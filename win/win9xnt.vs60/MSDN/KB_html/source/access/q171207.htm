

<HTML>
<HEAD>
<TITLE>ACC97: Removing Replicated Module Causes Automation Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171207">
<META NAME="KBModify" CONTENT="1997/11/11">
<META NAME="KBCreate" CONTENT="1997/07/09">
<META NAME="Keywords" CONTENT="RplGen RplUpd kbcode kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you open a replica after synchronizing with another replica, you may receive the following error message:     Automation error  CAUSE =====  An object in the Design Mas...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBS0,QAAP,QAFO,QA1S,QBWS,QAUR,QAH4,QDN9,QA2K,QAMA,QAGB,QBQU,QBML,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Removing Replicated Module Causes Automation Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171207</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you open a replica after synchronizing with another replica, you may
receive the following error message:
<P>
<PRE>   Automation error

</PRE><h2>CAUSE</h2>
 
<P>
An object in the Design Master's Visual Basic for Applications project has
been made nonreplicable, and then a synchronization with the replica has
been performed from within the Design Master.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Correcting the Automation Error After Synchronization</h3>
 
<P>
Correcting the Automation error following synchronization depends on how
the object was made nonreplicable in the Design Master. If the object was
made nonreplicable by clearing the Replicable check box in the object's
property window, the error should be corrected after you open the replica
a second time following synchronization. The first time you open the
replica following synchronization, Microsoft Access automatically compiles
and saves the replica's Visual Basic for Applications project. Once
Microsoft Access has compiled and saved the replica's Visual Basic for
Applications project, you should no longer receive the error when opening
the replica.
<P>
If the object was made nonreplicable by deleting it from the Design Master,
you will continue to receive the Automation error each time you open the
replica. In this case, you can correct the error by manually compiling and
saving all modules in the replica. To manually compile and save all modules
in the replica, follow these steps:

<OL><P><LI>Open the replica that is producing the Automation error.

<P><LI>Create a new, local module.

<P><LI>On the Debug menu, click "Compile and Save All Modules." When prompted
   to save the module, save it with any name.

<P><LI>Delete the new module created in step 3.

<P><LI>Close the replica, and then reopen it. Note that the Automation error
   no longer occurs.
<P>
</OL><h3>Preventing the Automation Error from Occurring</h3>
 
<P>
You can prevent the Automation error from occurring by performing the
synchronization from within the replica. This causes Microsoft Access to
automatically compile and save the replica's Visual Basic for Applications
project, and therefore prevents the error from occurring. To initiate the
synchronization from within the replica, follow these steps:

<OL><P><LI>Open the replica.

<P><LI>On the Tools menu, point to Replication, and then click Synchronize
   Now.

<P><LI>Select the Design Master database, and then click OK. You will
   receive a message confirming the synchronization was completed
   successfully. Click Yes to close the message.

<P><LI>Close the replica, and then reopen it.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97.
This problem no longer occurs in Microsoft Access 97 Service Release 1.
<P>
NOTE: Stand-alone Microsoft Access 97 Service Release 1 is not currently
available, but you can update your copy of Microsoft Access 97 to Service
Release 1 by downloading Microsoft Office Service Release 1 from
Microsoft's Web site at:
<P>
<PRE>   <B><A href="http://www.microsoft.com/office/office97/servicerelease">http://www.microsoft.com/office/office97/servicerelease</A></B>

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
Objects that make up a database's Visual Basic for Applications project
include global modules as well as forms and reports whose HasModule
property is set to Yes. These objects can be made nonreplicable either by
clearing the Replicable check boxes or by deleting the objects from the
Design Master.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file
and perform these steps on a copy of the database.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations
    section if it is not already there:
<P>
       Option Explicit

<P><LI>Type the following procedure:
<P>
       Function Test()
<PRE>          MsgBox "This is a test."
       End Function

</PRE><P><LI>On the Debug menu, click "Compile and Save All Modules."

<P><LI>When prompted for the module name, type "mdlReplicationTest" (without
    the quotation marks), and then click OK. Close the module.

<P><LI>On the Tools menu, point to Replication, and then click Create Replica.

<P><LI>Click Yes when prompted to close the current database.

<P><LI>Click No when prompted to create a backup of the database.

<P><LI>Select a location for the new replica, and then click OK. You will
    receive a confirmation message indicating the database has been
    converted to a Design Master, and that a replica has been created.
    Click OK to close the message.

<P><LI>Open the replica created in steps 6 - 9. Note that Microsoft Access
    compiles and saves the replica's Visual Basic for Applications
    project without error.

<P><LI>Open the replicated version of Northwind.mdb.

<P><LI>Delete the "mdlReplicationTest" module created in steps 2 - 5.

<P><LI>On the Tools menu, point to Replication, and then click Synchronize
    Now.

<P><LI>Select the replica created in steps 6 - 9, and then click OK. You
    will receive a message confirming the synchronization was completed
    successfully. Click Yes to close the message.

<P><LI>Open the replica created in steps 6 - 9. Note that you receive the
    following error message:
<P>
       Automation error
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pra<BR>
Keywords          : RplGen RplUpd kbcode kberrmsg<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
