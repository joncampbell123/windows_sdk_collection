

<HTML>
<HEAD>
<TITLE>ACC2: DefaultEditing Set to "Can't Add Records" Removes Filter </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129302">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1995/04/24">
<META NAME="Keywords" CONTENT="FmsProp kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use Access Basic code to set a form's DefaultEditing property to Can't Add Records, any filter that you apply to the form is removed and all the records are displayed.  ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA5V,QA1S,QAH4,QBXS,QDKW,QDN9,QAEF,QAHE,QAGU,QBJZ,QA5F,QAO4,QAMA,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: DefaultEditing Set to "Can't Add Records" Removes Filter</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129302</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use Access Basic code to set a form's DefaultEditing property to
Can't Add Records, any filter that you apply to the form is removed and all
the records are displayed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, re-apply the filter after you set the
DefaultEditing property to Can't Add Records.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
2.0. This problem no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Because the Can't Add Records option for the DefaultEditing property is not
available in the OpenForm macro action's Data Mode argument, you must use
Access Basic code to set the property in the form's Load event. But if you
set the property in the form's Load event, when the form opens, any filter
you apply to the OpenForm action's Filter Name or Where Condition argument
is removed.
<P>
For more information about opening a form with the Can't Add Records data
mode, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q129301.htm">Q129301</A></B>
   TITLE     : ACC2: No "Can't Add Records" Data Mode Arg. in OpenForm
               Action

</PRE><h3>Steps to Reproduce Problem</h3>
 
<P>
The following example demonstrates the problem described in this article.
For an example that demonstrates how you can work around this problem, see
the "Work Around" section later in this article.
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Open the Employees form in Design view.

<P><LI>Enter the following code for the form's Load event procedure:
<P>
<PRE>      Sub Form_Load (Cancel As Integer)
         ' Set the DefaultEditing property to the value passed in the
         ' OpenArgs argument.
         Me.DefaultEditing = Me.OpenArgs
      End Sub

</PRE><P><LI>Save, and then close the form.

<P><LI>Open the Utility Functions module in Design view and choose Immediate
   Window from the View menu.

<P><LI>Type the following statement in the Immediate window and press ENTER:
<P>
<P><PRE>      DoCmd OpenForm "Employees",,,,,,"4"
</PRE><P>
   Note that the Employees form opens. You cannot add new records, but all
   the employee records are available.
<P>
</OL><h3>Work Around</h3>
 
<P>
To open the form with a filter, pass the Where Condition argument and the
specified DefaultEditing property setting in the OpenArgs argument. In the
form's Load event, parse the components and apply the filter after setting
the specified DefaultEditing property.

<OL><P><LI>Change the Employees form's Load event procedure to the following
   code:
<P>
<PRE>      Sub Form_Load ()
         Dim iSemicolon As Integer
         Dim iDefaultEditing As Integer
         Dim sWhereCondition As String

         ' Find the semicolon.
         iSemicolon = InStr(Me.OpenArgs, ";")

         ' If the semicolon is found...
         If iSemicolon &gt; 0 Then
            '...parse the DefaultEditing property and WhereCondition
            'argument...
            iDefaultEditing = Left(Me.OpenArgs, iSemicolon - 1)
            sWhereCondition = Mid(Me.OpenArgs, iSemicolon + 1)

            '...and set the DefaultEditing property and WhereCondition
            'argument.
            Me.DefaultEditing = iDefaultEditing
            If sWhereCondition &lt;&gt; "" Then
               DoCmd ApplyFilter , sWhereCondition
            End If
         End If
      End Sub

</PRE><P><LI>Type the following statement in the Immediate window and press ENTER:
<P>
<P><PRE>      DoCmd OpenForm "Employees", ,,,,,"4;[Employee ID]=9"
</PRE><P>
   Note that the form opens with a filter, and you cannot add new records.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the DefaultEditing property, search for
"DefaultEditing," and then "AllowEditing, DefaultEditing Properties" using
the Microsoft Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsProp kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
