

<HTML>
<HEAD>
<TITLE>ACC: Using Win.ini &amp; Odbc.ini When Linking SQL Server Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96110 ">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1993/03/08">
<META NAME="Keywords" CONTENT="kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article discusses how the ODBC Driver manager and the SQL Server driver use the Win.ini and Odbc.ini files during connection time.  MORE INFORMATION  For the purposes o...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAU9,QA9E,QAA1,QAK6,QAC2,QA0B,QDI2,QAUJ,QAGI,QAYY,QAR5,QA1S,QBWD,QAVZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using Win.ini &amp; Odbc.ini When Linking SQL Server Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96110 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article discusses how the ODBC Driver manager and the SQL Server
driver use the Win.ini and Odbc.ini files during connection time.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For the purposes of this article, the following is assumed:

<UL><LI>You set up a data source for the SQL Server driver called mysqlsvr.

<LI>The data source is located on a server called Unixmc.

<LI>You are connecting to a Sybase SQL Server table on Unix whose
   address is 11.1.4.40,3180.

<LI>The net-library you are using is wdbftptc.dll.
<P>
</UL>Given these assumption, if the setup was done correctly, the Odbc.ini
file will have the following entry in the [ODBC Data Sources] section:
<P>
<PRE>   mysqlsvr=SQL Server

</PRE>There will be a section called [mysqlsvr] in the Odbc.ini and it will
have entries of the following form:
<P>
<PRE>   DRIVER=c:\windows\system\sqlsrvr.dll
   Description=SQL\Server on server Unixmc
   OemToAnsi=No
   Network=wdbftptc
   Address=11.1.4.40,3180

</PRE>The DRIVER entry points to the location of the SQL Server driver. It is
located on the System subdirectory of the Windows directory.
<P>
The Description entry describes what kind of a data source this is. This is
something that you can change when setting up the data source by using ODBC
Administrator.
<P>
The OemToAnsi entry indicates whether conversion needs to be done from the
OEM code page to the ANSI code page. Note that this is not the same as the
translation DLL.
<P>
The Network entry indicates the name of the net-library.
<P>
The Address entry indicates the network address.
<P>
The WIN.INI file will have the following entry in its [SQLSERVER] section:
<P>
<PRE>   mysqlsrvr=wdbftptc,11.1.4.40,3180

</PRE>When you run a SQLConnect or SQLDriverConnect command and choose to connect
to the mysqlsvr data source, the Driver manager looks in the ODBC.INI file
to find the name and location of the SQL Server driver. It looks for the
DRIVER entry described above and loads it into memory.
<P>
Next, the SQL Server driver looks in the Win.ini file's [SQLSERVER] section
for mysqlsvr entry where it picks up the name of the net-library. Then it
loads the net-library name (wdbftptc in this case) into the memory. Next,
it looks at the entry again to get the address of the server which it
passes on to the net-library. If there is no address following the name of
the net-library, it passes the name of the data source to the net-library,
as the network address.
<P>
Db-library users should note that unlike W3dblib.dll, the SQL Server driver
does not look at the dsquery entry unless dsquery is a data source in the
Odbc.dll file.
<P>
If you are using Microsoft Access, this sequence of operations takes place
when you link (attach) a SQL Server table. If you are using Microsoft
Visual Basic, it takes place in response to the OpenDataBase call.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage OdbcOthr<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
