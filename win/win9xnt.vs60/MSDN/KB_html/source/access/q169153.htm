

<HTML>
<HEAD>
<TITLE>ACC: Sample Query to Print One Label for Two People in a List </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169153">
<META NAME="KBModify" CONTENT="1997/06/09">
<META NAME="KBCreate" CONTENT="1997/05/28">
<META NAME="Keywords" CONTENT="kbprint QryTotal RptLabel RptWizlbl">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you have a list of names for which you would like to generate mailing labels, there are frequently two people listed at the same address. This article demonstrates a techniq...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QBQP,QAMB,QA7O,QA7N,QA5V,QAUJ,QAML,QAWH,QAGU,QAJQ,QADP,QAB6,QACF,QBWD P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sample Query to Print One Label for Two People in a List</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169153</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you have a list of names for which you would like to generate mailing
labels, there are frequently two people listed at the same address. This
article demonstrates a technique to create a query from which to print a
single mailing label for two people at the same address.
<P>
NOTE: If more than two people on your mailing list live at the same
address, only the names from the first and last record with that address in
your table will appear in the query.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you have an address list with two people at the same address, it is
often preferable to print a single mailing label for that address that
lists both people's names. To accomplish this, you first need to create a
query that contains the first name to print on the label, and then create a
query that contains the second name for the label. Then you can put these
two queries together to show both names for each address in a third query.
<P>
For this method to work it is important that ALL of the address information
for each person at the same address is identical. For example,
<P>
<PRE>   123 First Street N

</PRE>is different from
<P>
<PRE>   123 First St. North

</PRE>The following example uses the aggregate functions First() and Last() to
create lists of primary label names and secondary label names,
respectively.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0 or earlier). You may
want to back up the Northwind.mdb (or NWIND.MDB) file and perform these
steps on a copy of the database.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb (or
   NWIND.MDB in version 2.0).

<P><LI>Open the Employees table in Datasheet view, and add the following three
   records to create duplicate addresses. Note that some fields in each
   record will be left blank. Carefully type the information exactly as it
   appears below:
<P>
<PRE>                 Record #1            Record #2         Record #3
    -----------------------------------------------------------------------
    Last Name:   Fuller               Wilkinson         Smith
    First Name:  Mary                 Avery             John
    Birth Date:  7/2/54               4/30/77           10/20/58
    Address:     908 W. Capital Way   14 Garrett Hill   4110 Old Redmond
                                                        Rd.
    City:        Tacoma               London            Minneapolis
    Region:      WA                                     MN
    Postal Code: 98401                SW1 8JR           55435
    Country:     USA                  UK                USA

</PRE><P><LI>Create a new query in Design view based on the Employees table. This
   query will list the first set of names for your mailing labels.

<P><LI>On the View menu, click Totals. Then complete the design of your query
   as follows and save it as qryLabelNames1.
<P>
   NOTE: In Microsoft Access 2.0 the fields [Last Name], [First Name] and
   [Postal Code] contain a space in their names.
<P>
<P><PRE>      Query: qryLabelNames1
      ------------------------------------------------------
      Type: Totals Query
</PRE><P>
<P><PRE>      Field: ListName: First([FirstName] &amp; " " &amp; [LastName])
<PRE></PRE>         Table: Employees
         Total: Expression
         Sort: Ascending
      Field: Address
         Table: Employees
         Total: Group By
         Sort: None
      Field: City
         Table: Employees
         Total: Group By
         Sort: None
      Field: Region
         Table: Employees
         Total: Group By
         Sort: None
      Field: PostalCode
         Table: Employees
         Total: Group By
         Sort: None
      Field: Country
         Table: Employees
         Total: Group By
         Sort: None

</PRE><P><LI>Select the qryLabelNames1 query in the Database window, and then on the
   Edit menu, click Copy.

<P><LI>On the Edit menu, click Paste. In the Paste As dialog box, type
   qryLabelNames2 in the Query Name box, and then click OK.

<P><LI>Open the qryLabelNames2 query in Design view, and only modify the
   ListName field so it uses the Last() function instead of the First()
   function:
<P>
<P><PRE>      Field: ListName: Last([FirstName] &amp; " " &amp; [LastName])
<PRE></PRE>         Table: Employees
         Total: Expression
         Sort: Ascending

</PRE><P><LI>Save the query and close it. This query will list the second set of
   names for your mailing labels.

<P><LI>Create a new query in Design view based on the qryLabelNames1 and
   qryLabelNames2 queries. This query will be the basis for your mailing
   label report.
<P>
   NOTE: The expression in the field called Name2 contains an underscore
   (_) at the end of the line as a line-continuation character. Remove the
   underscore and type the entire expression as a single line when you
   recreate this example.
<P>
<P><PRE>      Query: qryMailingList
      ---------------------------------------------------------
      Type: Select Query
      Join: qryLabelNames1.Address &lt;-&gt; qryLabelNames2.Address
      Join: qryLabelNames1.PostalCode &lt;-&gt; qryLabelNames2.PostalCode
</PRE><P>
<P><PRE>      Field: Name1: ListName
<PRE></PRE>         Table: qryLabelNames1
         Sort: None
      Field: Name2: IIf([qryLabelNames1].[ListName]= _
             [qryLabelNames2].[ListName],"",[qryLabelNames2].[ListName])
         Sort: None
      Field: Address
         Table: qryLabelNames1
         Sort: None
      Field: City
         Table: qryLabelNames1
         Sort: None
      Field: Region
         Table: qryLabelNames1
         Sort: None
      Field: PostalCode
         Table: qryLabelNames1
         Sort: None
      Field: Country
         Table: qryLabelNames1
         Sort: None

</PRE></OL>When you run this query, note the following:

<UL><LI>Each record displays a name in the Name1 column, but where two or more
   people live at the same address, a name also appears in the Name2
   column.

<LI>Even though two records exist with an Address field of "4110 Old Redmond
   Rd.," they will print on separate labels because their postal codes are
   different. This happens because you joined both the Address and the
   PostalCode fields in the qryMailingList query.
<P>
</UL>Now you can use the Label Wizard (or Mailing Label Wizard in version 2.0)
to create labels based on the qryMailingList query.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using the Label Wizard, search the Help Index
for "mailing labels," or ask the Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprint QryTotal RptLabel RptWizlbl<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
