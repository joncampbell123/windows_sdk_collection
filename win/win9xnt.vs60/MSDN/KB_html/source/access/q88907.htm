

<HTML>
<HEAD>
<TITLE>ACC1x: How to Modify Toolbars </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88907 ">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1992/09/03">
<META NAME="Keywords" CONTENT="kbprg kbui MdlLib UifToolb">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Although Microsoft Access does not include any end-user features for modifying the toolbar at the top of the screen, you can modify the toolbar if you know how to design a f...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QANS,QAF0,QBCU,QA5D,QBVV,QAZV,QBWS,QAH4,QANE,QAIJ,QDIZ,QAMA,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Modify Toolbars</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88907 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Although Microsoft Access does not include any end-user features for
modifying the toolbar at the top of the screen, you can modify the
toolbar if you know how to design a form and write Access Basic code.
This article discusses where toolbars are stored, how they work, and
how you can modify them.
<P>
<P><h3>Notes</h3>
 

<UL><LI>Modification of the toolbar was not intentionally designed into
   Microsoft Access, so you may run into situations where your
   modifications do not work. Test your modifications on noncritical
   databases because making these modifications is not guaranteed to work
   correctly in every instance. Modifications to toolbars are not
   supported by Microsoft.

<LI>This article assumes that you are familiar with Access Basic and with
   creating Microsoft Access applications using the programming tools
   provided with Microsoft Access. For more information about Access
   Basic, please refer to the "Introduction to Programming" manual.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The various toolbars that appear when you are using Microsoft Access
are nothing more than forms stored in a database--the same kind of
forms that you create in Microsoft Access. These forms are stored in
the UTILITY.MDA file, a system database file that is loaded into memory
when you start Microsoft Access.
<P>
You cannot simply start Microsoft Access and open the UTILITY.MDA file to
modify these forms, however. This is because the UTILITY.MDA file is
loaded as a library database when you are using Microsoft Access and you
are not allowed to open a library database while it is active. To work
around this, do the following:

<OL><P><LI>Quit Microsoft Access if you have it open and make sure that no
   instances of Microsoft Access are active.

<P><LI>Choose the MS-DOS Prompt icon in Program Manager and type the
   following commands at the MS-DOS command prompt (the example below
   assumes that your Microsoft Access system files are stored in a
   directory called C:\ACCESS). Press ENTER after each command:
<P>
<P><PRE>     CD \ACCESS
     COPY UTILITY.MDA UTILITY.NEW
</PRE>
<P><LI>Start Microsoft Access.
<P>
</OL>At this point, you can begin modifying the toolbars in the UTILITY.NEW
file.
<P>
Open the UTILITY.NEW file as a database (a couple of alerts will appear
about loading duplicate procedure names; ignore these alerts by choosing
the OK button). In the Database window, switch to Form view and note the
names of the forms. The forms in the Database window that end with the
characters "TB" are toolbar forms. At this point, you can open a toolbar
form and make a modification. After you have made the modification, you
can change a setting in your MSACCESS.INI file that will force Microsoft
Access to use the UTILITY.NEW file instead of the UTILITY.MDA file as its
utility database.
<P>
It is important to note that any functionality you add to new
controls on the toolbars must be supported by Access Basic--do not use
macros, because they will not work for this purpose.
<P>
The example below illustrates how you can add a toolbar button to your
form design toolbar that will toggle the toolbox on and off:

<OL><P><LI>Open the form called FDTB in Design view. This is the toolbar that
    appears when you bring up a form in Design view.

<P><LI>Add a small command button to the right of the Paint Palette
    toolbar button on the form. Make sure your button does not overlap
    any other controls and that it does not alter the height of the
    form.

<P><LI>Set the button's OnPush property as follows:
<P>
      =ToggleToolBox()

<P><LI>Save and close the form.

<P><LI>Create a new module called NewToolBarFunctions and add the
    following sample function:
<P>
      Function ToggleToolBox ()
<PRE>          DoCmd DoMenuItem 3, 2, 8
          ' The DoCmd command above invokes the forms design menu item
          ' View-&gt;Toolbox.
      End Function

</PRE><P><LI>Save and close the module, and then close the database.

<P><LI>Quit Microsoft Access.

<P><LI>From Program Manager, open Notepad.

<P><LI>In NotePad, open the MSACCESS.INI file from your Windows program
    directory.

<P><LI>In the MSACCESS.INI file, locate the [Options] section and modify the
    UtilityDB= line to read:
<P>
      UtilityDB=C:\ACCESS\UTILITY.NEW

<P><LI>Save and close the MSACCESS.INI file, and then start Microsoft Access.

<P><LI>Open any database, and open any form in Design view. Note that the
    button you added appears in the toolbar. Click the button to turn
    the toolbox on and off.
<P>
</OL>In the same way you modified your form design toolbar using the steps
above, you can make other modifications to add functionality to the
other Microsoft Access toolbars.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: customize update<BR>
Keywords            : kbprg kbui MdlLib UifToolb<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
