

<HTML>
<HEAD>
<TITLE>ADT/ODE: How to Remove All Nodes from TreeView Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172286">
<META NAME="KBModify" CONTENT="1997/08/05">
<META NAME="KBCreate" CONTENT="1997/08/01">
<META NAME="Keywords" CONTENT="OdeGen kbprg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multi-user skills.  The Microsoft TreeView control version 5.0 ships with Microsoft Office 97 Developer Edition.  Use the Clear method to remove all nodes in a TreeView control.  This article ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QA1S,QAB5,QA7O,QAOE,QAMN,QAPN,QDN9,QBXS,QBS0,QA9N,QAJX,QADR,QAHV,QDKX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ADT/ODE: How to Remove All Nodes from TreeView Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172286</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft Office Developer Edition 97
<LI>Microsoft Access Developer's Toolkit, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multi-user skills.
<P>
The Microsoft TreeView control version 5.0 ships with Microsoft Office 97
Developer Edition.
<P>
Use the Clear method to remove all nodes in a TreeView control.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates creating a TreeView contol, adding
nodes, and then removing the nodes:

<OL><P><LI>Start Microsoft Access and open a new, blank database.

<P><LI>Open a new form in Design view.

<P><LI>On the Insert menu, click ActiveX Control (or click Custom Control if
    you are using Microsoft Access 7.0).

<P><LI>In the Insert ActiveX Control dialog box, select the Microsoft TreeView
    Control, and then click OK.

<P><LI>Set the following properties of the TreeView Control:
<P>
    TreeView Control
    ----------------
    Name: tvcExample
    Width: 2
    Height: 2

<P><LI>Add a command button to the form, and set the following properties:
<P>
    Command Button
    ----------------------
    Name: btnFillTreeView
    Caption: Fill TreeView
    Width: 1"
    Height: .25"

<P><LI>Set the OnClick property of the command button to the following event
    procedure:
<P>
     Private Sub btnFillTreeView_Click()
<P>
<PRE>       Dim nodX As Node    ' Declare Node variable.

       With Me!tvcExample

          ' Set Treeview control properties.
          .LineStyle = tvwRootLines  ' Linestyle 1
          ' Add Node objects
          ' First node with 'Root1' as text.
          Set nodX = .Nodes.Add(, , "r1", "Root1")
          ' Second node on root with 'Root2' as text
          Set nodX = .Nodes.Add(, , "r2", "Root2")
          ' This next node is a child of Node 1 ("Root").
          Set nodX = .Nodes.Add("r1", tvwChild, "child1", "Child")

       End With

     End Sub

</PRE><P><LI>Add another command button to the form and set the following
    properties:
<P>
    Command Button
    -----------------------
    Name: btnDeleteAllNodes
    Caption: Clear TreeView
    Width: .25"
    Height: 1"

<P><LI>Set the OnClick property of the command button to the following event
    procedure:
<P>
     Private Sub btnDeleteAllNodes_Click()
<PRE>          Me!tvcExample.Nodes.Clear
     End Sub

</PRE><P><LI>Switch to Form view and click Fill TreeView; then click Clear Treeview,
    and note that all nodes are removed.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about nodes in the TreeView control, search the Help
Index for "node object."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: basic delete<BR>
Keywords          : OdeGen kbprg<BR>
Version           : 7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
