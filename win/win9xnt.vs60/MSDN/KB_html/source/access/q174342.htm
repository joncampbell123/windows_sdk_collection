

<HTML>
<HEAD>
<TITLE>ACC: User-Level Security Wizard Doesn't Add Library References </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174342">
<META NAME="KBModify" CONTENT="1997/10/13">
<META NAME="KBCreate" CONTENT="1997/09/25">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the User-Level Security Wizard to secure a database that references libraries other than those included by default, code in the resulting database may not compile co...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAH4,QBWS,QAZV,QDN9,QBJZ,QAK7,QAAD,QBHQ,QDKX,QAVY,QAB4,QABT,QAW6,QAPN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: User-Level Security Wizard Doesn't Add Library References</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174342</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the User-Level Security Wizard to secure a database that
references libraries other than those included by default, code in the
resulting database may not compile correctly. You receive the following
error messages:
<P>
<PRE>   Compile Error: Variable not defined

   -or-

   Compile Error: User-defined type not defined

</PRE><h2>CAUSE</h2>
 
<P>
The wizard creates a new default database into which it imports the objects
from the unsecured database. References to libraries that existed in the
unsecured database are not automatically created in the new secure
database.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure that the same library references selected in the original,
unsecured database are also selected in the new, secured database. To
do so, follow these steps:

<OL><P><LI>Open the original, unsecured database in Microsoft Access.

<P><LI>In the Database window, click the Modules tab.

<P><LI>Select any module and click Design, or if no modules exist in the
    Modules window, click New.

<P><LI>On the Tools menu, click References.

<P><LI>Write down the name of each library that has a check mark next to its
    name.

<P><LI>Click Close; then close the module, and close the unsecured database.

<P><LI>Open the new, secured database in Microsoft Access.

<P><LI>In the Database Window, click the Modules tab.

<P><LI>Select any module and click Design, or if no modules exist in the
    Modules window, click New.

<P><LI>On the Tools menu, click References.

<P><LI>In the References dialog box, click to select the check boxes for the
    same libraries selected in the unsecured database.

<P><LI>Click OK.

<P><LI>On the Debug menu, click Compile Loaded Modules.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When Microsoft Access creates a new database, three references are included
by default. These references are as follows.
<P>
<P><h3>Microsoft Access 7.0</h3>
 

<UL><LI>Visual Basic For Applications
<LI>Microsoft Access for Windows 95
<LI>Microsoft DAO 3.0 Object Library
<P>
</UL><h3>Microsoft Access 97</h3>
 

<UL><LI>Visual Basic For Applications
<LI>Microsoft Access 8.0 Object Library
<LI>Microsoft DAO 3.5 Object Library
<P>
</UL>The procedure in the "Steps to Reproduce Problem" section is intended to
duplicate the error described in the "Symptoms" section. It does not
indicate the correct way to secure a Microsoft Access database. Please see
the "References" section for more information about Microsoft Access
Security.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
<PRE>  1. Open any sample database in Microsoft Access.

  2. In the Database window, click the Modules tab.

  3. Click New.

  4. On the Tools menu, click References.

  5. Click to select the Microsoft Office 8.0 Object Library.

     NOTE: If you are using Microsoft Access 7.0, click to select the
     Microsoft Office 95 Object Library.

  6. Click OK.

  7. Type the following code into the module:

       Function LostReference()
          ' This function sets the variable X to a constant that is
          ' defined in the Microsoft Office Object Library. If
          ' there is no reference to the Microsoft Office Object
          ' Library, this code generates a compile error. The
          ' Microsoft Office Object Library is not referenced
          ' by default.
          Dim X
          X = offPropertyTypeDate
       End Function

  8. On the Debug menu, click Compile Loaded Modules. (Note: Use the Run
     menu in Access 7.0).

  9. On the File menu, click Save; then type TestModule in the Module Name
     box.

 10. Close the Module.

 11. On the Tools menu, point to Security, and then click User-Level
     Security Wizard. Follow the instructions provided by the wizard.

     NOTE: You will receive a warning message if you are logged in as the
     Admin user:

       You are currently logged on as the Admin user. If you continue, the
       database and all objects in it will be unsecured. Do you want to
       continue?

     Click Yes; this will not affect this example.

 12. Open the newly secured database in Microsoft Access.

 13. In the Database window, click the Modules tab.

 14. Select TestModule from the Database window and click Design.

 15. On the Debug menu, click Compile Loaded Modules. (Note: Use the Run
     menu in Access 7.0).

     Note that you receive one of the error messages described in the
     "Symptoms" section.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about References, search the Help Index for
"References, type."
<P>
For more information about security, search the Help Index for "security,
securing a database," or ask the Microsoft Access 97 Office Assistant.
<P>
For additional information, see the Microsoft Access Security FAQ which is
located on the following Microsoft World Wide Web site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/access/content/secfaq.asp">http://support.microsoft.com/support/access/content/secfaq.asp</A></B>

</PRE>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prb OFF97<BR>
Keywords          : kberrmsg<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
