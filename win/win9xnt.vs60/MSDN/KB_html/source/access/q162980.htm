

<HTML>
<HEAD>
<TITLE>ACC97: IDC or ASP Parameter Query Returns "Too Few Parameters" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162980">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="OtpOthr QryParm WzOthr kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  When you browse to an IDC file that was created from a Microsoft Access 97 parameter query, the following error is returned in your Web browser:    Too few parameters. Expected         .  NOTE: This same behavior will occur when you export a form t...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QBWS,QBWA,QA3P,QACF,QBTI,QA1S,QA28,QATJ,QAUR,QAP2,QBVX,QDN9,QAUD,QAVZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: IDC or ASP Parameter Query Returns "Too Few Parameters"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162980</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
<LI>Microsoft Internet Information Server version 2.0 and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you browse to an IDC file that was created from a Microsoft Access 97
parameter query, the following error is returned in your Web browser:
<P>
<PRE>  Too few parameters. Expected &lt;number&gt;.

</PRE>NOTE: This same behavior will occur when you export a form that is based on
a parameter query as an Active Server Page.
<P>
<P><h2>CAUSE</h2>
 
<P>
The parameter query does not have data types specified in the Query
Parameters dialog box.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Explicitly declare the data types of each parameter in your query.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following is an example of a query that has its parameter data types
explicitly declared:

<OL><P><LI>Open the sample database Northwind.mdb, and create the following new
   query called qryParameter based on the Employees table:
<P>
<P><PRE>      Query: qryParameter
      ------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: LastName
<PRE></PRE>         Table: Employees
      Field: FirstName
         Table: Employees
         Criteria: [EnterName]

</PRE><P><LI>On the Query menu, click Parameters. Type the following in the Query
   Parameters dialog box, and then click OK.
<P>
<PRE>      Parameter          Data Type
      ----------------------------
      [EnterName]        Text

</PRE><P><LI>Save the qryParameter query and close it. If you exported the
   qryParameter query to IDC format, the SQL Statements generated would
   be correctly delimited.
<P>
</OL><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb, and create the following new
   query called qryParameter based on the Employees table:
<P>
<P><PRE>       Query: qryParameter
       ------------------------
       Type: Select Query
</PRE><P>
<P><PRE>       Field: LastName
<PRE></PRE>          Table: Employees
       Field: FirstName
          Table: Employees
          Criteria: [EnterName]

</PRE><P><LI>Save the qryParameter query and close it. Select the qryParameter query
   in the Database window, and then click Save As/Export on the File menu.

<P><LI>In the Save As dialog box, click "To an External File or Database," and
   then click OK.

<P><LI>In the "Save Query 'qryParameter' In" dialog box, select Microsoft IIS
   1-2 (*.htx;*.idc) in the Save As Type box, and type qryParameter.htx in
   the File Name box. Note the folder where the files will be exported to.
   Click Export. The HTX/IDC Output Options dialog box appears.

<P><LI>In the Data Source Name box, enter the name of a System DSN that
   points to the sample database Northwind.mdb. Click OK.
<P>
   For more information about how to define a system DSN, search the Help
   index for "ODBC, setting up data sources" and see the following article
   in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../access/q159682.htm">Q159682</A></B>
<PRE></PRE>      TITLE     : "Data Source Name Not Found" Err Msg Opening Web Page

</PRE><P><LI>Click OK in the Enter Parameter Value dialog box that appears. Note
   that the HTX/IDC output creates three files: qryParameter.HTML,
   qryParameter.htx, and qryParameter.IDC.

<P><LI>Copy qryParameter.HTML, qryParameter.htx, and qryParameter.IDC to a
   folder on your Web Server computer where you have both Read and Execute
   permission. Read permission is necessary to browse the HTML file and
   execute permission is necessary to run the IDC file.
<P>
   For more information about configuring Microsoft Internet Information
   Server (IIS) permissions, please refer to the IIS Help Index, and see
   the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../access/q160754.htm">Q160754</A></B>
<PRE></PRE>      TITLE     : Error "HTTP/1.0 403 Access Forbidden" Browsing IDC Page

</PRE><P><LI>Start Microsoft Internet Explorer 3.0, or another Web browser program.
   Type the Uniform Resource Locator (URL) in the address box of your Web
   browser to view qryParameter.HTML. For example, if you saved your IDC
   files in a folder called Test in the wwwroot folder of your Web
   Server, type:
<P>
<P><PRE>       <B>http://&lt;servername&gt;/test/qryParameter.HTML</B>
</PRE><P>
   Note that the URL depends upon where your files are located on the Web
   Server.

<P><LI>The qryParameter.HTML form opens in your web browser with an
   [EnterName] box and a Run Query button. Type "Nancy" (without the
   quotation marks) in the box, and then click the Run Query button.
   Note that the following error is returned:
<P>
<P><PRE>      Too few parameters. Expected 1.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about exporting IDC files, search the Help Index for
"IDC files," and then "Export a datasheet to dynamic HTML format,"
or ask the Microsoft Access 97 Office Assistant. In addition, please refer
to the IIS Help Index.
<P>
For more information about parameter queries, search the Help Index for
"parameter queries," and then "Specify the data type of a parameter in a
parameter query," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : OtpOthr QryParm WzOthr kberrmsg kbinterop
Version           : 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
