

<HTML>
<HEAD>
<TITLE>ACC: Macro to Check for Duplicate Values in a Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103135">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1993/08/18">
<META NAME="Keywords" CONTENT="kbusage McrCond">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  This article demonstrates how to use a macro using the DLookup() function to check for duplicate values in a field.  MORE INFORMATION  Microsoft Access provides automatic c...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QA7O,QABI,QAFO,QA7N,QA5V,QAKD,QAH4,QA1S,QAUD,QAPN,QDN9,QDKY,QBDM,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Macro to Check for Duplicate Values in a Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103135</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
This article demonstrates how to use a macro using the DLookup() function
to check for duplicate values in a field.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Access provides automatic checking for duplicate values in a
field that has been designated as the primary key. However, this check
occurs after all fields for a record have been entered, just before the
record is committed to the database. The following sample macro is based on
the sample database Northwind.mdb (or NWIND.MDB in versions 1.x and 2.0)
and will perform a duplicate check as the data in a field is entered:

<OL><P><LI>Open the Northwind.mdb (or NWIND.MDB in versions 1.x and 2.0).

<P><LI>Create a new form based on the Customers table.

<P><LI>Create a new macro as follows.
<P>
   NOTE: In the following example, an underscore (_) is used as a line-
   continuation character. Remove the underscore from the end of the line
   when re-creating the example.
<P>
<PRE>      Macro Name     Condition     Action
      --------------------------------------
      MyMacro        1.            MsgBox
                     ...           SendKeys

      1. DLookup("[CustomerID]", "Customers", "[CustomerID] = _
            Form.[CustomerID]") is Not Null

      NOTE: In versions 1.x and 2.0, there is a space in Customer ID.

      MyMacro Actions
      --------------------------------------
      MsgBox
         Message: That value already exists.

      SendKeys
         Keystrokes: +{TAB}
         Wait: No

   Note that the ellipsis (...) under the condition indicates that the
   condition controls both macro actions. The SendKeys action will
   return the cursor to the field just exited.

</PRE><P><LI>In Design view for the form, attach this macro to the AfterUpdate
   property of the CustomerID control.

<P><LI>In Form view, make a note of the value of the current CustomerID.

<P><LI>From the Records menu, choose Data Entry to add a new record.

<P><LI>Enter the value of the earlier noted CustomerID. The message box
   with your message will appear and the pointer will be returned to
   the CustomerID field.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about duplicate values in a field, search the Help
Index for "duplicate values," or ask the Microsoft Access 97 Office
Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: validate same validationrule<BR>
Keywords            : kbusage McrCond<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
