

<HTML>
<HEAD>
<TITLE>ACC2: Exporting Data to MS Excel 5.0 or 95 Twice Causes Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119806">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1994/08/24">
<META NAME="Keywords" CONTENT="IsmExl5 kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  Problem 1 ---------  If you export data from Microsoft Access to a Microsoft Excel versions 5.0 or 7.0 workbook twice, either manually or using the TransferSpreadsheet macr...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA3P,QA1S,QBJZ,QAUR,QDN9,QDNM,QAB4,QAH4,QAPN,QAKP,QBXS,QAYY,QAGB,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Exporting Data to MS Excel 5.0 or 95 Twice Causes Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119806</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
<LI>Microsoft Excel for Windows, versions 5.0, 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
<P><h3>Problem 1</h3>
 
<P>
If you export data from Microsoft Access to a Microsoft Excel versions 5.0
or 7.0 workbook twice, either manually or using the TransferSpreadsheet
macro action, and then try to delete extra worksheets from the workbook,
you will receive the error message:
<P>
<PRE>   Not enough memory

</PRE><h3>Problem 2</h3>
 
<P>
Similarly, if you export data from Microsoft Access to a Microsoft Excel
workbook twice, either manually or using the TransferSpreadsheet macro
action, and then try to insert a worksheet, you receive the error message:
<P>
<PRE>   Cannot do that command on nonadjacent selections

</PRE><h2>RESOLUTION</h2>
 
<P>
<P><h3>Problem 1</h3>
 
<P>
Do not export Microsoft Access data directly to a Microsoft Excel
workbook. Instead, use one of the following methods:

<UL><LI>Export the data, either manually or using the TransferSpreadsheet macro
   action, to a Microsoft Excel version 4.0 workbook.

<LI>Export the data, either manually or using the TransferSpreadsheet macro
   action, to a temporary Microsoft Excel 5.0 or 7.0 workbook, and then use
   a Microsoft Excel macro to transfer the data from one workbook to
   another.
<P>
</UL>If you accidentally export data to a Microsoft Excel workbook, follow
these steps to correct the problem:

<OL><P><LI>In Microsoft Excel, open the workbook to which you exported the data,
   and then choose Save As from the File menu.

<P><LI>In the Save File As Type box, select Microsoft Excel 4.0 Workbook,
   and then choose OK. Note that the file's extension changes to ".XLW".

<P><LI>Close the workbook.

<P><LI>Open the .XLW file you created in step 2.

<P><LI>From the File menu, choose Save As.

<P><LI>In the Save File As Type box, select Microsoft Excel Workbook, and
   then choose OK.

<P><LI>When you are prompted, choose Yes to replace the existing file.
<P>
</OL><h3>Problem 2</h3>
 
<P>
To solve the problem with inserting worksheets, move the worksheets
in the exported workbook to a new workbook within Microsoft Excel.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
2.0. This problem no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new Microsoft Excel version 5.0 workbook. Type "1" (without
    quotation marks) in cell A1, and type "2" (without quotation marks)
    in cell B1.

<P><LI>Delete worksheets 5-16 by selecting their tabs and then choosing
    Delete Sheet from the Edit menu.

<P><LI>Save the workbook as BOOK1.XLS. Make sure to save the file in
    Microsoft Excel Workbook format (the default format).

<P><LI>Close the workbook and then minimize Microsoft Excel.

<P><LI>Start Microsoft Access version 2.0 and open the sample database
    NWIND.MDB.

<P><LI>Create the following new macro, and then save it as TestMacro:
<P>
<PRE>       Macro Name   Macro Actions
       --------------------------------
       TestMacro    TransferSpreadsheet

       TestMacro Actions
       ----------------------------------------
       TransferSpreadsheet
          Transfer Type: Export
          Spreadsheet Type: Microsoft Excel 5.0
          Table Name: Customers
          File Name: &lt;drive&gt;:\&lt;path&gt;\BOOK1.XLS

</PRE><P><LI>Create a blank, new form.

<P><LI>Add a command button to the form. Set the command button's OnClick
    property to the TestMacro macro.

<P><LI>Save the form, and then view it in Form view.

<P><LI>Choose the command button twice.

<P><LI>Switch to Microsoft Excel.

<P><LI>Open the BOOK1.XLS workbook.

<P><LI>Try to delete the new worksheets. You will receive the error message
    stated earlier in this article.
<P>
</OL>NOTE: This problem occurs with the second export to the same Microsoft
Excel 5.0 workbook. If you export the data only once, the problem does not
occur. The problem will also occur if you export the data, delete the new
worksheet, export the data again, and then try to delete the new worksheet.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the TransferSpreadsheet macro action, search for
"TransferSpreadsheet," and then "TransferSpreadsheet Action" using the
Microsoft Access Help menu.
<P>
Microsoft Access "User's Guide," version 2.0, Chapter 26, "Using Macros to
Print Reports or Transfer Data," page 700
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: interoperability
<P>

Keywords            : IsmExl5 kberrmsg kbinterop<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
