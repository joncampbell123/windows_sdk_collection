

<HTML>
<HEAD>
<TITLE>ACC: Nulls Allowed in Foreign Key with Referential Integrity </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98789 ">
<META NAME="KBModify" CONTENT="1998/01/05">
<META NAME="KBCreate" CONTENT="1993/05/13">
<META NAME="Keywords" CONTENT="GnlApp kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  Microsoft Access allows a Null value in a field that is the foreign key in a relationship if referential integrity is enforced.  To prevent users from leaving the foreign k...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA5V,QA7O,QA7N,QBEK,QBEJ,QAB4,QAPF,QAKD,QALM,QBJZ,QARR,QABI,QDKY P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Nulls Allowed in Foreign Key with Referential Integrity</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98789 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
Microsoft Access allows a Null value in a field that is the foreign key in
a relationship if referential integrity is enforced.
<P>
To prevent users from leaving the foreign key blank in Microsoft Access 97,
7.0, or 2.0, set its Required property to Yes. To prevent users from
leaving the foreign key blank in Microsoft Access version 1.x, add a table
level validation rule to the table on the many side of the relationship.
For an example, see the "Steps to Reproduce Behavior" section.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior occurs whether you use a single-field primary key and foreign
key or a multiple-field primary key and foreign key. However, Microsoft
Access versions 7.0 and later allow a Null value in a field that is part of
a multiple-field foreign key only if every other field of the foreign key
also contains a Null value. If at least one field of the foreign key
contains a Null value and at least one other field of the foreign key
contains data, you receive the following error when you try to save the
record.
<P>
<PRE>   In Microsoft Access 7.0
   -----------------------

      Can't add or change record. Referential integrity rules require a
      related record in table &lt;one-side table&gt;.

   In Microsoft Access 97
   ----------------------

      You can't add or change a record because a related record is
      required in table &lt;one-side table&gt;.

</PRE>This behavior differs from that of earlier versions of Microsoft Access.
Microsoft Access version 2.0 allows you to save a record in which at
least one field of the foreign key contains a Null value and at least
one other field of the foreign key contains data.
<P>
For more information about Null values and multiple-field foreign keys in
Microsoft Access versions 7.0 and later, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q170779.htm">Q170779</A></B>
   TITLE     : ACC: Inconsistent Behavior with Multiple-Field Primary
               Key

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0 or earlier). You may
want to back up the Northwind.mdb (or NWIND.MDB) file and perform these
steps on a copy of the database.

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB).

<P><LI>On the Tools menu (or Edit menu in version 1.x or 2.0), click
   Relationships.

<P><LI>In Microsoft Access 97, 7.0 or 2.0, double-click the line connecting the
   Customer ID in the Customers table to the Customer ID in the Orders
   table. In version 1.x, In the Primary Table drop-down box, select
   the Customers table and in the Related Table drop-down box, select
   the Orders table.
<P>
   Note the following:
<P>
<P><PRE>    a. The Table/Query and Related Table/Query both display CustomerID.
</PRE><P>
<P><PRE>    b. The Enforce Referential Integrity check box is checked.
</PRE><P>
<P><PRE>    c. The join is One-To-Many
</PRE><P>
<P><PRE>    d. The Add button is unavailable. (Version 1.1 only)
</PRE><P>
   These characteristics indicate an existing relationship between the
   Customers and Orders tables; therefore, you will not be able to make an
   entry in the Customer ID field of the Orders table if that Customer
   ID does not exist in the Customers table.

<P><LI>Close the Relationships dialog box and open the Orders table in
   Design view. Select the CustomerID field and note the Required
   property. Change this property to Yes and save the table.
<P>
   NOTE: In Microsoft Access, versions 2.0, the Required property will be
   set to Yes by default. In Microsoft Access, versions 1.x, you will need
   to set a validation rule. See the Microsoft Access "User's Guide",
   version 1.1, page 43-46 for more information.

<P><LI>Open the Orders table in Datasheet view and try to change the Customer
   ID field of the first order to "XXXX" and press TAB to try to move to
   the next record. Note that you receive the following error message.
<P>
   In Microsoft Access 97 or 7.0:
<P>
<P><PRE>      The text you entered isn't an item in the list.
</PRE><P>
   This error message is due to the new feature in Microsoft Access 7.0 and
   97 called the Lookup Field. For more information about this new feature,
   search on "Lookup fields," and then "Create a field that looks up or
   lists values in tables" using the Microsoft Access Help Index.
<P>
   In Microsoft Access versions 1.x and 2.0:
<P>
<P><PRE>      Can't add or change record. Referential Integrity rules require
      a related record in the table "Customers."
</PRE>
<P><LI>Click OK.

<P><LI>Delete the entry in the Customer ID field. Make sure the field is
   completely empty. Press TAB to move to the next record. You will receive
   the following error message:
<P>
<P><PRE>     Field 'Orders.CustomerID' can't contain a null value
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about data integrity, search the Help Index for
"referential integrity," and then "What is referential integrity" or ask
the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: null compact cascade<BR>
Keywords          : GnlApp kbusage<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
