

<HTML>
<HEAD>
<TITLE>ACC: How to Rank Records Within a Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120608">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1994/09/15">
<META NAME="Keywords" CONTENT="kbusage QryHowto">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article contains three examples that demonstrate how to rank records within a query. The first example ranks records from a table. The second example ranks the results ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAPF,QA7O,QA7N,QANY,QAE1,QDKY,QAWH,QBWS,QAUD,QAY2,QAKD,QA3W,QBDO,QBDM P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Rank Records Within a Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120608</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article contains three examples that demonstrate how to rank records
within a query. The first example ranks records from a table. The second
example ranks the results of a totals query. The third example demonstrates
an alternative method of handling ties in ranking.
<P>
All the examples in this article require a field containing a value that
can be evaluated using either the GREATER THAN (&gt;) or the LESS THAN (&lt;)
operator, and a subquery to count the number of records that are greater
than or less than the current record.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Example 1 and Example 2 below, records following a tie in ranking are
given the same rank number they would have received had there been no tie.
The following table demonstrates a sample result with a tie in ranking:
<P>
<PRE>   Salesperson   Sales   Rank
   --------------------------

   Peterson      $8000   1
   Wakita        $7000   2
   Akerley       $7000   2
   Reston        $6000   4

</PRE>In Example 3 below, a second query, which has a DISTINCT clause, is used to
return a unique list of ranking less than that of the current record. The
following table, using the same records as the table above, demonstrates
the results of this method:
<P>
<PRE>   Salesperson   Sales   Rank
   --------------------------
   Peterson      $8000   1
   Wakita        $7000   2
   Akerley       $7000   2
   Reston        $6000   3

</PRE><h3>Example 1</h3>
 
<P>
This example returns results that show the order in which employees were
hired.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0 or earlier). You may
want to back up the Northwind.mdb (or NWIND.MDB) file and perform these
steps on a copy of the database.

<OL><P><LI>Open the sample Northwind.mdb (or NWIND.MDB in version 2.0) and create
   a new query based on the Employees table.

<P><LI>If the property sheet is not displayed, click the Properties button on
   the toolbar.

<P><LI>Click the title bar of the Employees field list, and then set the
   field list's Alias property to Emp1.

<P><LI>Drag the LastName and HireDate fields from the field list to the
   query grid.
<P>
   NOTE: In version 2.0, there is a space in the Last Name and the Hire
   Date fields.

<P><LI>In the HireDate column's Sort row, select Ascending.

<P><LI>In the third column's Field row, enter the following expression.
<P>
   NOTE: In the following expressions, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating these expressions.
<P>
<P><PRE>      Seniority: (Select Count(*) from Employees Where _
      [HireDate] &lt; [Emp1].[HireDate];)
</PRE>
<P><LI>Run the query. Note that the returned records are ranked sequentially
   starting at 0. The subquery returns the number of employees hired before
   the current employee. To rank the records starting with 1, use the
   following expression in step 6 above:
<P>
<P><PRE>      Seniority: (Select Count(*) from Employees Where _
      [HireDate] &lt; [Emp1].[HireDate]+1;)
</PRE>
<P><LI>To see the results of a tie in ranking, change the hire date of any
   employee to match another (in the Employees table).
<P>
</OL><h3>Example 2</h3>
 
<P>
This example returns results that rank categories by the number of products
in each category.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0 or earlier). You may
want to back up the Northwind.mdb (or NWIND.MDB) file and perform these
steps on a copy of the database.

<OL><P><LI>Create a new query based on the Products table.

<P><LI>Drag the CategoryID and ProductID fields from the field list to the
   query grid.
<P>
   NOTE: In version 2.0, there is a space in the Category ID and the
   Product ID fields.

<P><LI>Click the Totals button on the toolbar.

<P><LI>In the CategoryID column's Total row, select Group By. In the ProductID
   column's Total row, select Count. Save the query as ProductCount.

<P><LI>Create a new query based on the ProductCount query.

<P><LI>Set the ProductCount field list's Alias property to Prod1.

<P><LI>Drag both fields from the field list to the query grid, and then
   select Descending in the CountofProductID column's Sort row.

<P><LI>In the third column's Field row, enter the following expression.
<P>
   NOTE: In the following expression, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this expression.
<P>
<P><PRE>      Ranking: (Select Count(*) from ProductCount Where _
      [CountofProductID] &gt; [Prod1].[CountofProductID]) + 1
</PRE>
<P><LI>Run the query.
<P>
</OL><h3>Example 3</h3>
 
<P>
This example demonstrates an alternative method of handling ties in
ranking.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0 or earlier). You may
want to back up the Northwind.mdb (or NWIND.MDB) file and perform these
steps on a copy of the database.

<OL><P><LI>Repeat steps 1-8 in example 2. After step 8, save the query as
   CatRanking. Run the query and note the tie in the number of products
   between the Seafood, Condiments, and Beverages categories, CategoryIDs
   8, 2, and 1, respectively.
<P>
   NOTE: In version 2.0, there is a space in the Category ID field.

<P><LI>Create a new query based on the Products table. Drag the CategoryID
   and ProductID fields from the field list to the query grid.
<P>
   NOTE: In version 2.0, there is a space in the Product ID field.

<P><LI>Click the Totals button on the toolbar.

<P><LI>In the CategoryID column's Total row, select Group By. In the ProductID
   column's Total row, select Count.

<P><LI>In the CategoryID column's Show row, clear the check box.

<P><LI>Set the query's UniqueValues property to Yes.

<P><LI>Run the query. Note that the query returns a list of the eight
   different totals of orders placed. Save the query as DistinctCount.

<P><LI>View the CatRanking query in Design view. Replace the expression
   in the third column's Field row with the following expression, and
   then run the query.
<P>
   NOTE: In the following expression, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this expression.
<P>
<P><PRE>      Ranking: (Select Count(*) from DistinctCount Where _
      [CountofProductID] &gt; Prod1.[CountofProductID]) + 1
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: top first<BR>
Keywords            : kbusage QryHowto<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
