

<HTML>
<HEAD>
<TITLE>ACC: Errors Adding Record to AutoLookup Form (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142842">
<META NAME="KBModify" CONTENT="1997/05/12">
<META NAME="KBCreate" CONTENT="1996/01/21">
<META NAME="Keywords" CONTENT="kberrmsg kbusage QryHowto">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you are adding a record through a form that is based on an AutoLookup query, you may receive one of the following error messages when you try to enter anything in the foreig...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA7N,QA5V,QBJZ,QBT6,QAB4,QBV4,QAKD,QAUR,QBWS,QAHP,QA1S,QAUD,QADX,QABA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Errors Adding Record to AutoLookup Form (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142842</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you are adding a record through a form that is based on an AutoLookup
query, you may receive one of the following error messages when you try to
enter anything in the foreign key field:
<P>
<PRE>   To make changes to this field, first save the record

   -or-

   Current field must match join key '?' on 'one' side of
   one-to-many relationship because it has been updated.

   -or-

   Field can't be edited

</PRE><h2>CAUSE</h2>
 
<P>
Default values are set on a control or controls bound to the "one" side
table of an AutoLookup query, which acts as the record source for the form.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure that the control or controls that are bound to the "one" side of
the query do not have any default values set.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you enter a value in the foreign key field of an AutoLookup query,
fields from the "one" side table should update automatically with related
information. However, if you are adding a new record and one or more fields
from the "one" side have a default value, Microsoft Access assumes that you
are trying to add a record to the "one" side as well as to the "many" side.
<P>
If there are no default values for any of the "many" side fields, when you
enter a value in the foreign key field after making an entry in another
field from the "many" side table, you receive the error message:
<P>
<PRE>     &lt;fieldname&gt; field must match join key '?' on 'one' side
     of one-to-many relationship because it has been
     updated.

</PRE>If there are default values for any of the "many" side fields, or if you
have not entered any value in any field from the "many" side table, you
will receive the following warning message in the status bar after you
enter a value in the foreign key field:
<P>
<PRE>     To make changes to this field, first save the record

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Select the Orders table, and on the Edit menu click Copy.

<P><LI>On the Edit menu, click Paste.

<P><LI>In the Paste Table As dialog box, type Orders2 in the Table Name box,
    and then click OK.

<P><LI>Open the Orders2 table in Design view.

<P><LI>Change the OrderID Data Type from AutoNumber to Number.

<P><LI>Save and close the Orders2 table.

<P><LI>Create the following new query based on the Customers and the Orders2
    tables:
<P>
      Query: AutoLookup
      ---------------------------------------------------------
      Type: Select Query
<P>
      Field: OrderID
<PRE>         Table: Orders2
         Sort: Ascending
      Field: OrderDate
         Table: Orders2
      Field: CustomerID
         Table: Orders2
      Field: CompanyName
         Table: Customers
      Field: Address
         Table: Customers
      Field: City
         Table: Customers
      Field: Region
         Table: Customers
      Field: PostalCode
         Table: Customers
      Field: Country
         Table: Customers
      Field: Phone
         Table: Customers

</PRE><P><LI>Save the query as AutoLookup and close it.

<P><LI>Select the AutoLookup query, and on the Insert menu, click AutoForm.

<P><LI>When the new form opens in Form view, on the View menu click Design
    View (or Form Design in Microsoft Access 7.0).

<P><LI>Select the CustomerID control, and then on the Format menu, point to
    Change To, and then click Text Box.

<P><LI>Select the Region control, and set its DefaultValue property to 0
    (zero).

<P><LI>Open the form to Form view, and on the Records menu, click Data
    Entry.

<P><LI>Try to type any value into the Customer text box. Note that the
    following message appears in the status bar:
<P>
       To make changes to this field, first save the record.

<P><LI>Press the ESC key twice to undo the new record.

<P><LI>Type 1234 in the OrderID text box. Press TAB to move to the Customer
    text box, enter a value, and then press ENTER. Note that you receive
    the following error message:
<P>
<PRE>          Current field must match join key '?' on 'one'
          side of one-to-many relationship because it has
          been updated.

</PRE><P><LI>Press the ESC key twice to undo the new record.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the AutoLookup feature, search on the phrase
"AutoLookup queries," and then view the "Create an AutoLookup query that
automatically fills in data" or the "About AutoLookup queries that enter
data automatically" topic, using the Microsoft Access 97 Help Index.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage QryHowto<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
