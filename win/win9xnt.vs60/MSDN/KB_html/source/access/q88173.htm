

<HTML>
<HEAD>
<TITLE>ACC: ODBC Setup for Microsoft Access and SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88173 ">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1992/08/19">
<META NAME="Keywords" CONTENT="kberrmsg kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The installation of Microsoft ODBC for Microsoft and Sybase SQL Server requires the use of ISQL command line procedures to properly run the INSTCAT.SQL script.  If INSTCAT.S...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA1S,QAA1,QDNQ,QDN9,QDI2,QBWU,QAH5,QA9E,QBWS,QBXT,QA5V,QAIB,QAB9,QBWP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: ODBC Setup for Microsoft Access and SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88173 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
<LI>Microsoft SQL Server versions 1.10, 1.11, 4.20 for MS-DOS
   and Microsoft OS/2, and Microsoft SQL Server for Windows NT
<LI>Microsoft SQL Administrator versions 4.20, 4.21 for Windows
<LI>Microsoft ISQL for Windows version 4.21
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The installation of Microsoft ODBC for Microsoft and Sybase SQL Server
requires the use of ISQL command line procedures to properly run the
INSTCAT.SQL script.
<P>
If INSTCAT.SQL has not been properly implemented in SQL Server, you may
receive the following error message while linking (attaching) a SQL table
in Microsoft Access:
<P>
<PRE>   [Microsoft][ODBC SQL Server Driver] The ODBC catalog stored
   procedures installed on server &lt;server_name&gt; are version xx.xxxx;
   version xx.xx.xxxx is required to ensure proper operation. Please
   contact your system administrator.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
To properly configure SQL Server for use with Microsoft ODBC, you must run
the SQL script file INSTCAT.SQL (included on the ODBC disk in Microsoft
Access version 1.x, on disk 1 in Microsoft Access version 2.0 and on
disk 8 in Microsoft Access version 7.0) to set up the proper stored
procedures that provide catalog information used by Microsoft ODBC.
<P>
NOTE: Microsoft SAF for MS-DOS and OS/2 is limited to 511 lines of code in
a SQL script. INSTCAT.SQL has well over 511 lines of code.
<P>
Microsoft SQL Administrator version 4.20 will open the INSTCAT.SQL script,
but you will not be able to run it. This is because version 4.20 of the
SQL Administrator does not recognize the GO command used in INSTCAT.SQL.
This has been corrected in the SQL Administrator version 4.21.
<P>
In Microsoft SQL Server version 4.20a or earlier, the proper way to
install the catalog stored procedures using INSTCAT.SQL is to run
INSTCAT.SQL from the command line using the SQL Server utility ISQL
(Interactive SQL). If you are using Microsoft SQL Server version 4.20b for
OS/2 or Microsoft SQL Server for Windows NT, you can run the INSTCAT.SQL
script from within either ISQL/w (Interactive SQL for Windows), or
Microsoft SQL Administrator for Windows version 4.21.
<P>
Note that in order to run the INSTCAT.SQL script, you must connect to your
SQL Server as the System Administrator, or SA.
<P>
The ISQL facility is run from either the MS-DOS or OS/2 command prompt.
The syntax for this procedure is as follows.
<P>
NOTE: In the following example, an underscore (_) is used as a line-
continuation character. Remove the underscore from the end of the line
when re-creating this example.
<P>
<PRE>   isql /U &lt;sa login name&gt; /n /P &lt;password&gt; /S &lt;SQL server name&gt; /i_
   &lt;drive:\path\INSTCAT.SQL&gt; /o &lt;drive:\path\output file name&gt;

</PRE>Below are descriptions of the command line switches:
<P>
<PRE>   /U    The login name for the system administrator
   /n    Eliminates line numbering and prompting for user input
   /P    Password used for the system administrator (case sensitive)
   /S    The name of the server to set up
   /i    Provides the drive and fully qualified path for the location of
         INSTCAT.SQL
   /o    Provides isql with an output file destination for results or
         the process including errors

</PRE><h3>Example</h3>
 
<P>
<PRE>   isql /U sa /n /P skier /S DUMMY_SERVER /i d:\SQL\INSTCAT.SQL /o_
   d:\SQL\output.txt

</PRE>After you run INSTCAT.SQL, you should run the RECONFIGURE command
against the MASTER database using SAF. See pages 205-212 of the
Microsoft SQL "Administrator's Guide," version 4.2, for more
information.
<P>
NOTE: This information is available in the Microsoft Access README.TXT
file.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage OdbcOthr<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
