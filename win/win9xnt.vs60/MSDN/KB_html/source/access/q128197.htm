

<HTML>
<HEAD>
<TITLE>ACC2: Format of Data in Text Portion of Combo Box Is Incorrect </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128197">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1995/03/27">
<META NAME="Keywords" CONTENT="FmsCmbo kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you select a value from a combo box list, the selection that appears in the text portion of the combo box is not formatted as it appears in the combo box list.  For example,...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNG,QAE1,QACE,QBV3,QAPN,QDMN,QATX,QAMB,QAHP,QA7O,QA7N,QA1S,QABA,QBDM,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Format of Data in Text Portion of Combo Box Is Incorrect</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128197</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you select a value from a combo box list, the selection that appears
in the text portion of the combo box is not formatted as it appears in the
combo box list.
<P>
For example, if you select a date that is formatted as a Medium
Date in the table and in the combo box list (such as 10-May-91) the
date appears in the text portion of the combo box in Short Date format
(5/10/91).
<P>
<P><h2>CAUSE</h2>
 
<P>
Unlike a text box, a combo box does not have its own Format property. As a
result, if the combo box is bound to a table field, the value that appears
in the text portion of the combo box uses the format of the data as it is
stored in the table, ignoring any format defined at the table or query
level.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this behavior, use the following steps to base the format for a
value in a combo box on a query rather than on a table:

<OL><P><LI>Base the combo box on a query.

<P><LI>Place the field you want to make the bound column in the combo box in
   both the first and second columns in the query grid.

<P><LI>Place all other fields you want to include in the combo box in the
   third and successive columns.

<P><LI>In the combo box, make the first column the bound column and hide it
   from view by setting the following properties for the combo box:
<P>
<P><PRE>      BoundColumn:  1
      ColumnWidths: 0
</PRE><P>
</OL>Because the ColumnWidths property for column 1 is set to 0, Microsoft
Access uses the second column in the query to display text in the text
portion of the combo box.
<P>
In the query, you can set Format properties for the second column to
display values using the formats you want.
<P>
An example of this technique is demonstrated in the "Steps to Reproduce
Behavior" and "How to Correct the Behavior" sections later in this article.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior no longer occurs in Microsoft Access version 7.0 with the
addition of the new Format property for combo boxes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB, and create a new table called
   MyTable as follows:
<P>
<P><PRE>      Table: MyTable
      -----------------------
      Name: MyDate
<PRE></PRE>         Data Type: Date/Time
         Format: Medium Date

</PRE><P><LI>Create a new query called MyQuery based on the Orders table. Include
   the Order Date field in the first column in the query grid.

<P><LI>Create a new form with the following property:
<P>
<P><PRE>      RecordSource: MyTable
</PRE>
<P><LI>Create a combo box on the form with the following properties:
<P>
<P><PRE>      Name: MyCombo
      ControlSource: MyDate
      RowSourceType: Table/Query
      RowSource: MyQuery
      ColumnCount: 1
      BoundColumn: 1
</PRE>
<P><LI>View the form in Form view.

<P><LI>Click the drop-down arrow on the combo box. Note that the dates in the
   combo box list appear in Medium Date format.

<P><LI>Select any date. Note that the date you selected appears in Short Date
   format in the text portion of the combo box.
<P>
</OL><h3>How to Correct the Behavior</h3>
 

<OL><P><LI>Change the MyQuery query to include the Order Date (bound column) field
   in both the first and second columns of the query grid.
<P>
   Note that you can format the second column in the query grid (the copy
   of the Order Date field) by using the right mouse button to click the
   second column and then choosing Properties on the menu that appears.
<P>
   If you do not specify a format, the field inherits the format defined
   for the field in the underlying table. In the case of the Order Date
   field, the format is Medium Date.

<P><LI>Change the MyCombo combo box to include the following property settings:
<P>
<P><PRE>      ColumnCount: 2
      BoundColumn: 1
      ColumnWidths: 0 in; 1 in
</PRE><P>
   Note that this hides the first column, which is the bound column, by
   setting the width of the column to 0.

<P><LI>View the form in Form view.

<P><LI>Click the drop-down arrow on the combo box. Note that the dates in
   the combo box list appear in Medium Date format.

<P><LI>Select any date. Note that the date you select appears in Medium Date
   format in the text portion of the combo box.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Format property, search for "Format," and
then "Format Property" using the Microsoft Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsCmbo kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
