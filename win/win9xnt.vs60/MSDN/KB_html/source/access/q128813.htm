

<HTML>
<HEAD>
<TITLE>ACC2: How to Create a Stopwatch Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128813">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1995/04/11">
<META NAME="Keywords" CONTENT="FmsHowto kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to create and use a form that contains a Start/Stop and a Reset command button that use the form's Timer event to display elapsed hours, minutes, and s...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA1S,QAH4,QACE,QBT6,QBV4,QAB9,QDN9,QAHP,QBXS,QAO4,QA5F,QAMA,QAIJ,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: How to Create a Stopwatch Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128813</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to create and use a form that contains a
Start/Stop and a Reset command button that use the form's Timer event to
display elapsed hours, minutes, and seconds in a text box control.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools
provided with Microsoft Access. For more information about Access Basic,
please refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to create and use a form to track
elapsed time:

<OL><P><LI>Open any database.

<P><LI>Create a blank form not based on any table or query and set the
   following properties for the form:
<P>
<P><PRE>      ScrollBars: Neither
      RecordSelectors: No
      NavigationButtons: No
      OnTimer: [Event Procedure]
      TimerInterval: 0
</PRE>
<P><LI>Type the following code for the form's OnTimer property event procedure:
<P>
<PRE>      Sub Form_Timer ()
         Dim Hours, Minutes, Seconds, MS
         Dim Msg As String

         ElapsedMS = ElapsedMS + Me.TimerInterval

         Hours = Format((ElapsedMS \ 360000), "00")
         Minutes = Format(((ElapsedMS \ 6000) Mod 60), "00")
         Seconds = Format((ElapsedMS \ 100) Mod 60, "00")
         MS = Format((ElapsedMS) Mod 100, "00")

         If Hours &gt; 0 Then Msg = Hours &amp; ":"
         Msg = Msg &amp; Minutes &amp; ":" &amp; Seconds &amp; ":" &amp; MS

         Me!ElapsedTime = Msg
      End Sub

</PRE><P><LI>Add a command button to the form and set the following properties for
   the command button:
<P>
<P><PRE>      Name: StartStop
      Caption: Start
      OnClick: [Event Procedure]
</PRE>
<P><LI>Enter the following code for the command button's OnClick property event
   procedure:
<P>
<PRE>      Sub StartStop_Click ()
         If Me.TimerInterval = 0 Then
            Me.TimerInterval = 1
            Me![StartStop].Caption = "Stop"
         Else
            Me.TimerInterval = 0
            Me![StartStop].Caption = "Start"
         End If
      End Sub

</PRE><P><LI>Add a second command button to the form and set the following properties
   for the second command button:
<P>
<P><PRE>      Name: Reset
      Caption: Reset
      OnClick: [Event Procedure]
</PRE>
<P><LI>Enter the following code for the second command button's OnClick
   property event procedure:
<P>
<PRE>       Sub Reset_Click ()
         ElapsedMS = 0
         Me!ElapsedTime = ""
       End Sub

</PRE><P><LI>Add a text box to the form and set the following properties for the
   text box:
<P>
<P><PRE>      Name: ElapsedTime
      Enabled: No
      Locked: Yes
</PRE>
<P><LI>Click Code on the View menu to display the form module. In the
   Declarations section, replace the default statement
<P>
<P><PRE>      Option Compare Database
</PRE><P>
   with the statements:
<P>
<P><PRE>      Option Explicit
      Dim ElapsedMS
</PRE><P>
</OL>NOTE: The performance of the Stopwatch form will be dependent upon the
computer's processor speed. The form may not display actual elapsed time
and may vary form computer to computer.
<P>
For more information about creating a Stopwatch Form in Microsoft Access
7.0 and 97, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q142871.htm">Q142871</A></B>
   TITLE     : ACC: How to Create a Stopwatch Form (95/97)
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsHowto kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
