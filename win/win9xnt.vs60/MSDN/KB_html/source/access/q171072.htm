

<HTML>
<HEAD>
<TITLE>ACC97: No Error When AddFromFile Creates Duplicate Procedure </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171072">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1997/07/07">
<META NAME="Keywords" CONTENT="kbcode kbprg MdlProb PgmErr PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The AddFromFile method does not generate an error when it adds a duplicate procedure to a module.  CAUSE =====  When the AddFromFile method inserts a procedure into a module...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBRZ,QBS0,QAB9,QAVX,QAPN,QA9N,QAWF,QAKJ,QA5E,QAY5,QAVW,QACI,QASR,QAAP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: No Error When AddFromFile Creates Duplicate Procedure</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171072</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The AddFromFile method does not generate an error when it adds a duplicate
procedure to a module.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the AddFromFile method inserts a procedure into a module, Visual Basic
for Applications tries to compile all code in the target module first, and
then inserts the procedure if successful.
<P>
If you use the AddFromFile method multiple times to insert the same
procedure into the same target module, Visual Basic for Applications does
not detect a compile error until the third attempt. On the first attempt,
Visual Basic for Applications successfully compiles the code, and then
inserts the procedure from the text file. On the second attempt, Visual
Basic for Applications successfully compiles the code in the target module,
which now includes one instance of the procedure from the text file; it
then inserts a second copy of the procedure from the text file. On the
third attempt, Visual Basic for Applications detects a compile error
because there are two instances of the same procedure in the target module.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent the AddFromFile method from inserting a duplicate procedure, use
the Find method of the Module object to determine if the procedure already
exists in the module. To do so, follow these steps:

<OL><P><LI>Repeat steps 1-4 from the "Steps to Reproduce Behavior" section later in
   this article.

<P><LI>Type the following procedure:
<P>
<P><PRE>     Function ImportProc(vbProcName As String)
<PRE></PRE>        Dim mdl As Module
        Dim vbLineStop As Long

        Set mdl = Modules(0)
        vbLineStop = mdl.CountOfLines
        If Not mdl.Find(vbProcName, 1, 1, vbLineStop, 1, False) Then
           mdl.AddFromFile "C:\My Documents\Test.txt"
        Else
           MsgBox "'" &amp; vbProcName &amp; "' already exists in module."
        End If
     End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>      ?ImportProc("Sub AddFromFileTest()")
</PRE><P>
   Note that the AddFromFileTest procedure is successfully inserted into
   the module.

<P><LI>Repeat step 3 to run the procedure again.
<P>
   Note that the procedure is not inserted into the module, and that you
   receive the message:
<P>
<P><PRE>       'Sub AddFromFileTest()' already exists in module.
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Using Notepad or another text editor, create a new text file, and add
   the following text to the text file:
<P>
<PRE>      Sub AddFromFileTest()
         MsgBox "Hello"
      End Sub

</PRE><P><LI>Save and close the text file as C:\My Documents\Test.txt.

<P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function ImportProc()
<PRE></PRE>         Dim mdl As Module
         Set mdl = Modules(0)
         mdl.AddFromFile "C:\My Documents\Test.txt"
      End Function

</PRE><P><LI>On the Debug menu, click Compile And Save All Modules. When prompted
   to save the module, type "ImportTest" (without the quotation marks) and
   then click OK.

<P><LI>Type the following line in the Debug window, and then press ENTER:
<P>
<P><PRE>      ?ImportProc()
</PRE><P>
   Note that the AddFromFileTest procedure is successfully added to the
   module.

<P><LI>Repeat step 7 to run the ImportProc procedure again.
<P>
   Note that a second copy of the AddFromFileTest procedure is
   successfully added to the module, and no error is generated.

<P><LI>Repeat step 7 to run the ImportProc procedure a third time.
<P>
   Note that you receive the message:
<P>
<P><PRE>      Compile Error:
</PRE><P>
<P><PRE>      Ambiguous name detected: AddFromFileTest
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using the AddFromFile method, search the Help
Index for "AddFromFile method."
<P>
For more information about using the Find method, search the Help Index
for "Find method", and then "Find Method (Microsoft Access Reference)".
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbcode kbprg MdlProb PgmErr PgmHowTo<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
