

<HTML>
<HEAD>
<TITLE>ACC97: Manipulating Objects with DAO May Cause Database Bloat </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172285">
<META NAME="KBModify" CONTENT="1997/08/05">
<META NAME="KBCreate" CONTENT="1997/08/01">
<META NAME="Keywords" CONTENT="MdlDao kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you use data access objects (DAO) to create objects in a database, the size of the database increases substantially during the operation. After compacting, the size of ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QA1S,QDN9,QABM,QAVX,QAPN,QANF,QBS0,QBQU,QBJZ,QBWS,QA7O,QA7N,QAW6,QAUD P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Manipulating Objects with DAO May Cause Database Bloat</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172285</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you use data access objects (DAO) to create objects in a database,
the size of the database increases substantially during the operation.
After compacting, the size of the database is much smaller.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use SQL Data Definition Language (DDL) statements rather than DAO to create
or modify database objects. For example, you can use the following
procedure to work around the behavior demonstrated in the "Steps to
Reproduce Problem" section:
<P>
<PRE>   Sub CreateTables()
      Dim db As Database
      Dim sql As String
      Dim i As Integer, j As Integer

      Set db = CurrentDb()
      For i = 1 To 20
         sql = "CREATE TABLE Table" &amp; i &amp; " ("
         For j = 1 To 200
            sql = sql &amp; "Field" &amp; j &amp; " TEXT,"
         Next
         sql = Left$(sql, Len(sql) - 1) &amp; ");"
         db.Execute sql
      Next
      Application.RefreshDatabaseWindow
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97.
We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior typically occurs when using DAO to create or modify a large
number of database objects. The following example demonstrates this by
using DAO to create twenty tables, each with two hundred fields. In this
example, reducing the number of fields created in the example greatly
reduces the amount of database bloat.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>On the Tools menu, point to Database Utilities, and then click Compact
    Database.

<P><LI>Press CTRL+G to open the Debug window.

<P><LI>Type the following in the Debug window, and then press ENTER:
<P>
      ?FileLen(CurrentDb.Name)
<P>
    This function returns the file size in bytes of the currently
    opened database (Northwind.mdb). The file size of an unmodified copy
    of Northwind.mdb is approximately 1,546,240 bytes.

<P><LI>Create a module and type the following line in the Declarations
    section if it is not already there:
<P>
      Option Explicit

<P><LI>Type the following procedure:
<P>
     Sub CreateTables()
       Dim db As Database
       Dim t As TableDef
       Dim f As Field
       Dim i As Integer, j As Integer
<P>
       Set db = CurrentDb()
       For i = 1 To 20
<PRE>          Set t = db.CreateTableDef("Table" &amp; i)
          For j = 1 To 200
             Set f = t.CreateField("Field" &amp; j)
             f.Type = dbText
             f.size = 50
             t.Fields.Append f
          Next
          db.TableDefs.Append t
       Next
       Application.RefreshDatabaseWindow
     End Sub

</PRE><P><LI>On the Debug menu, click Compile And Save All Modules. When Microsoft
    Access prompts you for the name of the module, click OK to accept the
    default name.

<P><LI>To run this procedure, type the following line in the Debug window,
    and then press ENTER. It may take several minutes for this procedure
    to run.
<P>
      CreateTables
<P>
    Note that twenty tables are added to the database, each with two
    hundred fields.

<P><LI>Type the following line in the Debug window, and then press ENTER:
<P>
      ?FileLen(CurrentDb.Name)
<P>
    Note that the file size of Northwind.mdb is now reported to be more
    than 52 megabytes.

<P><LI>Press F11 to view the Database window.

<P><LI>On the Tools menu, point to Database Utilities, and then click Compact
    Database.

<P><LI>Press CTRL+G to open the Debug window.

<P><LI>Type the following in the Debug window, and then press ENTER:
<P>
      ?FileLen(CurrentDb.Name)
<P>
    Note that the file size of Northwind.mdb after compacting is reported
    to be 1,898,496 bytes.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about DDL queries, search the Help Index for
"data-definition queries," or ask the Microsoft Access 97 Office
Assistant.
 
<PRE>Keywords          : MdlDao kbusage
Version           : 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbcode</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
