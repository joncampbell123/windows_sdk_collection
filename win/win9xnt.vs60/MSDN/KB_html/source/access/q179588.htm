

<HTML>
<HEAD>
<TITLE>ACC: "Incomplete calculation" Error Opening Linked MS Excel File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179588">
<META NAME="KBModify" CONTENT="1998/01/22">
<META NAME="KBCreate" CONTENT="1998/01/20">
<META NAME="Keywords" CONTENT="IsmExl4 IsmExl5">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="   Novice: Requires knowledge of the user interface on single-user computers.  When you open a Microsoft Excel spreadsheet file that contains links to another Microsoft Excel spreadsheet file, you receive one of the following messages:     This docum...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBWS,QBJZ,QA1S,QBTI,QAE2,QDNM,QAUR,QAB4,QDN9,QBS9,QDMK,QAAP,QAXB,QA3P P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: "Incomplete calculation" Error Opening Linked MS Excel File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 22, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179588</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
When you open a Microsoft Excel spreadsheet file that contains links to
another Microsoft Excel spreadsheet file, you receive one of the following
messages:
<P>
<PRE>   This document contains links. Re-establish links?

   The workbook you opened contains automatic links to information in
   another workbook. Do you want to update this workbook with changes
   made to the other workbook?

</PRE>If you click Yes, you receive the following error:
<P>
<PRE>   '&lt;filename.xls&gt;' contains incomplete calculation.

</PRE><h2>CAUSE</h2>
 
<P>
The spreadsheet file that you are opening contains links to a second
spreadsheet file, and the second spreadsheet file is the source of a linked
table in a Microsoft Access database. You receive the error after you have
updated the data in the Microsoft Access table that is linked to the second
spreadsheet file.
<P>
In Microsoft Access version 7.0, this error occurs when you export to the
Microsoft Excel 5-7 (*.xls) file format or to the Microsoft Excel 4 (*.xls)
file format. In Microsoft Access 97, you do not receive this error unless
you export the table to the Microsoft Excel 4.0 file format.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To prevent this error from occurring, follow these steps:

<OL><P><LI>Start Microsoft Excel, and open the spreadsheet file that is the
   source of the links in the file that you are trying to open.

<P><LI>Press F9, or click Options on the Tools menu, and then click Calc Now on
   the Calculation tab.

<P><LI>Save and close the file.

<P><LI>Open the spreadsheet file containing the links to the file that you
   saved in step 3. Note that you do not receive an error message if you
   click Yes when prompted to update or re-establish the links.
<P>
</OL>If your spreadsheet generates the error described in the "Symptoms" section
when you open it, you must follow these steps every time that you use
Microsoft Access to update the other spreadsheet that is the source of its
links.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
<P><h3>Create a Microsoft Excel 4.0 Spreadsheet</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>In the Database window, select the Customers table.

<P><LI>On the File menu, click Save As/Export.

<P><LI>In the Save As dialog box, click To An External File Or Database, and
   then click OK.

<P><LI>In the Save Table 'Customers' In dialog box, click Microsoft Excel 4
   (*.xls) in the Save As Type box.

<P><LI>Type "Cust4.xls" (without the quotation marks) in the File Name box and
   then click Export.
<P>
</OL><h3>Create a Spreadsheet Linked to Another Spreadsheet</h3>
 

<OL><P><LI>Start Microsoft Excel and open the file Cust4.xls that you created in
    step 6 of the "Create a Microsoft Excel 4.0 Spreadsheet" section.

<P><LI>Press CTRL+HOME; then press CTRL+SHIFT+END to select the data in the
    spreadsheet.

<P><LI>On the Edit menu, click Copy.

<P><LI>On the File menu, click New. In the New dialog box, click the General
    tab, and then click the Workbook icon. Click OK to open a new workbook.

<P><LI>On the Edit menu, click Paste Special.

<P><LI>In the Paste Special dialog box, click Paste Link.

<P><LI>On the File menu, click Save.

<P><LI>In the Save As dialog box, click Microsoft Excel 4.0 Worksheet (*.xls)
    in the Save As Type box.

<P><LI>Type "Cust4a.xls" (without the quotation marks) in the File Name box,
    and then click Save. When you receive a message that the selected file
    type does not support workbooks containing multiple sheets, click OK to
    save only the active sheet.

<P><LI>Close both Cust4.xls and Cust4a.xls.
<P>
</OL><h3>Create a Microsoft Access Table Linked to a Spreadsheet</h3>
 

<OL><P><LI>Close both Cust4.xls and Cust4a.xls and return to Microsoft Access.
   Open the sample database Northwind.mdb if it is not already open.

<P><LI>On the File menu, point to Get External Data, and then click Link
   Tables.

<P><LI>In the Link dialog box, locate the file Cust4.xls that you created in
   in step 6 of the "Create a Microsoft Excel 4.0 Spreadsheet" section;
   select it, and then click Link.

<P><LI>When the Link Spreadsheet Wizard appears, click Next.

<P><LI>Click to select the First Row Contains Column Names check box, and then
   click Next.

<P><LI>Type "Cust4" (without the quotation marks) in the Linked Table Name box,
   and then click Finish.

<P><LI>When you receive the message that the Linked Spreadsheet Wizard has
   finished linking table Cust4, click OK.

<P><LI>Open the table Cust4. Make a change to the data in the ContactName
   field of the first record, and then close the table.
<P>
</OL><h3>Reopen the Linked Spreadsheet in Microsoft Excel</h3>
 

<OL><P><LI>Return to Microsoft Excel and open the file Cust4a.xls that you
   created in step 9 of the "Create a Spreadsheet Linked to Another
   Spreadsheet" section.

<P><LI>When you are prompted to re-establish links or to update this workbook
   with changes made to the other workbook, click Yes. Note that you
   receive the error described in the "Symptoms" section.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about linking to Microsoft Excel spreadsheet files,
search the Help Index for "Microsoft Excel, importing and linking Excel
data" and display the topic "import or link data from a spreadsheet."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: recalculation recalc<BR>
Keywords          : IsmExl4 IsmExl5<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbnofix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 22, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
