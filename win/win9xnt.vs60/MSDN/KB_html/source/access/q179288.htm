

<HTML>
<HEAD>
<TITLE>ACC: How to Repeat Report Records a Specified Number of Times </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179288">
<META NAME="KBModify" CONTENT="1998/01/14">
<META NAME="KBCreate" CONTENT="1998/01/13">
<META NAME="Keywords" CONTENT="RptEvent RptLabel">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Certain types of reports require printing each record a specific number of times. These reports include labels that are used for picking, shipping and invoicing, or tear-off form...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QA1S,QA5V,QAH4,QBJZ,QDN9,QBT6,QAMB,QBV4,QAPN,QAWF,QAKJ,QAGB,QAHP,QBBI P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Repeat Report Records a Specified Number of Times</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 14, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179288</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Certain types of reports require printing each record a specific number of
times. These reports include labels that are used for picking, shipping and
invoicing, or tear-off forms that are meant for multiple recipients.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to use a text box on an unbound form
to specify the number of times each record should be printed in the report.
<P>
<P><h3>Create the Report and the Code Behind the Report</h3>
 
<P>
<PRE>  1. Start Microsoft Access and open the sample database Northwind.mdb (or
     NWIND.MDB if you are using Microsoft Access version 2.0).

  2. Click the Reports tab and then click New.

  3. In the New Report dialog box, click AutoReport: Columnar and base the
     report on the Shippers table. Then click OK.

     If you are using Microsoft Access version 2.0, click Shippers in the
     Select A Table/Query drop-down list in the New Report dialog box; then
     click the Report Wizards button. In the Report Wizards dialog box,
     click AutoReport, and then click OK.

  4. Save the report as rptRepeatRecs.

  5. Open the rptRepeatRecs report in Design view.

  6. On the View menu, click Code.

  7. Under Option Compare Database, type the following statements:

        Option Explicit
        Dim intPrintCounter As Integer
        Dim intNumberRepeats As Integer

     Note that if you are using Microsoft Access version 7.0 or later,
     Option Explicit may already exist in the Declarations section.

  8. Close the module.

  9. On the Edit menu, click Select Report.

 10. On the View menu, click Properties.

 11. Click the OnOpen property box and then click the Build button (...) to
     the right.

 12. In the Choose Builder dialog box, click Code Builder, and then click
     OK.

 13. Type the following code:

        Private Sub Report_Open(Cancel As Integer)
           intPrintCounter = 1
           intNumberRepeats = Forms!PrintForm!TimesToRepeatRecord
        End Sub

 14. Close the module.

 15. Click the horizontal Detail bar. If the Detail section's property
     sheet is not already visible, click Properties on the View menu.

 16. Click the OnPrint property box, and then click the Build button (...)
     to the right.

 17. In the Choose Builder dialog box, click Code Builder, and then click
     OK.

 18. Type the following code:

        Private Sub Detail_Print(Cancel As Integer, PrintCount As Integer)
           ' Note: intNumberRepeats and intPrintCounter are initialized
           ' in the report's OnOpen event.
           If intPrintCounter &lt; intNumberRepeats Then
              intPrintCounter = intPrintCounter + 1
              ' Do not advance to the next record.
              Me.NextRecord = False
           Else
              ' Reset intPrintCounter and advance to next record.
              intPrintCounter = 1
              Me.NextRecord = True
           End If
        End Sub

     Note that this procedure may be called Detail1_Print in Microsoft
     Access version 2.0.

 19. Save and close the report.

</PRE><h3>Create a Form That Specifies How Many Times to Repeat the Records</h3>
 
<P>
<PRE>  1. In the Database window, click the Forms tab, and then click New.
     Create a new, blank form in Design View that is not based on any table
     or query.

  2. Add a text box to the form, and name it TimesToRepeatRecord.

  3. Make sure that the Control Wizards button on the toolbox is depressed;
     then add a command button to the form.

  4. In the Command Button Wizard dialog box, click Report Operations in
     the Categories list and click Preview Report in the Actions list. Then
     click Next.

  5. When you are asked which report you would like the command button to
     preview, click rptRepeatRecs, and then click Next.

  6. When you are asked if you want text or a picture on the button, click
     Text, and then click Next.

  7. Name the button PreviewReport. Then click Finish.

  8. Save the form as PrintForm, and switch to Form view.

  9. Type "3" (without the quotation marks) in the TimesToRepeatRecord text
     box, and then press ENTER.

 10. Click Preview Report.

     Note that Microsoft Access opens the rptRepeatRecs report and each
     record appears three times in the report.

</PRE><h2>REFERENCES</h2>
 
<P>
For information about repeating labels in Microsoft Access 1.x, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q117534.htm">Q117534</A></B>
   TITLE     : ACC1x: How to Print Multiple Labels in Varying Numbers
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: inf multiple repeat records duplicate more than<BR>
once<BR>
Keywords          : RptEvent RptLabel<BR>
Version           : WINDOWS:2.0,7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 14, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
