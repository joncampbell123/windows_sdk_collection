

<HTML>
<HEAD>
<TITLE>ACC2: Using the PrtDevMode Property to Change Page Orientation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129722">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1995/05/02">
<META NAME="Keywords" CONTENT="kbprint PtrSetup">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates a sample user-defined Access Basic Sub procedure you can use to set a report's PrtDevMode property to change the page orientation before you print the r...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAAL,QBXS,QAPN,QDN9,QAMA,QA5F,QADF,QANF,QBWA,QATX,QAH4,QBJZ,QBWC,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Using the PrtDevMode Property to Change Page Orientation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129722</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates a sample user-defined Access Basic Sub procedure
you can use to set a report's PrtDevMode property to change the page
orientation before you print the report.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you change a report's page orientation by setting the PrtDevMode
property, keep the following printer driver characteristics in mind:

<UL><LI>Set only those members that the printer driver supports. For example,
   if you set a custom page size for a driver that does not support a
   custom page size, you may encounter unexpected results.

<LI>Set the PrtDevMode property's Fields member if you change any other
   member to let the printer driver know which members you are changing.

<LI>Change only the first 68 bytes of the PrtDevMode property. Printer
   drivers are able to store driver-specific information after the first
   68 bytes; therefore, it is important not to overwrite this information.
<P>
</UL><h3>How to Change the Page Orientation</h3>
 

<OL><P><LI>Create a module and enter the following statement in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Enter the following procedure:
<P>
<PRE>      Sub ChgRptOrient (ReportName As String)
         ' The zwtDevModeStr and zwtDeviceMode types are defined in the
         ' zwAllGlobals module in the WZFRMRPT.MDA file.
         Dim DevString As zwtDevModeStr
         Dim dm As zwtDeviceMode
         'Constant for the Fields member.
         Const DM_ORIENTATION = &amp;H1
         Dim stDevModeExtra As String
         Dim rpt As Report
         Dim msg As String
         'Open the report in Design view.
         DoCmd OpenReport ReportName, A_DESIGN
         Set rpt = Reports(ReportName)
         If Not IsNull(rpt.PrtDevMode) Then
            'Copy the PrtDevMode property to a string.
            stDevModeExtra = rpt.PrtDevMode
            DevString.rgb = stDevModeExtra
            LSet dm = DevString
            'Display the current orientation.
            msg = "The Orientation is currently"
            If dm.dmOrientation = 1 Then
               msg = msg &amp; " Portrait. Change to Landscape?"
            Else
               msg = msg &amp; " Landscape. Change to Portrait?"
            End If
            response = MsgBox(msg, 4)
            If response = 6 Then
               'User chose Yes.
               'Initialize the Fields member.
               dm.dmFields = dm.dmFields Or DM_ORIENTATION
               'Set the orientation.
               If dm.dmOrientation = 1 Then
                  'Set the orientation to Landscape.
                  dm.dmOrientation = 2
               Else
                  'Set the orientation to Portrait.
                  dm.dmOrientation = 1
               End If
               'Update the first 68 bytes of the PrtDevMode property.
               LSet DevString = dm
               Mid$(stDevModeExtra, 1, 68) = DevString.rgb
               rpt.PrtDevMode = stDevModeExtra
            End If
         End If
      End Sub

</PRE><P><LI>Choose Immediate Window from the View menu. Type the following line in
   the Immediate window, and then press ENTER
<P>
<P><PRE>      ChgRptOrient "&lt;Report1&gt;"
</PRE><P>
   where &lt;Report1&gt; is the name of your report.
<P>
</OL>The report opens in Design view, the current orientation is displayed, and
you are prompted to change the orientation.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Language Reference," version 2.0, "PrtDevMode property,"
pages 484-490
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprint PtrSetup<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
