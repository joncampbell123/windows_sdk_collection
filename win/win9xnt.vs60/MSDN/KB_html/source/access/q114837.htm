

<HTML>
<HEAD>
<TITLE>ACC1x: How to Determine If Database Is Open Exclusively (1.x) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114837">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1994/05/15">
<META NAME="Keywords" CONTENT="GnlMu kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  This article describes a method using Access Basic that you can use to determine if a database is open exclusively in Microsoft Access version 1.x.  This article assumes that you are familiar with Access Basic and with creating Microsoft Access app...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAZV,QDN9,QBWS,QA5F,QAMA,QADK,QA3A,QAAP,QAB4,QBW7,QAI5,QBE7,QBE6,QA6A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Determine If Database Is Open Exclusively (1.x)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114837</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes a method using Access Basic that you can use to
determine if a database is open exclusively in Microsoft Access version
1.x.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When a database is open exclusively, no other program or process can access
that database. When a database is open shared, other programs and processes
can get shared access to the database. This article demonstrates how to use
the Open statement in Access Basic to determine if a database is open
exclusively by using the Open statement's Shared argument to try to access
the database file in shared mode. If the database is open exclusively, an
error will occur. Trapping for the error determines whether the database is
open exclusively or not.
<P>
This function may be useful to Access Basic programmers who want to warn
their applications' users that a database is open in the wrong mode.
<P>
The following steps demonstrate how to determine whether a database is open
exclusively:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new module and add the following line to the Declarations
   section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Enter the following function in the module:
<P>
<P><PRE>      Function IsCurDBExclusive1x () As Integer
      ' Purpose: Determine if a database is open exclusively.
      ' Returns: 0 if the database is not open exclusively.
<PRE></PRE>      '          -1 if the database is open exclusively.
      '          Err if any error condition is detected.

        Dim hFile As Integer
        Dim DBName As String
        hFile = FreeFile

        'This is the name of the database to test.
        dbname = "C:\access\nwind.mdb"

        If Dir$(DBName) &lt;&gt; "" Then
          On Error Resume Next
            Open dbname For Binary Access Read Write Shared As hFile
              Select Case Err
                Case 0
                  IsCurDBExclusive1x = False
                Case 70
                  IsCurDBExclusive1x = True
                Case Else:
                  IsCurDBExclusive1x = Err
              End Select
            Close hFile
          On Error GoTo 0
        Else
          MsgBox "Couldn't find " &amp; dbname &amp; "."
        End If
      End Function

   NOTE: Set the variable DBName to the name of the database file that
   you want to test.

</PRE><P><LI>From the View menu, choose Immediate Window.

<P><LI>Type the following line in the Immediate window, and then press ENTER:
<P>
<P><PRE>      If IsCurDBExclusive1x()=True Then Msgbox "It's Exclusive!"
</PRE><P>
</OL>If the database named in the DBName variable is open exclusively, the
message "It's Exclusive!" will appear. If the database is open shared, the
message will not appear.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Language Reference," version 1.x, pages 343-345
<P>
For more information about accomplishing the same task in later versions of
Microsoft Access, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q117539.htm">Q117539</A></B>
   TITLE     : ACC: How to Determine If Database Is Open Exclusively
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : GnlMu kbusage<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
