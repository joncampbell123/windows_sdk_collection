

<HTML>
<HEAD>
<TITLE>ACC2: How to Attach All the User Tables on a SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123714">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1994/12/07">
<META NAME="Keywords" CONTENT="kbusage OdbcSqlms">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to use a SQL pass-through query to obtain a list of all the user tables located on a SQL Server, and then attach those tables.  This article assum...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA1S,QDN9,QBXS,QAH4,QBJZ,QA5F,QA39,QAUD,QAMA,QBXT,QA5V,QAY2,QAUJ,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: How to Attach All the User Tables on a SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123714</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to use a SQL pass-through query to obtain a list
of all the user tables located on a SQL Server, and then attach those
tables.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a SQL pass-through query to list and attach all the tables on a
SQL Server, follow these steps:

<OL><P><LI>Create a new query that is not based on any table.

<P><LI>From the Query menu, choose SQL Specific and then choose Pass-Through.

<P><LI>In the SQL Pass-Through Query window, type the following line:
<P>
<P><PRE>      SELECT name FROM sysobjects Where type = 'U';
</PRE><P>
   NOTE: If the SQL Server you will be using was installed with case
   sensitivity, you may have to type "Name" and "u" in uppercase letters.

<P><LI>From the View menu, choose Properties. Enter a complete ODBC
   connect string in the ODBCConnectStr property, or choose the
   Build button to select an ODBC data source. The following is an
   example of a valid ODBC connect string:
<P>
<P><PRE>      ODBCConnectStr: ODBC;DSN=opus;UID=john;PWD=steelers;DATABASE=pubs
</PRE>
<P><LI>Run the query to make sure that it returns one column called Name
   that lists the tables on the SQL Server.

<P><LI>Save the query as SQL_Tables and then close it.

<P><LI>Create a new module and then enter the following line in the
   Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Enter the following code in the module.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<P><PRE>      Function attach_all ()
<PRE></PRE>          Dim DB As Database
          Dim RS As Recordset
          Dim QD As QueryDef

          Set DB = DBEngine.Workspaces(0).Databases(0)
          ' Set the QueryDef variable to the pass-through query.
          Set QD = DB.OpenQueryDef("sql_tables")
          Set RS = DB.OpenRecordset(QD.name, DB_OPEN_SNAPSHOT)

          Do Until RS.EOF
              DoCmd TransferDatabase A_ATTACH, "&lt;Sql database&gt;", _
                   QD.connect, A_TABLE, RS!Name, RS!Name
              RS.MoveNext
          Loop

          RS.Close
          QD.Close

      End Function

</PRE><P><LI>To test the function, choose View from the Immediate window, type
   the following line in the Immediate window, and then press ENTER:
<P>
<P><PRE>      ? attach_all()
</PRE><P>
   All the tables on the SQL Server will be attached to the current
   database. The amount of time this process requires depends on the
   number of tables on the SQL Server.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about SQL pass-through queries, search for "pass-
through query," and then "Creating a SQL Pass-Through Query" using the
Microsoft Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage OdbcSqlms<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
