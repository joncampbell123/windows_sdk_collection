

<HTML>
<HEAD>
<TITLE>ACC: How to Call the Windows Help Search Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109826">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="kbprg PgmApi">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to call the Windows Help Search dialog box from within your Microsoft Access application using the WinHelp() and FindWindow() Windows API function...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAGI,QAY5,QDL9,QBWO,QBWN,QA5F,QAMA,QAH4,QBV8,QAB9,QBWQ,QAIF,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Call the Windows Help Search Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109826</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to call the Windows Help Search dialog box
from within your Microsoft Access application using the WinHelp() and
FindWindow() Windows API function calls.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual in Microsoft Access version
1.x, or the "Building Applications" manual, Chapter 3, "Introducing Access
Basic," in version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to activate the Search dialog box
with a sample Access Basic function called OpenHelpSearch(). This example
uses the Microsoft Access Help file:
<P>
NOTE: In the following sample code, an underscore (_) is used as a line-
continuation character. Remove the underscore from the end of the line when
re-creating this code in Access Basic.

<OL><P><LI>Enter the following lines in a new module's Declarations section:
<P>
<P><PRE>      Option Explicit
      Global Const HELP_PARTIALKEY = &amp;H105
      Declare Function WinHelp Lib "User" (ByVal hWnd As _
<PRE></PRE>         Integer, ByVal lpHelpFile As String, ByVal _
         wCommand As Integer, ByVal dwData As Any) As Integer
      Declare Function HC_FindWindow% Lib "user" Alias "FindWindow" _
         (ByVal lpClassName As Any, ByVal lpCaption As Any)

</PRE><P><LI>Create two procedures by entering the following code in the module:
<P>
<P><PRE>      Function OpenHelpSearch ()
<PRE></PRE>         Dim DummyVal$, Temp%
         DummyVal$ = ""
         Temp% = WinHelp(GetAccessHandle(),_
            "c:\Access\msaccess.hlp", HELP_PARTIALKEY, DummyVal$)
         'For version 2.0, replace Temp% = etc with the following:
         'Temp% = WinHelp(GetAccessHandle(),_
         '   "c:\Acc2\msacc20.hlp", HELP_PARTIALKEY, DummyVal$)
      End Function

      Function GetAccessHandle ()
         GetAccessHandle = HC_FindWindow("Omain", 0&amp;)
      End Function

</PRE><P><LI>Save the module as Search Help.

<P><LI>From the Run menu, choose Compile All.

<P><LI>Type the following in the module's Immediate window, and then press
   ENTER:
<P>
<P><PRE>      ? OpenHelpSearch()
</PRE><P>
</OL>When you call the OpenHelpSearch() function, the Windows API WinHelp()
function is called. The OpenHelpSearch() function passes the current
Microsoft Access handle, the name of the Help file, the command
HELP_PARTIALKEY and a null string to the WinHelp() function. You are then
prompted for a topic to search for. Note that you can call the
OpenHelpSearch() function from any command button.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Programming Windows: The Microsoft Guide to Writing Applications
for Windows 3," Charles Petzold, Microsoft Press, 1990
<P>
"Programmer's Reference Library: Microsoft Windows 3.1 Guide to
Programming Reference," Volumes 1-6, Microsoft Press, 1992
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprg PgmApi<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
