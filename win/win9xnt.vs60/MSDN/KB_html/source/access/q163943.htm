

<HTML>
<HEAD>
<TITLE>ACC97: IPF in Msjet35.dll Running Update Against Attached Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163943">
<META NAME="KBModify" CONTENT="1997/07/21">
<META NAME="KBCreate" CONTENT="1997/02/20">
<META NAME="Keywords" CONTENT="kberrmsg kbusage QryUpdat">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use a user-defined function in the Update To row of an update query based on an attached SQL Server table, you may receive the following error message:     MSACCESS caus...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAVX,QAVW,QBD2,QAC1,QBWS,QAUR,QAY5,QAH4,QABM,QBV8,QAB9,QAA5,QA5V,QA39 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: IPF in Msjet35.dll Running Update Against Attached Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163943</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use a user-defined function in the Update To row of an update
query based on an attached SQL Server table, you may receive the following
error message:
<P>
<PRE>   MSACCESS caused an invalid page fault in
   module MSJet35.DLL at 0137:040df209

</PRE><h2>RESOLUTION</h2>
 
<P>
There are two methods you can use to resolve this problem. In the first
method, you create a make table query with a user-defined function to
create a temporary table. You then create an update query based on the
temporary table and the SQL server table. In the second method, you
perform the update manually in code.
<P>
NOTE: Both methods assume you have an attachment to the Sales table in
the PUBS sample database within Microsoft SQL Server and a function called
Test(). To create the Test() function, follow these steps:

<OL><P><LI>Create a module and type the following line in the Declarations
   section if the line is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function Test(qtyVal As Integer) As Integer
<PRE></PRE>         Test = qtyVal + 10
      End Function

</PRE><P><LI>Close and save the module as modTest.
<P>
</OL><h3>Method 1</h3>
 

<OL><P><LI>Create the following query based on the dbo_Sales table:
<P>
<P><PRE>      Query: qryTemp
      -------------------------
      Type: Select
      Field: Stor_id
      Field: Ord_Num
      Field: Title_id
      Field: Expr1: Test([qty])
</PRE>
<P><LI>On the Query menu, click Make Table, and then in the Table Name box,
   type "tblTemp" (without the quotation marks). Click OK.

<P><LI>Save the query as qryTemp.

<P><LI>Run the qryTemp query and close it.

<P><LI>Create the following update query based on dbo_Sales and tbltemp tables:
<P>
<P><PRE>      Query: qryUpdate
      -------------------------------------------------
      Type: Update
      Join: tblTemp.[Stor_id] &lt;-&gt; dbo_Sales.[Stor_id]
      Join: tblTemp.[Ord_num] &lt;-&gt; dbo_Sales.[Ord_num]
      Join: tblTemp.[Title_id] &lt;-&gt; dbo_Sales.[Title_id]
      Field: [qty]
<PRE></PRE>         Table: dbo_Sales
         Update To: [tblTemp].[Expr1]

</PRE><P><LI>Save the query as qryUpdate

<P><LI>Run the query to update the qty field in the Sales SQL attached table.
<P>
</OL>NOTE: Whenever you need to run the qryUpdate update query, you must first
run the qryTemp query to generate an updated tblTemp table.
<P>
<P><h3>Method 2</h3>
 

<OL><P><LI>Create a module and type the following line in the Declarations
   section if the line is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function UpdateId()
<PRE></PRE>         Dim MyDb as Database
         Dim MyRS as RecordSet
         Dim MyVar as Long
         Set MyDb = CurrentDB()
         Set MyRS = MyDB.OpenRecordset("dbo_sales",dbOpenDynaset)
         MyRS.MoveFirst
         Do While Not MyRS.EOF
            MyVar = Test([MyRS![qty])
            MyRS.Edit
            MyRS![qty] = MyVar
            MyRS.Update
         Loop
         MyRS.Close
      End Function

</PRE><P><LI>Close and save this module as modUpdateSQL

<P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ?UpdateID()
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97.
We are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new database, and then on the File Menu, point to Get External
   Data, and click Link Tables.

<P><LI>From the Files Of Type list, click ODBC Databases(), select the SQL
   Server Data Source, and then click OK.

<P><LI>Click Options and type Pubs in the Database box, and click OK.

<P><LI>Select the Sales table from the list, and then click OK.

<P><LI>Create a module and type the following line in the Declarations
   section if the line is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function Test(MyVar as Long) as Long
<PRE></PRE>         Test = MyVar /1
      End Function

</PRE><P><LI>Close and save the module as Module1.

<P><LI>Create the following query based on the dbo_Sales table:
<P>
<P><PRE>      Query: qryTest
      --------------------
      Type: Update
      Field: [qty]
      Update To: Test(qty)
</PRE>
<P><LI>Close and save this query as qryTest.
<P>
   Note that when you run the qryTest update query, you receive the error
   message mentioned in the "Symptoms" section.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage QryUpdat<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
