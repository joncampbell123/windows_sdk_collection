

<HTML>
<HEAD>
<TITLE>ACC1x: How to Get Record Position Number from Record Selector </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103260">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1993/08/19">
<META NAME="Keywords" CONTENT="JetRS kbprg PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft Access does not provide a way to retrieve the position number found in the record selector at the bottom of the form or datasheet.  This article demonstrates a sam...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QACI,QA1S,QBTV,QAJP,QDMH,QDN9,QAKC,QAY5,QBC6,QA5F,QAMA,QAG8,QBXS,QBT6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Get Record Position Number from Record Selector</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103260</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Access does not provide a way to retrieve the position number
found in the record selector at the bottom of the form or datasheet.
<P>
This article demonstrates a sample user-defined Access Basic function
called GetRecordPosition() that you can use to retrieve the current record
position. This article also explains how to use the GetRecordPosition()
function to create your own custom record position box on a form.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual in Microsoft Access version
1.x.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The number that appears in the record selector is actually not a record
number. It is a number used to indicate the record's relative position in
the current record set, not the record's natural position in the table.
<P>
The following Access Basic function, GetRecordPosition(), can be used to
get the record's relative position in the record set. Add this function to
a new or existing module.
<P>
<PRE>   'Global Declaration Section
   Option Explicit


   '***************************************************************
   ' FUNCTION: GetRecordPosition
   '
   ' PURPOSE:
   '   Gets the number representing the relative position of the
   '   record in the currently active form. This is the number that
   '   appears in the record selector found at the bottom of a form
   '   or datasheet.
   '
   ' RETURN:
   '   The relative record position. If there are no records in
   '   the active form's dynaset, or if there is no active form,
   '   Null is returned.
   '

   '***************************************************************
   Function GetRecordPosition ()
       Const ERR_NO_CURRENT_RECORD = 3021
       Dim DS As Dynaset
       Dim RecordPos As Long

       On Error GoTo Err_GetRecordPosition

       Set DS = Screen.ActiveForm.Dynaset
       DS.Bookmark = Screen.ActiveForm.Bookmark
       RecordPos = 0

       While Not DS.BOF
           DS.MovePrevious
           RecordPos = RecordPos + 1
       Wend

       GetRecordPosition = RecordPos

   Bye_GetRecordPosition:
       Exit Function

   NoCurrentRec_GetRecordPosition:
       On Error Resume Next
       DS.MoveLast
       If Err &lt;&gt; 0 Then
           ' There must be no records in the set, so new record is 1.
           GetRecordPosition = 1
       Else
           ' We are on last record of set, so count + 1.
           GetRecordPosition = DS.RecordCount + 1
       End If
       GoTo Bye_GetRecordPosition

   Err_GetRecordPosition:
       Select Case Err
           Case ERR_NO_CURRENT_RECORD
               Resume NoCurrentRec_GetRecordPosition
           Case Else
               Resume Bye_GetRecordPosition
       End Select
   End Function

</PRE><h3>Creating a Record Position Box on a Form</h3>
 
<P>
Use the following steps to create your own custom record position box on a
form using the GetRecordPosition() function:

<OL><P><LI>Create a new macro called Refresh Record Position with the
   following macro action:
<P>
<P><PRE>      Requery
<PRE></PRE>         ControlName: Record Position

</PRE><P><LI>Open the form in Design view. Make sure that the Form Hdr/Ftr
   option is selected on the Layout menu.

<P><LI>Create a text box in the footer with the following properties:
<P>
<P><PRE>      Name: Record Position (ControlName: Record Position in version 1.x)
      ControlSource: =GetRecordPosition()
</PRE>
<P><LI>Set the following properties on the form (not on the control):
<P>
<P><PRE>      OnCurrent: Refresh Record Position
      AfterUpdate: Refresh Record Position
</PRE><P>
   The current record position will be displayed in the text box in the
   footer of the form either when you navigate to a different record
   or when a new record is created.
<P>
   NOTE: The AfterUpdate property of the form is set in the event a
   new record is created and written to disk. The current record
   position may need to account for this new record.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: vcr<BR>
Keywords            : JetRS kbprg PgmObj<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
