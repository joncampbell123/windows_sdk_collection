

<HTML>
<HEAD>
<TITLE>ACC95: "Table '&lt;name&gt;' already Exists" Make-Table Query Err Msg </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140635">
<META NAME="KBModify" CONTENT="1997/07/21">
<META NAME="KBCreate" CONTENT="1995/12/04">
<META NAME="Keywords" CONTENT="kberrmsg QryMktbl">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you try to run a make-table parameter query more than once, you may receive the following error message and the query may not create the table:     Table '      ' already ex...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHD,QBWS,QAHE,QACF,QA1S,QAB4,QARR,QAVX,QAVW,QAEF,QDN9,QAY5,QAUJ,QAD7,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: "Table '&lt;name&gt;' already Exists" Make-Table Query Err Msg</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140635</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you try to run a make-table parameter query more than once, you may
receive the following error message and the query may not create the
table:
<P>
<PRE>   Table '&lt;name&gt;' already exists.

</PRE>NOTE: This also occurs in Microsoft Access 97 if the database is converted
from Microsoft Access 2.0 and the table already exists.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If a make-table parameter query creates a table with the same name as an
existing table, try one of these methods to avoid the error message
mentioned in the "Symptoms" section:

<UL><LI>Delete the existing table before running the query. If you want to
   automate this process, you can create a custom function to test for
   an existing table. If a table already exists, you can delete the table
   and then create a new table by running the make-table query.

<LI>Run a delete query that removes all records from the existing
   table followed by an append parameter query to add records to the
   empty table.

<LI>Open the make-table parameter query in Design view and modify it
   as follows:
<P>
<P><PRE>    1. Remove all explicitly defined parameters from the query. To do so,
       click Parameters on the Query menu, and then delete any items
       listed in the Parameters box.
</PRE><P>
<P><PRE>    2. In the query design grid, enclose the parameters within an Eval()
       function. For example:
</PRE><P>
<PRE>          Field: OrderID
             Table: Orders
             Criteria: =Eval("Forms!Form1!OrderID")

    3. Run the query. Note that you receive a message that says the table
       already exists and that asks if you want to continue. You can click
       Yes to overwrite the existing table.

</PRE><LI>Create a custom function using Visual Basic for Applications that
   returns the value of a parameter. Then, you can call the function
   from the make-table query, which passes the parameter value to the
   query when it is run. For example, to pass a long integer value (from
   a form) as a parameter, follow these steps:
<P>
<P><PRE>    1. Create a module and type the following procedure:
</PRE><P>
<PRE>          Function ReturnID() As Long
             ReturnID=Forms!Orders!OrderID
          End Function

    2. Open the make-table parameter query in Design view.

    3. Replace the parameter in the criteria row with the ReturnID()
       function:

          Field: OrderID
             Table: Orders
             Criteria: =ReturnID()

    4. Run the query. Note that you receive a message that says the table
       already exists and that asks if you want to continue. Click Yes to
       overwrite the existing table.

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 7.0. This
problem no longer occurs in Microsoft Access 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This error message does not occur with nonparameter make-table
queries. When you run a typical make-table query more than once, you
receive the following confirmation message:
<P>
<PRE>   The existing table '&lt;table name&gt;' will be deleted before you run
   the query. Do you want to continue anyway?

</PRE>If you click Yes, the query overwrites the existing table.
<P>
Also, note that the SetWarnings Action or Method cannot be used to
suppress the error message:
<P>
<PRE>   Table '&lt;name&gt;' already exists

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Copy the Sales By Year query and name it Make Table Test.

<P><LI>Open the Make Table Test query in Design view.

<P><LI>On the Query menu, click Make Table.

<P><LI>In the Make Table box, enter the name Test Table and click OK.

<P><LI>On the Query menu, click Run.

<P><LI>In the "Forms!Sales by Year Dialog!BeginningDate" box, type 1/1/94 and
    click OK.

<P><LI>In the "Forms!Sales by Year Dialog!EndDate" box, type 12/31/94 and
    click OK.

<P><LI>When you are asked "Are you sure you want to create a new table with
    selected records?" click Yes.

<P><LI>Repeat steps 6-8. Note that you receive the message:
<P>
       Table 'Test Table' already exists.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about make-table queries, search on the phrase "make
table," and then view "Create a new table from the results of a query with
a make-table query" using the Answer Wizard from the Microsoft Access for
Windows 95 Help menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: conversion<BR>
Keywords            : kberrmsg QryMktbl<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
