

<HTML>
<HEAD>
<TITLE>ACC: How to Make a Combo Box Default to First Item in List </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105519">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1993/10/20">
<META NAME="Keywords" CONTENT="FmsCmbo kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you move to a new record on a form that has a combo box or a list box, the combo box will be blank or the list box will not have any value selected. The combo box or list bo...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QDN9,QBVR,QA5V,QAY5,QAE1,QA5F,QAMA,QAGU,QAUD,QBJZ,QAB9,QBXS,QBV3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Make a Combo Box Default to First Item in List</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105519</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you move to a new record on a form that has a combo box or a list box,
the combo box will be blank or the list box will not have any value
selected. The combo box or list box may have a table or query defined in
its RowSource property that provides the list of items to be displayed in
the box. Because the data in the underlying RowSource property will vary
with the addition or deletion of records, it is difficult to know what item
will appear at the top of the list when the form is used.
<P>
This article describes how to force a list box or combo box to default to
the first row in the underlying list. The methods outlined in this article
work only if the combo box is bound to a field.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual in Microsoft Access version
1.x, or the "Building Applications" manual, Chapter 3, "Introducing Access
Basic," in version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Microsoft Access Version 2.0</h3>
 
<P>
In Microsoft Access version 2.0, you can use the ItemData method to cause a
list box or combo box to default to any row. To have the first row selected
automatically, set the box's DefaultValue property as follows:
<P>
<PRE>   =[&lt;MyCombo&gt;].[ItemData](0)

</PRE>NOTE: When the field names in a combo box are used as column headings the
syntax would be as follows:
<P>
<PRE>         =[&lt;MyCombo&gt;].[ItemData](1)

</PRE><h3>Microsoft Access Version 1.x</h3>
 
<P>
The first method below uses a user-defined Access Basic function, and the
second method uses the built-in DLookUp() function to display the first
value in the list automatically.
<P>
Method 1:
<P>
The following example demonstrates a sample Access Basic function called
GetFirst() that can be used to find the first item in the underlying
table or query. The function's result can be used by the DefaultValue
property to automatically select the first item in the list.
<P>
To create the GetFirst() function, add the following lines to a new or
existing module:
<P>
<PRE>   Option Explicit

   Function GetFirst (BoundColName As String, RowSource As String)
      Dim DB As Database
      Dim DS As Dynaset

      Set DB = CurrentDB()
      Set DS = DB.CreateDynaset(RowSource)

      On Error Resume Next
      DS.MoveFirst
      If Err = 0 Then GetFirst = DS(BoundColName)

   End Function

</PRE>Note that the first argument of the GetFirst() function is the name of
the field that is used as the BoundColumn property for the combo box. The
second argument is the name of the table or query specified in the
RowSource property of the combo box.
<P>
The following example demonstrates how to use the GetFirst() function to
automatically select the first employee in the Salesperson combo box on the
Orders form in the sample database NWIND.MDB:

<OL><P><LI>Open the Orders form in Design view.

<P><LI>Select the Salesperson combo box. Display the property sheet by
   choosing Properties from the View menu.

<P><LI>Set the DefaultValue property to the following expression:
<P>
<P><PRE>      =GetFirst("Employee ID", "Employee List")
</PRE>
<P><LI>View the form in Form view.

<P><LI>From the Records menu, choose Data Entry.
<P>
</OL>Note that the combo box automatically displays "Buchanan, B.L."
<P>
Differences Between GetFirst() and DFirst():
<P>
The GetFirst() function is similar to the built-in DFirst() aggregate
(totals) function. However, DFirst() may return unexpected results when
used to find the first item in a list.
<P>
If the underlying table or query is indexed, the value returned by DFirst()
will be the first indexed record. Otherwise, DFirst() will return items in
the actual order in which they were entered in the database. Therefore, if
the RowSource property of a combo box is a query that sorts the data by a
non-indexed field, DFirst() may not return the expected value.
<P>
For example, if you change the DefaultValue property of the Salesperson
combo box on the Orders form to
<P>
<PRE>   =DFirst("[Employee ID]", "Employee List")

</PRE></OL>the item returned will be "Davolio, Nancy," which is not the first item in
the combo box, but the first indexed item in the Employees table.
<P>
Method 2:
<P>
This method uses the DLookUp() function to look up the first record in the
list. The expression will be the field referred to in the BoundColumn
property (or the ControlSource property) of the combo box or list box. The
domain will be the same table or query that the combo box or list box uses
as its RowSource property. The optional criteria will not be used so that
the DLookUp() function will return the first record.
<P>
The following example demonstrates how to use DLookUp() to automatically
select the first employee in the Salesperson combo box on the Orders form
in the sample database NWIND.MDB:

<OL><P><LI>Open the Orders form in Design view.

<P><LI>Select the Sales Person combo box. View the property sheet by choosing
   Properties from the View menu.

<P><LI>Set the DefaultValue property to the following expression:
<P>
<P><PRE>      =DLookUp("[Employee ID]","Employee List")
</PRE>
<P><LI>View the form in Form view.

<P><LI>From the Records menu, choose Data Entry.
<P>
   Note that the combo box automatically displays "Buchanan, B.L."
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the ItemData method, search for "ItemData," and
then "ItemData Method" using the Microsoft Access Help menu.
<P>
Microsoft Access "User's Guide," version 1.0, Chapter 9, "Designing Forms,"
pages 233-242
<P>
Microsoft Access "User's Guide," version 1.1, Chapter 9, "Designing Forms,"
pages 237-246
<P>
Microsoft Access "Language Reference," versions 1.0 and 1.1, pages 131-132,
139-140, and 144-146
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: listbox combobox<BR>
Keywords            : FmsCmbo kbusage<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
