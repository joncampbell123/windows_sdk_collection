

<HTML>
<HEAD>
<TITLE>ACC: Calling RegQueryValue() to Get an OLE Object Class Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99322 ">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1993/05/26">
<META NAME="Keywords" CONTENT="IntpOle kbole kbprg PgmApi">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The RegQueryValue() function, found in the Microsoft Windows SHELL.DLL file, uses an OLE ClassKey (such as PBRUSH or MSGRAPH) to obtain the information about that class from...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QA9Q,QAPN,QAW6,QDL9,QBWO,QBWN,QAB9,QBV8,QAD7,QA1S,QAUJ,QATX,QAH7,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Calling RegQueryValue() to Get an OLE Object Class Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99322 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The RegQueryValue() function, found in the Microsoft Windows SHELL.DLL
file, uses an OLE ClassKey (such as PBRUSH or MSGRAPH) to obtain
the information about that class from the REG.DAT file.
<P>
This article describes the way the RegQueryValue() function obtains the
Object Class Name from the OLE Registration Database REG.DAT file.
<P>
Although only the procedure to obtain the Object Class Name is described
here, other information, including the current location of the OLE
server and the types of &lt;Primary VERBS&gt; available to the object, is
also available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: In the following sample code, an underscore (_) is used as a
line-continuation character. Remove the underscore from the end of the line
when re-creating this code in Access Basic.
<P>
<PRE>   Declare Function RegQueryValue Lib "shell" (ByVal hkey&amp;, _
      ByVal SubKeyStr$, ByVal QueryStr$, Buffsize&amp;) As Long

   Function GetObjectName$ (TheClassKey$)
      Dim ClassName$
      ClassName$ = Space$(255)
      X&amp; = CLng(Len(ClassName$))
      cb = RegQueryValue(1, TheClassKey$, ClassName$, X&amp;)
      GetObjectName$ = ClassName$
   End Function

</PRE>The sample function above declares a string to pass as a parameter for a
return value in the RegQueryValue() function. RegQueryValue() has the
following four parameters:
<P>
<PRE>   HKEY:        The handle to a key that defines what type of
                information you want to retrieve

   lpszSubKey:  A string that contains the OLE ClassKey that you want
                to look up

   lpszValue:   A string in which to place the resulting value

   lpcb:        The maximum length of the resulting string

</PRE>To use the sample function GetObjectName(), create a control on a form with
the following properties:
<P>
<PRE>   ControlName: &lt;ObjName&gt;
   ControlSource: =GetObjectName ("PBRUSH")

</PRE>Any appropriate OLE ClassKey in the REG.DAT OLE database can be passed
to the function.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about finding the ClassKey of an embedded object,
please see the following article here in the Microsoft Knowledge Base:
<P>
<PRE>    ARTICLE-ID: <B><A href="../access/q99319.htm">Q99319</A></B>
    TITLE:      ACC: Finding the OLE ClassKey of an Embedded Object (1.x,
                2.0)

</PRE>Microsoft Windows "Programmer's Reference," version 3.1, Volume 2,
page 282
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: classname class key<BR>
Keywords            : IntpOle kbole kbprg PgmApi<BR>
Technology          : kbole<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
