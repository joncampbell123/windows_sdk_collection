

<HTML>
<HEAD>
<TITLE>ACC1x: Preventing Users from Adding New Records </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100465">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1993/06/22">
<META NAME="Keywords" CONTENT="FmsHowto kbprg PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  The DefaultEditing form property, when set to AllowEdits, allows users to both modify existing records and to add new records. Microsoft Access has no built-in mechanism to prevent users from adding new records.  MORE INFORMATION  The following exa...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAY5,QA1S,QAGU,QDMH,QBV8,QAB9,QBVV,QDN9,QA5F,QA5E,QAVX,QAVW,QAPN,QAML V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Preventing Users from Adding New Records</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100465</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The DefaultEditing form property, when set to AllowEdits, allows users to
both modify existing records and to add new records. Microsoft Access has
no built-in mechanism to prevent users from adding new records.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates a sample, user-defined Access Basic
function that you can use to prevent users from entering new employees in
the Employees form in the sample database NWIND.MDB:

<OL><P><LI>Type the following Access Basic function in a new or existing
   module:
<P>
<P><PRE>      Function PreventNew ()
<PRE></PRE>         Dim X
         On Error Resume Next
         X = Screen.ActiveForm.Bookmark
         If Err = 3021 Then DoCmd GoToRecord , , A_LAST
      End Function

   NOTE: There are two commas between GoToRecord and A_LAST above.

</PRE><P><LI>Change the OnCurrent property of the Employees form to read as
   follows:
<P>
<P><PRE>      Form: Employees
      ----------------------------
<PRE></PRE>         OnCurrent:  =PreventNew()

   Note that the pointer is placed in the last record of the Employees form
   when you attempt to gain access to or navigate to the new record.

</PRE></OL><h3>How PreventNew() Works</h3>
 
<P>
Whenever you navigate to a different record, the OnCurrent property runs
the PreventNew() function. This function attempts to reference the Bookmark
property associated with the current record. All records are assigned a
string, called a bookmark, that uniquely identifies each record.
<P>
However, a new record that has not yet been saved has no bookmark
associated with it. Any attempt to reference the bookmark of a new
record generates an error message. If an error occurs, the
PreventNew() function immediately performs a GoToRecord action to
navigate to the last record in the form.
<P>
Using PreventNew() with Forms That Contain No Records
 
<P>
If the table or query that the form is based on contains no records,
PreventNew() does not prevent you from adding a new record to the form. You
must first test to see if records exist in the table or query prior to
opening the form. You can use the following Access Basic function to test
whether records exist in a table or query.
<P>
<PRE>      Function RecordsExist (TableQueryName As String)
         Dim DB As Database
         Dim DS As Dynaset
         Set DB = CurrentDB()
         On Error Resume Next
         Set DS = DB.CreateDynaset(TableQueryName)
         DS.MoveFirst
         If Err &lt;&gt; 0 Then
             RecordsExist = False
         Else
             RecordsExist = True
         End If
     End Function

</PRE>Given the name of the table or query, this function will return True (-1)
if records exist, or False (0) if no records exist.
<P>
Another method you can use is the DCount() function. However, the DCount()
function may be significantly slower than the RecordsExist() function in
that it must count all the records in the database whereas RecordsExist
simply tests to see if there is a "first" record in the recordset.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsHowto kbprg PgmObj<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
