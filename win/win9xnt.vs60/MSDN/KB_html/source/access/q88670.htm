

<HTML>
<HEAD>
<TITLE>ACC: Fill Record w/ Data from Prev. Record Automatically 1.x/2.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88670 ">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/08/11">
<META NAME="Keywords" CONTENT="GnlDe kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you are creating new records using a form, you may want to speed the data entry process by having fields in the new record fill automatically with values from the previous r...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBCF,QAM3,QA7O,QA7N,QBCE,QBT6,QBV4,QAY2,QAHP,QA1S,QAY5,QAM2,QDMH,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Fill Record w/ Data from Prev. Record Automatically 1.x/2.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88670 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you are creating new records using a form, you may want to speed the
data entry process by having fields in the new record fill automatically
with values from the previous record. This article demonstrates a sample
Access Basic function called AutoFillNewRecord() that enables you to
automatically fill selected fields, or all fields, in a new record with
values from the previous record.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
One technique to speed up repetitive data entry for the field containing
the insertion point is to press CTRL+APOSTROPHE (') to retrieve the value
from the previous record.
<P>
Another technique is to use the AutoFillNewRecord()function described
below. You can call this function from a form's OnCurrent property to fill
all the fields in a new record using data from the previous record. If you
want to fill only selected fields, you can create an unbound text box and
set the DefaultValue property with a semicolon-delimited list of field
names to automatically fill. For example:
<P>
<PRE>   Text box:
      Name: AutoFillNewRecordFields
      Visible: No
      DefaultValue: Phone;Company Name;City;State;Zip

</PRE>To create and use the AutoFillNewRecord() function, follow these steps:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a module and add the following line to the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure appropriate for your version of Microsoft
   Access:
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code.
<P>
<P><PRE>      Function AutoFillNewRecord (F As Form)
<PRE></PRE>         Dim RS As Dynaset
         Dim I As Integer, RetVal
         Dim FillFields As String, FillAllFields As Integer

      On Error Resume Next

         ' Exit if we are not on the new record.
         RetVal = F.Bookmark
         If Err = 0 Then Exit Function
         Err = 0

         ' Go to the last record of the form recordset (to autofill from).
         Set RS = F.Dynaset
         RS.MoveLast

         ' Exit if we cannot move to the last record (no records).
         If Err &lt;&gt; 0 Then Exit Function

         ' Get the list of fields to auto fill.
         FillFields = ";" &amp; F![AutoFillNewRecordFields] &amp; ";"

         ' If there is no criteria field, then set flag indicating
         ' ALL fields should be auto filled.
         FillAllFields = Err &lt;&gt; 0

         DoCmd Echo False

            ' Visit each field on the form.
            For I = 0 To F.Count - 1
            ' Fill the field if ALL fields are to be filled OR if the
            ' ControlSource field can be found in the FillFields list.
            If FillAllFields Or InStr(FillFields, ";" &amp; F(I).ControlName _
                &amp; ";") &gt; 0 Then
                  F(I) = RS(F(I).ControlSource)
            End If
         Next

         DoCmd Echo True

      End Function

</PRE><P><LI>Open the Customers form in Design view. Change the form's OnCurrent
   property as follows:
<P>
<P><PRE>      =AutoFillNewRecord([Form])
</PRE>
<P><LI>Add an unbound text box to the form with the following properties:
<P>
<P><PRE>      ControlName: AutoFillNewRecordFields
      Visible: No
      DefaultValue: Company Name;Contact Name;Contact Title;Address
</PRE><P>
</OL>When you move to a new record, the Company Name, Contact Name, Contact
Title, and Address fields are filled in automatically. If you want all
fields to fill in automatically, you can leave the DefaultValue property
blank or omit putting the AutoFillNewRecordField text box on your form.
<P>
For information on how to do this in Microsoft Access 7.0 and 97, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q136127.htm">Q136127</A></B>
   TITLE     : ACC: Fill Record w/Data from Prev. Record Automatically
               (95, 97)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: duplicate copy carry forward keep<BR>
Keywords            : GnlDe kbusage<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
