

<HTML>
<HEAD>
<TITLE>ACC: "#ERROR" Msg When Referencing Subreport Controls 95/97 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138906">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1995/10/30">
<META NAME="Keywords" CONTENT="RptSub kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you reference a subreport control from a main report when the subreport does not return any matching records, you may receive a  #ERROR  message for the referenced subreport c...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA1S,QAB4,QAPN,QDN9,QA7N,QAY5,QA5V,QAUD,QAPF,QAMN,QAMA,QAB5,QBT6,QBV4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: "#ERROR" Msg When Referencing Subreport Controls 95/97</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138906</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you reference a subreport control from a main report when the subreport
does not return any matching records, you may receive a "#ERROR" message
for the referenced subreport control.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>CAUSE</h2>
 
<P>
When the subreport has no data, it is not available. Referencing an empty
subreport results in an invalid operation.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure that subreport fields referenced in a main report contain data by
adding a function to test for this condition. See the "Steps to Reproduce
Behavior" and "Steps to Work Around Behavior" sections later in this
article for an example of such a function.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a new query based on the Customers table. Drag the CompanyName
    field from the field list to the query grid. Type the following line
    in the Criteria field for the column:
<P>
       Like "P*"
<P>
    Drag the CustomerID field from the field list to the next column on
    the query grid. Save the query as Sorter. Note that this query limits
    the recordset only to customer records beginning with the letter
    "P" and includes a customer with no orders.

<P><LI>Create a new subreport based on the Orders table and name it SubRpt.

<P><LI>Drag the Freight field to the detail section of the subreport. In the
    report footer section, add a text box and set the control's
    properties as follows:
<P>
       ControlSource: =Sum([Freight])
       ControlName: TotFreight.
<P>
    The subreport prints the detailed freight items with a grand total for
    all freight charges.

<P><LI>Create a new report based on the Sorter query and name it Main Report.

<P><LI>On the View menu, click Sorting And Grouping. Click CompanyName in the
    Field/Expression box and set the GroupHeader property to Yes.

<P><LI>Drag the CompanyName field to the new CompanyName header section.

<P><LI>Drag the SubRpt subreport from the Database window to the detail
    section of Main Report. Below the subreport, add a label and set
    its Caption property as follows:
<P>
       Total Order Amount Per Customer:

<P><LI>Add a text box and set its ControlSource property as follows:
<P>
       =([SubRpt].Report![TotFreight])

<P><LI>Set both the LinkMasterFields and the LinkChildFields properties
    for the subreport control to CustomerID. Setting these properties
    filters the subreport to display the Freight charges for each customer.

<P><LI>Preview the report. Note that "#ERROR" is displayed for the references
    to the subreport control for Paris Specialties, which has no orders.
<P>
</OL><h3>Steps to Work Around Behavior</h3>
 
<P>
To test that subreport fields referenced in a main report contain data,
follow these steps:

<OL><P><LI>Replace the line
<P>
<P><PRE>      =([SubRpt].Report![TotFreight])
</PRE><P>
   in step 9 above with the following line
<P>
<P><PRE>      =IIF([SubRpt].Report.HasData=True, [SubRpt].Report![TotFreight], 0)
</PRE>
<P><LI>Preview the report.
<P>
</OL>Note that a zero value is displayed for Paris Specialties instead of the
"#ERROR" message. The HasData property of the subreport returns True or
False. You can use this property to eliminate the "#ERROR" message by
returning a zero if the HasData property returns a False.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the HasData property, search the Help Index for
"HasData Property," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pound error<BR>
Keywords          : RptSub kberrmsg kbusage<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
