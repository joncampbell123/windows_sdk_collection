

<HTML>
<HEAD>
<TITLE>ACC97: Incorrect Records in Query Exported to File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181329">
<META NAME="KBModify" CONTENT="1998/03/03">
<META NAME="KBCreate" CONTENT="1998/02/18">
<META NAME="Keywords" CONTENT="IsmExl5 IntpOthr kbdta">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you modify an existing query and then export it to another file format without saving it, the expected data may not appear in the resulting file. For example, this behavior ca...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3P,QA5V,QAUR,QBTI,QBVP,QBWS,QA1S,QAU7,QDN9,QACF,QBJZ,QA7O,QA7N,QAUD,QAPN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Incorrect Records in Query Exported to File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181329</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you modify an existing query and then export it to another file format
without saving it, the expected data may not appear in the resulting file.
For example, this behavior can occur when you export a query to a text file
(*.txt), to Microsoft Excel 97 (*.xls), or to a dBASE file format (*.dbf).
<P>
<P><h2>CAUSE</h2>
 
<P>
When you export a query, Microsoft Access uses the SQL property of the
QueryDef object to determine which records and fields should be exported.
Modifications that you make to a query exist in a temporary object until
you save the query. At that time, the SQL property of the QueryDef object
is updated.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Save the query before you export it to another file format.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
<PRE>  1. Start Microsoft Access and open the sample database Northwind.mdb.

  2. Create the following query based on the Shippers table:

       Query: qryExportTest
       --------------------
       Type: Select Query

       Field: ShipperID
          Table: Shippers
       Field: CompanyName
          Table: Shippers
       Field: Phone
          Table: Shippers

  3. Save the query as qryExportTest.

  4. On the Query menu, click Run. Note that the query returns three
     records.

  5. On the View menu, click Design View and add the following criteria to
     the ShipperID field:

       &lt;&gt; 3

  6. Run the query without saving it. Note that the query returns two
     records.

  7. On the File menu, click Save As/Export.

  8. In the Save As dialog box, click "To an External File or Database,"
     and then click OK.

  9. In the Save In dialog box, click Microsoft Excel 97(*.xls) in the Save
     As Type list.

 10. In the File Name box, type "qryExportTest.xls" (without the quotation
     marks), and then click Export.

 11. Start Microsoft Excel and open qryExportTest.xls. Note that in
     addition to the column names, the spreadsheet contains three records
     instead of the two records returned by the unsaved query.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about exporting, search the Help Index for "exporting
data" and display the topic "Export data to another database or file
format," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prb results missing not there<BR>
Keywords          : IsmExl5 IntpOthr kbdta<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
