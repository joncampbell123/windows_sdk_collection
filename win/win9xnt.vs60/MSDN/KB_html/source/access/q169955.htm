

<HTML>
<HEAD>
<TITLE>ACC: Parameter Query Returns No Records w/ Replication ID Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169955">
<META NAME="KBModify" CONTENT="1997/06/12">
<META NAME="KBCreate" CONTENT="1997/06/11">
<META NAME="Keywords" CONTENT="kbusage QryParm">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you run a query based on a table that contains an AutoNumber field, and the field size of the AutoNumber field is set to Replication ID, no records are returned.  CAUSE ====...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBC6,QA5V,QA7O,QA7N,QAKC,QAHE,QA28,QAUR,QATJ,QAG8,QBWS,QA4H,QAFO,QAUD,QACF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Parameter Query Returns No Records w/ Replication ID Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169955</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you run a query based on a table that contains an AutoNumber field,
and the field size of the AutoNumber field is set to Replication ID, no
records are returned.
<P>
<P><h2>CAUSE</h2>
 
<P>
The query is using an implicit parameter for criteria on the AutoNumber
field, and the AutoNumber field is not indexed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two methods to work around this problem. You can create an index
on the AutoNumber field in the table, or you can explicitly define the
parameter within the query.
<P>
<P><h3>Method 1 - Creating an Index on the AutoNumber Field</h3>
 

<OL><P><LI>Open the table in Design view.

<P><LI>Click in the row containing the AutoNumber field.

<P><LI>Under Field Properties, click the General tab.

<P><LI>Set the Indexed property of the AutoNumber field to either "Yes
   (Duplicates OK)" or "Yes (No Duplicates)".

<P><LI>Save the table and close it.
<P>
</OL><h3>Method 2 - Explicitly Defining the Parameter</h3>
 

<OL><P><LI>Open the query in Design view.

<P><LI>On the Query menu, click Parameters.

<P><LI>In the Query Parameters dialog box, type the name of the parameter in
   the Parameter column, and then select Replication ID in the Data Type
   column. For example, if the parameter that the query is expecting is
   [Forms]![Form1]![Field1], then the Query Parameters dialog box should
   appear as follows:
<P>
<PRE>      Parameter                   Data Type
      ------------------------    --------------
      [Forms]![Form1]![Field1]    Replication ID

</PRE><P><LI>Click OK to close the Query Parameters dialog box.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 7.0 and
97. We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create the following new table:
<P>
<P><PRE>      Table: Table1
      --------------------------
      Field Name: Field1
      Data Type: AutoNumber
      Field Size: Replication ID
      Indexed: No
</PRE><P>
<P><PRE>      Field Name: Field2
      Data Type: Text
      Field Size: 50
      Indexed: No
</PRE>
<P><LI>Close and save the table. When you see a message asking if you want to
   create a primary key, click No.

<P><LI>Using the Autoform: Columnar Wizard, create a new form based on
   the Table1 table.

<P><LI>Type some text in the Field2 field so that a new Replication ID is
   entered into the first record.

<P><LI>On the Records menu, click Save Record to save the new record. Do not
   move the form to a new record.

<P><LI>Save the form as Form1. Do not close the form.

<P><LI>Create the following new query based on the Table1 table, and open it in
   Design view:
<P>
<P><PRE>      Query: Query1
      ----------------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: Field1
      Table: Table1
      Criteria: [Forms]![Form1]![Field1]
</PRE><P>
<P><PRE>      Field: Field2
      Table: Table1
</PRE>
<P><LI>Run the query. Note that no records are returned, even though the form's
   current record contains a Replication ID that exists in the table.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about Replication ID AutoNumbers, search the
Help Index for "Replication IDs, AutoNumber fields" and then select
"AutoNumber fields and replication."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage QryParm<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
