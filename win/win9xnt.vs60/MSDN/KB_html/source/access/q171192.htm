

<HTML>
<HEAD>
<TITLE>ACC: DAO Version Property Returns "3.0" for Jet 3.5 Databases </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171192">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1997/07/09">
<META NAME="Keywords" CONTENT="kbcode MdlDao">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The DAO Version property of a Microsoft Jet 3.5 database object in a Microsoft Jet workspace returns  3.0  even though the DAO Version property of the DBEngine object return...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAUD,QAPN,QAZV,QDN9,QALW,QBS0,QAY5,QAC1,QAH4,QBWC,QAVX,QATX,QBVV,QA4F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: DAO Version Property Returns "3.0" for Jet 3.5 Databases</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171192</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The DAO Version property of a Microsoft Jet 3.5 database object in a
Microsoft Jet workspace returns "3.0" even though the DAO Version property
of the DBEngine object returns "3.5."
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR
OWN RISK. Microsoft provides this code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The DAO Version property returns the version of Microsoft Jet that created
the database. The Microsoft Jet database file format did not change from
Microsoft Jet 3.0 to 3.5; therefore, the Version property always "3.0".
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Because the Version property of DAO cannot distinguish between databases
created with Microsoft Jet 3.0 and Microsoft Jet 3.5, you can determine
which version of Microsoft Jet created the database by determining which
version of Microsoft Access was used to create or convert the database. To
determine which version of Microsoft Access created the database, you can
use the AccessVersion property.
<P>
NOTE: The AccessVersion property is unsupported and subject to change in
future releases of Microsoft Access.
<P>
The AccessVersion property is not a native Microsoft Jet property, but an
application property specific to Microsoft Access. Therefore, this property
will only exist if you have opened the database at least once in Microsoft
Access version 2.0 or later.
<P>
For a Microsoft Access 2.0 database, the AccessVersion property returns
"02.00". For a Microsoft Access 7.0 database, the AccessVersion property
returns a string that always begins with "06" followed by a period and two
digits. For a Microsoft Access 97 database, the AccessVersion property
returns a string that always begins with "07" followed by a period and two
digits.
<P>
In both Microsoft Access 7.0 and 97, the final two digits returned by the
AccessVersion property may vary depending on the dynamic-link library (DLL)
that was used to create the database’s Visual Basic for Applications
project. Therefore, your code should ignore the final two digits if you
want to determine the version that created or converted the database. The
following function returns the version of Microsoft Access used to create
or convert a database by examining only the first two digits returned for
the AccessVersion property. This function takes a String argument that
specifies the path to the database.

<OL><P><LI>Start Microsoft Access 7.0 or 97.

<P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function FindVersion(strDbPath As String) As String
<PRE></PRE>         Dim dbs As Database
         Dim strVersion As String
         Const conPropertyNotFound As Integer = 3270

         On Error GoTo Err_FindVersion

         ' Open the database and return a reference to it.
         Set dbs = OpenDatabase(strDbPath)

         ' Check the value of the AccessVersion property.
         strVersion = dbs.Properties("AccessVersion")

         ' Return the two leftmost digits of the value of
         ' the AccessVersion property.
         strVersion = Left(strVersion, 2)

         ' Based on the value of the AccessVersion property,
         ' return a string indicating the version of Microsoft Access
         ' used to create or open the database.
         Select Case strVersion
            Case "02"
               FindVersion = "2.0"
            Case "06"
               FindVersion = "7.0"
            Case "07"
               FindVersion = "8.0"
         End Select
      Exit_FindVersion:
         On Error Resume Next
         dbs.Close
         Set dbs = Nothing
         Exit Function

      Err_FindVersion:
         If Err.Number = conPropertyNotFound Then
            MsgBox "This database hasn't previously been opened " &amp; _
                   "with Microsoft Access."
         Else
            MsgBox "Error: " &amp; Err &amp; vbCrLf &amp; Err.Description
         End If
         Resume Exit_FindVersion
      End Function

</PRE><P><LI>To test this procedure, type the following into the Debug window, and
   then press ENTER:
<P>
<P><PRE>      ?FindVersion("C:\Office97\Office\Samples\Northwind.mdb")
</PRE><P>
   Note that the function returns the version of Microsoft Access used to
   create the database.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior does not occur with a database object in an ODBCDirect
workspace; in that case, the Version property returns the version of the
ODBC driver rather than the version of Microsoft Jet.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access 97.

<P><LI>Create a new, blank database.

<P><LI>Press CTRL+G to open the Debug window.

<P><LI>Type the following in the Debug window, and then press ENTER:
<P>
<P><PRE>      ?CurrentDB.Version
</PRE><P>
</OL>Note that "3.0" is returned to the Debug window indicating the current
database is a Microsoft Jet 3.0 database. However, "3.5" is returned to the
Debug window if you type the following line:
<P>
<PRE>    ?DBEngine.Version

</PRE></OL>This behavior does not occur with a database object in an ODBCDirect
workspace. In that case, the Version property returns the version of the
ODBC driver rather than the version of Microsoft Jet.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Version property, search the Help Index for
"Version property".
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbcode MdlDao<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
