

<HTML>
<HEAD>
<TITLE>ACC: BeforeUpdate and AfterUpdate Field Properties Not Working </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100134">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1993/06/16">
<META NAME="Keywords" CONTENT="FmsEvnt kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  The macro or function attached to a field's BeforeUpdate or AfterUpdate property does not run when expected.  CAUSE =====  A field's BeforeUpdate and AfterUpdate events will not ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAH4,QA7O,QA7N,QAVT,QA1S,QBVV,QAO4,QATP,QDN9,QAY5,QBQU,QBWS,QALM,QDKW P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: BeforeUpdate and AfterUpdate Field Properties Not Working</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100134</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
The macro or function attached to a field's BeforeUpdate or AfterUpdate
property does not run when expected.
<P>
<P><h2>CAUSE</h2>
 
<P>
A field's BeforeUpdate and AfterUpdate events will not be triggered if
the field was modified by a macro or by code.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can work around this behavior by causing the macro or code that
modifies the field to manually trigger the event pointed to by the field's
BeforeUpdate or AfterUpdate property.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in Microsoft Access
   2.0 or earlier).

<P><LI>Create the following macro called TestCityForNull:
<P>
<PRE>     Macro Name       Condition        Action
     ----------------------------------------
     TestCityForNull  IsNull([City])   MsgBox
                      ...              CancelEvent

     TestCityForNull Actions
     -------------------------------------
     MsgBox:
        Message: City Is A Required Field!

</PRE><P><LI> Create the following macro called SetCityToNull:
<P>
<PRE>       Macro Name      Action
       --------------------
       SetCityToNull   OpenForm
                       SetValue

       SetCityToNull Actions
       ---------------------
       OpenForm Action:
          FormName: Customers
          View: Form

       SetValue Action:
          Item:[Forms]![Customers]![City]
          Expression: Null

</PRE><P><LI>Open the Customers form in Design view and select the TestCityForNull
   macro in the City field's BeforeUpdate property.

<P><LI>Run the SetCityToNull macro. Note that it successfully blanks out the
   City field (you can press ESC twice to get it back). If the field's
   BeforeUpdate event had been triggered, the TestCityForNull macro would
   not have allowed the field to be blank.

<P><LI>Try to blank out the City field manually. The TestCityForNull macro will
   be triggered, displaying the following message:
<P>
<P><PRE>      City Is A Required Field!
</PRE>
<P><LI>Do not save changes when you close the Customers form.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the order of event properties, search for
"Event procedures," and then "order of events" using the Microsoft Access
97 Help Index.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: before after update ui<BR>
Keywords            : FmsEvnt kbusage<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
