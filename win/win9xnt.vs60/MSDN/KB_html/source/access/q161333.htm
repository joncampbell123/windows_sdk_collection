

<HTML>
<HEAD>
<TITLE>ACC97: Check NT Permissions When Using IDC/ASP Files with Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161333">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1996/12/19">
<META NAME="Keywords" CONTENT="IntAsp kberrmsg kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article discusses some of the Microsoft Windows NT permissions issues you may encounter when you create and use Internet Database Connector (IDC) files or Active Server...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDKY,QBWD,QAVZ,QBVX,QAJQ,QDL9,QBWO,QBWN,QBG2,QAA1,QAI5,QBWG,QAGU,QDI2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Check NT Permissions When Using IDC/ASP Files with Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161333</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
<LI>Microsoft Internet Information Server version 2.0 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article discusses some of the Microsoft Windows NT permissions issues
you may encounter when you create and use Internet Database Connector
(IDC) files or Active Server Page (ASP) files from a Microsoft Access
database.
<P>
This article assumes that you are familiar with the Internet Database
Connector, ActiveX Server, Microsoft Windows NT, and Internet Information
Server (IIS).
<P>
For more information about using IDC to publish data on an intranet
or the Internet, please refer to the IIS online documentation. You
can also explore Microsoft's World Wide Web site for IIS at
<B><A href="http://www.microsoft.com/iis/default.asp">http://www.microsoft.com/iis/default.asp.</A></B>
<P>
For more information about using ASP to publish data on an intranet or the
Internet, please refer to the Active Server online tutorial.
<P>
NOTE: This article does not apply to Web servers running Microsoft Windows
95 with Personal Web Server because Microsoft Windows 95 does not use the
same security features that are built into Microsoft Windows NT.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you use IDC or ASP files to publish Microsoft Access data on an
intranet or the Internet, you may receive the following error message when
you browse through those files with your Web browser if the permissions,
usernames and passwords are not set correctly in Microsoft Windows NT:
<P>
<PRE>   The Microsoft Jet database engine cannot open the file '(unknown)'.
   It is already opened exclusively by another user, or you need
   permission to view its data.

</PRE>The following are the main reasons for the error message:

<UL><LI>Incorrect Username or Password
<LI>Insufficient NTFS Directory Permissions
<LI>Insufficient Share Permissions
<LI>Access Database Is on a Windows 95 Computer with Insufficient Share
   Permissions
<P>
</UL>Each of these problems is explained below, along with the actions you must
take to correct them. If you need additional assistance with permissions
or user accounts, please refer to your Microsoft Windows NT or Microsoft
IIS documentation.
<P>
NOTE: The troubleshooting tips that follow apply to the anonymous logon
username account set up in the IIS Internet Service Manager. IUSR_&lt;Server
Name&gt; is the default account name, but it can be changed. If anonymous
logons are not allowed (for example, if Basic Authentication or Windows NT
Challenge/Response is in use), then the following troubleshooting tips
apply to whatever user accounts may be trying to access the WWW services.
For more information about setting up the WWW service in the Internet
Service Manager, please refer to your IIS online documentation.
<P>
<P><h3>Incorrect Username or Password</h3>
 
<P>
You specified an incorrect username or password for the IUSR_&lt;Server Name&gt;
account, either in the Windows NT User Manager or in the Internet Service
Manager.
<P>
IUSR_&lt;Server Name&gt; is an account that is created when you set up IIS for
the purpose of allowing anonymous Internet access to resources on the Web
server. The IUSR_&lt;Server Name&gt; account is created with a randomly
generated password. If the password is changed in the Internet Service
Manager, the actual Microsoft Windows NT account password must also be
changed in the Microsoft Windows NT User Manager.
<P>
If the System DSN that your IDC or ASP files use points to a Microsoft
Access database located on a different Microsoft Windows NT computer than
your Web server, then the same IUSR_&lt;Server Name&gt; account with the same
password must be created on the computer where the Microsoft Access
database is located. If your Microsoft Access database is not on a
different computer than your Web server, but it uses attached tables that
are on a different computer, then the same IUSR_&lt;Server Name&gt; account with
the same password must be created on the computer where the attached
tables are located. Remember that the IUSR_&lt;Server Name&gt; account is
created initially with a randomly generated password; the only way to know
the password is to change it to something else.
<P>
<P><h3>Insufficient NTFS Directory Permissions</h3>
 
<P>
The IUSR_&lt;Server Name&gt; account requires both Read and Write permissions on
the directories where your Microsoft Access databases are located. Keep in
mind that NTFS directory permissions are different than share permissions.
If your databases are on a different computer than your Web server, or if
you are using attached tables, then Read and Write permissions must be
granted on the directories on both computers where the Microsoft Access
databases reside.
<P>
<P><h3>Insufficient Share Permissions</h3>
 
<P>
If the System DSN points a Microsoft Access database that resides on a
different computer than your Web server, then the IUSR_&lt;Server Name&gt;
account must exist on the other computer, and should have Read and Write
permissions on the share where the Microsoft Access database resides.
<P>
Access Database Is on a Windows 95 Computer with Insufficient Share
Permissions
 
<P>
If your System DSN points to a Microsoft Access database that is located
on a Microsoft Windows 95 computer that uses User-level access control,
whatever account is set up to be the Anonymous Logon in the Internet
Service Manager must be authenticated by the share permissions on
Microsoft Windows 95. This means if IUSR_&lt;Server Name&gt; is set up as the
Anonymous Logon, then IUSR_&lt;Server Name&gt; must also be a valid account in
the domain, with the same password used in the Internet Service Manager.
The "Username:" value under "Anonymous Logon" in the Internet Service
Manager must be modified to use the following format:
<P>
<PRE>     DOMAIN\IUSR_&lt;Server Name&gt;

</PRE>NOTE: The following error message is caused by a Microsoft Access database
that resides on a different computer than the Web server, and that has
tables linked to a Microsoft Access database on a third computer:
<P>
<PRE>   '&lt;path and file name&gt;' isn't a valid path.  Make sure that the path
   name is spelled correctly and that you are connected to the server on
   which the file resides.

</PRE>To resolve this error, store the front end database on the same computer
as the Web server, or do not use tables linked to a Microsoft Access
database that resides on a third computer.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For information about exporting IDC files in Microsoft Access 97, search
the Microsoft Access 97 Help Index for "IDC files."
<P>
For information about exporting ASP files in Microsoft Access 97, search
the Microsoft Access 97 Help Index for "ASP files."
<P>
For more information about setting Microsoft Windows NT Share permissions
and NTFS directory permissions, please refer to your Microsoft Windows NT
documentation.
<P>
For more information about the Internet Information Server and the
Internet Database Connector, please refer to your IIS online
documentation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: troubleshoot tshoot html iis<BR>
Keywords          : IntAsp kberrmsg kbfaq<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
