

<HTML>
<HEAD>
<TITLE>ACC97: IDC Files Display Hyperlinks as Text in Web Browser </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163654">
<META NAME="KBModify" CONTENT="1997/11/25">
<META NAME="KBCreate" CONTENT="1997/02/13">
<META NAME="Keywords" CONTENT="HtmView WzOthr kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Hyperlink fields in an internet database connector (IDC) file created with Microsoft Access 97 are displayed as text with number signs (#) when you view them with a Web browser. ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVX,QBTI,QAE2,QAVZ,QAUR,QBWS,QA1S,QDN9,QA7O,QA7N,QA3P,QAFI,QBWA,QBRJ,QBMD P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: IDC Files Display Hyperlinks as Text in Web Browser</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163654</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
<LI>Microsoft Internet Information Server version 2.0 and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Hyperlink fields in an internet database connector (IDC) file created with
Microsoft Access 97 are displayed as text with number signs (#) when you
view them with a Web browser.
<P>
<P><h2>CAUSE</h2>
 
<P>
Data that is stored in a Microsoft Access hyperlink field is stored in
three parts (displaytext, address, and subaddress) separated by number
signs. This is different from hyperlinks in HTML files, which are created
using the &lt;A&gt; tag. Microsoft Access outputs the data in a hyperlink field
as it exists, without adding the &lt;A&gt; tags or parsing the data into an HTML
format.
<P>
This issue is not specific to a single Internet server.
<P>
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Create a select query that parses the hyperlink field and adds the
appropriate &lt;A&gt; tags. Then export the query to an IDC file.
<P>
The following example demonstrates how to create a select query that you
can export to IDC/HTX format so that the hyperlink fields are preserved
when you view them in a Web browser. The query contains a column that
parses the HomePage Hyperlink field in Northwind's Suppliers table, and
adds HTML tags to preserve the links.

<OL><P><LI>Start Microsoft Access 97 and open the sample database Northwind.mdb.

<P><LI>Create a new query in Design view based on the Suppliers table.
<P>
   NOTE: In the field expression below, an underscore (_) at the end of a
   line is used as a line continuation character. Remove the underscore
   from the end of each line when you create this example.
<P>
<P><PRE>      Query: HyperIDC
      ------------------------------------------------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: SupplierID
<PRE></PRE>         Table: Suppliers

      Field: GoodHyper: "&lt;A href=""" &amp; IIf(IsNull([HomePage]),"""&gt;", _
             IIf(InStr(1,[HomePage],"#")=1,Mid([HomePage],2, _
             InStr(2,[HomePage],"#")-1) &amp; """&gt;" &amp; Mid([HomePage],2, _
             InStr(2,[HomePage],"#")-2),Mid([HomePage], _
             InStr(1,[HomePage],"#")+1,Len(Mid([HomePage], _
             InStr(1,[HomePage],"#")+1))) &amp; """&gt;" &amp; Left$([HomePage], _
             InStr(1,[HomePage],"#")-1))) &amp; "&lt;A&gt;"

   The expression in the GoodHyper column is so long because it must
   account for nulls in the hyperlink field, and the NZ() function cannot
   be used with IDC. The expression must also handle hyperlinks that do
   not contain the displaytext portion of the hyperlink field.

</PRE><P><LI>Save the HyperIDC query and close it.

<P><LI>Select the HyperIDC query in the Database window, and then on the File
   menu, click Save As/Export.

<P><LI>In the Save As dialog box, click "To an External File or Database,"
   and then click OK.

<P><LI>In the "Save Query 'HyperIDC' In" dialog box, select Microsoft IIS 1-2
   (*.htx;*.idc) in the Save As Type box, and type HyperIDC.htx in
   the File Name box. Select a folder to store the files, and then click
   Export.

<P><LI>In the HTX/IDC Output Options dialog box, type the name of a System
   DSN on your Web server that points to the Northwind sample database in
   the Data Source Name box, and then click OK.
<P>
   For more information on how to create a System DSN, search the Help
   Index for "ODBC, setting up data sources," and see the following
   article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../access/q159682.htm">Q159682</A></B>
<PRE></PRE>      TITLE     : ACC97: "Data Source Name Not Found" Err Msg Opening Web
                  Page

</PRE><P><LI>The HTX/IDC output creates two files: HyperIDC.htx and HyperIDC.idc.
   Copy the two files to a folder on your Web server computer where you
   have Execute permission.
<P>
   For more information about configuring Microsoft Internet Information
   Server (IIS) permissions, please refer to the IIS Help Index, and see
   the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../access/q160754.htm">Q160754</A></B>
<PRE></PRE>      TITLE     : ACC97: Error "HTTP/1.0 403 Access Forbidden" Browsing IDC
                  Page

</PRE><P><LI>Start Microsoft Internet Explorer 3.0, or another Web browser program.

<P><LI>Type the Uniform Resource Locator (URL) in the address box of your Web
    browser to view HyperIDC.idc. For example, if you saved your IDC
    files in a folder called Test in the wwwroot folder of your Web
    Server, type:
<P>
       <B>http://&lt;servername&gt;/test/HyperIDC.idc</B>
<P>
    Note that the URL depends upon where your files are located on the Web
    server.

<P><LI>The Web browser returns the SupplierID and the HomePage hyperlink
    field with the hyperlinks preserved.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access 97 and open the sample database Northwind.mdb.

<P><LI>Select the Suppliers table in the Database window, and then on the File
   menu, click Save As/Export.

<P><LI>In the Save As dialog box, click "To an External File or Database," and
   then click OK.

<P><LI>In the "Save Table 'Suppliers' In" dialog box, select Microsoft IIS 1-2
   (*.htx;*.idc) in the Save As Type box, and type Suppliers.htx in
   the File Name box. Select a folder to store the files, and then click
   Export.

<P><LI>In the HTX/IDC Output Options dialog box, type the name of a System DSN
   on your Web server that points to the Northwind sample database in the
   Data Source Name box, and then click OK.

<P><LI>The HTX/IDC output creates two files: Suppliers.htx and Suppliers.idc.
   Copy the two files to a folder on your Web server computer where you
   have Execute permission.

<P><LI>Start Microsoft Internet Explorer 3.0, or another Web browser program.

<P><LI>Type the URL in the address box of your Web browser to view
   Suppliers.idc. For example, if you saved your IDC files in a folder
   called Test in the wwwroot folder of your Web server, type:
<P>
<P><PRE>      <B>http://&lt;servername&gt;/test/Suppliers.idc</B>
</PRE><P>
   Note that the URL depends upon where your files are located on the Web
   Server.

<P><LI>The Web browser returns the HomePage field, but note that the hyperlinks
   are not preserved, and text containing number signs appears in place of
   the hyperlinks.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: IIS PWS Peer Web Services Personal Web Server<BR>
Keywords          : HtmView WzOthr kbinterop<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
