

<HTML>
<HEAD>
<TITLE>ACC2: Cannot Search for Name with Apostrophe in Find Customers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121260">
<META NAME="KBModify" CONTENT="1997/07/16">
<META NAME="KBCreate" CONTENT="1994/09/30">
<META NAME="Keywords" CONTENT="FmsEvnt kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you are using the Find Customers form in the sample database SOLUTION.MDB, you cannot search for a customer whose name contains an apostrophe ('). For example, if you try to...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAH4,QA5F,QAMA,QAUJ,QBJZ,QBXT,QBWS,QA5V,QAIB,QAPF,QA2Q,QA50,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Cannot Search for Name with Apostrophe in Find Customers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121260</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you are using the Find Customers form in the sample database
SOLUTION.MDB, you cannot search for a customer whose name contains an
apostrophe ('). For example, if you try to search for a customer with the
name "B's Foods," you receive the following error message:
<P>
<PRE>   Syntax error in query expression '[Company Name] Like 'B's Foods*''

</PRE><h2>RESOLUTION</h2>
 
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Building Applications" manual.
<P>
The following steps demonstrate how to modify the AddToWhere Sub procedure
so that you can search for customer names containing apostrophes.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.

<OL><P><LI>Quit Microsoft Access if it is running, and copy the SOLUTION.MDB file
   to a file called MYSOLUT.MDB.

<P><LI>Start Microsoft Access and open the MYSOLUT.MDB database.

<P><LI>In the Select A Category Of Examples box, select Sample Forms. In the
   Select An Example box, select Find Customers. Choose OK.

<P><LI>View the form in Design view. From the View menu, choose Code.

<P><LI>In the Procedure box on the toolbar, select AddToWhere, and place an
   apostrophe (') at the beginning of the line that reads:
<P>
<P><PRE>      Mycriteria = (Mycriteria &amp; FieldName &amp; " Like " &amp; Chr(39) &amp; _
      Fieldvalue &amp; Chr(42) &amp; Chr(39))
</PRE><P>
   Placing an apostrophe at the beginning of the line comments the line
   out.

<P><LI>Enter the following code just below the line that you commented out
   in step 5:
<P>
<P><PRE>      If InStr(1, fieldvalue, "'") Then
<PRE></PRE>        Mycriteria = (Mycriteria &amp; FieldName &amp; " Like " &amp; Chr(39) &amp;
        Left(Fieldvalue, InStr(1, Fieldvalue, "'") - 1) &amp; "'" &amp; _
        Mid(Fieldvalue, InStr(1, Fieldvalue, "'")) &amp; Chr(42) &amp; Chr(39))
      Else
        Mycriteria = (Mycriteria &amp; FieldName &amp; " Like " &amp; Chr(39) &amp; _
        Fieldvalue &amp; Chr(42) &amp; Chr(39))
      End If

</PRE><P><LI>Close the module and then view the form in Form view.

<P><LI>Search for a company whose name contains an apostrophe.

<P><LI>From the File menu, choose Save Form.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsEvnt kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
