

<HTML>
<HEAD>
<TITLE>ACC1x: Group Footer Controls Calculate Twice at Page Break </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104980">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1993/10/04">
<META NAME="Keywords" CONTENT="kbusage RptTotal">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  A group footer control that references a calculated detail control returns incorrect results if the page break and group break occur at the same time. The group footer control is off by the value of the last detail record.  CAUSE =====  Reference t...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QBT6,QBV4,QAML,QA7O,QAMN,QAB5,QAKS,QAHP,QBCI,QA5V,QAPN,QAOE,QA1S,QAWI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Group Footer Controls Calculate Twice at Page Break</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104980</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A group footer control that references a calculated detail control
returns incorrect results if the page break and group break occur at
the same time. The group footer control is off by the value of the
last detail record.
<P>
<P><h2>CAUSE</h2>
 
<P>
Reference to a control with the RunningSum property applied from a
higher-level group footer causes the control's value to be added again
for the last cached running sum and to return incorrect data. All
cached field values are validated when you advance the page; this
occurs before the record is advanced, determining the end of the
group. Thus, the last record in a group is added twice.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
From the OnPrint event of the Detail section, call a macro that uses
the SetValue action to place the detail control's value in an unbound
group footer control.
<P>
The Detail section has the following OnPrint properties and control:
<P>
<PRE>   OnPrint: Macro1
   ControlName: DetailTotal
      RunningSum: OverGroup

</PRE>The Group Footer section has the following unbound control:
<P>
<PRE>   ControlName: FooterTotal
   ControlSource: &lt;blank&gt;

</PRE>Macro1 is called from the OnPrint event of the Detail section and has
the following action:
<P>
<PRE>    SetValue
       Item=[FooterTotal]
       Expression=[DetailTotal]

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access versions
1.0 and 1.1. This problem no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a grouping report.

<P><LI>Locate an unbound text box in the Detail section.

<P><LI>Set the ControlSource property of the text box to =1 and the
   RunningSum property to OverGroups.

<P><LI>Locate a second unbound text box in the Group Footer section.

<P><LI>Set the ControlSource property for the second text box to the
   ControlName of the first text box.
<P>
   When the last detail record for a group prints on page 1 and the
   group footer prints on page 2, the group footer control adds the
   value for the last record in the group twice.
<P>
   If the totals are derived from a user-defined function, you may be
   able to test this procedure (for instance, if the FormatCount or
   PrintCount properties of the report have been set to 2 and, if
   true, return 0 to the function). Another option may be to change
   the data type from Variant to Double.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "User's Guide," version 1.0, page 568
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage RptTotal<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
