

<HTML>
<HEAD>
<TITLE>ACC1x: Cannot Paste Data from Clipboard Using DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104682">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1993/09/27">
<META NAME="Keywords" CONTENT="IntpDde kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  When you attempt to paste data into a dynamic data exchange (DDE) server application from Microsoft Access, the process does not complete correctly and the following error message is generated:     The other application won't perform the DDE method...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAY5,QAIH,QBV8,QAB9,QA5F,QA9N,QAB4,QAMA,QA5V,QBVP,QDL9,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Cannot Paste Data from Clipboard Using DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104682</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to paste data into a dynamic data exchange (DDE) server
application from Microsoft Access, the process does not complete correctly
and the following error message is generated:
<P>
<PRE>   The other application won't perform the DDE method or operation you
   attempted.

</PRE>If you are using Microsoft Word for Windows as your DDE server application,
the error message "WordBASIC Err=102 Command failed" will appear in Word
for Windows.
<P>
If you are using Microsoft Excel as your DDE server application, the error
message "Cannot paste data" will appear in Microsoft Excel.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Access does not "render," or place, the data on the Clipboard
until an application requests the data for pasting. (This technique
provides improved performance with large pieces of data.) When Microsoft
Access issues the DDEExecute command to tell the DDE server application to
paste the data, it waits for that command to finish before allowing any
other operation to take place. When the DDE server application receives the
paste command, it requests that Microsoft Access place the data on the
Clipboard. However, Microsoft Access will not do this because it is
waiting for the DDEExecute command to finish.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following sample Access Basic function called RenderClipboard() can be
called to force Microsoft Access to render the data to the Clipboard before
issuing the DDEExecute command:
<P>
NOTE: This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual.
<P>
NOTE: You may have some Microsoft Windows API functions defined in an
existing Microsoft Access library; therefore, your declarations may be
duplicates. If you receive a duplicate procedure name error message, remove
or comment out the declarations statement in your code.
<P>
NOTE: In the following sample code, an underscore (_) is used as a line-
continuation character. Remove the underscore when re-creating this code in
Access Basic.
<P>
<PRE>   '*********************************************************
   ' MODULE DECLARATION SECTION
   '*********************************************************
   Declare Function OpenClipboard% Lib "User" (ByVal hWnd%)
   Declare Function GetClipboardData% Lib "User" (ByVal wFormat%)
   Declare Function CloseClipboard% Lib "User" ()

   Global Const CF_TEXT = 1

   Function RenderClipboard ()
       Dim RetVal As Integer
       RetVal = OpenClipboard(0)
       RetVal = GetClipboardData(CF_TEXT)
       RetVal = CloseClipboard()
   End Function

</PRE>The following example demonstrates how to use the RenderClipboard()
function:

<OL><P><LI>Start Microsoft Word for Windows. The default document Document1 should
   be open.

<P><LI>Start Microsoft Access. Open the sample database NWIND.MDB.

<P><LI>Create a new module, and enter the following Access Basic function:
<P>
<P><PRE>      Function CopyRecordToWinword ()
<PRE></PRE>         Dim RetVal, Chan

         ' Copy the current record to the clipboard
         DoCmd DoMenuItem A_FORMBAR, A_EDITMENU, A_SELECTRECORD
         DoCmd DoMenuItem A_FORMBAR, A_EDITMENU, A_COPY

         RetVal = RenderClipboard()

         Chan = DDEInitiate("winword", "Document1")
         DDEExecute Chan, "[EditPaste]"
         DDETerminate Chan
      End Function

</PRE><P><LI>Open the Customers form in Design view and add a command button with the
   following properties:
<P>
<P><PRE>      Caption: Copy to Record
      OnPush: =CopyRecordToWinword()
</PRE>
<P><LI>Change to Form view, and choose the Copy To Winword button. The record
   will be pasted into the Word for Windows document.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access versions
1.0 and 1.1. This problem no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Word for Windows. The default document Document1 should
   be open.

<P><LI>Start Microsoft Access. Open the sample database NWIND.MDB.

<P><LI>Create a new module, and enter the following Access Basic function:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Function CopyRecordToWinword ()
<PRE></PRE>         Dim RetVal, Chan

         ' Copy the current record to the clipboard
         DoCmd DoMenuItem A_FORMBAR, A_EDITMENU, A_SELECTRECORD
         DoCmd DoMenuItem A_FORMBAR, A_EDITMENU, A_COPY

         Chan = DDEInitiate("winword", "Document1")
         DDEExecute Chan, "[EditPaste]"
         DDETerminate Chan
      End Function

</PRE><P><LI>Open the Customers form in Design view and add a command button with the
   following properties:
<P>
<P><PRE>      Caption: Copy to Record
      OnPush: =CopyRecordToWinword()
</PRE>
<P><LI>Change to Form view, and choose the Copy To Winword button. Word for
   Windows will generate the error message: "WordBASIC Err=102 Command
   failed."
<P>
   NOTE: To reproduce the problem with Microsoft Excel, use the following
   Access Basic function instead of the function listed above:
<P>
   Option Explicit
<P>
   Function CopyRecordToExcel ()
<P><PRE>      Dim RetVal, Chan
</PRE><P>
<P><PRE>      ' Copy the current record to the clipboard
      DoCmd DoMenuItem A_FORMBAR, A_EDITMENU, A_SELECTRECORD
      DoCmd DoMenuItem A_FORMBAR, A_EDITMENU, A_COPY
</PRE><P>
<P><PRE>      Chan = DDEInitiate("Excel", "Sheet1")
      DDEExecute Chan, "[Paste()]"
      DDETerminate Chan
</PRE>   End Function
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpDde kbinterop<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
