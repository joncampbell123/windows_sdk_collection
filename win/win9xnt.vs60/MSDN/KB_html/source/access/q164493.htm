

<HTML>
<HEAD>
<TITLE>ACC97: Display Problems When Refreshing ASP Forms in Browser </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164493">
<META NAME="KBModify" CONTENT="1997/07/21">
<META NAME="KBCreate" CONTENT="1997/03/03">
<META NAME="Keywords" CONTENT="FmsOthr IntAsp IntpWeb kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you export a Microsoft Access 97 form to Active Server Pages (ASP) format, and then view the file with your Web browser program, you notice one of the following problems whe...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QDNQ,QBJZ,QAVZ,QA1S,QDN9,QAXB,QAJQ,QBWS,QAUR,QADK,QBTI,QAI2,QAZV,QA9E P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Display Problems When Refreshing ASP Forms in Browser</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164493</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you export a Microsoft Access 97 form to Active Server Pages (ASP)
format, and then view the file with your Web browser program, you notice
one of the following problems when you click the Refresh button:

<UL><LI>The form becomes blank and does not display anything at all.
<LI>The form displays only some of the fields or navigation buttons that it
   actually contains.
<LI>The form continues to display the same record, even though that record
   was deleted from the database.
<P>
</UL><h2>CAUSE</h2>
 
<P>
The record you are viewing with the ASP file has been deleted from the
database, and the ASP file is unable to refresh the screen correctly
because it cannot requery the same record.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In most cases, you must quit your Web browser program and restart it again
before you can view the ASP form and its data correctly. If the navigation
buttons still appear on your form, such as the First, Last, Next or
Previous record buttons, you may be able to click one or more of them to
restore the form to its original state.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
ASP files use open database connectivity (ODBC) with a programming
language, such as VBScript or JScript, to view and manipulate the data in
your database. When you refresh the record you are viewing on an ASP form,
the form tries to access and display an updated version of the same
record. If that record is no longer available, the form cannot display it,
and consequently the form is not repainted properly on your screen.
<P>
The same situation can occur if you refresh an ASP form that is based on
an empty recordset, such as a table that does not contain any rows. When
you first view the form in your Web browser, you see all of the field
labels and navigation buttons on an empty form that is ready for you to
enter data. If you refresh the form, there is no data in the table to
display and the form is blank on your screen.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Select the Shippers table in the Database window.

<P><LI>On the Edit menu, click Copy, and then on the Edit menu, click Paste.

<P><LI>In the Paste Table As dialog box, type TestASP in the Table Name box,
   click Structure And Data, and then click OK.

<P><LI>Select the TestASP table in the Database window, and then click
   Autoform on the Insert menu. Save the new form as frmTestASP.

<P><LI>Save the frmTestASP form in ASP format using the Save As/Export
   command or the Save As HTML command on the File menu. Save it in a
   folder on your Web server where you have Execute permission.

<P><LI>Start Microsoft Internet Explorer 3.0 or another Web browser program
   and type the uniform resource locator (URL) for your ASP file in the
   Address box. Note the record that is displayed, which is probably the
   record for Speedy Express.

<P><LI>In Microsoft Access, open the TestASP table in Datasheet view, and
   delete the record for Speedy Express, or whichever record is currently
   displayed in your Web browser.

<P><LI>Return to your Web browser and click the Refresh button on the form.
   Note that the form displays as indicated in the "Symptoms" section of
   this article.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating ASP files and other Internet solutions
using Microsoft Access 97, please refer to "Building Applications with
Microsoft Access 97," Chapter 21, "Developing Applications for the Internet
and the World Wide Web," pages 587-629.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ADO blank empty IE<BR>
Keywords            : FmsOthr IntAsp IntpWeb kbinterop<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
