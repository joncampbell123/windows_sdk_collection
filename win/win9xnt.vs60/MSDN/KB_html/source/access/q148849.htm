

<HTML>
<HEAD>
<TITLE>ACC95: What Is Setup/G?  What Does the Log File Look Like? </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148849">
<META NAME="KBModify" CONTENT="1997/05/13">
<META NAME="KBCreate" CONTENT="1996/03/25">
<META NAME="Keywords" CONTENT="kbsetup StpOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article gives a brief overview of the Setup /G command line option for Microsoft Access 95 version 7.0 Setup. This ACME Setup command causes a Setup log to be generated...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QA1S,QDIZ,QAH6,QAD7,QAH7,QDN9,QDKX,QAIJ,QBFY,QAPN,QA9N,QDIV,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: What Is Setup/G?  What Does the Log File Look Like?</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148849</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article gives a brief overview of the Setup /G command line option for
Microsoft Access 95 version 7.0 Setup. This ACME Setup command causes a
Setup log to be generated during installation. This log contains
verification of the compliance checking, Registry entries, directory
creation and what files were copied to what directory from what CAB file.
This is an excellent tool to troubleshoot the installation process, to
identify where Setup may be failing, or to create a list of all the changes
made to the Registry.
<P>
The syntax for the Setup /G command is as follows
<P>
<PRE>    Setup /G &lt;"C:\SULOG.TXT"&gt;

</PRE>where &lt;"C:\SULOG.TXT"&gt; is the name of the log text file.
<P>
NOTE: The path and file name must be in quotation marks.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Setup log consists of sections labeled as passes that note significant
events in the installation process. From this log, you can make inferences
as to the options chosen during Setup and where failures occurred. A brief
description of the log file follows.
<P>
The following is the header file of the Setup.stf (ACME Setup script file)
used to install Microsoft Access 7.0. This file contains the sequence of
instructions Setup is to follow for performing the installation. It
specifies when and where files are to be copied, what Registry entries are
to be created, and it defines the general logical flow of the installation
process.
<P>
NOTE: Due to space constraints in the following sample log, an underscore
(_) at the end of a line is used as a line continuation character. This
underscore will not appear in an actual log file. Instead, a single, long
line will appear.
<P>
<PRE>   ************************************************************
   Microsoft Setup Log File Opened mm/dd/yy hh:mm:ss
   Version number: 1.20.0.2119
   Running under (Operating System Name).
   [15:16:32  Start of Pass: 0]
   [15:16:33  Start of Pass: 1]
   Floppy mode
   Processing the header information of the file:
   C:\~MSSETUP.T\~msstfqf.t\acc95.stf
   ************************************************************
     Application name: Microsoft Access for Windows 95
     Application version: 7.00.00.925(1033)

</PRE>The following sample caption and bitmap information are generated when the
Setup command is issued:
<P>
<PRE>   Frame bitmap: msaccbb.dll, 121, 122
   Frame caption: Microsoft Access for Windows 95 Setup
   Dialog caption base: Microsoft Access for Windows 95

</PRE>The following "Modules" section indicates that Setup is checking to
determine if other products are installed:
<P>
<PRE>   Modules: MOM Class, Microsoft Office Manager,Jet Transporter 3.0,
   Transporter, WindowsCRON,WinCron,OMain,Microsoft Access, msaccess,MS
   Access,msarn110,MS Access Runtime,msarn200,MS Access Runtime,vb,MS
   Visual Basic,vbrun100,MS Visual Basic Runtime

   MSApps mode: local
   INF file name: Acc95.INF

</PRE>NOTE: The start of each section is noted in square brackets along with the
system time stamp.
<P>
<PRE>    [15:16:40  Start of Pass: 2]

</PRE>The following section shows an example of ACME modifying the registry to
note this session of ACME Setup's information. Note verification
"Succeeded:"
<P>
<PRE>    [15:16:40  Start of Pass: 3]
    Writing registry key value: key = _
     HKEY_CURRENT_USER\Software\Microsoft\MS _
     Setup (ACME)\User Info; value name = DefName; value = Brett Roy; _
     Succeeded.
    Writing registry key value: key = _
     HKEY_CURRENT_USER\Software\Microsoft\MS _
     Setup (ACME)\User Info; value name = DefCompany; value = Microsoft _
     Product Support; Succeeded.

</PRE>In the following sample no version of Microsoft Access has been found to
exist under the c:\MSOffice\ directory. Microsoft Access version 1.x is
found on the hard drive. ACME prompts the user to remove Microsoft Access
1.x files. The answer is NO (Note: {&amp;No}).
<P>
<PRE>    [15:16:50  Start of Pass: 5]
     Object 5 - There is no existing Microsoft Access; installing to _
     folder: C:\MSOffice\.
    [15:16:54  Start of Pass: 6]
    .
    .
    [15:17:15  Start of Pass: 10]
    Setup has detected Microsoft Access version 1.X on your hard disk.
    Would you like to have this version removed? Only the application's
    files will be removed. Databases you created using the application will
    not be removed. Older Version Detected {&amp;No}
    .
    .

</PRE>In the following Proofing Tools section, language and version are checked.
Notice that MSSP_AM.LEX is not copied because the same version was found to
exist already on the hard drive.
<P>
<PRE>    .
    .
    SpellchkIntl Action: Object 4935: checking for language code 409
    SpellchkIntl Action: Object 4935: language 409 matched current user _
     language 409
    Object 4965 - File not copied: the existing file is the same or a _
     newer version. (Path: C:\WINNT35\MSAPPS\Proof\MSSP_AM.LEX; Our _
     version: No version; Existing version: No version)
    SpellchkIntl Action: Object 4935: checking for language code 409
    SpellchkIntl Action: Object 4935: language 409 matched current user _
     language 409
    .
    .

</PRE>In the following section, uncompressed Setup files were copied to the hard
drive to establish maintenance mode Setup:
<P>
<PRE>    .
    .
    [15:17:33  Start of Pass: 14]
    Uncompressed copy file: 'C:\~MSSETUP.T\~msstfqf.t\offsetup.ttf' to: _
     'C:\WINNT35\offsetup.ttf' Succeeded
    Uncompressed copy file: _
     '\\products1\release\APPS\ACCESS95\NETSETUP\ACME.EXE' to:   _
     'C:\MSOffice\Access\Setup\ACME.EXE' Succeeded
    Uncompressed copy file: _
     '\\products1\release\APPS\ACCESS95\NETSETUP\ACC95INV.DLL' to: _
     'C:\MSOffice\Access\Setup\ACC95INV.DLL' Succeeded
    .
    .

</PRE>Files were copied from the Setup Disks.
<P>
Following is an example of a typical failure and unsuccessful installation
of ACME Setup. The first time ACME prompts it could not read a file, the
user had ACME retry {&amp;Retry} then cancel {cancel} when prompted a second
time.  Then the Setup process is ended with the user responding {&amp;Yes} to
Quit Setup.
<P>
<PRE>    Setup could not read from the file: _
    '\\PRODUCTS1\RELEASE\APPS\ACCESS95\144\disk2\access2.cab'. Setup _
     Message {&amp;Retry}
    Setup could not read from the file: _
    '\\PRODUCTS1\RELEASE\APPS\ACCESS95\144\disk2\access2.cab'. Setup _
     Message {Cancel}
     Setup is not yet complete.
    If you quit now, the product will not be installed properly.
    Quit Setup? Setup Message {&amp;Yes}
    The compressed file _
     '\\PRODUCTS1\RELEASE\APPS\ACCESS95\144\disk2\access2.cab'   cannot _
     be decompressed and may be corrupted. Setup Message {OK}
    .
    .
    .

</PRE>The following are Registry Entries by ACME Setup of shared and specific
MIcrosoft Access 7.0 files:
<P>
<PRE>    [15:31:05  Start of Pass: 15]
    Writing registry key value: key = _
     HKEY_LOCAL_MACHINE\Software\Microsoft\Shared _
     Tools\mfc40; value name = Path; value = _
     C:\WINNT35\System32\MFC40.DLL;  Succeeded.
    Creating registry key: 'HKEY_LOCAL_MACHINE\Software\Microsoft\Shared _
     Tools\mfc40\Clients'; Succeeded.
    Writing registry key value: key = _
     HKEY_LOCAL_MACHINE\Software\Microsoft\Shared _
     Tools\mfc40\Clients; value name = _
     C:\MSOffice\Access\MSACCESS.EXE; value = ; Succeeded.
    .
    .
    .

</PRE>One of the last functions of the Setup process is the creation of
shortcuts, their command lines, and the icons in the Microsoft Office
group:
<P>
<PRE>    [15:35:16  Start of Pass: 16]
    Object 935 - Creation Succeeded (Path: Microsoft Office, Target Path: _
     C:\MSOffice\Access\Setup\Acme.exe, Icon Path: )
    Object 1375 - BindImage Succeeded (Path:   _
     C:\MSOffice\Access\MSACCESS.EXE)
    Object 4405 - Creation Succeeded (Path: Startup, Target Path: _
     C:\MSOffice\Office\fastboot.exe, Icon Path: )
    Object 6405 - Creation Succeeded (Path: Microsoft Office, Target Path:
     C:\MSOffice\Access\MSACCESS.EXE, Icon Path: )
    Object 6410 - Creation Succeeded (Path: Microsoft Office, Target Path:_
     C:\MSOffice\Access\WRKGADM.EXE, Icon Path: )
    Object 6420 - Creation Succeeded (Path: Microsoft Office, Target Path:_
     C:\MSOffice\Access\ACREADME.TXT, Icon Path: )

</PRE>Wrapping up the Setup process, ACME writes the final Registry key which is
for the Setup.stf file used in Setup maintenance mode. The TrueType font
(Offsetup.ttf) and font files (Offsetup.for) are removed after Setup has
completed. Finally, the log file is closed with a date/time stamp:
<P>
<PRE>    [15:35:22  Start of Pass: 17]
    Writing registry key value: key = _
     HKEY_LOCAL_MACHINE\Software\Microsoft\MS _
     Setup (ACME)\Table Files; value name = Microsoft Access for Windows _
     95@v7.00.00.925(1033); value = C:\MSOffice\Access\Setup\Acc95.stf; _
     Succeeded.
    [15:35:22  Start of Pass: 18]
    [15:35:22  Start of Pass: 19]
    Removing file 'C:\WINNT35\offsetup.ttf': Succeeded
    Removing file 'C:\WINNT35\offsetup.for': Succeeded
    Microsoft Setup Log File Closed 12/12/95 16:00:01

</PRE>NOTE: This is sample output only and should not be viewed as being an exact
replica of any particular installation. Although files transferred and
Registry entries will vary between environments, the basic format of the
passes, and actions therein are often consistent among these environments.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Office for Windows 95 Resource Kit, Chapter 9, "Customizing
Client Installations"
<P>
For more information about this topic, please see the following articles in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q119357.htm">Q119357</A></B>
   TITLE:      AppNote: "How to Create a Custom Installation Script"
               (WC1046)

   ARTICLE-ID: <B><A href="../setup/q122523.htm">Q122523</A></B>
   TITLE:      Office Setup: Differences Between Shared and System Files

   ARTICLE-ID: <B><A href="../accother/q123586.htm">Q123586</A></B>
   TITLE:      ADT2: Setup Wizard Cannot Create Compact and Repair Icons
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbsetup StpOthr<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
