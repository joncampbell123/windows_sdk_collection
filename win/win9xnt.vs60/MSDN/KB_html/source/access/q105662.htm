

<HTML>
<HEAD>
<TITLE>ACC: Print Text to Default Printer with Access Basic (1.x/2.0) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105662">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/10/22">
<META NAME="Keywords" CONTENT="kbprint PtrOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  In Microsoft Access, there is no standard way of sending text to the default printer without printing a form or report. This article demonstrates a method of using Windows A...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAY5,QDL9,QBWO,QBWN,QDN9,QAB9,QBV8,QBE7,QBE6,QA5F,QAMA,QATX,QAOX,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Print Text to Default Printer with Access Basic (1.x/2.0)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105662</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
In Microsoft Access, there is no standard way of sending text to the
default printer without printing a form or report. This article
demonstrates a method of using Windows API functions to send text to the
printer.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual in Microsoft Access version
1.x, or the "Building Applications" manual in version 2.0. This article
also assumes that you are familiar with programming in the Windows
environment. For more information on programming in the Windows environment
using API functions, please refer to the Microsoft Windows Software
Development Kit manuals.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Unlike Microsoft Visual Basic, Microsoft Access does not have a printer
object for sending text to the printer. The following example demonstrates
how to use Windows API functions to send text to the printer.
<P>
<P><h3>Notes</h3>
 

<UL><LI>This article does not describe the API function arguments. For details
   on the API functions, please refer to the Microsoft Windows Software
   Development Kit manuals.

<LI>You may have some Microsoft Windows API functions defined in an existing
   Microsoft Access library; therefore, your declarations may be
   duplicates. If you receive a duplicate procedure name error message,
   remove or comment out the declarations statement in your code. You
   should also alias any API function declarations. For more information on
   using aliases, search for "alias" then "declare statement" using the
   Microsoft Access Help menu.

<LI>In the following sample code, an underscore (_) is used as a line-
   continuation character. Remove the underscore when re-creating this
   code in Access Basic.
<P>
<P><PRE>      '-------------------------------------------------------------------
      'Declarations Section
      '-------------------------------------------------------------------
<PRE></PRE>      Option Compare Database   'Use database order for string comparisons
      Option Explicit

      Type DOCINFO
         cbSize As Integer
         lpszDocname As Long
         lpszOutPut As Long
      End Type

      Declare Function GetProfileString% Lib "Kernel" (ByVal lpAppName$, _
                       ByVal lpkeyname$, ByVal lpDefault$, _
                       ByVal lpReturnedString$, ByVal nsize%)
      Declare Function CreateDC% Lib "GDI" (ByVal lpDriverName$, _
                       ByVal lpDeviceName$, ByVal lpOutput$, _
                       lpInitData As Any)
      Declare Function DeleteDC% Lib "GDI" (ByVal hDC%)
      Declare Function TextOut% Lib "GDI" (ByVal hDC%, ByVal X%, ByVal _
                       Y%, ByVal lpString$, ByVal nCount%)
      Declare Function Mylstrcpy&amp; Lib "Kernel" Alias "lstrcpy" ( _
                       ByVal lpString1 As Any, ByVal lpString2 As Any)
      Declare Function StartDoc% Lib "GDI" (ByVal hDC%, lpdi As DOCINFO)
      Declare Function StartPage% Lib "GDI" (ByVal hDC%)
      Declare Function EndPage% Lib "GDI" (ByVal hDC%)
      Declare Function EndDocAPI% Lib "GDI" Alias "EndDoc" (ByVal hDC%)
      Declare Function Rectangle% Lib "GDI" (ByVal hDC%, ByVal X1%, _
                       ByVal Y1%, ByVal X2%, ByVal Y2%)

      '-------------------------------------------------------------------
      'Start of Function
      '-------------------------------------------------------------------

      Function Printer ()
         Dim lpReturnedString$
         Dim MyDoc As DOCINFO
         Dim MyDocumentname$
         Dim nPrinter, nDriver, nDevice
         Dim szDevice, szDriver, szOutPut
         Dim hDC%, X%, MyString$


         MyDocumentname$ = "My Document"

         '------------------------------------------
         ' Retrieve the currently selected printer as
         ' establish with the Control panel.
         ' Sample string as returned by lpReturnedString$:
         '
         '    HP LaserJet IIISi PostScript,pscript,LPT1:
         '------------------------------------------
         lpReturnedString$ = Space$(128)
         nPrinter = GetProfileString("windows", "device", ",,,", _
                    lpReturnedString$, Len(lpReturnedString$))

         '-----------------------------------------
         ' Parse the string of its three components
         '-----------------------------------------
         nDevice = InStr(lpReturnedString$, ",")
         nDriver = InStr(nDevice + 2, lpReturnedString$, ",")
         szDevice = Mid$(lpReturnedString$, 1, nDevice - 1)
         szDriver = Mid$(lpReturnedString$, nDevice + 1, nDriver - _
                    nDevice - 1)
         szOutPut = Mid$(lpReturnedString$, nDriver + 1)

         '------------------------------------------
         ' Create the DOCINFO structure for StartDoc()
         '  - lpszDocname is name displayed in PRINTMAN
         '  - lpszOutPut is not used and set to NULL
         '------------------------------------------
         MyDoc.cbSize = Len(MyDoc)
         MyDoc.lpszDocname = Mylstrcpy(MyDocumentname$, MyDocumentname$)
         MyDoc.lpszOutPut = 0&amp;

         '------------------------------------------
         ' Create the device context
         '------------------------------------------
         hDC% = CreateDC(szDriver, szDevice, szOutPut, 0&amp;)

         X% = StartDoc(hDC%, MyDoc)
            X% = StartPage(hDC%)

         '------------------------------------------
         ' Rectangle arguments are X, Y, cX, cY
         '------------------------------------------
         X% = Rectangle(hDC%, 10, 10, 1000, 150)
         MyString$ = "Derek and Robyn are brother and sister!"

         '------------------------------------------
         ' Second and third arguments are the X and Y
         ' coordinates on paper.
         '------------------------------------------
         X% = TextOut(hDC%, 30, 20, MyString$, Len(MyString$))

         X% = EndPage(hDC%)
         X% = EndDocAPI(hDC%)

         '------------------------------------------
         ' Release the device context when done
         '------------------------------------------
         hDC% = DeleteDC(hDC%)

      End Function

      '-------------------------------------------------------------------
      'End of Function
      '-------------------------------------------------------------------

</PRE></UL><h2>REFERENCES</h2>
 
<P>
Microsoft Windows Software Development Kit "Guide to Programming,"
version 3.1, page 254-255
<P>
Microsoft Windows Software Development Kit "Programmer's Reference
Volume 2: Functions," version 3.1
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprint PtrOthr<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
