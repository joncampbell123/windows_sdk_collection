

<HTML>
<HEAD>
<TITLE>ACC: How to Refer to a Control on a Subform or Subreport </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113352">
<META NAME="KBModify" CONTENT="1997/05/21">
<META NAME="KBCreate" CONTENT="1994/04/03">
<META NAME="Keywords" CONTENT="kbusage SynRef">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to refer to controls on subforms or subreports, and describes some common problems you may encounter when you refer to controls on subforms or subrepor...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QAB5,QAOE,QAMN,QDN7,QAUJ,QAPN,QAHV,QAWI,QAEN,QAMA,QAJQ,QAB6,QARM,QAB4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Refer to a Control on a Subform or Subreport</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113352</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to refer to controls on subforms or subreports,
and describes some common problems you may encounter when you refer to
controls on subforms or subreports.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: In Microsoft Access 7.0 and 97, the "Form" or "Report" identifier is
optional when referring to control properties. It is necessary, however,
when referring to subform or subreport properties.
<P>
To refer to a control on a subform, use the following syntax:
<P>
<PRE>   Forms![main form name]![subform control name].Form![control name]

</PRE>To refer to a control on a subreport, use the following syntax:
<P>
<PRE>   Reports![main report name]![subreport control name].Report![control
   name]

</PRE>NOTE: Only subforms are discussed in the rest of this article, but all the
information applies to both subforms and subreports.
<P>
It is important to note that you cannot refer to controls on a subform
with the following syntax:
<P>
<PRE>   Forms![subform name]![control name]

</PRE>This is because a subform on a main form is not a form, but is a control
just like a text box or a list box. You must refer to a subform as a
control rather than a form, and specify the Form identifier following the
subform control name reference to gain access to the controls on a subform.
<P>
It is also important to note that when you are referring to controls on a
subform, you must specify the value contained in the ControlName property
of the subform control. The ControlName property should not be confused
with the SourceObject property for a subform control. The SourceObject
property is used to indicate which subform to use in the subform control.
The ControlName property is used to specify the name by which the subform
control is referenced. ControlName is typically set the same as the
SourceObject, but it does not have to be.
<P>
For example, consider an Order Details subform on an Orders form with the
following properties:
<P>
<PRE>   ControlName: Order Details
   SourceObject: Order Details

</PRE>You can refer to a Unit Price control on the Order Details subform with the
following reference:
<P>
<PRE>   Forms![Orders]![Order Details].Form![Unit Price]

</PRE>If, however, the subform control has the following properties
<P>
<PRE>   ControlName: Details
   SourceObject: Order Details

</PRE>you must refer to the Unit Price control on the Order Details subform
with this reference:
<P>
<PRE>   Forms![Orders]![Details].Form![Unit Price]

</PRE><h3>Examples of Referencing Controls on a Subform</h3>
 
<P>
You could use the following SetValue macro action to increase the Unit
Price value on the Orders Subform by 10 percent:
<P>
<PRE>   SetValue
      Item: Forms![Orders]![Order Details].Form![Unit Price]
      Expression: Forms![Orders]![Order Details].Form![Unit Price]* 1.1

</PRE>If the macro is attached to a button on the Orders form, you can use
this expression for the SetValue Expression argument:
<P>
<PRE>   [Order Details].Form![Unit Price]*1.1

</PRE>If you are referring to a control on a subform from another control on the
same subform, you do not have to enter the Form property identifier. For
example, to refer to the Unit Price value on the Order Details subform in a
macro attached to a button on the Order Details subform, you can enter:
<P>
<PRE>   [Unit Price]

</PRE>The following expression can be entered as the ControlSource property for
the Subtotal control on the Orders main form to display a value calculated
in the hidden Order Subtotal control on the Order Details subform:
<P>
<PRE>   =[Orders Subform].Form![Order Subtotal]

</PRE>To refer to the value of a control on the parent (main) form from a control
on a subform, use the Parent property. For example, the following
expression entered in a control on a subform refers to the Customer ID
field on the parent form.
<P>
<PRE>   =Parent![Customer ID]

</PRE>To refer to a control on a nested subform (a subform on a subform),
you can use the following syntax:
<P>
<PRE>   Forms![main form name]![subform control name].Form![nested subform
   control name].Form![control name]

</PRE><h3>Common Problems Encountered When Referencing Subform Controls</h3>
 

<UL><LI>The following error message occurs:
<P>
<P><PRE>      Invalid reference to form '&lt;subform name&gt;'
</PRE><P>
   This means that you tried to reference a control on a subform with the
   following syntax:
<P>
<P><PRE>      Forms![subform name]![control name]
</PRE><P>
   The problem is that the subform is not really a form, but a control
   that appears on a main form. Refer to the subform as a control rather
   than as a form with the following syntax:
<P>
<P><PRE>      Forms![main form name]![subform control name].Form![control name]
</PRE><P>
</UL>-  "#Name?" appears in a control with an expression referring to a
<PRE>   subform control.

   This can occur when the ControlName property for the subform control is
   not what you expect. Open the main form in Design view, select the
   subform control, then choose the Property window from the View menu.
   Compare the ControlName property value to the SourceObject property
   value.

   The SourceObject property is used to indicate which subform to use
   in the subform control. The ControlName property is used to specify
   the name by which the subform control is referenced. The ControlName
   is typically set the same as the SourceObject, but it does not have
   to be.

</PRE><LI>The following error message occurs:
<P>
<P><PRE>      Invalid reference to field '&lt;subform name&gt;'
</PRE><P>
   This error message is caused by the same the problem as the problem in
   the last example.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
For more information about controls, type "controls" in the Office
Assistant, click Search, and then click to view "Controls: What they are
and how they work."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage SynRef<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
