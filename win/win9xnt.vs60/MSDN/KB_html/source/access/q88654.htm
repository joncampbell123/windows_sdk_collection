

<HTML>
<HEAD>
<TITLE>ACC1x: How to Perform an SQL Bulk Action Query from Access Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88654 ">
<META NAME="KBModify" CONTENT="1997/11/12">
<META NAME="KBCreate" CONTENT="1992/08/30">
<META NAME="Keywords" CONTENT="OdbcOthr kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Access Basic does not support SQL statements to access your data without defining a virtual table (VT) object to execute the statement. For example, you cannot execute the following SQL command on a line by itself, even though it would be valid in ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QDN9,QA5F,QAMA,QABM,QBLI,QAB9,QBXS,QAXB,QBFT,QAYL,QAFF,QAB4,QAZV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Perform an SQL Bulk Action Query from Access Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88654 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Access versions 1.0, 1.1
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Access Basic does not support SQL statements to access your data without
defining a virtual table (VT) object to execute the statement. For
example, you cannot execute the following SQL command on a line by
itself, even though it would be valid in a Microsoft Access query:
<P>
<PRE>   UPDATE Cust SET Cust.[Phone] = "(206) " &amp; [Phone];

</PRE>This article describes how to perform SQL bulk action queries, and
includes a Sub procedure called PerfromSQLAction that you can add to your
programs. You can use this Sub procedure to pass a SQL bulk action
statement to the procedure and have it executed.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools
provided with Microsoft Access. For more information about Access Basic,
please refer to the "Introduction to Programming" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Access Basic does not support SQL statements in that you cannot execute a
SQL statement on a line by itself. The following SQL command, although a
valid Microsoft Access query, will generate a syntax error message in
Access Basic:
<P>
<PRE>   UPDATE Cust SET Cust.[Phone] = "(206) " &amp; [Phone];

</PRE>Instead of including the SQL statement on a line by itself, you have to
follow steps similar to the example below to execute the SQL statement:

<OL><P><LI>Dimension a Database and QueryDef variable as shown below:
<P>
<P><PRE>      Dim MyDB As Database
      Dim MyQuery As QueryDef
</PRE>
<P><LI>Set the database variable to the current user database as shown
   below:
<P>
<P><PRE>      Set MyDB = CurrentDB()
</PRE>
<P><LI>Set the QueryDef variable to use the CreateQueryDef method, assigning
   an arbitrary query name such as TempQuery and including the desired SQL
   statement. The query you create using this step is only for the purpose
   of executing the bulk action query and will be deleted later. An
   example of how to use the CreateQueryDef method for this purpose is
   shown below.
<P>
   NOTE: In the following sample code, an underscore (_) is used as a
   line-continuation character. Remove the underscore from the end of the
   line when re-creating this code in Access Basic.
<P>
<P><PRE>      Set MyQuery = MyDB.CreateQueryDef("TempQuery" ,UPDATE _
      Cust SET Cust.[Phone] = "(206) " &amp; [Phone];
</PRE>
<P><LI>Execute the TempQuery query you created in the previous step using the
   Execute method:
<P>
<P><PRE>      MyQuery.Execute
</PRE>
<P><LI>Delete TempQuery using the DeleteQueryDef method as shown below:
<P>
<P><PRE>      MyDB.DeleteQueryDef("TempQuery")
</PRE><P>
</OL>All of these steps, along with some error trapping, have been combined in
the PerfromSQLAction Sub procedure. You can use this Sub procedure to
perform bulk action queries in your Access Basic programs.
<P>
PerformSQLAction requires only the SQL command you want to execute as a
string value. For example:
<P>
<PRE>   PerformSQLAction "UPDATE Cust SET Cust.[Phone] = '(206) ' &amp; [Phone];"

</PRE></OL>Note that the SQL command is always followed by a semicolon (;).
<P>
The following is a listing of PerformSQLAction:
<P>
<PRE>   Sub PerformSQLAction (SQLStmt As String)
      Dim LocalDB As Database, LocalQry As QueryDef

      On Error Resume Next
      Set LocalDB = CurrentDB()
      LocalDB.DeleteQueryDef("TempQuery")
      On Error GoTo 0

      Set LocalQry = LocalDB.CreateQueryDef("TempQuery", SQLStmt)
      LocalQry.Execute
      LocalQry.Close
      LocalDB.DeleteQueryDef("TempQuery")
   End Sub
</PRE> 
<PRE>Keywords          : OdbcOthr kbusage
Version           : 1.0 1.1
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
