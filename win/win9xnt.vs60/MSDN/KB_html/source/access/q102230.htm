

<HTML>
<HEAD>
<TITLE>ACC1x: Setup (STFSETUP) GP Faults in Windows Standard Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102230">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1993/07/29">
<META NAME="Keywords" CONTENT="kbsetup StpOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  When you are running Microsoft Windows in standard mode, the error message  STFSETUP caused a general protection fault in STFSETUP.EXE  will occur near the end of the installation process if you are running any of the following:   - The retail Setu...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAA1,QDN9,QABB,QDI2,QDL9,QDIZ,QBWO,QBWN,QBXS,QA5W,QAIJ,QBWS,QABA,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Setup (STFSETUP) GP Faults in Windows Standard Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102230</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 1.1
<LI>Microsoft Access Distribution Kit version 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are running Microsoft Windows in standard mode, the error message
"STFSETUP caused a general protection fault in STFSETUP.EXE" will occur
near the end of the installation process if you are running any of the
following:

<UL><LI>The retail Setup of Microsoft Access version 1.1.

<LI>A workstation Setup (/n) from the version 1.1 upgrade disks.

<LI>A custom application developed with the Microsoft Access
   Distribution Kit (ADK).
<P>
</UL><h2>CAUSE</h2>
 
<P>
This problem is caused by the detection and implementation of sharing
mechanisms.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Run Windows in 386 enhanced mode during Setup. You may then switch
back to standard mode to run your applications.
<P>
NOTE: This problem is solely confined to the Setup process. In no way
does it affect how Microsoft Access runs in either standard or 386
enhanced mode.
<P>
If for some reason you cannot run Microsoft Windows in 386 enhanced
mode, modify STFSETUP.IN_ as described below. Separate procedures
follow for retail, upgrade, and ADK users.
<P>
<P><h3>Steps for Retail Users</h3>
 

<OL><P><LI>Make a backup copy of Disk1.

<P><LI>On the backup disk, use an editor to modify the STFSETUP.IN_ file.
   Change the [System Paths] section from
<P>
   [System Paths]
<P><PRE>      SYSTEMPATH = "" ? DETCMD.DLL GetWindowsSysDir
      WINDOWSPATH = "" ? DETCMD.DLL GetWindowsDir
      HARDDRIVELIST  = "" ? DETCMD.DLL GetAllValidLocalHardDrives
      NETDRIVELIST = "" ? DETCMD.DLL GetAllValidNetworkDrives
</PRE><P>
   to
<P>
   [System Paths]
<P><PRE>      SYSTEMPATH = "" ? DETCMD.DLL GetWindowsSysDir
      WINDOWSPATH = "" ? DETCMD.DLL GetWindowsDir
      HARDDRIVELIST = "" ? DETCMD.DLL GetAllValidLocalHardDrives
      NETDRIVELIST = "" ? DETCMD.DLL GetAllValidNetworkDrives
      WINDOWSMODE = "" ? DETCMD.DLL GetWindowsMode
</PRE>
<P><LI>Then change the following
<P>
<P><PRE>    DoShareStuff = +
     set CurrentDialog = DoShareStuff
     set MAKEBAK = "NO"
     ui start VSHARERunning
     ifstr $(ANSWER) == "NO"
</PRE><P>
   to
<P>
<P><PRE>    DoShareStuff = +
     set CurrentDialog = DoShareStuff
     set MAKEBAK = "NO"
     ifstr $(WINDOWSMODE) != "ENHANCED"
<PRE></PRE>        set ANSWER = "NO"
     else
        ui start VSHARERunning
     endif
     ifstr $(ANSWER) == "NO"

</PRE></OL><h3>Steps for Version 1.1 Upgrade Users</h3>
 
<P>
Single-user upgrades and Admin upgrades (setup /a) work fine. However,
to run Setup or setup /n from the network with Windows in standard
mode, you must first make the changes mentioned above to the
STFSETUP.IN_ file in the ACCESS\INSTALL subdirectory on the network.
<P>
<P><h3>Steps for ADK Users</h3>
 
<P>
The ADK Setup works fine in Windows standard mode. However, before you
create disks for your application, modify the SETUPWIZ.IN_ file (and
optionally the CUST12MB.IN_, CUST14MB.IN_, and CUST720K.IN_ files) as
follows:

<OL><P><LI>Change the following
<P>
   [System Paths]
<P><PRE>       SystemPath =  "" ? DETCMD.DLL GetWindowsSysDir
<PRE></PRE>       WindowsPath     =  "" ? DETCMD.DLL GetWindowsDir
       HARDDRIVELIST   = "" ? DETCMD.DLL GetAllValidLocalHardDrives
       NETDRIVELIST = "" ? DETCMD.DLL GetAllValidNetworkDrives

   to

   [System Paths]
       SystemPath =  "" ? DETCMD.DLL GetWindowsSysDir
       WindowsPath     =  "" ? DETCMD.DLL GetWindowsDir
       HARDDRIVELIST   = "" ? DETCMD.DLL GetAllValidLocalHardDrives
       NETDRIVELIST = "" ? DETCMD.DLL GetAllValidNetworkDrives
       WINDOWSMODE =  "" ? DETCMD.DLL GetWindowsMode

   NOTE: Unlike the Microsoft Access version 1.1 corrections, the first
   two variables in the [System Paths] section of the ADK is
   case-sensitive.

</PRE><P><LI>Add the test case around VSHARERunning by changing the following
   from
<P>
<P><PRE>    DoShareStuff = +
     set CurrentDialog = DoShareStuff
     set MAKEBAK = "NO"
     ui start VSHARERunning
     ifstr $(ANSWER) == "NO"
</PRE><P>
   to
<P>
<P><PRE>    DoShareStuff = +
     set CurrentDialog = DoShareStuff
     set MAKEBAK = "NO"
     ifstr $(WINDOWSMODE) != "ENHANCED"
<PRE></PRE>        set ANSWER = "NO"
     else
        ui start VSHARERunning
     endif
     ifstr $(ANSWER) == "NO"

</PRE></OL>NOTE: This is exactly the same change as the Microsoft Access version
1.1 change.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
1.1 and the Microsoft Access Distribution Kit version 1.1. This problem no
longer occurs in Microsoft Access version 2.0 or the Microsoft Access
Developer's Toolkit version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Windows in standard mode (win /s), using the Microsoft Access
   version 1.1 Retail disks.

<P><LI>Insert Disk 1 into drive A for 3.5-inch disks (or B for 5.25-inch
   disks).

<P><LI>From the File menu in Program Manager, choose Run.

<P><LI>Type a:\setup (or b:\setup) and press ENTER.

<P><LI>Follow the instructions on your screen.
<P>
</OL>When you insert the last disk, you will receive this error.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: gpf<BR>
Keywords            : kbsetup StpOthr<BR>
Version             : 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
