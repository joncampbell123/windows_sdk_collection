

<HTML>
<HEAD>
<TITLE>ACC95: Overview of Conversion Issues </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136064">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1995/08/31">
<META NAME="Keywords" CONTENT="CnvProb kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Microsoft Access for Windows 95 version 7.0 has many enhancements, such as 32-bit architecture, Visual Basic for Applications, the Microsoft Jet data base engine version 3.0, and...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAB4,QAZV,QAH4,QAEQ,QATJ,QA28,QAPN,QAC1,QA7O,QAOE,QAMN,QAGI,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Overview of Conversion Issues</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136064</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Microsoft Access for Windows 95 version 7.0 has many enhancements, such as
32-bit architecture, Visual Basic for Applications, the Microsoft Jet data
base engine version 3.0, and a modified data access objects (DAO) model. To
take full advantage of these features, you should convert your databases
created in an earlier version of Microsoft Access to Microsoft Access
version 7.0.
<P>
Most Microsoft Access version 2.0 (or 1.x) databases can convert to version
7.0 without difficulty. In rare cases, however, new features can conflict
with existing objects and code. This article discusses the following few
issues that you may encounter when converting a database to version 7.0:

<UL><LI>Code Cannot Compile

<LI>Conversion Process is Slow

<LI>16-bit API Calls Do Not Convert

<LI>Custom Controls Do Not Convert

<LI>Table Exceeds Limit of 32 Indexes

<LI>Name Conflict Stops Conversion
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Code Cannot Compile</h3>
 
<P>
When you convert a database to version 7.0, the conversion utility converts
Access Basic code to Visual Basic for Applications and compiles the updated
code. If any code does not successfully compile, you may receive the
following error message after you convert a database to version 7.0:
<P>
<PRE>   There were compilation errors during the conversion or enabling of
   this database.

   This database has not been saved in a compiled state. The performance
   of this database will be impaired because Microsoft Access will need to
   recompile the database for each session. For information on improving
   performance, click Help.

</PRE>To resolve this error, open a module in Design view and click Compile
All Modules on the Run menu. As Microsoft Access compiles your code, it
stops at any line that contains an error. You can then modify the
syntax to resolve the compile error.
<P>
NOTE: In rare instances, the conversion utility may fail to convert some
syntax. For example, it may fail to modify a DoCmd statement, such as the
following,
<P>
<PRE>   DoCmd OpenForm "MyForm"

</PRE>into a DoCmd method:
<P>
<PRE>   DoCmd.OpenForm "MyForm"

</PRE>You may also receive the compile error message if your Microsoft Access 2.0
database contains syntax errors. Therefore, it is good practice to fully
compile your Microsoft Access 2.0 (or 1.x) databases before you convert
them to Microsoft Access 7.0.
<P>
<P><h3>Conversion Process Is Slow</h3>
 
<P>
If you have a large database, the conversion process may take a long time
or your computer may appear to stop responding (hang). The more objects
that you have, the longer it takes to update the code and objects to
version 7.0.
<P>
To speed the conversion process, try using the Import command instead of
the Convert Database command by following these steps:

<OL><P><LI>Create a new Microsoft Access version 7.0 database.

<P><LI>On the File menu, click Get External Data, and then click Import.

<P><LI>In the Import dialog box, make sure Microsoft Access (.mdb) is selected
   in the Files Of Type box.

<P><LI>Click the arrow to the right of the Look In box, select the drive and
   folder (directory) where the Microsoft Access database (.mdb) you want
   to import is located, and then double-click the database's icon.

<P><LI>Click 20 or so objects to import.

<P><LI>Click OK to import the selected objects.

<P><LI>Repeat steps 2-6 until all the objects are imported into the new
   database. Note that Microsoft Access converts the object to the new
   version 7.0 format as it is imported.
<P>
</OL>Importing database objects may increase the size of your database;
therefore, once the import is complete, compact the database. If you do
choose to convert a large database, make sure that you compact it into a
new file rather than replacing the original file.
<P>
<P><h3>16-bit API Calls Do Not Convert</h3>
 
<P>
If your modules contain 16-bit API calls, you may receive the following
error message when you convert the database to version 7.0:
<P>
<PRE>   There are calls to 16-bit dynamic-link libraries (.dll) in modules
   in this database. These won't work under Microsoft Windows 95
   or Microsoft Windows NT.

</PRE></OL>To resolve this error, you must change the API Declare statements in the
converted database to their 32-bit equivalents. For more information about
32-bit equivalents for 16-bit API calls, search on the phrase "converting
code," and then view "Converting code that calls a DLL" using the Answer
Wizard from the Microsoft Access for Windows 95 Help menu.
<P>
<P><h3>Custom Controls Do Not Convert</h3>
 
<P>
When you convert to version 7.0, you may receive the following error
message if your database contains an OLE custom control:
<P>
<PRE>   One or more forms or reports contains a 16-bit OLE Custom Control
   with no 32-bit equivalent. These controls will not function
   properly under Microsoft Windows 95 or Microsoft Windows NT.

</PRE>Microsoft Access version 2.0 supports 16-bit OLE custom controls whereas
Microsoft Access version 7.0 supports 32-bit OLE custom controls. When you
convert a database that uses a 16-bit custom control to version 7.0,
Microsoft Access can automatically update the control to its 32-bit version
only if a 32-bit version exists and is registered on your computer. If you
do not have a 32-bit version of a 16-bit control, then Microsoft Access may
generate the error message listed above.
<P>
For more information about converting OLE custom controls, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q138019.htm">Q138019</A></B>
   TITLE     : 16-bit OLE Controls Not Supported in Version 7.0

</PRE><h3>Table Exceeds Limit of 32 Indexes</h3>
 
<P>
If your database contains a table with 32 or more indexes and relationships
combined, you may receive the following error message when you convert to
version 7.0:
<P>
<PRE>   Operation failed. There are too many indexes on table '&lt;table name&gt;'.
   Delete some of the indexes on the table and try the operation again.

</PRE>The Microsoft Jet database engine version 3.0 has a limit of 32 indexes per
table. When you create a relationship and enforce referential integrity, an
index is created for the foreign key table. If the number of relationships
exceeds 32, then the number of indexes on the "foreign key-side" also
exceeds 32.
<P>
To resolve this error, open your database in version 2.0 (or 1.x)
and modify your table design to reduce the number of relationships for the
primary key table or remove some indexes from the foreign key table. Then,
you can try to convert the database to version 7.0.
<P>
This resolution assumes that you have version 2.0 (or 1.x) installed on
your computer, as well as version 7.0. If you replaced version 2.0 (or 1.x)
with version 7.0 using the same folder (directory) on your computer, then
you must re-install version 2.0 (or 1.x). You may want to re-install into a
different folder so that you have both versions available for resolving the
conversion problem.
<P>
<P><h3>Name Conflict Stops Conversion</h3>
 
<P>
If a module has the same name as a type library, such as "DAO", "VBA", or
"Access," the conversion process stops and Microsoft Access displays the
following error message:
<P>
<PRE>   Name conflicts with existing module, project, or object library.

</PRE>To resolve this error, open the database in Microsoft Access version 2.0
(or 1.x) and rename the object.
<P>
This resolution assumes that you have version 2.0 (or 1.x) installed on
your computer as well as version 7.0. If you replaced version 2.0 (or 1.x)
with version 7.0 using the same folder on your computer, then you must re-
install version 2.0 (or 1.x). You may want to re-install into a different
folder so that you have both versions available for resolving the
conversion problem.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about conversion and compatibility issues, search for
"conversion and compatibility" using the Answer Wizard from the Microsoft
Access 7.0 Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : CnvProb kbusage<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
