

<HTML>
<HEAD>
<TITLE>ACC2: "Invalid Operation" Error Msg. Running QueryDef Example </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124341">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1994/12/28">
<META NAME="Keywords" CONTENT="DcmMnl kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you run the sample QueryDef code on page 251 of the Microsoft Access version 2.0  Building Applications  manual, you receive the error message  Invalid operation.   CAUSE ==...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA1S,QAB4,QAH4,QBXS,QDN9,QAAP,QAW6,QAPF,QA5V,QA5F,QAY5,QAMA,QBWS,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: "Invalid Operation" Error Msg. Running QueryDef Example</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124341</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you run the sample QueryDef code on page 251 of the Microsoft Access
version 2.0 "Building Applications" manual, you receive the error message
"Invalid operation."
<P>
<P><h2>CAUSE</h2>
 
<P>
This error occurs because the Append method is used incorrectly with the
QueryDefs collection. Although the Append method is a valid method for
the QueryDefs collection, it is used incorrectly in the sample code.
<P>
The CreateQueryDef method creates a new QueryDef object and appends it to
the QueryDefs collection if it is supplied with a valid name. If you try to
append the QueryDef object again using the Append method, you receive an
error message because the QueryDef object has already been appended to the
collection.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The sample code on page 251 should read as follows.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.
<P>
<PRE>   Dim MyDB As Database, MyQuery as QueryDef
   Set MyDB = DBEngine.Workspaces(0).Databases(0)

   ' Create QueryDef.
   Set MyQuery = MyDB.CreateQueryDef("All Cust", "SELECT * FROM _
   Customers;")

   ' Set SQL property.
   MyQuery.SQL = "UPDATE DISTINCTROW Products SET _
   Products![Supplier ID] = 2 WHERE Products![Supplier ID] = 1;"

   MyQuery.Execute          ' Invoke query.
   MyQuery.Close            ' Close query.

</PRE><h2>STATUS</h2>
 
<P>
This behavior no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the Append method with the QueryDefs collection when the
CreateQueryDef method does not assign a name to the QueryDef object, as
in the following example:
<P>
<PRE>   Dim MyDB As Database, MyQuery As QueryDef
   Set MyDB = DBEngine.Workspaces(0).Databases(0)

   ' Create QueryDef object without a name.
   Set MyQuery = MyDB.CreateQueryDef()
   MyQuery.Name = "All Cust"
   MyQuery.SQL = "SELECT * FROM Customers;"
   MyDB.QueryDefs.Append MyQuery

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 11,
"Working with Sets of Records," page 251
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kberrmsg<BR>
Keywords            : DcmMnl kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
