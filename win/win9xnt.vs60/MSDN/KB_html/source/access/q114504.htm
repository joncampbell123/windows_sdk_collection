

<HTML>
<HEAD>
<TITLE>ACC1x: How to Disable PAGE UP and PAGE DOWN Keys in a Form (1.x) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114504">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1994/05/05">
<META NAME="Keywords" CONTENT="FmsOthr kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  This article describes the following two techniques that you can use to disable the use of the PAGE UP and PAGE DOWN keys in a form:   - Open the form as a Dialog form using the OpenForm macro action.     -or-   - Use the Windows API GetKeyState() ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXQ,QA1S,QDN9,QAPN,QAY5,QAH4,QAP2,QAB9,QBV8,QBXS,QA01,QAGI,QAI2,QDL9,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Disable PAGE UP and PAGE DOWN Keys in a Form (1.x)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114504</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes the following two techniques that you can use to
disable the use of the PAGE UP and PAGE DOWN keys in a form:

<UL><LI>Open the form as a Dialog form using the OpenForm macro action.
<P>
   -or-

<LI>Use the Windows API GetKeyState() function call to trap the PAGE UP
   and PAGE DOWN keys.
<P>
</UL>NOTE: This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual in Microsoft Access version
1.x, or the "Building Applications" manual in version 2.0.
<P>
CAUTION: Re-creating the examples in this article will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1: Opening the Form as Dialog Using the OpenForm Macro Action</h3>
 
<P>
The PAGE UP and PAGE DOWN keys will be inoperative in a form if the form is
opened using an OpenForm macro action with the Window Mode argument set to
Dialog. To demonstrate this technique, create a new macro in the sample
database NWIND.MDB with the following action:
<P>
<PRE>   OpenForm
      Form Name: Customers
      Filter Name: &lt;leave empty&gt;
      Where Condition: &lt;leave empty&gt;
      View: Form
      Data Mode: Edit
      Window Mode: Dialog

</PRE>The drawback to this technique is that a Dialog form cannot use a custom
menu, nor will you be able to switch to another form while the dialog form
is open.
<P>
NOTE: The Microsoft Access Wizards use this technique to limit navigation
in multiple-page forms.
<P>
<P><h3>Method 2: Using the GetKeyState() API Call to Trap PAGE UP and PAGE DOWN</h3>
 
<P>
The following sample user-defined function, DisablePGUP_PGDN(),
demonstrates how to use the GetKeyState() Windows API call to detect and
trap the PAGE UP and PAGE DOWN keys. Attach this function to the OnExit
property of all the controls on a form where the PAGE UP and PAGE DOWN keys
should be disabled.
<P>
NOTE: You may have some Microsoft Windows API functions defined in an
existing Microsoft Access library; therefore, your declarations may be
duplicates. If you receive a duplicate procedure name error message, remove
or comment out the declarations statement in your code.

<OL><P><LI>Create a new module with the following in the Declarations section:
<P>
<P><PRE>      Option Explicit
      Global Const VK_PRIOR = &amp;H21  ' PAGE UP
<PRE></PRE>      Global Const VK_NEXT = &amp;H22   ' PAGE DOWN
      Declare Function GetKeyState% Lib "user.exe" (ByVal nKey%)

</PRE><P><LI>Enter the following function in the module:
<P>
<P><PRE>      Function DisablePGUP_PGDN()
<PRE></PRE>         If GetKeyState(VK_PRIOR) &lt; 0 Or GetKeyState(VK_NEXT) &lt; 0 Then
            DoCmd CancelEvent
         End If
      End Function

</PRE></OL>To demonstrate the use of this function, open the Customers form in the
NWIND.MDB database and alter the OnExit property of each control on the
form to:
<P>
<PRE>   =DisablePGUP_PGDN()

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the OnKeyPress function in version 2.0,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q114506.htm">Q114506</A></B>
   TITLE     : ACC2: How to Disable PAGE UP and PAGE DOWN Keys in
               a Form (2.0)

</PRE>Microsoft Access "Language Reference," versions 1.0 and 1.1, pages 348-349
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pgup pgdn<BR>
Keywords            : FmsOthr kbusage<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
