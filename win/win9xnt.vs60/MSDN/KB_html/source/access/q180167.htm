

<HTML>
<HEAD>
<TITLE>ACC: No Warning Closing a Form with a Required Field Left Null </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180167">
<META NAME="KBModify" CONTENT="1998/01/30">
<META NAME="KBCreate" CONTENT="1998/01/29">
<META NAME="Keywords" CONTENT="FmsEvnt GnlDe">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use code (for example, on a command button) to close a form that contains a control bound to a field that has its Required property set to Yes, and no data is entered fo...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QAAW,QBJZ,QA7O,QA1S,QA7N,QALM,QAB4,QAH4,QAPN,QDN9,QA5V,QADK,QAFY,QAUJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: No Warning Closing a Form with a Required Field Left Null</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 30, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180167</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use code (for example, on a command button) to close a form that
contains a control bound to a field that has its Required property set to
Yes, and no data is entered for that control, you do not receive an error
message.
<P>
If you close the same form by using the Windows Close button, the Close
action in a macro, or by clicking Close on the File menu, you do receive
the following message as expected:
<P>
<PRE>   The field '&lt;tablename&gt;.&lt;fieldname&gt;' can't contain a null value
   because the Required property for this field is set to True.
   Enter a value in this field.

   -or-

   Field '&lt;tablename&gt;.&lt;fieldname&gt;' can't contain a null value.

</PRE><h2>RESOLUTION</h2>
 
<P>
By default, the changes to the record will be aborted without warning. If
you need to check whether data has been entered in the required field, you
will need to do so manually in code, as shown in the following example:

<OL><P><LI>Start Microsoft Access and create a new database.

<P><LI>Create the following new table:
<P>
<PRE>      Table:   Table1
      ------------------
      Field Name: Field1
         Data Type: Text
          Required:  Yes
      Field Name: Field2
         Data Type: Text
          Required:   No

</PRE><P><LI>Close and save the table as Table1. Do not add a primary key when
   prompted.

<P><LI>In the Database window, select the Table1 table, and then on the Insert
   menu, click AutoForm.

<P><LI>View the form in Design view and add a new command button as follows:
<P>
<P><PRE>      Name: CloseForm
      Caption: Close Form
</PRE>
<P><LI>Set the CloseForm command button's OnClick property to the following
   event procedure:
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. If you are using
   Microsoft Access 2.0, remove the underscore from the end of the line
   when re-creating this code.
<P>
<P><PRE>      If IsNull(Me![Field1]) Then
<PRE></PRE>        If MsgBox("'Field1' must contain a value." &amp; Chr(13) &amp; Chr(10) &amp; _
        "Press 'OK' to return and enter a value." &amp; Chr(13) &amp; Chr(10) &amp; _
        "Press 'Cancel' to abort the record.", _
        vbOKCancel, "A Required field is Null") = vbCancel Then
             DoCmd.Close
             ' For Access 2.0 remove the previous line and replace with:
             ' DoCmd Close
        Else
             Me![Field1].SetFocus
        End If
      Else
        DoCmd.Close
      End If

</PRE><P><LI>View the form in Form View.

<P><LI>Type any data in Field2 and click the Close Form button. Note that you
   receive a message stating that Field1 must contain a value.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and create a new database.

<P><LI>Create the following new table:
<P>
<PRE>      Table:   Table1
      ------------------
      Field Name: Field1
         Data Type: Text
          Required:  Yes
      Field Name: Field2
         Data Type: Text
          Required:   No

</PRE><P><LI>Close and save the Table1 table. Do not add a primary key when prompted.

<P><LI>In the Database window, select the Table1 table, and then on the Insert
   menu, click AutoForm.

<P><LI>View the form in Design view and add a new command button as follows:
<P>
<P><PRE>      Name: CloseForm
      Caption: Close Form
</PRE>
<P><LI>Add the following code to the Click event of the CloseForm button.
<P>
   In Microsoft Access 95 or 97:
<P>
<P><PRE>      DoCmd.Close
</PRE><P>
   In Microsoft Access 2.0:
<P>
<P><PRE>      DoCmd Close
</PRE>
<P><LI>On the View menu, select Form View.

<P><LI>Type any data in Field2 and click the Close Form command button.
<P>
</OL>Note that the form closes without any error message and the record is not
saved.
<P>
However, if you close the form by using the Windows Close button or by
clicking Close on the File menu, you do receive the messages mentioned in
the "Symptoms" section.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Close method, search the Help Index for
"Close Method."
<P>
For more information about the Required property, search the Help Index for
"Required Property."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: record missing<BR>
Keywords          : FmsEvnt GnlDe<BR>
Version           : WINDOWS:2.0,7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 30, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
