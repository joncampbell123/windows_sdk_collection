

<HTML>
<HEAD>
<TITLE>ACC: Event Procedure Disappears When a Control Is Renamed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113876">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1994/04/19">
<META NAME="Keywords" CONTENT="FmsEvnt kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Event procedure code does not run when you expect it to.  CAUSE =====  You changed the Name property of the control that has the event procedure code. When you change a control's...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAO4,QAH4,QAUJ,QAB9,QAFF,QA1S,QA7O,QAMN,QAB5,QAOE,QARM,QDN9,QABA,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Event Procedure Disappears When a Control Is Renamed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113876</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Event procedure code does not run when you expect it to.
<P>
<P><h2>CAUSE</h2>
 
<P>
You changed the Name property of the control that has the event procedure
code. When you change a control's name by changing its Name property, the
event procedure code name, which is made up of the control name and the
event name, does not change to reflect the new control name.
<P>
This behavior is consistent with Microsoft Visual Basic behavior.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To restore the original event procedure, do either of the following:

<UL><LI>Copy the code from the original event procedure and paste it into
   the new event procedure.
<P>
   -or-

<LI>Delete the new event procedure code, including the beginning Sub and
   ending End Sub lines, and then rename the original event procedure to
   the correct name for the control.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Access creates the name of the procedure in an event procedure
using a combination of the control name and the event name. For example,
the procedure name for an event procedure in the OnClick property of a
command button control named MyButton might be MyButton_Click. The first
line of the event procedure would be:
<P>
<PRE>   Sub MyButton_Click ()

</PRE>If you rename the button, the OnClick property will still have an
associated event procedure, but the original event procedure will not be
renamed accordingly. Instead, a new, empty event procedure will be called
by the button's OnClick property.
<P>
The MyButton_Click subprocedure is still a part of the form, however. To
access it in the form's module, select General in the Object box on the
module toolbar, and then select MyButton_Click in the Procedure box.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form not based on any table or query.

<P><LI>Add a command button to the form. Note that Microsoft Access
   automatically names the button Button0.

<P><LI>In the property sheet, click the Build button for the OnClick property.

<P><LI>In the Choose Builder dialog box, click Code Builder, and then click
   OK. Note that Microsoft Access automatically creates the following
   code for the event:
<P>
<PRE>      Sub Button0_Click ()

      End Sub

</PRE><P><LI>Modify the event code to match the following, and then close the form
   module:
<P>
<PRE>      Sub Button0_Click ()
         Msgbox "This is a test"
      End Sub

</PRE><P><LI>In the property sheet, change the Name property from Button0 to
   MyButton.

<P><LI>Click the Build button for the OnClick property. Note that the
<PRE>   Sub procedure you created in step 5 no longer shows in the module.
   Instead, a new, empty Sub procedure has been created, using the
   control's new name.

</PRE></OL>To restore the original event procedure, follow these steps:

<OL><P><LI>Delete the entire Sub procedure.

<P><LI>In the Procedure box on the toolbar, select Button0_Click.

<P><LI>Change the first line of the Sub procedure from
<P>
<PRE>      Sub Button0_Click ()

   to:

      Sub MyButton_Click ()

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about creating event procedures, search the Help Index
for "event procedures," or ask the Microsoft Access 97 Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsEvnt kbusage<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
