

<HTML>
<HEAD>
<TITLE>PRB: "Data Type Conversion Error" When Using a Data Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172101">
<META NAME="KBModify" CONTENT="1997/09/25">
<META NAME="KBCreate" CONTENT="1997/07/29">
<META NAME="Keywords" CONTENT="vb432 VB4WIN vb5all kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Deleting the data from a text box bound to certain data types, such as an integer or date, causes Error 3421:      Data Type Conversion Error.   NOTE: If you are using a dbGrid, it's Error Method will produce Error 16389.  CAUSE =====  This is desi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA7O,QAB5,QAYY,QAOE,QAMN,QBV4,QAAP,QAB4,QBT6,QAHP,QAEF,QA5B,QA4Q,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Data Type Conversion Error" When Using a Data Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172101</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   32-bit only, for Windows, version 4.0
<LI>Microsoft Visual Studio 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Deleting the data from a text box bound to certain data types, such as an
integer or date, causes Error 3421:
<P>
<PRE>   "Data Type Conversion Error."

</PRE>NOTE: If you are using a dbGrid, it's Error Method will produce Error
16389.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is designed behavior of DAO. The data control is sending a NULL string
to DAO and DAO attempts to coerce it to a number and fails. This is not a
problem with the Data Control: The same behavior can be observed without
the use of a Data Control, using only code. For example:
<P>
<PRE>   Set db = OpenDatabase("nwind.mdb", False, False)
   Set rs = db.OpenRecordset("select shipvia from orders", dbOpenDynaset)
   rs.Edit
   rs(0) = ""

</PRE><h2>RESOLUTION</h2>
 
<P>
Use the following code in the Data Controls Validate method to allow the
edit to occur as expected by user:
<P>
<PRE>   Private Sub Data1_Validate(Action As Integer, Save As Integer)
      If Text1.DataChanged Then
         Text1.DataChanged = False 'So this data is not saved
         Data1.UpdateRecord  ' This saves the data that
                             ' may have changed in the other controls

         ' Now clear the numeric field
         Data1.Recordset.Edit
         Data1.Recordset![Year Born] = Null
         Data1.Recordset.Update
     End If
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Place a data control and a textbox on a form.

<P><LI>Bind the textbox to an integer column of a table.

<P><LI>Delete the data from the text box.

<P><LI>Move off the record. Note that you get the "data type conversion error
   in the error event of the data control. This happens with Jet 3.5, 3.0,
   or 2.5, but does not happen in 16-bit Visual Basic.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: empty<BR>
Keywords          : vb432 VB4WIN vb5all kberrmsg<BR>
Version           : WINDOWS:4.0 5.0 Visual Studio:97<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
