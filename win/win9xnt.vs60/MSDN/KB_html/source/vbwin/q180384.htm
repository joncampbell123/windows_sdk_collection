

<HTML>
<HEAD>
<TITLE>HOWTO: Troubleshoot Run-time Error '70' in DCOM Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180384">
<META NAME="KBModify" CONTENT="1998/02/10">
<META NAME="KBCreate" CONTENT="1998/02/03">
<META NAME="Keywords" CONTENT="vb5all vb5howto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Attempting to access a DCOM Server from a remote client application sometimes results in the following error:     Run-time error '70':    Permission Denied  This article describes the most common scenarios in which this error is raised.  MORE INFOR...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBWG,QBWP,QBW7,QDK6,QAGU,QAK7,QAAP,QA1S,QAB4,QABA,QARL,QABO,QBWS,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Troubleshoot Run-time Error '70' in DCOM Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180384</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Attempting to access a DCOM Server from a remote client application
sometimes results in the following error:
<P>
<PRE>   Run-time error '70':
   Permission Denied

</PRE>This article describes the most common scenarios in which this error is
raised.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Run-time error '70' is typically the result of a security or permissions
issue. The following is a list of possible causes of run-time error 70 but
is by no means a complete or definitive list.
<P>
<P><h3>DCOM Is Not Enabled</h3>
 
<P>
If the Server machine does not have DCOM enabled, client machines will
receive run-time error 70 when attempting to access the server. This
scenario applies to both Windows NT and Windows 95 servers:

<OL><P><LI>On the Server machine, run DCOM Config (DCOMCNFG.EXE).

<P><LI>Choose the Default Properties tab.

<P><LI>Endure that Enable Distributed COM on this computer is checked. This
   value is stored in the Windows Registry at the following location:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\Software\Microsoft\OLE
</PRE><P>
</OL><h3>The Client User Does Not Have Sufficient Permissions</h3>
 
<P>
If the client user does not have the correct permissions, access to the
DCOM Server can be denied. There are several steps to take in order to
ensure your client has valid privileges.
<P>
If the Server is Windows 95:

<OL><P><LI>Run DCOM Config.

<P><LI>Select the DCOM Server application from the list of available
   applications.

<P><LI>Select the Properties button, or double-click the DCOM Server
   application in the list.

<P><LI>Test the server with "Default Access Permissions."
<P>
   If run-time error '70' still occurs, the default access permissions are
   restricting your user. If this is the case, then modify the Default
   Access Permissions from the Default Security tab in DCOM Config. Grant
   the client user access permissions.
   
   If run-time error '70' does not occur running with default access
   permissions, it is likely that the custom access permissions are
   restricting your client from accessing the DCOM Server. Choose custom
   access permissions and select the Edit button. Grant the client user
   access permissions.
<P>
</OL>If the Server is Windows NT:

<OL><P><LI>Run DCOM Config.

<P><LI>Select the DCOM Server application from the list of available
   applications.

<P><LI>Select the Properties button, or double-click the DCOM Server
   application in the list.

<P><LI>Test the server with "Default Access Permissions," "Default Launch
   Permissions," and "Custom Configuration Permissions."
<P>
   If run-time error '70' still occurs, it is likely that the default
   access permissions are restricting your user. If this is the case,
   modify the Default Access Permissions from the Default Security tab in
   DCOM Config.
   
   If run-time error '70' does not occur, it is likely that the custom
   access permissions are restricting your client from accessing the DCOM
   Server. Choose to use Custom access permissions and choose the Edit
   button. Grant the client user account access permissions, or grant a
   group the client user belongs to access permissions.
<P>
</OL>For more information regarding security groups on Windows NT see the table
below.
<P>
There are several group accounts you will find when you configure users and
groups on Windows NT. The following list is a summary of who belongs to
each group:
<P>
<PRE>Group                     Description
</PRE></OL> 
<PRE>Interactive               Includes all users who log onto a Windows NT
                          system locally (at the console). It does not
                          include users who connect to NT resources across
                          a network or are started as a server.

Network                   Includes all users who connect to Windows NT
                          resources across a network. It does not include
                          those who connect through an interactive logon.

Creator/Owner             The Creator/Owner group is created for each
                          sharable resource in the Windows NT system. Its
                          membership is the set of users who either create
                          a resource (such as a file) and who take
                          ownership of them.

Everyone                  All users who access the system, whether locally,
                          remotely, or across the network.

System                    The local operating system.

</PRE>The above list includes the group accounts which are intrinsic to Windows
NT systems. Your particular network may include more groups from which you
may choose. In order to determine the membership of each custom group
account, you must contact your network administrator.
<P>
<P><h3>Attempting to Access DCOM Server Across Non-Trusted Domains</h3>
 
<P>
If your DCOM Server resides in one NT domain, and your client logs on to a
second NT domain that is not "trusted" by the first, you will receive run-
time error '70' when attempting to access the DCOM Server.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../oleprog/q158508.htm">Q158508</A></B>
   TITLE     : FAQ: COM Security Frequently Asked Questions

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q176799.htm">Q176799</A></B>
   TITLE     : INFO: Using DCOM Config (DCOMCNFG.EXE) on Windows NT

</PRE> 
<PRE>Keywords          : vb5all vb5howto
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
