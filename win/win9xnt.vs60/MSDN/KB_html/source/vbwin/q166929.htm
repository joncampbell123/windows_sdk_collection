

<HTML>
<HEAD>
<TITLE>BUG: DBCombo Control Change Event Does Not Fire </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166929">
<META NAME="KBModify" CONTENT="1997/06/02">
<META NAME="KBCreate" CONTENT="1997/04/15">
<META NAME="Keywords" CONTENT="vb5all VBKBCtrl VBKBDB">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Program code in the Change event procedure of Microsoft Visual Basic version 5.0 will not execute. Applications written using Visual Basic version 4.0 may no longer work as expected if functionality is based on responding to a Change event in a DBC...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QAO4,QBS0,QA7O,QAUJ,QAOE,QAMN,QAB5,QACI,QBWS,QBXS,QAVX,QAGI,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: DBCombo Control Change Event Does Not Fire</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166929</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Program code in the Change event procedure of Microsoft Visual Basic
version 5.0 will not execute. Applications written using Visual Basic
version 4.0 may no longer work as expected if functionality is based on
responding to a Change event in a DBCombo control.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The resolution to this behavior is to replace the functional code of the
Change event procedure with equivalent code entered in the Click event
procedure. This code is conditioned by testing the DataChanged property of
the DBCombo control.
<P>
An example of this workaround is as follows:
<P>
<PRE>   Private Sub DBCombo1_Click(Area As Integer)
      If DBCombo1.DataChanged Then
         ' Any code that would normally be in the Change Event
         ' or call the Change event like this: DBCombo1_Change
         ' followed by code that resets the DataChanged property, such as:
         DBCombo1.DataChanged = False
      End IF
   End Sub

</PRE>If the user normally tabs to the DBCombo control and then uses arrow keys
to navigate to an item in the list, similar code would be required in the
KeyPress, KeyDown and/or KeyUp event procedures. In this case, it would be
more effective to write a single form-level module to replace the code of
the DBCombo Change event and call it from the various places where the
DBCombo.DataChanged property would be tested.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new Standard EXE project. Form1 is created by default.

<P><LI>On Form1, place two Data Controls named Data1 and Data2.

<P><LI>Set the following values for the properties of Data1:
<P>
<PRE>   Name            Data1
   DatabaseName    C:\Program Files\DevStudio\VB\Biblio.mdb (or the
                   appropriate path to that database)
   RecordsetType   0 - Table
   RecordSource    Titles

</PRE><P><LI>Set the following values for the properties of Data2:
<P>
<PRE>   Name            Data2
   DatabaseName    C:\Program Files\DevStudio\VB\Biblio.mdb (or the
                   appropriate path to that database)
   RecordsetType   2 - Snapshot
   RecordSource    SELECT PubID, Name FROM Publishers ORDER BY Name

</PRE><P><LI>Place a DBCombo control on the form.

<P><LI>Set the following values for the properties of DBCombo1:
<P>
<PRE>   Name            DBCombo1
   BoundColumn     PubID
   DataField       PubID
   DataSource      Data1
   ListField       Name
   RowSource       Data2
   Style           0 – dbcDropDownCombo

</PRE><P><LI>In the module for the form, enter the following:
<P>
<P><PRE>      Private Sub DBCombo1_Change()
<PRE></PRE>         Debug.Print "In the Change Event Method"
      End Sub

</PRE><P><LI>Run the form. Click the down arrow to the DBCombo to open the list
   portion.

<P><LI>Click any line in the list portion. Observe the Immediate (Debug)
   Window.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : vb5all VBKBCtrl VBKBDB<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
