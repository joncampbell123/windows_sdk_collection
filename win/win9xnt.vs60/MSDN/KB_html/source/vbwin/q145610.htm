

<HTML>
<HEAD>
<TITLE>How to Change Color of Individual Cell in Grid Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145610">
<META NAME="KBModify" CONTENT="1997/03/18">
<META NAME="KBCreate" CONTENT="1996/02/04">
<META NAME="Keywords" CONTENT="kbprg PrgCtrlsCus vb4all vb4win">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Grid custom control does not allow different colors in individual cells. The example program below demonstrates how you can manipulate color of individual cells in the Grid custom control.  MORE INFORMATION  The example program shown below enab...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPG,QAFF,QBJZ,QAB5,QAMN,QAG9,QARR,QA7O,QAOE,QBWS,QDNZ,QAH4,QAGI,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Change Color of Individual Cell in Grid Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145610</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 4.00 | 3.00 4.00
<PRE>WINDOWS   | WINDOWS NT
</PRE>kbprg kbcode kbhowto
<P>
 
The information in this article applies to:
<P>
- Standard, Professional, and Enterprise Editions of Microsoft
<PRE>  Visual Basic, 16-bit and 32-bit, for Windows, version 4.0

</PRE>- Standard and Professional Editions of Microsoft Visual
<PRE>  Basic for Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Grid custom control does not allow different colors in individual
cells. The example program below demonstrates how you can manipulate color
of individual cells in the Grid custom control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The example program shown below enables you to have different background
colors for the cells of a grid. It also shows how to change the text color
in individual cells. It uses the Picture property of the grid and an
invisible picture box control.
<P>
<P><h3>Steps to Create Example Program</h3>
 

<OL><P><LI>Start Visual Basic or on the File menu, click New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>On the File menu, click Add File. Then select the GRID.VBX file. The
   Grid tool appears in the Toolbox. (In the case of Visual Basic 4.0,
   on the Tools menu, click Custom Controls. Then check the Microsoft Grid
   Control under the available controls. Finally, click OK).

<P><LI>Place a grid (Grid1), a picture box (Picture1) and 3 command buttons
   (Command1, Command2, Command3) on Form1. Set the Grid1 Cols and Rows
   properties both to 10. Then size the grid to show all the cells. Set the
   Picture1 AutoRedraw property to True and the Visible property to False.
   Make sure that the size of the Picture1 picture box is greater than that
   of the cell size of Grid1.

<P><LI>Place the following functions in the general section of Form1:
<P>
<P><PRE>    ' Enter the following on a single line.
    Sub SetGridCell (grd As Grid, RowNum%, ColNum%, BkClr&amp;, FrClr&amp;)
<PRE></PRE>        grd.Row = RowNum%
        grd.Col = ColNum%
        Picture1.BackColor = BkClr
        Picture1.ForeColor = FrClr
        Picture1.CurrentX = 0: Picture1.CurrentY = 0
        Picture1.Print grd.Text
        grd.Picture = Picture1.Image
    End Sub

    Sub ClearGrid (grd As Grid)
        Dim i%, j%
        For i = 1 To grd.Rows - 1
            For j = 1 To grd.Cols - 1
                grd.Row = i: Grid1.Col = j
                grd.Picture = LoadPicture("")
            Next j
        Next i
    End Sub

</PRE><P><LI>Enter the following code in the Form_Load procedure:
<P>
<PRE>   Sub Form_Load ()
        Dim i%, j%
        For i = 1 To Grid1.Rows - 1
            For j = 1 To Grid1.Cols - 1
                Grid1.Row = i: Grid1.Col = j
                ' Fill cell text so that "(i,j)" string is
                ' assigned to the cell in ith row, jth column.
                Grid1.Text = "(" &amp; CStr(i) &amp; "," &amp; CStr(j) &amp; ")"
            Next j
        Next i
   End Sub

</PRE><P><LI>Add the following code to the command button click event procedures:
<P>
<PRE>   Sub Command1_Click ()
      Dim i%, j%
      For i = 1 To Grid1.Rows - 1
          For j = 1 To Grid1.Cols - 1
           Call SetGridCell(Grid1, i, j, QBColor(i-1), QBColor(15))
          Next j
      Next i
   End Sub

   Sub Command2_Click ()
      Dim i%, j%
      For i = 1 To Grid1.Rows - 1
          For j = 1 To Grid1.Cols - 1
          Call SetGridCell(Grid1, i, j, QBColor(15), QBColor(j-1))
          Next j
      Next i
   End Sub

   Sub Command3_Click ()
      Call ClearGrid(Grid1)
   End Sub

</PRE><P><LI>Press the F5 key to run the program. Click Command1 to see the cells in
   different rows appear in different colors. Click Command2 to see text in
   cells of different columns appear in different colors. Click Command3 to
   reset the grid display.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode kbkhowto<BR>
KBSubcategory: PrgCtrlsCus vb4win vb4all<BR>
Additional reference words: 3.00 4.00<BR>
Keywords            : kbprg PrgCtrlsCus vb4all vb4win<BR>
Version             : 3.00 4.00 | 3.00 4.00<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
