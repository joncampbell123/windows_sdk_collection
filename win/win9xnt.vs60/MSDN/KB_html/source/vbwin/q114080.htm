

<HTML>
<HEAD>
<TITLE>How to Create and Use Multiple-Field Index in Visual Basic 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114080">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/04/24">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Indexes significantly speed up searches in Visual Basic. This article shows by example how to use a multiple-field index to perform a search on the BIBLIO.MDB database.  MORE INFORMATION  Creating a Multiple-Field Index  Before trying the example i...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QATJ,QA28,QAMB,QBWS,QAUJ,QAEB,QAC2,QBXS,QBJZ,QAMA,QDIV,QA7O,QA7N,QATX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create and Use Multiple-Field Index in Visual Basic 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114080</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Indexes significantly speed up searches in Visual Basic. This article shows
by example how to use a multiple-field index to perform a search on the
BIBLIO.MDB database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Creating a Multiple-Field Index</h3>
 
<P>
Before trying the example in this article, you need to use Data Manager,
which is located on the Window menu of the main Visual Basic menu, to
create a multiple-field index. Here are the steps:

<OL><P><LI>In Data Manager, from the File menu, choose Open Database Access.
   Double-click the BIBLIO.MDB database to open it.

<P><LI>Select the Publishers text. Then choose the Design button.

<P><LI>From the Design window, choose the Add button in the Indexes: section
   of the window.

<P><LI>Enter test1_idx for the Index Name.

<P><LI>Select the PubID field. Then click the Add(Asc) button.

<P><LI>Select the Name field. Then click the Add(Asc) button.

<P><LI>Select the Company Name field. Then click the Add(Asc) button.

<P><LI>Click the Done button.
<P>
</OL>You now have a multiple-field index named test1_idx with the following
fields in the following order:

<UL><LI>PubID
<LI>Name
<LI>Company Name
<P>
</UL><h3>Using the Multiple-Field Index</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Load the following into a text editor and fix all the two-line
   statements, so that each statement appears on one, single line. Then
   save the file as MULTIF.FRM.
<P>
  VERSION 2.00
  Begin Form MultiF
<PRE>   Caption         =   "Sample of using Multiple field index to Seek with"
   ClientHeight    =   4020
   ClientLeft      =   1095
   ClientTop       =   1485
   ClientWidth     =   7365
   Height          =   4425
   Left            =   1035
   LinkTopic       =   "Form1"
   ScaleHeight     =   4020
   ScaleWidth      =   7365
   Top             =   1140
   Width           =   7485
   Begin TextBox Text3
      Height          =   495
      Left            =   2040
      TabIndex        =   7
      Text            =   "Brady Books Div., Simon &amp; Schuster, Inc."
      Top             =   1200
      Width           =   5295
   End
   Begin TextBox Text2
      Height          =   495
      Left            =   4440
      TabIndex        =   5
      Text            =   "Brady Pub."
      Top             =   240
      Width           =   1815
   End
   Begin TextBox Text1
      Height          =   495
      Left            =   1560
      TabIndex        =   3
      Text            =   "5"
      Top             =   240
      Width           =   735
   End
   Begin ListBox List1
      Height          =   810
      Left            =   1440
      TabIndex        =   1
      Top             =   2280
      Width           =   4095
   End
   Begin CommandButton Command1
      Caption         =   "Search on Multiple index test1_idx"
      Height          =   495
      Left            =   2040
      TabIndex        =   0
      Top             =   3240
      Width           =   3135
   End
   Begin Label Label4
      Caption         =   "Results"
      Height          =   255
      Left            =   3000
      TabIndex        =   8
      Top             =   1920
      Width           =   855
   End
   Begin Label Label3
      Caption         =   "Company Name -----&gt;"
      Height          =   255
      Left            =   120
      TabIndex        =   6
      Top             =   1200
      Width           =   1815
   End
   Begin Label Label2
      Caption         =   "Name --------&gt;"
      Height          =   255
      Left            =   3120
      TabIndex        =   4
      Top             =   360
      Width           =   1215
   End
   Begin Label Label1
      Caption         =   "Pubid------&gt;"
      Height          =   255
      Left            =   360
      TabIndex        =   2
      Top             =   360
      Width           =   1095
    End
   End

   Sub Command1_Click ()
    Dim tbl As table
    Dim db As database

    a% = Val(text1.Text)
    tmp1$ = Trim$(text2.Text)
    tmp2$ = Trim$(text3.Text)

    Set db = OpenDatabase("biblio.mdb")
    Set tbl = db.OpenTable("publishers")
    tbl.Index = "test1_idx"
    tbl.Seek "=", a%, tmp1$, tmp2$

    If tbl.NoMatch Then
      MsgBox "No matches found"
    Else
      ' Change the following two lines to one, single line:
      list1.AddItem "" &amp; tbl("PubID") &amp; " "&amp; tbl("Name")
         &amp; " " &amp; tbl("Company Name")
    End If

   End Sub

</PRE><P><LI>Remove Form1 from the new Visual Basic project list, and add
   MULTIF.FRM. Then set MULTIF as the start up form.

<P><LI>From the Run menu, choose Start (ALT, R, S), or press the F5 key
   to run the program. Click the Command1 button.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 multi-field multi<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgDataAcc
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
