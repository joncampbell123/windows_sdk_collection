

<HTML>
<HEAD>
<TITLE>PRB: WithEvents Does Not Work with Remote Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172312">
<META NAME="KBModify" CONTENT="1997/08/26">
<META NAME="KBCreate" CONTENT="1997/08/01">
<META NAME="Keywords" CONTENT="VBKBDAO VBKBDB VBKBJet VBKBObj">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When attempting to raise a remote event across Remote Automation, the following run-time error appears:     -2147467259(80004005) , Automation error  CAUSE =====  Remote Automation does not currently support the use of WithEvents.  RESOLUTION  To s...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA2K,QA01,QAPN,QAH4,QANN,QBWS,QATX,QAIJ,QAFF,QAO4,QAAP,QBXS,QAY5,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: WithEvents Does Not Work with Remote Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172312</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When attempting to raise a remote event across Remote Automation, the
following run-time error appears:
<P>
<PRE>   -2147467259(80004005) , Automation error

</PRE><h2>CAUSE</h2>
 
<P>
Remote Automation does not currently support the use of WithEvents.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To support remote events with Visual Basic 5.0, use DCOM instead of Remote
Automation. You can also use callbacks to simulate raising events remotely.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Use the following steps on the server machine:

<OL><P><LI>Start Visual Basic 5.0 and create a new ActiveX EXE project.

<P><LI>From the Project menu, selectProject properties and change the Project
   name to "Projtest."

<P><LI>Add a Class Module and change its name to "Testclass."

<P><LI>In Testclass' Code window, input following code:
<P>
<P><PRE>      Public Event propchange(newv As String)
      Private propt As String
</PRE><P>
<P><PRE>      Public Sub showfrm()
<PRE></PRE>            MsgBox "asdfl"
      End Sub

      Public Property Get testp() As String
            testp = propt
      End Property

      Public Property Let testp(ByVal vNewValue As String)
            propt = vNewValue
            RaiseEvent propchange(propt)
      End Property

</PRE><P><LI>On the File menu, click "Make ProjTest.exe."

<P><LI>Copy the corresponding .exe, .tlb, and .vbr files to the client machine.

<P><LI>Start the Automation Manager and the RemAuto Connection Manager to set
   necessary server-side configuration for using Projtest.testclass for
   Remote Automation.
<P>
</OL>Use the following steps on the client machine:

<OL><P><LI>Run Projtest.exe, which was copied from the Server side in the above
   steps.

<P><LI>Start the RemAuto Connection Manager to set necessary Client-side
   configuration for using Projtest.testclass.

<P><LI>Launch Visual Basic 5.0 and create a new Standard EXE project with a
   standard form.

<P><LI>From the Project menu, click References and select the "Projtest" box.

<P><LI>In Form1's Code window, input following code:
<P>
<P><PRE>      Public WithEvents eventp As testclass
</PRE><P>
<P><PRE>      Private Sub eventp_propchange(newv As String)
<PRE></PRE>           MsgBox newv
      End Sub

      Private Sub Form_Load()
           Dim a As New testclass
           a.showfrm
           Set eventp = a
           a.testp = "test string"
       End Sub

</PRE><P><LI>Run the project and check if the Remote Automation connection is
   correct, the message box should pop up on the server-side machine.

<P><LI>Click OK to close the message box on the server-side machine.
<P>
</OL><h3>Result</h3>
 
<P>
When the line "Set eventp = a" executes, you will get the following run-
time error:
<P>
<PRE>   -2147467259(80004005) , Automation error

</PRE></OL><h3>Expected behavior</h3>
 
<P>
A message box should appear on the client-side machine because the server
raised the Propchange event.
<P>
NOTE: If both the client and the server are running on the same machine
(with local automation), you will see the expected behavior.
<P>
 
<PRE>Keywords          : VBKBDAO VBKBDB VBKBJet VBKBObj
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
