

<HTML>
<HEAD>
<TITLE>How to Use LZCOPYFILE Function to Decompress or Copy Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88257 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/08/20">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Included with Windows versions 3.0 and 3.1 is a dynamic-link library (DLL) named LZEXPAND.DLL that contains routines to manipulate compressed files. The functions in LZEXPAND.DLL manipulate files that are compressed by the COMPRESS.EXE utility supp...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA9N,QAY5,QAH4,QASB,QBWS,QDL9,QBWQ,QBWO,QBWN,QAB9,QBV8,QBXS,QAIJ,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use LZCOPYFILE Function to Decompress or Copy Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88257 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0 and 3.0
<LI>Microsoft Visual Basic programming system for Windows, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Included with Windows versions 3.0 and 3.1 is a dynamic-link library (DLL)
named LZEXPAND.DLL that contains routines to manipulate compressed files.
The functions in LZEXPAND.DLL manipulate files that are compressed by the
COMPRESS.EXE utility supplied with the Windows Software Development Kit
(SDK) versions 3.0 and 3.1. These functions allow you to expand
(decompress) a compressed file.
<P>
The following example demonstrates how to use the LZCOPYFILE function
included in LZEXPAND.DLL. This function is used to expand a compressed
file or to copy a file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following is a small program that will copy or decompress a file
in Visual Basic for Windows:

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>In the general Declarations section of Form1, add the following
   declaration entirely on one, single line:
<P>
<PRE>   Declare Function LZCOPY Lib "LZEXPAND.DLL" (ByVal SOURCEHANDLE As
      Integer, ByVal DESTHANDLE As Integer) As Long

</PRE><P><LI>In the Form1 Click event procedure, add the following code:
<P>
   Open "Source" For Input As #1 ' Insert the name and path of the
<PRE>                                 ' file to be decompressed, or copied.

   Open "Dest" For Output As #2  ' Insert the name and path of the
                                 ' destination file here.
   SOURCEHANDLE% = Fileattr(1,2)
   DESTHANDLE% = Fileattr(2,2)
   RETURNCODE&amp; = Lzcopy(Sourcehandle%, Desthandle%)
   Close

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) to run the program.
<P>
</OL>The return code will be set to the number of bytes copied or set to the
following value if an error occurs:
<P>
<PRE>   -1  invalid input handle
   -2  invalid output handle
   -3  corrupt compressed file format
   -4  out of space for output file
   -5  insufficient memory for LZFile struct
   -6  bad global handle
   -7  input parameter out of range
   -8  compression algorithm not recognized

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg<BR>
KBSubcategory: APrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
