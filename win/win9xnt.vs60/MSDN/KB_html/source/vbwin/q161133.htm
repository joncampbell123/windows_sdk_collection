

<HTML>
<HEAD>
<TITLE>HOWTO: Block CTRL+ALT+DEL and ALT+TAB in Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161133">
<META NAME="KBModify" CONTENT="1997/10/13">
<META NAME="KBCreate" CONTENT="1996/12/17">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all vb5howto VBKBEnv VBKBProgramming VBKBWinAPI kbenv kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT=" WARNING: ANY USE OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Microsoft provides this code  as is  without warranty of any kind, either express or implied, including but not limited to the implied warranties of merchantability and/or fi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMN,QAH4,QDL9,QBWQ,QBWO,QBWN,QBVV,QA4P,QAFF,QAGB,QBS0,QBXS,QAQT,QA5B,QARP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Block CTRL+ALT+DEL and ALT+TAB in Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161133</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Learning, Professional, and Enterprise Editions of Microsoft Visual
   Basic for Windows, version 5.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
WARNING: ANY USE OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK.
Microsoft provides this code "as is" without warranty of any kind, either
express or implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose.
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can prevent the CTRL+ALT+DEL and ALT+TAB key combinations from bringing
up a task list in Windows 95 by calling the SystemParametersInfo function
in the Win32 API. A step-by-step example of this appears below.
<P>
NOTE: This is possible only in Windows 95.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Sometimes it is necessary for a program to prevent the use of the
CTRL+ALT+DEL key combination to bring up the Close Program task list to end
a task or shut down Windows 95 and to prevent the use of the ALT+TAB key
combination to switch tasks. The following technique uses the
SystemParametersInfo API to trick Windows 95 into thinking that a screen
saver is running. As a side effect, CTRL+ALT+DEL and ALT+TAB are disabled.
<P>
The Win32 SDK states:
<P>
<PRE>   "SPI_SCREENSAVERRUNNING Windows 95: Used internally; applications should
   not use this flag. Windows NT: Not supported."

</PRE>Note that disabling CTRL+ALT+DEL is not recommended because the Close
Program dialog box was created to enable users to terminate misbehaving
applications. If a program "hangs" while CTRL+ALT+DEL is disabled, it may
not be possible to terminate it by any method other than rebooting the
machine, which could result in the loss of data. Also, this technique may
not work in future versions of Windows.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new Standard EXE project. Form1 is created by default.

<P><LI>Add two CommandButton controls (Command1 and Command2) to Form1.

<P><LI>Add the following code to Form1's General Declarations section:
<P>
<P><PRE>      Private Const SPI_SCREENSAVERRUNNING = 97&amp;
      Private Declare Function SystemParametersInfo Lib "User32" _
<PRE></PRE>          Alias "SystemParametersInfoA" _
         (ByVal uAction As Long, _
          ByVal uParam As Long, _
          lpvParam As Any, _
          ByVal fuWinIni As Long) As Long

      Private Sub Form_Load()
         Command1.Caption = "Disabled"
         Command2.Caption = "Enabled"
      End Sub

      Private Sub Form_Unload(Cancel As Integer)
         'Re-enable CTRL+ALT+DEL and ALT+TAB before the program terminates.
         Command2_Click
      End Sub

      Private Sub Command1_Click()
         Dim lngRet As Long
         Dim blnOld As Boolean
         lngRet = SystemParametersInfo(SPI_SCREENSAVERRUNNING, True, _
         blnOld, _
            0&amp;)
      End Sub

      Private Sub Command2_Click()
        Dim lngRet As Long
        Dim blnOld As Boolean
        lngRet = SystemParametersInfo(SPI_SCREENSAVERRUNNING, False, _
        blnOld, _
           0&amp;)
      End Sub

</PRE><P><LI>Press the F5 key to run the program, and click the "Disabled"
   CommandButton. CTRL+ALT+DEL and ALT+TAB are disabled. Click the
   "Enabled" CommandButton to enable CTRL+ALT+DEL and ALT+TAB again.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Developer Network CD
(A subscription to the Microsoft Developer Network may be purchased from
Microsoft. For more information on this product call (800)759-5474 in the
U.S. and Canada.)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: reboot<BR>
Keywords          : VB4ALL VB4WIN vb5all vb5howto VBKBEnv VBKBProgramming VBKBWinAPI kbenv kbhowto<BR>
Version           : 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
