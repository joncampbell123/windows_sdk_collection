

<HTML>
<HEAD>
<TITLE>PRB: Add Graph Error: GSW.EXE and GSWDLL.DLL Version Mismatch </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96007 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/03/03">
<META NAME="Keywords" CONTENT="kbenv kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Loading the graph control into a project when different versions of GSW.EXE and GSWDLL.DLL exist on the same computer can cause one of the following two error messages:     GSW.EXE and GSWDLL.DLL Version Mismatch    Need Graphics Server 2.00 or lat...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBXB,QATJ,QAFI,QDL9,QBWQ,QBWO,QBWN,QAB4,QAMN,QBJZ,QA7O,QAB5,QAOE,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Add Graph Error: GSW.EXE and GSWDLL.DLL Version Mismatch</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96007 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  version 2.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Loading the graph control into a project when different versions of GSW.EXE
and GSWDLL.DLL exist on the same computer can cause one of the following
two error messages:
<P>
<PRE>   GSW.EXE and GSWDLL.DLL Version Mismatch
   Need Graphics Server 2.00 or later

</PRE><h2>CAUSE</h2>
 
<P>
Because the graph control uses a graphing and charting library (GSWDLL.DLL)
along with a graphics server (GSW.EXE) to provide its graphing
capabilities, it must have the same versions of these two files.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around the problem, place the 2.0 version of all three files
(GRAPH.VBX, GSW.EXE, and GSWDLL.DLL) in the \WINDOWS\SYSTEM directory, and
delete or move the older versions out of the following directories:

<UL><LI>The \WINDOWS directory
<LI>The \WINDOWS\SYSTEM directory
<LI>All directories located on the MS-DOS path
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The setup program for the Professional Edition of Visual Basic version 2.0,
correctly updates the GRAPH.VBX and its two auxiliary files if previous
versions of the files exist in the \WINDOWS\SYSTEM directory. If prior
versions of the control reside in a different directory, such as the
\WINDOWS directory, the setup program for Visual Basic version 2.0 will not
rename or remove the older versions. However, it does place the version 2.0
versions of the controls in the \WINDOWS\SYSTEM directory.
<P>
When you load the graph control, either by choosing Add File from the File
menu or by adding GRAPH.VBX to the AUTOLOAD.MAK file, the graph control
searches the directories for its two auxiliary files in this order:

<OL><P><LI>The directory where GRAPH.VBX resides, unless it's \WINDOWS\SYSTEM
</OL>2. The \WINDOWS directory
3. The \WINDOWS\SYSTEM directory
4. The directories on MS-DOS path
<P>
If GRAPH.VBX resides in the \WINDOWS\SYSTEM directory the search begins
with step 2. The error message, therefore, can occur when a copy of
GRAPH.VBX resides in the \WINDOWS\SYSTEM directory and an older version of
either GSW.EXE or GSWDLL.DLL resides in the \WINDOWS directory while 2.0
versions reside in the \WINDOWS\SYSTEM directory with GRAPH.VBX.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Run SETUP.EXE from the Professional Toolkit for Visual Basic
   version 1.0.

<P><LI>Install the Toolkit in the \VB1 directory using these two options:
<P>
   - Select the option to install Controls/Samples.
   - Select Yes, when asked if you want to install duplicate copies of the
<P><PRE>     Toolkit controls in the \VB1\VBX directory.
</PRE><P>
   This will install copies of the custom controls in the \WINDOWS\SYSTEM
   and \VB1\VBX directories.

<P><LI>Run SETUP.EXE from the Visual Basic Professional Edition version 2.0 for
   Windows.

<P><LI>Install Visual Basic version 2.0 in the default directory (\VB) using
   the Complete Installation option.
<P>
</OL>At this point, the Visual Basic version 1.0 controls in the \WINDOWS\SYSTEM
directory are updated to their 2.0 versions, including GRAPH.VBX, GSW.EXE,
and GSWDLL.DLL.

<OL><P><LI>Rename GSW.EXE in the \WINDOWS\SYSTEM directory to GSW.OLD. Using
   File Manager, navigate to the \WINDOWS\SYSTEM directory and select
   GSW.EXE from the list of files. From the File menu, choose Rename
   (ALT, F, N). In the To box, enter GSW.OLD.
<P>
   By doing this, you will retain a 2.0 version of the Graph control's
   server program.

<P><LI>Copy GSW.EXE from the \VB1\VBX directory into the \WINDOWS\SYSTEM
   directory. Using File Manager, navigate to the \VB1\VBX directory and
   select GSW.EXE from the list of files. From the File menu, choose
   Copy (ALT, F, C).
<P>
   Now you have conflicting versions of the GRAPH.VBX and GSW.EXE files
   in the same directory.

<P><LI>Run Visual Basic, or from the File menu, choose New Project (ALT,
   F, N) if Visual Basic is already running. Form1 is created by default.
<P>
   The AUTOLOAD.MAK file, installed with Visual Basic 2.0, will attempt to
   load all custom controls shipped with the Professional Edition. When
   the loading process reaches the graph control, the following error
   message occurs:
<P>
<P><PRE>      GSW.EXE &amp; GSWDLL.DLL version mismatch
</PRE><P>
   Upon closing the error message box, a second error message box appears:
<P>
<P><PRE>      Can't load Custom Control DLL: C:\WINDOWS\SYSTEM\GRAPH.VBX
</PRE><P>
   The two error messages also occur when you choose Add File from the
   File menu
<P>
</OL>Even though this example incorrectly updates only the GSW.EXE file, the
same error messages occur when all three files related to the graph control
have different versions.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00<BR>
KBCategory: kbenv kbprg kbprb<BR>
KBSubcategory: EnvtDes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
