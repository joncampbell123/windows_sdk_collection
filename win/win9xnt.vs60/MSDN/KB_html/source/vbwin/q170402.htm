

<HTML>
<HEAD>
<TITLE>BUG: OLE Automation to Excel 8.0 Fails Using a 16-bit Client </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170402">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1997/06/19">
<META NAME="Keywords" CONTENT="IAPVBA vb416 VB4WIN kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you use a 16-bit Visual Basic client to Automate Microsoft Excel 97 under Windows 95, you may receive the following error:                   caused an invalid page fault in module kernel32.dll   This error only occurs on Windows 95 with Microsof...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QBWQ,QDL9,QBWO,QBWN,QBWP,QBVX,QARL,QAKP,QA5B,QALQ,QAAP,QAFF,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: OLE Automation to Excel 8.0 Fails Using a 16-bit Client</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170402</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions, 16-bit
   only, for Windows, version 4.0
   on the following platform: Win95
<LI>Microsoft Visual Basic Professional Edition for Windows, version 3.0
   on the following platform: Win95
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use a 16-bit Visual Basic client to Automate Microsoft Excel 97
under Windows 95, you may receive the following error:
<P>
<PRE>  "&lt;application&gt; caused an invalid page fault in module kernel32.dll"

</PRE>This error only occurs on Windows 95 with Microsoft Excel 97. The error
does not happen on Windows NT 4.0 or with Microsoft Excel 95.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are several solutions to this problem.

<UL><LI>Use a 32-bit client.
<P>
   -or-

<LI>Use Windows NT 4.0.
<P>
   -or-

<LI>Install DCOM for Windows 95.
   DCOM for Windows 95 can be downloaded from the Microsoft Web Site at the
   following address:
<P>
<P><PRE>      <B><A href="http://www.microsoft.com/oledev">http://www.microsoft.com/oledev</A></B>
</PRE><P>
</UL>A License and Distribution Agreement can also be found at the above Web
Site.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example only fails on Windows 95 using a 16-bit client
application to Microsoft Excel 97. This will only fail on machines that do
not have DCOM for Windows 95 installed.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new Visual Basic 4.0 16-bit project.

<P><LI>Add a CommandButton to Form1.

<P><LI>Add the following code to Form1:
<P>
<P><PRE>      Dim oExcel as object
</PRE><P>
<P><PRE>      Private Sub Form_Load()
<PRE></PRE>        Set oExcel = CreateObject("Excel.Application")
      End Sub

      Private Sub Command1_Click()
        oExcel.Workbooks.add
        oExcel.Visible = True
        'The error usually happens on one of the next 3 lines
        oExcel.Sheets(1).Activate
        oExcel.Range("a1").Value = 1
        oExcel.Range("a2").Value = 2
      End Sub

</PRE><P><LI>Run the project by pressing the F5 Key.

<P><LI>Click the CommandButton.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 XL8 VB4 16bit ipf crash<BR>
Keywords          : IAPVBA vb416 VB4WIN kberrmsg<BR>
Version           : 3.0 4.0 97<BR>
Platform          : Win95 WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
