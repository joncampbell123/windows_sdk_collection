

<HTML>
<HEAD>
<TITLE>PRB: Debugging ActiveX Server in IDE Causes Application Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170340">
<META NAME="KBModify" CONTENT="1997/07/28">
<META NAME="KBCreate" CONTENT="1997/06/18">
<META NAME="Keywords" CONTENT="vb5all VBKBAutomation VBKBAX VBKBComp VBKBExe kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When debugging an ActiveX server running in the Visual Basic IDE on Windows NT 4.0, you may receive the following error when the ActiveX server attempts to return control back to the Client application running in a second Visual Basic IDE:      Ste...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBWP,QAHV,QBWS,QAAP,QAH4,QAB4,QABI,QASR,QAIJ,QAFF,QDO3,QAJH,QA5F,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Debugging ActiveX Server in IDE Causes Application Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170340</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
   on the following platform: NT
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When debugging an ActiveX server running in the Visual Basic IDE on Windows
NT 4.0, you may receive the following error when the ActiveX server
attempts to return control back to the Client application running in a
second Visual Basic IDE:
<P>
<PRE>   "Step Into: VB5.EXE - Application Error
   The instruction at &lt;memory address&gt; referenced memory at &lt;memory
   address&gt;. The memory could not be "read"

</PRE><h2>RESOLUTION</h2>
 
<P>
To correct this problem, use one of the following methods.

<UL><LI>Install Windows NT Service Pack 2 or later. The system requirements on
   the Visual Basic Box recommend Service Pack 2 for Windows NT 4.0.
<P>
   -or-

<LI>Use late binding when creating the ActiveX server object.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
A common method of debugging ActiveX servers is to run them in one session
of the Visual Basic IDE while the client runs in a second session of the
Visual Basic IDE. When using early binding to an ActiveX server on Windows
NT 4.0, you will receive an APPLICATION ERROR when the ActiveX server tries
to return control to the client application.
<P>
NOTE: This is a problem only if Windows NT Service Pack 2 or later is not
installed.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new ActiveX EXE Project.

<P><LI>Name the Class "clsTest" (without the quotes).

<P><LI>Add the following code to the class module:
<P>
<P><PRE>      Private Sub Class_Initialize()
<PRE></PRE>         Debug.Print "Class Init"
      End Sub

</PRE><P><LI>Click Properties on the Project menu. On the General tab, set the
   Project name to "pjxTest." On the Make tab, set the Application Title
   to "pjxTest." On the Component Tab, set the Start Mode to ActiveX
   Component and click OK.

<P><LI>Run the ActiveX server by pressing CTRL+F5 or, from the Run Menu,
   select Start with Full Compile.

<P><LI>Start a second session of Visual Basic and create a Standard EXE
   project.

<P><LI>From the Project Menu, select References. Check "pjxTest" and click OK.

<P><LI>Place a CommandButton on Form1.

<P><LI>Add the following code to the form:
<P>
<P><PRE>      Dim obj As pjxTest.clstest
</PRE><P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         Set obj = New pjxTest.clstest
      End Sub

</PRE><P><LI>From the View Menu, select Toolbars, and make sure the Debug Toolbar
<P><PRE>    is checked.
</PRE>
<P><LI>Use the Step Into button on the Debug Toolbar to step through the code.
<P><PRE>    You will get an APPLICATION ERROR when you click the Step Into button
    and you are on the "End Sub" line in the Class_Initialize Sub of the
    ActiveX server. Because the APPLICATION ERROR is from the Client,
    the Client session of Visual Basic will be terminated.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OLE Automation instance<BR>
Keywords          : vb5all VBKBAutomation VBKBAX VBKBComp VBKBExe kbprb<BR>
Technology        : kbole<BR>
Version           : 5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
