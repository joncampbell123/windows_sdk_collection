

<HTML>
<HEAD>
<TITLE>How To Run Setup1.vbp in the Design Environment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159860">
<META NAME="KBModify" CONTENT="1996/11/26">
<META NAME="KBCreate" CONTENT="1996/11/22">
<META NAME="Keywords" CONTENT="kbsetup kbtool kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You can customize the installation program created by the Setup Wizard by modifying the Setup1.vbp project in the \Vb\Setupkit\Setup1 directory. However, you cannot run or debug this project in the Visual Basic Design Environment unless you emulate...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDIZ,QBS0,QDI2,QBWS,QAX1,QAHE,QBXB,QATJ,QAFI,QAJH,QAH4,QA5F,QAMA,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Run Setup1.vbp in the Design Environment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 26, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159860</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can customize the installation program created by the Setup Wizard by
modifying the Setup1.vbp project in the \Vb\Setupkit\Setup1 directory.
However, you cannot run or debug this project in the Visual Basic Design
Environment unless you emulate the behavior of the compiled setup routine.
<P>
NOTE: Microsoft Technical Support does not support the modification of the
setup process or any of the setup files. Support is provided for the Setup
Wizard on an "as is" basis only.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Before you can run Setup132.exe, the Setup.exe program must copy certain
files to their destination directories (all files listed in the
"[Bootstrap]" section of the Setup.lst file). Setup.exe also creates an
uninstall log file that is used by Setup1.exe for 32-bit applications. It
also copies Setup1.lst to your \Windows directory so that it will not be
swapped out.
<P>
Setup.exe invokes Setup1.exe with certain command line parameters. In order
to run the Setup1 project in the Visual Basic Design Environment, these
parameters must be set. Do this by launching the Visual Basic Design
Environment from the Setup program and specifying your modified Setup1.vbp
as a command line parameter.
<P>
NOTE: The file Setup1.exe is created for a 16-bit application and
Setup132.exe is created for a 32-bit application. The following example
focuses on 32-bit applications, but can be readily adapted to 16-bit
applications.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Run the Application Setup Wizard and follow the steps to produce the
   default setup distribution set in a directory.

<P><LI>Edit the file Setup.lst in a pure text editor, such as Notepad. Locate
   the following entry:
<P>
   Setup=setup132.exe
<P>
   and replace it with:
<P>
   Setup=c:\vb\vb32.exe c:\vb\setupkit\setup1\setup1.vbp /cmd
<P>
   Modify the path as appropriate. Save Setup.lst when this step is
   complete.

<P><LI>Run Setup.exe from the installation directory. Instead of running
   Setup132.exe, Setup.exe starts up the Visual Basic Design Environment
   with the Setup1.vbp project loaded, the correct files in the correct
   places, the uninstall log already created, and with the command-line
   parameters set properly. This is the function of the '/cmd' parameter.
   It allows Visual Basic 4.0 to pick up the command-line parameters that
   Setup.exe sends to Setup132.exe. Refer to the Advanced tab option of the
   Tools/Options menu to confirm what parameters were passed.

<P><LI>Add the desired break points. Press the F5 or F8 key to run the project.
<P>
   Note that if you click the "Exit Setup" button at any time while running
   the project, or if the program runs to the end either successfully or by
   a trapped error, the log file (setup.lst) and the uninstall program are
   deleted. Conversely, if you run repeated tests of your version of
   Setup132, then multiple copies of the log file (St4unst.000,
   St4unst.001...) are copied into your \Windows directory. These may be
   safely deleted after you exit the Visual Basic Design Environment.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbtool kbhowto<BR>
KBSubcategory: TlsSetWiz<BR>
Additional reference words: 4.00 vb4win vb4all kbstream<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 26, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
