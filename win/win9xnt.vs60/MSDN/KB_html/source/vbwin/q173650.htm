

<HTML>
<HEAD>
<TITLE>PRB: Version Number Not Incrementing Using Command Line /Make </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173650">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1997/09/09">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all VBKBDesignTime VBKBEnv VBKBVB">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When making an executable file using the Visual Basic command-line argument /make or /m, the Revision Version Number is incremented only the first time even though Auto Increment was checked in the Project Properties dialog box before the project w...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAKC,QAPN,QBWS,QBC6,QASR,QBIC,QAG8,QA01,QDL9,QBWQ,QBWO,QBWN,QA2Q,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Version Number Not Incrementing Using Command Line /Make</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173650</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions
   for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When making an executable file using the Visual Basic command-line argument
/make or /m, the Revision Version Number is incremented only the first time
even though Auto Increment was checked in the Project Properties dialog box
before the project was saved.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To maintain accurate versioning in your applications, compile the
executable file via the Visual Basic Integrated Development Environment
(IDE).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Visual Basic /make or /m command-line argument is designed to adhere to
the Path, EXEName, and Title properties of the App object. It is not
designed to adhere to the versioning information or the Auto Increment
property of the project.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new Standard EXE project. Form1 is added by default.

<P><LI>On the File menu, click Make Project1.exe.

<P><LI>In the Make Project dialog box, click the Options button.

<P><LI>In the Project Properties dialog box, change the Major Version Number to
   2, the Minor Version Number to 2, the Revision Version Number to 2, and
   select Auto Increment.

<P><LI>Click OK to return to the Make Project dialog box; then click OK to
   create the executable.

<P><LI>Save the project and exit Visual Basic.

<P><LI>Using the Microsoft Windows Explorer, locate the Project1.exe file,
   right-click to select the file, click Properties on the menu, and then
   click the Version tab in the Properties dialog box to view its current
   version number. Note that this number is 2.02.0002, and exit.

<P><LI>On the Windows Start menu, click Run, and type in the following
   command, replacing the values within "&lt;...&gt;" with the actual paths on
   your system:
<P>
<P><PRE>      &lt;PATH TO VB5&gt;\VB5.EXE /make &lt;PATH TO Project1.VBP&gt;\Project1.VBP
</PRE>
<P><LI>Locate the Project1.exe file using the Microsoft Windows Explorer,
   right-click to select the file, click Properties on the menu, and then
   click the Version tab in the Properties dialog box. Note that the
   version number is 2.02.0003, as expected.

<P><LI>On the Windows Start menu, click Run again and select the following
<P><PRE>    command, which has the values within "&lt;...&gt;" replaced with the
    actual paths on your system:
</PRE><P>
<P><PRE>      &lt;PATH TO VB5&gt;\VB5.EXE /make &lt;PATH TO Project1.VBP&gt;\Project1.VBP
</PRE>
<P><LI>Locate the Project1.exe file using the Microsoft Windows Explorer,
<P><PRE>    right-click to select the file, click Properties on the menu, and then
    click the Version tab in the Properties dialog box. Note that the
    version number is 2.02.0003 and has not changed. Compiling from the
    command line will no longer cause the Revision version number to be
    auto-incremented.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: autoincremented<BR>
Keywords          : VB4ALL VB4WIN vb5all VBKBDesignTime VBKBEnv VBKBVB<BR>
Version           : WINDOWS:4.0,5.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
