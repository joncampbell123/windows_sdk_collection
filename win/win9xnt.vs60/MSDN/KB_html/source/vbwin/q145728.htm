

<HTML>
<HEAD>
<TITLE>How To Create a Listbox with Clickable Checkboxes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145728">
<META NAME="KBModify" CONTENT="1997/01/21">
<META NAME="KBCreate" CONTENT="1996/02/06">
<META NAME="Keywords" CONTENT="kbusage kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Many Windows programs incorporate listboxes with embedded checkboxes as part of their user interface. The References dialog in Visual Basic 4.0 is one example of this kind of listbox. This article shows how to implement a listbox with this function...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QAB5,QA7O,QAOE,QAMN,QAPN,QABH,QABI,QAHP,QBVR,QAMB,QAFF,QA5F,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Create a Listbox with Clickable Checkboxes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145728</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic for Windows, 32-bit only, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Many Windows programs incorporate listboxes with embedded checkboxes as
part of their user interface. The References dialog in Visual Basic 4.0 is
one example of this kind of listbox. This article shows how to implement a
listbox with this functionality in Visual Basic 4.0 by using the ListView
control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ListView control has the capability to show images and text for each
item in a list. The graphics to be displayed are held in an associated
ImageList control and can be checked and unchecked checkboxes or whatever
images are desired.
<P>
NOTE: To use ImageList controls with the ListView control, you must
associate a particular ImageList control with the Icons and SmallIcons
properties, as follows:
<P>
<PRE>    ListView1.Icons = ImageList1
    ListView1.SmallIcons = ImageList2

</PRE>Follow these steps to create a listbox with the capability to display
graphics and text:

<OL><P><LI>Start Visual Basic 4.0, 32-bit, or if it is already running, open a new
   project.

<P><LI>Place a ListView and an ImageList control on the form.

<P><LI>Right click on the ImageList control and select Properties. On the
   General tab, ensure that the '16 x 16' option button is selected. Switch
   to the Images tab and use the Insert Picture button to add two images to
   the ImageList. So that the code below will work without modification,
   make the first picture the 'unchecked' image, and the second the
<PRE>   'checked'. Visual Basic 4.0 does not ship with images that represent
   simple checked and unchecked checkboxes. Two complementary icons that
   are included in the Icons directory beneath the Visual Basic directory
   can be used (e.g. the Trash02a.ico and Trash02b.ico icons located in
   the \Icons\Computer directory.) Or, if you have a previous version of
   Visual Basic, these icons can be easily created with the IconWorks
   sample that is included with previous versions of Visual Basic.

</PRE><P><LI>Insert these lines of code in the General Declaration section of the
   form.
<P>
<PRE>   'store the item selected in the ItemClick event
   'for use in the DblClick event
   Private ItemClicked As ListItem

</PRE><P><LI>Add the following code into the code window for the form. The operation
   of the code is explained in the included comments.
<P>
<PRE>   Private Sub Form_Load()
       Dim itmX As ListItem
       Dim i As Integer

       'loop and add 10 items to the ListView control
       'this code should be replaced by your add item code
       For i = 1 To 10
           Set itmX = ListView1.ListItems.Add()
           'set icon to unchecked
           itmX.SmallIcon = 1
           itmX.Text = "ListItem " &amp; i
       Next i

       'other views will work, but will allow additional
       'behavior over a standard listbox
       ListView1.View = lvwList

       'display full label
       ListView1.LabelWrap = False
   End Sub

   Private Sub ListView1_DblClick()

       'toggle icon between checked and unchecked
       'use the private ItemClicked variable set in the
       'ListView1_ItemClick event
       With ItemClicked
           If .SmallIcon = 1 Then
               .SmallIcon = 2
           Else
               .SmallIcon = 1
           End If
       End With
   End Sub

   Private Sub ListView1_ItemClick(ByVal Item As ListItem)
       'since there is no ItemDblClick event, save the item
       'clicked on for use in the ListView's DblClick Event
       Set ItemClicked = Item
   End Sub

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Online help for ListView and ImageList controls.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbwebcontent<BR>
KBSubcategory: PrgCtrlsStd<BR>
Additional reference words: 4.00 vb4win vb432 check box<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
