

<HTML>
<HEAD>
<TITLE>HOWTO: Set the System Time </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154009">
<META NAME="KBModify" CONTENT="1997/07/14">
<META NAME="KBCreate" CONTENT="1996/07/25">
<META NAME="Keywords" CONTENT="kbusage PrgOther vb432 vb4win vb5all vb5howto kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Win32 API offers the functionality to change the system time on the local machine. The change will take place immediately without the need for a reboot. Below is a code sample showing how to do this.  MORE INFORMATION  1. Start a new project in...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QACE,QA4Q,QAH4,QAU3,QAMR,QA62,QA5B,QAFH,QAC1,QBTX,QBSO,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Set the System Time</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154009</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for Windows,
   version 5.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Win32 API offers the functionality to change the system time on the
local machine. The change will take place immediately without the need for
a reboot. Below is a code sample showing how to do this.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the General Declarations section of Form1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Type SYSTEMTIME
<PRE></PRE>        wYear As Integer
        wMonth As Integer
        wDayOfWeek As Integer
        wDay As Integer
        wHour As Integer
        wMinute As Integer
        wSecond As Integer
        wMilliseconds As Integer
      End Type

      Private Declare Function SetSystemTime Lib "kernel32" (lpSystemTime _
        As SYSTEMTIME) As Long

      Private Sub Form_Load()
        Dim lReturn As Long
        Dim lpSystemTime As SYSTEMTIME
        lpSystemTime.wYear = 1996
        lpSystemTime.wMonth = 6
        lpSystemTime.wDayOfWeek = 5
        lpSystemTime.wDay = 28
        lpSystemTime.wHour = 9
        lpSystemTime.wMinute = 42
        lpSystemTime.wSecond = 0
        lpSystemTime.wMilliseconds = 0
        lReturn = SetSystemTime(lpSystemTime)
      End Sub

</PRE><P><LI>Run the project by pressing the F5 key. Check the system time and date
   in the Control Panel or on the system. Do the same in Windows 95. It
   should have changed to reflect the settings from the code.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
The SYSTEMTIME Type structure is as follows:
<P>
<PRE>   WYear           Integer-The current year.
   WMonth          Integer-The current month. January is 1.
   WDayOfWeek      Integer-The current day of the week. Sunday is 0.
   WDay            Integer-The current day of the month.
   WHour           Integer-The current hour.
   wMinute         Integer-The current minute.
   wSecond         Integer-The current second.
   wMilliseconds   Integer-The current millisecond.

</PRE></OL>To change the system time on a Win32 platform from 16-bit Visual Basic, you
would have to create a DLL that does a generic thunk to the 32-bit API
SetSystemTime.
<P>
For more information, please see article <B><A href="../win32sdk/q104009.htm">Q104009</A></B> on the Microsoft Developer
Network (MSDN) and the article outline in the Microsoft Systems Journal
(MSJ) for June 1994.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage PrgOther vb432 vb4win vb5all vb5howto kbhowto<BR>
Version             : 4.0 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
