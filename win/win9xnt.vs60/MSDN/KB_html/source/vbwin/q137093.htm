

<HTML>
<HEAD>
<TITLE>How to Get a Control Reference from the Control's hWnd </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137093">
<META NAME="KBModify" CONTENT="1996/05/28">
<META NAME="KBCreate" CONTENT="1995/09/20">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Visual Basic exports a new function in the Visual Basic run time that can be used to return a control reference when all you have is the hWnd to the control. This article shows you how.  MORE INFORMATION  Microsoft Windows uses window handles to ke...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QA7O,QAMN,QAH4,QAOE,QAUD,QDL9,QBWO,QBWN,QAB9,QA5F,QA3P,QAY5,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Get a Control Reference from the Control's hWnd</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137093</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual Basic exports a new function in the Visual Basic run time that can
be used to return a control reference when all you have is the hWnd to the
control. This article shows you how.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Windows uses window handles to keep track of all windowed
controls created. Visual Basic wraps this functionality with the hWnd
property that all windowed controls have. Ordinarily it is quite difficult
to trace backwards from the hWnd property to a reference to the control it
represents. It would be necessary to walk through all the child windows of
a task recursively and compare each window's hWnd to the one you are
seeking. However, the VBGetHwndControl function allows you to do it in one
simple call. This function is not available from within Visual Basic, but
you can easily wrap it in a C-language DLL.
<P>
<P><h3>Step-by-Step Procedure</h3>
 

<OL><P><LI>Create a DLL in the language of your choice. The following code would be
   used for the C programming language. Enter the code, and compile it into
   a DLL called Mydll.dll.
<P>
   HCTL FAR PASCAL _export GetTheHctl(HWND hwnd)
<P><PRE>      {
<PRE></PRE>         return VBGetHwndControl(hwnd);
      }

</PRE><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a command button (Command1) to Form1.

<P><LI>Add the following code to the General Declarations section of Form1:
<P>
   Dim x as control

<P><LI>Add the following code to the Form_Click event procedure for Form1:
<P>
<PRE>   Sub Form_Click ()
      Set X = GetTheHctl(Command1.hwnd)
      MsgBox X.Caption
   End Sub

</PRE><P><LI>Add a Module (Module1.Bas) to your project.

<P><LI>Add the following line to the General Declarations section of Module1:
<P>
<PRE>   Declare Function GetTheHctl lib "mydll.dll" (byval hwnd%) As Control

</PRE><P><LI>Start the program by pressing the F5 key.

<P><LI>Click Form1. The program identifies and returns a reference to Command1
   based on its hWnd. The output is:
<P>
   Command1
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb416<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
