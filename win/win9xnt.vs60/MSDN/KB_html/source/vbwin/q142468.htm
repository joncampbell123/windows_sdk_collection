

<HTML>
<HEAD>
<TITLE>BUG: Adding Subitems To Hidden ListView Causes APP Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142468">
<META NAME="KBModify" CONTENT="1996/10/16">
<META NAME="KBCreate" CONTENT="1996/01/14">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A 32-bit Visual Basic application with a ListView control can generate an application error or incorrectly display the subitems if the subitems are added to a ListView control that is hidden on a form.  STATUS ======  Microsoft has confirmed this t...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBXS,QAB5,QA7O,QAMN,QAOE,QAPN,QAAP,QAH4,QAB4,QABI,QABH,QAFF,QAJH,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Adding Subitems To Hidden ListView Causes APP Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142468</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A 32-bit Visual Basic application with a ListView control can generate an
application error or incorrectly display the subitems if the subitems are
added to a ListView control that is hidden on a form.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
issue and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To eliminate this behavior, use one of the following methods:
<P>
If you want your ListView control in the form to be hidden when the form
is shown, toggle the Visible property once before adding the subitems to
the ListView control. To toggle the Visible property, initially set the
Visible property to True and then reset the Visible property to False.
<P>
-or-
<P>
At design time, set the ListView control Visible property to True. Then in
the first line of code in the form's Load procedure, set the ListView
control Visible property to False.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Issue</h3>
 

<OL><P><LI>Start the 32-bit version of Visual Basic 4.0, or if it is already
   running, click New Project on the File menu.

<P><LI>Add the following controls to the Form1 form:
<P>
   - One Check Box
   - Two Image List Boxes
   - One ListView Control

<P><LI>Set the Caption property of the Check box to "ListView Control Visible."

<P><LI>Copy the following code to the Code window of the Form1 form:
<P>
<P><PRE>      Private Sub Check1_Click()
</PRE><P>
<PRE>         ListView1.Visible = Check1.Value = 1

      End Sub

      Private Sub Form_Load()

         'Set the ListView control's Column Headers
         Dim clmX As ColumnHeader
         Set clmX = ListView1.ColumnHeaders.Add(, , "Author", _
                    ListView1.Width / 3)
         Set clmX = ListView1.ColumnHeaders.Add(, , "Author ID", _
                    ListView1.Width / 3, lvwColumnCenter)
         Set clmX = ListView1.ColumnHeaders.Add(, , "Birthdate", _
                    ListView1.Width / 3)

         'Set the ListView control's view property to show a "Report" view
         ListView1.View = lvwReport

         'Add ListItems to the ListView control
         'Use an icon file and a bitmap file that comes with Visual Basic
          Dim imgX As ListImage
          Set imgX = ImageList1.ListImages.Add(, , LoadPicture _
                     ("C:\VB\ICONS\WRITING\NOTE06.ICO"))
          Set imgX = ImageList2.ListImages.Add(, , LoadPicture _
                     ("C:\VB\REPORT\PROLOGOB.BMP"))
          ListView1.Icons = ImageList1
          ListView1.SmallIcons = ImageList2

          Set itmX = ListView1.ListItems.Add(, , "John Doe")
          itmX.SubItems(1) = "John Dow Sub item"

      End Sub

</PRE><P><LI>Press the F5 key to run the application.

<P><LI>Click the check box. One of the following behaviors occur:
<P>
   While using Microsoft Windows NT version 3.51, the following error is
   returned:
<P>
   An application error has occurred and an application error log is being
   generated. VB32.exe. Exception: access violation (0xc0000005),
   Address: 0x0523ca55.
<P>
   While using Microsoft Windows 95, the following error is returned:
<P>
   VB32 caused an invalid page fault in module COMCTL32.OCX at
   0137:0523ca55.
<P>
   -or-
<P>
   The ListView control incorrectly displays the subitems.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>
Additional reference words: 4.00 vb4win vb432 ListView errmsg buglist4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
