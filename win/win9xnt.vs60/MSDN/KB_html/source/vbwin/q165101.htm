

<HTML>
<HEAD>
<TITLE>HOWTO: Use Win95 as a DCOM Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165101">
<META NAME="KBModify" CONTENT="1997/06/05">
<META NAME="KBCreate" CONTENT="1997/03/12">
<META NAME="Keywords" CONTENT="vb5all vb5howto VBKBAutomation VBKBAX VBKBComp VBKBExe kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  To use a Windows 95 computer as a Distributed Component Object Model (DCOM) server, you need to configure the computer to run DCOM applications. Using a Windows 95 computer as a DCOM server will not provide the same features as a Windows NT 4.0 com...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWG,QBWS,QAI5,QBW7,QAJG,QAB4,QBWQ,QDK6,QAAP,QDL9,QBWP,QBWO,QBWN,QAK7,QA1S V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Use Win95 as a DCOM Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165101</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To use a Windows 95 computer as a Distributed Component Object Model (DCOM)
server, you need to configure the computer to run DCOM applications. Using
a Windows 95 computer as a DCOM server will not provide the same features
as a Windows NT 4.0 computer. Performance and security will be more
limited. Additionally, you will have to perform some steps manually that
are provided automatically by Windows NT. For instance, you will probably
want to add shortcuts to the server components in your startup group and
you will need to run RPCSS.EXE before you will be able to access the server
component.
<P>
Because you need to have the server component running before trying to use
the client, you need some mechanism to keep the server running. The easiest
way to do this is to have a blank form in the server. You may set the
visible property of the form to "False."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
DCOM was designed to run on Windows NT 4.0 Server and Workstation. To
configure a Windows 95 computer for use as a DCOM server, download
DCOM95.EXE and DCM95CFG.EXE available from the OLE Development section of
the Microsoft Web Site at:
<P>
<B><A href="http://www.microsoft.com/oledev">http://www.microsoft.com/oledev</A></B>
<P>
DCOM95.EXE is also available on the Microsoft Visual Basic 5.0 CD-ROM
(Enterprise, Professional and Standard editions) in the \Pro\Tools\DCOM95
directory.
<P>
After downloading and saving DCOM95.EXE, do the following:

<OL><P><LI>Double-click DCOM95.EXE and proceed through the installation of DCOM95.
   This process requires you to reboot your system upon completion.
<P>
   NOTE: If you intend to install DCM95CFG.EXE at the same time, you can
   forgo rebooting your computer until the completion of DCM95CFG.EXE
   installation.

<P><LI>Double-click DCM95CFG.EXE. This will install the DCOMCNFG.EXE utility
   that allows you to configure a DCOM server component. This requires you
   to reboot your system upon completion.

<P><LI>Change the key below in the Windows 95 registry:
<P>
   HKEY_LOCAL_MACHINE\Software\Microsoft\OLE\EnableRemoteConnect
<P>
   to the following:
<P>
   Y
<P>
   NOTE: Failure to set this key results in the following error on the
   client:
<P>
   "Run-time error '429': ActiveX component can't create object"

<P><LI>Run DCOMCNFG on the Windows 95 Server. Select the server component and
   click the "Properties" button. Select the "Location" tab and ensure that
   the "Run application on this computer" check box is selected.
<P>
   Select the "Security" tab. Select either "Use default access
   Permissions" or "Use custom access permissions." If you opt to use
   custom permissions, click the Edit button.
<P>
   Use the "Add Access Permissions" dialog box to grant or deny access to
   users of the server component. Click OK to close the "Add Access
   Permissions" dialog box. Click OK again to close the "Access
   Permissions" dialog box. Then click Apply to put your access permissions
   into effect. If you do not set custom access permissions, your server
   component will use the default access permissions for the computer.
   Default access permissions are set from the "Distributed COM
   Configuration Properties" dialog box. Select the tab labeled "Default
   Security" to set access permissions as described above.
<P>
   NOTE: Failure to set the access permissions will result in the
   following error on the client:
<P>
   "Run-time error '70': Permission denied"

<P><LI>While it is not necessary to place a shortcut to RPCSS.EXE (found in
   your Windows\System folder) into your startup group, it is advisable
   because RPCSS.EXE needs to be running on the server before clients can
   connect.
<P>
   NOTE: Failure to run RPCSS.EXE before attempting to connect to it will
   result in the following error on the client:
<P>
   "Run-time error '-2147023174 (800706ba)': Automation error"
<P>
   This error message decodes to "The RPC server is unavailable."

<P><LI>Place a shortcut to the server component you want to automate through
   DCOM into the startup group. Again, this is not necessary, but because
   the server component must be running before a client can access it,
   this is a good technique to ensure the component is always running.
<P>
   NOTE: Failure to run the server component results in the following
   error on the client:
<P>
   "Run-time error '429': ActiveX component can't create object"
<P>
</OL><h2>REFERENCES</h2>
 
<P>
DCOM for Windows 95 release notes, located at:
<P>
<B><A href="http://www.microsoft.com/oledev">http://www.microsoft.com/oledev</A></B>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: rpcss<BR>
Keywords            : vb5all vb5howto VBKBAutomation VBKBAX VBKBComp VBKBExe kbhowto<BR>
Technology          : kbole<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
