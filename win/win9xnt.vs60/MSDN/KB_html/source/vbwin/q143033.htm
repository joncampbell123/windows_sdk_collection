

<HTML>
<HEAD>
<TITLE>Comparing AbsolutePosition to PercentPosition in VB 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143033">
<META NAME="KBModify" CONTENT="1996/05/20">
<META NAME="KBCreate" CONTENT="1996/01/24">
<META NAME="Keywords" CONTENT="kbprg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  In Microsoft Visual Basic 4.0 using Jet's DAO model, there are two Properties that can help you determine the current cursor position or that you can use to set the cursor to a certain position.  This article will demonstrate both properties and gi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBS0,QAMB,QA5V,QBXS,QACI,QAAW,QAH4,QAKC,QAUD,QAMN,QBVV,QBC6,QAY2,QAW6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Comparing AbsolutePosition to PercentPosition in VB 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143033</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   version 4.0, for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Visual Basic 4.0 using Jet's DAO model, there are two
Properties that can help you determine the current cursor position or that
you can use to set the cursor to a certain position.
<P>
This article will demonstrate both properties and give you some ideas on
when to use one or the other.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
According information from the online Help, the description of the
AbsolutePosition is as follows:
<P>
Returns or sets the relative record number of a Recordset object's current
record. Applies to the Recordset Object as a Dynaset-type or Snapshot-
type(except for forward-only Snapshots and passthrough queries).
<P>
According information from the online Help, the description of the
PercentPosition is as follows:
<P>
Returns or sets a value that indicates or changes the approximate location
of the current record in the Recordset object based on a percentage of the
records in the Recordset. Applies to all three types of Recordset Objects
(except for forward-only Snapshots and passthrough queries).
<P>
In the following code, I use the rs.MoveLast method before referring to
rs.PercentPosition. This is because PercentPosition is dependent on
RecordCount, and AbsolutePosition is not. The RecordCount property is not
accurate until you move to the end of your Recordset object. Also keep in
mind that RecordCount is not always 100 percent accurate, it is just an
estimate of the number of rows in your recordset, and therefore
PercentPosition is not always accurate--but AbsolutePosition is always
accurate. For instance, a dynaset in a multi-user environment does not
reflect rows other users have added until you issue the refresh method.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>Add two Command buttons(Command1, Command2), four Labels (Label1,
   Label2, Label3, Label4), one Data Control(Data1) and one Text box(Text1)
   to Form1. Place Label1 to the left of Text1 and place Label2 next to the
   Data control. Place Label3 next to the Command1 button and place Label4
   next to the Command2 button.

<P><LI>Set the following properties for each control:
<P>
<PRE>   Default   Property        Set to
   -----------------------------------------------
   Command1   Caption        AbsolutePosition
   Command2   Caption        PercentPosition
   Data1      DatabaseName   BIBLIO.MDB
   Data1      RecordSource   Titles
   Label1     Caption        Enter a Number:
   Text1      Text
   Label2     Caption
   Label2     DataSource     Data1
   Label2     DataField      Title
   Label3     Caption
   Label4     Caption

</PRE><P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Private Sub Command1_Click()
     Dim rs1 As Recordset
     Set rs1 = Data1.Recordset
     rs1.MoveLast
     rs1.AbsolutePosition = Val(Text1.Text)
     Label3.Caption = "Absolute Results: " &amp; rs1("title")
   End Sub

</PRE><P><LI>Add the following code to the Command2_Click event:
<P>
<PRE>   Private Sub Command2_Click()
     Dim rs2 As Recordset
     Set rs2 = Data1.Recordset
     rs2.MoveLast    'RecordCount now accurate
     rs2.PercentPosition = Val(Text1.Text)
     Label4.Caption = "Percent Results: " &amp; rs2("title")
   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S), or press the F5 key to run
   the program. Enter a number from 1 to 100 into Text1. Press the Command1
   button, then press the Command2 button. Look at the different results in
   Label3 versus Label4. You can test the location by selecting the arrow
   keys of the Data control also.
<P>
   You can experiment with different numbers to get different results. The
   PercentPosition property is good for helping in displaying a status bar
   type of indicator. The AbsolutePosition property could be used as a
   reference for jumping to certain records, but you could use a BookMark
   as well.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win<BR>
KBCategory: kbprg kbusage<BR>
KBSubcategory: APrgDataOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
