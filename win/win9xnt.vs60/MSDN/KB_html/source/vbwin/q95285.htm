

<HTML>
<HEAD>
<TITLE>FIX Large Sub or Function or Module Can Cause GP Fault or UAE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95285 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/02/04">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You can get a general protection (GP) fault in Windows version 3.1 or an unrecoverable application error (UAE) in Windows version 3.0 when making an .EXE file when you approach the maximum size limit of a sub or function or when a form or code modu...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBS0,QBKN,QAY5,QAFF,QDL9,QBWQ,QBWO,QBWN,QAB9,QAKP,QABN,QBV8,QA5E,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX Large Sub or Function or Module Can Cause GP Fault or UAE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95285 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00
WINDOWS
kbenv kbbuglist
<P>
 
The information in this article applies to:
<P>
- Standard and Professional editions of Microsoft Visual Basic programming
<PRE>  system for Windows, version 2.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You can get a general protection (GP) fault in Windows version 3.1 or an
unrecoverable application error (UAE) in Windows version 3.0 when making
an .EXE file when you approach the maximum size limit of a sub or
function or when a form or code module is larger than about 400K.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around the problem, break up the code in the large sub, function,
or module. In most cases, you will need to identify the largest sub,
function, or module in your project and work on breaking it up. If this
problem persists after breaking up the largest procedure or module, break
up other large procedures or modules until you overcome the problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Visual Basic version 2.0
for Windows. This problem was corrected in Microsoft Visual Basic version
3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The problem occurs with a sub or function because Visual Basic attempts
to generate more than 64K of code for the sub or function. However,
when you run it from the VB.EXE programming environment, it is possible
that the amount of interpreted code generated for the sub or function is
slightly less than 64K.
<P>
The problem occurs with a code module when the compiler attempts to exceed
a compiler segment limit.
<P>
Because of these problems, it is usually possible to run the program
successfully from the operating environment, but you cannot make an
.EXE file.
<P>
In Windows version 3.0, there is no way to know whether a large procedure
or module is the source of the problem. However, in Windows version 3.1, a
GP fault occurs at the address 0067:4C4D if a sub or function is too large
or at 0067:4C4E if compiler segment limits were exceeded when you attempted
to make an .EXE file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist2.00 fixlist3.00 2.00 3.00 GPF<BR>
KBCategory: kbenv kbbuglist<BR>
KBSubcategory: EnvtDes<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
