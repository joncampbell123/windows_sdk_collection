

<HTML>
<HEAD>
<TITLE>PRB: All Parameters of Choose Function Are Evaluated </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175979">
<META NAME="KBModify" CONTENT="1997/11/03">
<META NAME="KBCreate" CONTENT="1997/10/30">
<META NAME="Keywords" CONTENT="VB4WIN vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you specify functions as the Choice arguments in a Choose function, all functions are executed.  CAUSE =====  The Choose function allows you to select a value from a list of choices based on the value passed as the index. For example, the foll...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QBV8,QAB9,QBS0,QBXS,QAL3,QA28,QATJ,QBWS,QAKD,QAG2,QAPN,QAHE,QAGX,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: All Parameters of Choose Function Are Evaluated</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175979</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions
   for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you specify functions as the Choice arguments in a Choose function,
all functions are executed.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Choose function allows you to select a value from a list of choices
based on the value passed as the index. For example, the following
statement would result in x being assigned the value "b":
<P>
<PRE>   x = Choose(2, "a", "b", "c")

</PRE>The parameters passed to the Choose function do not need to be static
values as in the above example. You can use function names instead:
<P>
<PRE>   x = Choose(2, MyFunction1(), MyFunction2(), MyFunction3())

</PRE>In this situation, all of the functions referenced are executed regardless
of the index specified. In this example, the functions MyFunction1,
MyFunction2, and MyFunction3 are all executed even though the result of
MyFunction2 is the value returned by Choose.
<P>
Choose is implemented as a function with a parameter array and every
parameter must be evaluated before it can be passed to the Choose function.
<P>
Visual Basic's implementation of the Choose function can be duplicated with
the following function:
<P>
<PRE>   Public Function MyChoose(Index As Single, ParamArray Choice())
      On Error GoTo BadChoice
      If IsObject(Choice(Index - 1)) Then
         Set MyChoose = Choice(Index - 1)
      Else
         MyChoose = Choice(Index - 1)
      End If
      Exit Function
   BadChoice:
      MyChoose = Null
   End Function

</PRE><h2>RESOLUTION</h2>
 
<P>
Because this behavior is by design, another approach must be taken to avoid
all parameters being evaluated. The logic of the Choose function can easily
be broken down into an equivalent "If...Then...ElseIf" statement or a
"Select Case" statement.
<P>
<P><h3>Sample Choose Statement</h3>
 
<P>
<PRE>   result = Choose(MyIndex, MyFunction1(), MyFunction2(), MyFunction3())


</PRE><h3>Equivalent 'If...Then...ElseIf' Statement</h3>
 
<P>
<PRE>   If MyIndex = 1 Then
      result = MyFunction1()
   ElseIf MyIndex = 2 Then
      result = MyFunction2()
   ElseIf MyIndex = 3 Then
      result = MyFunction3()
   Else
      result = Null
   End If

</PRE>Equivalent 'Select Case' Statement
 
<P>
<PRE>   Select Case MyIndex
      Case 1
         result = MyFunction1()
      Case 2
         result = MyFunction2()
      Case 3
         result = MyFunction3()
      Case Else
         result = Null
   End Select

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new Visual Basic project. Form1 is created by default.

<P><LI>Add a Command button to Form1.

<P><LI>Add the following code to Form1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Function MyFunction1() As Long
<PRE></PRE>         Debug.Print "MyFunction1"
         MyFunction1 = 1
      End Function

      Private Function MyFunction2() As Long
         Debug.Print "MyFunction2"
         MyFunction2 = 2
      End Function

      Private Function MyFunction3() As Long
         Debug.Print "MyFunction3"
         MyFunction3 = 3
      End Function

      Private Sub Command1_Click()
         Dim result
         result = Choose(2, MyFunction1(), MyFunction2(), MyFunction3())
      End Sub

</PRE><P><LI>Save and run the project.

<P><LI>Click the CommandButton. Note that the "Debug.Print" statements from the
   three user-defined functions are executed even though the result of
   MyFunction2 is the returned value.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual Basic's Online Help for the Choose function.
 
<PRE>Keywords          : VB4WIN vb5all
Version           : WINDOWS:4.0,5.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
