

<HTML>
<HEAD>
<TITLE>How to Lock a Form so it Cannot Be Moved </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118376">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/07/17">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows you how to remove the Move and Size menu items from the Visual Basic Control menu (also known as the System Menu) to prevent the form from being moved or sized by the user.  MORE INFORMATION  If you do not want the user to be abl...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QBS0,QAVI,QACI,QA9N,QANJ,QAJP,QA7O,QAOE,QAMN,QAB5,QASC,QAB9,QDH6,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Lock a Form so it Cannot Be Moved</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118376</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows you how to remove the Move and Size menu items
from the Visual Basic Control menu (also known as the System Menu)
to prevent the form from being moved or sized by the user.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you do not want the user to be able to move or size your form, you
can remove both or either of the Move or Size menu items from the
Visual Basic control menu by using Windows API function calls. The
GetSystemMenu API Function returns the handle to the Control menu.
Then you can use that handle with the DeleteMenu API function to
modify or delete specific menu items.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following steps demonstrate how to remove the Move and Size menu items
from the Visual Basic control menu:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Place a command button (Command1) on Form1. Change its Caption
   property to Lock Form.

<P><LI>Add the following declarations and constants to the general
   Declarations section of Form1:
<P>
<PRE>   ' Enter each Declare statement as one, single line:
   Declare Function GetSystemMenu Lib "User" (ByVal hWnd%,
      ByVal bRevert%) As Integer
   Declare Function DeleteMenu Lib "user" (ByVal hMenu%, ByVal iditem%,
      ByVal wflags%) As Integer

   Const SC_SIZE = &amp;HF000
   Const SC_MOVE = &amp;HF010
   Const MF_BYCOMMAND = &amp;H0

   NOTE: Other constants to remove other menu items in the Control
   menu are described in the WIN30API.TXT text file found in the
   \VB\WINAPI directory.

</PRE><P><LI>Add the following code to the Command1 Click event:
<P>
<PRE>   Sub Command1_Click ()
      Dim hWnd%, hMenu%, Success%
      hWnd% = Form1.hWnd
      hMenu% = GetSystemMenu(hWnd%, 0)
      Success% = deletemenu(hMenu%, SC_SIZE, MF_BYCOMMAND)
      Success% = deletemenu(hMenu%, SC_MOVE, MF_BYCOMMAND)
   End Sub

</PRE><P><LI>Press the F5 key to run the program.

<P><LI>Click the command button to remove the menu items. Now attempt to
   move or size the form. You will not be able to move or size the form.
   However, you will be able to maximize it or minimize it or change its
   position and size in code.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Another method, similar to the one presented here is presented in the
following article in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A href="../vbwin/q82876.htm">Q82876</A></B>
<PRE>TITLE     : How to Disable Close Command in VB Control Menu (System Menu)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
