

<HTML>
<HEAD>
<TITLE>PRB: Disk or Network Error When Trying to Run Database App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150943">
<META NAME="KBModify" CONTENT="1996/05/16">
<META NAME="KBCreate" CONTENT="1996/05/13">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Any attempt to run a project or executable that accesses a database fails with error 3043  Disk or Network Error  or a Page Fault.  CAUSE =====  This behavior is caused by an invalid or non-existent Temp or TMP directory. The problem only affects a...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAAP,QAB4,QBQU,QBF0,QAYL,QBTX,QBXB,QBWP,QAZV,QATJ,QA1S,QAKP,QAFI,QDH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Disk or Network Error When Trying to Run Database App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150943</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Any attempt to run a project or executable that accesses a database fails
with error 3043 "Disk or Network Error" or a Page Fault.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is caused by an invalid or non-existent Temp or TMP
directory. The problem only affects applications running on Windows NT.
Windows 95 creates a default Temp directory if one does not exist or is
invalid.
<P>
The following combinations of these two environment variables cause
the problem:
<P>
<PRE>   TMP missing and Temp missing
   TMP invalid and Temp missing
   TMP missing and Temp invalid

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. We are researching this issue
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Using the System applet in the Control Panel, add or correct the
environment variable named "Temp" so it points to a valid directory for
temporary files such as:
<P>
<PRE>   Temp=C:\WINNT35\Temp

</PRE>Using the System applet in the Control Panel, add or correct the
environment variable named "TMP" so it points to a valid directory for
temporary files such as:
<P>
<PRE>   TMP=C:\WINNT35\Temp

</PRE>Reboot, and note that the database applications run properly.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Jet engine version 3.0, used by Visual Basic 4.0 to gain
access to databases, looks for a Temp or TMP environment variable pointing
to a valid directory in which to store the necessary temporary files. If
this information cannot be obtained, an error condition is encountered. The
version of the Jet engine that ships with Visual Basic 4.0 incorrectly
causes a Page Fault when an error condition is encountered. The version of
the Jet engine that ships with Access 95 and Visual Basic 4.0a correctly
handles the error and displays the "Disk or Network Error" error message.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: APrgDataOther
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
