

<HTML>
<HEAD>
<TITLE>How to Request Exclusive Use of a Table in VB Prof 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108467">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/12/13">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Below is an example of how to request exclusive use of a table and deny access to other users.  MORE INFORMATION  If you do not want any other users to access a table while you have it open, open the table exclusively. Set the options argument of t...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QBW7,QBWS,QAI5,QBWG,QBXS,QBRZ,QA5F,QAVX,QAVW,QAN0,QAMA,QAIJ,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Request Exclusive Use of a Table in VB Prof 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108467</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows, version 3.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Below is an example of how to request exclusive use of a table and deny
access to other users.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you do not want any other users to access a table while you have it
open, open the table exclusively. Set the options argument of the OpenTable
method to a value equal to DB_DENYREAD plus DB_DENYWRITE to give your
program exclusive access.
<P>
The values of all constants for data access, such as DB_DENYREAD and
DB_DENYWRITE, are defined in the DATACONS.TXT text file installed in
your Visual Basic directory.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Double-click the form to open its code window. Add the following code
   to the Form Load event:
<P>
<PRE>   Sub Form_Load ()
      Dim i As Integer
      Dim db As Database
      Dim tb As table

      On Error GoTo ExclusiveErr
      Const DB_DENYWRITE = &amp;H1  ' Constant defined in DATACONS.TXT file
      Const DB_DENYREAD = &amp;H2   ' Constant defined in DATACONS.TXT file
      Set db = OpenDatabase("C:\VB3\BIBLIO.MDB")
      Set tb = db.OpenTable("authors", DB_DENYREAD + DB_DENYWRITE)
      ' To open shared access, use: Set tb = db.OpenTable("authors", 0)
      MsgBox "Database &amp; table opened successfully, denying read &amp; write."
      'PlaceDataInControls
      EndExclusiveOpen:
   Exit Sub

   ExclusiveErr:
   Select Case Err
   Case 3262
      MsgBox "Table is locked. You cannot open it exclusively. Try shared."
      'optExclusive.Value = False
      Resume EndExclusiveOpen
   Case 3261
      MsgBox "Table exclusively locked by another user -- cannot open."
      End
   Case Else
      MsgBox Err &amp; " " &amp; Error$
   End Select

   End Sub

</PRE><P><LI>From the File menu, choose Make EXE File. Name the executable file
   TEST.EXE.

<P><LI>Run one copy of TEST.EXE from the Windows File Manager or Program
   Manager. Leave the following message on the screen without choosing OK,
   in order to leave the database open:
<P>
<P><PRE>      Database &amp; table opened successfully, denying read &amp; write.
</PRE>
<P><LI>Start the program in Visual Basic by pressing the F5 key. This second
   instance of the program displays the following message:
<P>
<P><PRE>      Table is locked. You cannot open it exclusively. Try shared.
</PRE>
<P><LI>Close the form to end the program session in Visual Basic. Change
   DB_DENYREAD + DB_DENYWRITE to 0 in the OpenTable method as follows:
<P>
<P><PRE>      Set tb = db.OpenTable("authors", 0)
</PRE><P>
   This opens the table with shared access, the default.

<P><LI>Start the program in Visual Basic by pressing the F5 key. This second
   instance of the program now displays the following message:
<P>
<P><PRE>      Table exclusively locked by another user. You cannot open it.
</PRE>
<P><LI>You can end the first instance of the program, TEST.EXE, by clicking
   OK and closing the form.
<P>
</OL><h2>REFERENCES</h2>
 

<UL><LI>Microsoft Visual Basic 3.0: Professional Features Book 2: Data Access
   Guide, page 58.

<LI>DATACONS.TXT text file installed in your Visual Basic directory.

<LI>The VISDATA.MAK file installed in the VB3\SAMPLES\VISDATA directory
   loads extensive examples of data access. The VISDATA sample program uses
   every data access function in Visual Basic. You can refer to the VISDATA
   source code for examples of how to use each data access function.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgDataOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
