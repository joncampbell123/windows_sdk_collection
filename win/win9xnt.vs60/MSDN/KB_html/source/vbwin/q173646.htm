

<HTML>
<HEAD>
<TITLE>HOWTO: Use a Custom Jet Profile to Alter Data Access Behavior </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173646">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1997/09/09">
<META NAME="Keywords" CONTENT="APrgDataAcc vb416 VB4WIN vb5all VBKBEnv VBKBRegistry">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You can edit the Jet Registry keys to alter the data access behavior of the Microsoft Jet database engine. However, doing so affects all Jet-based applications, and may have unintended negative consequences for some. By using custom profiles, you c...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBS0,QDN9,QDJ2,QABA,QALH,QAKD,QBAO,QAJH,QBW4,QDKY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Use a Custom Jet Profile to Alter Data Access Behavior</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173646</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Microsoft Visual Basic Professional and Enterprise Editions, 32-bit
   only, for Windows, version 4.0
<LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can edit the Jet Registry keys to alter the data access behavior of the
Microsoft Jet database engine. However, doing so affects all Jet-based
applications, and may have unintended negative consequences for some. By
using custom profiles, you can tune Jet on a per-application basis.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In 16-bit versions of Visual Basic and Microsoft Access, Jet settings are
stored in an .ini file (for example, Msaccess.ini or Msacc20.ini). You can
provide a custom .ini file with your application that contains settings
specific to your application.
<P>
The 32-bit versions of Jet read their settings from the registry.
<P>
In Visual Basic 4.0 and 5.0, Jet versions 3.0 and 3.5 use the default
registry location:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.0

 -or-

   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5

</PRE>If using Microsoft Access, settings are read from the following branch
first, and then the default location (above) is used for any additional
values:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Access\7.0\Jet\3.0

 -or-

   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\8.0\Access\Jet\3.5

</PRE>To prevent multiple applications from making custom changes to these
settings and negatively impacting other Jet-based programs, the application
can tell Jet to read its settings from a different branch of the registry.
These alternate branches are known as Profiles.
<P>
You don't have to reproduce the entire registry branch in your profile.
Values you specify in your custom profile override values specified in the
default registry location, which in turn override internal Jet default
values.
<P>
<P><h3>Example Profile</h3>
 
<P>
NOTE: Inadvertent changes to the Registry could affect the stability of the
operating system. You should back up the registry prior to proceeding.
<P>
This example illustrates registry changes for a custom profile that lowers
the LockRetry setting from the default value of 20 to 5.

<OL><P><LI>In the Registry Editor, expand HKEY_LOCAL_MACHINE\SOFTWARE and add key
   values for your company name (MyCorp), application name (MyApp), and
   version (1.0):
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0
</PRE>
<P><LI>The above is sufficient for Visual Basic, but to maintain compatibility
   with Microsoft Access applications, add keys for "Jet" and "3.0" or
   "3.5":
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0\Jet\3.0
</PRE><P>
   -or-
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0\Jet\3.5
</PRE>
<P><LI>This is an empty Profile. From here, add keys and values that affect
   Jet's behavior. To make the LockRetry changes, add the keys "Engines"
   and "Jet":
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0\Jet\3.0\Engines\Jet
</PRE><P>
   -or-
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0\Jet\3.5\Engines\Jet
</PRE><P>
   Then, add a REG_DWORD Value, called LockRetry, and a value of 5.
<P>
</OL>The profile is complete.
<P>
<P><h3>Using the Profile in Visual Basic</h3>
 
<P>
To use the profile in Visual Basic, set DBEngine.IniPath to the profile
name prior to using any database functionality:
<P>
In Visual Basic 4.0:
<P>
<PRE>   DBEngine.IniPath = _
     "HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0\Jet\3.0"

</PRE></OL>In Visual Basic 5.0:
<P>
<PRE>   DBEngine.IniPath = _
     "HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0\Jet\3.5"

</PRE><h3>Using the Profile in Microsoft Access</h3>
 
<P>
Unlike visual Basic, where you can set the profile name programmatically,
Jet is already initialized by the time your Microsoft Access code is
running. To specify a profile name, you need to add another registry key to
specify a "friendly" profile name and use a command-line switch when
starting Microsoft Access:

<OL><P><LI>Expand the following registry branch:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Access\7.0
</PRE><P>
   -or-
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\8.0\Access
</PRE>
<P><LI>Add a key "Profiles".
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Access\7.0\Profiles
</PRE><P>
   -or-
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\8.0\Access\Profiles
</PRE>
<P><LI>Add a REG_SZ value with the name being your "friendly" profile name
   (for example, MyProfile) and the value being the registry branch where
   the profile settings are located. For example:
<P>
<P><PRE>      Name:  MyProfile
      Type:  REG_SZ
      Value: HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0
</PRE>
<P><LI>Start Microsoft Access with the command-line option:
<P>
<P><PRE>      MSACCESS.EXE /PROFILE "MyProfile" MYDATABASE.MDB
</PRE><P>
</OL>Microsoft Access 95 will automatically choose the ...\Jet\3.0 branch,
Microsoft Access 97 will automatically choose the ...\Jet\3.5 branch, in
Visual Basic you must specify the complete profile path.

<OL><P><LI>Because you can't guarantee that Microsoft Access was started using the
   correct profile, you can check your startup code to see if the user
   started the application properly or just double-clicked the icon for the
  .mdb file. For example:
<P>
<P><PRE>      If SysCmd(acSysCmdProfile) &lt;&gt; "MyProfile" Then
<PRE></PRE>        MsgBox "To use this database, run MyApp from the Start Menu"
        DoCmd.Quit acExit
      End If

</PRE></OL><h3>Compatibility with Earlier Jet Databases</h3>
 
<P>
If the database you're opening is used by earlier versions of Jet (1.0,
1.1, 2.0, or 2.5), Microsoft Jet 3.x doesn't read these files directly. It
uses an Installable ISAM engine in the same way it would when reading a
dBase or Paradox file.
<P>
For example, to set the LockRetry value for accessing a Jet 2.x database,
add the Value to the following location:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0\Jet\3.0\Engines\Jet
   2.x\ISAM

</PRE>You still only reference the profile location as indicated in the Microsoft
Access and Visual Basic usage sections above. For example:
<P>
In Visual Basic:
<P>
<PRE>   DBEngine.IniPath = _
     "HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0\Jet\3.0"

   -or-

   DBEngine.IniPath = _
     "HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0\Jet\3.5"

</PRE>In Microsoft Access:
<P>
<PRE>   Value: HKEY_LOCAL_MACHINE\SOFTWARE\MyCorp\MyApp\1.0

</PRE><h3>Table of Engine Keys</h3>
 
<P>
The following table lists registry branches for the Jet 3.x engine and the
various other engines:
<P>
<PRE>   Engine     Registry Branch
   ----------------------------------------------------

   Jet 3.x    ...\Engines\Jet
   Jet 2.x    ...\Engines\Jet 2.x\ISAM
   ODBC       ...\Engines\ODBC
   Xbase      ...\Engines\Xbase
   Paradox    ...\Engines\Paradox
   Excel      ...\Engines\Excel
   Lotus      ...\Engines\Lotus
   Text       ...\Engines\Text

</PRE><h3>Jet 3.5 Notes</h3>
 
<P>
With Jet 3.5, you can tune some values dynamically using the new SetOption
method of the DBEngine object. This means you can use some values for one
part of your program, that is, to favor a bulk update, while using other
values in another part of your program, that is, to favor interactive data
entry. Using DBEngine.SetOption affects only the current instance of your
program. It can be used in Microsoft Access 97 and Visual Basic 5.0.
<P>
The following table lists the settings you can change:
<P>
<PRE>   Setting                 Constant
   ---------------------------------------------------

   PageTimeout             dbPageTimeout
   SharedAsyncDelay        dbSharedAsyncDelay
   ExclusiveAsyncDelay     dbExclusiveAsyncDelay
   LockRetry               dbLockRetry
   UserCommitSync          dbUserCommitSync
   ImplicitCommitSync      dbImplicitCommitSync
   MaxBufferSize           dbMaxBufferSize
   MaxLocksPerFile         dbMaxLocksPerFile
   LockDelay               dbLockDelay
   RecycleLVs              dbRecycleLVs
   FlushTransactionTimeout dbFlushTransactionTimeout

</PRE>Usage:
<P>
<PRE>   DBEngine.SetOption dbMaxBufferSize, 128

</PRE><h2>REFERENCES</h2>
 
<P>
For a complete list of Jet engine registry settings and their descriptions,
refer to
<P>
<PRE>   Appendix C of the Microsoft Jet Database Engine Programmer's Guide

</PRE>or the Help topic:
<P>
<PRE>   Customizing Windows Registry Settings for Data Access Objects

</PRE>For help with Microsoft Access Profiles, see the Help topic "Profiles,
User."
<P>
To programmatically read/write registry settings, please refer to the
following Knowledge Base article:
<P>
<PRE>   ID:    <B><A href="../vbapps/q145679.htm">Q145679</A></B>
   Title: How to Use the Registry API to Save and Retrieve Setting

</PRE><P><LI>For more information on DBEngine.SetOption, see the Help topic:
<P>
   Customizing Windows Registry Settings for Data Access Objects
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: vb5 vb4<BR>
Keywords          : APrgDataAcc vb416 VB4WIN vb5all VBKBEnv VBKBRegistry<BR>
Component         : jet<BR>
Version           : WINDOWS:4.0,5.0,7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
