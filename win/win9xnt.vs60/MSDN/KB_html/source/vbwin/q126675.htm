

<HTML>
<HEAD>
<TITLE>BUG: Menu Lost if Caption Changed on Menu with Only WindowList </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126675">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1995/02/28">
<META NAME="Keywords" CONTENT="kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When a top-level menu has its WindowList property set to True and the top- level menu does not contain any sub-menus, after changing the menu's caption the top-level menu will no longer display the list of MDI child windows and you will not receive...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QAPN,QAF0,QBWS,QABI,QAMB,QAH4,QBS0,QDL9,QBWQ,QBWO,QBWN,QBVV,QAVX,QAVW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Menu Lost if Caption Changed on Menu with Only WindowList</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126675</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a top-level menu has its WindowList property set to True and the top-
level menu does not contain any sub-menus, after changing the menu's
caption the top-level menu will no longer display the list of MDI child
windows and you will not receive any click events.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In order to work around the problem, make sure the top-level menu item
that has the WindowList property set to True has at least 1 sub-menu
item.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In the example below, a menu on the MDI form contains nothing but a
WindowList. A command button is placed on the MDI child form with code
behind it to change the caption of the menu containing the WindowList. As
long as you do not click on the command button, the Window menu will
display a list the MDI child windows. Once you click on the command button,
the Window menu caption is changed to "Test" and it no longer keeps track
of the MDI child windows and it no longer receives click events.
<P>
NOTE: Issuing the command "Print MDIForm1.mnuwindow.Windowlist"
(without the quotes) from the immediate window will return -1 (True).
However, the Window list is not displayed.
<P>
<P><h3>Steps To Recreate The Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic (ALT, F, N). Form1 is created
   by default.

<P><LI>From the Property Window, set MDIChild equal to True for Form1.

<P><LI>Add a Command button (Command1) to Form1 and add the following
   code to the Click event.
<P>
<PRE>      Sub Command1_Click ()
         MDIForm1.mnuWindow.Caption = "Test"
      End Sub

</PRE><P><LI>From the File menu, select New MDI Form. MDIForm1 is created by
   default.

<P><LI>From the Window menu, choose Menu Design.

<P><LI>Create a menu for the MDI Form with the following properties:
<P>
<PRE>   Caption   Name        Indented   WindowList
   -------------------------------------------
   File      mnuFile     No         Unchecked
   New       mnuNew      Once       Unchecked
   Window    mnuWindow   No         Checked

</PRE><P><LI>Choose Done to exit the Menu Design Window. You now have two
   top-level menus.

<P><LI>Add the following code to the Click event of mnuNew menu on MDIForm1.
<P>
<PRE>      Sub mnuNew_Click ()
        Dim f As New Form1
        f.Show
      End Sub

</PRE><P><LI>Press F5 to run the program.

<P><LI>The Window menu will keep track of all the MDIChild windows as long as
<P><PRE>    you do not click Command1 contained in the MDIChild. Once you click on
    the command button, the Window menu's caption has changed to "Test" and
    it will no longer list any of the MDIChild windows and you will not
    receive any click events.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 buglist3.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
