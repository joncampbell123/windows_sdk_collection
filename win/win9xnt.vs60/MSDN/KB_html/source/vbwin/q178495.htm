

<HTML>
<HEAD>
<TITLE>BUG: Invalid Page Fault When Deleting Nodes in TreeView Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178495">
<META NAME="KBModify" CONTENT="1997/12/23">
<META NAME="KBCreate" CONTENT="1997/12/23">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  While attempting to delete nodes from a TreeView control, you receive an Invalid Page Fault and your Visual Basic application is terminated.  CAUSE =====  This problem may occur when the user clicks on the TreeView control and this action causes an...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMN,QBS0,QA7O,QAOE,QAB5,QAIJ,QAH4,QAFF,QBWS,QDL9,QBWO,QBWN,QAGB,QAKP,QBCT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Invalid Page Fault When Deleting Nodes in TreeView Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178495</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
<LI>Microsoft Visual Studio versions 97, 97sp1, 97sp2, 97sp3
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
While attempting to delete nodes from a TreeView control, you receive an
Invalid Page Fault and your Visual Basic application is terminated.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur when the user clicks on the TreeView control and
this action causes an event procedure to run that attempts to delete nodes
from the TreeView before the TreeView gets the focus.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem, call the DoEvents function in the MouseDown event
of the TreeView Control. For example:
<P>
<PRE>   Private Sub TreeView1_MouseDown(Button As Integer, Shift As Integer, _
     x As Single, y As Single)
        DoEvents
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new Standard EXE project in Visual Basic. Form1 is created by
   default.

<P><LI>Click Components from the Project menu and check Microsoft Windows
   Common Controls 5.0.

<P><LI>Place a TreeView control and a TextBox control on Form1.

<P><LI>Copy the following code to the Code window of Form1:
<P>
<P><PRE>      Private Sub Form_Load()
<PRE></PRE>         TreeView1.Nodes.Add , , "A", "A"
      End Sub

      Private Sub Text1_LostFocus()
         TreeView1.Nodes.Clear
      End Sub

</PRE><P><LI>On the Run menu, click Start, or press the F5 key to start the program.

<P><LI>Click on the TextBox so that it has the focus.

<P><LI>Click on the "A" node in the TreeView control.
<P>
   On Windows 95, you receive the following error:
<P>
<P><PRE>      VB5 caused an invalid page fault in module COMCTL32.DLL at
      &lt;address&gt;.
</PRE><P>
   On Windows NT, you receive the following error:
<P>
<P><PRE>      Exception: Stack overflow in VB5.EXE
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      The exception unknown software exception (0xc00000fd) occurred in the
      application at location &lt;address&gt;.
</PRE><P>
   NOTE: You may have to repeat steps 6 and 7 several times before seeing
   the problem.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: application error crash gpf ipf page fault<BR>
Keywords          : vb5all<BR>
Version           : WINDOWS:5.0,97,97sp1,97sp2,97sp3<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
