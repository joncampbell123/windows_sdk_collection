

<HTML>
<HEAD>
<TITLE>FIX: Referencing Data Object Gives Error: Object not an Array </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100367">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/06/20">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  An  Object not an Array  error results when you reference a field of a dynaset, table, or snapshot object in a form or module that does not contain a Set statement for that dynaset, table, or snapshot. The error occurs when Visual Basic attempts to...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QBXS,QAFF,QAPN,QAB9,QBVV,QAW6,QAMA,QAAP,QBJZ,QAKP,QAY2,QAB4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Referencing Data Object Gives Error: Object not an Array</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100367</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbinterop kbprg kbbuglist
<P>
 
<P>
The information in this article applies to:

<UL><LI>Professional Edition of Microsoft Visual Basic for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An "Object not an Array" error results when you reference a field of a
dynaset, table, or snapshot object in a form or module that does not
contain a Set statement for that dynaset, table, or snapshot. The error
occurs when Visual Basic attempts to compile your program.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error is caused by a parsing problem in the Visual Basic programming
environment. The Visual Basic parser does not recognize the object type
because there is no Set statement in the same form or module.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Add a dummy Sub procedure to each form or module, and use a Set statement
that refers to the global database / table / dynaset in a meaningful way
(for example, Set myds = db.CreateDynaset(...) not set myDs = myDs). Give
the Sub procedure a name like 'AAAAA_Fix_Parser' so it becomes the first
code parsed in that form or module. Make sure the dynaset set in the dummy
<PRE>Sub procedure is the exact same dynaset that is causing the problem.

</PRE>When adding more than one dummy Sub procedure to a project, give each Sub
procedure a different name (AAAAA1, AAAAA2, and so on) to avoid name
collisions that could complicate your existing problem.
<P>
For example, use the following dummy procedure if MyDs is the dynaset
causing the problem:
<P>
<PRE>   Sub AAAAAA_Fix_Parser
      Set MyDs = MyDB.CreateDynaset("...")
   End Sub

</PRE>You never need to execute the code in the Sub procedure or even call the
<PRE>Sub procedure. Once you add the Sub procedure, the parser sees the Set
</PRE>statement(s) before it tries to parse any other code, so it does not have
trouble with the global objects. After adding the Sub procedure, you do not
have to tweak the code every time you reload the project; you can do it
once and save it.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Microsoft Visual Basic version
3.0 for Windows. This bug was corrected in Microsoft Visual Basic version
4.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>From the File menu, choose New Module (ALT, F, M). Module1 is created.

<P><LI>Add a text box (Text1) to Form1.

<P><LI>Add the following code to the General section of Module1:
<P>
   Global MyDs As Dynaset

<P><LI>Add the following code to Module1:
<P>
<PRE>   Sub main ()
      Dim MyDB As Database
      Dim SQLStmt As String
      Const DB_READONLY = 4   ' Set constant.
      Set MyDB = OpenDatabase("BIBLIO.MDB")   ' Open database.
      ' Set text for the SQL statement.
      SQLStmt = "SELECT * FROM Publishers WHERE State = 'NY'"
      ' Create the new Dynaset.
      Set MyDs = MyDB.CreateDynaset(SQLStmt, DB_READONLY)
      form1.Show
    End Sub

</PRE><P><LI>Add the following code to the Form_Load event procedure of Form1:
<P>
<PRE>   Sub Form_Load ()
      Text1.Text = MyDs("state")
   End Sub

</PRE><P><LI>From the Options menu, choose Project (ALT, O, P). The Projects Options
   dialog is displayed.

<P><LI>From the Project Options dialog, set the Start Up Form to Sub Main and
   choose OK.

<P><LI>From the Run menu, choose start (ALT, R, S) or press F5.
<P>
</OL>The following line of code returns the error "Object not an Array":
<P>
<PRE>   Text1.text = MyDs("state").
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 fixlist4.00 3.00<BR>
KBCategory: kbinterop kbprg kbbuglist<BR>
KBSubcategory: APrgDataIISAM PrgCtrlsStd<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
