

<HTML>
<HEAD>
<TITLE>BUG: Toolbar Does Not Wrap Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175533">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1997/10/22">
<META NAME="Keywords" CONTENT="vb432 VB4WIN vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you change the number of visible buttons on a Toolbar, the Toolbar does not wrap when it should. This problem may occur when adding, removing, or changing the Visible property of buttons on the Toolbar.  RESOLUTION  The work around is to eithe...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANS,QAF0,QA5D,QBS0,QA6Y,QAJD,QDL9,QBWO,QBWN,QBVV,QAPN,QAML,QAH4,QAFF,QATP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Toolbar Does Not Wrap Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175533</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Microsoft Visual Basic Professional and Enterprise Editions, 32-bit
   only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you change the number of visible buttons on a Toolbar, the Toolbar
does not wrap when it should. This problem may occur when adding, removing,
or changing the Visible property of buttons on the Toolbar.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The work around is to either resize the form or use
SendMessage(Toolbar1.hwnd, WM_SIZE, 0, 0) to force resizing of the Toolbar.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When using the Add method of the Buttons Collections, wrapping will not
occur with the first Button that won't fit but will occur when a subsequent
Button is added. Conversely, when using the Remove method, wrapping occurs
one Button too soon so that when only one Button remains on the last row,
the Toolbar unwraps, placing this last Button off the Toolbar. Changing the
Visible property of Buttons never triggers wrapping. The example that
follows demonstrates the problem.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new Visual Basic project.

<P><LI>Click Components on the Project menu and check "Microsoft Windows Common
   Controls 5.0."

<P><LI>Add two CommandButtons and a Toolbar control to Form1.

<P><LI>Paste the following code into the form's General Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Declare Function SendMessage Lib "user32" Alias _
      "SendMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, _
      ByVal wParam As Long, lParam As Any) As Long
</PRE><P>
<P><PRE>      Const WM_SIZE = &amp;H5
</PRE><P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>      Dim I As Integer    ' Make all Buttons visible
      For I = 1 To Toolbar1.Buttons.Count
          Toolbar1.Buttons(I).Visible = True
      Next I
      End Sub

      Private Sub Command2_Click()
      Dim RetVal As Long
      ' If Internet Explorer 4.0 is installed, you must repeat the
      ' following SendMessage line, so that the message is sent twice.
      RetVal = SendMessage(Toolbar1.hwnd, WM_SIZE, 0, 0)  ' Wrap
      ' If placing another control on the Toolbar, set it's Left and ZOrder
      ' properties after the SendMessage.  For a demonstration of this,
      ' see "Example" under "Toolbar Control" in On Line Help.
      End Sub

      Private Sub Form_Load()
      Dim I As Integer
      Dim btnX As Button
      Me.Width = 4200     ' So that 15 buttons won't fit
      Me.Height = 3000    ' So that Command buttons will fit
      Toolbar1.Wrappable = True
      For I = 1 To 15     ' Add more buttons than will fit
          Set btnX = Toolbar1.Buttons.Add(, , , tbrDefault)
          If I &gt; 5 Then btnX.Visible = False  ' Start with 5 buttons
          If I Mod 5 = 0 Then ' Make Groups of 5 (Optional)
              Set btnX = Toolbar1.Buttons.Add(, , , tbrSeparator)
          End If
      Next I
      ' Place and size Command buttons so that Toolbar1 has room to wrap
      With Command1
        .Width = 2000
        .Caption = "Add Buttons"
        .Left = 200
        .Top = (Toolbar1.Height * 2) + 250
      End With
      With Command2
        .Width = 2000
        .Caption = "Wrap Toolbar"
        .Left = 200
        .Top = Command1.Top + Command1.Height + 15
      End With
      End Sub

</PRE><P><LI>Run the project. You will see five blank buttons on the Toolbar.

<P><LI>Click on "Add Buttons." Ten more buttons are made visible but not all
   will fit. Note that the ToolBar does not wrap.

<P><LI>Click on "Wrap Toolbar." Note that the Toolbar now wraps.
<P>
</OL>Making more buttons visible than will fit on the Toolbar should cause it to
wrap, but the code to do this is not triggered. Resizing the Form will
trigger this code, but using the SendMessage API is a better solution
because it also works on a Maximized Form.
 
<PRE>Keywords          : vb432 VB4WIN vb5all
Version           : WINDOWS:4.0,5.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
