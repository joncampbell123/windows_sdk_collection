

<HTML>
<HEAD>
<TITLE>FIX: Crash When Enum Name Referenced Incorrectly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171482">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/07/16">
<META NAME="Keywords" CONTENT="vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When incorrectly referring to an Enum name of a UserControl, such as treating the Enum name as a Property of the UserControl, Visual Basic will give a fatal error and close.  The error received will be similar to one of the following;     “VB5 caus...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDO3,QAAP,QAR4,QA56,QA55,QAM1,QAUJ,QAJQ,QAH4,QA5F,QAPN,QAMA,QAB4,QAP2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Crash When Enum Name Referenced Incorrectly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171482</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When incorrectly referring to an Enum name of a UserControl, such as
treating the Enum name as a Property of the UserControl, Visual Basic will
give a fatal error and close.
<P>
The error received will be similar to one of the following;
<P>
<PRE>   “VB5 caused an invalid page fault in module VB5.Exe...”

   - or -

   “The instruction at "0x004762d3 referenced memory at "0x0000000".
   The memory could not be "read"...”

</PRE><h2>CAUSE</h2>
 
<P>
The fatal error is the end result of incorrectly referencing a Enum name
within a UserControl. For example, if the following Enum is declared in the
General Declarations of a UserControl:
<P>
<PRE>      Public Enum Salsa
         Mild
         Medium
         Hot
      End Enum

</PRE>then an instance of UserControl is added to a form, and the Salsa
enumeration is referred to as:
<P>
<PRE>      UserControl1.Salsa

</PRE>The fatal error described above will occur. Enumerations behave like public
constants and cannot be referenced like a variable or property. To
reference the Salsa enumeration correctly, the user should reference
Salsa.&lt;membername&gt;, such as:
<P>
<PRE>   Salsa.Hot

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 2, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new Standard Exe project in Visual Basic 5.0. Form1 is created
   by default.

<P><LI>From the Project menu, select Add UserControl to add a UserControl
   (UserControl1) to the Project.

<P><LI>Add the following enumeration to the General Declarations section of the
   UserControl:
<P>
<P><PRE>      Public Enum Salsa
<PRE></PRE>               Mild
               Medium
               Hot
            End Enum

</PRE><P><LI>Close both the UserControl1 code Window and the UserControl1 design
   Window.

<P><LI>Place an instance of the UserControl1 (UserControl11) onto Form1.

<P><LI>Add a CommandButton to Form1.

<P><LI>In the Click event of the CommandButton, add the following code:
<P>
<P><PRE>      Usercontrol11.Salsa
</PRE>
<P><LI>Save and run the Project. Click the CommandButton to reproduce the
   problem in Visual Basic 5.0.
<P>
</OL>NOTE: This can also be reproduced simply by typing in the
"UserControl11.Salsa" line in the Click event. After typing the line, press
the spacebar and note that you get the same result.
 
<PRE>Keywords          : vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
