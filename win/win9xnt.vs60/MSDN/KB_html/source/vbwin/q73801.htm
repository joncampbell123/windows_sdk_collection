

<HTML>
<HEAD>
<TITLE>PRB: UAE or GP Fault with VB .EXE Acting as Windows 3.0 Shell </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73801 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1991/07/08">
<META NAME="Keywords" CONTENT="kbenv kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Compiled Visual Basic .EXE applications can be used as the Windows shell in Windows version 3.1 on an 80386 computer or better. However, an .EXE application created by Visual Basic cannot be used as the Windows shell in Windows version 3.0. Attempt...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDL9,QBWQ,QBWO,QBWN,QBJZ,QBIC,QBKN,QBWS,QAGQ,QAIJ,QAH4,QA5F,QAMA,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: UAE or GP Fault with VB .EXE Acting as Windows 3.0 Shell</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73801 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, versions 1.0
<PRE>  and 2.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Compiled Visual Basic .EXE applications can be used as the Windows shell in
Windows version 3.1 on an 80386 computer or better. However, an .EXE
application created by Visual Basic cannot be used as the Windows shell in
Windows version 3.0. Attempting to run an application as the Windows
version 3.0 shell results in an Unrecoverable Application Error (UAE).
<P>
<P><h2>STATUS</h2>
 
<P>
This is a design limitation of Windows version 3.0. It is not a limitation
in Windows version 3.1, with one exception. When you run the .EXE program
in Windows version 3.1 standard mode on a 80286 computer, a General
Protection (GP) fault occurs at the same point where a UAE occurs in
Windows version 3.0.
<P>
Basically, you can use a Visual Basic .EXE program as a Windows shell only
on an 80386 computer or better. This information applies only to Visual
Basic .EXE programs.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A user-defined shell application can be specified in the Windows system
initialization (SYSTEM.INI) file. The default shell is PROGMAN.EXE (the
Program Manager). If a Visual Basic program is specified as the customized
Windows 3.0 shell, a Windows 3.0 UAE occurs on any attempt to run Windows
version 3.0 from the MS-DOS command line. This problem does not occur with
Windows version 3.1.
<P>
A Visual Basic application cannot be run as the Windows 3.0 shell because
it does not contain the special set of startup code required by a Windows
3.0 shell application. The only way to create a Windows 3.0 shell
application is to use the C Compiler and the Windows Software Development
Kit (SDK) to write a non-Visual Basic application.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
WARNING: The following steps require changing the Windows system
initialization file (SYSTEM.INI) in a manner such that Windows version 3.0
will not run successfully unless the file is restored from MS-DOS. The
file can be restored from MS-DOS by using a backup copy of the SYSTEM.INI
file or by restoring the SYSTEM.INI file with a text editor in MS-DOS.

<OL><P><LI>Start Visual Basic.

<P><LI>From the File menu, choose New Project.

<P><LI>From the File menu, choose Make .EXE program.

<P><LI>Choose the OK button to select Project1.EXE as the .EXE filename.

<P><LI>Exit Visual Basic.

<P><LI>Start Windows Notepad.

<P><LI>From the File menu, choose Open.

<P><LI>In the Filename text box, type C:\WINDOWS\SYSTEM.INI including the
   correct path for the SYSTEM.INI file on your computer.

<P><LI>Choose the OK button.

<P><LI>Change this line:
<P>
<P><PRE>       SHELL=PROGMAN.EXE
</PRE><P>
<P><PRE>    to this line:
</PRE><P>
<P><PRE>       SHELL=C:\VB\PROJECT1.EXE
</PRE><P>
<P><PRE>    Chane the path to the correct path to the file created in step 4.
</PRE>
<P><LI>From the File menu, choose Save.

<P><LI>Exit Notepad.

<P><LI>From the Windows Program Manager File menu, choose Exit. You should
<P><PRE>    return to MS-DOS.
</PRE>
<P><LI>At the MS-DOS command prompt, start Windows.
<P>
</OL>When you attempt to start Windows version 3.0, a UAE occurs. You will need
to reboot (restart) your computer and modify the SYSTEM.INI file using a
text editor in MS-DOS to reverse the change made in step 10.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00 286 386<BR>
KBCategory: kbenv kbprg kbprb<BR>
KBSubcategory: EnvtRun<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
