

<HTML>
<HEAD>
<TITLE>BUG: CommandButton Receives Keystroke from Open Dialog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181010">
<META NAME="KBModify" CONTENT="1998/02/13">
<META NAME="KBCreate" CONTENT="1998/02/12">
<META NAME="Keywords" CONTENT="vb5all vbce WinCE">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If a CommandButton has the focus and is used to open a MessageBox, InputBox, or form, when you use the ENTER key to close the MessageBox, InputBox, or form the Click event procedure of the CommandCutton executes.  CAUSE =====  The ENTER key strokes...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBWS,QBS0,QAGB,QAPN,QAO4,QAAW,QA01,QDL9,QBWO,QBWN,QAWF,QAKJ,QAY2,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: CommandButton Receives Keystroke from Open Dialog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181010</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Windows CE Toolkit for Visual Basic 5.0, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a CommandButton has the focus and is used to open a MessageBox,
InputBox, or form, when you use the ENTER key to close the MessageBox,
InputBox, or form the Click event procedure of the CommandCutton executes.
<P>
<P><h2>CAUSE</h2>
 
<P>
The ENTER key strokes returned from an open dialog or other form are
interpreted by a CommandButton as a Click event.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two workarounds for this problem.

<OL><P><LI>Close the open MessageBox, InputBox or form with a mouse (or stylus)
   action.

<P><LI>When a MessageBox or InputBox is called from a CommandButton, add code
   to set the focus to the next control in the CommandButton Click event
   procedure, such as:
<P>
<P><PRE>      Msgbox "All Done"
      Text1.SetFocus
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem occurs when using the ENTER key to close a Messagebox, an
InputBox, or another form:

<UL><LI>With a MessageBox, use the ENTER key to dismiss it.

<LI>With the InputBox function, the user can TAB to the desired button (OK,
   Yes, No, etc.) and select it with the ENTER key.

<LI>With another form that has a CLOSE button, the user can TAB to it and
   select it with the ENTER key.
<P>
</UL><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open a new Windows CE project in Visual Basic. Form1 is created by
   default.

<P><LI>Add a CommandButton and TextBox to Form1; they will be named Command1
   and Text1 by default.

<P><LI>Add the following code to Form1:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         MsgBox "Command1.Click"
      End Sub

      Private Sub Text1_Click()
         MsgBox "Text1.Click"
      End Sub

</PRE><P><LI>Press F5 to run the project.

<P><LI>Click on Command1. Use the ENTER key to close the MessageBox dialog and
   note that the Command1 Click event procedure runs again.

<P><LI>Close the MessageBox dialog using a mouse or stylus by clicking OK. Note
   that the CommandButton Click event procedure does not repeat.

<P><LI>Click on Text1. Use the ENTER key to close the MessageBox dialog and
   note that the TextBox Click event procedure does not repeat.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Books Online for Microsoft Windows CE Toolkit for Visual Basic 5.0
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wce vbce<BR>
Keywords          : vb5all vbce WinCE<BR>
Version           : WINDOWS:1.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbnofix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
