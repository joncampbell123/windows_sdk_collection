

<HTML>
<HEAD>
<TITLE>PRB: GetVersion API Returns 3.10 When in Windows 3.11 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113998">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/04/21">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The GetVersion Windows API function returns version 3.10 when in Windows version 3.11.  CAUSE =====  GetVersion still returns 3.10 while inside Windows for Workgroups version 3.11 because there were so many applications that were checking for the v...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAUD,QBS0,QDL9,QBWQ,QBWN,QAC1,QAY5,QATX,QDIT,QAH4,QALW,QAGQ,QATE,QANF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: GetVersion API Returns 3.10 When in Windows 3.11</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113998</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The GetVersion Windows API function returns version 3.10 when in Windows
version 3.11.
<P>
<P><h2>CAUSE</h2>
 
<P>
GetVersion still returns 3.10 while inside Windows for Workgroups version
3.11 because there were so many applications that were checking for the
version number and requiring that the application be run under version
3.10. Therefore, Microsoft decided to have the GetVersion function
continue to return version 3.10 in Windows version 3.11.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To look for Windows version 3.11 from within Windows, use the
GetFileVersionInfo Windows API function instead of GetVersion. This article
shows by example how to call GetFileVersionInfo from Visual Basic.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design to help developers who have developed
applications that required and checked for Windows version 3.10.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the general declarations section of Form1:
<P>
<PRE>   ' Enter the following Declare statement as one, single line:
   Declare Function GetFileVersionInfo% Lib "VER.DLL" (ByVal lpszFileName$,
      ByVal handle As Any, ByVal cbBuf&amp;, ByVal lpvData$)

</PRE><P><LI>Add the following code to the Form_Load event of Form1:
<P>
<PRE>   Sub Form_Load ()
      Dim pos As Integer
      Dim version As String * 255
      Dim ans As String
      version = Space$(255)
      ' Get the version info and fill the version string:
      ret% = GetFileVersionInfo("user.exe", 0&amp;, 254, version)
      ' Find the position in the string where the FileVersion stamp is:
      pos = InStr(1, version, "FileVersion")
      ' 12 is the length of "FileVersion" +1 for the null
      ' 4 is the length of string (3.11 in this case) to return
      ans = Mid$(version, pos + 12, 4)
      ' Display the answer:
      MsgBox ans
   End Sub

</PRE><P><LI>Run the application by pressing the F5 key.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubcategory: APrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
