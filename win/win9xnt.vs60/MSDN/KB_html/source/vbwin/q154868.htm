

<HTML>
<HEAD>
<TITLE>HOWTO: Block CTRL+ALT+DEL and ALT+TAB in Windows 95 in VB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154868">
<META NAME="KBModify" CONTENT="1997/10/16">
<META NAME="KBCreate" CONTENT="1996/08/15">
<META NAME="Keywords" CONTENT="APrgOther vb432 VB4WIN kbenv kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  It is possible to prevent the CTRL+ALT+DEL and ALT+TAB key combinations from bringing up the task list in Windows 95 by calling a function in the Win32 API. This article demonstrates this procedure.  NOTE: This is possible only in Windows 95.  MORE...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMN,QBS0,QDL9,QBWQ,QBWO,QBWN,QAFF,QAH4,QBVV,QAGB,QA4P,QAY2,QBXS,QBWS,QA5B V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Block CTRL+ALT+DEL and ALT+TAB in Windows 95 in VB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154868</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
SUMMARY
 
<P>
It is possible to prevent the CTRL+ALT+DEL and ALT+TAB key combinations
from bringing up the task list in Windows 95 by calling a function in the
Win32 API. This article demonstrates this procedure.
<P>
NOTE: This is possible only in Windows 95.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It may be necessary for a program to prevent users from pressing the
CTRL+ALT+DEL key combination to bring up the Close Program task list in
Windows 95 from where they can end a task or shut down the system.
<P>
This can be done using the SystemParametersInfo API. A sample program
demonstrating this is given below.
<P>
Note that disabling CTRL+ALT+DEL is not recommended because the Close
Program dialog was created to allow misbehaving applications to be
terminated. If a program "hangs" while CTRL+ALT+DEL is disabled, it may not
be possible to terminate it by any method other than a hardware reboot of
the machine, possibly resulting in loss of data. Also, this technique may
not work in future versions of Windows.
<P>
The technique involves tricking Windows 95 into thinking that a screen
saver is running. A side effect of this is that CTRL+ALT+DEL no longer has
any affect.
<P>
The Win32 SDK states:
<P>
<PRE>   "SPI_SCREENSAVERRUNNING Windows 95: Used internally; applications should
   not use this flag. Windows NT: Not supported."

</PRE><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new Visual Basic project. Form1 is created by default.

<P><LI>Add two Command buttons to Form1.

<P><LI>Put the following code into the General Declarations section of Form1:
<P>
<PRE>   Private Declare Function SystemParametersInfo Lib "user32" _
   Alias "SystemParametersInfoA" (ByVal uAction As Long, _
   ByVal uParam As Long, lpvParam As Any, _
   ByVal fuWinIni As Long) As Long

   Private Const SPI_SCREENSAVERRUNNING = 97

   Private Sub Command1_Click()
     Dim ret As Integer
     Dim pOld As Boolean
     ret = SystemParametersInfo(SPI_SCREENSAVERRUNNING, True, pOld, 0)
   End Sub

   Private Sub Form_Load()
     Command1.Caption = "Disabled"
     Command2.Caption = "Enabled"
   End Sub

   Private Sub Command2_Click()
     Dim ret As Integer
     Dim pOld As Boolean
     ret = SystemParametersInfo(SPI_SCREENSAVERRUNNING, False, pOld, 0)
   End Sub

   Private Sub Form_Unload(Cancel As Integer)
   '  re-enable Ctrl+Alt+Del and Alt+Tab before the program terminates
     Command2_Click
   End Sub

</PRE><P><LI>Run the project and click the Disable button to test. Click the
   Enable button to enable CTRL+ALT+DEL and ALT+TAB again.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
SystemParametersInfo is documented in the Win32 SDK available in the
MSDN/Visual Basic Starter Kit that can be installed from the CD-ROM version
of Visual Basic 4.0, Professional and Enterprise Editions. Install by
running SETUP.EXE in the MSDN directory on the CD-ROM. It is also available
in the MSDN Development Library that is available under subscription from
Microsoft.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: reboot<BR>
Keywords          : APrgOther vb432 VB4WIN kbenv kbhowto<BR>
Version           : 4.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
