

<HTML>
<HEAD>
<TITLE>BUG: Setting the Caption of a Tab Control Results in GP Fault </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138525">
<META NAME="KBModify" CONTENT="1995/11/17">
<META NAME="KBCreate" CONTENT="1995/10/23">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Setting the caption of the Tab control to the contents of a text box may generate a general protection (GP) fault if the text box is empty. The GP fault occurs in module User.exe and is usually at the address 000B:009B.  WORKAROUND  The GP fault do...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QBT6,QBV4,QAHP,QAMB,QA7O,QAOE,QAMN,QAB5,QAO4,QAH4,QBWO,QATX,QBS0,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Setting the Caption of a Tab Control Results in GP Fault</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138525</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Setting the caption of the Tab control to the contents of a text box may
generate a general protection (GP) fault if the text box is empty. The GP
fault occurs in module User.exe and is usually at the address 000B:009B.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The GP fault does not occur if the caption of the control is set directly
to an empty string. For example, modify the Change event code for the Text1
control in step 5 of the "Steps to Reproduce Problem" section of this
article to this:
<P>
<PRE>   If Text1.Text = "" Then
      Form1.SSTab1.Caption = ""
   Else
      Form1.SSTab1.Caption = Text1.Text
   End If

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This occurs only in 16-bit Windows because User.exe was updated in Windows
95 and Windows NT. The 32-bit version of the Sheridan tab control does not
exhibit this behavior.
<P>
The GP fault occurs only when the Caption property is set to the Text
property of a text box or the caption of another control, and that text box
or other control does not contain text. The GP fault does not occur if the
caption is set to an empty string directly.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic 4.0, 16-bit Edition. Form1 is created by default.

<P><LI>Place the Sheridan tab control onto Form1.

<P><LI>In the Load event for Form1, place the following line of code:
<P>
   Form2.Show

<P><LI>Add a new form to the project (on the Insert menu, click Form).

<P><LI>On Form2, place a text box. In the Change event for the text box, place
   the following code:
<P>
   Form1.SSTab1.Caption = Text1.Text

<P><LI>Run the project by pressing the F5 key. Click Form2, highlight the
   text inside of the text box (Text1), and press the DELETE key. On
   Windows for Workgroups this gives a GP fault in the User.exe module.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 buglist4.00 GPF vb4win vb416<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
