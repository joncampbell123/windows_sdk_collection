

<HTML>
<HEAD>
<TITLE>PRB: WinExec Error 0002h When Running SetupWiz Setup Program </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149266">
<META NAME="KBModify" CONTENT="1997/05/09">
<META NAME="KBCreate" CONTENT="1996/03/29">
<META NAME="Keywords" CONTENT="TlsSetWiz vb416 vb4win kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  After the initial Copying Initialization Files dialog box is displayed by a Setup Wizard-generated setup program, an error is raised stating:     Cannot start main setup program (winexec). Error code 0002H  The setup is not successful and fails aft...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBS0,QDI2,QA0B,QAH4,QAAP,QDIZ,QAB4,QAMA,QA5F,QBVV,QA9N,QA36,QDH6,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: WinExec Error 0002h When Running SetupWiz Setup Program</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149266</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After the initial Copying Initialization Files dialog box is displayed by a
Setup Wizard-generated setup program, an error is raised stating:
<P>
<PRE>   Cannot start main setup program (winexec). Error code 0002H

</PRE>The setup is not successful and fails after this dialog box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The corresponding error message for error code 0002H from WinExec is "File
not found." This error can be raised any time that one or more of the files
that the Setup1.exe program requires to begin operation are missing. This
can occur if one or more files are removed during step 7 of the Setup
Wizard. In addition, if the Swdepend.ini file that is used by the Setup
Wizard to determine what files are needed is missing any entries, then the
distribution media may not contain all necessary files.
<P>
The Setup Wizard checks for the existence of the Swdepend.ini file when it
starts. If the file does not exist it will be created by the Setup Wizard
from template file \vb\setupkit\kitfiles\Sw16tmpl.ini for 16 bit and
\vb\setupkit\kitfil32\Sw32tmpl.ini for 32 bit. The 16-bit Setup Wizard adds
entries to Swdepend.ini based on Sw16tmpl.ini, and the 32-bit version does
likewise using Sw32tmpl.ini. If either of the template files have been
corrupted or were installed incorrectly during the installation of Visual
Basic 4.0, then the Swdepend.ini file may be missing important entries.
<P>
The approximate sizes for correctly installed template files are listed
here:
<P>
<PRE>   Edition of Visual Basic 4.0      SW16TMPL.INI   SW32TMPL.INI
   ---------------------------      ------------   ------------
   Standard                         NA            4.0K
   Professional                     2.7K          4.0K
   Enterprise                       3.5K          5.0K

</PRE>If the Sw16tmpl.ini or Sw32tmpl.ini is smaller than this size, it may be
corrupted or may not have been installed correctly. To resolve this
problem, follow these steps:

<OL><P><LI>Copy over the incorrect file using the relevant and correct file from
   the vb\setupkit\kitfiles or vb\setupkit\kitfil32 directory of the Visual
   Basic 4.0 CD. It may be a good idea to back up the file before it is
   overwritten in case any changes have been made to it by installation
   programs for 3rd party OCXs or other components.

<P><LI>Edit \Windows\Swdepend.ini using a text editor such as Notepad. Locate
   any lines containing the entry 'CreatedSW=1' and delete them. This will
   force the Setup Wizard to re-create the entries in Swdepend.ini the next
   time it runs.

<P><LI>Run the Setup Wizard to create a correct copy of Swdepend.ini.
<P>
</OL>After these steps the Setup Wizard will be able to include all basic
necessary files when creating setup programs for Visual Basic 4.0
applications. Any changes made to the previous copy of the template files
can be added manually to the template file before creating Swdepend.ini or
added directly to the Swdepend.ini file. A description of the format of
Swdepend.ini may be found in the VB4 help file under Swdepend.ini syntax.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : TlsSetWiz vb416 vb4win kbprb<BR>
Version             : 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
