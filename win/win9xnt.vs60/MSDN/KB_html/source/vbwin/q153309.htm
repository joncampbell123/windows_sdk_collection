

<HTML>
<HEAD>
<TITLE>How to Retrieve the Registered User Under Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153309">
<META NAME="KBModify" CONTENT="1996/07/11">
<META NAME="KBCreate" CONTENT="1996/07/05">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The strings related to the registered user of a particular copy of Windows are stored in a string inside USER.EXE. They are displayed in the Help About box of File Manager or Explorer in Windows 95. This article provides a code sample showing how t...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDL9,QBWO,QBWN,QAGU,QA4Q,QAH4,QBWQ,QATX,QANF,QAOX,QBV8,QACJ,QAB9,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Retrieve the Registered User Under Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 11, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153309</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic for Windows, 16-bit only, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The strings related to the registered user of a particular copy of Windows
are stored in a string inside USER.EXE. They are displayed in the Help
About box of File Manager or Explorer in Windows 95. This article provides
a code sample showing how to extract this information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Place a command button on the form.

<P><LI>Add the following code to the form1 code window:
<P>
   Option Explicit
<P>
<PRE>   Private Declare Function GetModuleHandle Lib "Kernel" _
      (ByVal Module As String) As Integer
   Private Declare Function LoadString Lib "user" _
      (ByVal hInst As Integer, ByVal wID As Integer, _
      ByVal buf As Any, ByVal size As Integer) As Integer

   Sub Command1_Click()
    Dim ihInst As Integer
    Dim sUserName As String * 128
    Dim sOrganization As String * 128
    Dim sTitle As String
    Dim iLength As Integer
    ihInst = GetModuleHandle("user.exe")
    iLength = LoadString(ihInst, 514, sUserName, Len(sUserName))
    sUserName = Left$(sUserName, iLength)
    iLength = LoadString(ihInst, 515, sOrganization, Len(sOrganization))
    sOrganization = Left$(sOrganization, iLength)
    Print sUserName
    Print sOrganization
   End Sub

</PRE><P><LI>Press F5 to run the project. Click the command button. The information
   should be printed on the form.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
The API can also be used if you use Visual Basic 4.0 32-bit, as explained
in article <B><A href="../vbapps/q145679.htm">Q145679</A></B> by changing the RegisteredOrganization and
RegisteredOwner values in:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion

</PRE></OL><B><A href="../win3x/q88363.htm">Q88363</A></B> - Changing Name and Company After Windows Installation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb416<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory:
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 11, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
