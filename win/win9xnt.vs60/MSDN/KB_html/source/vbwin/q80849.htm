

<HTML>
<HEAD>
<TITLE>PRB: Grid Custom Control: Surprising Results when FillStyle=1 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80849 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/02/17">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When the Grid custom control has its FillStyle property set to 1 (repeat), assignments to the Text and Picture properties store a value in all the cells within the selected region (determined by SelStartCol, SelStartRow, SelEndCol, and SelEndRow). ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QA2Q,QATX,QAMB,QBXS,QAUD,QAH4,QBJZ,QAY2,QARR,QABO,QBWS,QAG2,QDNZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Grid Custom Control: Surprising Results when FillStyle=1</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80849 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  versions 2.0 and 3.0
</PRE>- Microsoft Professional Toolkit for Microsoft Visual Basic
<PRE>  Programming System for Windows, version 1.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the Grid custom control has its FillStyle property set to 1
(repeat), assignments to the Text and Picture properties store a value
in all the cells within the selected region (determined by
SelStartCol, SelStartRow, SelEndCol, and SelEndRow). However, the
value returned from Text and Picture comes from the current cell
(determined by the Col and Row properties).
<P>
This behavior can produce surprising results when the current cell
is located outside the selected region.
<P>
When FillStyle is 0 (single), the Text and Picture properties store to
the current cell and retrieve from the current cell.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To cause the Text property to return the same value assigned when
FillStyle=1, set the current cell location to a cell inside the
selected region. For example, use this code:
<P>
<PRE>   Grid1.Text = "hello"
   Grid1.Col = Grid1.SelColStart
   Grid1.Row = Grid1.SelRowStart
   ' Length of Text is 5
   MsgBox "Len(Text)=" + Format$(Len(Grid1.Text))

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The CellSelected property returns True (-1) if the current cell is
within the grid's selected region; otherwise, CellSelected returns
False (0).
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic, or if Visual Basic is already running, choose New
   Project from the File menu (ALT, F, N). Form1 is created by default.

<P><LI>From the File menu, choose Add File, and select GRID.VBX. The Grid
   tool will appear in the Toolbox.

<P><LI>Select the Grid tool from the Toolbox, and place a grid (Grid1)
   on Form1.

<P><LI>On the Properties bar (Properties window in Visual Basic version 2.0),
   set the grid properties Cols and Rows each to 4. In Visual Basic 2.0,
   you will need to press the F4 key to display the Properties Window,
   so you can set the Cols and Rows properties.

<P><LI>Size the grid so that you can see all the cells.

<P><LI>Double-click the form to bring up the Code window. In the Procedure
   box, select Load. Enter the following code:
<P>
<PRE>   Sub Form_Load ()
      Grid1.FillStyle = 1     ' Repeat.

      ' Set selected region.
      Grid1.SelStartCol = 2
      Grid1.SelStartRow = 2
      Grid1.SelEndCol = 3
      Grid1.SelEndRow = 3

      ' Set current cell, outside of selected region.
      Grid1.Col = 1
      Grid1.Row = 1

      ' Assign to Text.
      Grid1.Text = "hello"

      ' Length of Text is 0, not 5.
      Show
      MsgBox "Len(Text)=" + Format$(Len(Grid1.Text))
   End Sub

</PRE><P><LI>Press the F5 key to run the program.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
