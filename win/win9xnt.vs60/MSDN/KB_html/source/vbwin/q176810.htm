

<HTML>
<HEAD>
<TITLE>HOWTO: Manually Modify and Rebuild CAB Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176810">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1997/11/14">
<META NAME="Keywords" CONTENT="vb5all vb5howto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When using the Visual Basic 5.0 Application Setup Wizard to create an Internet Component Download Setup for your ActiveX control or ActiveX document, you may need to modify the CAB file created by the Setup Wizard.  This article describes how to mo...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIY,QAA1,QA3P,QAHV,QBS0,QDI2,QANE,QBWA,QATF,QAJG,QBCU,QAFI,QAY2,QAPN,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Manually Modify and Rebuild CAB Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176810</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using the Visual Basic 5.0 Application Setup Wizard to create an
Internet Component Download Setup for your ActiveX control or ActiveX
document, you may need to modify the CAB file created by the Setup
Wizard.
<P>
This article describes how to modify the CAB files that the Visual Basic
Setup Wizard creates and specifically shows how to extract the files from a
CAB file and how to rebuild the CAB file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For distributing ActiveX components, you may choose to build an Internet
Component Download Setup using the Visual Basic 5 Application Setup Wizard.
<P>
The wizard creates two key files: an HTM file (Hypertext Markup Language
File, also known as HTML file) and a CAB file (Cabinet file, a compressed
file). The HTM file contains the information necessary to extract and
install the information stored in the CAB file. The CAB file contains the
actual components of your OCX, EXE, or DLL.
<P>
When you open the HTM file with Internet Explorer (IE), IE executes the
&lt;OBJECT&gt; tag within the HTML code. In its simplest terms, an &lt;OBJECT&gt; tag
tells Internet Explorer how to install your ActiveX component onto the
client machine.
<P>
The following is an example of an &lt;OBJECT&gt; tag;
<P>
<PRE>   &lt;OBJECT ID="MyUserDocument"
   CLSID="CLSID:CB6994D4-2DCA-11D1-A9CB-00AA00B7B36F"
   CODEBASE="ActiveX.CAB#version=1,0,0,0"&gt;
   &lt;/OBJECT&gt;

</PRE>In the &lt;OBJECT&gt; tag above, Internet Explorer uses the ID and CLSID to see
if the specified control is already installed on the client computer. If it
is not already installed or if it out of date, IE uses the CODEBASE
argument to locate the ActiveX.CAB file to install the ActiveX control or
document.
<P>
<P><h3>The Contents of a .CAB File</h3>
 
<P>
A CAB file contains compressed files that are crucial for installing your
ActiveX components. The Setup Wizard places an uncompressed copy of each
file it placed into your cabinet file into a directory named "Support,"
which can be found in the same location as the CAB and HTM files.
<P>
In all cases, the Setup Wizard will place at least three files in the
Support folder: a .DDF file, an ActiveX component file (.EXE, .DLL or .OCX
file), and an .INF file.

<UL><LI>.DDF: The DDF file is known as a Diamond Directive File, a text file
   that may be opened in Notepad or any text editor. The DDF contains
   specific information required to compress your files into a cabinet
   file; the DDF file itself is not placed into the CAB file. NOTE: This
   file should not be modified unless absolutely necessary.

<LI>Component File (.EXE, .DLL or .OCX): The type of ActiveX component you
   create determines the file extension of the file included here. All
   ActiveX controls have a .OCX extension. Other ActiveX components
   either .EXEs or .DLLs. This file is your ActiveX component being
   installed.

<LI>.INF: This is the Information file that contains information about what
   other files your ActiveX component depends on (dependency files),
   where to get copies of those files, and how to install those files.
<P>
</UL><h3>Extracting the Contents of a CAB File</h3>
 
<P>
In order to extract what is in a cabinet file, you must use the Extract
utility. Extract.Exe can be found in your Windows folder or on your Windows
95 or Windows NT installation CD-ROM.
<P>
Extract.Exe is a command-line utility; therefore it is used from an MS-DOS
command prompt. To extract the files within a cabinet file, be sure the
Extract.Exe utility is in the MS-DOS Path or copy the Extract utility to
the same folder as the cabinet file.
<P>
From the MS-DOS command prompt, you can run the following command to
extract all of the files in a CAB file into the current directory:
<P>
<PRE>   Extract ActiveX.CAB *.*

</PRE>where "ActiveX.CAB" is the name of your cabinet file.
<P>
For more information on using the Extract.Exe utility, you may type the
following command at an MS-DOS command prompt:
<P>
<PRE>   Extract /?

</PRE>For even more information on Extract.Exe, please see the ActiveX SDK
documentation as referred to in the REFERENCES section of this article.
<P>
<P><h3>Rebuilding a CAB File</h3>
 
<P>
Once you've extracted the files within a CAB, you can make modifications
and then proceed to rebuild the CAB file manually.
<P>
To rebuild a CAB file, you must use the MakeCab.Exe utility that ships with
Visual Basic. The MakeCab utility is installed by default in the following
directory:
<P>
<PRE>   C:\Program Files\DevStudio\Vb\setupkit\kitfil32

</PRE>It may also be found on your Visual Basic 5.0 installation CD-ROM in the
following directory:
<P>
<PRE>   \VB\Setupkit\Kitfil32

</PRE>To rebuild the cabinet file, place any modified files and the original .DDF
file into a single folder. Also, make sure the MakeCab.Exe utility is in
the MS-DOS path or copy it to the same folder as the .DDF.
<P>
From a command prompt, type the following command:
<P>
<PRE>   MakeCab /F ActiveX.DDF

</PRE>where "ActiveX.DDF" is the name of your .DDF file.
<P>
For more information on the MakeCab utility ,you may use the "/?" switch or
see the ActiveX SDK documentation as referred to in the REFERENCES section
of this article.
<P>
<P><h3>Notes on Rebuilding Cabinet Files</h3>
 
<P>
Usually, it should not be necessary to modify the files within a cabinet
file. However, situations may arise where you need to do so. When modifying
cabinet files, please use the following guidelines to avoid problems:

<OL><P><LI>Never add or remove files from a CAB file. The only files that should be
   in a CAB file are those added by the Application Setup Wizard. If you
   need to add or remove files from the cabinet file, re-run the
   Application Setup Wizard. Otherwise, you will need to modify the .DDF
   file.

<P><LI>If you modify the INF file, be sure that your changes are syntactically
   correct and do not contain errors. For more information about modifying
   INF files, see the ActiveX SDK in the REFERENCES section of this
   article. Problems with the INF file may result in undesired behavior
   when the component attempts to download.

<P><LI>You should not modify the ActiveX component (.OCX, .EXE or .DLL) in any
   way. If you feel you need to modify the ActiveX component, rebuild the
   cabinet file using the Application Setup Wizard.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using the Extract.Exe, MakeCab.Exe, modifying
DDF files or modifying INF files, please see the documentation found in the
"ActiveX Software Development Kit (SDK)." The ActiveX SDK is available for
download from the following location;
<P>
<PRE>   <B><A href="http://www.microsoft.com/workshop/prog/sdk">http://www.microsoft.com/workshop/prog/sdk</A></B>
</PRE></OL> 
<PRE>Keywords          : vb5all vb5howto
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
