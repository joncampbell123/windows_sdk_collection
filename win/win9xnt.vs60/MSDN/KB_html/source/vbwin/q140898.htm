

<HTML>
<HEAD>
<TITLE>BUG: Application Error Occurs When Rebinding a Bound DBGrid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140898">
<META NAME="KBModify" CONTENT="1996/05/16">
<META NAME="KBCreate" CONTENT="1995/12/07">
<META NAME="Keywords" CONTENT="kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  An application error occurs when a Visual Basic 32-bit program with a DBGrid control bound to a Data control rebinds the Data control to a recordset containing at least 26 fields and 11 records.  STATUS ======  Microsoft has confirmed this to be a ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QBS0,QAB5,QA5V,QAOE,QAMN,QAH4,QBXS,QBWS,QBE7,QBE6,QAZV,QAVX,QAVW,QANF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Application Error Occurs When Rebinding a Bound DBGrid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140898</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic
   32-bit only, for Windows, version 4.0
<LI>Microsoft Windows NT, version 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An application error occurs when a Visual Basic 32-bit program with a
DBGrid control bound to a Data control rebinds the Data control to a
recordset containing at least 26 fields and 11 records.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. Microsoft is researching this problem and
will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code example provides steps to reproduce this behavior. In this
example, create a form containing a command button, data control, and a
DBGrid control. Set the DataSource property of the DBGrid control to the
data control. After copying the code to the Form1 code window, run the
program and click any row in the DBGrid control except the first row. Click
the Command1 button to swap the recordsets. An application error occurs.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start the 32-bit version of Visual Basic 4.0, or if it is already
   running, click New Project on the File menu.

<P><LI>Add a command button, data control, and a DBGrid control on the Form1
   form.

<P><LI>Use the following steps to set the DataSource property of the DBGrid
   control to Data1.
<P>
   a. Click the DBGrid control on the Form1 form.
<P>
   b. In the Properties Window, click the DataSource property.
<P>
   c. In the DataSource Property, click the down arrow. The Data1 option
<P><PRE>      appears. Click this option.
</PRE>
<P><LI>Copy the following code sample to the Form1 code window:
<P>
<P><PRE>      Dim rs1 As Recordset
      Dim rs2 As Recordset
      Dim db As Database
      Dim td As TableDef
      Dim fl As Field
</PRE><P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         Set Data1.Recordset = rs2
         Set Data1.Recordset = rs1
      End Sub

      Private Sub Form_Load()
      Dim x As Integer, y As Integer

      'If the database does not exist, create the database
      If Dir("C:\TEST.MDB") = "" Then
         Set db = CreateDatabase("C:\test.mdb", dbLangGeneral)

         'Create the table in the database
         Set td = db.CreateTableDef("TABLE1")

         'Create the fields in the database
         For x = 1 To 26
            Set fl = td.CreateField("Field " &amp; CStr(x), dbInteger)
            td.Fields.Append fl
         Next x
         db.TableDefs.Append td

         'Add records to the database through a recordset
         Set rs1 = db.OpenRecordset("TABLE1", dbOpenTable)
         For y = 1 To 11      'For each row
            rs1.AddNew        'Add a new record

            For x = 1 To 26   'For each cell in the record
               rs1("Field " &amp; CStr(x)) = x   'Add a number
            Next x

            rs1.Update
         Next y

         'Close both the recordset and database
         rs1.Close
         db.Close
      End If

      'Open the database and create the recordsets
      Set db = OpenDatabase("C:\TEST.MDB")
      Set rs1 = db.OpenRecordset("Select * From TABLE1")
      Set rs2 = db.OpenRecordset("Select * From TABLE1")
      Set Data1.Recordset = rs1

      End Sub

</PRE><P><LI>Press the F5 key or click Start on the Run menu to run the program.

<P><LI>Click on any row on the DBGrid control except the first row.

<P><LI>Click on the Command1 button to swap the recordsets. An application
   error occurs and Visual Basic ends.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432 buglist4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
