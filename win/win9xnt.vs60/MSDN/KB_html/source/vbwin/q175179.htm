

<HTML>
<HEAD>
<TITLE>FILE: VBFTP.EXE: Implementing FTP Using WinInet API from VB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175179">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1997/10/15">
<META NAME="Keywords" CONTENT="VB4WIN vb5all kbsample">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  VBFTP.EXE is a sample that implements FTP connection, download, and upload using the WinInet FTP API from Visual Basic. It demonstrates the APIs and techniques to set FTP connection attributes and transfer mode that are not exposed inthe MS Interne...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW9,QBS0,QAB5,QDKF,QAY2,QAH6,QDIT,QAQW,QBVW,QA7O,QAOE,QAMN,QAI5,QASP,QAPP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: VBFTP.EXE: Implementing FTP Using WinInet API from VB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175179</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
VBFTP.EXE is a sample that implements FTP connection, download, and upload
using the WinInet FTP API from Visual Basic. It demonstrates the APIs and
techniques to set FTP connection attributes and transfer mode that are not
exposed inthe MS Internet Transfer Control.
<P>
The sample requires Visual Basic SP2 or Visual Studio SP2 installed to run
because it uses the updated comctl32.ocx from those Service Packs.
<P>
When adding FTP functionality to your application, it is important to
understand the capability and limitation of each of the different Internet
technologies. At the lowest level, you could use the Microsoft Winsock
Control to send commands directly to FTP server port 21. The sequence and
syntax of the commands you send to the server would have to follow the
specification of the FTP protocol. The WinInet FTP API wraps the socket
code and most low-level FTP commands and provides a set of much simpler
task-oriented APIs that do not require detailed knowledge of FTP protocol.
However, there is a chance that some FTP servers use FTP commands not
implemented by WinInet. If this happens, you have to use the Microsoft
Winsock Control to communicate with the server directly at the protocol
level. Test your FTP server with the VBFTPJR sample before you decide
whether to choose WinInet API or the Winsock Control. The Microsoft
Internet Transfer Control, on the other hand, offers a more simplified
interface than WinInet but offers less flexibility and cannot be used if
you want to customize the connection and transfer mode.
<P>
If you are using a proxy to access an FTP server, the proxy has to be
capable of handling FTP commands and cannot be a CERN proxy. Please see the
following article in the Microsoft Knowledge Base for more information:
<P>
<PRE>   ARTICLE-ID: <B><A href="../axsdk/q166961.htm">Q166961</A></B>
   TITLE     : HOWTO: FTP with CERN-Based Proxy Using WinInet API

</PRE>The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/vbftp.exe">vbftp.exe</A> <I>(size: 47597 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services
</PRE> 
<PRE>Keywords          : VB4WIN vb5all kbsample
Technology        : kbInetDev
Version           : WINDOWS:4.0,5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
