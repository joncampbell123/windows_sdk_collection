

<HTML>
<HEAD>
<TITLE>PRB: Jet Text IISAM Truncates Trailing Spaces </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182355">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1998/03/11">
<META NAME="Keywords" CONTENT="vb5all VBKBVBA">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When importing delimited data from a text file into a Jet database, trailing spaces are dropped from fields.  CAUSE =====  The Text IISAM driver truncates trailing spaces regardless of whether the field is surrounded by quotes.  RESOLUTION   - Writ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA1S,QBRZ,QAH4,QA5F,QATX,QAPN,QAMB,QAMA,QDN9,QAVX,QAVW,QDKY,QBVV,QA6A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Jet Text IISAM Truncates Trailing Spaces</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182355</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Microsoft Visual Basic for Applications, version 5.0
<LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When importing delimited data from a text file into a Jet database,
trailing spaces are dropped from fields.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Text IISAM driver truncates trailing spaces regardless of whether the
field is surrounded by quotes.
<P>
<P><h2>RESOLUTION</h2>
 

<UL><LI>Write a custom import routine using low-level file I/O and DAO, and
   parse the line into fields using BASIC.
<P>
   -or-

<LI>When creating the text file, use a substitute character for trailing
   spaces you do not want truncated and then use a SQL statement to "fix"
   the imported data.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: Your use or modification of the CODE provided in this article is
at your own risk. Microsoft provides this CODE "as is" without warranty of
any kind, either expressed or implied, including but not limited to the
implied warranties of merchantability and/or fitness for a particular
purpose. Microsoft does not support modifications of the CODE to suit
specific customer requirements.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Using Notepad, create a text file with the following data:
<P>
<P><PRE>      ID,Desc,Field3
      Line1,Description 1  ,Field3-1
      Line2,"Description 2  ",Field3-2
</PRE>
<P><LI>Save the file as c:\test.txt.

<P><LI>In Visual Basic, create a new project and add a reference for Microsoft
   DAO 3.5 Object Library. In Access, open the Northwind.MDB database.

<P><LI>Create a new form with a CommandButton (Command1) and the following
   code:
<P>
<P><PRE>      Private Sub Command1_Click ()
      Dim db As Database
<PRE></PRE>        Set db = CurrentDB                               ' Access only
        Set db = DBEngine(0).OpenDatabase("biblio.mdb")  ' Visual Basic
        db.Execute "SELECT * INTO TestImport FROM [test#txt] IN '' " _
                   "'text;database=c:\;FMT=Delimited;HDR=Yes'"
        db.Close
      End Sub

</PRE><P><LI>Run the project/form and click the CommandButton to import the data.

<P><LI>Examine the contents of the TestImport table, and note that the Desc
   column has the trailing spaces truncated for both records.
<P>
</OL>Notes:

<OL><P><LI>The symptoms are also present when using Access' File|Get External Data
   menu command and via the TransferText macro action and the TransferText
   method of the DoCmd object, all of which use the Text IISAM driver.

<P><LI>The symptoms probably also apply to previous versions of Jet but have
   not been tested with them.

<P><LI>In Visual Basic, you can use the VISDATA sample project to examine the
   contents of the table.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual Basic and Access help topic: IN CLAUSE
<P>
(c) Microsoft Corporation 1998, All Rights Reserved.
Contributions by Malcolm Stewart, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: delimited csv<BR>
Keywords          : vb5all VBKBVBA<BR>
Version           : WINDOWS:5.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
