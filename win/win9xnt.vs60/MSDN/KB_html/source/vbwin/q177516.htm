

<HTML>
<HEAD>
<TITLE>PRB: ODBCDirect Query Causes Error 3667 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177516">
<META NAME="KBModify" CONTENT="1997/12/03">
<META NAME="KBCreate" CONTENT="1997/12/02">
<META NAME="Keywords" CONTENT="vb5all VBKBDAO VBKBDB VBKBODBC VBKBDAODatabase kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Running a query or manipulating a recordset in an ODBCDirect workspace causes the following error to occur:      A different operation is preventing this operation from being executed,     runtime error 3667.   CAUSE =====  This error can be caused...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAI5,QBG2,QAH4,QAY5,QAW6,QAJQ,QBS0,QBWS,QAAP,QAB4,QACI,QBXS,QAO4,QANF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ODBCDirect Query Causes Error 3667</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177516</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Running a query or manipulating a recordset in an ODBCDirect workspace
causes the following error to occur:
<P>
<PRE>   "A different operation is preventing this operation from being executed,
    runtime error 3667."

</PRE><h2>CAUSE</h2>
 
<P>
This error can be caused by trying to run more than one asynchronous
operation at a time on the same connection object or performing other Data
Access Object (DAO) operations (such as recordset manipulation) on the same
connection object while an asynchronous query runs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To run multiple asynchronous queries on the same connection object, you
must first test the value of the StillExecuting property to determine
whether you can start the next asynchronous operation. To run multiple
asynchronous queries in parallel, you must create separate connection
objects and run each asynchronous query on its own connection object.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce the Behavior</h3>
 

<OL><P><LI>Create a Visual Basic standard .exe file. By default this places a Form
   in the project. Under Project References select "Microsoft DAO 3.5
   Object Library."

<P><LI>In the General Declarations section of the Form1, place the following
   code:
<P>
<P><PRE>      Dim wks As Workspace
      Dim cn As Connection
      Dim recset As Recordset
      Dim SQLStuff As String
</PRE>
<P><LI>In the Form_Load event place the following code. This code assumes that
   you have a DSN that connects to the sample pubs database in SQL Server.
<P>
<P><PRE>      SQLStuff = "ODBC;DSN=PubsDSN;UID=sa;PWD="
      Set wks = CreateWorkspace("", "admin", "", dbUseODBC)
      Set cn = wks.OpenConnection("", dbDriverNoPrompt, False, SQLStuff)
</PRE>
<P><LI>Place a command button on the form by adding the following code to the
   Command1_Click event:
<P>
<P><PRE>      SQLStuff = "UPDATE employee SET job_lvl = job_lvl + job_lvl * .1"
      cn.Execute SQLStuff, dbRunAsync
      Set recset = cn.OpenRecordset("SELECT * FROM authors", dbOpenDynamic,
<PRE></PRE>         dbRunAsync, dbOptimisticValue)

</PRE></OL>Note that the connection execute method is still using the connection when
the openrecordset method is used. This is what causes the error to occur.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information query on stillexecuting in the help file or in "Books
On Line."
<P>
 
<PRE>Keywords          : vb5all VBKBDAO VBKBDB VBKBODBC VBKBDAODatabase kberrmsg
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
