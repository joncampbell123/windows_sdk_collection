

<HTML>
<HEAD>
<TITLE>FIX: Disk or Network Error with Data Access Objects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114771">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1994/05/11">
<META NAME="Keywords" CONTENT="APrgDataAcc kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Error 3043 (Disk or network error) can result when you run multiple instances of one Visual Basic program or you run multiple programs, and all instances or programs perform data access on the same database.  If the program does not explicitly clos...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAH4,QAAP,QBWS,QAB4,QAZV,QBW7,QAI5,QBXS,QAW6,QAR4,QAPF,QAGB,QA1S V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Disk or Network Error with Data Access Objects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114771</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Professional Edition of Microsoft Visual Basic for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Error 3043 (Disk or network error) can result when you run multiple
instances of one Visual Basic program or you run multiple programs, and all
instances or programs perform data access on the same database.
<P>
If the program does not explicitly close all the data access objects (by
using db.close, for example), then the error will occur when the second
instance of the program tries to work with a data access object.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Close all data access objects (tables, dynasets, snapshots, and databases)
explicitly. For example, if your program has any of the following
statements
<P>
<PRE>   Dim db As database
   Dim ds As dynaset
   Dim sn As snapshot
   Dim tb As table
   Set db = OpenDatabase("&lt;some database file&gt;")
   Set ds = db.CreateDynaset("&lt;some query&gt;")
   Set sn = db.CreateSnapshot("&lt;some query&gt;")
   Set tb = db.OpenTable("&lt;some table name&gt;")

</PRE>execute the following close statements before the program ends:
<P>
<PRE>   tb.close
   ds.close
   sn.close
   db.close

</PRE>NOTE: If you place the .Close methods in the Unload or QueryUnload events,
make sure you invoke these events before your program ends by using the
Unload statement (for example, Unload Me). Be careful when using the End
statement; it does not invoke the Unload or QueryUnload events.
<P>
<P><h2>STATUS</h2>
 
<P>
This bug was corrected in Microsoft Visual Basic version 4.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic and open the VISDATA.MAK project located in the
   \VB\SAMPLES\VISDATA directory (ALT, F, O).

<P><LI>From the File menu, choose Make EXE File to create an executable.

<P><LI>Exit Visual Basic, and run File Manager.

<P><LI>Change directories to the \VB\SAMPLES\VISDATA directory and double-click
   VISDATA.EXE to run the program. Repeat this step so that two instances
   of VISDATA are running.

<P><LI>In both instances of VISDATA, open the BIBILIO.MDB database located in
   your Visual Basic directory \VB.

<P><LI>Close one instance of VISDATA.EXE.

<P><LI>Start another instance of VISDATA.EXE and try to open the BIBLIO.MDB
   database again. You will get Error 3043 - "Disk or Network Error."
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 fixlist3.00 3.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgDataAcc<BR>
Keywords          : APrgDataAcc kbbuglist kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
