

<HTML>
<HEAD>
<TITLE>PRB: Error When Updating Fields in Dynaset That Has 2+ Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102681">
<META NAME="KBModify" CONTENT="1996/08/08">
<META NAME="KBCreate" CONTENT="1993/08/08">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When trying to edit or update fields in a dynaset that was created by a SQL select statement that joined two or more tables, the following errors may occur. In these messages, 'item' is a field in a table to be changed.     Can't perform operation;...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAN0,QBS0,QAAP,QAMB,QAB4,QA5V,QA28,QATJ,QAXB,QAH4,QA7O,QA7N,QABM,QBMW,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error When Updating Fields in Dynaset That Has 2+ Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 8, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102681</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0, using the DAO 2.0/2.5
   Compatibility Library
<LI>Professional Edition of Microsoft Visual Basic for Windows, version 3.0
</UL> 
<P>
SYMPTOMS
 
<P>
When trying to edit or update fields in a dynaset that was created by a SQL
select statement that joined two or more tables, the following errors may
occur. In these messages, 'item' is a field in a table to be changed.
<P>
<PRE>   Can't perform operation; it is illegal. (3219)
   Can't update 'item'; field not updatable. (3113)

</PRE>CAUSE
 
<P>
These errors occur if the Microsoft Access engine cannot ensure that
referential integrity of the table entries will be maintained as a result
of the operation.
<P>
MORE INFORMATION
 
<P>
For a multiple table dynaset to be updatable, the following must be true:

<UL><LI>The dynaset needs to have been created with a SQL "join" clause between
   tables that have a one-to-many relationship.
<LI>There must be a unique index (or primary key) on the one-side of the
   query.
<P>
</UL>Reproducing the Behavior
 
<P>
These examples use the BIBLIO.MDB database that shipped as a sample
database with Visual Basic version 3.0 for Windows. This code will only
work on a database that doesn't have referential integrity enabled, such as
the BIBLIO.MDB from Visual Basic 3.0. In BIBLIO.MDB, the Authors table has
a unique (primary) index set on AU_ID, and [Title author] has an index
set on AU_ID but it is not unique or primary. The following code causes the
errors:
<P>
<PRE>   Dim db As database
   Dim ds As dynaset
   ' The following SQL$ code is correct. It will not generate an error.
   ' Enter it as one, single line:
   ' SQL$ = "Select * from AUTHORS,TITLES, Titles INNER JOIN
   '    authors on Titles.AU_ID = Authors.AU_ID"
   ' The following line will cause the error, but it won't be generated
   ' until the last line of the same code -- which is expected:
   SQL$ = "Select * from AUTHORS,TITLES where Titles.AU_ID = Authors.AU_ID"
   Set db = OpenDatabase("C:\vb3\biblio.mdb")
   Set ds = db.CreateDynaset(SQL$)
   ds.Edit

</PRE>This is a classic example of a SQL inner join statement. It chooses all
fields from both tables where the book titles match up with the author who
wrote them. The unique index is the ID number of the author. This means one
author can have many titles but books by a single author will have only one
author in the Authors table.
<P>
If this query did not have a one-to-many relationship, the error, "Can't
perform operation; it is illegal" (3219) would occur on the line "ds.Edit."
The error is telling you that either there is not a unique index in the
multiple-table dynaset, or there is no unambiguous one-side of the one to
many relationship to the query. Checking the updatable property of the
dynaset before invoking edit mode avoids the error from attempting to edit
a non-updatable dynaset.
<P>
After the query is successfully created and the copy buffer is opened by
issuing the Edit statement, you can proceed with updating records.
<P>
<PRE>   ds.Fields("Title") = "Some new book title"
   ds.Update

</PRE>This works because "Title" is on the non-unique or many-side of the initial
query. All the records in the Titles table are editable whereas none of the
records in Authors table are editable. The error "Can't update 'item';
field not updatable." (3113) occurs with an attempt to edit any item in the
Authors table.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 4.00 Jet 2.0 2.5 vb416<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: APrgDataAcc
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 8, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
