

<HTML>
<HEAD>
<TITLE>HOWTO: Programmatically Register and UnRegister .OCX Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173091">
<META NAME="KBModify" CONTENT="1997/08/26">
<META NAME="KBCreate" CONTENT="1997/08/25">
<META NAME="Keywords" CONTENT="vb5all kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how to programmatically register and unregister ActiveX controls (.OCXs).  Microsoft Visual Basic ships with several ActiveX controls (.OCX files). These files are automatically registered by the Visual Basic setup program du...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QA7O,QAOE,QAMN,QAH4,QDL9,QBWO,QBWN,QAHV,QAUD,QAY5,QAFF,QAMA,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Programmatically Register and UnRegister .OCX Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173091</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to programmatically register and unregister
ActiveX controls (.OCXs).
<P>
Microsoft Visual Basic ships with several ActiveX controls (.OCX files).
These files are automatically registered by the Visual Basic setup program
during installation. Developers often desire to register or unregister
these and/or their own controls at will. This can be accomplished by using
a tool such as RegSvr32.EXE or it can be done programmatically through
Visual Basic code.
<P>
The ActiveX control framework supports the DllRegisterServer and
DllUnregisterServer entry points. These entry points can be declared as
functions in your Visual Basic code and then called to register and
unregister the ActiveX control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to write a code module that can be
used to register and unregister an ActiveX control, specifically the
Microsoft Windows Common Controls found in ComCtl32.OCX.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a new Standard Exe project in Visual Basic.

<P><LI>Add a Module (Module1) to the project.

<P><LI>Add the following code to the General Declarations section of Module1:
<P>
<P><PRE>      Public Declare Function RegComCtl32 Lib "ComCtl32.OCX" _
<PRE></PRE>         Alias "DllRegisterServer" () As Long

      Public Declare Function UnRegComCtl32 Lib "ComCtl32.OCX" _
         Alias "DllUnregisterServer" () As Long

      Public Const S_OK = &amp;H0

      Sub RegisterComCtl32()
         On Error GoTo Err_Registration_Failed
         If RegComCtl32 = S_OK Then
            MsgBox "Registered Successfully"
         Else
            MsgBox "Not Registered"
         End If
      Exit Sub
      Err_Registration_Failed:
         MsgBox "Error: " &amp; Err.Number &amp; " " &amp; Err.Description
      End Sub

      Sub UnRegisterComCtl32()
         On Error GoTo Err_Unregistration_Failed
         If UnRegComCtl32 = S_OK Then
            MsgBox "Unregistered Successfully"
         Else
            MsgBox "Not Unregistered"
         End If
      Exit Sub
      Err_Unregistration_Failed:
         MsgBox "Error: " &amp; Err.Number &amp; " " &amp; Err.Description
      End Sub

</PRE><P><LI>View the Immediate Window (CTRL+G) and type:
<P>
<P><PRE>      UnRegisterComCtl32
</PRE><P>
   Press the ENTER key to unregister ComCtl32.OCX, and then type:
<P>
<P><PRE>      RegisterComCtl32
</PRE><P>
   and press the ENTER key to register the control.
<P>
</OL>These functions can now be called to register and unregister the ActiveX
control, programmatically providing functionality similar to that of
RegSvr32.EXE. You can test these functions by right-clicking on the ToolBox
and selecting Components from the pop-up menu. An entry for the Microsoft
Windows Common Controls 5.0 will be displayed on the Controls tab of the
Components dialog if ComCtl32.OCX is registered and no entry will be
displayed if ComCtl32.OCX is not registered.
<P>
Please note the following:

<UL><LI>"RegComCtl32" and "UnRegComCtl32" are user-defined names and may be
   changed to suit your needs.

<LI>The Step-by-Step Example above assumes that ComCtl32.OCX is located in
   the Windows\System folder of the local hard drive. If it is not located
   there, you must specify the complete path to the .OCX file in the
   Declare statement.

<LI>"DllRegisterServer" and "DllUnregisterServer" are case-sensitive. It is
   important that the correct case be used when declaring these functions.
</UL> 
<PRE>Keywords          : vb5all kbhowto
Version           : WINDOWS:5.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
