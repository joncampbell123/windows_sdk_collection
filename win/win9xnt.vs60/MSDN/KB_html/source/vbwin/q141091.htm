

<HTML>
<HEAD>
<TITLE>BUG: SSCommand Control Generates Application Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141091">
<META NAME="KBModify" CONTENT="1995/12/15">
<META NAME="KBCreate" CONTENT="1995/12/11">
<META NAME="Keywords" CONTENT="kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  An application error or general protection (GP) fault ending the Visual Basic design environment occurs when the Picture property of a SSCommand (3D command button) control is set to the default property of a PictureBox control located on another f...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QA7O,QAMN,QAOE,QAPN,QAH4,QBWS,QBJZ,QAYS,QAB4,QBWO,QAJ6,QAHV,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SSCommand Control Generates Application Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141091</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional and Enterprise Editions of Microsoft
   Visual Basic for Windows, 16-bit and 32-bit, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An application error or general protection (GP) fault ending the Visual
Basic design environment occurs when the Picture property of a SSCommand
(3D command button) control is set to the default property of a PictureBox
control located on another form, and the running application is stopped
using only the End button on the Toolbar.
<P>
The bug occurs if you have a Visual Basic application containing one form
with a SSCommand control and another form with a PictureBox control. The
Picture property of the SSCommand control is set to the default property of
the PictureBox control. The PictureBox control's default property is its
Picture property.
<P>
When you run the application in the Visual Basic design environment and you
click the End button on the Toolbar to stop the application, an error
message displays and Visual Basic ends. Note that the Close button on the
form with the SSCommand control is not clicked.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The workaround is to set the Picture property of the SSCommand control by
explicitly specifying the Picture property of the PictureBox control. Do
NOT use the default property of the PictureBox control to set the Picture
property of the SSCommand control. An example of this is shown below in the
code in the More Information section.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. Microsoft is researching this problem and
will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following shows you how to reproduce the bug:
<P>
<P><h3>Steps to Reproduce Bug</h3>
 

<OL><P><LI>Start Visual Basic 4.0, or if it is already running, click New Project
   on the File menu.

<P><LI>Click Custom Controls on the Tools menu. Click the Sheridan 3D Controls
   check box in the Custom Controls dialog box. Click OK to close the
   dialog box.

<P><LI>Add a SSCommand control to the Form1 form.

<P><LI>Add the following code to the Form1 code window:
<P>
<PRE>   Private Sub SSCommand1_Click()

      'Set the SSCommand button's Picture property to the PictureBox
      'control's default property as below:
      SSCommand1.Picture = Form2.Picture1

      'The workaround is to explicitly specify the PictureBox control's
      'Picture property. Use the following code instead:
      'SSCommand1.Picture = Form2.Picture1.Picture

   End Sub

</PRE><P><LI>Add a second form to your project by clicking Form in the Insert menu.

<P><LI>Add a PictureBox control to Form2 form.

<P><LI>Set the PictureBox control's Picture property to any bitmap or icon file
   stored on your computer as follows:
<P>
   a. In the PictureBox control's Properties Window, click the button with
<P><PRE>      an ellipsis (...) to display the Load Picture dialog box.
</PRE><P>
   b. Double-click any listed bitmap (.bmp) or icon (.ico) file.

<P><LI>Press the F5 key or click Start on the Run menu to start the Visual
   Basic program. Click the Command1 button. The caption changes to bitmap
   graphic you selected. Click the End button in the toolbar to stop the
   project. An application error occurs with one of the following messages
   displayed and Visual Basic ends:
<P>
   Windows NT 3.51:
<P>
<P><PRE>      32-bit: An application error has occurred and an application error
<PRE></PRE>              log is being generated. VB32.Exe Exception: access violation
              (oxc0000005), Address: 0x0046e951.

      16-bit: VB caused a General Protection Fault in module VB.Exe at
              0023:39FF.

   Windows 95:

      32-bit: VB32 caused an invalid page fault in module VB32.Exe at
              0137:0046e951.
      16-bit: VB caused a general protection fault in module VB.Exe at
              0023:000039ff.

   Windows (and Windows for Workgroups) 3.11:

      VB caused a General Protection Fault in module VB.Exe at 0023:39FF.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.0 vb4win vb4all GPF buglist4.00<BR>
KBCategory: kbbuglist kbprg<BR>
KBSubcategory: PrgCtrls<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
