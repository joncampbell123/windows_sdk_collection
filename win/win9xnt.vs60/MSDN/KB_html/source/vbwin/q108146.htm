

<HTML>
<HEAD>
<TITLE>How to Create a Microsoft Access Database using VB Prof 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108146">
<META NAME="KBModify" CONTENT="1995/07/20">
<META NAME="KBCreate" CONTENT="1993/12/07">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Below is an example showing how to use the CreateDatabase function and data definition language (DDL) statements to create an empty Microsoft Access database. This example defines the structure of the Microsoft Access database, and doesn't add any ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA1S,QDKY,QATJ,QA7O,QA7N,QA28,QANF,QAH4,QAGU,QAPF,QAPN,QACJ,QBWS,QBW7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a Microsoft Access Database using VB Prof 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108146</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Below is an example showing how to use the CreateDatabase function and data
definition language (DDL) statements to create an empty Microsoft Access
database. This example defines the structure of the Microsoft Access
database, and doesn't add any data.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Double-click the form to open its code window. Add the following code
   to the Form Load event:
<P>
<PRE>   Sub Form_Load ()

      Const DB_LANG_GENERAL = ";LANGID=0x0809;CP=1252;COUNTRY=0"
      Dim db As Database
      Dim tdEmployee As New TableDef
      Dim tdStore As New TableDef

      Dim fEmp_ID As New Field
      Dim fEmp_FirstName As New Field
      Dim fEmp_LastName As New Field
      Dim fEmp_Address As New Field

      Dim fStore_ID As New Field
      Dim fStore_Location As New Field

      Dim indxEmployee As New Index
      Dim indxStore As New Index

      Set db = CreateDatabase("COMPANY.MDB", DB_LANG_GENERAL)

      tdEmployee.Name = "Employee"
      tdStore.Name = "Store"

      'Define all Employee fields
      fEmp_ID.Name = "Emp_ID"
      fEmp_ID.Type = 4                  'Long integer

      fEmp_FirstName.Name = "Emp_FirstName"
      fEmp_FirstName.Type = 10          'Text (32)
      fEmp_FirstName.Size = 32

      fEmp_LastName.Name = "Emp_LastName"
      fEmp_LastName.Type = 10           'Text (32)
      fEmp_LastName.Size = 32

      fEmp_Address.Name = "Address"
      fEmp_Address.Type = 10            'Text (256)
      fEmp_Address.Size = 255

      'Define all Store fields
      fStore_ID.Name = "Store_ID"
      fStore_ID.Type = 4                'Long integer

      fStore_Location.Name = "Store_Location"
      fStore_Location.Type = 10   'Text (256)
      fStore_Location.Size = 255

      'Add employee fields to Fields collection
      tdEmployee.Fields.Append fEmp_ID
      tdEmployee.Fields.Append fEmp_FirstName
      tdEmployee.Fields.Append fEmp_LastName
      tdEmployee.Fields.Append fEmp_Address

      'Add store fields to Fields collection
      tdStore.Fields.Append fStore_ID
      tdStore.Fields.Append fStore_Location

      'Define employee table index
      indxEmployee.Name = "INDEX_EMPLOYEE"
      indxEmployee.Fields = "Emp_ID"
      indxEmployee.Unique = True
      indxEmployee.Primary = True

      'Define store table index
      indxStore.Name = "INDEX_STORE"
      indxStore.Fields = "Store_ID"
      indxStore.Unique = True
      indxStore.Primary = True

      'Append the employee and store indexes
      'to the respective Indexes collection
      tdEmployee.Indexes.Append indxEmployee
      tdStore.Indexes.Append indxStore

      'Append employee and store TableDefs
      'to TableDefs collection
      db.TableDefs.Append tdEmployee
      db.TableDefs.Append tdStore

   End Sub

</PRE><P><LI>Start the program or press the F5 key. This creates a Microsoft Access
   database called COMPANY.MDB. End the program by closing the form.

<P><LI>You can check that COMPANY.MDB was created correctly by opening it with
   Microsoft Access or with the Data Manager provided with Visual Basic.
   You can run the Data Manager program from the Window menu in Visual
   Basic, or from the Windows File Manager run DATAMGR.EXE in the Visual
   Basic directory.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
The VISDATA.MAK file installed in the VB3\SAMPLES\VISDATA directory
loads extensive examples of data access. The VISDATA sample program uses
every data access function in Visual Basic. You can refer to the VISDATA
source code for examples of how to use each data access function.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgDataOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 20, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
