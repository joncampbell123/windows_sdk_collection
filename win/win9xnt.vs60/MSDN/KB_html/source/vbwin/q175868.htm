

<HTML>
<HEAD>
<TITLE>BUG: T-SQL Debugger Does Not Run on NT with User Account </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175868">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1997/10/28">
<META NAME="Keywords" CONTENT="vb5all kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  T-SQL Debugger causes the following error when a stored procedure is called if the Visual Basic 5.0 application is being run on an NT 4.0 machine where the login was to a User Account:      You must have Privledges to modify the registry   NOTE: Th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QABI,QBWP,QBWS,QABH,QAH4,QAA1,QA5F,QAMA,QAGU,QBG2,QANF,QAGI,QAB4,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: T-SQL Debugger Does Not Run on NT with User Account</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175868</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
T-SQL Debugger causes the following error when a stored procedure is called
if the Visual Basic 5.0 application is being run on an NT 4.0 machine where
the login was to a User Account:
<P>
<PRE>   "You must have Privledges to modify the registry"

</PRE>NOTE: The word "Privileges" is misspelled in the error message.
<P>
Visual Basic will hang when the application is ended and the task manager
must be invoked to shut it down.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use an NT login account that has administrator rights.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Login into an NT server with administrator privileges.

<P><LI>Create a stored procedure on Sqlserver 6.5 by running the following
   code in ISQL/W:
<P>
<P><PRE>      CREATE PROCEDURE findstate @whichstate char(2) as
      select * from authors where state= @whichstate
</PRE>
<P><LI>Create a Visual Basic Project and check "Microsoft Remote Data Object
   2.0" under Project References.

<P><LI>Under Add-Ins Manager, check Visual Basic T-SQL Debugger. Under Tools,
   T_SQL Debugging Option make sure both check boxes are checked. See
   references mentioned below for setting up T-SQL Debugger.

<P><LI>Place two CommandButtons on the form. Paste the following code in the
   form:
<P>
<PRE>         Option Explicit
           Dim cn As rdoConnection
           Dim qy As rdoQuery
           Dim rs As rdoResultset
           Dim strConnect As String
           Dim n As Integer
   
         Private Sub Command2_Click()
            rs.Close
            Set rs = Nothing
            unload me
         End Sub
   
     Private Sub Command1_Click()
   
        strConnect = "driver={SQL Server};server=servername;" &amp; _
          "database=pubs;uid=sa;pwd="
        rdoEnvironments(0).CursorDriver = rdUseOdbc
        Set cn = rdoEnvironments(0).OpenConnection( _
          dsName:="", _
          Prompt:=rdDriverNoPrompt, _
          ReadOnly:=False, _
          Connect:=strConnect)
   
        Set qy = cn.CreateQuery("sql", _
                "{call pubs.dbo.findstate(?) }")
        qy.RowsetSize = 1
        qy.rdoParameters(0) = "CA"
        Set rs = qy.OpenResultset( _
          Type:=rdOpenForwardOnly, _
          LockType:=rdConcurReadOnly)
   
        While Not rs.EOF
          debug.print rs(0) &amp; ", " &amp; rs(1)
          rs.MoveNext
        Wend
   
      End Sub

</PRE><P><LI>Place a break point on the procedure call line.

<P><LI>Run the code and T-SQL debugger should come up.

<P><LI>Press the F5 key and it should continue.

<P><LI>Close Visual Basic and restart NT. Login to User Account.

<P><LI>Open the same project making sure T-SQL debugger is activated.

<P><LI>Run the application and the error will appear.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual Basic Books Online, query on "t-sql debugger," use quotes.
<P>
Hitchhiker's Guide to Visual Basic &amp; SQLserver. pp411-413
<P>
For more information on T-SQL Debugger for setup problems, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q166280.htm">Q166280</A></B>
   TITLE     : T-SQL Debugger Server Setup Provides Incorrect Location
   
   ARTICLE-ID: <B><A href="../vbwin/q172099.htm">Q172099</A></B>
   TITLE     : T-SQL - Running Remote and Local SQL Debugging
</PRE></OL> 
<PRE>Keywords          : vb5all kberrmsg
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
