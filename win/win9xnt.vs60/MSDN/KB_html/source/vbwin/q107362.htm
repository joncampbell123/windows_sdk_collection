

<HTML>
<HEAD>
<TITLE>FIX: Name Not Found in This Collection When Deleting Member </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107362">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/11/17">
<META NAME="Keywords" CONTENT="APrgDataOther kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Delete method incorrectly reports the following message for the existing member under certain conditions:     Name not found in this collection. Error 3265.  This occurs when you use the OpenDatabase function to open a database, and then immedi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QATJ,QBS0,QA28,QDKW,QBCT,QAEF,QAGC,QAGB,QAAP,QAH4,QDKD,QAUJ,QAR4,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Name Not Found in This Collection When Deleting Member</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107362</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  version 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Delete method incorrectly reports the following message for the
existing member under certain conditions:
<P>
<PRE>   Name not found in this collection. Error 3265.

</PRE>This occurs when you use the OpenDatabase function to open a database, and
then immediately, as the first change to the database's structure, execute
a Delete method on a member of a TableDefs or Indexes collection. The
member can be a TableDef or Index.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem occurs when a Delete method is the first data definition
language (DDL) operation after you open the database.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around the bug, use the Refresh method on the Indexes collection
before using the Delete method. An example is shown in "Workaround Example"
under the More Information section below.
<P>
NOTE: A program will correctly give the above error message when the name
truly is not found in the collection. As soon as a Delete method succeeds
on a specified TableDef or Index member of a collection, that name will no
longer be found in the collection.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This problem has been corrected in Visual
Basic version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Copy the file BIBLIO.MDB from your Visual Basic directory to the root
   directory (C:\BIBLIO.MDB). The program created below modifies the copy
   of BIBLIO.MDB instead of the master file. The BIBLIO.MDB sample
   database file is a bibliographical reference.

<P><LI>Add a command button to Form1.

<P><LI>Add the following code to the Command1 Click event:
<P>
<PRE>   Sub Command1_Click()
      Dim db as Database
      Set db = OpenDatabase ("c:\BIBLIO.MDB")
      ' db.TableDefs("Titles").Indexes.Refresh ' Add this for workaround
      db.Tabledefs("Titles").Indexes.Delete "PubID"  '&lt;- Problem line
   End Sub

</PRE><P><LI>Start the program or press the F5 key. The program gives the incorrect
   error, "Name not found in this collection."
<P>
</OL><h3>Workaround Example</h3>
 
<P>
To work around this bug, use the Refresh method before using the Delete
method:
<P>
<PRE>   db.TableDefs("Titles").Indexes.Refresh

</PRE></OL>As an alternative workaround, replace the Delete line with this command:
<P>
<PRE>   ' Enter the following two lines as one, single line:
   db.TableDefs("Titles").Indexes.Delete
      db.TableDefs("Titles").Indexes("PubID")

</PRE>This command expands "PubID" into its complete reference:
<P>
<PRE>   db.TableDefs("Titles").Indexes("PubID")

</PRE>This refreshes the Indexes collection before PubID is deleted in the same
statement.
<P>
NOTE: If you run the program twice using the workaround, the program
correctly gives the error, "Name not found in this collection." The error
is correct this time because the PubID index member was successfully
deleted and no longer exists.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 3.00 fixlist4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgDataOther<BR>
Keywords          : APrgDataOther kbbuglist kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
