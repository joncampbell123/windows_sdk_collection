

<HTML>
<HEAD>
<TITLE>VB3 How to Set the Formatting Rectangle of a TextBox </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101162">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1993/07/07">
<META NAME="Keywords" CONTENT="kbui kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You can change the formatting rectangle of a text box to control when scrolling occurs.  The formatting rectangle determines the range of positions allowed for the caret (text cursor). The limiting rectangle is independent of the size of the edit-c...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QAIJ,QAK4,QBS0,QBXS,QABO,QANX,QATX,QAMB,QDIV,QAH4,QAEB,QAK3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 How to Set the Formatting Rectangle of a TextBox</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101162</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can change the formatting rectangle of a text box to control when
scrolling occurs.
<P>
The formatting rectangle determines the range of positions allowed for the
caret (text cursor). The limiting rectangle is independent of the size of
the edit-control window. By default, the formatting rectangle is the same
as the client area of the edit-control window.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Using the SendMessage API call and the EM_SETRECT message, you can set the
formatting rectangle of a text box. If you do not send the EM_SETRECT
message, the formatting rectangle defaults to the size of the client area
of the text box.
<P>
You can use this API call to control where the scrolling starts in a text
box. The default scrolling starts when the cursor reaches the left side of
the text box. This API can make that rectangle smaller than the actual text
box forcing the scrolling to start before the cursor reaches the left side
of the text box.
<P>
Note the following if you do not use the message until after text has been
entered into the text box:
<P>
If the text box does not have a horizontal scroll bar, and the formatting
rectangle is set to be larger than the text box window, lines of text
exceeding the width of the text box (but smaller than the width of the
formatting rectangle) are clipped instead of wrapped.
<P>
<P><h3>Step-by-Step Demonstration</h3>
 

<OL><P><LI>Start Visual Basic, or if you are in Visual Basic, start a new project.

<P><LI>Add a text box (Text1) to your form.

<P><LI>Set the Text1 MultiLine Property to True and the ScrollBars Property to
   3 (Both).

<P><LI>From the File menu, choose New Module (Module1.bas).

<P><LI>Add the following code to Module1.bas:
<P>
   Type recttype
<P><PRE>      l As Integer ' left of rectangular region
      t As Integer ' top of region
      r As Integer ' right of region
      b As Integer ' bottom of region
</PRE>   End Type
<P>
<PRE>   ' Note the following Declare must be on one, single line:
   Declare Function SendMessage Lib "user" (ByVal hwnd%, ByVal wMsg%, _
      ByVal wp%, lp As Any) As Long

</PRE><P><LI>Add the following code to the Form_Load event for Form1:
<P>
<PRE>   Sub Form_Load ()
      EM_SETRECT = &amp;H403      ' Set EM_SETRECT variable
      Dim rect As recttype    ' dim variable as rectype
      rect.l = 0              ' Set left to upper left corner
      rect.t = 0              ' Set top to upper left corner
      rect.r = 200            ' Set right of region
      rect.b = 200            ' Set bottom of region
      x% = SendMessage(text1.hwnd, EM_SETRECT, 0, rect)
   End Sub

</PRE><P><LI>Run the program.
<P>
</OL>Start typing in the text box. Scrolling will begin when you reach the edge
of your region. You can change the size of your region by changing the
values of the rect type.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbui kbprg kbcode<BR>
KBSubcategory: APrgWindow<BR>
Additional reference words: 2.00 3.00 textbox rect
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
