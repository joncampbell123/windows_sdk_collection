

<HTML>
<HEAD>
<TITLE>Nested OLE Objects Are Destroyed When Parents Are Destroyed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129837">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbprg kbole">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you have OLE objects that create OLE objects, these nested objects are destroyed (set equal to Nothing) when the parent object that created them is destroyed.  MORE INFORMATION  Visual Basic releases all second-level objects (objects created b...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QBS0,QAD7,QAH7,QAH6,QAFF,QDKA,QABO,QA9Q,QA5F,QAMA,QAJQ,QBXS,QAJ8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Nested OLE Objects Are Destroyed When Parents Are Destroyed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129837</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you have OLE objects that create OLE objects, these nested objects are
destroyed (set equal to Nothing) when the parent object that created them
is destroyed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual Basic releases all second-level objects (objects created by objects)
when the top level class is destroyed. This is essentially the same
behavior as an object variable going out of scope.
<P>
For example, assume the following object hierarchy:
<P>
Two classes:
<PRE>   Class CTopLevel
   Class CSecondLevel

</PRE>Class CTopLevel has the object members.
<PRE>   Public ChildObject As CSecondLevel
   Public ParentString As String

</PRE>Class CSecondLevel has the object member.
<PRE>   Public ChildString As String

</PRE>In the Initialize event of CTopLevel, you set the ChildObject:
<P>
<PRE>   Private Sub CTopLevel_Initialize ()
      Set ChildObject = New CSecondLevel
      ChildObject.ChildString = "I'm a child object."
   End Sub

</PRE>If the CTopLevel class is created and goes out of scope after the End Sub
in the following code:
<P>
<PRE>   Private Sub Form_Click ()
      Dim ParentObject As New CTopLevel
      ParentObject.ParentString = "I'm a parent object."
   End Sub

</PRE>a CSecondLevel object (ChildObject) is explicitly instantiated in the
CTopLevel_Initialize event, but implicitly destroyed when ParentObject goes
out of scope at the end of the Form_Click Sub procedure.
<P>
For objects that have not been destroyed when a Visual Basic application
shuts down, Visual Basic does a two-pass cleanup on outstanding objects.
Pass one releases all module level and static object references (classes
and objects). Pass two releases the objects themselves. This allows parent
and child objects to both shut down even though they may have module-level
references to each other. Essentially, Visual Basic cleans up after itself
very well.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbole<BR>
KBSubcategory: IAPOLE PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
