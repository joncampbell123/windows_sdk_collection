

<HTML>
<HEAD>
<TITLE>HOWTO: Find and Highlight Text in the RichTextBox Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154884">
<META NAME="KBModify" CONTENT="1997/07/14">
<META NAME="KBCreate" CONTENT="1996/08/16">
<META NAME="Keywords" CONTENT="PrgCtrls vb432 vb4win kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  In many applications there is a function to search and highlight keywords in a text window. The RichTextBox control in Visual Basic 4.0 can be made to provide this functionality, as shown in the sample code below.  MORE INFORMATION  1. Start a new ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QATX,QAHH,QAMB,QAIJ,QBXN,QANF,QBWS,QA7O,QA5E,QA5B,QAOE,QAMN,QAB5,QAHG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Find and Highlight Text in the RichTextBox Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154884</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In many applications there is a function to search and highlight keywords
in a text window. The RichTextBox control in Visual Basic 4.0 can be made
to provide this functionality, as shown in the sample code below.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Place a Command button and a RichTextBox on Form1. Set the Text property
   of the RichTextBox to "This is an example of finding text in a rich
   text box."

<P><LI>Add the following code to the General Declarations section of Form1:
<P>
   Option Explicit
<P>
<PRE>   Private Sub Command1_Click()
     HighlightWords RichTextBox1, "text", vbRed
   End Sub

   Private Function HighlightWords(rtb As RichTextBox, _
                               sFindString As String, _
                               lColor As Long) _
                               As Integer

     Dim lFoundPos As Long           'Position of first character of match
     Dim lFindLength As Long         'Length of string to find
     Dim lOriginalSelStart As Long
     Dim lOriginalSelLength As Long
     Dim iMatchCount As Integer      'Number of matches

     'Save the insertion points current location and length
     lOriginalSelStart = rtb.SelStart
     lOriginalSelLength = rtb.SelLength

     'Cache the length of the string to find
     lFindLength = Len(sFindString)

     'Attempt to find the first match
     lFoundPos = rtb.Find(sFindString, 0, , rtfNoHighlight)
     While lFoundPos &gt; 0
       iMatchCount = iMatchCount + 1

       rtb.SelStart = lFoundPos
       'The SelLength property is set to 0 as
       'soon as you change SelStart
       rtb.SelLength = lFindLength
       rtb.SelColor = lColor

       'Attempt to find the next match
       lFoundPos = rtb.Find(sFindString, _
         lFoundPos + lFindLength, , rtfNoHighlight)
     Wend

     'Restore the insertion point to its original
     'location and length
     rtb.SelStart = lOriginalSelStart
     rtb.SelLength = lOriginalSelLength

     'Return the number of matches
     HighlightWords = iMatchCount

   End Function

</PRE><P><LI>Choose Start from the Run menu, or press the F5 key to start the
   project. Click the Command button and you should see that both
   occurrences of the word "text" are now shown in red.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
The Visual Basic Online Help and the Professional Features Manual in the
Custom Control Section, p.329-362.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : PrgCtrls vb432 vb4win kbhowto<BR>
Version             : 4.0<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
