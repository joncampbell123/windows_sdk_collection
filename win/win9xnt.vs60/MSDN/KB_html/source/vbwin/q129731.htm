

<HTML>
<HEAD>
<TITLE>BUG: ODBC OrdinalPosition Differs with dbSQLPassThrough </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129731">
<META NAME="KBModify" CONTENT="1995/12/18">
<META NAME="KBCreate" CONTENT="1995/05/02">
<META NAME="Keywords" CONTENT="kbprg kbbuglist kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The values of OrdinalPosition for fields in a RecordSet created against an ODBC data source will be different depending on whether dbSQLPassThrough is used or not.  CAUSE =====  OrdinalPosition is not under the control of Visual Basic DAO for ODBC ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAG8,QBS0,QACI,QAY2,QAVX,QAIJ,QAJP,QA9E,QBXS,QBWS,QAI4,QA28,QAYZ,QATJ,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ODBC OrdinalPosition Differs with dbSQLPassThrough</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129731</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The values of OrdinalPosition for fields in a RecordSet created against an
ODBC data source will be different depending on whether dbSQLPassThrough is
used or not.
<P>
<P><h2>CAUSE</h2>
 
<P>
OrdinalPosition is not under the control of Visual Basic DAO for ODBC data
sources. This information is retrieved from the back-end database engine.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
OrdinalPosition on a database should not be expected to be in sync with
collection indexes in Visual Basic. To get the OrdinalPosition as defined
for the ODBC datasource, dbSQLPassThrough should be used.
<P>
<P><h2>STATUS</h2>
 
<P>
Regarding: The difference in OrdinalPosition with or without
dbSQLPassThrough:
<P>
Microsoft has confirmed this to be a bug in the products listed at the
beginning of this article. We are researching this problem and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
Regarding: The difference in OrdinalPosition versus the value in collection
indexes:
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the Form1_Load procedure:
<P>
   NOTE: This example assumes an existing table "userid.table1" with three
   fields (field1, field2, field3) on an ODBC DSN (mydatasource).
<P>
<PRE>   Sub Form_Load()
      Dim Db as Database
      Dim RS As Recordset, I As Integer
      Dim TD As TableDef
      Set DB = Workspaces(0).OpenDatabase("", False, False, _
       "ODBC;dsn=mydatasource;UID=userid;pwd=userpassword")
      Debug.Print
      Debug.Print "From the TableDef -&gt;"
      Set TD = DB.TableDefs("userid.table1")
      For I = 0 To TD.Fields.Count - 1
      Debug.Print TD.Fields(I).Name;
      Debug.Print " Count "; I;
      Debug.Print " Ordinal Postion "; _
         Str$(TD.Fields(I).OrdinalPosition)
      Next I
      Debug.Print

      Set RS = DB.OpenRecordset("SELECT * FROM userid.table1", _
         dbOpenSnapshot, dbSQLPassThrough)
      Debug.Print "From the RecordSet -&gt;"
      For I = 0 To RS.Fields.Count - 1
         Debug.Print RS.Fields(I).Name;
         Debug.Print " Count "; I;
         Debug.Print " Ordinal Position ";_
            RS.Fields(RS.Fields(I).Name).OrdinalPosition
      Next I
      RS.Close
      DB.Close
   End Sub

</PRE><P><LI>Start the program by choosing Start from the Run menu or by pressing the
   F5 key.
<P>
   The output shows the difference between the enumerated position and
   OrdinalPosition:
<P>
   &gt;From the TableDef -&gt;
   field1 Count 0 Ordinal Postion 0
   field2 Count 1 Ordinal Postion 0
   field3 Count 2 Ordinal Postion 0
<P>
   &gt;From the RecordSet -&gt;
   field1 Count 0 Ordinal Position 1
   field2 Count 1 Ordinal Position 2
   field3 Count 2 Ordinal Position 3

<P><LI>Now change the OpenRecordSet line to:
<P>
   Set RS = DB.OpenRecordset("SELECT * FROM table1", dbOpenSnapshot)

<P><LI>Restart the program by choosing Restart from the Run menu or by pressing
   SHIFT+F5.
<P>
   Now, the output shows the enumerated position and OrdinalPosition in
   agreement:
<P>
   &gt;From the TableDef:
   ------------------
   field1 Count 0 Ordinal Postion 0
   field2 Count 1 Ordinal Postion 0
   field3 Count 2 Ordinal Postion 0
<P>
   &gt;From the RecordSet:
   -------------------
   field1 Count 0 Ordinal Position 0
   field2 Count 1 Ordinal Position 1
   field3 Count 2 Ordinal Position 2
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 buglist4.00 vb4win vb4all<BR>
KBCategory: kbprg kbprb kbbuglist<BR>
KBSubcategory: APrgDataODBC<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
