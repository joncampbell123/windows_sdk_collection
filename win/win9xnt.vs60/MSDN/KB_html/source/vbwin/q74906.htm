

<HTML>
<HEAD>
<TITLE>PRB: Carriage Return Won't Wrap Lines in Text Box Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74906 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1991/08/04">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Under Microsoft Windows version 3.0, using Chr$(13) (the carriage return character) alone to create a line wrap to the next line in a Visual Basic text box control causes the character following the carriage return to be removed from a multiline te...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBT6,QBV4,QAHP,QDL9,QBWO,QBWN,QBS0,QBXT,QA5V,QAIB,QBPC,QATX,QAMB,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Carriage Return Won't Wrap Lines in Text Box Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74906 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0 and 3.0
<LI>Microsoft Visual Basic programming system for Windows, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Under Microsoft Windows version 3.0, using Chr$(13) (the carriage return
character) alone to create a line wrap to the next line in a Visual Basic
text box control causes the character following the carriage return to be
removed from a multiline text box. Under Microsoft Windows, version 3.1, it
will cause a pipe character '|' to be displayed in the place of the
CHR$(13).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To wrap to the next line correctly, you must use both a carriage return and
a linefeed -- Chr$(13) and Chr$(10).
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The correct method to create a line wrap is to use a carriage return
character followed by a linefeed character, Chr$(13) + Chr$(10). The
Windows text box expects to find this sequence and assumes that the
character following the carriage return is a linefeed, thus removing the
following character as if it were a linefeed.
<P>
The following steps show the results of using just the carriage return, and
the results of using both carriage return and linefeed characters in a text
box.

<OL><P><LI>In a new project, click the text box icon from the Toolbox
   (second tool down in the right column).

<P><LI>Click anywhere on the form and drag diagonally to create a text box
   large enough to hold more then one line of text.

<P><LI>From the Properties bar (below the main menu) scroll down to
   Multiline, then choose the Settings box for that Multiline property
   (also on the Properties bar below the menu) and choose True. The
   text box can now accommodate several lines of text.

<P><LI>Double-click anywhere in the form outside of the text box to bring
   up the Form_click code window (or use the F7 function key).

<P><LI>On the line below Sub Form_click (), type the following:
<P>
<P><PRE>      Text1.text = "Hello" + Chr$(13) + "World"
</PRE>
<P><LI>Press F5 to run the newly created application, then click
   anywhere in the form outside the text box. The following text
   will appear.
<P>
   For Windows, version 3.0:
<P>
<P><PRE>      Hello
      orld
</PRE><P>
   NOTE: The W of "World" is missing.
<P>
   For Windows, version 3.1:
<P>
<P><PRE>      Hello|World
</PRE>
<P><LI>To obtain the desired result, you must add a linefeed following the
   carriage return character, as follows:
<P>
<P><PRE>      Text1.text = "Hello" + Chr$(13) + Chr$ (10) + "World"
</PRE><P>
   This statement will display the expected result of:
<P>
<P><PRE>      Hello
      World
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
