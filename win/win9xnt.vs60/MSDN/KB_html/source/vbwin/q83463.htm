

<HTML>
<HEAD>
<TITLE>BUG: Graph Axis Titles Don't Switch on Horizontal Bar Graphs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q83463 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/04/13">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Graph custom control allows you to convert your graph control from a non-horizontal bar graph to a horizontal bar graph or vice versa. This conversion will switch all necessary information to its proper position except for the axis titles. The ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAH4,QBS0,QAKR,QAHE,QBWS,QAPN,QAMN,QAAL,QAB5,QBJZ,QA7O,QAOE,QAFF,QAC2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Graph Axis Titles Don't Switch on Horizontal Bar Graphs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q83463 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  versions 2.0 and 3.0
</PRE>- Microsoft Professional Toolkit for Microsoft Visual Basic programming
<PRE>  system for Windows, version 1.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Graph custom control allows you to convert your graph control from a
non-horizontal bar graph to a horizontal bar graph or vice versa. This
conversion will switch all necessary information to its proper
position except for the axis titles. The BottomTitle and LeftTitle
should switch positions, but do not.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
As a workaround for this problem, test whether the graph is being
converted from or to a horizontal bar graph, and switch the values for
BottomTitle and LeftTitle yourself. The example shown in the More
Information section illustrates the problem and provides code to work
around it.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug with the Graph custom control
supplied with the Microsoft products listed at the beginning of this
article. We are researching this problem and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
1. Start Visual Basic or from the File menu, choose New Project (ALT,
<PRE>   F, N) if Visual Basic is already running. Form1 is created by default.

</PRE><P><LI>From the File menu, choose Add File. In the Files list box, select
   the GRAPH.VBX custom control file. The Graph tool appears in the
   toolbox.

<P><LI>On Form1, add three command buttons (Command1, Command2, and
   Command3) and a Graph control (Graph1).

<P><LI>Change the following properties:
<P>
<PRE>   Control     Property       Value
   -----------------------------------------------------
   Command1    Caption        Make Horizontal
   Command2    Caption        Make Vertical
   Command3    Caption        Switch Correctly
   Graph1      Width          4000
   Graph1      Height         2500
   Graph1      GraphType      3  (default)
   Graph1      GraphStyle     0  (default)
   Graph1      GraphData      10, 20, 30, 40, 50
   Graph1      BottomTitle    Title for axis labeled 1-5
   Graph1      LeftTitle      Title for axis labeled 0-50

</PRE><P><LI>In the Command1 Click event, add the following code:
<P>
<PRE>   Sub Command1_Click ()
      Graph1.GraphStyle = 1    'horizontal
      Graph1.DrawMode = 2     ' redraws graph with new properties
   End Sub

</PRE><P><LI>In the Command2 Click event, add the following code:
<P>
<PRE>   Sub Command2_Click ()
      Graph1.GraphStyle = 0 'default (vertical)
      Graph1.DrawMode = 2   ' redraws graph with new properties
   End Sub

</PRE><P><LI>In the Command3 Click event, add the following code:
<P>
<PRE>   Sub Command3_Click ()
      Const TRUE = 1
      OldStyle = Graph1.GraphStyle
      Graph1.GraphType = 3  'or change according to your needs
      Graph1.GraphStyle = 1  'or change according to your needs

      If (Graph1.GraphType=3) Or (Graph1.GraphType=4) Then BarGraph%=TRUE
      ' The next line of code takes advantage of the fact that the
      ' GraphStyle numbers for the horizontal bar graphs are odd and the
      ' vertical are even.
      If (Graph1.GraphStyle + OldStyle) Mod 2 = 1 Then Switched% = TRUE

      If BarGraph% And Switched% Then
         temp$ = Graph1.BottomTitle
         Graph1.BottomTitle = Graph1.LeftTitle
         Graph1.LeftTitle = temp$
      End If
      Graph1.DrawMode = 2
   End Sub

</PRE><P><LI>Press F5 (or ALT, R, S) to run the program.
<P>
</OL>When you run the program and click the Command1 button, Graph1 will
redraw itself as a horizontal graph. The left and bottom labels
switched but the LeftTitle and BottomTitle do not. Next, click the
Command2 button. The Command2 Click event will return the graph to its
original appearance.
<P>
When you click the Command3 button, Graph1 will redraw itself as a
horizontal graph with all labels and titles switched appropriately.
The code for the Command3 Click event was written to react appropriately,
regardless of which GraphType and GraphStyle are chosen.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist1.00 buglist2.00 buglist3.00 1.00 2.00<BR>
3.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
