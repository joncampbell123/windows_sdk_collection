

<HTML>
<HEAD>
<TITLE>FIX: First Item Can Disappear in Outline Control Style 0 or 2 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108659">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/12/15">
<META NAME="Keywords" CONTENT="PrgCtrlsCus kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When an Outline custom control has both:   - Style property value of 0 or 2  - Indent property value of 0 on an item  the first visible item in the outline incorrectly disappears when you initially click any other item at run time. The problem occu...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIB,QBS0,QAPN,QBCD,QAO7,QA7O,QAOE,QAMN,QAB5,QAH4,QBWS,QDKW,QBVV,QBAA,QA5B V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: First Item Can Disappear in Outline Control Style 0 or 2</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108659</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Professional Edition of Microsoft Visual Basic for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When an Outline custom control has both:

<UL><LI>Style property value of 0 or 2
<LI>Indent property value of 0 on an item
<P>
</UL>the first visible item in the outline incorrectly disappears when you
initially click any other item at run time. The problem occurs both in
the Visual Basic environment and in compiled EXE files.
<P>
By design, the item that has an Indent property of 0 should not display.
However this should not have any effect on the items that do display.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The first item reappears as soon as you select it with the mouse or
keyboard. The keyboard interface for the Outline control includes
LEFT ARROW, RIGHT ARROW, UP ARROW, DOWN ARROW, HOME, END, PAGE UP, PAGE
DOWN, plus sign (+), and minus sign (-).
<P>
You can prevent the disappearance of the first item as follows:

<UL><LI>Do not use an Indent value of 0 on items in an Outline control that uses
   Style property values of 0 or 2. Instead, use an Indent value of 1 or
   greater.
<P>
</UL>or

<UL><LI>Add the Outline1.ListIndex=1 statement after you add all items and
   indents to the Outline control. This ListIndex method selects the first
   item automatically, working around the problem.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Professional Edition of
Microsoft Visual Basic version 3.0 for Windows. This problem has been
corrected in Visual Basic version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: An item that has an Indent property of 0 will be visible when you
use Style property values of 1, 3, 4, and 5, which include pictures or
tree lines. The bug mentioned in this article does not occur for these
styles.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>From the File menu, choose Add File. Add the MSOUTLIN.VBX control file
   from your WINDOWS\SYSTEM directory.

<P><LI>Add an Outline custom control to the form.

<P><LI>Select the Outline control and press the F4 key to display the
   Properties window. Set the Style property to 0 or 2:
<P>
<P><PRE>      0 - Text Only
</PRE>   or
<P><PRE>      2 - Plus/Minus and Text
</PRE>
<P><LI>Double-click the form to display the code window. Add the following code
   to the Form Load event:
<P>
<PRE>   Sub Form_Load ()
      For i = 0 To 4
         ' Note that item 0 will not be visible, by design.
         outline1.AddItem Str$(i)
         outline1.Indent(i) = i
      Next
      For i = 1 To 4
         outline1.Expand(i - 1) = True
      Next
      ' Add the following statement to work around the bug:
      ' Outline1.ListIndex=1
   End Sub

</PRE><P><LI>Start the program, or press the F5 key. To duplicate the problem, click
   any item except the first. The first item, 1, incorrectly disappears.
<P>
   As long as you click any item except the first, the first item remains
   invisible. As soon as you click the first item, it correctly appears.
<P>
</OL>To work around the problem, add Outline1.ListIndex=1 to the end of the
code listed in step 5. The ListIndex method selects the first item
automatically.
<P>
<P><h2>REFERENCES</h2>
 

<UL><LI>"Microsoft Visual Basic Version 3.0: Professional Features Book 1:
   Custom Control Reference." See the Outline control, pages 256-257.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 3.00 fixlist4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsCus<BR>
Keywords          : PrgCtrlsCus kbbuglist kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
