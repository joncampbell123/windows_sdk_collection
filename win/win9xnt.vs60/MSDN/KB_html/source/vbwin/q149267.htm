

<HTML>
<HEAD>
<TITLE>BUG: Container Property of DBGrid Does Not Behave Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149267">
<META NAME="KBModify" CONTENT="1996/10/03">
<META NAME="KBCreate" CONTENT="1996/03/29">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If the container property of the DBGrid control is changed at run time, subsequent changes to the DBGrid's properties will still reflect the initial container. If the Name property of the Container object (that is, DBGrid1.Container.Name) is examin...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QBWS,QDKW,QA7O,QAB5,QAOE,QAMN,QBS0,QBXS,QAIJ,QBVV,QAYS,QABA,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Container Property of DBGrid Does Not Behave Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149267</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If the container property of the DBGrid control is changed at run time,
subsequent changes to the DBGrid's properties will still reflect the
initial container. If the Name property of the Container object (that is,
DBGrid1.Container.Name) is examined, it will return the newly set
container, but the DBGrid itself will not honor this change.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, place the DBGrid control inside another
container (such as a PictureBox or Frame), size this container, and set
properties so that the DBGrid appears as normal, and then set the
properties of this container instead of the properties of the DBGrid.
<P>
Steps 5 - 9 of the reproduction sample below demonstrate this workaround.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce</h3>
 

<OL><P><LI>Start Visual Basic 4.0. Form1 is created by default.

<P><LI>Add a single DBGrid control to the form. Also click and drag a single
   picture box onto the same form.

<P><LI>Add the following code to the form's Form_Click event:
<P>
<PRE>   Private Sub Form_Click()
      Set DBGrid1.Container = Picture1
      DBGrid1.Left = 0
      DBGrid1.Top = 0
   End Sub

</PRE><P><LI>Press F5 or select Start from the Run menu to run the application. Click
   on the form and notice that the DBGrid moves to the upper-left corner of
   the form instead of the upper-left corner of the picture box control.
<P>
</OL>To work around the problem, perform the following steps:

<OL><P><LI>Add an additional PictureBox to the form (Picture2 by default).

<P><LI>Delete the currently existing DBGrid and then draw a new DBGrid inside
   of the Picture2 PictureBox control.

<P><LI>Set the BorderStyle property of Picture2 to '0 - None'. Move the DBGrid
   and resize Picture2 so that the picture box control just surrounds the
   DBGrid and so that the picture control does not appear visible.

<P><LI>Modify the Form_Click event to contain this code:
<P>
<PRE>   Private Sub Form_Click()
      Set Picture2.Container = Picture1
      Picture2.Left = 0
      Picture2.Top = 0
   End Sub

</PRE><P><LI>Press F5 or select Start from the Run menu to run the application. Click
   the form and observe how the DBGrid now moves to the upper-left corner
   of the first picture box, not the form. In this sample, if you wanted to
   change the properties of the DBGrid, you would change the properties of
   Picture2 instead.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsCus
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 3, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
