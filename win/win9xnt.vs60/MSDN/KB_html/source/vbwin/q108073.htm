

<HTML>
<HEAD>
<TITLE>PRB: Printer.FontSize Return Value Is Not Requested Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108073">
<META NAME="KBModify" CONTENT="1996/02/18">
<META NAME="KBCreate" CONTENT="1993/12/05">
<META NAME="Keywords" CONTENT="kbprint kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you set the FontSize property of the Printer object in Visual Basic, the font size you get may differ from the size you requested. This behavior occurs with both Postscript printer fonts and Truetype fonts.  CAUSE =====  This behavior occurs b...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANO,QBC9,QBC8,QADF,QAII,QACT,QBS0,QAOX,QASR,QBXS,QAGI,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Printer.FontSize Return Value Is Not Requested Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108073</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you set the FontSize property of the Printer object in Visual
Basic, the font size you get may differ from the size you requested.
This behavior occurs with both Postscript printer fonts and Truetype
fonts.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs because Windows doesn't store the requested point
size. Instead, Windows stores the closest character cell height that is
supported on the current printer device. The character cell height is
rounded to an integer number of pixels (dots). Rounding is necessary
because Windows doesn't support a fractional device unit such as half
a dot (pixel).
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
As an example, if your printer prints at 96 dots per inch (DPI) and you
request a 10 point font, Windows creates a logical printer font that is
exactly 13 dots high:
<P>
<PRE>   13 dots = CInt( (10 points * 96 DPI) / (72 points per inch) )

</PRE>The above CInt function rounds to the nearest integer. The conversion
depends on the DPI resolution of your printer.
<P>
When you set the FontSize property to 10 points, the FontSize will
actually be set to 9.75 points, which is the nearest point size the
printer can support at 96 DPI:
<P>
<PRE>   9.75 points = 13 dots * (72 points per inch) / (96 DPI)

</PRE>On 300 DPI printers, the minimum interval between supported font sizes
is 0.24 points. You get 0.24 points per dot as a result of the following
formula:
<P>
<PRE>   (72 points per inch) / (300 DPI)

</PRE>On 600 DPI printers, such as with an HP LaserJet 4 driver, supported
font sizes are at intervals of 0.12 points.
<P>
In typesetting, a point is 1/72 of an inch. The height of fonts is
usually expressed in points.
<P>
Windows automatically maps the requested font or font size to the
nearest one supported by the screen or printer device if that font or
size does not exist on that device.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
As an example, the Hewlett-Packard (HP) LaserJet with the HP PostScript
cartridge supports point sizes down to a resolution of 0.25 point. In
Visual Basic, you can set the Printer.FontSize property to a desired
point size. You can set the Printer.FontName property to the PostScript
font. However, the Printer.FontSize property displays font sizes at 0.24
point intervals instead of 0.25 points. You get font sizes such as 9.6,
9.84, 10.08, 10.32, 10.56, 10.8, 11.04, and so forth. Setting the font
size to 11.0 points actually gives you a font with 10.8 points.
<P>
The following steps reproduce this behavior:

<OL><P><LI>In the Windows Control Panel, select a printer that uses a 300 DPI
   driver, such as on the HP LaserJet IIIsi. Printers with different DPI
   settings will return fonts in different increments.

<P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following to the Form Load event procedure:
<P>
<PRE>   Sub Form_Load ()
      For j = 9 To 12 Step .25
      Printer.FontSize = j  'Set printer font size in increments of .25
      Debug.Print Printer.FontSize
      Next
   End Sub

</PRE><P><LI>Start the program (or press F5). Choose Debug from the Window menu.
   Although you requested fonts in increments of 0.25 points, you
   instead get fonts in increments of 0.24 points:
<P>
   9.36, 9.6, 9.84, 10.08, 10.32, 10.56, 10.8, 11.04, 11.28, 11.52, 12
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 H-P laser jet HPLJ PS Apple LaserWriter<BR>
KBCategory: kbprint kbprg kbcode kbprb<BR>
KBSubcategory: APrgPrint<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
