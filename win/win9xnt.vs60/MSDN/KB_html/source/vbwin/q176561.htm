

<HTML>
<HEAD>
<TITLE>PRB: Passing Timestamp Parameter Using User Connection Designer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176561">
<META NAME="KBModify" CONTENT="1997/11/11">
<META NAME="KBCreate" CONTENT="1997/11/10">
<META NAME="Keywords" CONTENT="vb5all kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When executing a query defined from the User Connection Object with a Timestamp data type as the input parameter of a Stored Procedure, the following error occurs:     Run-time error '13'    Type mismatch  CAUSE =====  The User Connection Designer ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QACI,QA2Q,QBWS,QAG2,QBG2,QAY2,QAI5,QAHE,QBCF,QAD7,QAP2,QAYY,QABI,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Passing Timestamp Parameter Using User Connection Designer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176561</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When executing a query defined from the User Connection Object with a
Timestamp data type as the input parameter of a Stored Procedure, the
following error occurs:
<P>
<PRE>   Run-time error '13'
   Type mismatch

</PRE><h2>CAUSE</h2>
 
<P>
The User Connection Designer automatically recognizes the parameters of
Stored Procedures by name, direction, ODBC binding data type, and Visual
Basic's data type. However, the Designer thinks the Timestamp parameter is
a Byte data type in Visual Basic, which is incorrect. In SQL Server,
Timestamp is binary array; there is no corresponding counterpart in Visual
Basic.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In User Connection Designer, go to the Parameters tab of Query object
properties page and change the Visual Basic Data Type of Timestamp input
parameter from Byte to Variant.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
<P><h3>Task One : Create the Test Table and Stored Procedure</h3>
 

<OL><P><LI>For testing purpose, table TimeStampTbl is created in Pubs database with
   one row inserted. In SQL Server, to create a table and add new row,
   select Pubs database, then place the following Create Table T-SQL in the
   SQL window of ISQL/W and execute it:
<P>
<P><PRE>      CREATE TABLE TimestampTbl
<PRE></PRE>         (ID int identity, name char(30) NULL, stamp Timestamp)
      INSERT INTO TimeStampTbl (name) Values("RoadRunner")

</PRE><P><LI>To create stored procedure, spID_Timestamp, place the following Create
   Procedure T-SQL in the SQL window of ISQL/W and execute it:
<P>
<P><PRE>      CREATE PROCEDURE spID_Timestamp
<PRE></PRE>         @theID int,
         @theTS TimeStamp
      As
         SELECT * FROM TimestampTbl WHERE ID=@theID AND stamp=@theTS

</PRE></OL><h3>Task Two: Create the UserConnection</h3>
 

<OL><P><LI>Start a new project in Visual Basic and choose "Standard EXE". Form1 is
   created by default.

<P><LI>From the Project menu, select Components, select the Designer tab, and
   then place a check next to Microsoft UserConnection.

<P><LI>From the Project menu, select Add ActiveX Designer, and then select
   Microsoft UserConnection. This will bring up a dialog titled
   UserConnection1 Properties. (A reference to Remote Data Objects 2.0 will
   be automatically added to your project.)

<P><LI>On the Connection tab, select either a DSN or DSN-less connection and
   fill in the appropriate information. If you select DSN-less, make sure
   you specify a database in the Other ODBC Attributes area with
   database=Pubs. On the Authentication tab, fill in your username and
   password, and place a check next to Save Connection Information for
   Design Time.

<P><LI>Click OK to save this information and return to the Designer window.

<P><LI>Insert a new Query by right-clicking on UserConnection1 and choosing
   Insert Query or by clicking on Insert Query toolbar icon.

<P><LI>From the Source of Query, choose Based on Stored Procedure. From the
   pull-down list of the available stored procedures, select the one you
   just created, spID_Timestamp.

<P><LI>On the Parameters tab, note that the Visual Basic Data Type of input
   parameter, theTS, is default to Byte, which will cause the run-time
   error "Type mismatch."

<P><LI>Click OK to save this information.
<P>
</OL><h3>Task Three: Build the Visual Basic Code</h3>
 

<OL><P><LI>Paste the following code into the General Declarations section of Form1:
<P>
<P><PRE>      Private Sub Form_Load()
</PRE>   
<PRE>         Dim cn As New UserConnection1
         Dim rs1 As rdoResultset
         Dim rs2 As rdoResultset
         Dim Timestamp As Variant
   
         cn.EstablishConnection
         Set rs1 = cn.OpenResultSet("Select ID, Stamp From TimeStampTbl")
         Timestamp = rs1(1)
         cn.Query1 rs1(0), Timestamp
         Set rs2 = cn.LastQueryResults
         Debug.Print "rs2(0): " &amp; rs2(0)
   
      End Sub

</PRE><P><LI>Start the program or press the F5 key.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information about User Connection Designer and TimeStamp
datatype, please see the following articles in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q166281.htm">Q166281</A></B>
   TITLE     : HOWTO: Create and Implement a UserConnection
   
   ARTICLE-ID: <B><A href="../vbwin/q170380.htm">Q170380</A></B>
   TITLE     : HOWTO: Display/Pass Timestamp Value from/to SQL Server

</PRE></OL>(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Adrian Chiang, Microsoft Corporation
 
<PRE>Keywords          : vb5all kberrmsg
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
