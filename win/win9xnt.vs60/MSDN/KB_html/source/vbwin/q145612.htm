

<HTML>
<HEAD>
<TITLE>HOWTO: Retrieve Multiple Filenames from Common Dialog Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145612">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1996/02/04">
<META NAME="Keywords" CONTENT="PrgCtrls vb4all vb4win vb5all vb5howto kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Common Dialog File control allows you to select one or more files to use in your Visual Basic application program. This article shows how to retrieve the names of the selected files from the Common Dialog control.  MORE INFORMATION  Visual Basi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAMN,QA2S,QA7O,QAB5,QAOE,QBT6,QBV4,QA2Q,QA01,QAHP,QAY2,QAH4,QAPN,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Retrieve Multiple Filenames from Common Dialog Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145612</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Common Dialog File control allows you to select one or more files to
use in your Visual Basic application program. This article shows how to
retrieve the names of the selected files from the Common Dialog control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual Basic's Common Dialog File control allows you to provide access to
the directory and file structure of your hard disk from within an
application program. For example, if your user needs to select a text file,
you can display a Common Dialog File Control box and the user can traverse
the directories until he finds the individual file he wants to access.
<P>
By setting the Flags property of the Common Dialog control to the constant
value OFN_ALLOWMULTISELECT, your user may select several files to work
with. Multiple files can be selected by clicking on each filename while
holding down the SHIFT or CTRL key. The selected filenames are highlighted.
<P>
When your Visual Basic program needs to work with the files selected by the
user, you need to retrieve each individual filename from the control's
Filename property. The filenames selected by the user are all stored in
this property as one long string. Each filename is separated by a space
(32) character.
<P>
Therefore, to retrieve each individual filename from the Common Dialog's
Filename property, you use the InStr function to search for the delimiting
space character. The InStr function returns the location of the space
character within the Filename property string. Next, you use the Mid
function to remove the individual filename entry from the string.
<P>
<P><h3>Create the Demonstration Program</h3>
 
The demonstration program below shows how to retrieve all filenames
selected in a Common Dialog File control.

<OL><P><LI>Create a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a Common Dialog control to Form1. CommonDialog1 is created by
   default.

<P><LI>Add a Text Box control to Form1. Text1 is created by default.

<P><LI>Add a second Text Box control to Form1. Text2 is created by default.
   Set its MultiLine property to True.

<P><LI>Add a CommandButton control to Form1. Command1 is created by default.

<P><LI>Add the following code to the Click event for Command1.
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>          Dim I As Integer
          Dim Y As Integer
          Dim Z As Integer
          Dim FileNames$()
   
   
          CommonDialog1.filename = ""
          CommonDialog1.Filter = "All Files|*.*"
          CommonDialog1.Flags = cdlOFNAllowMultiselect
          CommonDialog1.Action = 1
   
          CommonDialog1.filename = CommonDialog1.filename &amp; Chr(32)
   
          Z = 1
          For I = 1 To Len(CommonDialog1.filename)
              I = InStr(Z, CommonDialog1.filename, Chr(32))
              If I = 0 Then Exit For
              ReDim Preserve FileNames(Y)
              FileNames(Y) = Mid(CommonDialog1.filename, Z, I - Z)
              Z = I + 1
              Y = Y + 1
          Next
   
          If Y = 1 Then
              Text1.Text = FileNames(0)
          Else
              Text2.Text = ""
              For I = 0 To Y - 1
                  If I = 0 Then
                      Text1.Text = FileNames(I)
                  Else
                      Text2.Text = Text2.Text &amp; UCase(FileNames(I)) &amp; _
      Chr$(13) &amp; Chr$(10)
                  End If
              Next
          End If
      End Sub

</PRE></OL>Execute the demonstration program by pressing the F5 key. Click on the
CommandButton. The Common Dialog Box File control is displayed on the
screen. Select several files from the file list by holding down the SHIFT
or CTRL key while clicking the mouse on a filename. When you have selected
several files, click OK. The filenames are displayed in the second Text Box
control and the directory name is displayed in the first Text Box control.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Product Documentation, Officer Developer's Kit, Visual Basic 3.0
Professional Edition. Common Dialog Control
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : PrgCtrls vb4all vb4win vb5all vb5howto kbhowto<BR>
Version             : 4.0 5.0<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
