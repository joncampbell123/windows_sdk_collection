

<HTML>
<HEAD>
<TITLE>How to Detect If Computer Has Sound Card That Plays Wave Audio </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147811">
<META NAME="KBModify" CONTENT="1996/03/05">
<META NAME="KBCreate" CONTENT="1996/02/29">
<META NAME="Keywords" CONTENT="kbprg kbsound kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how to detect if a system has a sound card capable of playing back wave audio data (.WAV files).  MORE INFORMATION  The multimedia Application Programming Interface (API) has a function, WaveOutGetNumDevs(), which returns the...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDL2,QAYS,QAHR,QBS0,QASR,QAH4,QBV8,QAY5,QAYY,QAB9,QABR,QDMW,QA5B,QA4Q,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Detect If Computer Has Sound Card That Plays Wave Audio</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147811</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to detect if a system has a sound card capable
of playing back wave audio data (.WAV files).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The multimedia Application Programming Interface (API) has a function,
WaveOutGetNumDevs(), which returns the number of devices in the system
capable of playing back wave audio data.
<P>
<P><h3>Step by Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic (ALT, F, N), and place a Command
   button (Command1) on Form1.

<P><LI>Add the following declaration to the General Declarations section of
   Form1:
<P>
   #If Win32 Then
<PRE>   Private Declare Function waveOutGetNumDevs Lib "winmm" () As Long
   #ElseIf Win16 Then
   Private Declare Function waveOutGetNumDevs Lib "mmsystem" () _
    As Integer
   #End If

</PRE><P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Private Sub Command1_Click()
   #If Win32 Then
   Dim i As Long
   #ElseIf Win16 Then
   Dim i As Integer
   #End If
   i = waveOutGetNumDevs()
   If i &gt; 0 Then         ' There is at least one device.
   MsgBox "You Can Play Wave Data"
   Else
   MsgBox "Cannot Play Wave Data"
   End If
   End Sub

</PRE><P><LI>Press the F5 key to run the code. Then click the command button. An
   appropriate message lets you know if your computer plays wave audio
   data.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbsound kbhowto<BR>
KBSubCategory: APrgWindow
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
