

<HTML>
<HEAD>
<TITLE>INFO: Data Access Objects Have Properties Based on Database Type </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129732">
<META NAME="KBModify" CONTENT="1997/12/12">
<META NAME="KBCreate" CONTENT="1995/05/02">
<META NAME="Keywords" CONTENT="APrgDataAcc APrgDataIISAM APrgDataODBC VB4ALL VB4WIN vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Certain Visual Basic Data Access Objects (DAO), such as the Field, Recordset, and TableDef objects, each have a Properties collection that uniquely characterizes an instance of the object. You can use the default (built-in) properties in the collec...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBS0,QA1S,QABA,QDKY,QAW6,QDN9,QDMW,QBWC,QAZV,QAH4,QBXS,QA59 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Data Access Objects Have Properties Based on Database Type</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129732</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Professional and Enterprise Editions of Microsoft Visual Basic, 16-bit
   and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Certain Visual Basic Data Access Objects (DAO), such as the Field,
Recordset, and TableDef objects, each have a Properties collection that
uniquely characterizes an instance of the object. You can use the default
(built-in) properties in the collection or you can create user-defined
properties by using the CreateProperty method.
<P>
The default properties available in the collection vary depending on the
database type. A set of extended properties, referred to as application-
defined properties, are available with Microsoft Access databases.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The built-in properties are available in the Properties collection for all
databases including Microsoft Access, Btrieve, dBASE, Microsoft FoxPro,
Paradox, and ODBC client-server databases such as SQL Server. For example,
the following built-in properties are available in the Properties
collection of the TableDef object (using DAO version 3.0):
<P>
<PRE>    Name            SourceTableName
    Updatable       RecordCount
    DateCreated     ValidationRule
    LastUpdated     ValidationText
    Connect         ConflictTable
    Attributes

</PRE>Additional application-defined properties are available for Microsoft
Access databases. For a complete list of built-in and application-defined
properties, please see the following topics in the Microsoft Access Help
menu:
<P>
<PRE>    Field Object, Fields Collection - Summary
    RecordSet Object, Recordsets Collection - Summary
    TableDef Object, TableDefs Collection - Summary

</PRE>The application-defined properties will not be a part of the DAO's
Properties collection until the values are changed from their default
values. You can change an application-defined property default value by
using Visual Basic code or by using the Microsoft Access design
environment. In Visual Basic code, use the CreateProperty method just as
you would to create user-defined properties.
<P>
<P><h3>Steps to Display the Properties Collection</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>If using Visual Basic 5.0, establish a reference to DAO 3.5 by
   clicking References from the Project menu.

<P><LI>Add the following code to the Form1_Click procedure:
<P>
<P><PRE>      Dim MyDB As Database
      Dim MySet As Recordset
      Dim MyProperty As Property
      Dim MyTableDef as TableDef
</PRE><P>
<P><PRE>      ' Access database
      Set MyDB = DBEngine.Workspaces(0).OpenDatabase("biblio.mdb")
      Set MySet = MyDB.OpenRecordset("Authors", dbOpenTable)
      Set MyTableDef = MyDB("Authors")
</PRE><P>
<P><PRE>      'display properties collection for Field
      For Each MyProperty In MySet(0).Properties
<PRE></PRE>         List1.AddItem MyProperty.Name
      Next

      'display properties collection for Recordset
      For Each MyProperty In Myset.Properties
         List2.AddItem MyProperty.Name
      Next

      'display properties collection for Tabledef
      For Each MyProperty In MyTableDef.Properties
         List3.AddItem MyProperty.Name
      Next

      'Append an application-defined TableDef property by
      'changing its default value so it appears in the list
      On Error GoTo myerr:     'if RowHeight property exists trap error
      Set MyProperty = MyTableDef.CreateProperty("RowHeight")
      MyProperty.Type = dbinteger
      MyProperty.Value = 9
      MyTableDef.Properties.Append MyProperty

      myerr:
      MsgBox("RowHeight Property already exists, Please create another")

      'Print list again to see that RowHeight is displayed
      For Each MyProperty In MyTableDef.Properties
         List4.AddItem MyProperty.Name
      Next
      MySet.Close
      MyDb.Close
      On Error GoTo 0

</PRE><P><LI>Add four list boxes (List1, List2, List3, and List4) to Form1.

<P><LI>Run the program.
</OL> 
<PRE>Keywords          : APrgDataAcc APrgDataIISAM APrgDataODBC VB4ALL VB4WIN vb5all
Version           : WINDOWS:4.0,5.0
Platform          : WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
