

<HTML>
<HEAD>
<TITLE>HOWTO: Suppress Maximize &amp; Minimize Buttons on MDI Parent Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137033">
<META NAME="KBModify" CONTENT="1997/07/03">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="kbui PrgCtrlsStd vb4all vb4win vb5all vb5howto vbwin kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows by example how to suppress the maximize and minimize buttons on an MDI parent form.  On non-MDI forms, you can set the MinButton and MaxButton properties to False to disable the form's Minimize and Maximize buttons. However, thes...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAMA,QA5F,QA4Q,QAPN,QBW1,QAY5,QAB9,QA5B,QAH4,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Suppress Maximize &amp; Minimize Buttons on MDI Parent Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137033</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to suppress the maximize and minimize
buttons on an MDI parent form.
<P>
On non-MDI forms, you can set the MinButton and MaxButton properties to
False to disable the form's Minimize and Maximize buttons. However, these
properties are not available on an MDI parent form. To disable an MDI
form's Minimize and Maximize buttons, you need to use the SetWindowLong
Windows API function to change the style of the window.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Both of the following examples eliminate the Minimize and Maximize buttons
from the main MDI form (MDIForm1).
<P>
NOTE: Information in the Visual Basic versions 4.0 and 5.0 section applies
only to Visual Basic versions 4.0 and 5.0, and information in the Visual
Basic 3.0 section applies only to Visual Basic 3.0.
<P>
<P><h3>VISUAL BASIC 4.0 AND 5.0 SECTION</h3>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Change the MDIChild property of Form1 to True.

<P><LI>Add an MDI form (MDIForm1) to the project.

<P><LI>Add the following code to the MDIForm_Load event procedure for MDIForm1:
<P>
<P><PRE>      Private Sub MDIForm_Load()
<PRE></PRE>         Dim L as Long
         L = GetWindowLong(Me.hWnd, GWL_STYLE)
         L = L And Not (WS_MINIMIZEBOX)
         L = L And Not (WS_MAXIMIZEBOX)
         L = SetWindowLong(Me.hWnd, GWL_STYLE, L)
      End Sub

</PRE><P><LI>Add the following declarations to the general section of MDIForm1:
<P>
</OL>NOTE: You only need the Win32 declares below if you are using Visual Basic
5.0 or if you develop only in the 32-bit version of Visual Basic 4.0.
<P>
<PRE>    #If Win32 Then
       Private Declare Function SetWindowLong Lib "user32" Alias _
          "SetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long, _
          ByVal dwNewLong As Long) As Long
       Private Declare Function GetWindowLong Lib "user32" Alias _
          "GetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long) _
          As Long
    #Else
       Declare Function SetWindowLong Lib "User" (ByVal hwnd As Integer, _
          ByVal nIndex As Integer, ByVal dwNewLong As Long) As Long
        Declare Function GetWindowLong Lib "User" (ByVal hwnd As Integer, _
          ByVal nIndex As Integer) As Long
    #End If

    Const WS_MINIMIZEBOX = &amp;H20000
    Const WS_MAXIMIZEBOX = &amp;H10000
    Const GWL_STYLE = (-16)

</PRE><P><LI>Press the F5 key to run the program.
<P>
</OL><h3>VISUAL BASIC 3.0 SECTION</h3>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Change the MDIChild property of Form1 to True.

<P><LI>Add an MDI form (MDIForm1) to the project.

<P><LI>Add the following code to the MDIForm_Load event procedure for MDIForm1:
<P>
<PRE>      Sub MDIForm_Load()
         Dim L as Long
         L = GetWindowLong(Me.hWnd, GWL_STYLE)
         L = L And Not (WS_MINIMIZEBOX)
         L = L And Not (WS_MAXIMIZEBOX)
         L = SetWindowLong(Me.hWnd, GWL_STYLE, L)
      End Sub

</PRE><P><LI>Add the following declarations to the general section of MDIForm1:
<P>
<P><PRE>      ' Enter the following Declare statement as one, single line:
      Declare Function SetWindowLong Lib "User" (ByVal hwnd As Integer,
<PRE></PRE>         ByVal nIndex As Integer, ByVal dwNewLong As Long) As Long

      ' Enter the following Declare statement as one, single line:
      Declare Function GetWindowLong Lib "User" (ByVal hwnd As Integer,
         ByVal nIndex As Integer) As Long

      Const WS_MINIMIZEBOX = &amp;H20000
      Const WS_MAXIMIZEBOX = &amp;H10000
      Const GWL_STYLE = (-16)

</PRE><P><LI>Press the F5 key to run the program.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbui PrgCtrlsStd vb4all vb4win vb5all vb5howto vbwin kbhowto<BR>
Version             : 3.0 4.0 5.0<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
