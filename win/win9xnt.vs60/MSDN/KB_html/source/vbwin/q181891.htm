

<HTML>
<HEAD>
<TITLE>BUG: OLE Drag Disabled When ListBox Has Multiple Columns </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181891">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1998/02/27">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A listbox control is set to more than one column and the OLEDragMode property is set to Automatic to allow for OLE Drag-and-Drop. When you attempt to drag an item to another control from any column of the listbox other than the first, the item is n...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QAHP,QBV4,QA9N,QAMN,QBVR,QAE1,QBWS,QBXS,QAY2,QAH4,QBS0,QA7O,QAYZ,QAOE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: OLE Drag Disabled When ListBox Has Multiple Columns</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181891</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A listbox control is set to more than one column and the OLEDragMode
property is set to Automatic to allow for OLE Drag-and-Drop. When you
attempt to drag an item to another control from any column of the listbox
other than the first, the item is not copied to the target control as
expected.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, initiate the drag from the listbox using the
OLEDrag method.
<P>
For example, you would add code such as the following to the MouseDown
event of the "multi-column" listbox:
<P>
<PRE>    Private Sub List1_MouseDown(Button As Integer, Shift As Integer, _
                                X As Single, Y As Single)
       List1.OLEDrag
    End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new Standard EXE project in Visual Basic. Form1 is created by
   default.

<P><LI>Add the following controls to Form1 and set the following properties for
   the appropriate controls:
<P>
<PRE>   Control           Default Name     Property            Setting
   ---------------------------------------------------------------
   Text Box          Text1            Text                &lt;Blank&gt;
                                      OLEDropMode         2 - Automatic

   List Box          List1            Columns             2
                                      OLEDragMode         1 - Automatic

</PRE><P><LI>Copy the following code to the Module of Form1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Sub Form_Load()
<PRE></PRE>         Dim intCounter As Integer
         ' Add some test data to the ListBox
         For intCounter = 1 To 100
            List1.AddItem CStr(intCounter)
         Next
      End Sub

      Private Sub List1_MouseDown(Button As Integer, Shift As Integer, _
                                  X As Single, Y As Single)
         ' Uncomment the next line for a simple workaround.
         'List1.OLEDrag
      End Sub

</PRE><P><LI>On the Run menu, click Start or press the F5 key to start the program.
   Select an item from the first column and drag that item to the text box.
   Note that you must Click and release to select the item, then Click-and-
   Drag the same item as a second operation. Now, select an item from the
   second column and drag that item to the text box.
<P>
   Result: Note that the item from the first column is copied to the text
   box, but the item from the second column is not.

<P><LI>Choose End from the Run Menu or Click the End button to stop the
   program. Uncomment the workaround line and repeat step 4.
<P>
   Result: Note that both items are now successfully copied to the text
   box. Also, it no longer requires a Click to select and a second Click-
   and-Drag to move the item. This can now be a single Click-and-Drag
   operation.
</OL> 
<PRE>Keywords          : vb5all
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbpending</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
