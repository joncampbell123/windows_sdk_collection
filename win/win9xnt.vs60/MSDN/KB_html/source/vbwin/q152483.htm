

<HTML>
<HEAD>
<TITLE>PRB: Multiple VB4 16-bit Apps Under Win95 GPF on Closing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152483">
<META NAME="KBModify" CONTENT="1996/08/08">
<META NAME="KBCreate" CONTENT="1996/06/14">
<META NAME="Keywords" CONTENT="kbusage kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you run multiple Visual Basic 4.0 16-bit applications at the same time, each using the same controls, a General Protection Fault may occur when the last instance of the application is closed. This problem only occurs under Windows 95.  RESOLUT...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBWQ,QAJZ,QBBJ,QAIJ,QDL9,QBWO,QBWN,QAGB,QAKP,QAB4,QBWS,QABA,QAJQ,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Multiple VB4 16-bit Apps Under Win95 GPF on Closing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 8, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152483</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic for
   Windows, 16-bit only, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run multiple Visual Basic 4.0 16-bit applications at the same
time, each using the same controls, a General Protection Fault may occur
when the last instance of the application is closed. This problem only
occurs under Windows 95.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The resolution is to download and install OLEUPD.EXE from the Microsoft
Software Library.
<P>
For additional information about this problem and its resolution, please
see the following article in the Microsoft Knowledge Base. It can be found
in the Windows 95 product Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q139432.htm">Q139432</A></B>
   TITLE     : OLE Update for Windows 95

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following Visual Basic 4.0 OCX controls are known to be affected by
this problem:
<P>
<PRE>   COMDLG16.OCX
   DBLIST16.OCX
   GRID16.OCX
   TABCTL16.OCX

</PRE><h3>Steps to Reproduce Problem</h3>
 
<P>
WARNING: You will need to reboot after reproducing the problem.

<OL><P><LI>Start the 16-bit Edition of Visual Basic version 4.0 for Windows. Form1
   is created by default.

<P><LI>Open the Loan Sample application found in the Samples\Grid directory.

<P><LI>Create an executable for the sample application, LOAN.EXE.

<P><LI>Start an instance of LOAN.EXE, placing it in the upper-left corner of
   the screen.

<P><LI>Start a second instance of LOAN.EXE.

<P><LI>Click the X button to close the first instance of LOAN.EXE in the upper-
   left corner of the screen.

<P><LI>Click the X button to close the second instance of LOAN.EXE.

<P><LI>An error dialog will be generated containing the following message and
   you will probably need to reboot to continue:
<P>
   "This program has performed an illegal operation and will be shut down"
<P>
   The address information in the dialog varies, since the control could be
   anywhere in memory. The error dialog will often have garbage characters
   in the title bar.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb416 kernel32<BR>
KBCategory: kbusage<BR>
KBSubcategory: EnvtDes
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 8, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
