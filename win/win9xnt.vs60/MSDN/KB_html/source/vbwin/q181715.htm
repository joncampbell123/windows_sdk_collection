

<HTML>
<HEAD>
<TITLE>PRB: RDO/Jet: Run-Time Error 40069; Client Cursor Error 11 or 12 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181715">
<META NAME="KBModify" CONTENT="1998/02/26">
<META NAME="KBCreate" CONTENT="1998/02/24">
<META NAME="Keywords" CONTENT="kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you run a SELECT statement against the Microsoft Jet ODBC driver using RDO and the client batch cursor engine, you receive one of the following two error messages:     Run-time error 40069    Client Cursor: 11 - No update tables are specified ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QAH4,QAPN,QA7O,QBDM,QA7N,QARL,QAO2,QBWS,QBS0,QAUJ,QAMA,QAKP,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: RDO/Jet: Run-Time Error 40069; Client Cursor Error 11 or 12</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 26, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181715</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a SELECT statement against the Microsoft Jet ODBC driver using
RDO and the client batch cursor engine, you receive one of the following
two error messages:
<P>
<PRE>   Run-time error 40069
   Client Cursor: 11 - No update tables are specified

   -or-

   Run-time error '40069':
   Client Cursor: 12 - No key columns are specified for the update table

</PRE><h2>CAUSE</h2>
 
<P>
When using the client batch cursor engine, and opening a static resultset,
you must use the same case as in the table when typing field names into the
SELECT clause of the SQL statement. This applies to the primary key field
and any BLOB (Binary Long Object) columns--LongVarChar and LongVarBinary.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use one of the following methods to resolve this problem:

<UL><LI>Type the field names using the same case as the field names in the ODBC
   table.
<P>
   -or-

<LI>After opening the recordset, manually specify the SourceTable property
   of the problematic columns prior to doing any data access. Also, set the
   KeyColumn property of the primary key field to True.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The client batch cursor engine needs to locate the source table name for
the primary key field and any BLOB fields, because these fields are
required when updating data and retrieving BLOB data.
<P>
If the BLOB column names don't have the correct case, you will receive the
error 11 message.
<P>
If only the primary key column has an incorrect case for the field name,
you will receive the error 12 message.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this code "as is" without warranty of any kind,
either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.

<OL><P><LI>In the ODBC 32-bit Administrator, in the Control Panel, add a DSN
   called NWIND using the Microsoft Access ODBC driver.

<P><LI>Open a new Standard EXE project in Microsoft Visual Basic 5.0.

<P><LI>On the Project menu, click Reference, and check Microsoft Remote Data
   Object 2.0.

<P><LI>Add a command button (Command1) to the default form (Form1).

<P><LI>Add the following code:
<P>
<P><PRE>      Private Sub Command1_Click()
      Dim cn As rdoConnection, rs As rdoResultset
<PRE></PRE>        rdoEngine.rdoDefaultCursorDriver = rdUseClientBatch
        Set cn = rdoEngine(0).OpenConnection("NWIND", rdDriverComplete, _
                 False, "")
        Set rs = cn.OpenResultset( _
                 "SELECT employeeid, notes, lastname FROM Employees", _
                 rdOpenStatic, rdConcurRowVer, rdExecDirect)
        Do While Not rs.EOF
          Debug.Print rs!EmployeeID, rs!LastName, Len(rs!Notes), rs!Notes
          rs.MoveNext
        Loop
        rs.Close
        cn.Close
      End Sub

</PRE><P><LI>Run the code and note the error that appears on the Debug.Print line.

<P><LI>Change notes to Notes in the SELECT clause and rerun the project.
<P>
   Note that the Client Cursor error code will change from 11 to 12.

<P><LI>Change employeeid to EmployeeID in the SELECT clause and rerun.
<P>
   Note that the error goes away.
<P>
</OL>To demonstrate the alternative workaround:

<OL><P><LI>Using the original code from step 5, add the following lines immediately
   prior to the Do statement:
<P>
<P><PRE>      rs!EmployeeID.SourceTable = "Employees"
      rs!EmployeeID.KeyColumn = True
      rs!Notes.SourceTable = "Employees"
</PRE><P>
</OL>The code should run without error.
<P>
(c) Microsoft Corporation 1988, All Rights Reserved. Contributions by
Malcolm Stewart, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: upper lower<BR>
Keywords          : kbcode<BR>
Technology        : odbc<BR>
Version           : WINDOWS:5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 26, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
