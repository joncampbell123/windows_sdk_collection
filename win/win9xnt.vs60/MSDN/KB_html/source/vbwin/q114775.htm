

<HTML>
<HEAD>
<TITLE>How to Create a Modeless Dialog or Form in Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114775">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/05/11">
<META NAME="Keywords" CONTENT="kbui kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article contains information on how to create a modeless dialog or form in Visual Basic. An example of a modeless dialog is the toolbar in Microsoft Excel version 5.0 and Word version 6.0. A modeless form always displays on top of the parent f...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QA4Q,QA01,QAFF,QAUD,QABA,QA5F,QAPN,QAMA,QAI2,QBKN,QBVP,QAO4,QAJ6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a Modeless Dialog or Form in Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114775</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains information on how to create a modeless dialog or
form in Visual Basic. An example of a modeless dialog is the toolbar in
Microsoft Excel version 5.0 and Word version 6.0. A modeless form
always displays on top of the parent form, but is not bounded by the
parent form nor does it stay on top of all other applications as does
SetWindowPos and HWND_TOPMOST.
<P>
For additional information on SetWindowPos, please see the following
article in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A href="../vbwin/q84251.htm">Q84251</A></B>
<PRE>TITLE     : How to Create a Topmost or Floating Window in Visual Basic

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The Windows API SetWindowWord() is used with the value GWW_HWNDPARENT to
change the parent of the form that you want to be a modeless dialog.
SetWindowWord returns the original parent's window handle that we need to
restore when the form is unloaded to avoid a General Protection Fault.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a second form (Form2) to the project.

<P><LI>Add a  the following code to the Form_Load event for Form1:
<P>
<PRE>   Sub Form_Load()
      Form2.Show      'display the child form
      Form1.Caption = "Parent"
      Form2.Caption = "Child"
   End Sub

</PRE><P><LI>Add the following declarations to the general section of Form2:
<P>
<PRE>   ' Enter the following Declare statement as one, single line:
   Declare Function SetWindowWord Lib "User" (ByVal hwnd As Integer,
      ByVal Index As Integer, ByVal wNewWord As Integer) As Integer
   Const GWW_HWNDPARENT = (-8)
   Dim OriginalParenthWnd As Integer

</PRE><P><LI>Add the following code the Form_Load event of Form2:
<P>
<PRE>   Sub Form_Load()

    ' Set parent for the toolbar to display on top of:
    OriginalParenthWnd = SetWindowWord(Me.hWnd, GWW_HWNDPARENT, Form1.hWnd)

    Me.Width = Form1.Width \ 3      ' Scale child form
    Me.Height = Form1.Height \ 3

   End Sub

</PRE><P><LI>Add the following code the Form_Unload event of Form2:
<P>
<PRE>   Sub Form_Unload()

     Dim ret As Integer

     ' Return the original parent handle to avoid a GP Fault
     ret = SetWindowWord(Me.hWnd, GWW_HWNDPARENT, OriginalParenthWnd)

   End Sub

</PRE><P><LI>Press the F5 key to run the program. The child form is displayed as a
   modeless dialog of the parent form.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00<BR>
KBCategory: kbui kbprg kbcode<BR>
KBSubcategory: APrgWindow<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
