

<HTML>
<HEAD>
<TITLE>HOWTO: Display Additional Buttons in Customize Toolbar Dialog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174087">
<META NAME="KBModify" CONTENT="1997/09/26">
<META NAME="KBCreate" CONTENT="1997/09/18">
<META NAME="Keywords" CONTENT="vb432 VB4WIN vb5all vb5howto VBKBAX VBKBComp VBKBCtrl">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="---   The Toolbar control that is provided with the Microsoft Windows Common Controls (COMCTL32.OCX) can be customized by users. The Customize Toolbar method is displayed if either:   - the AllowCustomize property is set to True and the user double- ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANS,QA5D,QAF0,QA9N,QDL9,QBWO,QBWN,QABA,QAEF,QAPN,QAE1,QAJD,QAHT,QBS0,QAVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Display Additional Buttons in Customize Toolbar Dialog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174087</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise
</UL>Editions
<PRE>   for Windows, version 5.0
</PRE><LI>Microsoft Visual Basic Standard, Professional, and Enterprise
</UL>Editions,
<PRE>   32-bit only, for Windows, version 4.0
</PRE> 
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Toolbar control that is provided with the Microsoft Windows
Common
Controls (COMCTL32.OCX) can be customized by users. The Customize
Toolbar
method is displayed if either:

<UL><LI>the AllowCustomize property is set to True and the user double-
</UL>clicks
<PRE>   the Toolbar

   -or-

</PRE><LI>the Customize method of the Toolbar is invoked.
<P>
</UL>By default, this dialog lists all of the buttons on the Toolbar in
the
"Toolbar Buttons" lists but lists only a Separator in the
"Available
Buttons" list. This article describes how you can display
additional
toolbar buttons in the "Available Buttons" list.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
All of the buttons in the Buttons collection of a Toolbar control
appear in
the Customize Toolbar dialog. Buttons that are currently showing
on the
Toolbar appear in the "Toolbar Buttons" list and Buttons that have
been
removed from the Toolbar through customization appear in the
"Available
Buttons" list. To add additional buttons to the "Available
Buttons" list,
create your default toolbar, use the SaveToolbar method to save
this
setting, add the additional buttons at run-time, and then use
RestoreToolbar to restore the "default" toolbar settings.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project.

<P><LI>Reference the Microsoft Windows Common Controls (COMCTL32.OCX).

<P><LI>Add a Toolbar and an ImageList to Form1.

<P><LI>Add six images to ImageList1 with the following properties:
<P>
<PRE>   Index          Key          Picture
   -----          ---          -------
   1              Bold
</PRE></OL>..\VB\Graphics\Bitmaps\Tlbr_w95\Bld.bmp
<PRE>   2              Italic
</PRE>..\VB\Graphics\Bitmaps\Tlbr_w95\Itl.bmp
<PRE>   3              Underline
</PRE>..\VB\Graphics\Bitmaps\Tlbr_w95\Undrln.bmp
<PRE>   4              Copy
</PRE>..\VB\Graphics\Bitmaps\Tlbr_w95\Copy.bmp
<PRE>   5              Paste
</PRE>..\VB\Graphics\Bitmaps\Tlbr_w95\Paste.bmp
<PRE>   6              Cut
</PRE>..\VB\Graphics\Bitmaps\Tlbr_w95\Cut.bmp

<OL><P><LI>Set the ImageList property of Toolbar1 to "ImageList1."

<P><LI>Add three buttons to Toolbar1 with the following properties:
<P>
<PRE>   Index        Key            Image
   -----        ---            -----
   1            Bold           Bold
   2            Italic         Italic
   3            Underline      Underline

   NOTE: The Toolbar contains only these three buttons because
</PRE></OL>this is the
<PRE>   layout of the "default" toolbar. The Copy, Paste, and Cut
</PRE>buttons will
<PRE>   be added at run-time so that they will appear in the
</PRE>"Additional
<PRE>   Buttons" list.

</PRE><P><LI>Add the following code to Form1:
<P>
<P><PRE>      Private Declare Function RegOpenKey Lib "advapi32.dll" Alias
</OL></PRE>_
<PRE>         "RegOpenKeyA" (ByVal hKey As Long, ByVal lpSubKey As
</PRE></OL>String, _
<PRE>         phkResult As Long) As Long

      Const HKEY_CURRENT_USER = &amp;H80000001

      Private Sub Form_GotFocus()

         Me.Show

         'Check to see if the registry keys for the toolbar exists
         'If not, then save the initial toolbar settings
         Success = RegOpenKey(HKEY_CURRENT_USER, "MyApp", hKey)
         If Success &lt;&gt; 0 Then Toolbar1.SaveToolbar "Test",
</PRE>"MyApp", _
<PRE>            "Toolbar1"

         'Add the toolbars you wish to see in the "Available
</PRE>Buttons" list
<PRE>         Toolbar1.Buttons.Add , "Copy", , , "Copy"
         Toolbar1.Buttons.Add , "Paste", , , "Paste"

         'Restore the toolbar settings
         DoEvents
         Toolbar1.RestoreToolbar "Test", "MyApp", "Toolbar1"
         DoEvents

         bFormLoad = False

      End Sub

      Private Sub Form_Unload(Cancel As Integer)

         'When the form unloads, save the toolbar settings
         'to HKEY_CURRENT_USER\MyApp
         Toolbar1.SaveToolbar "Test", "MyApp", "Toolbar1"

      End Sub

</PRE><P><LI>Press the F5 key to run the application. Double-click Toolbar1
</OL>to
<PRE>   display the Customize Toolbar dialog. Notice that the Cut,
</PRE></OL>Copy, and
<PRE>   Paste toolbars appear in the Additional Buttons list.

   NOTE: The SaveToolbar and RestoreToolbar methods used in this
</PRE>example
<PRE>   write and read the registry entry
</PRE>HKEY_CURRENT_USER\MyApp\Toolbar1.
 
<PRE>Keywords          : vb432 VB4WIN vb5all vb5howto VBKBAX VBKBComp VBKBCtrl
Version           : WINDOWS:4.0 5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
