

<HTML>
<HEAD>
<TITLE>PRB: Can't Read Temporary Table Created Using # Sign in RDO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160168">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When using Remote Data Object (RDO) to create a temporary table with a single pound sign (#) in the SQL statement, it appears that the temporary table is not created in SQL server. When an attempt is made to open this table within the same connecti...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QABM,QBF0,QBQ0,QAPN,QAI5,QAY2,QAH4,QAB4,QBWS,QBXR,QBXS,QA5B,QA2Q,QAN0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Can't Read Temporary Table Created Using # Sign in RDO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160168</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using Remote Data Object (RDO) to create a temporary table with a
single pound sign (#) in the SQL statement, it appears that the temporary
table is not created in SQL server. When an attempt is made to open this
table within the same connection, RDO returns a run-time error.
<P>
<P><h2>CAUSE</h2>
 
<P>
When an action query is prepared in RDO and passed to SQL server, a stored
procedure is created. However, this stored procedure is dropped after it is
executed. Therefore, temporary tables created within the action query are
destroyed once that stored procedure ends.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, create a global temporary object by using a
double pound sign (##). For example:
<P>
<PRE>   rdoConn.Execute "Select * Into ##Temp1 From Authors"
        Set rs = rdoConn.OpenResultset("Select * from ##Temp1")

</PRE>Another workaround is to create temporary tables by using stored procedures
in SQL server. For implementation details, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q147938.htm">Q147938</A></B>
   TITLE     : RDO: Getting Data from Temp Tables Created by Stored
               Procedure

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a CommandButton, Command1 to Form1.

<P><LI>Paste the following code into the General Declarations section of Form1:
<P>
<PRE>         Private Sub Command1_Click()
   
      Dim rdoEnv As rdoEnvironment
      Dim rdoConn As rdoConnection
      Dim strConn As String
      Dim ps As rdoPreparedStatement
   
      Set rdoEnv = rdoEngine.rdoEnvironments(0)
         rdoEnv.CursorDriver = rdUseOdbc
   
         '***You need to change the SERVER, UID, and PWD parameters here.
      strConn = "driver={SQL Server};server=myserver;" &amp; _
      "database=pubs;uid=sa;pwd="
         Set rdoConn = rdoEnv.OpenConnection( _
           dsName:="", _
           Prompt:=rdDriverNoPrompt, _
           ReadOnly:=False, _
           Connect:=strConn)
   
      rdoConn.Execute "Select * into #Temp1 From Authors"
           Set rs = rdoConn.OpenResultset("Select * from #Temp1")
           Do Until rs.EOF
              Debug.Print rs.rdoColumns(0) &amp; ", " &amp; rs.rdoColumns(1)
              rs.MoveNext
           Loop
           rs.Close
           rdoConn.Close
           rdoEnv.Close
   
         End Sub

</PRE><P><LI>Make sure you have an appropriate ODBC data source, user ID, and
   password. Start the program by pressing the F5 key.

<P><LI>Click the Command1 button to execute the code. You will receive the
   following error message indicating that table #Temp1 in SQL server
   cannot be found:
<P>
   Run-time Error '400002':
   S0002: [Microsoft][ODBC SQL Server Driver][SQL Server] Invalid object
   name
<PRE>   '#Temp1'.
</PRE></OL> 
<PRE>Keywords          : VB4ALL VB4WIN vb5all
Version           : 4.0 5.0
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
