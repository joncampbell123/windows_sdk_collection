

<HTML>
<HEAD>
<TITLE>INFO: App.LogEvent Only Logs in Compiled Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161306">
<META NAME="KBModify" CONTENT="1997/03/21">
<META NAME="KBCreate" CONTENT="1996/12/19">
<META NAME="Keywords" CONTENT="kbusage vb5all vb5howto VBKBAX kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Microsoft Visual Basic version 5.0 introduces the concept of Event Logging to applications. This feature allows an application to add information to either a user-defined file or the Microsoft Windows NT Event Log when a user-defined criteria is me...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAH4,QBWS,QAJH,QBJZ,QAVX,QAVW,QAFF,QDMH,QAY2,QDIV,QAHV,QA5F,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: App.LogEvent Only Logs in Compiled Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161306</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional,
   and Enterprise Editions, for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Visual Basic version 5.0 introduces the concept of Event Logging
to applications. This feature allows an application to add information to
either a user-defined file or the Microsoft Windows NT Event Log when a
user-defined criteria is met.
<P>
This functionality is only available when running a compiled application.
If you attempt to use the logging methods while in the Microsoft Visual
Basic 5.0 development environment, the logging methods will be ignored.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The logging can be enabled for the development process by creating and
compiling a user-defined ActiveX DLL or EXE component that exposes the
logging methods of the App object. The application in the development
environment need only to add a reference to this compiled component.
Calling the exposed methods of this ActiveX component will allow logging
to function. Below is a sample ActiveX DLL that exposes the StartLogging
and LogEvent methods of the App object.
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR
OWN RISK. Microsoft provides this code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.

<OL><P><LI>Start Microsoft Visual Basic. Open a new ActiveX DLL project. This will
   add Class1 to the new project.

<P><LI>Change the Name property of Class1 to "Logging" (without quotes).

<P><LI>From the Project menu, click Project1 Properties.

<P><LI>Change the Name of the Project to "AppMessages" (without quotes).

<P><LI>Add the following code to the Logging class:
<P>
<P><PRE>      Public Enum eLogModes
<PRE></PRE>          mLogAuto = 0
          mLogOff = 1
          mLogToFile = 2
          mLogToNT = 3
          mLogOverwrite = &amp;H10
          mLogThreadID = &amp;H20
      End Enum

      Public Sub StartLog(logTarget As String, logMode As eLogModes)
          App.StartLogging logTarget, logMode
      End Sub

      Public Sub AddLogEvent(LogBuffer As String, EventType As _
      LogEventTypeConstants)
          App.LogEvent LogBuffer, EventType
      End Sub

</PRE></OL>NOTE: Other methods may be exposed to apply to your specific needs. See the
Microsoft Visual Basic Online Help for the entire list of event log methods
of the App object.

<OL><P><LI>From the File menu, click Make AppMessage.DLL. Select a folder in which
   to place the DLL, and click OK.

<P><LI>From the File menu, click New project. Click Yes to Save the AppMessage
   source code for later use.

<P><LI>Select Standard EXE. Click OK.

<P><LI>From the Project menu, click References.

<P><LI>Turn on the reference to "AppMessages." Click OK.

<P><LI>To Form1, add the following code:
<P>
<P><PRE>       Private Sub Form_Load()
<PRE></PRE>           Dim t As New AppMessages.Logging
           t.StartLog "C:\TEMP\Test.log", mLogToFile
           t.AddLogEvent "Form Loaded", vbLogEventTypeInformation
           Set t = Nothing
       End Sub

</PRE><P><LI>From the Run menu, click Start. A new file "Test.log" will be created
   and placed into the C:\TEMP folder. This file will contain the
   information:
<P>
   "Information Application C:\TEMP\Test.log: Thread ID: -316429 ,Logged:
   Form Loaded"
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Visual Basic 5.0 Online Help
"StartLogging Method"
"LogEvent Method"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: limit limitation<BR>
Keywords            : kbusage vb5all vb5howto VBKBAX kbhowto<BR>
Technology          : kbole<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
