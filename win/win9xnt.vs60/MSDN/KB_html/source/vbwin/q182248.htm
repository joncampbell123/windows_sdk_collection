

<HTML>
<HEAD>
<TITLE>HOWTO: Use DCOM Config (DCOMCNFG.EXE) with Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182248">
<META NAME="KBModify" CONTENT="1998/03/10">
<META NAME="KBCreate" CONTENT="1998/03/09">
<META NAME="Keywords" CONTENT="vb5all vb5howto VBKBDCOM VBKBRegistry">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  DCOMCNFG.EXE (known as DCOM Config) is a utility that can be used to secure distributed COM (DCOM) objects that have been created.  Because security is much more advanced on Windows NT, the options differ on Windows NT systems. This article, writte...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABA,QAPN,QDK6,QAK7,QAAD,QAI5,QAJH,QBWG,QBWQ,QAW6,QDL9,QBW7,QBWO,QBWN,QARP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Use DCOM Config (DCOMCNFG.EXE) with Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182248</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
DCOMCNFG.EXE (known as DCOM Config) is a utility that can be used to secure
distributed COM (DCOM) objects that have been created.
<P>
Because security is much more advanced on Windows NT, the options differ on
Windows NT systems. This article, written for those running DCOM Config on
Windows 95 systems, describes the options and settings in DCOM Config.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DCOM Config's main window is divided into three tabs:

<OL><P><LI>Applications Tab.

<P><LI>Default Properties Tab.

<P><LI>Default Security Tab.
<P>
</OL>The following explains each tab in DCOM Config, beginning with the
Applications tab.
<P>
<P><h3>Applications Tab</h3>
 
<P>
The Applications tab shows each of the items registered under the following
registry key:
<P>
<PRE>   HKEY_CLASSES_ROOT\AppId\

</PRE></OL>Beneath this key are all of the objects that can be launched on a remote
machine. DCOM Config displays just the ProgIDs (friendly names) of each
object, such as "Microsoft Word Document" or "Microsoft Access Database."
Some objects may register without registering a ProgID; in these cases, the
GUID of the object will be displayed, such as "{4E6B942A-01B0-11D1-A9CB-
00AA00B7B36F}."
<P>
Properties for each application listed in the Applications tab can be
viewed either by selecting an item and choosing the "Properties" button, or
by double-clicking the application name.
<P>
<P><h3>Default Properties Tab</h3>
 
<P>
Each of the values displayed under the Default Properties tab may be found
under the following key in the registry:
<P>
<PRE>   HKEY_LOCAL_MACHINE\Software\Microsoft\OLE

</PRE>The first item in the Default Properties tab is a check box:
<P>
<PRE>   "Enable Distributed COM on this computer"

</PRE>This is a global setting for the entire machine. When this option is
checked, the machine allows the creation of DCOM objects. If it is not
checked, no objects may be created via DCOM.
<P>
NOTE: You must reboot the system in order for a change in this setting to
take effect.
<P>
The second part of the Default Properties tab is the Default Distributed
COM Communication properties, which consists of two parts:

<OL><P><LI>Default Authentication Level

<P><LI>Default Impersonation Level
<P>
</OL>These two options can only be modified if DCOM is enabled on this system.

<OL><P><LI>Default Authentication Level
<P>
</OL>Authentication Levels are as follows:
<P>
<PRE>Name                         Description

</PRE></OL> 
<P>
<PRE>None                         No authentication.

Connect                      Authentication occurs when a connection
                             is made to the server. Connectionless
                             protocols do not use this.

</PRE>Unlike Windows NT, Windows 95 machines can only accept calls on the 'None'
or 'Connect' levels.

<OL><P><LI>Default Impersonation Level
<P>
</OL>If no security is set at the object level, the server uses the security
setting specified here as the default. The possible values are:
<P>
<PRE>Name                         Description

</PRE></OL> 
<P>
<PRE>Identify                     The server can impersonate the client to
                             check permissions in the ACL (Access Control
                             List) but cannot access system objects.

Impersonate                  The server can impersonate the client and
                             access system objects on the client's behalf.

</PRE>The last item on the Default Properties tab is a check box:
<P>
<PRE>    "Provide additional security for reference tracking"

</PRE>This tells the server to track connected client applications by keeping an
additional reference count. Checking this box uses more memory and may slow
down COM, but it ensures that a client application cannot kill a server
process by artificially forcing a reference count to zero.
<P>
<P><h3>Default Security Tab</h3>
 
<P>
On Windows 95 machines, there is an option under the Default Security tab
for Default Access Permission. The value displayed here may be found in the
Windows registry at the following location:
<P>
<PRE>   HKEY_LOCAL_MACHINE\Software\Microsoft\OLE

</PRE>Default Access Permission - This value determines the users who can access
an object when no other access permissions are provided. For information on
how to give individual access permissions to specific DCOM objects, see the
"Application Properties" section later in this document.
<P>
An additional option under the Default Security tab is "Enable remote
connection." This option must be selected in order to enable remote
connections to DCOM Servers running on Windows 95. The value is stored as a
Yes or No value in the Windows registry at the following location:
<P>
<PRE>   HKEY_LOCAL_MACHINE\Software\Microsoft\OLE\EnableRemoteConnect


</PRE><h3>Application Properties</h3>
 
<P>
You may specify custom settings for individual DCOM applications by
choosing the Properties button on the "Applications" tab in DCOM Config.
This section describes each tab (General, Location, and Security) and
setting found within Application Properties.
<P>
<P><h3>General</h3>
 
<P>
The General tab provides general information about the application. This
tab displays the Application name, type (local server or remote server),
and location (local path or remote computer). These settings are not
modifiable through the DCOM Config interface.
<P>
The General Tab retrieves all of its information from subkeys of the
following registry key:
<P>
<PRE>   HKEY_CLASSES_ROOT\CLSID\{...CLSID...}


</PRE>where {...CLSID...} is the unique CLSID for the Object Server currently
being viewed.
<P>
<P><h3>Location</h3>
 
<P>
This tab is used to determine where DCOM will execute the application.
There are three possible choices:

<OL><P><LI>Run application on the computer where the data is located - If selected,
   DCOM will execute the application where the data is located. This is
   useful only if the application provides a data file for the server
   application.

<P><LI>Run application on this computer - Indicates that the DCOM application
   should run on the local machine.

<P><LI>Run application on the following computer - Allows you to specify a
   computer to execute on. This option should only be selected on DCOM
   Client machines to specify where the DCOM server is located. For DCOM
   Servers this option will not work as expected, Windows 95 machines
   cannot delegate an application to execute on a different machine
<P>
</OL><h3>Security</h3>
 
<P>
On this tab, you may customize settings for individual application
permissions. This tab is only available for objects capable of performing
as DCOM Servers. You may customize the settings for the following
permissions:

<UL><LI>Use default access permissions.

<LI>Use custom access permissions.
<P>
</UL>With custom access permissions, you may specify individual users who may
access the application. If you do not choose to use custom access
permissions, the default security settings are used. For more information
about the Security tab see the "Default Security" section earlier in this
article.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../oleprog/q158508.htm">Q158508</A></B>
   TITLE     : INFO: COM Security Frequently Asked Questions

   ARTICLE-ID: <B><A href="../vbwin/q165101.htm">Q165101</A></B>
   TITLE     : HOWTO: Use Win95 as a DCOM Server

   ARTICLE-ID: <B><A href="../vbwin/q176799.htm">Q176799</A></B>
   TITLE     : INFO: Use DCOM Config (DCOMCNFG.EXE) on Windows NT
</PRE></OL> 
<PRE>Keywords          : vb5all vb5howto VBKBDCOM VBKBRegistry
Version           : WINDOWS:5.0
Platform          : Win95 WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
