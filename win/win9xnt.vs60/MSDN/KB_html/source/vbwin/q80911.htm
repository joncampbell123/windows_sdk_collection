

<HTML>
<HEAD>
<TITLE>PRB: Grid Custom Control: LeftCol/TopRow Valid Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80911 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/02/20">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The LeftCol and TopRow grid properties control the position of the scrollable region of a Grid custom control. When you attempt to set the LeftCol or TopRow grid properties to display the lower right region of a grid, you may receive the error  Inv...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QARR,QAKD,QBS0,QAKC,QAB5,QAUY,QAPN,QAMN,QAUR,QA7O,QAOE,QBC6,QAAP,QAB4,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Grid Custom Control: LeftCol/TopRow Valid Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80911 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  versions 2.0 and 3.0
</PRE>- Microsoft Professional Toolkit for Microsoft Visual Basic programming
<PRE>  system for Windows, version 1.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The LeftCol and TopRow grid properties control the position of the
scrollable region of a Grid custom control. When you attempt to set
the LeftCol or TopRow grid properties to display the lower right
region of a grid, you may receive the error "Invalid Column Value"
(30010) or "Invalid Row Value" (30009), respectively.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The example given below in the More Information section shows how to
determine the range of values that do not give errors.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A program can determine the maximum values allowed for LeftCol and
TopRow by setting these properties to each valid column and row
number, respectively, and then determining if the assignment caused an
error. The example code below shows how to use this method.
<P>
The minimum values allowed for LeftCol and TopRow are always given by
the values of the Grid custom control properties FixedCols and FixedRows,
respectively.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>From the File menu, choose Add File, and select the GRID.VBX custom
   control file. The Grid tool will appear in the Toolbox.

<P><LI>Select the Grid tool from the Toolbox, and add a grid (Grid1) to Form1.

<P><LI>Size the Grid and choose values for the Cols and Rows properties of
   the Grid.

<P><LI>Place a command button (Command1) on Form1.

<P><LI>Enter the following code in the Command1_Click event procedure:
<P>
<PRE>   ' Example of how to call Grid_Scroll_Range to determine the
   ' range of values for Grid properties LeftCol and TopRow.
   Sub Command1_Click ()
      Dim msg As String          ' message string
      Dim max_LeftCol As Single  ' maximum LeftCol
      Dim max_TopRow As Single   ' maximum TopRow

      Call grid_scroll_range(grid1, max_LeftCol, max_TopRow)

      msg = "Valid Grid.LeftCol: "
      msg = msg + Format$(grid1.FixedCols) + ".."
      msg = msg + Format$(max_LeftCol) + Chr$(13) + Chr$(10)
      msg = msg + "Valid Grid.TopRow: "
      msg = msg + Format$(grid1.FixedRows) + ".."
      msg = msg + Format$(max_TopRow)

      MsgBox msg
   End Sub

</PRE><P><LI>Enter the following code in the general Declarations section:
<P>
<PRE>   ' grid_scroll_range
   '   Determines the maximum values allowable for grid LeftCol
   '   and TopRow. Minimum values are FixedCols and FixedRows.
   '   Parameters:
   '       grid    -- a Grid control
   '       LftMax  -- return value, maximum LeftCol value
   '       TopMax  -- return value, maximum TopRow value
   '
   Sub grid_scroll_range (grid As Control, LftMax!, TopMax!)
      Dim save As Integer     ' for restoring grid properties

      ' Calculate LftMax
      ' Try each column number to see if it causes a run-time
      ' error. Go in reverse order to minimize the number of
      ' tries to the number of columns displayed in the grid.
      save = grid.LeftCol
      On Error Resume Next
      For LftMax = grid.Cols - 1 To grid.FixedCols + 1 Step -1
         Err = 0
         grid.LeftCol = LftMax
         If Err = 0 Then
            Exit For
         End If
      Next
      grid.LeftCol = save

      ' Calculate TopMax
      ' Try each row number to see if it causes a run-time
      ' error. Go in reverse order to minimize the number of
      ' tries to the number of rows displayed in the grid.
      save = grid.TopRow
      On Error Resume Next
      For TopMax = grid.Rows - 1 To grid.FixedRows + 1 Step -1
         Err = 0
         grid.TopRow = TopMax
         If Err = 0 Then
            Exit For
         End If
      Next
      grid.TopRow = save
   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
