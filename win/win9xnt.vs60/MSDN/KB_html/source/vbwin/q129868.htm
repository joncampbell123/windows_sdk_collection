

<HTML>
<HEAD>
<TITLE>How to Pass a UDT to an OLE Automation Server in VB 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129868">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbole kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows by example how to pass a user-defined type (UDT) to an OLE Automation server in Visual Basic version 4.0.  MORE INFORMATION  A UDT cannot be passed to a public member function of an OLE Automation Server. This behavior is by desi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAD7,QAH7,QAH6,QAH4,QA9Q,QA2K,QBJZ,QAFF,QAUJ,QAIJ,QAMA,QBWS,QBXS,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Pass a UDT to an OLE Automation Server in VB 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129868</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to pass a user-defined type (UDT) to an
OLE Automation server in Visual Basic version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A UDT cannot be passed to a public member function of an OLE Automation
Server. This behavior is by design. However, it is possible to pass a UDT
to a private member function or to declare a private variable of a user
defined type within a class module. But because these are private, they
cannot be accessed directly by an OLE Automation Controller or Client.
Therefore, you need to pass each field of the UDT, element by element, or
create a class with public variables corresponding to each field of the
UDT.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
There are two parts to this example - creating the OLE Automation
Server and creating the OLE Automation Controller.
<P>
<P><h3>Part One: Create the OLE Automation Server</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Choose Class Module from the Insert menu. Class1 is created by default.

<P><LI>Add the following code to the General Declarations section of Class1:
<P>
   Private Type UDT
<P><PRE>      age As Integer
      name As String
</PRE>   End Type
<P>
   Private ClassUDT As UDT
<P>
   Public Sub GetUDTFields(age As Integer, name As String)
<P><PRE>      ClassUDT.age = age
      ClassUDT.name = name
<PRE></PRE>   End Sub

   Public Sub DispalyClassUDT()
   MsgBox "Hi! My Name is " &amp; ClassUDT.name &amp; ". I am " &amp; _
      ClassUDT.age &amp; " years old"
   End Sub

</PRE><P><LI>Set the following properties for Class1:
<P>
<PRE>   Properties     Value
   -------------------------------------
   Instancing     2 - Creatable MultiUse
   Name           Class1
   Public         True

</PRE><P><LI>Choose Module from the Insert menu. Module1 is created by default.

<P><LI>Add the following code to the General Declarations section of Module1:
<P>
<PRE>   Sub main()

   End Sub

</PRE><P><LI>Choose Options from the Tools menu, and in the Project Options, select
<PRE>   Sub Main as the Startup Form and OLE Server as the StartMode.

</PRE><P><LI>The OLE Automation server is now ready. Press the F5 key to run the
   program, and then minimize it.
<P>
</OL><h3>Part Two: Create the OLE Automation Controller</h3>
 

<OL><P><LI>Start a new instance of Visual Basic.

<P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the General Declarations section of Form1:
<P>
   Private Type UDT
<P><PRE>      age As Integer
      name As String
</PRE>   End Type

<P><LI>Add the following code to the Form_Click event of Form1:
<P>
   Dim x As Object
   Dim MyUDT As UDT
<P>
   MyUDT.age = 25
   MyUDT.name = "Joe"
   Set x = CreateObject("Project1.Class1")
   x.GetUDTFields MyUDT.age, MyUDT.name
   x.DispalyClassUDT

<P><LI>Press the F5 key to run the program. Click Form1. A message box will
   display the fields of the UDT passed element-by-element to the OLE
   Automation server.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbole kbcode<BR>
KBSubcategory: IAPOLE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
