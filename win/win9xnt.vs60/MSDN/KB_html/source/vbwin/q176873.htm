

<HTML>
<HEAD>
<TITLE>BUG: DBCombo Does Not Display the "&amp;" Character Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176873">
<META NAME="KBModify" CONTENT="1997/11/19">
<META NAME="KBCreate" CONTENT="1997/11/17">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If a DBCombo control contains items with the ampersand (*) character as part of the text and if the style of the DBCombo control is dbcDropdownList, then the text will not display correctly in the text box portion (the edit area) of the control. Th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATX,QA7O,QBS0,QAB5,QAOE,QAMN,QAMB,QBVV,QBFY,QABA,QBT6,QBV4,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: DBCombo Does Not Display the "&amp;" Character Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176873</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a DBCombo control contains items with the ampersand (&amp;) character as
part of the text and if the style of the DBCombo control is
dbcDropdownList, then the text will not display correctly in the text box
portion (the edit area) of the control. The drop-down list area is not
affected.
<P>
This problem does not occur with the styles dbcDropdownCombo or
dbcSimpleCombo.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, simply modify the text to include an extra "&amp;"
for every "&amp;" that is in the original text as shown in the following code:
<P>
<PRE>   Private Sub DBCombo1_Click(Area As Integer)
   Dim i As Integer
   Dim s As String
   Dim c As String * 1

       If DBCombo1.Style = dbcDropdownList And Area = dbcAreaList Then
           s = DBCombo1.Text
           If InStr(s, "&amp;") Then
               DBCombo1.Text = ""
               For i = 1 To Len(s)
                   c = Mid$(s, i, 1)
                   If c = "&amp;" Then
                       DBCombo1.Text = DBCombo1.Text &amp; "&amp;&amp;"
                   Else
                       DBCombo1.Text = DBCombo1.Text &amp; c
                   End If
               Next
           End If
       End If

   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a sample MDB (db1.mdb) and add one table (Table1) with one text
   field (Field1). Add the record "&amp;one &amp;&amp;two &amp;&amp;&amp;three" to Table1.

<P><LI>Start Visual Basic and create a new Standard EXE. Form1 is created by
   default.

<P><LI>Add a Data control to Form1 and set the following properties:
<P>
<P><PRE>      DatabaseName = "db1.mdb"
      RecordSource = "Table1"
</PRE>
<P><LI>Add a DBCombo control to Form1 and set the following properties:
<P>
<P><PRE>      RowSource = "Data1"
      ListField = "Field1"
      Style = "2 - dbcDropdownList"
</PRE>
<P><LI>Run the project.

<P><LI>Click the button on DBCombo1 and select the item from the list.
</OL> 
<PRE>Keywords          : vb5all
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
