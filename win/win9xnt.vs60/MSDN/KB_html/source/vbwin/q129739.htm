

<HTML>
<HEAD>
<TITLE>How to Determine If VB 4.0 App Was Launched as OLE Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129739">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/05/03">
<META NAME="Keywords" CONTENT="kbole kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how to use the StartMode Property of the Visual Basic App object to determine whether an application started as a stand-alone project or as an OLE Automation object application.  MORE INFORMATION  If the StartMode property ha...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAIJ,QBWS,QAJH,QBXS,QAPN,QA9Q,QBJZ,QAJN,QA01,QA2K,QAY2,QABA,QAH4,QAW6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Determine If VB 4.0 App Was Launched as OLE Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129739</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to use the StartMode Property of the Visual
Basic App object to determine whether an application started as a
stand-alone project or as an OLE Automation object application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the StartMode property has a value of vbSModeStandalone (or 0), it means
that the application started as a stand-alone project. That is, the user
started the .EXE from File Manager or by double-clicking the icon from
Program Manager.
<P>
If the StartMode property has a value of vbSModeAutomation (or 1), it means
that the application started as an OLE Automation object application. That
is, the .EXE started because an OLE Automation client called CreateObject.
<P>
These constants are listed in the Visual Basic object library in the Object
Browser.
<P>
At design time, you can debug an application as if it were started as an
OLE Automation object application by setting StartMode in the Project
Options dialog box to 1 (vbSModeAutomation) by selecting the OLEServer
option button. But a project's actual StartMode setting is determined by
how that application is started at run time, not by its nominal setting in
the Project Options dialog box when you create an executable (.EXE) file.
<P>
When StartMode is set to 1 and there are no public classes in the project,
you must use the End statement or choose End from the Run menu or toolbar
to end the application. If you choose Close from the Control menu, the form
closes but the project is still running.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a new Module to the project by choosing Module from the Insert menu.
   Module1 is created by default.

<P><LI>Copy the following code, and Paste it into the General Declarations
   portion of Module1:
<P>
   Public Sub main()
<P><PRE>      If App.StartMode = vbSModeStandalone Then
<PRE></PRE>         MsgBox "Application being started as a stand alone EXE!"
      Else
         MsgBox "Application being started as an OLE Automation server!"
      End If
   End Sub

</PRE><P><LI>In the Project Options dialog box (Choose Options from the Tools menu
   and then select the Project tab), choose Sub Main as the startup form
   and choose OLEServer as the startmode.

<P><LI>Press the F5 key to run the program. A message box will tell you that
   the application was started as an OLE Automation server.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbole kbprg kbcode<BR>
KBSubcategory: IAPOLE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
