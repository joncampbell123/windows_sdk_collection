

<HTML>
<HEAD>
<TITLE>How to Cancel an Asynchronous Query--RDO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142925">
<META NAME="KBModify" CONTENT="1996/06/21">
<META NAME="KBCreate" CONTENT="1996/01/22">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  After executing an asynchronous query with the OpenResultset method, program control will continue to the next line of code while the query is executing.  Later in your code, you can decide to cancel the asynchronous query by using the Cancel metho...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QAGC,QBS0,QABM,QAH4,QAPN,QAMB,QATX,QAIJ,QAFF,QBWS,QANF,QAPF,QBV8,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Cancel an Asynchronous Query--RDO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142925</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Enterprise Edition of Microsoft Visual Basic, version 4.0, for
<PRE>  Windows
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
After executing an asynchronous query with the OpenResultset method,
program control will continue to the next line of code while the query is
executing.
<P>
Later in your code, you can decide to cancel the asynchronous query by
using the Cancel method of the rdoResultset.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Program</h3>
 
<P>
This example assumes that you already have an ODBC database server
available and that you have an SQL query that will run long enough to make
a cancel operation practical. This example uses a "DSN-less" ODBC
connection so you will not need to set up a DSN with the ODBC Admin
utility.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add two command buttons to Form1. Change the caption property of
   Command1 to Begin and the caption property of Commmand2 to Cancel.

<P><LI>Paste the following code into the General Declarations section of form1.
<P>
   Option Explicit
   Dim cn As rdoConnection
   Dim en As rdoEnvironment
   Dim rs As rdoResultset
<P>
<PRE>   Private Sub Form_Load()
     Command1.Enabled = True
     Command2.Enabled = False
     'establish connection
     Set en = rdoEngine.rdoEnvironments(0)
     en.CursorDriver = rdUseOdbc
     'this should be modified to connect to your database
     Dim cnStr As String
     cnStr = "driver={SQL Server};server=mysvr;" &amp; _
       "database=pubs;uid=myuid;pwd=mypwd"
     Set cn = en.OpenConnection(dsname:="", Prompt:=rdDriverNoPrompt, _
        Connect:=cnStr)
   End Sub

   Private Sub Command1_Click()
     Dim sql As String
     'Change this to an SQL statement that takes at least a few
     'seconds to finish, such as a Cartesian join or a text
     'column search i.e. Where textcolumn Like '*find this text*'
     sql = "Select title From Titles"
     Command1.Enabled = False
     Command2.Enabled = True
     Set rs = cn.OpenResultset(Name:=sql, Type:=rdOpenStatic, _
       Option:=rdAsyncEnable)
     While rs.StillExecuting
       DoEvents  ' allow user to click on Cancel command button
     Wend
     Command1.Enabled = True
     Command2.Enabled = False
   End Sub

   Private Sub Command2_Click()
     rs.Cancel
   End Sub

</PRE><P><LI>Note that you will need to change your DRIVER, SERVER, DATABASE, UID,
   and PWD in the OpenConnection function contained in the Form_Load event.
   You will also need to modify the SQL statement contained in the
   Command1_Click event to match your own SQL data source and to be complex
   enough to make this example a practical use of the cancel operation. A
   good example is a Cartesian join or a text column search:
<P>
   Select * from mytable Where textcolumn Like '*find this text*'

<P><LI>Start the program or press the F5 key.

<P><LI>You can then click on the Begin Command button to start the query and
   the Cancel Command button to cancel the currently running query while it
   is in operation.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
<PRE>   (Hitchhiker's Guide to Visual Basic and SQL Server, Microsoft Press.
   ISBN: 1-55615-906-4.).
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win<BR>
KBCategory: kbprg<BR>
KBSubcategory: APrgOther APrgDataODBC<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
