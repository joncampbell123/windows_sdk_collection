

<HTML>
<HEAD>
<TITLE>BUG: Printer Object Font Information is Lost After Printing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153125">
<META NAME="KBModify" CONTENT="1997/07/09">
<META NAME="KBCreate" CONTENT="1996/06/28">
<META NAME="Keywords" CONTENT="kbprint PrgOther vb4all vb4win kbbug">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The printer object loses all of its font information, including font size, boldness, underlining, etc., after an initial call to Printer.Print has been made.  CAUSE =====  This problem occurs because of the way the Windows 95 and NT printer drivers...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QACT,QADF,QBS0,QAPN,QBXS,QAYY,QAW6,QAKJ,QABA,QAVX,QAVW,QAKP,QAJX,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Printer Object Font Information is Lost After Printing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153125</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The printer object loses all of its font information, including font size,
boldness, underlining, etc., after an initial call to Printer.Print has
been made.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because of the way the Windows 95 and NT printer
drivers work. They require applications to re-send printer settings for
each page. Visual Basic 4.0 does not automatically do this.
<P>
This behavior is described in the article mentioned in the REFERENCES
section below.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, add the following statements to the beginning
of the Command1_Click procedure, as shown in the following example:
<P>
<PRE>   Sub Command1_click()
     Dim PrinterFont As String   '*
     Printer.Print ""            '* Initialize printer object's device
                                 '* context
     PrinterFont = Printer.Font  '* Retrieve current font name
     Printer.Font = ""           '* Clear current font details
     Printer.Font = PrinterFont  '* Reset font information
     Printer.fontsize = 36
     Printer.fontbold = true
     Printer.fontitalic = true
     Printer.fontunderline = true
     Printer.print "This is a test"
     Printer.enddoc
   End Sub

</PRE>Each time the CommandButton is pressed, the output should print correctly.
<P>
Starting a new page will also reset the Printer's font information to its
defaults, so you will need to reset the printer after each NewPage method.
Page level Information, such as orientation, will not need to be reset.
<P>
<PRE>  ' If you have additional pages, use this syntax:

  Printer.NewPage
  Printer.Print ""     '* Reinitialize printer object's device
  Printer.Font = ""    '* Clear current font details
  Printer.Font = PrinterFont '* Reset font information
  Printer.FontSize = 36
  Printer.CurrentY = 0    '* Reset to the top of the new page
  Printer.Print "This is page two"
  Printer.EndDoc

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic with a New Project.

<P><LI>Add a CommandButton to the form.

<P><LI>Add the following code to the Click event of the CommandButton:
<P>
<PRE>      Sub Command1_click()
         Printer.Fontsize = 36
         Printer.Fontbold = true
         Printer.Fontitalic = true
         Printer.Fontunderline = true
         Printer.Frint "This is a test"
         Printer.Fnddoc
      End Sub

</PRE><P><LI>Run this program and press the CommandButton. The output should have
   printed correctly.

<P><LI>Press the CommandButton again. This time the output will have
   lost all of its font attributes.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win32sdk/q125696.htm">Q125696</A></B>
   TITLE     : StartPage/EndPage Resets Printer DC Attributes in Windows95
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprint PrgOther vb4all vb4win kbbug<BR>
Version             : 4.0<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
