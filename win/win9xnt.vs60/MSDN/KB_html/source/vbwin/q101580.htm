

<HTML>
<HEAD>
<TITLE>PRB: File Not Found Error When Running .EXE on Other Computer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101580">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/07/19">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you try to use the IIf function in Visual Basic version 3.0 for Windows, you receive a  File Not Found  error when you try to run your executable program on a separate computer that does not contain the file MSAFINX.DLL.  CAUSE ===== The  File...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVV,QAAP,QAB4,QAY5,QBT6,QBV4,QBWS,QAH4,QAHP,QAB9,QDNN,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: File Not Found Error When Running .EXE on Other Computer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101580</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional and Standard Editions of Microsoft Visual Basic
<PRE>  Programming System for Windows, version 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to use the IIf function in Visual Basic version 3.0 for
Windows, you receive a "File Not Found" error when you try to run your
executable program on a separate computer that does not contain the file
MSAFINX.DLL.
<P>
<P><h2>CAUSE</h2>
 
The "File Not Found" error occurs because the IIf function is not included
in VBRUN300.DLL file but is located in the MSAFINX.DLL file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent the error, install the MSAFINX.DLL file on the customer's
computer in the \WINDOWS\SYSTEM subdirectory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Below is a list of all the financial functions in the MSAFINX.DLL file:
<P>
<PRE>DDB          FV           IPMT         IRR          MIRR
NPER         NPV          PMT          PPMT         PV
RATE         SLN          SYD

</PRE>Below is a list of all the date functions in the MSAFINX.DLL file:
<P>
<PRE>DATE         DATE$        DATEADD      DATECREATED  DATEDIFF
DATEPART     DATESERIAL   DATEVALUE    DAVG         DAY

</PRE>Below is a list of the other functions in the MSAFINX.DLL:
<P>
<PRE>IIF          PARTITION

</PRE>A "File Not Found" error occurs if you use any of the these functions in
your program and then use the program on a computer that does not contain
the MSAFINX.DLL file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following steps cause the "File Not Found" error in Visual Basic
version 3.00 for Windows.

<OL><P><LI>Start Visual Basic (VB.EXE).

<P><LI>Add a text box (Text1) and a label (Label1) to Form1.

<P><LI>Enter the line of code on page 274 in the Language Reference manual:
<P>
<PRE>   Sub Label1_Click ( )
      Label1.Caption = IIf(Val(text1.text) &gt; 1000, "Large", "Small")
      '*** note you may want to add the Val statement for numbers
   End Sub

</PRE><P><LI>Run the example and enter a number in the Text1 text box. Then click
   Label1 to see if the example works in the environment.

<P><LI>From the File menu, choose Make Exe File... Name the executable
   IIFTEST.EXE. Save the project as IIFTEST.MAK, and save the form as
   IIFTEST.FRM.

<P><LI>Copy the IIFTEST.EXE and VBRUN300.DLL files to a floppy disk.

<P><LI>Take the floppy disk to a computer that does not have Visual Basic
   version 3.0 installed. Try and run the IIFTEST.EXE file from File
   Manager on that computer. You should get the "File Not Found" error.

<P><LI>If you add the file MSAFINX.DLL to the floppy disk, and then run
   the IIFTEST.EXE file, no error will occur.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
