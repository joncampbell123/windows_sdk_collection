

<HTML>
<HEAD>
<TITLE>VB3 Display Multiple Foreground Text Colors in VB List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108811">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1993/12/19">
<META NAME="Keywords" CONTENT="kbprg kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  To set the foreground and background color of a list box control, set the ForeColor and BackColor properties at either design time or run time. All text in a list box uses the color set by the ForeColor property. The text is printed against a backg...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAB5,QA7O,QAMN,QAOE,QAG9,QBS0,QAPG,QDL9,QBWO,QBWN,QATX,QAMB,QAPN,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 Display Multiple Foreground Text Colors in VB List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108811</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To set the foreground and background color of a list box control, set the
ForeColor and BackColor properties at either design time or run time. All
text in a list box uses the color set by the ForeColor property. The text
is printed against a background color set by the BackColor property.
<P>
Visual Basic doesn't directly support the display of text of different
colors simultaneously in the list box. This article describes how to
display words of different colors simultaneously in a list box by using an
indirect technique.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can display lines or words of different colors simultaneously in a
list box by using one of the following indirect techniques.

<OL><P><LI>Simulate the list box with a picture box control. You can store the
   desired text strings in an array of strings, and use the Print
   method to write the array entries into the picture box with different
   ForeColor properties. For example:
<P>
<P><PRE>      picture1.BackColor = QBColor(14)  ' 14=Light yellow
<PRE></PRE>      picture1.ForeColor = QBColor(4)   '  4=Red
      picture1.Print "in living red"
      picture1.ForeColor = QBColor(2)   '  2=Green
      picture1.Print "in living green"

   You can also add a vertical scroll bar next to the picture box. When the
   scroll bar is scrolled, your code needs to redraw the picture box. The
   ForeColor property of the picture box controls the current color used
   by the Print method. The picture box will not let you highlight text.
   NOTE: The BackColor method erases any pre-existing text on the picture
   control.

</PRE><P><LI>For coloring list box entries with multiple foreground colors, the
   Desaware company provides two solutions:
<P>
   a. The MLIST2.VBX control file is included with the Custom Control
<P><PRE>      Factory product from Desaware. MLIST2.VBX allows each line in a list
      box to be colored independently. All words on the same line must be
      the same color. MLIST2.VBX comes with full source code.
</PRE><P>
   b. A more flexible and advanced solution is to turn Visual Basic's list
<P><PRE>      box into an owner-draw list box. Desaware says that you can make true
      owner-draw list boxes with their SpyWorks-VB product. SpyWorks-VB
      allows you to color each entry of the list box with the full power of
      the Windows API drawing functions. SpyWorks-VB comes with sample
      source code for an owner-draw list box and command button, along with
      explanations of how to turn the standard controls into owner-draw
      controls. See the section on owner-draw controls further below.
</PRE><P>
</OL><h3>How to Contact Desaware</h3>
 
<P>
NOTE: Desaware products are manufactured independent of Microsoft.
Microsoft makes no warranty, implied or otherwise, regarding these
products' performance or reliability.
<P>
Desaware
5 Town &amp; Country Village #790
San Jose, CA  95128
Contact:  Dan Appleman (408) 377-4770
Fax: (408) 371-3530
<P>
The Desaware company offers the following products:

<OL><P><LI>Custom Control Factory -- an interactive development tool for creating
   custom controls including Animated Pushbuttons, Multistate Buttons,
   enhanced buttons, check box, and option button controls for Windows
   applications.

<P><LI>CCF-Cursors -- provides you with complete control over cursors (mouse
   pointers) in Visual Basic applications. Create your own cursors or
   convert icons to cursors, and much more. Includes over 50 cursors.

<P><LI>SpyWorks-VB -- an advanced development tool for use with Visual Basic.
<P>
</OL><h3>Owner-Draw Controls in Windows</h3>
 
<P>
The owner-draw list capability is appropriate for advanced programmers
for Microsoft Windows. You will need a good reference for the Windows
API to learn the required drawing functions.
<P>
Owner-draw controls were introduced in Windows version 3.0. Because your
application does all the drawing of the contents of the controls, you
can customize them any way you like. Owner-draw controls are similar to
predefined controls in that Windows will handle the control's
functionality and mouse and keyboard input processing. However, you are
responsible for drawing the owner-draw control in its normal, selected,
and focus states.
<P>
You can create owner-draw controls from the menu, button, and list-box
classes. You can create owner-draw combo boxes, but they must have the
CBS_DROPDOWNLIST style, which equates to a static text item and a list
box. The elements of an owner-draw control can be composed of strings,
bitmaps, lines, rectangles, and other drawing functions in any
combination, in your choice of colors.
<P>
<P><h2>REFERENCES</h2>
 

<UL><LI>"Microsoft Windows Programmer's Reference"
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kb3rdparty<BR>
KBSubcategory: PrgCtrlsCus PrgCtrlsStd PrgCtrlsThird<BR>
Additional reference words: 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
