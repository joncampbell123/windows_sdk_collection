

<HTML>
<HEAD>
<TITLE>BUG: Setting ComboBox Control Text in Click Event Wipes Out Text </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168824">
<META NAME="KBModify" CONTENT="1997/06/02">
<META NAME="KBCreate" CONTENT="1997/05/21">
<META NAME="Keywords" CONTENT="PrgCtrls vb5all VBKBCtrl VBKBInt VBKBStd">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When setting the ComboBox control Text property in the Click event of ComboBox control, the text always returns blank. This is different behavior than Visual Basic 3.0 and Visual Basic 4.0.  RESOLUTION  Instead of setting the Text property of the C...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHP,QBV3,QAMN,QA7O,QAOE,QAB5,QAFF,QBS0,QBXS,QAPN,QATX,QAMB,QABA,QBV4,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Setting ComboBox Control Text in Click Event Wipes Out Text</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168824</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When setting the ComboBox control Text property in the Click event of
ComboBox control, the text always returns blank. This is different behavior
than Visual Basic 3.0 and Visual Basic 4.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Instead of setting the Text property of the ComboBox control in the Click
event, do it at the LostFocus event by shifting the focus to another
control, such as TextBox, although it will leave the focus set to the
TextBox. To work around that, hide a TextBox behind the ComboBox with
TabStop property set to False; in the GotFocus event of the Textbox, set
the focus back to the ComboBox. To place a TextBox behind the ComboBox in
design time, choose the Send To Back menu command from the Format/Order
menu; in runtime, set the z-order of TextBox to 1.
<P>
The following code example shows how to keep the text of ComboBox control
after being set at the Click event:

<OL><P><LI>Start a new Standard EXE project. Form1 is created by default.

<P><LI>Add a TextBox control, Text1, to Form1.

<P><LI>Add a ComboBox control, Combo1, to Form1.

<P><LI>Place the following code into the General Declarations section of Form1:
<P>
<P><PRE>      Dim ClickFlag As Integer
</PRE><P>
<P><PRE>      Private Sub Combo1_Click()
<PRE></PRE>         ClickFlag = True
         Text1.SetFocus
      End Sub

      Private Sub Combo1_LostFocus()
         If ClickFlag = True Then
            Combo1.Text = Mid(Combo1.Text, 4)
            ClickFlag = False
         End If
      End Sub

      Private Sub Form_Load()
         ClickFlag = False
         With Combo1
             .AddItem "1. Adam"
             .AddItem "2. Bob"
             .AddItem "3. Charles"
         End With
         Combo1.Text = Mid(Combo1.List(0), 4)

         'Hide Text1 under Combo1
         Text1.Move Combo1.Left, Combo1.Top, Combo1.Width, Combo1.Height
         Text1.ZOrder (1)
         Text1.TabStop = False
      End Sub

      Private Sub Text1_GotFocus()
         Combo1.SetFocus
      End Sub

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new Standard EXE project. Form1 is created by default.

<P><LI>Add a ComboBox control, Combo1, to Form1.

<P><LI>Paste the following code into the General Declarations section of Form1:
<P>
<P><PRE>      Private Sub Combo1_Click()
<PRE></PRE>         Combo1.Text = Mid(Combo1.Text, 1, 3)
      End Sub

      Private Sub Form_Load()
        With Combo1
          .AddItem "1. Adam"
          .AddItem "2. Bob"
          .AddItem "3. Charles"
        End With
        Combo1.Text = Mid(Combo1.List(0), 4)
      End Sub

</PRE><P><LI>Start the program or press the F5 key.

<P><LI>Click one item of the ComboBox control dropdown list and note that the
   text portion of the ComboBox control is wiped out and becomes blank.
</OL>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by
Adrian Chiang, Microsoft Corporation
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : PrgCtrls vb5all VBKBCtrl VBKBInt VBKBStd<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
