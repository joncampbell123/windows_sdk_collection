

<HTML>
<HEAD>
<TITLE>PRB: Resizing OCX Does Not Resize Its Component Control(s) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161209">
<META NAME="KBModify" CONTENT="1997/03/21">
<META NAME="KBCreate" CONTENT="1996/12/18">
<META NAME="Keywords" CONTENT="kbgraphic kbprg vb5all VBKBAX VBKBComp VBKBGraphics kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When resizing your ActiveX control on a host form, the component controls or user-drawn graphics do not get resized.  CAUSE =====  You do not have logic in the Resize event of the UserControl object to resize the component control(s) to the new siz...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAMB,QAC2,QAPN,QAHV,QBS0,QAH4,QAFF,QAI4,QAJG,QBVV,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Resizing OCX Does Not Resize Its Component Control(s)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161209</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation and Enterprise Editions,
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When resizing your ActiveX control on a host form, the component controls
or user-drawn graphics do not get resized.
<P>
<P><h2>CAUSE</h2>
 
<P>
You do not have logic in the Resize event of the UserControl object to
resize the component control(s) to the new size, or in the Paint event of
the UserControl object to redraw the user-drawn graphics.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Add code to the UserControl's Resize and/or paint event to resize the
component control(s) and user-drawn graphics.
<P>
<P><h2>STATUS</h2>
 
<P>
This is behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Even though you may want to have various effects when the developer resizes
your ActiveX control, Visual Basic has no way of determining how to handle
resize issues of your component controls. You can place code in the
UserControl_Resize event to handle the resizing in whatever manner you
wish.
<P>
If your control has no component controls, the UserControl_Paint event
allows you to redraw the user-drawn graphics.
<P>
Several examples are included below. All code is in the UserControl object.
<P>
<P><h3>Resizing a Single Control</h3>
 
<P>
The control is resized to fill the entire UserControl by using the
following code:
<P>
<PRE>      Private Sub UserControl_Resize()
        Text1.Move 0, 0 , ScaleWidth, ScaleHeight
      End Sub

</PRE><h3>Resizing a Control and a Label Side-by-Side</h3>
 
<P>
The label occupies the leftmost 20% of the user control. The textbox
occupies the rightmost 75% of the user control. A 5% gap exists between
them, as shown here:
<P>
<PRE>      Private Sub UserControl_Resize()
        Label1.Move 0, 0 , ScaleWidth * .2, ScaleHeight
        Text1.Move ScaleWidth * .25, 0, ScaleWidth * .75, ScaleHeight
      End Sub

</PRE><h3>Resizing a Shape Control with a Label Drawn Part-Way Down</h3>
 
<P>
The shape control fills the entire UserControl. The label occupies the full
width and is drawn slightly above center as shown here:
<P>
<PRE>      Private Sub UserControl_Resize()
        Shape1.Move 0, 0 , ScaleWidth, ScaleHeight
        Label1.Move 0, (ScaleHeight - Label1.Height) * .4, ScaleWidth
      End Sub

</PRE>The height of the label is assumed not to change in this example. To change
label height to be 30% of the UserControl height, add the 4th argument to
the Move method:
<P>
<PRE>      Label1.Move 0, ScaleHeight * .28, ScaleWidth, ScaleHeight * .3

</PRE>The change of the second argument to ScaleHeight * .28 is obtained by
substituting ScaleHeight * .3 for Label1.Height, giving:
<P>
<PRE>      (ScaleHeight - ScaleHeight * .3) * .4
      (ScaleHeight * .7) * .4
      ScaleHeight * .28

</PRE><h3>Resizing User-Drawn Graphics</h3>
 
<P>
The code draws a border around the UserControl and puts an 'X' in it. The
ScaleMode needs to be in pixels for the border to paint correctly:
<P>
<PRE>      Private Sub UserControl_Paint()
        UserControl.ScaleMode = vbPixels
        UserControl.Line (0, 0)-(ScaleWidth - 1, ScaleHeight - 1), 0, B
        UserControl.Line (0, 0)-(ScaleWidth - 1, ScaleHeight - 1), 0
        UserControl.Line (0, ScaleHeight - 1)-(ScaleWidth - 1, 0), 0
      End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft Visual Basic User's Guide, Chapter 4, Creating an ActiveX
Control, Drawing the ShapeLabel Control
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbgraphic kbprg vb5all VBKBAX VBKBComp VBKBGraphics kbprb<BR>
Technology          : kbole<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
