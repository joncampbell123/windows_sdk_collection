

<HTML>
<HEAD>
<TITLE>Techniques for Diagnosing &amp; Resolving OLE Automation Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137029">
<META NAME="KBModify" CONTENT="1996/09/06">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="kbole kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Applications using OLE Automation may encounter either one of the following two errors:     429 - OLE Automation server can't create object    438 - OLE Automation no such property or method  This article presents some techniques for resolving thes...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAAP,QAB4,QA9Q,QAPN,QAH4,QAIH,QDL9,QBWQ,QBWO,QBWN,QA2K,QAEF,QBJZ,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Techniques for Diagnosing &amp; Resolving OLE Automation Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 6, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137029</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Applications using OLE Automation may encounter either one of the following
two errors:
<P>
<PRE>   429 - OLE Automation server can't create object
   438 - OLE Automation no such property or method

</PRE>This article presents some techniques for resolving these errors.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Error 429</h3>
 
<P>
Error 429 typically occurs during a CreateObject call. There are several
causes for this error:

<UL><LI>Low System Resources.
<LI>Corrupt or invalid OLE Registry.
<LI>Lost connection with the OLE server.
<P>
</UL><h3>Error 429: Low System Resources</h3>
 
<P>
Low system resources are a factor when CreateObject is used to load a
specified application that doesn't already exist in memory. You can check
system resources and memory at any time by clicking About Program Manager
on the Help menu of the Windows Program Manager.
<P>
To test memory if you get error 429 in your Visual Basic code, switch to
the Program Manager, and try to load the application. If you can't, you are
low on system resources or memory. If you can, there may be a problem with
either the syntax within CreateObject or with the registry.
<P>
<P><h3>Error 429: Corrupt or Invalid OLE Registry</h3>
 
<P>
If the OLE Registry is corrupted or invalid, you can use the following
steps to restore it:

<OL><P><LI>Exit windows. If you make these changes within Windows, they will be
   over-written. Windows stores the Registry in memory and writes it back
   out to disk when Windows exits.

<P><LI>Within the \Windows directory, make a copy of both Reg.dat and Win.ini
   files.

<P><LI>Delete the Reg.dat file.

<P><LI>Edit the Win.ini file, and remove the [Embedding] section.

<P><LI>Restart Windows. An empty Reg.dat file will be created.

<P><LI>Start File Manager. On the file menu, click Search, and find all files
   on your hard disk that have the .reg extension. That is, search for:
<P>
   *.reg

<P><LI>In the search results window, double-click the files that you want to
   add to the registry. You should, at minimum, double-click these files:
<P>
   Ole2.reg
   &lt;YourApp.reg&gt;
<P>
   Some applications will attempt to automatically re-register themselves
   on startup. The application will look for key entries in the registry;
   if none is found, the application will re-register itself. If the entry
   comes from a second application, this means the first application may
   not be properly registered. You may have to manually re-register each of
   your applications using the technique described in this step.

<P><LI>Retry your Visual Basic application.
<P>
</OL><h3>Error 429: Lost Connection with the OLE Server</h3>
 
<P>
Finally, the connection to an object may have been lost. The following code
can demonstrate how this can happen:
<P>
<PRE>   Dim LoadDC as Object
   Dim LoadWd as Object
   Set LoadDC = CreateObject( "Word.Document.Doc" )
   Set LoadWd = LoadDC.Application.WordBasic
   Set LoadDC = Nothing
   LoadWd.FileOpen ...

</PRE></OL>As it stands, this code may generate error 429. If the third line of code
setting LoadDC to nothing is removed or changed to a comment, it works.
<P>
<P><h3>Error 438</h3>
 
<P>
Error 438 can be generated when the OLE object created does not recognize
the method or property you are attempting to use. This could be something
as simple as a syntax error (the method or property you are trying to use
is misspelled in your code). Or it could be because the object's connection
is no longer available.
<P>
Consider the following scenario with OLE Automation between Visual Basic
and Microsoft Word:

<OL><P><LI>Start Microsoft Word, opening a specific document.

<P><LI>Print that document

<P><LI>Close the document by using FileClose.

<P><LI>Issue another Print command to the document.
<P>
</OL>This will generate error 438 because the link to the document was lost when
it was closed. The syntax for issuing the print is correct but the method
is no longer available because there is no document open within Word.
<P>
<P><h2>REFERENCES</h2>
 
<P>
The Office Developers Kit, currently shipping with Visual Basic, is an
excellent resource for demonstrating how to use OLE Automation effectively
with Visual Basic. It comes with a CD-ROM compact disc filled with
technical information and reference material, as well as numerous samples.
<P>
For more information on how to obtain the Office Developers Kit, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q92545.htm">Q92545</A></B>
   TITLE     : Visual Basic 3.0 Common Questions &amp; Answers
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbole kbtshoot<BR>
KBSubCategory: IAPOLE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 6, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
