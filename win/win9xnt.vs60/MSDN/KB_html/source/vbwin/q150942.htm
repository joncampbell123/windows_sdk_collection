

<HTML>
<HEAD>
<TITLE>PRB: ISAM Tuning Information Not Read From VB.INI </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150942">
<META NAME="KBModify" CONTENT="1996/08/08">
<META NAME="KBCreate" CONTENT="1996/05/13">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The ISAM tuning information is not automatically read from the VB.INI file in the design environment or the              .INI in the executable program.  When using Visual Basic 4.0 with one of the ISAM drivers, unexpected behavior or errors occur....">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVV,QABM,QAPN,QA0B,QAB4,QDKW,QBBI,QA5F,QAMA,QA7O,QAYY,QA1S,QDIZ,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ISAM Tuning Information Not Read From VB.INI</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 8, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150942</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The ISAM tuning information is not automatically read from the VB.INI file
in the design environment or the &lt;application&gt;.INI in the executable
program.
<P>
When using Visual Basic 4.0 with one of the ISAM drivers, unexpected
behavior or errors occur. For example, setting Deleted=on in the [dBase
ISAM] section of the VB.INI or &lt;application name&gt;.INI has no effect on the
visibility of deleted records. Also, when trying to connect to a Paradox
4.x table, Visual Basic gives the error message:
<P>
<PRE>   Can't open this Paradox 4.x table because ParadoxNetStyle is
   set to 3.x in.

</PRE>For developers working with Paradox 4.X tables, this means that their
applications cannot access those tables at design time. Specifically, right
clicking on a DBGrid and selecting "Retrieve Fields" will generate the
error message described above. Also, the DataField property of bound
controls will not be populated automatically. This means that the DataField
property cannot be filled by selecting from the drop-down list of fields in
the table. However, the field can still be entered at design time by typing
it in. If the DBEngine.IniPath property is correctly assigned and contains
the necessary information, the application will behave properly at run
time.
<P>
Both the 16-bit and 32-bit versions of the Visual Basic database engine
look for the [Installable ISAM] information, such as the [Paradox ISAM] and
[dbase ISAM] sections, in the system registry.
<P>
The 32-bit edition also looks for the ISAM tuning information in the system
registry. The 16-bit version does not.
<P>
The 16-bit edition looks for the ISAM tuning information in a specified INI
file. Unlike Visual Basic 3.0, it does not default to the VB.INI file or
&lt;application&gt;.INI file.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem in the 16-bit edition of Visual Basic, specify
an .INI file that contains the ISAM entries using the INIPath property of
the DBEngine object, and set all properties at run-time. For example:
<P>
<PRE>   Sub Form_Load ()

      'Do before any other references to DAO objects or data control.
      DBEngine.INIPath = "VB.INI"
      'All other code

   End Sub

</PRE>To work around this problem in the 32-bit edition of Visual Basic, specify
a Registry key such as:
<P>
<PRE>   ...\Engines\SomeISAM

</PRE>where SomeISAM = Xbase, Paradox, Excel, Text, or Lotus, and the ...
specifies any Registry key you specify.
<P>
Use the DBEngine.INIPath property as documented above to point to the
Registry Key up to, but not including, the Engines Key (the ...).
<P>
If ... = "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.0", then the settings
are system wide and DBEngine.INIPath does not need to be used.
<P>
NOTE: The full path to the .Ini file must be included, Visual Basic will
not automatically look in the Windows directory.
<P>
For further information see:
<P>
"The Jet Database Engine Programmer's Guide", Appendix C.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: APrgDataIISAM
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 8, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
