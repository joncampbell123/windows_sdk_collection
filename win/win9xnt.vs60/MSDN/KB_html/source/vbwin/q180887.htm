

<HTML>
<HEAD>
<TITLE>BUG: File Control's EOF Property Is Always Set to False </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180887">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1998/02/11">
<META NAME="Keywords" CONTENT="vb5all vbce kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When using the File Control and reading from a file using either the LineInputString or InputFields methods, the EOF property is always False, even when it has reached the end of the file. One of the following error messages will be generated:     ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB4,QAPN,QAFF,QAAP,QDL9,QBXS,QBWO,QBWN,QA7O,QAMN,QAB5,QAKP,QAVX,QAVW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: File Control's EOF Property Is Always Set to False</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180887</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Windows CE Toolkit for Visual Basic 5.0, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the File Control and reading from a file using either the
LineInputString or InputFields methods, the EOF property is always False,
even when it has reached the end of the file. One of the following error
messages will be generated:
<P>
<PRE>   An error was encountered while running this program.

   -or-

   -2147467259

</PRE><h2>CAUSE</h2>
 
<P>
The file EOF property is not set to True when the file pointer reaches the
end of the file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Check for the error immediately following the LineInputString or
InputFields method and handle it accordingly. See the MORE INFORMATION
section below for details.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
NOTE: This example uses the LineInputString method. The error also occurs
using the InputFields method.

<OL><P><LI>Start a new Windows CE project in Visual Basic 5.0. Form1 is created by
   default.

<P><LI>Add a File control, two CommandButton controls and a TextBox to Form1.

<P><LI>Set the Text1.Multiline property to True.

<P><LI>Add the following code:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Sub Form_Load()
<PRE></PRE>         Command1.Caption = "Write to file"
         Command2.Caption = "Read from File"
      End Sub

      Private Sub Command1_Click()
         'Write file via LinePrint
         File1.Open "\test.txt", 2
         File1.LinePrint "line one"
         File1.LinePrint "line two"
         File1.LinePrint "line three"
         File1.Close
      End Sub

      Private Sub Command2_Click()
         'Read file via LineInputString
         Dim sLine
         On Error Resume Next
         Text1.Text = ""
         File1.Open "\test.txt", 1
         Do Until File1.EOF
            sLine = File1.LineInputString
            If Err.Number &lt;&gt; 0 Then
               Text1.Text = Text1.Text &amp; "error: " &amp; _
               Err.Number &amp; " " &amp; Err.Description &amp; vbCrLf
               File1.Close
               Exit Sub
            End If
            Text1.Text = Text1.Text &amp; sLine &amp; ":  File1.EOF = " _
                         &amp; File1.EOF &amp; vbCrLf
         Loop
         File1.Close
      End Sub

</PRE><P><LI>Press the F5 key to run the project and note that the error -2147467259
   is encountered because File1.EOF is never set to True.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Books Online for Microsoft Windows CE Toolkit for Visual Basic 5.0
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wce<BR>
Keywords          : vb5all vbce kberrmsg<BR>
Version           : WINDOWS:1.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
