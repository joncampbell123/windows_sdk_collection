

<HTML>
<HEAD>
<TITLE>BUG: Multiline Text Box Incorrectly Displays Large Text </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120523">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/09/13">
<META NAME="Keywords" CONTENT="kbui kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A MultiLine Text Box control with only a vertical scroll bar may incorrectly display large strings that do not contain spaces or line feed characters. The control will potentially display an incorrect string, no string at all, or modify the visible...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QATX,QAPN,QAH4,QAFF,QAMB,QBS0,QANF,QADF,QBXS,QA5V,QAO4,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Multiline Text Box Incorrectly Displays Large Text</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120523</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A MultiLine Text Box control with only a vertical scroll bar may
incorrectly display large strings that do not contain spaces or line feed
characters. The control will potentially display an incorrect string, no
string at all, or modify the visible font without affecting the control's
font property.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem with the Windows Text Box
(Edit) control. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To workaround this problem, set the ScrollBars property of the Text box to:
<P>
<PRE>'1 - Horizontal' or '3 - Both'

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following test application will reproduce the problems described above.
Variations in FontName and FontSize will produce different results.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a Text Box (Text1) and three Command Buttons (Command1,
   Command2, and Command3) to Form1.

<P><LI>Set the Multiline property of Text1 to True and set the ScrollBars
   property to 2 - Vertical.

<P><LI>Add the following code to the load event of Form1:
<P>
<PRE>   Sub Form_Load ()
      Text1.Left = 100
      Text1.Top = 100
      Text1.Width = 4000
      Text1.Height = 1600
      Command1.Left = 4500
      Command1.Top = 100
      Command2.Left = 4500
      Command2.Top = Command1.Top + Command1.Height + 25
      Command3.Left = 4500
      Command3.Top = Command2.Top + Command2.Height + 25
   End Sub

</PRE><P><LI>Add the following code to the click event of Command1:
<P>
<PRE>   Sub Command1_Click ()
      Dim A As String
      Dim B As String

      'A single '1' will appear in the Text
      'box and the Font will not be bold although
      'the property is set to True

      Text1.Text = ""
      Text1.FontName = "MS Sans Serif"
      Text1.FontBold = True

      A$ = String(4096, "1")
      B$ = String(4096, "2")

      A$ = A$ &amp; " " &amp; B$
      Text1.Text = A$
   End Sub

</PRE><P><LI>Add the following code to the click event of Command2:
<P>
<PRE>   Sub Command2_Click ()
      Dim A As String
      Dim B As String

      'No text will appear in the Text1

      Text1.Text = ""
      Text1.FontName = "MS Sans Serif"
      Text1.FontBold = True

      A$ = String(4096, "1")
      B$ = String(4096, "2")

      A$ = A$ &amp; B$
      Text1.Text = A$
   End Sub

</PRE><P><LI>Add the following code to the click event of Command3:
<P>
<PRE>   Sub Command3_Click ()
      Dim A As String
      Dim B As String

      'A blank line will appear followed by the 'Y's

      Text1.Text = ""
      Text1.FontName = "MS Sans Serif"
      Text1.FontBold = True

      A$ = String(4096, "X")
      B$ = String(4096, "Y")

      A$ = A$ &amp; B$
      Text1.Text = A$
   End Sub

</PRE><P><LI>Save the project and run.  Click each of the command buttons to see
   the following results:
<P>
<P><PRE>    - Command1: A single 1 will appear in the text box and the font will
<PRE></PRE>                not be bold.

    - Command2: No text will appear in the text box.

    - Command3: A single blank row or row of Xs followed by Ys will be
                visible in the text box.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00 buglist2.00 buglist3.00<BR>
KBCategory: kbui kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
