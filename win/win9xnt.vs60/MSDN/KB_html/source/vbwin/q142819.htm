

<HTML>
<HEAD>
<TITLE>How to Send Keystrokes from VB App to MS-DOS App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142819">
<META NAME="KBModify" CONTENT="1997/03/11">
<META NAME="KBCreate" CONTENT="1996/01/21">
<META NAME="Keywords" CONTENT="EnvtRun kbenv kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article demonstrates a technique you can use to to send keystrokes to a Microsoft MS-DOS-based application from a Microsoft Visual Basic application running on Microsoft Windows 3.x or Microsoft Windows 95. This method does not work with Micro...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAMB,QBT6,QDL9,QBWO,QBWN,QBV4,QAH6,QBWQ,QAHP,QBWS,QAJH,QATX,QAGQ,QANH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Send Keystrokes from VB App to MS-DOS App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142819</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>4.00    | 4.00
</PRE>WINDOWS | WINDOWS 95
kbenv kbprg kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates a technique you can use to to send keystrokes to
a Microsoft MS-DOS-based application from a Microsoft Visual Basic
application running on Microsoft Windows 3.x or Microsoft Windows 95. This
method does not work with Microsoft Windows NT.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Visual Basic for Windows SendKeys function can send keystrokes to the
currently active window as if the keystrokes had been typed at the
keyboard. Although it is not possible to send keystrokes to an
application that is not based on Windows by using SendKeys directly, you
can place text on the Clipboard and use the SendKeys function to paste that
text into an MS-DOS-based application that is running in a window or
minimized as an icon.
<P>
To run an MS-DOS-based application in a window, you must be running in
Windows 386 enhanced mode. You must also make sure that the MS-DOS-based
application's .PIF file has been set to display the application in a window
rather than full screen. Use the Windows PIF Editor to make this
modification, if necessary.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example demonstrates how to send keystrokes to an MS-DOS
session running in a window:

<OL><P><LI>Start an MS-DOS session running in a window.

<P><LI>Start Visual Basic for Windows and start a new project.

<P><LI>Enter the following into the general declarations section of the form:
<P>
<P><PRE>      Dim progname As String
</PRE>
<P><LI>Put two labels on the form. Change the first label's caption to
   "MS-DOS App Title." Change the second label's caption to "Keys to send."

<P><LI>Put two text boxes on the form next to each of the labels. Delete the
   default contents of these text boxes. These controls are used to allow
   the user to enter the MS-DOS-based application's window title and the
   keystrokes to send to it. Change the Name property of these text
   boxes to "DosTitle" and "DosKeys" respectively.

<P><LI>Put a command button on the form, and change its caption to "Send keys."

<P><LI>Add the following code to the Command1 button click event procedure:
<P>
<PRE>   Private Sub Command1_Click()
      'Ensure that progname is set to the titlebar of Visual Basic while
      ' running.
      progname = "Project1 - Microsoft Visual Basic [run]"
      clipboard.Clear
      clipboard.SetText DosKeys.Text + Chr$(13)  ' Append a &lt;CR&gt;.
      AppActivate DosTitle.Text
      SendKeys "% ep", 1
      AppActivate progname
   End Sub

   If the text that you send is the DIR command or another command that
   takes time, the AppActivate call immediately following the SendKeys
   call can interrupt the processing. The AppActivate call should be
   placed in a timer with the appropriate interval set, and the timer
   should be enabled in the command_click procedure. The timer should
   be disabled before exiting the timer.

</PRE><P><LI>Run the program.

<P><LI>Enter the window title of the MS-DOS-based application into the DosTitle
   text box. The default window title for an MS-DOS session is
   "MS-DOS Prompt".

<P><LI>Enter the keystrokes to send into the DosKeys text box (for
<P><PRE>    example, DIR).
</PRE>
<P><LI>Click the Send Keys button. The keystrokes are sent to the
<P><PRE>    Clipboard and then pasted into the MS-DOS window.
</PRE><P>
</OL>To use this technique in a compiled Visual Basic for Windows program,
change the progname assignment from "Microsoft Visual Basic" to the
executable file name. Also, to see the text being placed onto the
Clipboard, open the Windows Clipboard viewer.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00 vb416 vb4win 4.00<BR>
KBCategory: kbenv kbprg kbhowto<BR>
KBSubcategory: EnvtRun<BR>
Keywords            : EnvtRun kbenv kbhowto kbprg<BR>
Version             : 4.00    | 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
