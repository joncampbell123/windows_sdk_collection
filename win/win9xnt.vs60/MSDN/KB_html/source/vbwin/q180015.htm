

<HTML>
<HEAD>
<TITLE>PRB: Stored Procedures Slower with MS Oracle ODBC Driver 2.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180015">
<META NAME="KBModify" CONTENT="1998/01/28">
<META NAME="KBCreate" CONTENT="1998/01/27">
<META NAME="Keywords" CONTENT="odbcOracle mdacMisc">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you call an Oracle stored procedure through RDO or through ADO using Command.Refresh, the MS Oracle ODBC Driver version 2.0 is slower than version 1.0.  CAUSE =====  The underlying ODBC API call (SQLProcedureColumns) was changed in version 2.0...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABG,QA94,QAI4,QAGI,QBS0,QAB9,QA9E,QAU9,QAPN,QABM,QAIF,QBVV,QAZB,QALZ,QDIT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Stored Procedures Slower with MS Oracle ODBC Driver 2.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 28, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180015</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
<LI>Microsoft ODBC for Oracle, version 2.0 (Build 2.73.7269)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you call an Oracle stored procedure through RDO or through ADO using
Command.Refresh, the MS Oracle ODBC Driver version 2.0 is slower than
version 1.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
The underlying ODBC API call (SQLProcedureColumns) was changed in version
2.0 of the MS Oracle ODBC Driver to accommodate Oracle package support. By
making this change, the SQL for the API call increased ten-fold. The larger
SQL statement results in the slower execution of Oracle stored procedures.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When using RDO there is no workaround. SQLProcedureColumns is always
called. With ADO, if all of the Command attributes are set, the parameters
collection is defined and Command.Refresh is not used, then
SQLProcedureColumns is not called. For an example of how to use ADO so that
SQLProcedureColumns is not called, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q176936.htm">Q176936</A></B>
   TITLE     : INFO: Visual Basic 5.0 Accessing an Oracle Database Using
               ADO

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Following is the SQL statement that SQLProcedureColumns creates on Oracle
(captured through Oracle SQL trace):
<P>
<PRE>   select null,owner,decode(package_name,NULL,object_name,
   package_name||'.'||object_name),decode(position,0,
   'RETURN_VALUE',nvl(argument_name,chr(0))),
   decode(data_type,'REFCURSOR',3,decode(in_out,
   'IN',1,'IN/OUT',2,'OUT',decode(argument_name,null,5,4)
   ,0)), decode(data_type, 'CHAR', 1, 'DATE', 11, 'FLOAT'
   , 8, 'LONG', -1, 'LONG RAW', -4, 'NUMBER', 3, 'RAW', -3,
   'VARCHAR2', 12, 0), data_type, decode(data_type, 'CHAR',
   decode(data_length, null, 255, data_length), 'DATE', 19,
   'FLOAT', 15, 'LONG', 2147483647, 'LONG RAW', 2147483647,
   'NUMBER', decode(data_precision, null, 38, data_precision),
   'RAW', decode(data_length, null, 255, data_length),
   'VARCHAR2', decode(data_length, null, 2000, data_length),
   data_length), decode(data_type, 'CHAR', decode(data_length,
   null, 255, data_length), 'DATE', 16, 'FLOAT', 8, 'LONG',
   2147483647, 'LONG RAW', 2147483647, 'NUMBER', decode(
   data_precision, null, decode(data_scale, 0, 40, 40), 40),
   'RAW', decode(data_length, null, 255, data_length),
   'VARCHAR2', decode(data_length, null, 2000, data_length),
   data_length), decode(data_type, 'DATE', 0, 'FLOAT', null,
   'NUMBER', 0, data_scale), decode(data_type, 'NUMBER', 10,
   'FLOAT', 10, 'DATE', 10, null), 2, null, overload,  sequence
   from all_arguments where data_level = 0 and
   decode(package_name,NULL,object_name,package_name||'.'||
   object_name) like 'PACKPERSON.ONEPERSON' escape '\'
   order by 2,3,14,15

</PRE>If you use ADO (as demonstrated in KB article <B><A href="../vbwin/q176936.htm">Q176936</A></B>) instead of RDO, the
above statement is never issued to Oracle. Because of this, ADO can execute
an Oracle stored procedure much faster than RDO.
<P>
(c) Microsoft Corporation 1998, All Rights Reserved.
Contributions by Sam Carpenter, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MS Oracle ODBC Driver rdo ado stored procedure<BR>
Keywords          : odbcOracle mdacMisc<BR>
Technology        : odbc<BR>
Version           : WINNT:2.0;<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 28, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
