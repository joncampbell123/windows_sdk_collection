

<HTML>
<HEAD>
<TITLE>VB3 How to Send Keystrokes from VB App to MS-DOS App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77394 ">
<META NAME="KBModify" CONTENT="1997/08/11">
<META NAME="KBCreate" CONTENT="1991/10/15">
<META NAME="Keywords" CONTENT="EnvtRun kbenv kbprg kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The  Microsoft Visual Basic: Language Reference  version 1.0 manual states that the SendKeys function cannot be used to send keystrokes to an MS-DOS-based application from a Windows-based application. This article gives a technique you can use to t...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAMB,QBT6,QBV4,QAH6,QAHP,QAJH,QDL9,QBWQ,QBWO,QBWN,QBWS,QATX,QAGQ,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 How to Send Keystrokes from VB App to MS-DOS App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77394 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, version 1.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The "Microsoft Visual Basic: Language Reference" version 1.0 manual states
that the SendKeys function cannot be used to send keystrokes to an
MS-DOS-based application from a Windows-based application. This article
gives a technique you can use to to send keystrokes to an MS-DOS-based
application from a Visual Basic Windows-based application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Visual Basic for Windows SendKeys function can send
keystrokes to the currently active window as if the keystrokes had been
typed at the keyboard. Although it is not possible to send keystrokes to an
application that is not based on Windows by using SendKeys directly, you
can place text on the Clipboard and use SendKeys to paste that text into an
MS-DOS-based application that is running in a window or minimized as an
icon.
<P>
To run an MS-DOS-based application in a window, you must be running in
Windows 386 enhanced mode. You must also make sure that the MS-DOS-based
application's .PIF file has been set to display the application in a window
rather than full screen. Use the Windows PIF Editor to make this
modification, if necessary.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following shows by example how to send keystrokes to an MS-DOS session
running in a window:

<OL><P><LI>Start an MS-DOS session running in a window.

<P><LI>Start Visual Basic for Windows and start a new project.

<P><LI>Enter the following into the general declarations section of the form:
<P>
<P><PRE>      Dim progname As String
</PRE>
<P><LI>Put two labels on the form. Change the first label's caption to
   "MS-DOS App Title." Change the second label's caption to "Keys to send."

<P><LI>Put two text boxes on the form next to each of the labels. Delete the
   default contents of these text boxes. These controls will be used to
   allow the user to enter the MS-DOS-based application's window title and
   the keystrokes to send to it. Change the Name property of these text
   boxes to "DosTitle" and "DosKeys" respectively.

<P><LI>Put a command button on the form, and change its caption to "Send keys."

<P><LI>Add the following code to the Command1 button click event procedure:
<P>
<PRE>   Sub Command1_Click()
      progname = "Microsoft Visual Basic"
      clipboard.Clear
      clipboard.SetText DosKeys.Text + Chr$(13)  ' Append a &lt;CR&gt;.
      AppActivate DosTitle.Text
      SendKeys "% ep", 1
      AppActivate progname
   End Sub

  If the text that you send is the DIR command or another command that
  takes time, the AppActivate call immediately following the SendKeys
  call will interrupt the processing. The AppActivate call should be
  placed in a timer with the appropriate interval set and the timer
  enabled in the command_click procedure. The timer should be disabled
  before exiting the timer.

</PRE><P><LI>Run the program.

<P><LI>Enter the window title of the MS-DOS-based application into the DosTitle
   text box. The default window title for an MS-DOS session is "DOS."
   If you would like to change the default window title, use the PIF
   Editor.

<P><LI>Enter the keystrokes to send into the DosKeys text box (for
<P><PRE>    example, DIR).
</PRE>
<P><LI>Click the Send Keys button. The keystrokes will be sent to the
<P><PRE>    Clipboard and then pasted into the MS-DOS window.
</PRE><P>
</OL>To use this technique in a compiled Visual Basic for Windows program,
change the progname assignment from "Microsoft Visual Basic" to the
executable file name. Also, to see the text being placed onto the
Clipboard, open the Windows Clipboard viewer.
 
<PRE>Keywords          : EnvtRun kbenv kbprg kbtlc
Version           : 1.0 2.0 3.0
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
