

<HTML>
<HEAD>
<TITLE>HOWTO: Call SQL Server System Stored Procedures from RDO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166211">
<META NAME="KBModify" CONTENT="1997/11/26">
<META NAME="KBCreate" CONTENT="1997/04/01">
<META NAME="Keywords" CONTENT="vb432 VB4WIN vb5all vb5howto VBKBDB VBKBNet VBKBObj kbusage kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how to call system-stored procedures on SQL Server from RDO.  SQL Server has a number of prewritten, stored procedures that are used to configure and administer the SQL server. They are all located in the Master database and ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QBS0,QAMA,QAZV,QAPN,QAOE,QABM,QAB9,QAY2,QAIF,QAW6,QANE,QAIJ,QAHE,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Call SQL Server System Stored Procedures from RDO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166211</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to call system-stored procedures on SQL Server
from RDO.
<P>
SQL Server has a number of prewritten, stored procedures that are used to
configure and administer the SQL server. They are all located in the Master
database and have the prefix “sp_,” which distinguishes them from
user- or application-written stored procedures.
<P>
In order to call these stored procedures from RDO, you must specify the
correct database in which they reside, the master database. There are
several ways to do this, but the most effective way is to explicitly
reference the stored procedure in your call syntax. For example:
<P>
<PRE>   { ? = call master.dbo.sp_addlogin(?,?) }

</PRE>Another method to accomplish this behavior is to set the default database
before creating and executing your stored procedure. The following example
uses a prepared statement and assumes that "Pubs" is your default database,
cn is an active rdoConnection object, and qr is an rdoQuery object:
<P>
<PRE>   cn .Execute "Use Master"
   qr.SQL  = "some sql to execute..."
   Set qr.ActiveConnection = cn
   qr .Execute
   cn .Execute "Use Pubs"

</PRE><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Start a new Standard EXE project. Form1 is created by default.

<P><LI>Add a CommandButton (Command1) to Form1.

<P><LI>From the Project menu, select References, and place a check next to
   Microsoft Remote Data Object 2.0.

<P><LI>Paste the following code into the General Declarations section of Form1:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         Dim cn As New rdoConnection
         Dim qr As New rdoquery

         With cn
         .Connect = "Driver={SQL Server};Server=MyServer;" &amp; _
                  "Database=pubs;Uid=sa;Pwd="
         .EstablishConnection Prompt = rdDriverNoPrompt
         End With

         With qr
            Set .ActiveConnection = cn
            'Note: If you don't specify master, you will get the following
            'error: "An invalid parameter was passed."
            .SQL = "{ ? = call master.dbo.sp_addlogin(?,?) }"
            .Prepared = True
            .BindThreshold = 1024 'largest column that will be bound under
                                  'ODBC.
            Debug.Print .rdoParameters.Count
            .rdoParameters(0).Direction = rdParamOutput
            .rdoParameters(1).Direction = rdParamInput
            .rdoParameters(2).Direction = rdParamInput
            .rdoParameters(1) = "Edward"
            .rdoParameters(2) = "Scissorhands"

            .Execute
            Debug.Print .rdoParameters(0).Value
            'Const SQL_SUCCESS As Long = 0
            'Const SQL_ERROR As Long = -1
         End With
      End Sub

</PRE><P><LI>Note that you need to change your DATABASE, UID, and PWD parameters in
   the Connect Property.

<P><LI>Start the program or press the F5 key.

<P><LI>Click the Command1 button to execute the stored procedure and display
   the parameter count and the output parameter in the debug window.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
In Visual Basic Books Online, please see:
<P>
<PRE>  Guide to Building Client Server Applications in Visual Basic (Enterprise)
    Part 3: Data Access Options
      Using Remote Data Objects and the Remote Data Control
        Using RDO to Execute Stored Procedures

</PRE></OL>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by
Jon Fowler, Microsoft Corporation
 
<PRE>Keywords          : vb432 VB4WIN vb5all vb5howto VBKBDB VBKBNet VBKBObj kbusage kbhowto
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
