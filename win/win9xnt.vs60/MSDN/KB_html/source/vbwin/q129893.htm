

<HTML>
<HEAD>
<TITLE>PRB: Circle Aspect Ratio Unaffected by User-Defined ScaleMode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129893">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbgraphic kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Lines (using the line method) drawn inside of a circle (using the Circle method) may have different aspect ratios. Therefore, lines that should have been an exact radius may be longer or shorter than the radius of the drawn circle.  CAUSE =====  Th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QBXT,QAIB,QA5V,QAK4,QAK2,QBS0,QA4Q,QAPN,QAJD,QAH4,QACR,QAI4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Circle Aspect Ratio Unaffected by User-Defined ScaleMode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129893</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Lines (using the line method) drawn inside of a circle (using the Circle
method) may have different aspect ratios. Therefore, lines that should have
been an exact radius may be longer or shorter than the radius of the drawn
circle.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Circle method always draws a perfect circle. It measures the radius in
the X direction. User-defined ScaleModes may have a defined unit in the X
direction that is not equal to the defined unit in the Y direction. This
causes the line lengths to be changed based on the User-defined
Scalemode, but it does not affect the circle.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This is not a problem with Visual Basic. The circle always draws a perfect
circle. It measures the radius in the X direction. The line method draws
the segments the correct length in both directions. To fix this issue, you
have to scale the Y coordinate or pick a better user-defined coordinate
system where units in the X and Y directions are equivalent. The following
shows the correct way to handle ScaleMode.
<P>
Replace the code shown in the "Steps to Reproduce Behavior" section of this
article with this code:
<P>
<PRE>   Sub Form_Click ()
      Dim X As Integer, Y As Integer, N As Integer
      N = 5
      X = 0
      Y = 0

      yscale = Form1.ScaleWidth / Form1.ScaleHeight  'added:

      Form1.ScaleMode = 0
      Form1.ScaleHeight = -3
      Form1.ScaleWidth = 3
      Form1.ScaleLeft = -1.5
      Form1.ScaleTop = 1.5

      Circle (x, y), 1, QBColor(n)
      Line (x, y)-(1, 0), QBColor(n)
      Line (x, y)-(0, 1 * yscale), QBColor(n)    'modified: added * yscale
      Line (x, y)-(-1, 0), QBColor(n)
      Line (x, y)-(0, -1 * yscale), QBColor(n)   'modified: added * yscale

   End Sub

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add two Command buttons (Command1 and Command2) to Form1.

<P><LI>Add the following code to the Click events for the command buttons:
<P>
<PRE>   Sub Command1_Click ()
      Form1.ScaleMode = 5 'Inches
      Form1.ScaleLeft = 0
      Form1.ScaleTop = 0

      Dim N As Integer, X As Integer, Y As Integer

      N = 5
      X = 1
      Y = 1

      Circle (x, y), 1, QBColor(n)
      Line (x, y)-(2, 1), QBColor(n)
      Line (x, y)-(1, 2), QBColor(n)
      Line (x, y)-(-2, 1), QBColor(n)
      Line (x, y)-(1, -2), QBColor(n)
   End Sub

   Sub Command2_Click()
      '** Note: depending on what screen resolution you are running
      'the aspect ratio difference may differ. At 1024x768 resolution,
      'the 2nd and 4th Line statement generate lines which go outside
      'of the circle).

      Dim N As Integer, X As Integer, Y As Integer
      N = 5
      X = 0
      Y = 0

      Form1.ScaleMode = 0 'User
      Form1.ScaleHeight = -3
      Form1.ScaleWidth = 3
      Form1.ScaleLeft = -1.5
      Form1.ScaleTop = 1.5

      Circle (x, y), 1, QBColor(n)
      Line (x, y)-(1, 0), QBColor(n)
      Line (x, y)-(0, 1), QBColor(n)      '** line 2
      Line (x, y)-(-1, 0), QBColor(n)
      Line (x, y)-(0, -1), QBColor(n)     '** line 4
   End Sub

</PRE><P><LI>Start the program by choosing Start from the Run menu or by pressing
   the F5 key.

<P><LI>Click the Command1 button. Then click the Command2 button. Note that the
   lines in the circle generated by the Command1 click event exactly equal
   the radius, but the lines in the circle generated by the Command2 click
   event do not.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbgraphic kbprg kbprb<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
