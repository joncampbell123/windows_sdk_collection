

<HTML>
<HEAD>
<TITLE>HOWTO: Move A Form That Has No Title Bar (32-Bit) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173773">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1997/09/11">
<META NAME="Keywords" CONTENT="vb432 VB4WIN vb5all vb5howto VBKBWinAPI">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article demonstrates how to move a form with the mouse when the form has no title bar by using the 32-bit Windows API SendMessage function with the WM_NCLBUTTONDOWN message.  MORE INFORMATION  The WM_NCLBUTTON message is generated by Windows w...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTM,QBS0,QACI,QAMB,QA9N,QAEF,QANJ,QAH4,QDL9,QBWQ,QBWO,QBWN,QAMN,QAFF,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Move A Form That Has No Title Bar (32-Bit)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173773</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to move a form with the mouse when the form
has no title bar by using the 32-bit Windows API SendMessage function with
the WM_NCLBUTTONDOWN message.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The WM_NCLBUTTON message is generated by Windows when a user right-clicks
on a window's title bar. Windows uses this message to determine whether the
window should be moved by further user actions. If the title bar does not
exist, this message is not generated. However, it is often useful to move a
window when it doesn't have a title bar. A window or form in 32-bit Visual
Basic will not have a title bar under the following circumstances:
<P>
<PRE>   Visual Basic 5.0
      Caption = ""
      ControlBox = False

   Visual Basic 4.0
      Caption = ""
      ControlBox = False
      MaxButton = False
      MinButton = False

</PRE>The sample code below illustrates a way of letting users move a form
without a title bar by simply clicking and dragging it from anywhere on the
form. The code placed in the MouseMove event procedure of Form1 may be
placed in other event procedures, if so desired. For example, the code
could be placed in the MouseDown event procedure of a Label control
allowing movement of the form by selecting and dragging from the Label
control.
<P>
NOTE: In Visual Basic 4.0, a form with a menu will have the title bar
supplied by default so the method demonstrated below is not necessary. In
Visual Basic 5.0, a form with a menu will not have a title bar supplied by
default.
<P>
<P><h3>Step-By-Step Example</h3>
 

<OL><P><LI>Start a new Standard EXE project. Form1 is added by default.

<P><LI>Set Form1's ControlBox, MinButton, and MaxButton properties to False,
   and then clear its Caption.

<P><LI>Place a CommandButton control (Command1) on Form1.

<P><LI>Place the following code in the General Declarations section of Form1:
<P>
<P><PRE>      Private Declare Function SendMessage Lib "User32" _
<PRE></PRE>                         Alias "SendMessageA" (ByVal hWnd As Long, _
                                               ByVal wMsg As Long, _
                                               ByVal wParam As Long, _
                                               lParam As Any) As Long

      Private Declare Sub ReleaseCapture Lib "User32" ()

      Const WM_NCLBUTTONDOWN = &amp;HA1
      Const HTCAPTION = 2

      Private Sub Form_Load()
         Command1.Caption = "Exit"
      End Sub

      Private Sub Form_MouseMove(Button As Integer, Shift As Integer, _
                                 X As Single, Y As Single)
         Dim lngReturnValue As Long

         If Button = 1 Then
            Call ReleaseCapture
            lngReturnValue = SendMessage(Form1.hWnd, WM_NCLBUTTONDOWN, _
                                         HTCAPTION, 0&amp;)
         End If
      End Sub

      Private Sub Command1_Click()
         End
      End Sub

</PRE><P><LI>Press the F5 key to run the program. Clicking and holding over Form1
   will allow you to move the form. Pressing the CommandButton control will
   exit the program.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For information on how to move a form without a title bar in 16-bit
versions of Visual Basic, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q114593.htm">Q114593</A></B>
   TITLE     : HOWTO: Move a Form that Has No Titlebar or Caption
</PRE></OL> 
<PRE>Keywords          : vb432 VB4WIN vb5all vb5howto VBKBWinAPI
Version           : WINDOWS:4.0,5.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
