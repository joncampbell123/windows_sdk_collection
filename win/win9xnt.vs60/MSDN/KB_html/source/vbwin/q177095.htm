

<HTML>
<HEAD>
<TITLE>FILE: SYSTRAY.EXE: ActiveX Control Adds Icons to Status Area </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177095">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/11/20">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  SYSTRAY.EXE is an ActiveX control written in Visual Basic that demonstrates how to add icons to the status area of the taskbar and also processes callback messages for taskbar icons. Using the new Visual Basic 5.0 AddressOf function, the callback m...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QA7O,QAOE,QAMN,QDKB,QA5F,QAMA,QAHV,QANS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: SYSTRAY.EXE: ActiveX Control Adds Icons to Status Area</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177095</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SYSTRAY.EXE is an ActiveX control written in Visual Basic that demonstrates
how to add icons to the status area of the taskbar and also processes
callback messages for taskbar icons. Using the new Visual Basic 5.0
AddressOf function, the callback messages are received and processed in a
module that is registered as a callback function in a Win32 API call.
<P>
The Visual Basic project for this control can be downloaded from the Visual
Basic Owner's site at the following URL:

<UL><LI><B><A href="http://premium.microsoft.com/download/vbasic/systray.exe">http://premium.microsoft.com/download/vbasic/systray.exe.</A></B>
<P>
</UL>Only registered users of Visual Basic can access this site.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Visual Basic version 4.0, manipulating the status area of the taskbar
required the use a Visual Basic intrinsic control to serve as a Window that
reacts to the callback message. Using an intrinsic control in this fashion
was a way to work around the inability version 4.0 to work with pointers.
This method is documented in the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q162613.htm">Q162613</A></B>
   TITLE     : HOWTO: Manipulate Icons in the System Tray with Visual Basic

</PRE>Visual Basic 5.0, however, has the ability to work with pointers, so you
don't need to use an intrinsic control to add icons to the status area of
the taskbar. Additionally, the control contains properties and mouse
events, such as MouseMove, MouseDown, MouseUp, MouseDblClick, to make the
control more useful by specifying when the icon appears, where the ToolTip
text will be, and the icon image.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: system tray
<P>

(c) Microsoft Corporation 1997, All Rights Reserved.<BR>
Contributions by  Arsenio Locsin, Microsoft Corporation<BR>
Keywords          : vb5all<BR>
Version           : WINDOWS:5.0<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
