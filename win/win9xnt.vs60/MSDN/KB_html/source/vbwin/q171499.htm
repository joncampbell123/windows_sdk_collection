

<HTML>
<HEAD>
<TITLE>FIX: IDE Doesn't Show Topics of OCX Help Files Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171499">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/07/16">
<META NAME="Keywords" CONTENT="vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When creating your own control or using a third-party control, you may see the following problems when invoking context-sensitive help on a Classes or Members item in the Object Browser from within the Visual Basic 5.0 IDE. These problems may occur...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBMH,QA6A,QDM0,QAB4,QAR4,QA7O,QAMN,QAB5,QDO3,QAPN,QAN0,QAKP,QBVV,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: IDE Doesn't Show Topics of OCX Help Files Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171499</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When creating your own control or using a third-party control, you may see
the following problems when invoking context-sensitive help on a Classes or
Members item in the Object Browser from within the Visual Basic 5.0 IDE.
These problems may occur when invoking context-sensitive help using the F1
key, the What's This button, or the right-mouse button on the object and
selecting Help from the popup menu. You may also see these problems when
pressing the F1 key after selecting a control that is placed on a form at
design-time in the IDE.
<P>
The problems you may see are as follows:

<OL><P><LI>If Help Author is switched on (set to 1), you will see the error message
   "The Window name 'LangRef' was not defined in your project file." You
   will also see the topic displayed in Visual Basic 5.0's Langref window
   instead of the control's Help file window.

<P><LI>Macros that make jumps based on keywords do not function. The macros
   that are affected are ALink, KLink, and JumpKeyword. The error "No
   additional information is available" is displayed when either the ALink
   or KLink macro is invoked from a topic shown through context-sensitive
   help in the Object Browser. Please note that the ALink and KLink macros
   are typically invoked in Help files from "Related Topics" or "See Also"
   hotspots. When using JumpKeyword, the Index tab is displayed but the
   desired keyword may not be listed. If the keyword is listed in the Index
   tab, a jump to the desired topic may not occur.

<P><LI>Visual Basic's contents tree is displayed instead of the control's when
   the Contents or Help Topics button is clicked on a topic invoked through
   context-sensitive help in the Object Browser.
<P>
</OL>These problems do not happen with intrinsic controls or other controls that
were originally shipped with Visual Basic 5.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
All the problems above have been fixed in Visual Studio 97 Service Pack 2
(SP2) except problem number 1. This error is only displayed when Help
Authoring is switched on. To prevent the error message from appearing,
switch off Help Authoring. Help Authoring can be switched by doing any one
of the following:

<OL><P><LI>From HCW, select and uncheck the Help Author item in the File menu.

<P><LI>In Win95, add Help Author=0 to the [Windows Help] Section of the Win.ini
   in the windows directory. You will not need to reboot but you will need
   to close the Help file and reopen it.

<P><LI>From Windows NT 3.51 or 4.0 in the
   HKEY_CURRENT_USER\\Software\Microsoft\Windows Help, you will need to set
<PRE>   'Help Author' to '0'.

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 2, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Problem 1: If Help Author is switched on (set to 1), you will see the error
message "The Window name 'LangRef' was not defined in your project file."

<OL><P><LI>Create an ActiveX control that has a couple of exposed properties and
   set the name of your Help file on the Project Properties \ General tab.

<P><LI>In Object Browser, select the control project. In the classes section,
   select the control name.

<P><LI>Right-click the exposed property. This brings up the popup menu.

<P><LI>Select the Properties item and set the HelpcontextID.

<P><LI>Repeat steps 3 and 4 on the other exposed property.

<P><LI>In Object Browser, select the first exposed property and click F1. This
   displays the Help topic in the correct Help window.

<P><LI>In Object Browser, select the second exposed property and click F1. This
   displays the correct topic but in Visual Basic 5.0's langref Help
   window.
<P>
</OL>Problem 2: Keyword macros such as ALink or KLink macros do not work on a
topic invoked through context-sensitive Help in the IDE.
<P>
In Object Browser, select the exposed property and click F1. If the topic
that is displayed has a hotspot labeled either "See Also" or "Related
Topics," it is quite probable the ALink or KLink Help macros are being
called. If this is the case, then clicking the button can produce the
following error message: "No additional information is available."
<P>
Problem 3: The wrong contents is displayed when the Contents or Help Topics
button is clicked on a topic invoked through context-sensitive Help from
Object Browser. Visual Basic 5.0's contents is displayed instead of
control's contents.
 
<PRE>Keywords          : vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
