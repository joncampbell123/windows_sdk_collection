

<HTML>
<HEAD>
<TITLE>How to Add Items into Control Menu Box of Visual Basic Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110498">
<META NAME="KBModify" CONTENT="1996/02/18">
<META NAME="KBCreate" CONTENT="1994/01/24">
<META NAME="Keywords" CONTENT="kbref kbprg kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  To add items into the Control-menu box of a Visual Basic Form, you can use the AppendMenu API (application programming interface) function in Windows. However, Visual Basic cannot directly detect any events for the added menu item. To catch the mes...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QAMN,QA7O,QAOE,QAEV,QAO2,QAH6,QAB9,QDL9,QBWQ,QBWO,QBWN,QA5F,QAYC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Add Items into Control Menu Box of Visual Basic Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110498</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To add items into the Control-menu box of a Visual Basic Form, you can use
the AppendMenu API (application programming interface) function in Windows.
However, Visual Basic cannot directly detect any events for the added menu
item. To catch the message for the added menu item, you can use a subclass
control. You can write subclass controls using Microsoft C, but not using
Visual Basic. Alternatively, you can obtain subclass controls from third-
party programs such as SpyWorks from Desaware.
<P>
The Control-menu box, found in the upper-left corner of a Visual Basic
form, is also known as the System-menu box in other products for Windows.
The default Control-menu box contains the following nine entries including
separators:
<P>
<PRE>   Restore
   Move
   Size
   Minimize
   Maximize
   -----------------------
   Close            Alt+F4
   -----------------------
   Switch to...   Ctrl+Esc

</PRE><h2>MORE INFORMATION</h2>
 
<P>
In Windows programming terms, subclassing is the process of creating a
message handling procedure and intercepting messages for a given window,
handling any messages you choose, and passing the rest to the window's
original message handler.
<P>
The subclass procedure is a message filter that performs nondefault
processing for a few key messages, and passes other messages to a default
window procedure using the CallWindowProc API function. The CallWindowProc
function passes a message to the Windows system, which in turns sends the
message to the target window procedure. The target window procedure cannot
be called directly by the subclass procedure because the target procedure
(in this case a window procedure) is exported.
<P>
<P><h3>How to Contact Desaware</h3>
 
<P>
NOTE: Desaware products are manufactured independent of Microsoft.
Microsoft makes no warranty, implied or otherwise, regarding these
products' performance or reliability.
<P>
<PRE>   Desaware
   5 Town &amp; Country Village #790
   San Jose, CA  95128
   Contact:  Dan Appleman (408) 377-4770
   Fax: (408) 371-3530

</PRE>The Desaware company offers the following products:

<UL><LI>Custom Control Factory -- An interactive development tool for creating
   custom controls including animated pushbuttons, multistate buttons,
   enhanced buttons, check boxes, and option button controls for Windows
   applications.

<LI>CCF-Cursors -- Provides you with complete control over cursors (mouse
   pointers) in Visual Basic applications. Create your own cursors or
   convert icons to cursors, and much more. Includes over 50 cursors.

<LI>SpyWorks-VB -- An advanced development tool for use with Visual Basic.
   SpyWorks contains subclass controls.
<P>
</UL>This information is subject to change.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbref kbprg kb3rdparty<BR>
KBSubcategory: APrgOther RefsThird<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
