

<HTML>
<HEAD>
<TITLE>UPD: Oracle ODBC Setup and Connection Issues in VB 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99706 ">
<META NAME="KBModify" CONTENT="1996/12/19">
<META NAME="KBCreate" CONTENT="1993/06/06">
<META NAME="Keywords" CONTENT="kbinterop kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The information given further below was taken from the latest version of the ORACLE.TXT file. A version of ORACLE.TXT was provided with Visual Basic version 3.0, but a later version (the one shown below) was provided with Microsoft Access version 1...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA94,QABI,QAA1,QAYL,QDI2,QAB4,QA9E,QAVZ,QABH,QDL9,QBWQ,QBWO,QBWN,QBFY,QAU9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>UPD: Oracle ODBC Setup and Connection Issues in VB 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 19, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99706 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows, version 3.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The information given further below was taken from the latest version
of the ORACLE.TXT file. A version of ORACLE.TXT was provided with Visual
Basic version 3.0, but a later version (the one shown below) was provided
with Microsoft Access version 1.1 for Windows. This updated version is
provided in the More Information section below.
<P>
To install the earlier version of ORACLE.TXT on your computer, run Data
Access Setup and install the Oracle ODBC driver. The ORACLE.TXT file will
be installed in your WINDOWS\SYSTEM directory. Then you can update the
file with the new information provided in the More Information section
below.
<P>
The ORACLE.TXT file fails to mention that the SQL*NET drivers are not
provided with Visual Basic. In order to use the information in this
article, you must acquire the SQL*NET drivers from Oracle. You can
contact Oracle at 1-800-345-DBMS.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
SETTING UP THE ODBC ORACLE DRIVER FOR USE WITH THE SQL*NET FOR WINDOWS DLLs
<P>
This file discusses how to set up the ODBC ORACLE driver to run with your
ORACLE Server software. To use the ODBC ORACLE driver with any large
application, such as Microsoft Access, you must use the SQL*Net for Windows
DLLs. Because the ODBC ORACLE driver is designed to use ORACLE Server
version 6 and the SQL*Net for Windows DLLs are designed to use ORACLE
Server version 7, you must be careful to configure your system correctly.
<P>
If you do not have the SQL*Net for Windows DLLs, or, after following the
instructions in this file, you are still unable to connect to ORACLE Server
with SQL*Net, you can contact Oracle Corp. at 1-800-345-DBMS.
<P>
<P><h3>If ORACLE Server Version 6 is Already Installed</h3>
 
<P>
To set up the ODBC ORACLE driver and the SQL*Net for Windows DLLs if you
already have ORACLE Server version 6 on your system:

<OL><P><LI> Make sure you have the correct versions of ORACLE products, including
<P><PRE>    at least one SQL*Net protocol.
</PRE><P>
<PRE>    Product                                  Version
    --------------------------------         -----------
    ORACLE Installer                         3.0.8.3.7
    Required Support Files                   7.0.12.1.0
    SQL*Net Named Pipes for Windows          1.1.1.3
    SQL*Net SPX for Windows                  1.1.1.5
    SQL*Net TCP/IP for Windows               1.1.7.6

</PRE><P><LI> Test your current SQL*Net connection by using an ORACLE tool such as
<P><PRE>    SQL*Plus for Windows.
</PRE>
<P><LI> Search for and delete all copies of ORA6WIN.DLL from your system. A new
<P><PRE>    (backwards compatible) version of ORA6WIN.DLL will be installed with
    the ODBC ORACLE driver.
</PRE>
<P><LI> Run the ORACLE Installer program. When asked for your ORACLE
<P><PRE>    installation directory, use the suggested default directory C:\ORAWIN.
</PRE>
<P><LI> Run the ORACLE Installer in the ORACLE group in the Program Manager:
<P>
<P><PRE>    a) Install the files from the Required Support Files disk.
</PRE><P>
<P><PRE>    b) Install the SQL*Net protocol you will be using. For more
       information, see the ORACLE documentation.
</PRE>
<P><LI> If the following line exists, remove it from your AUTOEXEC.BAT file:
<P>
<P><PRE>      SET CONFIG=&lt;oracle_configuration_file&gt;
</PRE><P>
<P><PRE>    Add the following line to your AUTOEXEC.BAT file:
</PRE><P>
<P><PRE>      SET CONFIG_FILES=C:\WINDOWS\ORACLE.INI
</PRE><P>
<P><PRE>    NOTE: If you are using the MS-DOS 6.0 operating system, add the
    following line to the end of your AUTOEXEC.BAT file:
</PRE><P>
<P><PRE>      SET CONFIG=
</PRE><P>
<P><PRE>    ORACLE Server first checks the CONFIG environment variable for the path
    of the ORACLE configuration file. If the CONFIG variable is not set,
    ORACLE Server checks the CONFIG_FILES variable. Because MS-DOS 6.0 can
    use the CONFIG environment variable during system startup, you must
    clear this variable before leaving your AUTOEXEC.BAT file. Otherwise,
    ORACLE Server will use its value as the path of the ORACLE
    configuration file.
</PRE>
<P><LI> Make sure your PATH variable includes the BIN subdirectories of your
<P><PRE>    &lt;oraclehome&gt; directory and the \ORAWIN directory. For example, if your
    &lt;oraclehome&gt; directory is C:\ORACLE6, add the following line to your
    AUTOEXEC.BAT file:
</PRE><P>
<P><PRE>      SET PATH=%PATH%;C:\ORACLE6\BIN;C:\ORAWIN\BIN
</PRE>
<P><LI> Paste the contents of your CONFIG.ORA file at the start of your
<P><PRE>    ORACLE.INI file. For example, if your CONFIG.ORA file contains:
</PRE><P>
<P><PRE>      LANGUAGE=American_America.US7ASCII
      ORACLE_HOME=C:\ORACLE6
      MACHINE_TYPE=J
      SQLPATH=C:\ORACLE6
      WIN_REMOTE_SESSIONS=3
      LOCAL=p:MyServer
</PRE><P>
<P><PRE>    and your ORACLE.INI file contains:
</PRE><P>
<P><PRE>      [Oracle]
      ORACLE_HOME=C:\ORAWIN
      LANGUAGE=American_America.US7ASCII
      NLS_LANG=ENGLISH
      WIN_LOCAL_SESSIONS=1
      TCP_VENDOR=LANMAN
      TCP_SERVICES_FILE=C:\WINDOWS\SERVICES
</PRE><P>
<P><PRE>    then your modified ORACLE.INI file should contain:
</PRE><P>
<P><PRE>      LANGUAGE=American_America.US7ASCII
      ORACLE_HOME=C:\ORACLE6
      MACHINE_TYPE=J
      SQLPATH=C:\ORACLE6
      WIN_REMOTE_SESSIONS=3
      LOCAL=p:MyServer
</PRE><P>
<P><PRE>      [Oracle]
      ORACLE_HOME=C:\ORAWIN
      LANGUAGE=American_America.US7ASCII
      NLS_LANG=ENGLISH
      WIN_LOCAL_SESSIONS=1
      TCP_VENDOR=LANMAN
      TCP_SERVICES_FILE=C:\WINDOWS\SERVICES
</PRE><P>
<P><PRE>    NOTE: The ORACLE_HOME variable is set twice, once to point to the
    version 6 &lt;oraclehome&gt; directory and once to point to C:\ORAWIN.
</PRE>
<P><LI> If it is not already running, start Windows. Insert the ODBC Setup disk
<P><PRE>    in drive A, choose Run from the Windows Program Manager (or File
    Manager) File menu, and then type "a:\setup.exe" in the Command Line
    box. For information about using the ODBC Setup program, see the online
    Help.
</PRE>
<P><LI>Run the ODBC Control Panel option and add a data source for your ORACLE
<P><PRE>    server. For information about using the ODBC Control Panel option, see
    the online Help.
</PRE><P>
</OL>You should now be able to run the ODBC ORACLE driver. You should also be
able to run ORACLE version 6 and version 7 tools and applications written
for Windows. All of these can run over SQL*Net for Windows DLLs.
<P>
NOTE:  Due to differences in memory use, this configuration may not allow
you to run ORACLE MS-DOS-only tools or applications.
<P>
<P><h3>If ORACLE Server is Not Installed</h3>
 
<P>
To set up the ODBC ORACLE driver and the SQL*Net for Windows DLLs if you do
not have any versions of ORACLE Server on your system:

<OL><P><LI> Make sure that you have the correct versions of ORACLE products,
<P><PRE>    including at least one SQL*Net protocol.
</PRE><P>
<PRE>    Product                                  Version
    --------------------------------         -----------
    ORACLE Installer                         3.0.8.3.7
    Required Support Files                   7.0.12.1.0
    SQL*Net Named Pipes for Windows          1.1.1.3
    SQL*Net SPX for Windows                  1.1.1.5
    SQL*Net TCP/IP for Windows               1.1.7.6

</PRE><P><LI> Install the network software connecting your client workstation to the
<P><PRE>    server and check that a connection can be made. For example, for the
    TCP/IP protocol, type "ping &lt;servername&gt;". This connection must work
    before you install the SQL*Net for Windows DLLs.
</PRE>
<P><LI> Run the ORACLE Installer program. When asked for your ORACLE
<P><PRE>    installation directory, use the suggested default directory C:\ORAWIN.
</PRE>
<P><LI> Run the ORACLE Installer in the ORACLE group in the Program Manager:
<P>
<P><PRE>    a) Install the files from the Required Support Files disk.
</PRE><P>
<P><PRE>    b) Install the SQL*Net protocol you will be using. For more
       information, see the ORACLE documentation.
</PRE>
<P><LI> Add the following line to your AUTOEXEC.BAT file:
<P>
<P><PRE>      SET CONFIG_FILES=C:\WINDOWS\ORACLE.INI
</PRE><P>
<P><PRE>    NOTE: If you are using MS-DOS 6.0, add the following line to the end
    of your AUTOEXEC.BAT file:
</PRE><P>
<P><PRE>      SET CONFIG=
</PRE><P>
<P><PRE>    ORACLE Server first checks the CONFIG environment variable for the path
    of the ORACLE configuration file. If the CONFIG variable is not set,
    ORACLE Server checks the CONFIG_FILES variable. Because MS-DOS 6.0 can
    use the CONFIG environment variable during system startup, you must
    clear this variable before leaving your AUTOEXEC.BAT file. Otherwise,
    ORACLE Server will use its value as the path of the ORACLE
    configuration file.
</PRE>
<P><LI> Make sure your PATH variable includes the C:\ORAWIN\BIN directory. To
<P><PRE>    do this, add the following line to your AUTOEXEC.BAT file:
</PRE><P>
<P><PRE>      SET PATH=%PATH%;C:\ORAWIN\BIN
</PRE>
<P><LI> So that the ODBC ORACLE driver can use ORACLE version 7 error messages,
<P><PRE>    copy the version 7 error messages to the directory where the ODBC
    ORACLE driver searches for error messages:
</PRE><P>
<P><PRE>      COPY C:\ORAWIN\RDBMS70\*.MSB C:\ORAWIN\DBS
</PRE>
<P><LI> Search for and delete all copies of ORA6WIN.DLL from your system. A new
<P><PRE>    (backwards compatible) version of ORA6WIN.DLL will be installed with
    the ODBC ORACLE driver.
</PRE>
<P><LI> If it is not already running, start Windows. Insert the ODBC Setup disk
<P><PRE>    in drive A, choose Run from the Windows Program Manager (or File
    Manager) File menu, and then type "a:\setup.exe" in the Command Line
    box. For information about using the ODBC setup program, see the online
    Help.
</PRE>
<P><LI>Run the ODBC Control Panel option and add a data source for your ORACLE
<P><PRE>    server. For information about using the ODBC Control Panel option, see
    the online Help.
</PRE><P>
</OL>You should now be able to run the ODBC ORACLE driver.
<P>
<P><h3>ORACLE Error Messages</h3>
 
<P>
The following section explains what to do when you encounter various error
messages from ORACLE Server through the ODBC ORACLE driver.
<P>
<P><h3>ORA-xxxxx Message not found; product = RDBMS facility = ORA language = NULL</h3>
 
<P>
The ODBC ORACLE driver searches for error messages in the subdirectory that
normally contains the ORACLE version 6 error messages. If you receive this
error, it means that the ODBC ORACLE driver cannot find the error messages.
To fix this:

<OL><P><LI> Check that the CONFIG_FILES variable is set in your AUTOEXEC.BAT file
<P><PRE>    and that it points to your ORACLE configuration file (ORACLE.INI). If
    you are using MS-DOS 6.0, check that the CONFIG environment variable is
    either not set or is cleared in the last line of your AUTOEXEC.BAT
    file.
</PRE>
<P><LI> Check that the ORACLE_HOME variable is set correctly in your
<P><PRE>    C:\WINDOWS\ORACLE.INI file.
</PRE><P>
<P><PRE>    If ORACLE Server version 6 was already installed on your system,
    ORACLE_HOME should be set twice. The first time, it should be set to
    your version 6 &lt;oraclehome&gt; directory, usually C:\ORACLE6. The second
    time, in the [Oracle] section of the file, it should be set to
    C:\ORAWIN.
</PRE><P>
<P><PRE>    If ORACLE Server was not installed on your system, ORACLE_HOME should
    be set to C:\ORAWIN.
</PRE>
<P><LI> If you did not have any ORACLE software on your workstation, make sure
<P><PRE>    that you copied all the .MSB files from C:\ORAWIN\RDBMS70 to
    C:\ORAWIN\DBS.
</PRE><P>
</OL>The ODBC ORACLE driver should now be able to print the ORACLE Server error
message, enabling you to fix the problem that generated the error.
<P>
<P><h3>ORA-03121  No interface driver connected -- function not performed</h3>
 
<P>
The ODBC ORACLE driver cannot find ORA6WIN.DLL or one of the SQL*Net
components. Check the following:

<OL><P><LI> Without running the ODBC ORACLE driver, make sure the network
<P><PRE>    connection is valid. For example, type "ping &lt;servername&gt;" for a TCP/IP
    connection.
</PRE>
<P><LI> Search for and delete old versions of ORA6WIN.DLL. The correct version
<P><PRE>    of the ORA6WIN.DLL was installed by the ODBC ORACLE driver in the
    SYSTEM subdirectory of your Windows directory.
</PRE>
<P><LI> Check that the PATH variable contains the BIN subdirectory of the
<P><PRE>    &lt;oraclehome&gt; directory (usually C:\ORACLE6\BIN or C:\ORAWIN\BIN).
</PRE>
<P><LI> Check that the CONFIG_FILES variable is set in your AUTOEXEC.BAT file
<P><PRE>    and that it points to your ORACLE configuration file (ORACLE.INI). If
    you are using MS-DOS 6.0, check that the CONFIG environment variable
    is either not set or is cleared in the last line of your AUTOEXEC.BAT
    file.
</PRE>
<P><LI> Check that SQLTCP.DLL (for TCP/IP), SQLSPX.DLL (for Novell NetWare
<P><PRE>    IPX/SPX), or SQLNMP.DLL (for Named Pipes) is in the ORACLE BIN
    directory specified in the PATH variable. (If not, SQL*Net was not
    installed correctly.)
</PRE>
<P><LI> Check that ORA7WIN.DLL and COREWIN.DLL are in the ORACLE BIN directory
<P><PRE>    specified in the PATH variable. (If not, SQL*Net was not installed
    correctly.)
</PRE><P>
</OL><h3>ORA-06120  NETTCP: network driver not loaded</h3>
 
<P>
This error can occur when ORA6WIN.DLL is loaded but cannot find another
SQL*Net component, such as SQLTCP.DLL.

<OL><P><LI> Check that the directories containing the SQL*Net components are in
<P><PRE>    your PATH variable.
</PRE>
<P><LI> Check that the ORACLE_HOME variable is set correctly in your
<P><PRE>    C:\WINDOWS\ORACLE.INI file.
</PRE><P>
<P><PRE>    If ORACLE Server version 6 was already installed on your system,
    ORACLE_HOME should be set twice. The first time, it should be set to
    your version 6 &lt;oraclehome&gt; directory, usually C:\ORACLE6. The second
    time, in the [Oracle] section of the file, it should be set to
    C:\ORAWIN.
</PRE><P>
<P><PRE>    If ORACLE Server was not installed on your system, ORACLE_HOME should
    be set to C:\ORAWIN.
</PRE>
<P><LI> Search for and delete old versions of ORA6WIN.DLL. The correct version
<P><PRE>    of the ORA6WIN.DLL was installed by the ODBC ORACLE driver in the
    SYSTEM subdirectory of your Windows directory.
</PRE>
<P><LI> Check that you have followed all the instructions for the SQL*Net
<P><PRE>    driver you are using. For example, for the SQL*Net for TCP/IP driver,
    make sure that all the TSRs, such as NMTSR and SOCKTSR, are loaded.
    (If not, SQL*Net was not installed correctly.)
</PRE><P>
</OL><h3>ORA-0941: Error Translating Logical Name</h3>
 
<P>
This error may occur when you attempt to access an Oracle server via ODBC
from Microsoft Access or Microsoft Visual Basic running on a client
workstation that uses the SQL*Net TCP/IP protocol for Windows. When this
error occurs, the CONFIG variable in your AUTOEXEC.BAT file that points to
the ORACLE.INI file is invalid. To resolve this error, use the instructions
in step number 6 of the "If ORACLE Server Version 6 is Already Installed"
section above.
<P>
<P><h3>ODBC Error Messages</h3>
 
<P>
The following section explains what to do when you encounter various ODBC
error messages.
<P>
IM003 Driver specified by data source could not be loaded
 
<P>
The ODBC Driver Manager is attempting to load the ODBC ORACLE driver
(SQORA.DLL). SQORA.DLL loads ORA6WIN.DLL to connect to the ORACLE server.
You can receive this message if it cannot find ORA6WIN.DLL or finds the
wrong version of ORA6WIN.DLL.

<OL><P><LI> Search for and delete old versions of ORA6WIN.DLL. The correct version
<P><PRE>    of the ORA6WIN.DLL was installed by the ODBC ORACLE driver in the
    SYSTEM subdirectory of your Windows directory.
</PRE>
<P><LI> Make sure that ORA6WIN.DLL was installed when the ODBC ORACLE driver
<P><PRE>    was installed.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 ODBC Update3.00<BR>
KBCategory: kbinterop kbprg<BR>
KBSubcategory: APrgDataODBC<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 19, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
