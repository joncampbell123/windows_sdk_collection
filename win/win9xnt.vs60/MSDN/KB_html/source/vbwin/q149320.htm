

<HTML>
<HEAD>
<TITLE>BUG: First ListItem Truncated with ListView in Report View </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149320">
<META NAME="KBModify" CONTENT="1996/10/03">
<META NAME="KBCreate" CONTENT="1996/03/30">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If the first item added to a ListView control set to Report view mode is added outside of the Form_Load event, the text of that item can be truncated and not displayed completely. Subsequent ListItem objects added to the ListView display their text...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QATX,QBS0,QAH4,QADK,QAKP,QBWS,QBXS,QA6A,QAW6,QAMB,QAIJ,QAFF,QADZ,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: First ListItem Truncated with ListView in Report View</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149320</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If the first item added to a ListView control set to Report view mode is
added outside of the Form_Load event, the text of that item can be
truncated and not displayed completely. Subsequent ListItem objects added
to the ListView display their text correctly. The problem does not occur if
the text of the ListItem object is specified with the Add method of the
ListItem collection instead of as a separate property assignment.
<P>
Another article detailing a somewhat similar problem with the ListView in
Report, rather than List, view mode is article <B><A href="../vbwin/q149264.htm">Q149264</A></B>, "BUG: ListView in
Report View Truncates First ListItem." This article outlines the different
symptoms of that problem in addition to a different workaround.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
This problem can be avoided in two ways:

<UL><LI>Add the initial ListItem to the ListView during the Form_Load event
   rather than adding at a later time.
<P>
   -or-

<LI>Specify the text of the initial ListItem in the Add method of the
   ListItem collection object instead of as a separate property assignment.
   For example, instead of using this code (assuming lv is a ListItem
   object)
<P>
<P><PRE>      Set lv = ListView1.ListItems.Add
      lv.Text = "This is the string"
</PRE><P>
   use:
<P>
<P><PRE>      Set lv = listview1.ListItems.Add(, , "This is the string")
</PRE><P>
   Any strings added after the initial item can be added in any manner from
   any where in code.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce</h3>
 

<OL><P><LI>Start Visual Basic 4.0. Form1 is created by default.

<P><LI>Add a single ListView control to the form1.

<P><LI>Add this code to the project:
<P>
<PRE>   Private Sub Form_Load()
       ListView1.View = lvwReport
       ListView1.ColumnHeaders.Add , , "Goo"
   End Sub

   Private Sub FOrm_Click()
       Dim lv As ListItem

       Set lv = listView1.ListItems.Add
       lv.Text = "THIS IS A VERY LONG STRING"
   End Sub

</PRE><P><LI>Press F5 or select Start from the Run menu to run the application.

<P><LI>Click the form once and see that the new entry to the ListView is
   truncated and is not completely displayed. Any subsequent clicks to the
   form after this will result in the correct string being displayed.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432<BR>
KBCategory: kbbuglist kbprg<BR>
KBSubcategory: PrgCtrlsCus
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 3, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
