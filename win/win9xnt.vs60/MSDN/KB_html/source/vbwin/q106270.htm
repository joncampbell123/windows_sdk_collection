

<HTML>
<HEAD>
<TITLE>PRB: Illegal to Use Find Method with Table Object Variable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106270">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/11/04">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Using the FindFirst, FindNext, FindLast, or FindPrevious method on an object variable of type Table results in this error:     Can't perform operation; it is illegal.  Pressing the F1 key on this error dialog gives the following description from th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAN0,QAYL,QBS0,QA5V,QAW6,QA5B,QANF,QDKW,QBXS,QAY5,QACI,QAYV,QAO1,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Illegal to Use Find Method with Table Object Variable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106270</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows, version 3.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the FindFirst, FindNext, FindLast, or FindPrevious method on an
object variable of type Table results in this error:
<P>
<PRE>   Can't perform operation; it is illegal.

</PRE>Pressing the F1 key on this error dialog gives the following description
from the Visual Basic Help:
<P>
<PRE>   Error 3219.
   You tried to use a method or property with or on a recordset,
   and it isn't valid for that object.

</PRE><h2>CAUSE</h2>
 
<P>
The FindFirst, FindNext, FindLast, and FindPrevious methods can be used
only with a Dynaset or Snapshot. These Find methods cannot be used with a
Table object variable.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To move between the records of a Table, use the Seek method or the Move
methods (MoveFirst, MoveLast, MoveNext, and MovePrevious).
<P>
Also, you can create a Dynaset or Snapshot variable on the whole Table
by using the CreateDynaset or CreateSnapshot method. Then you can use
the FindFirst, FindNext, FindLast, and FindPrevious methods on that Dynaset
or Snapshot. The Find methods move between records that meet specific
conditions.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following code demonstrates the error using the FindFirst method on a
Table object variable:
<P>
<PRE>   Dim db As database
   Dim recordset As table  ' Correction: Dim recordset As dynaset
   Set db = OpenDatabase("c:\vb3\biblio.mdb")
   Set recordset = db.OpenTable("authors") ' Instead: db.CreateDynaset
   ' The following line gives "can't perform operation; it is illegal":
   recordset.FindFirst "Author like 'a*'"
   Debug.Print recordset.Fields("Author")

</PRE>The following code works around this behavior by first creating a Dynaset
from the Table, and then using FindFirst on the Dynaset:
<P>
<PRE>   Dim db As database
      ' Dim recordset As table   ' Gives problem.
   Dim recordset As dynaset      ' Workaround.
   Set db = OpenDatabase("c:\vb3\biblio.mdb")
      ' Set recordset = db.OpenTable("authors")   ' Gives problem.
   Set recordset = db.CreateDynaset("Authors")    ' Workaround.
   recordset.FindFirst "Author like 'a*'"
   Debug.Print recordset.Fields("Author")

</PRE><h2>REFERENCES</h2>
 
<P>
See "Positioning the Current Record in a Recordset" on Pages 68-77 of
the Visual Basic Professional Edition, version 3.0, "Professional Features
Book 2" manual. Page 72 states, "The Find methods cannot be used on Table
objects."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: APrgDataOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
