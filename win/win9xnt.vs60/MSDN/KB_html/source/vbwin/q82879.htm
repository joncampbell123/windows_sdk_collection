

<HTML>
<HEAD>
<TITLE>VB Example of Using DDE LinkExecute to Word for Windows 2.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82879 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/04/01">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article demonstrates how to send a LinkExecute event to Microsoft Word for Windows from Microsoft Visual Basic for Windows using dynamic data exchange (DDE).  The commands available through DDE with Word for Windows are as follows:   - Any Mac...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBS0,QDL9,QBWQ,QBWO,QBWN,QBV4,QBT6,QAIJ,QAPN,QAH4,QBXS,QAHP,QDO7,QAOX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB Example of Using DDE LinkExecute to Word for Windows 2.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82879 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, version 1.0
- Microsoft Word for Windows, versions 2.0 and 6.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to send a LinkExecute event to Microsoft
Word for Windows from Microsoft Visual Basic for Windows using dynamic
data exchange (DDE).
<P>
The commands available through DDE with Word for Windows are as
follows:

<UL><LI>Any Macro in Word for Windows
<LI>Any embedded WordBasic command built into Word for Windows
<P>
</UL>A full explanation of the above commands can be found in Word for
Windows online Help under the topic "WordBasic."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example program demonstrates how to:

<UL><LI>Automatically start Word for Windows
<LI>Automatically send text typed in a Visual Basic for Windows text
   box to the Word for Windows document
<LI>Print the Word for Windows document to the selected printer.

</UL><OL><P><LI>Start Visual Basic for Windows, or from the File menu, choose New
   Project (press ALT, F, N) if Visual Basic for Windows is already
   running. Form1 is created by default.

<P><LI>Create the following controls with the given properties on Form1:
<P>
<PRE>      Object     Name         Caption
      ----------------------------------
      TextBox    Text1
      Button     Command1     Start Word
      Button     Command2     Link
      Button     Command3     Send Text
      Button     Command4     Print

    (In Visual Basic version 1.0 for Windows set the CtlName Property
     for the above objects instead of the Name property.)

</PRE><P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Sub Command1_Click ()
      x = Shell("winword.exe", 7) ' Start Word for Windows minimized
                                  ' without the focus.
      x = DoEvents()              ' This gives WinWord time to load.
   End Sub

</PRE><P><LI>Add the following code to the Command2_Click event procedure:
<P>
<PRE>   Sub Command2_Click ()
      text1.LinkMode = 0 ' Clears DDE link if it already exists.
      text1.LinkTopic = "WinWord|document1" ' Set up link w/ WINWORD.EXE.

      text1.LinkMode = 2       ' Establish a manual DDE link.
      text1.linktimeout = 60   ' Set the time for a response to 6 seconds.
      ' If a DDETIMEOUT occurs increase the Text1.Linktimeout.

      ' Enter the following two lines as one, single line:
      text1.LinkExecute
         "[InsertBookmark .Name="+Chr$(34)+"Test"+Chr$(34)+"]"

      ' NOTE: the space is necessary as shown before .Name in the above
      ' LinkExecute statement.

      ' For Microsoft Word version 6.0, use the following instead and
      ' enter the two lines as one single line -- after removing the
      ' single quotation mark from the start of both lines:
      ' text1.LinkExecute
      '    "[EditBookmark .Name ="+Chr$(34)+"Test"+Chr$(34)+"]"

      text1.LinkItem = "Test"      ' Set link to a bookmark on document.
   End Sub

</PRE><P><LI>Add the following code to the Command3_Click event procedure:
<P>
<PRE>   Sub Command3_Click ()
      text1.LinkPoke  ' Sends the contents of the text box.
   End Sub

</PRE><P><LI>Add the following code to the Command4_Click event procedure:
<P>
<PRE>   Sub Command4_Click ()
      text1.LinkExecute "[FilePrintDefault]"   ' Prints the doc with the
                                               ' default printer settings.
   End Sub

</PRE><P><LI>Press the F5 key to run the program.

<P><LI>Choose the Start Word button.

<P><LI>Choose the Link button. This will establish a DDE conversation with
   Word's Document1 and create a bookmark called Test using LinkExecute
   and the embedded InsertBookmark WordBasic command. It will then set
   the LinkItem to this newly created bookmark in Document1.

<P><LI>Type some text in the text box and choose the Send Text command
<P><PRE>    button to send the contents of the text box to Word for Windows.
</PRE>
<P><LI>Choose the Print button to print the document in Word for Windows.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbinterop kbprg kbcode<BR>
KBSubcategory: IAPDDE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
