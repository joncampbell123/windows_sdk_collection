

<HTML>
<HEAD>
<TITLE>How to Play an .AVI Video File in Full Screen in Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142389">
<META NAME="KBModify" CONTENT="1996/01/12">
<META NAME="KBCreate" CONTENT="1996/01/10">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT=" This article shows by example how to play an .AVI (video) file in full screen from Visual Basic for Windows. When you play an .AVI file using the full screen, the color palette focus is set to the .AVI file only. No dithering of colors occurs becaus...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBJL,QBJM,QDL9,QBWO,QBWN,QAYS,QDK0,QA5F,QAMA,QBWS,QAH4,QAIJ,QBWQ,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Play an .AVI Video File in Full Screen in Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142389</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0 and 3.0
<LI>Microsoft Visual Basic for Windows, version 1.0
</UL> 
<P>
This article shows by example how to play an .AVI (video) file in full
screen from Visual Basic for Windows. When you play an .AVI file using the
full screen, the color palette focus is set to the .AVI file only. No
dithering of colors occurs because there are no other windows in the
background to capture the color palette.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The example uses the mciSendString application programming interface (API)
from Microsoft Windows version 3.1 or Microsoft Windows version 3.0 with
Multimedia Extensions.
<P>
For the example to work, your computer must be able to play .AVI files and
you need either Microsoft Windows version 3.1 or Microsoft Windows version
3.0 with Multimedia Extensions.
<P>
The .AVI file included in the example (WNDSURF1.AVI) is the one from
Microsoft Video for Windows.
<P>
Information in the Visual Basic 4.0 section applies only to Visual Basic
4.0, and information in the Visual Basic 3.0 section applies only to Visual
Basic 3.0.
<P>
<P><h2>VB 4.0 SECTION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>Add a command button (Command1) to Form1, and set its caption property
   to:  Play Video.

<P><LI>Add the following line of code to the (general) (declarations) section
   of Form1:
<P>
   #If Win32 Then
<PRE>   Private Declare Function mciSendString Lib "winmm.dll" Alias _
   "mciSendStringA" (ByVal lpstrCommand As String, ByVal _
   lpstrReturnString As Any, ByVal uReturnLength As Long, ByVal _
   hwndCallback As Long) As Long
   #Else
   Private Declare Function mciSendString Lib "mmsystem" (ByVal _
   lpstrCommand As String, ByVal lpstrReturnStr As Any, ByVal _
   wReturnLen As Integer, ByVal hCallBack As Integer) As Long
   #End If

</PRE><P><LI>Add the following lines of code to the Command1 Click event procedure:
<P>
<PRE>   Sub Command1_Click ()
   CmdStr$ = "play c:\winvideo\wndsurf1.avi fullscreen "
   ReturnVal&amp; = mciSendString(CmdStr$, 0&amp;, 0, 0&amp;)
   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) to run the program.
<P>
</OL>Click the Play Video button to watch the video full screen. The video
will last for a few seconds and return back to the Visual Basic
environment.
<P>
<P><h2>VB 3.0 SECTION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>Add a command button (Command1) to Form1, and set its caption property
   to:  Play Video.

<P><LI>Add the following line of code to the (general) (declarations) section
   of Form1:
<P>
<PRE>   ' Enter the following Declare statement on one, single line:

   Declare Function mciSendString Lib "mmsystem" (ByVal lpstrCommand$,
   ByVal lpstrReturnStr As Any, ByVal wReturnLen%, ByVal hCallBack%) As
   Long

</PRE><P><LI>Add the following lines of code to the Command1 Click event procedure:
<P>
<PRE>   Sub Command1_Click ()
   CmdStr$ = "play c:\winvideo\wndsurf1.avi fullscreen "
   ReturnVal&amp; = mciSendString(CmdStr$, 0&amp;, 0, 0&amp;)
   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) to run the program.
<P>
</OL>Click the Play Video button to watch the video full screen. The video will
last for a few seconds and return back to the Visual Basic environment.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
