

<HTML>
<HEAD>
<TITLE>PRB: Can't Use ActiveForm to Reference Data Control in VB 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101252">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/07/08">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Using the ActiveForm Property of the Screen control or an MDI Parent form to reference a Data control causes a  Type Mismatch  error in Visual Basic.  CAUSE =====  This behavior is by design. This is not a bug in Visual Basic. The Visual Basic envi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QAPN,QAMN,QBXS,QA7O,QAOE,QAB5,QAFF,QBJZ,QAAP,QAR4,QAB4,QAKP,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Can't Use ActiveForm to Reference Data Control in VB 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101252</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the ActiveForm Property of the Screen control or an MDI Parent
form to reference a Data control causes a "Type Mismatch" error in
Visual Basic.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is by design. This is not a bug in Visual Basic. The
Visual Basic environment does not know in advance that the Active form
will actually contain a Data control, so it generates a "Type mismatch"
error.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid the error message, use global objects to reference the local
controls. The "More Information" section below demonstrates one method
for doing this.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Correct Problem</h3>
 
This example shows how to correct the problem. First, create the
problem by following the steps listed in "Steps to Reproduce Problem."
Then correct the problem with these steps:

<OL><P><LI>Add the following code to the Form_Activate Event:
<P>
<PRE>   Sub Form_Activate ()
      Set CurrentDS = Data1.Recordset
   End Sub

</PRE><P><LI>Change two lines of code into comments by adding a single quotation
   mark to the beginning of the line. Change the Set CurrentDS statement
   in the Set_CurrentDS Sub in Module1 to a comment, and do the same to
   the Call Set_CurrentDS statement in the Form_Click event of Form1.
<P>
</OL><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>Add a data control (Data1) to Form1.

<P><LI>Set the DatabaseName Property of Data1 to BIBLIO.MDB.

<P><LI>From the File menu, choose New Module (ALT, F, M). Module1 is created.

<P><LI>Add the following code to the General section of Module1:
<P>
   Global CurrentDS As DynaSet

<P><LI>Add the following code to Module1:
<P>
<PRE>   Sub Set_CurrentDS ()
      Set CurrentDS = Screen.ActiveForm.Data1.Recordset
   End Sub

</PRE><P><LI>Add the following code to the Form_Click event procedure of Form1:
<P>
<PRE>   Sub Form_Click ()
      Call Set_CurrentDS
   End Sub

</PRE><P><LI>From the Run menu, choose start (ALT, R, S) or press the F5 key.
<P>
</OL>A "Type mismatch" error will occur on the Set statement.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 errmsg<BR>
KBCategory: kbinterop kbprg kbcode kbprb<BR>
KBSubcategory: APrgDataIISAM PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
