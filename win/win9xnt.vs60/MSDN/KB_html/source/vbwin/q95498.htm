

<HTML>
<HEAD>
<TITLE>FIX: Problems Calling DoEvents from a Scroll Bar Change Event </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95498 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/02/11">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  There are two parts to this bug, a paint problem and a stack problem. These two problems can occur when DoEvents is called from the Change event of a scroll bar.   - Clicking either the up or down directional arrows of a scroll bar causes    the ch...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBXQ,QAO4,QAPN,QAH4,QAKP,QBWS,QAY2,QACI,QATK,QAO2,QAEF,QAB4,QAIJ,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Problems Calling DoEvents from a Scroll Bar Change Event</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95498 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 2.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
There are two parts to this bug, a paint problem and a stack problem. These
two problems can occur when DoEvents is called from the Change event of a
scroll bar.

<UL><LI>Clicking either the up or down directional arrows of a scroll bar causes
   the change event to fire repeatedly and generate an "Out of Stack Space"
   error.

<LI>Moving the scroll bar's thumb after clicking either of the directional
   arrows leads to painting problems with the scroll bar.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around the problem, move code containing DoEvents calls from the
change event to a timer event. Then from the scroll bar change event,
enable the timer. For example, add the following steps to those listed in
the "More Information" section to implement this workaround:

<OL><P><LI>Add a Timer control (Timer1) to Form1.

<P><LI>Place the following code in the Timer1_Timer event procedure:
<P>
<PRE>   Sub Timer1_Timer ()
      s! = Timer
      Do
      x% = DoEvents ()
      Loop While Timer - s! &lt;= .25
      timer1.Enabled = 0
   End Sub

</PRE><P><LI>Place the following code in the HScroll1 Change event procedure to
   replace the code added in step 3.
<P>
<PRE>   Sub HScroll1_Change ()
      Print "We are in the Change Event"
      timer1.Interval = 2000
      timer1.Enabled = -1
   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) or press the F5 key to run
<P><PRE>    the program.
</PRE><P>
</OL>Now you should be able to click the directional arrows of the scroll bar
and move the scroll thumb without encountering either of the two problems.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Microsoft Visual Basic version
2.0. The stack problem was corrected in Microsoft Visual Basic version 3.0.
However, the paint problem still exists.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic, or from the File menu, choose New Project if Visual
   Basic is already running. Form1 is created by default.

<P><LI>Add a horizontal scroll bar (HScroll1) to Form1.

<P><LI>Add the following code in the HScroll1_Change event procedure of Form1:
<P>
<PRE>   Sub HScroll1_Change ()

      Print "We are in the Change Event"

      s! = Timer
      Do
      x% = DoEvents ()
      Loop While Timer - s! &lt;= .25

   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) or press the F5 key to run
   the program.
<P>
</OL>To demonstrate the problem of Change events being fired repeatedly, click
either of the scroll bar's directional arrow buttons and leave the mouse
cursor over the directional arrow. This will eventually lead to an "Out of
stack space" error message.
<P>
To demonstrate the painting problems, click either of the arrows. Then move
the scroll thumb of the scroll bar in any direction. The scroll bar will be
painted incorrectly. This will also lead to an "Out of stack space" error
message.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist2.00 fixlist3.00 2.00 3.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
