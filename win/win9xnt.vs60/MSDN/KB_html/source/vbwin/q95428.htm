

<HTML>
<HEAD>
<TITLE>FIX: Error Message: Timeout While Waiting for DDE Response </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95428 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/02/09">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You can get the error  Timeout while waiting for DDE response  if you execute DDE commands within a DDE event. This occurs due to a limitation of the Dynamic Data Exchange Management Library (DDEML.DLL) that provides support for DDE under Windows. ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZ2,QBS0,QAO4,QAPN,QAH4,QAB4,QBJZ,QAFF,QBT6,QBV4,QAKP,QBUG,QBUF,QDL9,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Error Message: Timeout While Waiting for DDE Response</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95428 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00
WINDOWS
kbinterop kbprg kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Standard and Professional editions of Microsoft Visual Basic
   programming system for Windows, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You can get the error "Timeout while waiting for DDE response" if you
execute DDE commands within a DDE event. This occurs due to a limitation
of the Dynamic Data Exchange Management Library (DDEML.DLL) that provides
support for DDE under Windows. This problem may also occur if you place DDE
commands in an event that is triggered by a DDE command such as the Change
event of a text box.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem occurs because changing the text under the Destination Data
section of the DDE source causes a Text1_Change event. Since this is a DDE
related event, attempting to perform a DDE operation such as
text2.LinkRequest results in the timeout error message.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around the problem, perform all DDE operations in non-DDE
related events. If you need to perform a DDE operation in a DDE related
event, you can put the DDE operations in a timer event that will execute
after the DDE related event has finished. Here is an example:

<OL><P><LI>Follow steps 1 through 7 in the More Information section below.

<P><LI>Place a timer control (Timer1) on Form1.

<P><LI>Set the Interval property of Timer1 to 1.

<P><LI>Set the Enabled property of Timer1 to False.

<P><LI>In the Text1_Change event, enter the following code:
<P>
<PRE>   Sub Text1_Change ()
      Timer1.Enabled = True
   End Sub

</PRE><P><LI>In the Timer1_Timer event, enter the following code:
<P>
<PRE>   Sub Timer1_Timer ()
      text2.LinkRequest
      Timer1.Enabled = False
   End Sub

</PRE><P><LI>Run the program.

<P><LI>Change the text in the Destination Data section of the compiled DDE
   sample application.
<P>
</OL>Text1 should correctly display the text typed into the Destination Data
section of the compiled DDE sample application without producing an error.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Standard and
Professional editions of Microsoft Visual Basic version 2.0 for Windows.
This problem was corrected in Microsoft Visual Basic version 3.0 for
Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic, or from the File menu, choose New Project
   (ALT, F, N) if Visual Basic is already running.

<P><LI>Open the DDE sample program located in the \SAMPLES\DDE directory.

<P><LI>From the File menu, choose Make EXE File (ALT, F, K).

<P><LI>Start the compiled .EXE program from Program Manager or File Manager.

<P><LI>From the File menu, choose New Project (ALT, F, N). Form1 is created
   by default.

<P><LI>Place two text boxes on Form1.

<P><LI>In the Form_Load event, enter the following code:
<P>
<PRE>   Sub Form_Load ()

      text1.LinkMode = 0
      text1.LinkTopic = "dde|system"
      text1.LinkItem = "txtdata"
      text1.LinkMode = 1  'Establish an automatic link

      text2.LinkMode = 0
      text2.LinkTopic = "dde|system"
      text2.LinkItem = "txtdata"
      text2.LinkMode = 2  'Establish a manual link

   End Sub

</PRE><P><LI>In the Text1_Change event, enter the following code:
<P>
<PRE>   Sub Text1_Change ()
      text2.LinkRequest
   End Sub

</PRE><P><LI>Run the program.

<P><LI>Change the text in the Destination Data section of the compiled DDE
<P><PRE>    sample application.
</PRE><P>
</OL>After approximately five seconds, you will receive the error "Timeout
while waiting for DDE response."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist2.00 fixlist3.00 2.00 3.00<BR>
KBCategory: kbinterop kbprg kbbuglist<BR>
KBSubcategory: IAPDDE<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
