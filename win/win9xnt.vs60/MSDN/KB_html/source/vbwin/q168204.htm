

<HTML>
<HEAD>
<TITLE>HOWTO: Kill an Application with System Menu Using VB5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168204">
<META NAME="KBModify" CONTENT="1997/10/16">
<META NAME="KBCreate" CONTENT="1997/05/07">
<META NAME="Keywords" CONTENT="APrgOther vb5all vb5howto kbcode kbusage kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Microsoft Visual Basic for Windows can use the Microsoft Windows API SendMessage function to close any active window that has a system menu (referred to as the Control Box within Visual Basic for Windows) with the Close option.  MORE INFORMATION  T...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDL9,QBWO,QBWN,QAIJ,QBWS,QAY5,QAH4,QBWQ,QALZ,QBV8,QABA,QAGB,QAB9,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Kill an Application with System Menu Using VB5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168204</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional and Enterprise Editions
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Visual Basic for Windows can use the Microsoft Windows API
SendMessage function to close any active window that has a system menu
(referred to as the Control Box within Visual Basic for Windows) with the
Close option.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This sample program uses the Windows API SendMessage function to post a
message to any window in the environment, provided the handle to the window
is known. The API FindWindow function is used to determine the handle
associated with the window the user wants to close. To use FindWindow, you
must know either the ClassName or the Caption (if any) of that window.
Please see the REFERENCES section below for more information.
<P>
<P><h3>Steps to Create Example Program</h3>
 

<OL><P><LI>Start Visual Basic 5.0 and select Standard EXE. If Visual Basic 5.0 is
   already running, click New Project on the File menu and select Standard
   EXE. Form1 is created by default.

<P><LI>Create two Command Buttons called Command1 and Command2.

<P><LI>On the Project menu, click Add Module (ALT, P, M). Module1 is
   created by default.

<P><LI>In the Declarations section, declare the following two API functions:
<P>
<P><PRE>      Declare Function FindWindow _
       Lib "user32" Alias "FindWindowA" _
       (ByVal lpClassName As String, _
       ByVal lpWindowName As String) _
       As Long
</PRE><P>
<P><PRE>      Declare Function SendMessage _
       Lib "user32" Alias "SendMessageA" _
       (ByVal hwnd As Long, _
       ByVal wMsg As Long, _
       ByVal wParam As Long, _
       lParam As Long) _
       As Long
</PRE>
<P><LI>Within the Command1 Click event, add the following code:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         Shell "Calc.exe", vbNormalFocus
      End Sub

</PRE><P><LI>Within the Command2 Click event, add the following code:
<P>
<P><PRE>      Private Sub Command2_Click()
<PRE></PRE>         Dim lpClassName As String
         Dim lpCaption As String
         Dim Handle As Long

         Const NILL = 0&amp;
         Const WM_SYSCOMMAND = &amp;H112
         Const SC_CLOSE = &amp;HF060&amp;

         lpClassName = "SciCalc"
         lpCaption = "Calculator"

      '* Determine the handle to the Calculator window.
         Handle = FindWindow(lpClassName$, lpCaption$)

      '* Post a message to Calc to end its existence.
         Handle = SendMessage(Handle, WM_SYSCOMMAND, SC_CLOSE, NILL)

      End Sub

</PRE><P><LI>On the Run menu, click Start or press the F5 key to start the program.
   Clicking the Command1 button starts a (new) instance of the Windows
   Calculator accessory. Clicking on the Command2 button kills an instance
   of the Calculator.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information on the FindWindow and SendMessage functions, query on
the following words in the Microsoft Knowledge Base:
<P>
<PRE>   FindWindow and Visual Basic or SendMessage and Visual Basic

</PRE></OL>For information on a different sample application that returns assorted
information for a windowed application, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q112649.htm">Q112649</A></B>
   TITLE     : How to Get a Window's Class Name and Other Window Attributes
</PRE> 
<PRE>Keywords          : APrgOther vb5all vb5howto kbcode kbusage kbhowto
Version           : 5.0
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
