

<HTML>
<HEAD>
<TITLE>FIX: Crash When Viewing Data Tips on ParamArray </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171835">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/07/23">
<META NAME="Keywords" CONTENT="vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A crash may occur while trying to display Data Tips in the IDE. This can occur when you have a variant that contains an array of non-variants and pass the element of that array to a ParamArray.  STATUS ======  Microsoft has confirmed this to be a b...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QDO3,QAR4,QAMA,QAB4,QAO2,QA56,QA55,QAYL,QAM1,QAO3,QA5F,QANE,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Crash When Viewing Data Tips on ParamArray</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171835</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A crash may occur while trying to display Data Tips in the IDE. This can
occur when you have a variant that contains an array of non-variants and
pass the element of that array to a ParamArray.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 2, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new Standard EXE Project in Visual Basic 5.0.

<P><LI>Click on Project | Add Module to add a basic module to the project. Note
   that if you have Visual Basic 5.0 set up to automatically include
   "Option Explicit" to new modules, remove this line.

<P><LI>In the General Declarations area of the module, add the following code:
<P>
<PRE>      Sub main()
          Dim x(5) as integer
          v = x
          r = Formt("????", v(5))
      End Sub

      Public Function Formt(str As String, ParamArray rgArgs()) As String
          Dim var As Variant
          Dim iPos As Integer, iLastPos As Integer
          Dim strRet As String

          iPos = 0
          iLastPos = 1
          For Each var In rgArgs
              iPos = InStr(iPos + 1, str, "?")
              If iPos &lt; 1 Then Exit For
              strRet = strRet &amp; Mid(str, iLastPos, iPos - iLastPos)
              strRet = strRet &amp; var
              iLastPos = iPos + 1
          Next

          If Len(str) &gt; iPos Then strRet = _
                        strRet &amp; Right(str, Len(str) - (iPos))

          Formt = strRet
      End Function

</PRE><P><LI>From the Project menu select the Project1.Properties. On the General
   tab, make Sub Main the Startup Object.

<P><LI>Press the F5 key to run this program.

<P><LI>You will get a Type Mismatch error. Click on the dialog's Debug
   button.

<P><LI>In the following line of code:
<P>
<P><PRE>      strRet = strRet &amp; Mid(str, iLastPos, iPos - iLastPos)
</PRE><P>
   move the mouse pointer over the variable str to display the Data Tips.
   Once the Data Tip for this variable has been displayed, move to the next
   variable, iLastPos, to display its Data Tip. Go back and forth between
   the two variables several times.

<P><LI>Go to the following line of code:
<P>
<P><PRE>       Public Function Format(str As String, ParamArray rgArgs()) _
<PRE></PRE>               As String

   and move the mouse pointer over rgArgs. At this point an Invalid
   Page Fault and an application error in Visual Basic is displayed.
</PRE></OL> 
<PRE>Keywords          : vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
