

<HTML>
<HEAD>
<TITLE>Retrieving Groups &amp; Items from Program Manager Using DDE in VB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112384">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/03/07">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Program Manager (Progman) has a DDE command-string interface that allows other applications to view the groups and items that currently exist within Progman.  MORE INFORMATION  Perform the following steps to produce an application that will retriev...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QAH4,QBS0,QAFF,QBUG,QBUF,QDL9,QBWO,QBWN,QAZ2,QBXT,QBWS,QA5V,QAY2,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Retrieving Groups &amp; Items from Program Manager Using DDE in VB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112384</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic
<PRE>  programming system for Windows, versions 1.0, 2.0, and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Program Manager (Progman) has a DDE command-string interface that allows
other applications to view the groups and items that currently exist within
Progman.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Perform the following steps to produce an application that will retrieve
the group and items from Progman by using DDE:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add two Text box controls (tGroups and tItems) to Form1. Set the visible
   property on both to false. The DDE link needs these controls.

<P><LI>Add two Combo box controls (ComGroups and ComItems) to Form1.

<P><LI>Add a Command button (cGroups) to Form1 and change the caption
   property to Groups.

<P><LI>Add the following code to the cGroups_Click () event:
<P>
<PRE>   Sub cGroups_Click ()
      Dim sGroups As String
      Dim pos As Integer
      On Error GoTo GError
      tGroups.LinkMode = 0
      tGroups.LinkTopic = "Progman|Progman"
      tGroups.LinkMode = 2
      tGroups.LinkItem = "groups"
      tGroups.LinkRequest

      ' Parse groups that come back:
      sGroups = tGroups.Text
      pos = InStr(1, sGroups, Chr(13))
      While pos
         ComGroups.AddItem RTrim$(Mid$(sGroups, 1, pos - 1))
         sGroups = LTrim$(Mid$(sGroups, pos + 2))
         ' The + 2 on the previous line gets past the line feed chr(10)
         pos = InStr(1, sGroups, Chr(13))
      Wend

      ' Select first member in combo box:
      ComGroups.ListIndex = 1
      GDone:
         tGroups.LinkMode = 0
         Exit Sub
      GError:
         MsgBox "Error in getting groups"
         Resume GDone
   End Sub

</PRE><P><LI>Add another Command button (cItems) to Form1, and change the caption to
   Items.

<P><LI>Add the following code to the cItems_Click () event:
<P>
<PRE>   Sub cItems_Click ()
      Dim sItems As String
      On Error GoTo IError

      ' Clear the combo box:
      ComItems.Clear
      If (Len(ComGroups.Text)) Then
         tItems.LinkMode = 0
         tItems.LinkTopic = "Progman|Progman"
         tItems.LinkMode = 2
         tItems.LinkItem = ComGroups.Text
         tItems.LinkRequest

         ' Parse items that come back:
         sItems = tItems.Text
         pos = InStr(1, sItems, Chr(13))
         While pos
            ComItems.AddItem RTrim$(Mid$(sItems, 1, pos - 1))
            sItems = LTrim$(Mid$(sItems, pos + 2))
            ' The + 2 on the previous line gets past the line feed chr(10)
            pos = InStr(1, sItems, Chr(13))
         Wend
      End If

      ' Select first member in combo box:
      ComItems.ListIndex = 1
      IDone:
         tItems.LinkMode = 0
         Exit Sub
      IError:
         MsgBox "Error in getting items"
         Resume IDone
   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) or press the F5 key to run
   the program. Press the Groups button and all the groups on Progman will
   be loaded into the ComGroups Combo box. Then press the Items button
   and all the items in the group selected in the ComGroups Combo box
   will be put into the ComItems Combo box.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
More information can be found in:

<UL><LI>"Programmers Reference, Volume 1: Overview Microsoft Windows SDK,"
   Chapter 17, "Shell Dynamic Data Exchange Interface DDEML."
<LI>Progman topic in the Windows SDK Help menu.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00 interop icon<BR>
KBCategory: kbinterop kbprg kbcode<BR>
KBSubcategory: IAPDDE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
