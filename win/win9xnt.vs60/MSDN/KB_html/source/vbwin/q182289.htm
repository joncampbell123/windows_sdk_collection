

<HTML>
<HEAD>
<TITLE>PRB: DBGRID Can Cause VB5 To Crash When Scrolling Horizontally </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182289">
<META NAME="KBModify" CONTENT="1998/03/11">
<META NAME="KBCreate" CONTENT="1998/03/10">
<META NAME="Keywords" CONTENT="vb5all vbwin">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Using the Remote Data Control and DBGrid can cause Visual Basic 5.0 to crash when scrolling horizontally in the DBGrid (dbgrid32.ocx).  RESOLUTION  Either size the grid so there is no need to scroll horizontally or implement the FlexGrid control.  ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QA7O,QAOE,QAMN,QBXQ,QBXS,QANN,QARR,QAAL,QDJO,QA4H,QAYY,QAVX,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: DBGRID Can Cause VB5 To Crash When Scrolling Horizontally</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182289</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the Remote Data Control and DBGrid can cause Visual Basic 5.0 to
crash when scrolling horizontally in the DBGrid (dbgrid32.ocx).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Either size the grid so there is no need to scroll horizontally or
implement the FlexGrid control.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem only occurs on Windows 95.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Run the following SQL Server script file on SQL Server:
<P>
<P><PRE>      if exists (select * from sysobjects
<PRE></PRE>        where id = object_id('dbo.test') and sysstat &amp; 0xf = 3)
       drop table dbo.test
      GO

      CREATE TABLE dbo.test
      ( id int NOT NULL , a char (255) NULL , b char (255) NULL ,
      c char (255) NULL , d char (255) NULL )
      GO

</PRE><P><LI>Create a new project in Visual Basic 5.0. Form1 is created by default.

<P><LI>Add a Remote Data Control, a DBGrid, and a CommandButton to Form1.

<P><LI>Set the appropriate properties for the Remote Data Control to
   connect with the Server.

<P><LI>Set the following properties for the DBGrid control accordingly:
<P>
<P><PRE>      DataSource = MSRDC1
</PRE>
<P><LI>Add the following code to the CommandButton's Click method:
<P>
<P><PRE>      Dim con As rdoConnection
      Dim rs As rdoResultset
      Set con = rdoEngine(0).OpenConnection("", _
<PRE></PRE>         rdDriverNoPrompt, _
         false, _
         "DRIVER={SQL Server};" _
         &amp; "SERVER=&lt;server_name&gt;;" _
         &amp; "UID=&lt;userID&gt;;" _
         &amp; "PWD=&lt;password&gt;;" _
         &amp; "DATABASE=&lt;databasename&gt;")"
      For i = 1 To 30
       Set rs = con.OpenResultset("INSERT INTO test (id,a,b,c)" _
        &amp; " VALUES (" &amp; i &amp; " ,'" &amp; CStr(i) " _
        &amp; "','2222222222222222222222222','3333333333333333333333333')")"
       Debug.Print i
      Next i

</PRE><P><LI>Save the Project and run it. Under Components on the Project menu, check
   the Microsoft Remote Data Control.

<P><LI>When the form is loaded, press the CommandButton to populate the table,
   MSRDC, and grid.

<P><LI>When the grid is populated, scroll down using the mouse and the DOWN
   ARROW button on the grid, and then try scrolling to the right.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: gpf<BR>
Keywords          : vb5all vbwin<BR>
Version           : WINDOWS:5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
