

<HTML>
<HEAD>
<TITLE>HOWTO: List Stored Procedures in a SQL Server Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154756">
<META NAME="KBModify" CONTENT="1997/07/14">
<META NAME="KBCreate" CONTENT="1996/08/14">
<META NAME="Keywords" CONTENT="APrgDataRDO kbusage vb432 vb4win vb5all vb5howto kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Some programmers require the ability to list all of the stored procedures from a SQL Server database. The following example demonstrates how to use SQL syntax to instruct SQL Server to return information regarding the stored procedures and their pa...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QABM,QAE1,QBXS,QAZV,QAB9,QBVR,QANF,QAI5,QBG2,QA4H,QAY2,QANE,QAGI,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: List Stored Procedures in a SQL Server Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154756</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for Windows,
   version 5.0
<LI>Enterprise Edition of Microsoft Visual Basic for Windows,
   32-bit only, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Some programmers require the ability to list all of the stored procedures
from a SQL Server database. The following example demonstrates how to use
SQL syntax to instruct SQL Server to return information regarding the
stored procedures and their parameters.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example uses RDO to create a list of the stored procedures
held in the SQL Server pubs database:

<OL><P><LI>Start a new Project in Visual Basic. Form1 is created by default.

<P><LI>Add a Command button (Command1) and a List Box (List1) to Form1.

<P><LI>Add the following code to Form1:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>        Dim cn As rdoConnection
        Dim ps As rdoPreparedStatement
        Dim rs As rdoResultset
        Dim strConnect As String
        Dim strSQL As String
        'open a connection to the pubs database using DSNless connections
        'change the Server argument to match your SQL Server
        strConnect = "Driver={SQL Server}; Server=myserver; " &amp; _
                     "Database=pubs; Uid=sa; Pwd="
        Set cn = rdoEnvironments(0).OpenConnection(dsName:="", _
                 Prompt:=rdDriverNoPrompt, _
                 ReadOnly:=False, _
                 Connect:=strConnect)

        strSQL = "Select so.name,sc.name,st.name,sc.length " &amp; _
           "FROM syscolumns sc,master..systypes st,sysobjects so " &amp; _
           "WHERE sc.id in (select id from sysobjects where type ='P')" &amp; _
           " AND so.type ='P' " &amp; _
           "AND sc.id = so.id " &amp; _
           "AND sc.type = st.type " &amp; _
           "AND sc.type &lt;&gt; 39"
        'create a prep stmt for the stored proc call
        Set ps = cn.CreatePreparedStatement("MyPs", strSQL)

        Set rs = ps.OpenResultset(rdOpenStatic)

        'add the first resultset to a list box
        list1.AddItem "SP Name,Param Name,Data Type,Length"
        While Not rs.EOF
           list1.AddItem rs(0) &amp; " , " &amp; rs(1) &amp; " , " &amp; rs(2) &amp; " , " &amp; _
                         rs(3)
           rs.MoveNext
        Wend
        'Close the resultset and the connection and set both to nothing
        rs.Close
        Set rs = Nothing
        cn.Close
        Set cn = Nothing
      End Sub

      Private Sub Form_Load()
        Command1.Caption = "List all Stored Procedures"
      End Sub

</PRE><P><LI>Press the F5 key to run the program. Click the button labeled "List
   all Stored Procedures." A List of all stored procedures and their
   parameters should now appear.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q153234.htm">Q153234</A></B>
   TITLE     : How To Call System-Stored Procedures on SQL Server from RDO

   ARTICLE-ID: <B><A href="../vbwin/q147875.htm">Q147875</A></B>
   TITLE     : How to Use "DS-Less" ODBC Connections with RDO and DAO
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : APrgDataRDO kbusage vb432 vb4win vb5all vb5howto kbhowto<BR>
Version             : 4.0 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
