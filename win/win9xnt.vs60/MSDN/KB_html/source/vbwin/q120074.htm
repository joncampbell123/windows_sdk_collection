

<HTML>
<HEAD>
<TITLE>SAMPLE: Use ZAP.EXE to Find Duplicate DLLs and VBXs in VB 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120074">
<META NAME="KBModify" CONTENT="1997/09/17">
<META NAME="KBCreate" CONTENT="1994/08/31">
<META NAME="Keywords" CONTENT="kbenv kbfile kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  It is not uncommon for Windows programs to ship with libraries of routines known as dynamic link libraries (DLLs). As more and more applications ship these types of files, duplicates of files tend to accumulate.  The ZAP.EXE sample program is usefu...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBVR,QAMA,QDL9,QBWQ,QBWO,QBWN,QA9N,QBS0,QAFO,QAY2,QAEF,QADF,QAX6,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Use ZAP.EXE to Find Duplicate DLLs and VBXs in VB 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120074</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 3.00
WINDOWS
kbenv kbprg kbfile kbhowto
<P>
 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
It is not uncommon for Windows programs to ship with libraries of routines
known as dynamic link libraries (DLLs). As more and more applications ship
these types of files, duplicates of files tend to accumulate.
<P>
The ZAP.EXE sample program is useful for finding duplicated DLLs and VBXs
in a system, which could potentially cause problems. It can search the same
places searched by Windows when a VBX or DLL is loaded. The sample code
demonstrates several API functions, both in the interface and in the
primary algorithms.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual Basic support engineers regularly encounter problems caused by users
with more than one copy of a particular DLL or VBX. The ZAP.EXE utility
makes what used to be a tedious and time-consuming problem a great deal
easier and quicker to solve. The main features of ZAP.EXE are as follows:

<UL><LI>It can search any combination of the MS-DOS search path, the Windows
   search path (that is, \WINDOWS and \WINDOWS\SYSTEM), and a recursive
   search path through the hard disk starting at any directory.

<LI>It can find DLLs, VBXs, and/or any other file specification.

<LI>The size, date and time of creation, and (where possible) version number
   of each file is returned, making analysis simple.

<LI>You can delete files from within the ZAP.EXE utility by selecting the
   file in the list box display and pressing the DELETE key or by dragging
   and dropping the file from the list box into the trash can icon.

<LI>You can copy or move files by dragging and dropping the file into the
   diskette icon and then selecting a destination for the file.
<P>
</UL>The included source code is fully commented. The special features of the
code are as follows:

<UL><LI>Tabbed list box and tabbed text box that use a font other than the
   system font

<LI>List box with bound horizontal scroll bar

<LI>Data structure designed to make sorting of data much quicker

<LI>Drag-and-drop feature

<LI>Feature that checks to see whether a DLL or VBX is in use before
   deleting it.

<LI>Increased-speed method of getting a directory listing

<LI>Use of the Windows API to get file version numbers
<P>
</UL>The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/zap10.exe">Zap10.exe</A> <I>(size: 44668 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from
               Online Services

</PRE>After downloading Zap10.exe, run it to extract the files it contains.
They are as follows:
<P>
Filename  Extension  Description
--------  ---------  ---------------------------------------------
<PRE>ZAP       EXE        The application itself
ZAP       MAK        The project file
MAIN      FRM        The main form
MAIN      FRX        Binary file associated with MAIN.FRM
ABOUT     FRM        The about box
WAIT      FRM        Form displayed during processing
COPYDEST  FRM        Form for selecting copy/move destination
ADT       BAS        Code module containing the main data structure
                     and the procedure to manipulate it
GLOBAL    BAS        Code module containing global variables, API
                     declarations, and type definitions.
USE       TXT        Instruction on how to use this tool
KB        TXT        This document
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv kbprg kbfile kbhowto<BR>
KBSubCategory: EnvtRun kbsample<BR>
Additional reference words: 2.00 3.00 drag-and-drop softlib<BR>
Keywords          : kbenv kbfile kbhowto kbprg<BR>
Version           : 2.00 3.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
