

<HTML>
<HEAD>
<TITLE>HOWTO: Capture the Parameters from an SQL Procedure with RDO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159657">
<META NAME="KBModify" CONTENT="1997/07/15">
<META NAME="KBCreate" CONTENT="1996/11/18">
<META NAME="Keywords" CONTENT="PrgOther vb432 VB4WIN kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article demonstrates how to capture the output parameters from an SQL procedure.  An rdoParameter object represents a parameter associated with an rdoPreparedStatement object. You use the Direction property of the rdoParameter object to determ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBS0,QAHE,QAVX,QAUD,QA5A,QABM,QAB9,QAY2,QAVW,QAPN,QANF,QANE,QAIJ,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Capture the Parameters from an SQL Procedure with RDO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159657</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Enterprise Edition of Microsoft Visual Basic for Windows, 32-bit only,
   version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to capture the output parameters from an
SQL procedure.
<P>
An rdoParameter object represents a parameter associated with an
rdoPreparedStatement object. You use the Direction property of the
rdoParameter object to determine whether the parameter is used for input,
output, both, or as a return value from the stored procedure.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Program</h3>
 
<P>
<P><h3>Step 1: Create the Stored Procedure</h3>
 

<OL><P><LI>Open the SQL Server 6.5 ISQL utility and change the default database to
   Pubs.

<P><LI>Paste the following code in the Query window:
<P>
<P><PRE>      create procedure test
      @result1 integer output, @result2 integer output
      as
      select @result1 = 100
      select @result2 = 200
</PRE>
<P><LI>Click Execute Query or press CTRL+E to execute the Transact-SQL code.

<P><LI>The following confirmation message appears:
<P>
   "This command did not return data, and it did not return any rows"
<P>
   This indicates that the Transact-SQL code created the stored procedure
   correctly.
<P>
</OL><h3>Step 2: Create the Visual Basic Code</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a CommandButton(Command1) to Form1.

<P><LI>Paste the following code into the General Declarations section of Form1:
<P>
<PRE>         Private Sub Command1_Click()
      Dim rdoEnv As rdoEnvironment
      Dim rdoConn As rdoConnection
      Dim strConn As String
      Dim ps As rdoPreparedStatement
   
      Set rdoEnv = rdoEngine.rdoEnvironments(0)
         rdoEnv.CursorDriver = rdUseOdbc
         '***You need to change the SERVER, UID, and PWD parameters here.
      strConn = "driver={SQL Server};server=myserver;" &amp; _
      "database=pubs;uid=sa;pwd="
         Set rdoConn = rdoEnv.OpenConnection( _
           dsName:="", _
           Prompt:=rdDriverNoPrompt, _
           ReadOnly:=False, _
           Connect:=strConn)

            Set ps = rdoConn.CreatePreparedStatement _
              ("", "{Call test(?,?)}")
      ps.Type = 2
         ps.rdoParameters(0).Direction = rdParamOutput
         ps.rdoParameters(1).Direction = rdParamOutput
         ps.Execute
         Debug.Print ps.rdoParameters(0).Value, ps.rdoParameters(1).Value
      rdoConn.Close
         rdoEnv.Close
        End Sub

</PRE><P><LI>Press the F5 key to start the program.

<P><LI>Click the Command1 button to execute the code and display the output
   parameter in the debug window.
</OL> 
<PRE>Keywords          : PrgOther vb432 VB4WIN kbhowto
Version           : 4.0
Platform          : NT WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
