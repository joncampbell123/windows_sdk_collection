

<HTML>
<HEAD>
<TITLE>FIX: Missing Controls on the SSTAB Control Tabs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167107">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/04/17">
<META NAME="Keywords" CONTENT="PrgCtrlsCus vb432 VB4WIN vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  One or more of the tabs on the SSTAB control is missing its controls when displayed at run-time.  CAUSE =====  The SSTab control does not respond correctly when attempting to manipulate the Tab or TabVisible properties from the Form-Load event. If ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAPN,QAOE,QAMN,QARP,QBS0,QABA,QBXS,QAR4,QADO,QDO3,QAO4,QAM1,QAKJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Missing Controls on the SSTAB Control Tabs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167107</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
   on the following platforms: NT, Win95
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   32-bit only, for Windows, version 4.0
   on the following platforms: NT, Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
One or more of the tabs on the SSTAB control is missing its controls when
displayed at run-time.
<P>
<P><h2>CAUSE</h2>
 
<P>
The SSTab control does not respond correctly when attempting to manipulate
the Tab or TabVisible properties from the Form-Load event. If the SSTab
control has not completely finished initializing when you attempt to set
the Tab property to reflect a value different than the default, then the
controls are still located in their temporary holding area at -72960. The
Tab will display without its controls. To guarantee that the SSTab control
has finished initializing, you can access its properties from any event
after Form_Load has completed and the SSTab can receive the focus. This
will occasionally work from the Form_Load event but has inconsistent
behavior when you have various controls on one the tabs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Tab Property</h3>
 
<P>
If you attempt to set a certain tab as the current tab on initial display,
then setting the Tab property in either the Form_Activate event or the
SSTab1.Got_Focus event instead of the Form_Load event fixes this problem,
as follows:
<P>
<PRE>   Private Sub Form_Activate
   Static bReactivate as Boolean  'default is false
   If Not bReactivate Then
    SSTab1.Tab = GetSetting("MyApp","Settings","MyTab",0)
    bReactivate = True
   End If
   End Sub

</PRE><h3>TabVisible Property</h3>
 
<P>
If you attempt to display only a certain tab on initial display, then
setting the desired tab as the current tab and then setting the REMAINING
tabs TabVisible property to false in reverse order (leaving the current tab
set to visible) from either the Form_Activate event or the SSTab.Got_Focus
events solves this problem, as follows:
<P>
<PRE>   Private Sub Form_Activate()
   Static bReactivate as Boolean  'default is false
    If Not bReactivate Then
     SSTab1.Tab = GetSetting("MyApp","Settings","MyTab",0)
     For i = SSTab1.Tabs - 1 To 0 Step -1
      If SSTab1.Tab &lt;&gt; i Then
       SSTab1.TabVisible(i) = False
      End If
     Next i
     bReactivate = True
    End If
   End Sub

</PRE>This code assumes that have stored an entry "MyTab" in the registry.
<P>
The GetSetting function can be replaced with a module level Public integer
variable and set as needed.

<UL><LI>You should not make the current tab invisible using
   SSTab1.TabVisible() = False.

<LI>You should not set an invisible tab as the current tab.

<LI>You should always leave at least one 'tab' set to visible. If you want
   to make all the tabs invisible, use SSTab1.Visible = False
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 2, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Activate &amp; Got_Focus</h3>
 
<P>
If you do not want the tab selected every time the SSTab control or the
form its on receives focus, then use a Static flag such as bReactivate in
the sample. If you do want the tab to be set every time the form receives
focus, then remove the flag:
<P>
<PRE>   Private Sub Form_Activate
    SSTab1.Tab = GetSetting("MyApp","Settings","MyTab",0)
   End Sub

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
<P><h3>SSTab Control</h3>
 
<P>
Tab property:

<OL><P><LI>Put an SSTab control with five tabs on a form.

<P><LI>Add a textbox to each tab.

<P><LI>Click on tab 0 to set design time current tab to 0.

<P><LI>In Form_Load, add:
<P>
<P><PRE>      SSTab1.Tab = 3
</PRE>
<P><LI>Run the project and note that the textbox will be gone. The textbox is
   actually at -72960.
<P>
</OL>Tabvisible property:

<OL><P><LI>Put an SSTab control with three tabs on a form.

<P><LI>Add a textbox to each tab.

<P><LI>In form load, add:
<P>
<P><PRE>      sstab1.tabvisible(0) = false
      sstab1.tabvisible(1) = false
      sstab1.tabvisible(2) = false
      *(this will fail with the older SSTab, giving invalid property value)
</PRE>
<P><LI>Put three CommandButtons on the form, reversing what was done in
   form load:
<P>
<P><PRE>      sstab1.tabvisible(0) = true
      sstab1.tabvisible(1) = true
      sstab1.tabvisible(2) = true
</PRE><P>
  Note that the textbox will be gone; it is actually at -72960.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q149328.htm">Q149328</A></B>
   TITLE     : Selecting Invisible Tab Can Cause GPF with SSTab Control
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: missing invisible<BR>
Keywords          : PrgCtrlsCus vb432 VB4WIN vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2<BR>
Version           : 4.0 5.0<BR>
Platform          : NT Win95 WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbservicepack<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
