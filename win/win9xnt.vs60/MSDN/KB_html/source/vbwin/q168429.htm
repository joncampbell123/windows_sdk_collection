

<HTML>
<HEAD>
<TITLE>PRB: Component Download Fails for DCOM Projects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168429">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1997/05/12">
<META NAME="Keywords" CONTENT="kberrmsg vb5all VBKBInet VBKBSetup VBKBToolkit kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Component Download Fails for DCOM Projects when using Setup Wizard to create download files. If you have included a Remote Object in an ActiveX Document setup, you could see the following error on code download:      Internet Explorer is opening fi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDIY,QBS0,QAO0,QAH4,QAJQ,QAFI,QAH0,QBWS,QABI,QDK6,QDI2,QDIZ,QBXB,QATJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Component Download Fails for DCOM Projects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168429</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Component Download Fails for DCOM Projects when using Setup Wizard to
create download files. If you have included a Remote Object in an ActiveX
Document setup, you could see the following error on code download:
<P>
<PRE>   "Internet Explorer is opening file of unknown type:
   &lt;Name of Document&gt;.VBD from"

</PRE><h2>CAUSE</h2>
 
<P>
The MySamp.cab download will not work if the Msracli.cab is located in a
different folder than RemoteReg.cab.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
MySamp should be the name of your project. The workaround for the download
problem is below:

<OL><P><LI>Run the Setup Wizard from Visual Basic 5.0 and select "Add Remote." The
   Setup Wizard will create the download files for your MySamp project.

<P><LI>Make sure Msracli.cab is located in the same folder as RemoteReg.cab.
   RemoteReg.cab is put in the download directory created by Setup Wizard.
   Msracli.cab is shipped on the Visual Basic 5.0 CD-ROM and is located in
   VB5/tools/cabinets/Msracli.cab.

<P><LI>Modify the MySamp.inf file created by Setup Wizard:
<P>
   Code in MySamp.inf:
<P>
<P><PRE>      [MSRACli.cab_Installer]
      file-win32-x86=<B><A href="http://activex.microsoft.com/controls/vb5/msracli.cab">http://activex.microsoft.com/controls/vb5/MSRACli.cab</A></B>
      InfFile=MSRACli.inf
</PRE><P>
   Replace with:
<P>
<P><PRE>      [MSRACli.cab_Installer]
      file-win32-x86=MSRACli.cab
      InfFile=MSRACli.inf
</PRE>
<P><LI>Run Makecab.exe on MySamp.inf file. Makecab.exe is provided by Visual
   Basic 5.0 in the \vb5\setupkit\kitfil32\makecab.exe.

<P><LI>Run the following line of code using the MySamp.ddf created by the Setup
   Wizard:
<P>
<P><PRE>      makecab.exe /F MySamp.ddf
</PRE>
<P><LI>This will create a MySamp.cab in the same directory as MySamp.ddf and
   MySamp.inf. Copy MySamp.cab to the correct directory and your download
   should work correctly.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg vb5all VBKBInet VBKBSetup VBKBToolkit kbprb<BR>
Technology          : kbole kbInetDev<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
