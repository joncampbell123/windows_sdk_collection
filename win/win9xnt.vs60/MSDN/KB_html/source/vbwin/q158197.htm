

<HTML>
<HEAD>
<TITLE>SAMPLE: RDO: Using ODBC to Bind Parameters to Stored Procs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158197">
<META NAME="KBModify" CONTENT="1997/09/17">
<META NAME="KBCreate" CONTENT="1996/10/24">
<META NAME="Keywords" CONTENT="APrgDataODBC vb432 vbwin kbsample kb3rdparty kbfile kbhowto kbole kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how to use the ODBC API to bind input, output, and return values to parameters of stored procedures. This is a workaround using the rdoPreparedStatement object to accomplish this behavior.  RDO has problems binding parameters...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QA9E,QAHE,QBS0,QAY2,QAGI,QAKD,QAB9,QBXS,QAH4,QAD7,QALW,QAYY,QAPN,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: RDO: Using ODBC to Bind Parameters to Stored Procs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158197</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS
kbprg kb3rdparty kbole kbfile kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition, 32-bit only, for Windows,
   version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to use the ODBC API to bind input, output, and
return values to parameters of stored procedures. This is a workaround
using the rdoPreparedStatement object to accomplish this behavior.
<P>
RDO has problems binding parameters to an rdoPreparedStatement if your ODBC
driver does not correctly support SQLDescribeParam and SQLProcedureColumns.
RDO depends on information returned from these functions to determine the
type, direction, and size of each parameter in a stored procedure. If any
of this information is missing or invalid, RDO will fail with the error
message:

<UL><LI>"Invalid parameter value"
<P>
   -or-

<LI>"Illegal syntax or access violation"
<P>
</UL>RDO will generate the error the first time you access the rdoParameters
collection (check the Count property or try to get an item from it),
because RDO calls SQLDescribeParam or SQLProcedureColumns and attempts to
build the parameters collection at that time.
<P>
NOTE: RDO will use SQLProcedureColumns if the SQL uses the ODBC {Call}
syntax and SQLDescribeParam for all others, such as the proprietary Execute
for SQL Server.
<P>
One way to avoid this problem is to pass the input parameters to your
stored procedure "in-line," without using an rdoPreparedStatement. The
following line of code demonstrates this:
<P>
<PRE>   Set rs = cn.OpenResultset("{call GetNames ('Jones')}")

</PRE>NOTE: Oracle 7.2 cannot return a result set from a stored procedure.
<P>
In the case of this sample, a stored procedure named GetNames received one
input parameter with the value of "Jones," and presumably will return a
result set with each row from the table that contained that value in a
certain column. This works fine for a stored procedure that only accepts
input parameters, but it is not useful for a stored procedure that returns
output parameters or return values.
<P>
To work around this problem, Microsoft Technical Support developed a class
module that uses the ODBC API to call your parameterized stored procedure
without the use of SQLDescribeParam or SQLProcedureColumns. This class
module does not have the ability to return a result set from the stored
procedure, but you can set multiple input, output, and return values. This
sample is available for download as Odbcbind.exe as a class module that you
can include in your application or compile into an OLE DLL.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Odbcbind.exe requires the installation of Visual Basic 4.0 Enterprise
Edition on Windows NT or Windows 95.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/odbcbind.exe">Odbcbind.exe</A> <I>(size: 25510 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from
               Online Services

</PRE><h2>REFERENCES</h2>
 
<P>
Open Database Connectivity (ODBC) SDK, version 2.10, "Programmer's
Reference," on the Microsoft Developer Network (MSDN) CD-ROM.
<P>
"Hitchhiker's Guide to Visual Basic and SQL Server," William R. Vaughn,
Microsoft Press, April 1996, ISBN: 1-55615-906-4.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kb3rdparty kbole kbfile kbhowto<BR>
KBSubcategory: APrgDataODBC kbsample vbwin vb432<BR>
Additional reference words: 4.00<BR>
Keywords          : APrgDataODBC vb432 vbwin kbsample kb3rdparty kbfile kbhowto kbole kbprg<BR>
Version           : 4.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
