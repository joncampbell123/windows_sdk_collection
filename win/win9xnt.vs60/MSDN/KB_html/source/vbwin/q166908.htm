

<HTML>
<HEAD>
<TITLE>FIX: ScaleMode for Printer Object Can't Create Custom Scale </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166908">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/04/14">
<META NAME="Keywords" CONTENT="vb5all VBKBObj VBKBPrinting VBKBVB VS97FixlistSP3 kbprint VS97FixlistSP2 VB5FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  In Microsoft Visual Basic version 5.0, when you set the Printer object's ScaleMode property to vbUser (0) to create a user-defined custom coordinate system, the behavior of the Printer object does not change. While the value of the ScaleMode proper...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAPN,QBS0,QAIW,QACT,QDO3,QAW6,QAR4,QAM1,QABK,QA56,QA55,QADB,QDKW,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: ScaleMode for Printer Object Can't Create Custom Scale</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166908</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Visual Basic version 5.0, when you set the Printer object's
ScaleMode property to vbUser (0) to create a user-defined custom coordinate
system, the behavior of the Printer object does not change. While the value
of the ScaleMode property displays as zero (0), the Printer object behaves
as if the ScaleMode property has not changed from its previous value, which
is usually the default value of one (1).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, use the Scale method to create a user-defined
custom coordinate system instead of using the ScaleMode property. You can
specify a custom scale using the following syntax:
<P>
<PRE>   Printer.Scale (x1,y1) - (x2, y2)

</PRE>where the values of x1 and y1 determine the settings of the ScaleLeft and
ScaleTop properties, and the differences between the two x-coordinates and
the two y-coordinates determine the settings of ScaleWidth and ScaleHeight,
respectively.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 2, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This problem occurs only with the Printer object. The ScaleMode property of
a PictureBox control or a Form can be successfully set to vbUser (0).
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new Standard EXE project. Form1 is created by default.

<P><LI>Add a CommandButton (Command1) to Form1.

<P><LI>Add the following code to the Click event for Command1:
<P>
<P><PRE>      Private Sub Command1_Click()
</PRE><P>
<PRE>         With Printer

            .ScaleMode = vbUser               'Create a user-defined custom
            .ScaleWidth = 8.5                 'scale for 8.5" x 11" paper.
            .ScaleHeight = 11

            Printer.Circle (4.25, 5.5), 1     'Print a circle in the
                                              'center of the page.

            .CurrentX = 3.5                   'Print the text at user-
            .CurrentY = 2                     'defined coordinates x = 3.5
            Printer.Print "This is a test"    'and y = 2.

            .EndDoc                           'End the print job.

            Debug.Print Printer.ScaleMode     'Display 0 (vbUser).

         End With

      End Sub

</PRE><P><LI>Press the F5 key to run. Click the CommandButton and note that in the
   printed output, the circle is not printed in the center of the page as
   you would expect. Also note that the text is not printed at the custom
   coordinates (3.5,2) as expected.
<P>
</OL><h3>Workaround</h3>
 
<P>
To work around this behavior, replace the code in step 3 above with the
following code that illustrates how to create a custom scale for the
Printer object successfully by using the Printer object's Scale method
rather than its ScaleMode property:
<P>
<PRE>   Private Sub Command1_Click()

      With Printer

         Printer.Scale (0, 0)-(8.5, 11)    'Create a user-defined custom
                                           'scale for 8.5" x 11" paper.

         Printer.Circle (4.25, 5.5), 1     'Print a circle in the
                                           'center of the page.

         .CurrentX = 3.5                   'Print the text at user-
         .CurrentY = 2                     'defined coordinates x = 3.5
         Printer.Print "This is a test"    'and y = 2.

         .EndDoc                           'End the print job.

      End With

   End Sub

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"Visual Basic Programmer's Guide", version 5.0, Chapter 12
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pset line printing<BR>
Keywords          : vb5all VBKBObj VBKBPrinting VBKBVB VS97FixlistSP3 kbprint VS97FixlistSP2 VB5FixlistSP2<BR>
Version           : 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbservicepack<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
