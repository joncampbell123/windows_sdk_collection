

<HTML>
<HEAD>
<TITLE>FAQ: APIs &amp; DLLs in Visual Basic 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126727">
<META NAME="KBModify" CONTENT="1995/07/20">
<META NAME="KBCreate" CONTENT="1995/03/01">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT=" This article covers some of the most Frequently Asked Questions (FAQ) about nontechnical issues for Microsoft Visual Basic for Windows. You can find this and other FAQ articles by querying on the keyword  FAQ.  You can find additional general refere...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAGI,QAH7,QAH6,QAD7,QDL9,QDIT,QBWQ,QBWO,QBWN,QA6A,QAIF,QDOP,QAMB,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FAQ: APIs &amp; DLLs in Visual Basic 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126727</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
This article covers some of the most Frequently Asked Questions (FAQ)
about nontechnical issues for Microsoft Visual Basic for Windows. You can
find this and other FAQ articles by querying on the keyword "FAQ." You can
find additional general references in the Microsoft Knowledge Base by
searching on "article list."
<P>
Most of the following information can be found in Chapter 24 "Calling
Procedures in DLLs" of the "Professional Features Book 2."

<PRE>1. Q. How do you pass an LPSTR or LPCSTR string to a DLL or API?

   A. To pass a string to an API or DLL call that expects an LPSTR or
      LPCSTR, you need to declare the parameter as ByVal; that is, ByVal
      lpModuleName As String.

2. Q. Why do I get a GP fault after calling an API/DLL that returns a
      string?

   A. You need to initialize your string buffer before you make the call;
      for example:

      szFileName = Space$(128)      'initialize to 128 spaces
      Call GetFileName(szFileName)  'call the DLL which modifies the string

3. Q. How do I pass numbers to my DLL?

   A. Usually, you want to use ByVal when passing numerics to your DLL.

      For additional information, please see the following article(s) in
      the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../vbwin/q94960.htm">Q94960</A></B>
      TITLE     : How to Pass Numeric Variables to a C DLL

4. Q. How do I pass a User Defined Type or Structure?

   A. User Defined Types or Structures (in C) can be passed by reference.
      Because Visual Basic passes this way by default, all you need to do
      is place the user defined type variable in the argument list. For
      example, if you have the following user defined type and function
      declaration

      Type POINTAPI
        x As Integer
        y As Integer
      End Type
      Declare Function PassUDT Lib "MyLib.DLL" (pt As POINTAPI) As Integer

      you could call the function passing the variable as follows:

      Dim CoOrdinate As POINTAPI
      CoOrdinate.X = 10
      CoOrdinate.Y = 10
      ret% = PassUDT(CoOrdinate)

5. Q. I keep getting "Error Loading DLL" when I try can call my function.
      All the declarations are set up correctly; what else could be going
      wrong?

   A. If you created the DLL, check your .DEF file and make sure the
      LIBRARY name is the same as the filename.

      For additional information, please see the following article(s) in
      the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../vbwin/q98309.htm">Q98309</A></B>
      TITLE     : 'Error in loading DLL' When LIBRARY Name Not Same as
                  Filename

6. Q. How do I manipulate INI files?

   A. Visual Basic can manipulate INI files through the Windows API. These
      calls are documented in several Knowledge Base articles.

      For additional information, please see the following articles in the
      Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../vbwin/q75639.htm">Q75639</A></B>
      TITLE     : How to Access Windows Initialization Files Within Visual
                  Basic

      ARTICLE-ID: <B><A href="../vbwin/q115328.htm">Q115328</A></B>
      TITLE     : DOCERR: Write*ProfileString Declaration Incorrect in API

      ARTICLE-ID: <B><A href="../vbwin/q110826.htm">Q110826</A></B>
      TITLE     : DOCERR: GetPrivateProfileString Declaration Incorrect in
                  API

7. Q. How can I find out more about calling the windows API?

    A. There are two useful help files shipped with Visual Basic,
      Professional Edition. The Windows SDK Help file discusses Windows API
      general topics, functions, structures and messages. Its companion
      help file, Windows 3.1 API Help, offers the Visual Basic declare
      statements, type declarations and global constants used to access
      much of the Windows API. In addition, there are the following
      resources:

      Chapter 24 (Call Procedures in DLLs) of the "Programmer's Guide" is a
      good place to start looking at DLL and VB issues.

      For additional information, please see the following article(s) in
      the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../vbapps/q106553.htm">Q106553</A></B>
      TITLE     : How to write C DLL's and Call Them from Visual Basic

      ARTICLE-ID: <B><A href="../vbwin/q110219.htm">Q110219</A></B>
      TITLE     : LONG: How to Call windows API from VB - General
                  Guidelines

      ARTICLE-ID: <B><A href="../vbwin/q109290.htm">Q109290</A></B>
      TITLE     : Popular Windows API Functions Used from Visual Basic 3.0

8. Q. How can I create a transparent bitmap, or layer multiple bitmaps on
      top of each other?

   A. If bitmaps are layered on top of one another, the overlapped regions
      will not show through the bitmaps that are on top unless the upper
      bitmap has transparent regions. Article <B><A href="../vbwin/q94961.htm">Q94961</A></B> shows how to create a
      transparent bitmap from Visual Basic using Windows APIs.

      For additional information, please see the following article(s) in
      the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../vbwin/q94961.htm">Q94961</A></B>
      TITLE     : How to Create a Transparent Bitmap Using Visual Basic
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 gpf gp-fault general protection FAQ<BR>
KBCategory:<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 20, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
