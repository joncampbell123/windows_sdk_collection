

<HTML>
<HEAD>
<TITLE>VB3 How to Create a Flashing Title Bar on a VB Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q71280 ">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1991/04/11">
<META NAME="Keywords" CONTENT="kbui kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When calling a Windows API function call, you can create a flashing window title bar on the present form or any other form for which you know the handle.  ***WARNING: The flash rate should be set based on the caret blink rate. Then, application use...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBTM,QAFF,QAH4,QAGI,QAMB,QAY5,QAPN,QAB9,QAGQ,QDL9,QBWQ,QBWO,QBWN,QAEK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 How to Create a Flashing Title Bar on a VB Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q71280 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, version 1.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When calling a Windows API function call, you can create a flashing
window title bar on the present form or any other form for which you
know the handle.
<P>
***WARNING: The flash rate should be set based on the caret blink rate.
Then, application users who have epilepsy can control the flash rate so
they don't have a seizure.***
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual Basic for Windows has the ability to flash the title bar on any
other form if you can get the handle to that form. The function
FlashWindow flashes the specified window once. Flashing a window means
changing the appearance of its caption bar, as if the window were
changing from inactive to active status, or vice versa. (An inactive
caption bar changes to an active caption bar; an active caption bar
changes to an inactive caption bar.)
<P>
Typically, a window is flashed to inform the user that the window
requires attention when that window does not currently have the input
focus.
<P>
The function FlashWindow is defined as
<P>
<PRE>   FlashWindow(hWnd%, bInvert%)

</PRE>where:
<P>
<PRE>   hWnd%     - Identifies the window to be flashed. The window can be
               either open or iconic.
   bInvert%  - Specifies whether the window is to be flashed or
               returned to its original state. The window is flashed
               from one state to the other if the bInvert parameter is
               nonzero. If the bInvert parameter is zero, the window
               is returned to its original state (either active or
               inactive).

</PRE>FlashWindow returns a value that specifies the window's state before
the call to the FlashWindow function. It is nonzero if the window was
active before the call; otherwise, it is zero.
<P>
The following section describes how to flash a form while that form
does not have the focus:

<OL><P><LI>Create two forms called Form1 and Form2.

<P><LI>On Form1, create a timer control and set the Interval Property to
   1000. Also set the Enabled Property to FALSE.

<P><LI>Within the general-declarations section of Form1, declare the
   FlashWindow function as follows:
<P>
<PRE>   ' The following Declare statement must appear on one line.
   Declare Function FlashWindow% Lib "user" (ByVal hWnd%,
                                                ByVal bInvert%)

</PRE><P><LI>In Visual Basic version 1.0 for Windows, define the following
   constants in the declarations section:
<P>
   Const TRUE = -1
   Const FALSE = 0

<P><LI>In the Form_Load event procedure, add the following code:
<P>
<PRE>   Sub Form_Load ()
      Form2.Show
   End Sub

</PRE><P><LI>In the Sub Timer1_Timer () procedure of Form1, add the following
   code:
<P>
<PRE>   Sub Timer1_Timer ()
      Succ% = FlashWindow(Form1.hWnd, 1)
   End Sub

</PRE><P><LI>In the GotFocus event procedure of Form1, create the following code:
<P>
<PRE>   Sub Form_GotFocus ()
     Timer1.Enabled =  False
   End Sub

</PRE><P><LI>In the Click event for Form2, add the following code:
<P>
<PRE>   Sub Form_Click ()
      Form1.Timer1.Enabled = True
   End Sub

</PRE><P><LI>Run the program. Form1 will be in the foreground with Form2 in the
   background. Click anywhere in Form2; Form1's Caption Bar will flash
   until you click Form1.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00 vb3only<BR>
KBCategory: kbui kbprg kbcode<BR>
KBSubcategory: APrgWindow APrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
