

<HTML>
<HEAD>
<TITLE>How To Create a Flashing Title Bar on a Visual Basic Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147815">
<META NAME="KBModify" CONTENT="1996/09/24">
<META NAME="KBCreate" CONTENT="1996/02/29">
<META NAME="Keywords" CONTENT="kbui kbprg kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When calling a Windows API function call, you can create a flashing window title bar on the present form or any other form for which you know the handle.  MORE INFORMATION  Visual Basic for Windows has the ability to flash the title bar on any form...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QBTM,QBJZ,QAY5,QAFF,QAMB,QBWS,QAGI,QBV8,QAUD,QAIJ,QAGQ,QAB9,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Create a Flashing Title Bar on a Visual Basic Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 24, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147815</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic for Windows 16-bit and 32-bit, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When calling a Windows API function call, you can create a flashing window
title bar on the present form or any other form for which you know the
handle.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual Basic for Windows has the ability to flash the title bar on any
form if you can get the handle to that form. The function FlashWindow
flashes the specified window once. Flashing a window means changing the
appearance of its caption bar, as if the window were changing from inactive
to active status, or vice versa. (An inactive caption bar changes to an
active caption bar; an active caption bar changes to an inactive caption
bar.)
<P>
Typically, a window is flashed to inform the user that the window requires
attention when that window does not currently have the input focus. The
function FlashWindow is defined as
<P>
<PRE>   FlashWindow(hWnd, bInvert)

</PRE>where:
<P>
<PRE>   hWnd      - Identifies the window to be flashed. The window can be
               either open or iconic.

   bInvert   - Specifies whether the window is to be flashed or
               returned to its original state. The window is flashed
               from one state to the other if the bInvert parameter is
               nonzero. If the bInvert parameter is zero, the window
               is returned to its original state (either active or
               inactive).

</PRE>FlashWindow returns a value that specifies the window's state before the
call to the FlashWindow function. It is nonzero if the window was active
before the call; otherwise, it is zero.
<P>
When using FlashWindow, it is a good design practice to set the flash rate
equal to that of the caret rate. The caret blink rate can be found by
using the GetCaretBlinkTime function. GetCaretBlinkTime returns the elapsed
time, in milliseconds, required to cause the caret to blink.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following section describes how to flash a form while that form does
not have the focus:

<OL><P><LI>Start 16-bit or 32-bit Visual Basic 4.0, or, if it is already running,
   click New Project on the File menu.

<P><LI>Add a Timer control to the Form1 form.

<P><LI>Copy the following code to the Code window of the Form1 form:
<P>
<PRE>   Private Sub Form_GotFocus()
      Timer1.Enabled = False
   End Sub

   Private Sub Form_Load()
      Timer1.Interval = GetCaretBlinkTime()
      Form2.Show
   End Sub

   Private Sub Timer1_Timer()
      Success = FlashWindow(Form1.hwnd, 1)
   End Sub

</PRE><P><LI>On the Insert menu, click Form to insert a second form into the project.

<P><LI>Copy the following code to the Code window of the Form2 form:
<P>
<PRE>   Private Sub Form_Click()
      Form1.Timer1.Enabled = True
   End Sub

</PRE><P><LI>On the Insert menu, click Module to insert a module into the project.

<P><LI>Copy the following code to the Code window of the Module1 module:
<P>
<PRE>   'Depending on what operating system you are using determines the
   'correct function declares and variables. This is an example of
   'conditional compilation.

   #If Win32 Then
      Declare Function FlashWindow Lib "user32" ( _
                       ByVal hwnd As Long, _
                       ByVal bInvert As Long) As Long

      Declare Function GetCaretBlinkTime Lib "user32" () As Long

      Dim Success As Long

   #Else
      Declare Function FlashWindow Lib "User" ( _
                       ByVal hwnd As Integer, _
                       ByVal bInvert As Integer) As Integer

      Declare Function GetCaretBlinkTime Lib "User" () As Integer

      Dim Success As Integer

   #End If

</PRE><P><LI>On the Run menu, click Start or press the F5 key to start the program.
   Form1 will be in the foreground with Form2 in the background. Click
   anywhere in Form2; Form1's Caption Bar will flash until you click Form1.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbui kbprg kbcode kbhowto<BR>
KBSubcategory: APrgWindow APrgOther
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 24, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
