

<HTML>
<HEAD>
<TITLE>HOWTO: Play a Waveform (.WAV) Sound File in Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86281 ">
<META NAME="KBModify" CONTENT="1997/07/03">
<META NAME="KBCreate" CONTENT="1992/07/01">
<META NAME="Keywords" CONTENT="APrgOther kbcode vb432 vb4win vb5all vb5howto VBKBWinAPI kbfasttip kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT=" THE FOLLOWING SECTION APPLIES TO VISUAL BASIC VERSIONS 4.0 AND 5.0 ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYS,QAHR,QBS0,QBBI,QAY5,QAUD,QAH4,QAB9,QBV8,QDL9,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Play a Waveform (.WAV) Sound File in Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86281 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 32-bit only, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0 and 3.0
<LI>Microsoft Visual Basic for Windows, version 1.0
</UL> 
<P>
<P><h3>THE FOLLOWING SECTION APPLIES TO VISUAL BASIC VERSIONS 4.0 AND 5.0</h3>
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can play a waveform (.wav) sound file from Microsoft Visual Basic for
Windows by calling the sndPlaySound API function from the Mmsystem.dll
file. In order to be able to call the sndPlaySound API function, you must
be using either Microsoft Windows, version 3.1 or the Microsoft Multimedia
Extensions for Windows, version 3.0. The following information discusses
the sndPlaySound parameters, and includes an example of how to use this
function from Visual Basic for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To use the sndPlaySound API from within a Visual Basic for Windows
application, you must declare the sndPlaySound function in the global
module or in the Declarations section of the Code window. To declare the
function, enter this Declare statement:
<P>
<PRE>   Declare Function sndPlaySound Lib "WINMM.DLL" Alias "sndPlaySoundA" _
      (ByVal lpszSoundName As String, ByVal uFlags As Long) As Long

</PRE>Here are explanations for the parameters:

<UL><LI>lpszSoundName specifies the name of the sound to play. The function
   first searches the [sounds] section of the Win.ini file for an entry
   with the specified name, and then plays the associated waveform sound
   file. If no entry by this name exists, it is assumed the specified name
   is the name of a waveform sound file. If this parameter is null, any
   currently playing sound is stopped. Use 0&amp; to provide a null value.

<LI>uFlags specifies options for playing the sound using one or more of the
   following flags:
<P>
<P><PRE>    - SND_SYNC specifies that the sound is played synchronously and the
      function does not return until the sound ends.
</PRE><P>
<P><PRE>    - SND_ASYNC specifies that the sound is played asynchronously and the
      function returns immediately after beginning the sound.
</PRE><P>
<P><PRE>    - SND_NODEFAULT specifies that if the sound cannot be found, the
      function returns silently without playing the default sound.
</PRE><P>
<P><PRE>    - SND_LOOP specifies that the sound will continue to play continuously
      until sndPlaySound is called again with the lpszSoundName$ parameter
      set to null. You must also specify the SND_ASYNC flag to loop sounds.
</PRE><P>
<P><PRE>    - SND_NOSTOP specifies that if a sound is currently playing, the
      function will immediately return False without playing the requested
      sound.
</PRE><P>
</UL>The sndPlaySound function returns True (-1) if the sound is played,
otherwise it returns False (0).
<P>
<P><h3>Code Sample</h3>
 
<P>
The following code example illustrates how to use the sndPlaySound API
function to play a waveform (.wav) sound file. Add the code to the global
module or general Declarations section of your form:
<P>
<PRE>   Private  Declare Function sndPlaySound Lib "WINMM.DLL" Alias _
      "sndPlaySoundA" (ByVal lpszSoundName As String, ByVal uFlags As _
      Long) As Long

   Const SND_SYNC = &amp;H0
   Const SND_ASYNC = &amp;H1
   Const SND_NODEFAULT = &amp;H2
   Const SND_LOOP = &amp;H8
   Const SND_NOSTOP = &amp;H10

</PRE>Add the following code to the appropriate Function or Sub procedure in your
application:
<P>
<PRE>   SoundName$ = "c:\windows\tada.wav"
   wFlags% = SND_ASYNC Or SND_NODEFAULT
   x% = sndPlaySound(SoundName$,wFlags%)

</PRE>NOTE: If a large waveform (.wav) sound file is specified and this call
fails to play the file in its entirety, you need to adjust the settings on
the appropriate sound driver.
<P>
<P><h3>THE FOLLOWING SECTION APPLIES TO VISUAL BASIC 3.0 ONLY</h3>
 
<P>
To use the sndPlaySound API from within a Visual Basic for Windows
application, you must declare the sndPlaySound function in the global
module or in the Declarations section of your Code window. To declare the
function, enter the following Declare statement as one, single line:
<P>
<PRE>   Declare Function sndPlaySound Lib "MMSYSTEM.DLL" (ByVal lpszSoundName As
      Any, ByVal wFlags%) As Integer

</PRE>Here are explanations for the parameters:

<UL><LI>lpszSoundName specifies the name of the sound to play. The function
   first searches the [sounds] section of the Win.ini file for an entry
   with the specified name, and then plays the associated waveform sound
   file. If no entry by this name exists, it is assumed the specified name
   is the name of a waveform sound file. If this parameter is null, any
   currently playing sound is stopped. Use 0&amp; to provide a null value.

<LI>uFlags specifies options for playing the sound using one or more of the
   following flags:
<P>
<P><PRE>    - SND_SYNC specifies that the sound is played synchronously and the
      function does not return until the sound ends.
</PRE><P>
<P><PRE>    - SND_ASYNC specifies that the sound is played asynchronously and the
      function returns immediately after beginning the sound.
</PRE><P>
<P><PRE>    - SND_NODEFAULT specifies that if the sound cannot be found, the
      function returns silently without playing the default sound.
</PRE><P>
<P><PRE>    - SND_LOOP specifies that the sound will continue to play continuously
      until sndPlaySound is called again with the lpszSoundName$ parameter
      set to null. You must also specify the SND_ASYNC flag to loop sounds.
</PRE><P>
<P><PRE>    - SND_NOSTOP specifies that if a sound is currently playing, the
      function will immediately return False without playing the requested
      sound.
</PRE><P>
</UL>The sndPlaySound function returns True (-1) if the sound is played,
otherwise it returns False (0).
<P>
<P><h3>Code Sample</h3>
 
<P>
The following code example illustrates how to use the sndPlaySound API
function to play a waveform (.wav) sound file. Add the following code to
the global module or general Declarations section of your form:
<P>
<PRE>   'VB3Line: Enter the following lines as one line
   Declare Function sndPlaySound Lib "MMSYSTEM.DLL" (ByVal lpszSoundName$,
      ByVal wFlags%) As Integer

   Global Const SND_SYNC      = &amp;H0000
   Global Const SND_ASYNC     = &amp;H0001
   Global Const SND_NODEFAULT = &amp;H0002
   Global Const SND_LOOP      = &amp;H0008
   Global Const SND_NOSTOP    = &amp;H0010

</PRE>Add the following code to the appropriate Function or Sub procedure in your
application:
<P>
<PRE>   SoundName$ = "c:\windows\tada.wav"
   wFlags% = SND_ASYNC Or SND_NODEFAULT
   x% = sndPlaySound(SoundName$,wFlags%)

</PRE>NOTE: If a large waveform (.wav) sound file is specified and this call
fails to play the file in its entirety, you need to adjust the settings on
the appropriate sound driver.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Multimedia Development Kit: Programmer's Reference" version 1.0.
For more information on adjusting the sound driver settings, query on the
following words in the Microsoft Knowledge Base:
<P>
<PRE>   Speaker and Sound and Driver and Settings and .WAV and File
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : APrgOther kbcode vb432 vb4win vb5all vb5howto VBKBWinAPI kbfasttip kbhowto<BR>
Version             : 1.0 2.0 3.0 4.0 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
