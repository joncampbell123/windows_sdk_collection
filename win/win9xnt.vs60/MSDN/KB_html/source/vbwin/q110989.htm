

<HTML>
<HEAD>
<TITLE>FIX: Out of Memory Error When Adding 35-50 Pen Controls </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110989">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1994/02/03">
<META NAME="Keywords" CONTENT="PrgCtrlsCus kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You will receive an  Out of Memory  error message if you attempt to add more than approximately 36 HEdit or approximately 50 BEdit Pen Controls to an individual Form.  WORKAROUND  You can edit in only one control at a time, so use only one of each ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QATJ,QA28,QAB5,QAMN,QAOE,QA4Q,QAMB,QA7N,QBS0,QAEF,QAFF,QAC2,QAHV,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Out of Memory Error When Adding 35-50 Pen Controls</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110989</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 3.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic
<PRE>  programming system for Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You will receive an "Out of Memory" error message if you attempt to
add more than approximately 36 HEdit or approximately 50 BEdit Pen
Controls to an individual Form.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can edit in only one control at a time, so use only one of each
of the Pen Controls on top of multiple Labels or Picture Box Controls.
This will display the result of the edit when you move the focus to
another control.
<P>
The examples in the More Information section below will demonstrate how
to do this for each of the Pen Controls.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This problem has been corrected in Visual
Basic version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Here are two examples showing how to work around this bug:
<P>
<P><h3>Step-by-Step Example One</h3>
 
<P>
The following example demonstrates how to use multiple Picture Boxes
and one HEdit Control with the DelayRecog = True.  This will allow the
user to input signatures into a field which will then remain as written,
no recognition is performed.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following controls, and set the indicated properties:
<P>
<PRE>   Control          Property     Value
   ----------------------------------------
   Picture Box      Name         PictureB
                    Index        0
                    AutoRedraw   True

   Picture Box      Name         PictureB
                    Index        1
                    AutoRedraw   True

   HEdit Control    Name         HEdit1
                    DelayRecog   True
                    Text         &lt;blank&gt;

   Command Button   Name         Command1
                    Caption      Clear

</PRE><P><LI>Add the following code to the General Declarations section of Form1:
<P>
<PRE>   'Enter each of the following Declare statements on one, single line:
   Declare Function GetDC Lib "USER" (ByVal hWnd As Integer) As Integer
   Declare Function BitBlt Lib "GDI" (ByVal hDestDC As Integer,
      ByVal x As Integer, ByVal y As Integer, ByVal nWidth As Integer,
      ByVal nHeight As Integer, ByVal hSrsDC As Integer,
      ByVal xSrc As Integer, ByVal ySrc As Integer, ByVal dwRop) As Integer

      Const SRCCOPY &amp;H00CC0020&amp;  ' Will be used in the call to BitBlt
      Dim LastPos As Integer     ' Will be used to keep track of the
                                 ' last edited field.
      Dim InkArray(2) As String  ' This array will be used to store the
                                 ' InkDataString for each of the fields.

</PRE><P><LI>Add the following code to the appropriate Control's event procedures:
<P>
<PRE>   Sub Command1_Click ()
      HEdit1.InkDataString = ""     ' Clear the field.
   End Sub

   Sub Form_Load ()
      Call PictureB_Click(0)    ' Position the HEdit control over the
   End Sub                      ' first field.

   Sub Picture1_Click (index As Integer)
      ' Copy the image in the HEdit control to the Picture Box
      destDC = GetDC(HEdit.hWnd)
      ' Enter the following three lines as one, single line:
      dummy% = BitBlt(PictureB(LastPos).HDC, 0, 0,
         PictureB(LastPos).ScaleWidth-2, PictureB(LastPos).ScaleHeight-2,
         destDC, 1, 1)
      InkArray(LastPos) = HEdit1.InkDataString
      ' Save the Ink data for this field.  It will be reassigned
      ' to the HEdit control the next time that field is selected
      ' and the HEdit control is positioned on top of it.
      LastPos = index        ' Update LastPos to the current field.
      HEdit1.Visible = False ' This prevent a flicker when the
                             ' control is moved.
      HEdit1.Top = PictureB(index).Top     ' Move the HEdit Control on
      HEdit1.Left = PictureB(index).Left   ' top of the selected Picture
      HEdit1.Width = PictureB(index).Width ' box field.
      HEdit1.Height = PictureB(index).Height
      HEdit1.InkDataString = InkArray(index) ' Reset the Ink in the
                                             ' Hedit Control to that
                                             ' stored for this field.
      HEdit1.Visible = True
   End Sub

</PRE></OL><h3>Step-by-Step Example Two</h3>
 
<P>
The following example demonstrates how to use multiple Labels and one
HEdit Control with DelayRecog = False. This works using a BEdit control
as well. This allows the user to input hand-written characters into a
field where those characters will then be recognized and converted into
font characters.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following controls, and set the indicated properties:
<P>
<PRE>   Control         Property      Value
   -----------------------------------------------------------
   Label           Name          LabelF
                   Index         0
                   Caption       &lt;blank&gt;

   Label           Name          LabelF
                   Index         1
                   Caption       &lt;blank&gt;

   HEdit Control   Name          HEdit1
                   DelayRecog    False
                   Text          &lt;blank&gt;

</PRE><P><LI>Add the following code to the General Declarations section of Form1:
<P>
   Dim LastPos As Integer

<P><LI>Add the following code to the appropriate event procedures:
<P>
<PRE>   Sub Form_Load ()
      Call LabelF_Click (0)
   End Sub

   Sub LabelF_Click (index As Integer)
      LabelF(LastPos).Caption = HEdit.Text    ' Copy the contents of
                                              ' the HEdit Control to  the
                                              ' Label Control.
      LastPos = index         ' Update LastPos to the current field.
      HEdit1.Visible = False  ' This prevent a flicker when the
                              ' control is moved.
      HEdit1.Top = LabelF(index).Top       ' Move the HEdit Control on
      HEdit1.Left = LabelF(index).Left     ' top of the selected Picture
      HEdit1.Width = LabelF(index).Width   ' Box field.
      HEdit1.Height = LabelF(index).Height
      HEdit1.Text = LabelF(index).Caption  ' Reset the Ink in the HEdit
                                           ' Control to that stored for
                                           ' this field.
      HEdit1.Visible = True
   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist2.00 buglist3.00 2.00 3.00 fixlist4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsCus<BR>
Keywords          : PrgCtrlsCus kbbuglist kbprg<BR>
Version           : 2.00 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
