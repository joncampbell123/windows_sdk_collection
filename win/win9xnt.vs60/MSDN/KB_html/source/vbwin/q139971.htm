

<HTML>
<HEAD>
<TITLE>BUG:DBGrid with Visible Property Set to False Becomes Visible </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139971">
<META NAME="KBModify" CONTENT="1996/09/17">
<META NAME="KBCreate" CONTENT="1995/11/20">
<META NAME="Keywords" CONTENT="kbusage kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A DBGrid that has its Visible property set to False does not remain invisible when the data control referenced in its DataSource property is refreshed (via the Refresh method) or has its current record changed.  CAUSE =====  As a side effect of the...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAPN,QAH4,QAIJ,QBWS,QBS0,QBVV,QA5V,QACI,QAYY,QAHV,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG:DBGrid with Visible Property Set to False Becomes Visible</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139971</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A DBGrid that has its Visible property set to False does not remain
invisible when the data control referenced in its DataSource property is
refreshed (via the Refresh method) or has its current record changed.
<P>
<P><h2>CAUSE</h2>
 
<P>
As a side effect of these methods, a message to repaint is sent to a data
bound grid. In this case, the problem is that the DBGrid control does not
check its Visible property to see if it is all right to draw itself on the
form, it just goes ahead and does it.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Executing the following line of code
<P>
<PRE>    &lt;DBGrid Name&gt;.Visible = False

</PRE>causes another Paint message to be sent to the DBGrid control, but this
time the grid behaves correctly and hides itself. The workaround is to
place this line of code (shown above) in the Reposition event of the data
control. Whenever a data control executes a Refresh method, or any of the
Move methods, the Reposition event is called, and this line of code causes
the correct painting to occur.
<P>
<P>
Another workaround is to move the DBGrid control off of the visible section
of the form when it should not be seen. You can use a line of code such as
the following:
<P>
<PRE>  DBGrid1.Move -5000, -5000

</PRE>To make the DBGrid visible again, move it back to the
correct location on the form.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of the article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to reproduce problem</h3>
 

<OL><P><LI>Start Visual Basic, or if it is already running, click New Project
    on the File menu.

<P><LI>In the toolbox, double-click the data control button to add a new data
    control to the project.

<P><LI>Modify the following properties of the data control:
<P>
      DatabaseName: &lt;path to your VB directory&gt;\biblio.mdb
      RecordSource: Authors

<P><LI>In the toolbox, double-click DBGrid to add a DBGrid control to the
    form.

<P><LI>In the Properties window, change the DataSource property of the DBGrid
    control to Data1.

<P><LI>Change the DBGrid's Visible property to False.

<P><LI>Click and drag a single command button, named Command1 by default, onto
    the form.

<P><LI>Add the following code to the Command1_Click procedure:
<P>
       Private Sub Command1_Click()
<PRE>          Data1.Refresh
       End Sub

</PRE><P><LI>On the Run menu, click Start or press the F5 key to start your
    application. The DBGrid control is not displayed as expected.

<P><LI>Click the command button to send a Refresh to the data control. This
    causes the DBGrid control to be drawn on the form, despite the fact
    that its Visible property is false.

<P><LI>Stop the application, then add the following code to the
    Data1_Reposition procedure:
<P>
      Private Sub Data1_Reposition()
<PRE>         DBGrid1.Visible = False
      End Sub

</PRE><P><LI>On the Run menu, click Start or press F5 to start your application. The
    DBGrid control is not displayed.

<P><LI>Click the command button to send a Refresh to the data control. The
    DBGrid control is not displayed, which is the desired behavior.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all buglist4.00<BR>
KBCategory: kbusage kbbuglist<BR>
KBSubcategory: prgctrlsstd
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 17, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
