

<HTML>
<HEAD>
<TITLE>HOWTO: Run Automation Manager as a Windows NT Service </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143431">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1996/02/01">
<META NAME="Keywords" CONTENT="PrgOther VB4ALL VB4WIN kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Windows NT Resource Kit provides two utilities that allow you to create a Windows NT user-defined service for an application (executable) or batch file. This article describes how to use these two utilities, SRVANY.EXE and INSTSRV.EXE, to set u...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACK,QBWP,QBWS,QAIJ,QDIV,QBTX,QBXS,QA2Q,QAGU,QA2K,QAH5,QAG2,QAA1,QBCU,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Run Automation Manager as a Windows NT Service</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143431</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Windows NT Resource Kit provides two utilities that allow you to create
a Windows NT user-defined service for an application (executable) or batch
file. This article describes how to use these two utilities, SRVANY.EXE and
INSTSRV.EXE, to set up the Automation Manager as a Windows NT service. In
this article you will be instructed to use the Registry Editor,
REGEDT32.EXE. Before doing so, please read the following:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When using the Registry Editor, you will be instructed to add a key or add
a value to the Registry. To add a key, select Edit from the Registry Editor
menu and choose Add Key. Similarly, to add a value, select Edit and then
choose Add Value. Making any of the above selections will result in a
prompt for further data. Please follow the steps below for the correct
setting.
<P>
To set Automation Manager as a Windows NT service, do the following
step-by-step instructions:

<OL><P><LI>Copy SRVANY.EXE and INSTSRV.EXE to your system32 directory.

<P><LI>Select a name for your service, AutoMan for instance, and install it as
   a new service by typing the following at the command line:
<P>
<P><PRE>      INSTSRV AutoMan C:\windows\system32\SRVANY.EXE
</PRE>
<P><LI>If new service is created successfully, you should get the following:
<P>
   CreateService SUCCESS
   Don't forget!!! You must now go to the Control Panel and use the
   Services utility to change the account name and password that this
   newly installed service will use when it attempts to logon as a service
   when it starts. Also, use the Services utility to ensure this newly
   installed service starts automatically, since the point of this service
   is to start automatically and apply the DACLs to the floppy drives
   prior to a user logging on at the keyboard

<P><LI>Now go to the Control Panel and open the Services utility.

<P><LI>Select your new service, in this case AutoMan, and click the Startup
   button.

<P><LI>If you want your service to start every time you boot your machine,
   select Automatic for Startup Type in the Service dialog box. Otherwise
   select Manual or Disabled. If you select Manual, you will need to go
   into the Services utility, select the service, and click the Start or
   Stop button every time you want to start or stop the service.

<P><LI>Select System Account for Log On As, and make sure to check the Allow
   Service to Interact with Desktop option.

<P><LI>Click OK and Close the Services utility.

<P><LI>Run REGEDT32.

<P><LI>Under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\AutoMan, add
   a new key and set its name to "Parameters" (without quotes). Notice
   that AutoMan is only the service name in this case. You may have chosen
   a different name.

<P><LI>Under Parameters, add a new value. Set Value Name to "Application" and
   leave the default REG_SZ for Data Type. When prompted for the value's
   string, set it to reflect the path and filename of the Automation
   Manager, for example C:\windows\system32\AUTMGR32.EXE.

<P><LI>If you intend to run the Automation Manager invisible, add another
   value under the Parameters key and set its name to "AppParameters".
   Leave the default REG_SZ for Data Type, and set the String to
   "/hidden".

<P><LI>Now Exit RegEdt32 and restart your machine. If you selected Automatic
   for Startup Type in step 6, the Automation Manager should start
   automatically. Otherwise, open the Services utility from the Control
   Panel and start the service manually. If you chose to run Automation
   Manager hidden, you can verify that it is running by using PView.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q137890.htm">Q137890</A></B>
   TITLE     : How To Create a User-Defined Service

   ARTICLE-ID: <B><A href="../vbwin/q138067.htm">Q138067</A></B>
   TITLE     : How To Hide the Automation Manager
</PRE></OL> 
<PRE>Keywords          : PrgOther VB4ALL VB4WIN kbhowto
Version           : 4.0
Platform          : NT WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
