

<HTML>
<HEAD>
<TITLE>How to Perform a Union Query in Visual Basic Version 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113592">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/04/07">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The sample program in this article demonstrates how to perform a Union query on a Microsoft Access version 2.0 database (NWIND.MDB) and on a Microsoft Access version 1.x database (BIBLIO.MDB included with Visual Basic version 3.0).  Union queries a...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA1S,QABM,QAMB,QAY2,QATR,QDN9,QBWS,QBVR,QA7O,QBM2,QACI,QAPF,QDKY,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Perform a Union Query in Visual Basic Version 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113592</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
<P><h3>- Microsoft Visual Basic programming system for Windows, version 3.0</h3>
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The sample program in this article demonstrates how to perform a Union
query on a Microsoft Access version 2.0 database (NWIND.MDB) and on a
Microsoft Access version 1.x database (BIBLIO.MDB included with
Visual Basic version 3.0).
<P>
Union queries are new to Microsoft Access version 2.0, so you must have
installed the Microsoft Jet 2.0/Visual Basic 3.0 Compatibility Layer. For
more information about the Compatibility Layer, please see the following
article in Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A href="../vbwin/q113683.htm">Q113683</A></B>
<PRE>TITLE     : Fact Sheet on Microsoft Jet 2.0/VB 3.0 Compatibility Layer

</PRE>For information on how to obtain the Compatibility Layer, please see the
following article in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A href="../vbwin/q113951.htm">Q113951</A></B>
<PRE>TITLE     : How to Obtain &amp; Distribute the Compatibility Layer

</PRE>The sample in this article also makes use of the NWIND.MDB database
that is distributed with Microsoft Access version 2.0. This version of
the NWIND.MDB database is different from the one that shipped with
Microsoft Access version 1.1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Union queries help you combine fields from two or more tables or
queries. A union query returns all the records from corresponding fields
in the included tables or queries. In contrast, a join query returns a
recordset containing data only from records whose related fields meet a
specific criteria.
<P>
<P><h3>Example Using the Union Query in Visual Basic</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add one Label (Label1), two Command buttons (Command1 and Command2),
   two List Boxes (List1 and List2), and two Data controls (Data1 and
   Data2) to Form1 using the following placement:
<P>
<P><PRE>    - Put Label1 at the top and center of Form1.
    - Put Command1 under Label1 and left of Command2
    - Put Command2 under Label1 and right of Command1
    - Put List1 under Command1 and to left of List2
    - Put List2 under Command2 and to right of List1
</PRE>
<P><LI>Using the following table as a guide, set the properties of the
   controls you added in step 2.
<P>
<PRE>   Control Name   Property       New Value
   ---------------------------------------------------------------
   Label1         AutoSize       True
   Label1         Caption        Union Query Sample
   Command1       Caption        Access 2.0 Nwind Sample
   Command2       Caption        VB 3.0 Biblio(Access 1.x) Sample
   Data1          Visible        False
   Data2          Visible        False

</PRE><P><LI>Place the following code in the Command1 click event procedure
   of Form1:
<P>
<PRE>   Sub Command1_Click ()

      ' Build the Union query:
      ' Select all Companies from Suppliers and Customers in Brazil:
      sql$ = "SELECT [Company Name] FROM Suppliers"
      sql$ = sql$ &amp; " WHERE Country = 'Brazil' UNION SELECT [Company Name]"
      sql$ = sql$ &amp; " FROM Customers WHERE Country = 'Brazil'; "

      ' Place the query in the recordsource and refresh the data control:
      data1.DatabaseName = "C:\ACCESS2\SAMPAPPS\NWIND.MDB"  '
      data1.RecordSource = sql$
      data1.Refresh

      ' Add records of the query to the list box:
      Do Until data1.Recordset.EOF
         list1.AddItem data1.Recordset("Company Name")
         data1.Recordset.MoveNext
      Loop

   End Sub

</PRE><P><LI>Place the following code in the Command2 Click event procedure of Form1:
<P>
<PRE>   Sub Command2_Click ()

      ' Build the Union query:
      ' Select all publishers where publishers and titles begin with 'm':
      sql$ = "SELECT titles.pubid FROM titles "
      sql$ = sql$ &amp; " WHERE title like 'm*' UNION SELECT publishers.pubid"
      sql$ = sql$ &amp; " FROM publishers WHERE name like 'm*';"

      ' Initialize the data control:
      data2.DatabaseName = "C:\VB3\BIBLIO.MDB"  ' Change path if needed.
      data2.RecordSource = sql$
      data2.Refresh

      ' Add the results to the list box:
      Do Until data2.Recordset.EOF
         list2.AddItem data2.Recordset("pubid")
         data2.Recordset.MoveNext
      Loop

   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S), or press the F5 key to
   run the program. Click the Command1 button to get a list of all the
   companies and suppliers in Brazil. Then click the Command2 button to
   get a list of all the publisher identifications that have book titles
   or a publisher name that begins with the letter m.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
