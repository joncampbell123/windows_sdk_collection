

<HTML>
<HEAD>
<TITLE>How to Use Data Control to Scroll Up and Down in a Recordset </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97414 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/04/11">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The data control provided with Visual Basic does not provide an automatic way to scroll up or down in a recordset by groups (pages) of records. This article shows you how to use the MoveNext and MovePrevious methods to scroll up or down in a record...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBXQ,QBS0,QA7O,QAMN,QDMH,QAPN,QAB5,QAFO,QAOE,QAH4,QBXS,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use Data Control to Scroll Up and Down in a Recordset</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97414 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows, version
<PRE>  3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The data control provided with Visual Basic does not provide an
automatic way to scroll up or down in a recordset by groups (pages)
of records. This article shows you how to use the MoveNext and
MovePrevious methods to scroll up or down in a recordset by groups
(pages) of records without displaying all the records.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Usually, when you use the MoveNext and MovePrevious methods to scroll
up or down by a specified number of records, all the records are
displayed as you move through them. This is undesirable behavior if
you want a way to scroll through the recordset by pages.
<P>
In order to display only the record you have scrolled to, without
displaying all the records in between, you need to use the Clone
method to clone the data control's recordset.
<P>
Once you clone the recordset, you can use the MoveNext and MovePrevious
methods to move to the desired record within the cloned recordset. Then
set the Bookmark property of the original recordset to the Bookmark
property of the cloned recordset. This makes the desired record the
current record in the original recordset and causes the fields of this
record to be displayed in the bound data controls.
<P>
Perform the following steps to create an example program that
demonstrates how to scroll up and down by pages in a data control's
recordset:

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>Add a data control (Data1) to Form1.

<P><LI>Add two text boxes (Text1 and Text2) to Form1.

<P><LI>Add two command buttons (Command1 and Command2) to Form1.

<P><LI>Using the following table as a guide, set the properties of the
   controls you added in steps 2, 3, and 4.
<P>
<PRE>   Control Name   Property       New Value    Comment
   --------------------------------------------------------------------
   Command1       Caption        "Page Up"
   Command2       Caption        "Page Down"
   Data1          DatabaseName   BIBLIO.MDB   Provide the full path to
                                              to this file, which
                                              should be in the Visual
                                              Basic directory -- C:\VB
   Data1          RecordSource   Authors
   Text1          DataSource     Data1
   Text1          DataField      AU_ID
   Text2          DataSource     Data1
   Text2          DataField      Author

</PRE><P><LI>Add the following code to the general declarations section of Form1:
<P>
   Const PAGEUP = 1
   Const PAGEDOWN = 2
   Const Records_per_Page = 10

<P><LI>Add the following procedure to Form1:
<P>
<PRE>   Sub Page (RecSet As Dynaset, ByVal iDirection As Integer, ByVal
                                                  Records As Integer)

      Dim dsClone As Dynaset
      Dim i As Integer

      'Copy the visible recordset. This is necessary so that you can
      'move through the clone recordset without displaying each record.
      Set dsClone = RecSet.Clone()

      'Set the current record of the cloned recordset to the current
      'record of the visible recordset.
      dsClone.Bookmark = RecSet.Bookmark

      'Scroll up or down N number of records in the cloned recordset.
      i = 1
      Do While i &lt;= Records And Not dsClone.EOF And Not dsClone.BOF

         If iDirection = PAGEUP Then
            dsClone.MovePrevious
         Else
            dsClone.MoveNext
         End If

         i = i + 1
      Loop

      'If the above loop caused a BOF or EOF condition, move to the
      'beginning or end of the recordset as appropriate.
      If dsClone.BOF And iDirection = PAGEUP Then
         dsClone.MoveFirst
      ElseIf dsClone.EOF And iDirection = PAGEDOWN Then
         dsClone.MoveLast
      End If

      'Change the bookmark of the visible record set to the bookmark
      'of the desired record. This makes the current record of the
      'visible recordset match the record moved to in the cloned
      'dynaset. The fields of the record are displayed in the data
      'bound controls without displaying any intervening records.
      RecSet.Bookmark = dsClone.Bookmark

   End Sub

</PRE><P><LI>Add the following code to the Command1_Click event for Form1:
<P>
<P><PRE>    Sub Command1_Click ()
</PRE><P>
<P><PRE>       'Scroll up 10 records in the recordset associated with Data1
       Page Data1.RecordSet, PAGEUP, Records_per_Page
</PRE><P>
<P><PRE>    End Sub
</PRE>
<P><LI>Add the following code to the Command2_Click event for Form1:
<P>
<PRE>   Sub Command2_Click ()

      'Scroll down 10 records in the recordset associated with Data1
       Page Data1.RecordSet, PAGEDOWN, Records_per_Page

   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S), or press the F5 key
<P><PRE>    to run the program.
</PRE><P>
</OL>Click the "Page Up" or "Page Down" button to scroll up or down in
10-record increments. Change the value of Records_per_Page to modify
the pagesize.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
