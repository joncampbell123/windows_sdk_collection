

<HTML>
<HEAD>
<TITLE>How to Automatically Select or Highlight Text Box Upon Focus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110394">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/01/20">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The sample program below automatically selects (highlights) all text in a text box whenever the text box gets the focus. This is done by using the SelStart and SelLength properties in the GetFocus event for the text box.  Automatic highlighting is ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QBT6,QAHP,QATX,QAMB,QADO,QAG2,QAPN,QA2Q,QBWS,QBER,QBC9,QBC8,QANO,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Automatically Select or Highlight Text Box Upon Focus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110394</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The sample program below automatically selects (highlights) all text in a
text box whenever the text box gets the focus. This is done by using the
SelStart and SelLength properties in the GetFocus event for the text box.
<P>
Automatic highlighting is useful in data entry boxes where you want to give
the user the option to quickly overwrite the existing contents by pressing
any character key.
<P>
To avoid overwriting the highlighted text after giving focus to the text
box, the user can single-click the text, or press an arrow (direction) key
or cursor-movement key (such as END or HOME) to remove the highlighting
from the text and allow editing.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example How to Automatically Select Text Whenever Given the Focus</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add two text boxes to Form1.

<P><LI>Add the following code to the Form Load event:
<P>
<PRE>   Sub Form_Load ()
      text1.Text = "This sentence is highlighted whenever given the focus."
      text2.Text = "This is not highlighted."
   End Sub

</PRE><P><LI>Add the following code to the Text1 GotFocus event:
<P>
<PRE>   Sub Text1_GotFocus ()
      text1.SelStart = 0          ' Start selection at beginning.
      text1.SelLength = Len(text1.Text)  ' Length of text in Text1.
   End Sub

</PRE><P><LI>Start the program, or press the F5 key. Click the text in Text1 to
   remove its highlighting. Click Text2 to change the focus. Click Text1
   again and notice that the complete contents of Text1 are automatically
   highlighted again. Close the form to end the program.
<P>
</OL><h3>Syntax of SelLength, SelStart, and SelText Properties</h3>
 
<P>
The SelLength, SelStart, and SelText properties apply to combo boxes and
text boxes, and behave as follows:

<UL><LI>SelLength determines the number of characters selected.

<LI>SelStart determines the starting point of text selected. SelStart
   indicates the position of the insertion point if no text is currently
   selected.

<LI>SelText determines the string containing the currently selected text;
   consists of an empty string ("") if no characters are currently
   selected.
<P>
</UL>The SelLength, SelStart, SelText properties are not available at design
time. They are only available at run time. They have the following syntax:
<P>
<PRE>   [form.]{combobox|textbox}.SelLength[ = length ]
   [form.]{combobox|textbox}.SelStart[ = index ]
   [form.]{combobox|textbox}.SelText[ = stringexpression ]

</PRE></OL>For SelLength and SelStart, the valid range of settings is 0 to the text
length -- the total number of characters in the edit area of a combo box or
text box.
<P>
Use these properties for tasks such as setting the insertion point,
establishing an insertion range, selecting substrings in a control, or
clearing text. Used in conjunction with the Clipboard object, these
properties are useful for copy, cut, and paste operations. When working
with these properties:

<UL><LI>Setting SelLength less than 0 causes a run-time error.

<LI>Setting SelStart greater than the text length sets the property to the
   existing text length; changing SelStart changes the selection to an
   insertion point and sets SelLength to 0.

<LI>Setting SelText to a new value sets SelLength to 0 and replaces the
   selected text with the new string.
<P>
</UL>For example, to position the insertion point at the end of a text box
whenever the box gets the focus, use the following code:
<P>
<PRE>   text1.SelStart = Len(text1.Text)
   text1.SelLength = 1  ' Length of selection

</PRE>SelLength and SelStart have a Long data type. SelText has a String data
type.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
