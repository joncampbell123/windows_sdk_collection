

<HTML>
<HEAD>
<TITLE>How to Right Justify Items in List Box w/ Tabs &amp; SendMessage </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110958">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/02/03">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The sample program below shows how to right justify items in a list box.  MORE INFORMATION  This program calls the SendMessage Windows API function to set a tab stop at every character position in the list box. The program prefixes the appropriate ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QADF,QATX,QAH4,QBS0,QAEC,QARP,QDL9,QBWQ,QBWO,QBWN,QAE8,QA4Q,QAY5,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Right Justify Items in List Box w/ Tabs &amp; SendMessage</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110958</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The sample program below shows how to right justify items in a list box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This program calls the SendMessage Windows API function to set a tab stop
at every character position in the list box. The program prefixes
the appropriate number of tabs to right justify each string in the list
box. You need to set the maximum allowed string length in the program.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a large list box (List1) to Form1.

<P><LI>Add the following to the Form Load event code:
<P>
<PRE>   Sub Form_Load ()

      Const WM_USER = &amp;H400
      Const LB_SETTABSTOPS = WM_USER + 19
      Const maxlen = 10 ' Maximum expected string length in list box.
      tabchar = Chr$(9) ' ASCII code for a tab
      ReDim a$(maxlen)  ' String array to right justify in list box.
      form1.Show        ' Must Show form in Load event before Print
                        ' will become visible.

      ' GetDialogBaseUnits() API function lets you calculate the average
      ' width of characters in the system font.
      bu&amp; = GetDialogBaseUnits()
      hiword = bu&amp; \ (2 ^ 16)    ' 16 pixels high in default system font.
      loword = bu&amp; And &amp;HFFFF&amp;   ' 8 pixels wide in default system font.
      Print "System font width and height, in pixels:   " &amp; loword, hiword

      'Assign the array of defined tab stops.
      Static tabs(1 To maxlen) As Integer
      For j = 1 To maxlen  ' Set tabs every 4 dialog units (one character):
         tabs(j) = (loword * j) / 2
         ' On most Windows systems, you need only this: tabs(j) = j * 4
      Next

      'Send message to the List1 control through the Windows message queue:
      retVal&amp; = SendMessage(List1.hWnd, LB_SETTABSTOPS, maxlen, tabs(1))

      For j = 1 To maxlen
         a$(j) = String$(j, "a") ' Assign an arbitrary character string.
         ' Add the appropriate number of tabstops to right justify:
         tabstring = String$(maxlen + 1 - Len(a$(j)), Chr$(9))
         List1.AddItem tabstring &amp; a$(j)
      Next

   End Sub

</PRE><P><LI>Add the following Windows API declarations to the General Declarations
   section:
<P>
<PRE>   Declare Function GetDialogBaseUnits Lib "User" () As Long
   ' Enter the following Declare statement on one, single line:
   Declare Function SendMessage Lib "user" (ByVal hWnd As Integer,
      ByVal wMsg As Integer, ByVal wp As Integer, lp As Any) As Long

</PRE><P><LI>Start the program, or press the F5 key. All strings are right-justified
   in the list box. Close the form to end the program.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 alignment right-align align<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgOther PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
