

<HTML>
<HEAD>
<TITLE>BUG: PictureBox Loses Graphics Printing from Win95 with 16-Bit </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149329">
<META NAME="KBModify" CONTENT="1996/11/19">
<META NAME="KBCreate" CONTENT="1996/03/30">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Graphics drawn on a picture box with the graphics methods do not appear when the form containing that picture box is printed using the PrintForm method. Bitmaps and/or icons print correctly. The AutoRedraw property has no affect on this problem.  W...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAYS,QBS0,QAPN,QABA,QBWS,QAIJ,QAH4,QAFF,QDKW,QAKP,QBWQ,QA6A,QAY2,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: PictureBox Loses Graphics Printing from Win95 with 16-Bit</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 19, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149329</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Graphics drawn on a picture box with the graphics methods do not appear
when the form containing that picture box is printed using the PrintForm
method. Bitmaps and/or icons print correctly. The AutoRedraw property
has no affect on this problem.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, please see the following article in the
Microsoft Knowledge Base (and use the procedures detailed in that article):
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q141933.htm">Q141933</A></B>
   TITLE     : How to Capture &amp; Print the Screen, a Form, or any Window in
               VB

</PRE>Alternatively, the problem may also be avoided by setting AutoRedraw to
true before any drawing occurs on the picturebox to be printed. Before
printing, set the Image property of the Picture box to the Picture
property. This can be accomplished with a line of code similar to:
<P>
<PRE>   Picture1.Picture = Picture1.Image

</PRE>After these steps the graphics drawn on the picture box will print
correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce</h3>
 

<OL><P><LI>Start Visual Basic 4.0. Form1 is created by default.

<P><LI>Add a single PictureBox control and a two command buttons to the form.

<P><LI>Add this code to Form1:
<P>
<PRE>   Private Sub Command1_Click()
      Picture1.Line (10, 10)-(500, 500)
      Picture1.Line (10, 500)-(500, 10)
   End Sub

   Private Sub Command2_Click()
      Form1.PrintForm
   End Sub

</PRE><P><LI>Press F5 or select Start from the Run menu to run the application. Click
   Command1 to add the graphics to the picture box, then click Command2 to
   print the form. After printing is complete, notice that the picture box
   on the printed page is empty.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb416<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgPrint
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 19, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
