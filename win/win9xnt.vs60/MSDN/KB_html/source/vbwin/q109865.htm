

<HTML>
<HEAD>
<TITLE>How to Distinguish a DblClick from a Click Event </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109865">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Usually when you issue two consecutive mouse clicks on a form or object, you will receive a click event for the first mouse click and another click event or a double-click event for the second mouse click -- depending on the period of time between ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QAO4,QAPN,QAH4,QAFF,QATK,QBS0,QBVV,QACE,QAFH,QA6G,QA4F,QAY2,QAU3,QAMR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Distinguish a DblClick from a Click Event</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109865</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic
<PRE>  programming system for Windows, versions 1.0, 2.0, and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Usually when you issue two consecutive mouse clicks on a form or object,
you will receive a click event for the first mouse click and another click
event or a double-click event for the second mouse click -- depending on
the period of time between the mouse clicks.
<P>
At times, you may want to receive only the double-click event without the
preceding click event. This article describes how to write code to
accomplish this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to receive only a DblClick
event on a form rather than a Click and then a DblClick event.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a Timer control (Timer1) to Form1.

<P><LI>Add the following code to the (general) (declarations) section of
   Form1:
<P>
<PRE>   ' The following Function gets the DoubleClickSpeed from the WIN.INI
   ' file. Windows uses this setting to determine how close together two
   ' consecutive mouse clicks must occur for it to be interpreted as
   ' a double-click.
   ' Enter the following Declare statement on one, single line:
   Declare Function GetProfileInt% Lib "Kernel" (ByVal lpAppName$,
      ByVal lpKeyName$, ByVal nDefault%)

</PRE><P><LI>Add the following code to the specified event procedures:
<P>
<PRE>   Sub Form_Load ()
      clickSpeed% = GetProfileInt("Windows", "DoubleClickSpeed", 0)
      Timer1.Enabled = False         ' Timer should be off to begin with.
      Timer1.Interval = clickSpeed%  ' After the timer is turned on
                                     ' it will trigger the Timer Event
                                     ' after a specific amount of time
                                     ' equal to that of DoubleClickSpeed.
   End Sub

   Sub Form_Click ()
      Timer1.Enabled = True          ' Turn the timer on. If another mouse
                                     ' click does not occur within the
                                     ' DoubleClickSpeed interval, the
                                     ' Timer1_Timer Event will fire.
   End Sub

   Sub Form_DblClick ()
      Timer1.Enabled = False         ' Turn off the timer. This
                                     ' prevents the Timer1_Timer event
                                     ' from firing and thus the code
                                     ' for a single click will not be
                                     ' processed.
      Print "This is a double-click" ' Code for double-click goes here.
   End Sub

   Sub Timer1_Timer ()
      ' If this event occurs then there has not been another mouse
      ' click since the previous one within the DoubleClickSpeed
      ' time interval. Thus there will be two Click events rather
      ' than a DblClick Event.
      Timer1.Enabled = False         ' Turn off the timer so the
                                     ' Timer1_Timer Event does not
                                     ' continue to fire.
      Print "This is a Single Click" ' Code for single click goes here.
   End Sub

</PRE><P><LI>Run the program.

<P><LI>Click once, wait a while, click again to receive two single clicks.

<P><LI>Click twice quickly to receive a double-click with no preceding single
   click.
<P>
</OL>NOTE: The single click code will not occur until the DoubleClickSpeed
interval passes and the Timer1_Timer event is fired.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsStd
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
