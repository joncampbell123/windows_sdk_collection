

<HTML>
<HEAD>
<TITLE>FIX: Printer.Print Statements Unable to Print w/ Postscript </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113593">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1994/04/07">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Nothing prints on the paper when you try to print a string to the printer using the printer.print statement. Nothing prints when code processing reaches the printer.enddoc statement or the end of the program.  CAUSE =====  The following two Postscr...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QACT,QBS0,QADF,QAPN,QAH4,QAVX,QAVW,QAN8,QAKP,QAB9,QDKW,QAR4,QBWS,QAU9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Printer.Print Statements Unable to Print w/ Postscript</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113593</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 2.00
WINDOWS
kbpring kbprg kbbuglist
<P>
 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows,
<PRE>  versions 1.0 and 2.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Nothing prints on the paper when you try to print a string to the printer
using the printer.print statement. Nothing prints when code processing
reaches the printer.enddoc statement or the end of the program.
<P>
<P><h2>CAUSE</h2>
 
<P>
The following two Postscript printer drivers were tested and found to
have a problem with Microsoft Visual Basic versions 1.0 and 2.0 for
Windows. The drivers with the problem are:

<UL><LI>PSCRIPT.DRV 318112 bytes dated 10-01-92

<LI>PSCRIPT.DRV 313520 bytes dated 3-02-92
<P>
</UL>The problem is that nothing prints on the paper. The Printer.Print
statement(s) may be ignored entirely when you are using either of
the two drivers listed above.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Add two statements prior to the Printer.Print statement(s) to correct
the problem. You need to set the Printer.CurrentX and Printer.CurrentY
properties to positive values. Then add the Printer.Print statement
and you should see the desired string printed on the printer's page.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the products listed at the
beginning of this article. This problem did not occur in Visual Basic
version 3.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Note that you will need a PSCRIPT.DRV 318112 bytes 10-01-92 or
PSCRIPT.DRV 313520 bytes dated 3-02-92 postscript printer driver to
reproduce the problem outlined below.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a Command button (Command1) to Form1.

<P><LI>Add the following code to the Command1 click event procedure:
<P>
<PRE>   Sub Command1_Click ()
      Printer.Print "This is a test of the Postscript printer driver"
      printer.enddoc
   End Sub

</PRE><P><LI>Run the program and click the Command1 button. You should see
   a blank piece of paper printed out if you have one of the
   specified drivers.
<P>
</OL><h3>Additional Steps to Work Around the Problem</h3>
 

<OL><P><LI>To work around the problem, add two lines of code to the Command1
   click event procedure:
<P>
<PRE>   Sub Command1_Click ()
      printer.CurrentX = 1
      printer.CurrentY = 1
      printer.Print "This is a test of the Postscript printer driver"
      printer.EndDoc
   End Sub

</PRE><P><LI>Run the program and click the Command1 button. Now you should
   see the line of text: 'This is a test of the Postscript printer
   driver' printed on the paper.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist1.00 buglist2.00 fixlist3.00 1.00 2.00<BR>
buglist1.00 buglist2.00 fixlist3.00<BR>
KBCategory: kbpring kbprg kbbuglist<BR>
KBSubcategory: APrgPrint<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
