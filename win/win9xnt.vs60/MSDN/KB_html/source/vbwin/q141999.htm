

<HTML>
<HEAD>
<TITLE>How to Use DrawFrameControl API in Visual Basic 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141999">
<META NAME="KBModify" CONTENT="1996/05/16">
<META NAME="KBCreate" CONTENT="1996/01/03">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Win32 API includes a handy function called DrawFrameControl. This function is useful for drawing many of the standard Windows 95 3D controls as graphic objects on your forms. The function only draws the controls on your form. To make these draw...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA0K,QBS0,QBJZ,QAY5,QBXQ,QAJD,QBV8,QAUR,QA5D,QBWS,QAB9,QA7O,QAOE,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use DrawFrameControl API in Visual Basic 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141999</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Win32 API includes a handy function called DrawFrameControl. This
function is useful for drawing many of the standard Windows 95 3D controls
as graphic objects on your forms. The function only draws the controls on
your form. To make these drawings behave like controls, you must add code
to provide this functionality.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This sample demonstrates how to use the DrawFrameControl function. You
create a module that declares the necessary constants and the
DrawFrameControl function. The form contains code to call the function and
draw the controls on your form. When you run the program, control drawings
appear on the form.

<OL><P><LI>Start the 32-bit version of Visual Basic 4.0, or if it is already
   running, click New Project on the File menu.

<P><LI>Use the following steps to create a module called DrawFram.bas.
<P>
   a. On the Insert menu, click Module.
   b. Copy the following code to the Module1 code window:
<P>
<P><PRE>      '*****************************************************************
      ' DrawFram.bas - Contains API declarations and constants for the
<PRE></PRE>      '                DrawFrameControl API function.
      '*****************************************************************
      Option Explicit

      Public Type RECT
         Left As Long
         Top As Long
         Right As Long
         Bottom As Long
      End Type

      '  flags for DrawFrameControl

      Public Const DFC_CAPTION = 1            'Title bar
      Public Const DFC_MENU = 2               'Menu
      Public Const DFC_SCROLL = 3             'Scroll bar
      Public Const DFC_BUTTON = 4             'Standard button

      Public Const DFCS_CAPTIONCLOSE = &amp;H0    'Close button
      Public Const DFCS_CAPTIONMIN = &amp;H1      'Minimize button
      Public Const DFCS_CAPTIONMAX = &amp;H2      'Maximize button
      Public Const DFCS_CAPTIONRESTORE = &amp;H3  'Restore button
      Public Const DFCS_CAPTIONHELP = &amp;H4     'Windows 95 only:
                                              'Help button

      Public Const DFCS_MENUARROW = &amp;H0       'Submenu arrow
      Public Const DFCS_MENUCHECK = &amp;H1       'Check mark
      Public Const DFCS_MENUBULLET = &amp;H2      'Bullet
      Public Const DFCS_MENUARROWRIGHT = &amp;H4

      Public Const DFCS_SCROLLUP = &amp;H0               'Up arrow of scroll
                                                     'bar
      Public Const DFCS_SCROLLDOWN = &amp;H1             'Down arrow of
                                                     'scroll bar
      Public Const DFCS_SCROLLLEFT = &amp;H2             'Left arrow of
                                                     'scroll bar
      Public Const DFCS_SCROLLRIGHT = &amp;H3            'Right arrow of
                                                     'scroll bar
      Public Const DFCS_SCROLLCOMBOBOX = &amp;H5         'Combo box scroll
                                                     'bar
      Public Const DFCS_SCROLLSIZEGRIP = &amp;H8         'Size grip
      Public Const DFCS_SCROLLSIZEGRIPRIGHT = &amp;H10   'Size grip in
                                                     'bottom-right
                                                     'corner of window

      Public Const DFCS_BUTTONCHECK = &amp;H0      'Check box

      Public Const DFCS_BUTTONRADIO = &amp;H4     'Radio button
      Public Const DFCS_BUTTON3STATE = &amp;H8    'Three-state button
      Public Const DFCS_BUTTONPUSH = &amp;H10     'Push button

      Public Const DFCS_INACTIVE = &amp;H100      'Button is inactive
                                              '(grayed)
      Public Const DFCS_PUSHED = &amp;H200        'Button is pushed
      Public Const DFCS_CHECKED = &amp;H400       'Button is checked

      Public Const DFCS_ADJUSTRECT = &amp;H2000   'Bounding rectangle is
                                              'adjusted to exclude the
                                              'surrounding edge of the
                                              'push button

      Public Const DFCS_FLAT = &amp;H4000         'Button has a flat border
      Public Const DFCS_MONO = &amp;H8000         'Button has a monochrome
                                              'border

      Public Declare Function DrawFrameControl Lib "user32" (ByVal _
         hDC&amp;, lpRect As RECT, ByVal un1 As Long, ByVal un2 As Long) _
         As Boolean

   c. On the File menu, click Save File and save the file as DrawFram.bas
      for the file name.

</PRE><P><LI>Copy the following code to the Form1 Code Window:
<P>
<P><PRE>      '********************************************************************
      ' DrawFram.frm - Demonstrates how to use DrawFrameControl
      '********************************************************************
      Option Explicit
</PRE><P>
<P><PRE>      '********************************************************************
      ' Helper function that allows a you to load a rect on one line
      '********************************************************************
      Private Function MakeRect(l As Long, t As Long, w As Long, _
<PRE></PRE>                                h As Long) As RECT
         With MakeRect
            .Left = l
            .Top = t
            .Right = l + w
            .Bottom = t + h
         End With

      End Function

      Private Sub Form_Load()
         ScaleMode = vbPixels
         AutoRedraw = True

      'Captions
      DrawFrameControl hDC, MakeRect(10, 10, 15, 15), DFC_CAPTION, _
         DFCS_CAPTIONCLOSE

      DrawFrameControl hDC, MakeRect(10, 30, 15, 15), DFC_CAPTION, _
         DFCS_CAPTIONRESTORE

      DrawFrameControl hDC, MakeRect(10, 50, 15, 15), DFC_CAPTION, _
         DFCS_CAPTIONMAX Or DFCS_INACTIVE

      ' Menus
      DrawFrameControl hDC, MakeRect(30, 10, 15, 15), DFC_MENU, _
         DFCS_MENUARROW

      DrawFrameControl hDC, MakeRect(30, 30, 15, 15), DFC_MENU, _
         DFCS_MENUCHECK

      DrawFrameControl hDC, MakeRect(30, 50, 15, 15), DFC_MENU, _
         DFCS_MENUBULLET

      ' Scrollbars
      DrawFrameControl hDC, MakeRect(50, 10, 15, 15), DFC_SCROLL, _
         DFCS_SCROLLUP

      DrawFrameControl hDC, MakeRect(50, 30, 15, 15), DFC_SCROLL, _
         DFCS_SCROLLSIZEGRIP

      DrawFrameControl hDC, MakeRect(50, 50, 15, 15), DFC_SCROLL, _
         DFCS_SCROLLRIGHT Or DFCS_INACTIVE

      ' Checkboxes
      DrawFrameControl hDC, MakeRect(70, 10, 15, 15), DFC_BUTTON, _
         DFCS_BUTTONCHECK

      DrawFrameControl hDC, MakeRect(70, 30, 15, 15), DFC_BUTTON, _
         DFCS_BUTTONCHECK Or DFCS_CHECKED

      DrawFrameControl hDC, MakeRect(70, 50, 15, 15), DFC_BUTTON, _
         DFCS_BUTTONCHECK Or DFCS_CHECKED Or DFCS_BUTTON3STATE

      ' Option Buttons
      DrawFrameControl hDC, MakeRect(90, 10, 15, 15), DFC_BUTTON, _
         DFCS_BUTTONRADIO

      DrawFrameControl hDC, MakeRect(90, 30, 15, 15), DFC_BUTTON, _
         DFCS_BUTTONRADIO Or DFCS_CHECKED

      DrawFrameControl hDC, MakeRect(90, 50, 15, 15), DFC_BUTTON, _
         DFCS_BUTTONRADIO Or DFCS_CHECKED Or DFCS_FLAT

      ' Push Button
      DrawFrameControl hDC, MakeRect(110, 10, 50, 20), DFC_BUTTON, _
         DFCS_BUTTONPUSH

      DrawFrameControl hDC, MakeRect(110, 40, 50, 20), DFC_BUTTON, _
         DFCS_BUTTONPUSH Or DFCS_PUSHED

      End Sub

</PRE><P><LI>On the File menu, click Save File and save the file as DrawFram.frm for
   the file name.

<P><LI>On the Run menu, click Start or press the F5 key to start the program.
   The form appears with drawings of the controls.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432 THREED DRAWFRAMECONTROL<BR>
DRAWEDGE WIN95<BR>
KBCategory: kbprg<BR>
KBSubCategory: APrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
