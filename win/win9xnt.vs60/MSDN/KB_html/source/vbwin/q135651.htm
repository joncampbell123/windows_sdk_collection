

<HTML>
<HEAD>
<TITLE>PRB: Label Grows Wider When AutoSize and WordWrap Are True </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135651">
<META NAME="KBModify" CONTENT="1996/11/19">
<META NAME="KBCreate" CONTENT="1995/08/24">
<META NAME="Keywords" CONTENT="kbui kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  As more text is added to a Label Control that has the AutoSize and WordWrap properties set to True, both the width and the height of the label increase. This is not what you might expect, which is that only the height of the label would increase.  ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAC2,QBS0,QA26,QATX,QABA,QAVS,QBXS,QA7O,QAOE,QAMN,QAIJ,QAB5,QAX6,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Label Grows Wider When AutoSize and WordWrap Are True</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 19, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135651</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
As more text is added to a Label Control that has the AutoSize and WordWrap
properties set to True, both the width and the height of the label
increase. This is not what you might expect, which is that only the height
of the label would increase.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Set the Width property back to the original width explicitly after adding
text to the caption of the label.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available. This behavior has
been modified in Visual Basic version 4.0. Increases in the width of the
Label control after text is added to the caption are now significantly
smaller than the increases seen in version 3.0, although they do still
occur. Also, in version 4.0, the width of the label doesn't become larger
and larger when you repeatedly add text to the caption. In Version 3.0, the
width of the label continues increasing as more text is repeatedly added to
the caption.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project. On Form1 (the default form), place a Label
   control (Label1) and a command button (Command1).

<P><LI>Select the Label1 control on the form and press the F4 key to see the
   Properties window. Set WordWrap and AutoSize to True, and in order to
   see the problem clearly, set the BorderStyle to 1 (Fixed - Single).
   Set the Width to 1200 Twips (twips is the default ScaleMode).

<P><LI>Double-click the Command1 button. Place the following code in the
   Command1_Click event procedure:
<P>
   MsgBox "Start Width=" &amp; Label1.Width
   For i = 1 To 50
<P><PRE>      Label1.Caption = Label1.Caption &amp; "This is my Text "
</PRE>   Next
   MsgBox "Final Width=" &amp; Label1.Width

<P><LI>Run the program by pressing the F5 key. Press the Command1 to see that
   the width of Label1 increases as more text is added to the Caption. In
   Visual Basic version 3.0, the width increases with each successive
   addition of text. In Visual Basic version 4.0, the width of the label
   increases once but does not continue to grow.
<P>
</OL><h3>Example Workaround</h3>
 
<P>
To prevent the width from becoming excessively large, you can use this
code:
<P>
<PRE>   MsgBox "Start Width=" &amp; Label1.Width
   OriginalWidth = Label1.Width
   Label1.Visible = False
   For i = 1 To 50
      Label1.Caption = Label1.Caption &amp; "This is my Text "
   Next
   Label1.Width = OriginalWidth
   Label1.Visible = True
   MsgBox "Final Width=" &amp; Label1.Width

</PRE></OL>This workaround suitable only for solving the large increases in label
width that are seen in version 3.0. The AutoSize feature will probably
cause the final width of the control to be slightly larger than the
original width of the label as more text is added, even when the width is
explicitly set. The differences between the initial and final widths of the
control after text is added to the caption will depend on the content of
the new caption and the font characteristics.
<P>
By setting the AutoSize property of the label to False before setting the
label width back, the original width can be obtained. However, this will
result in text being truncated.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 3.00 Windows 95 vb4all<BR>
KBCategory: kbui kbusage<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 19, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
