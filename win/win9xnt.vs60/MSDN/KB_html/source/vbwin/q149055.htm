

<HTML>
<HEAD>
<TITLE>Jet Doesn't Support QueryDefs on a Non-Attached ODBC Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149055">
<META NAME="KBModify" CONTENT="1996/07/19">
<META NAME="KBCreate" CONTENT="1996/03/26">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Jet does not support named QueryDefs on a non-attached ODBC database. A non attached ODBC database is one that is opened directly with the OpenDatabase method of the WorkSpace object without the use of an .mdb file.  STATUS ======  This behavior is...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA9E,QA1S,QBS0,QA39,QAZV,QAFF,QAY5,QAW6,QAUJ,QABT,QBWS,QBVV,QAYY,QAWM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Jet Doesn't Support QueryDefs on a Non-Attached ODBC Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 19, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149055</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Enterprise Edition of Microsoft Visual Basic version 4.0, for
   Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Jet does not support named QueryDefs on a non-attached ODBC database. A non
attached ODBC database is one that is opened directly with the
OpenDatabase method of the WorkSpace object without the use of an .mdb
file.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design because Jet does not have a place to store the
QueryDef object on the ODBC source.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The preferred method for opening an external ODBC table is to attach it to
an .mdb file. For additional information, please see the following
article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q150716.htm">Q150716</A></B>
   TITLE     : DAO: How To Attach to and Create QueryDefs on ODBC Tables

</PRE>If this method is not appropriate for your application, the following
example shows how to createQuerydefs with no name:
<P>
<PRE>   Set qd = db.CreateQueryDef("")
   qd.SQL = "Select * from authors"


</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<UL><LI>If you use the &lt;object&gt;.CreateQueryDef("qdname") method and specify a
   QueryDef name, you get the error 3219 - Invalid operation.

<LI>If you specify a &lt;object&gt;.Name property, you get error 3251 - Operation
   is not supported for this type of object.
<P>
</UL>The following information is from Guide To Data Access Objects, Chapter 7,
Data Access Choices:
<P>
In many cases, attaching a table is a faster way to access external data
than opening a table directly, especially when the data is located in an
ODBC database. In Visual Basic version 4.0, you can even use SQL
Passthrough to directly query attached ODBC databases. If possible, it's
best to consider attaching external tables rather than opening them
directly. If you're using external data in an ODBC database and your
particular situation requires opening the external tables directly, keep in
mind that performance will be significantly slower when you are using the
data.
<P>
<P><h3>Sample Program</h3>
 
<P>
The following example describes how to create a Querydef with no name.
There is no need to set up a DSN with the ODBC Admin utility as it uses a
"DSN-less" ODBC connection.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default. Add
   two command buttons to Form1, command1 and command2 by default.

<P><LI>Paste the following code in the General Declarations section of form1:
<P>
   Dim db As Database
   Dim cn As String
   Dim qd As QueryDef
<PRE>   Private Sub Form_Load()
     'open db directly, without attaching
     cn = "odbc;driver={SQL Server};server=myserver;" &amp; _
       "database=pubs;uid=myuid;pwd=mypwd"
     Set db = OpenDatabase(Name:=pubs, Exclusive:=False, _
       ReadOnly:=False, Connect:=cn)
   End Sub
   Private Sub Command1_Click()
     'If we try to name it, we get the following error:
     'Error 3251 "Operation is not supported for this type of object."
     Set qd = db.CreateQueryDef("")
     'If we try to name it like this we get error 3219 "Invalid operation."
     'qd.Name = "abc"
     qd.Connect = cn
     qd.SQL = "Select * from titles"
   End Sub
   Private Sub Command2_Click()
     Dim rs As Recordset
     Set rs = qd.OpenRecordset()
     Call displayResults(rs)
    End Sub
   Sub displayResults(rs As Recordset)
     Dim f As Field, s As String, i As Integer
     For Each f In rs.Fields
       s = s &amp; f.Name
     Next f
     Debug.Print s              'print column headers
    While Not rs.EOF And i &lt; 5
       s = ""
       For Each f In rs.Fields
         s = s &amp; f.Value
       Next f
       Debug.Print s            'print first 5 rows
       rs.MoveNext
       i = i + 1
     Wend
   End Sub

</PRE><P><LI>Change the DRIVER, SERVER, DATABASE, UID, and PWD in the OpenConnection
   method. Modify the SQL statement contained in the Command1_Click event
   to match the SQL data source.

<P><LI>Start the program or press the F5 key. Click on the Command1 button to
   create the Querydef, and command2 to execute the query, which will
   display the first 5 rows of data in the debug window.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Jet Database Engine Programmer's Guide, Microsoft Press, page 323
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: APrgDataODBC
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 19, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
