

<HTML>
<HEAD>
<TITLE>PRB: Accelerator Keys Don't Work with Disabled MDI Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129804">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/05/04">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When a MDI Form is programmatically disabled (Form1.Enabled = False), accelerator keys on the MDI Parent form will not respond to user input.  CAUSE =====  By disabling the window with the keyboard focus, you now have a disabled window with the foc...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QADO,QBXS,QA4P,QABB,QDL9,QBWQ,QBWO,QBWN,QAGH,QAIJ,QAY5,QAH4,QABA,QAQT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Accelerator Keys Don't Work with Disabled MDI Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129804</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a MDI Form is programmatically disabled (Form1.Enabled = False),
accelerator keys on the MDI Parent form will not respond to user input.
<P>
<P><h2>CAUSE</h2>
 
<P>
By disabling the window with the keyboard focus, you now have a disabled
window with the focus. Because it has the focus, all keystrokes are
directed to it, but because it is disabled, those keystrokes are not
processed. This is true even for accelerators on the MDI parent form.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This behavior exists in both versions 3.0 and 4.0 of Microsoft Visual Basic
for Windows. This is, in fact, standard Windows MDI behavior.
<P>
The solution is to always move the focus off the MDI child form when it
becomes disabled programmatically. If the focus is on a disabled MDI child,
the accelerator keys will not work under Windows, because Windows doesn't
send up the WM_KEYDOWN message that Visual Basic would have to process for
the accelerator's keystroke.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. This is standard Windows MDI form behavior.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a new MDI form to your project (MDIForm1).

<P><LI>Add two menu items to MDIForm1 using the following as a guide:
<P>
<PRE>   Menu       Property     Value
   ------------------------------
   mnuTop     Caption      Top
   mnuTop     Name         mnuTop

   mnuSub1    Caption      Sub1
   mnuSub1    Name         mnuSub1

</PRE><P><LI>Indent mnuSub1 making it a sub-menu of mnuTop by pressing the right
   arrow button on the Menu Editor.

<P><LI>Assign the ShortCut key CTRL+A to mnuSub1.

<P><LI>Add the following code to the mnuSub1_Click event:
<P>
<PRE>   Sub mnuSub1_Click()
      Msgbox "Accelerator Key Responded."
   End Sub

</PRE><P><LI>On Form1, add a command button (Command1).

<P><LI>Add the following code to Command1_Click() event:
<P>
<PRE>   Sub Command1_Click()
      Me.Enabled = False
   End Sub

</PRE><P><LI>Start the program by choosing Start from the Run menu or by pressing the
   F5 key.

<P><LI>Click the Command1 button on Form1. Form1 becomes disabled, and it has
<P><PRE>    the focus.
</PRE>
<P><LI>Press CTRL+A. The accelerator menu on MDIForm1 does not respond.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: PrgCrtlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
