

<HTML>
<HEAD>
<TITLE>FIX: Graph Custom Control Incompatible w/ HP II Series Printer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80912 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1992/02/20">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Visual Basic Graph custom control cannot successfully print directly to a Hewlett-Packard (HP) II series LaserJet. This is a compatibility issue between the Graph custom control and the HP II series only. It is not a problem with Visual Basic. ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAOX,QAG9,QAB5,QAPN,QAMN,QA7O,QAOE,QAHT,QACT,QAR4,QAPG,QAA7,QDKW,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Graph Custom Control Incompatible w/ HP II Series Printer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80912 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 2.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows, version 2.0
- Microsoft Professional Toolkit for Microsoft Visual Basic programming
<PRE>  system for Windows, version 1.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Visual Basic Graph custom control cannot successfully print
directly to a Hewlett-Packard (HP) II series LaserJet. This is a
compatibility issue between the Graph custom control and the HP II
series only. It is not a problem with Visual Basic.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around the problem, add an additional form to the project,
transfer the graph's image to the form, and then print the form. This
method bypasses the DrawMode=5 (print) method and the incompatibility
issue. The example in the More Information section demonstrates how
how to implement this workaround.
<P>
Note: Unless you know that your graph will never be printed on an HP
II Series LaserJet, you may wish to always use this print method.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Graph custom control
supplied with the products listed above. This bug was corrected in
Microsoft Visual Basic version 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Visual Basic Graph custom control version 1.2 allows you to send a
graph image directly to your printer by setting the graph's DrawMode
property to 5 (print). However, the Graph control is incompatible with
the HP II LaserJet family. When using the DrawMode=5 (print) method to
print to an HP II LaserJet, only a portion of the graph will print.
<P>
<P><h3>Step-by-Step Example</h3>
 
1. Start a new project in Visual Basic. Form1 is created by default.

<OL><P><LI>From the File menu, choose Add File, and select the GRAPH.VBX
   custom control file. The Graph tool will appear in the Toolbox.

<P><LI>Add another form (Form2).

<P><LI>Change the following properties for Form2:
<P>
<PRE>   Property     Value
   ------------------

   ControlBox   False
   MaxButton    False
   MinButton    False
   Caption      False

</PRE><P><LI>On Form1, create a Graph control (Graph1) and a command button
   (Command1). Set the Caption property for Command1 to "Print."

<P><LI>Size and edit Graph1 so that it appears the way you want it to print.

<P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Sub Command1_Click ()

      'change to black/white for clearer printing
      Graph1.DrawStyle = 0
      'update change to black/white
      Graph1.DrawMode = 2

      Load Form2
      'size Form2 and transfer Graph1's image
      Form2.width = Graph1.width
      Form2.height = Graph1.height
      Form2.picture = Graph1.picture
      Form2.visible = 1   'optional

      Form2.PrintForm

      'return Graph1 to display in color (optional)
      Graph1.DrawStyle = 1
      'update display to color
      Graph1.DrawMode = 2

   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT R, S) and click the Print button.
<P>
</OL>Unless you specify otherwise, Graph1 will originally be displayed in color.
Once the Command1_Click event is triggered, the graph will convert to
black and white. If you exclude the optional line Form2.visible=1, a
dialog box will appear stating that Form2 is being printed. Graph1 will
convert back to a color display, and the program will end.
<P>
If you included the optional line Form2.visible=1, you will see Form2
appear and resize with the black and white graph image as its picture.
A dialog box will appear stating that Form2 is being printed. Graph1
will convert back to a color display and the program will end.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist1.00 buglist2.00 fixlist3.00 1.00 2.00<BR>
3.00 H-P HPII<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsCus APrgPrint<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
