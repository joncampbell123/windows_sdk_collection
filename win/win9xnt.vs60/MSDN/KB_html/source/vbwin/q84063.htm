

<HTML>
<HEAD>
<TITLE>How to Use VB Graph Control to Graph Data from Grid Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84063 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/04/29">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article contains an example of how to use a Graph custom control to graph the data contained in a Grid custom control.  In order to use either the Grid or the Graph control, you must add them to the Toolbox in the Visual Basic for Windows envi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAFF,QAMN,QAB5,QA7O,QAOE,QBXS,QBJZ,QAY2,QARR,QDL9,QBWQ,QBWO,QBWN,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use VB Graph Control to Graph Data from Grid Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84063 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  versions 2.0 and 3.0
</PRE>- Microsoft Professional Toolkit for Microsoft Visual Basic programming
<PRE>  system for Windows, version 1.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains an example of how to use a Graph custom control
to graph the data contained in a Grid custom control.
<P>
In order to use either the Grid or the Graph control, you must add
them to the Toolbox in the Visual Basic for Windows environment (in
VB.EXE). You do this by selecting Add File from the File menu. From
here select the Graph.VBX file, and then repeat the process for Grid.VBX.
Graph.VBX and Grid.VBX should be found in your Windows\System directory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create the example, do the following:

<OL><P><LI>Run Visual Basic for Windows, or from the File menu, choose New
   Project (ALT, F, N) if Visual Basic for Windows is already running.
   Form1 is created by default.

<P><LI>From the File menu, choose Add File. In the Files box, select the
   GRAPH.VBX custom control file. The Graph tool appears in the
   Toolbox.

<P><LI>Repeat step 2 for the GRID.VBX custom control file.

<P><LI>Add a Grid control (Grid1), a Graph control (Graph1), and a command
   button (Command1) to Form1.

<P><LI>In the Load event for Form1, add the following code:
<P>
<PRE>   Sub Form_Load ()
      ' This Sub will do all the configuration for the Grid.
       ConfigureGrid
      ' This Sub will do all the configuration for the Graph.
       ConfigureGraph
   End Sub

</PRE><P><LI>Create the following subroutine in the general Declarations section
   of Form1 to make it callable from anywhere in the form:
<P>
<P><PRE>    Sub ConfigureGrid ()
</PRE><P>
<PRE>        ' Set the number of cols and rows for the grid.
        Grid1.Rows = 11
        Grid1.Cols = 4

        ' Set the alignment for the fixed col to centered.
        Grid1.FixedAlignment(0) = 2

        ' Set the alignment for the variable cols to centered.
        Grid1.ColAlignment(1) = 2
        Grid1.ColAlignment(2) = 2
        Grid1.ColAlignment(3) = 2

        Grid1.ScrollBars = 0

        ' Add the row labels.
        Grid1.Col = 0
        For i = 1 To 10
            Grid1.Row = i
            Grid1.Text = Str$(i)
        Next i

         ' Add the Col labels.
        Grid1.Row = 0
            Grid1.Col = 1
            Grid1.Text = "May"
            Grid1.Col = 2
            Grid1.Text = "June"
            Grid1.Col = 3
            Grid1.Text = "July"

      ' Set the starting cell on the Grid.
        Grid1.Row = 1
        Grid1.Col = 1
    End Sub

</PRE><P><LI>Create the following subroutine in the general Declarations section
   of Form1 to make it callable from anywhere on the form:
<P>
<P><PRE>    Sub ConfigureGraph ()
      ' Set the Graph to auto increment.
<PRE></PRE>        Graph1.AutoInc = 1
        Graph1.BottomTitle = "Months"
        Graph1.GraphCaption = "Graph Caption"
      ' Set the number of data groupings.
        Graph1.NumPoints = 10
      ' Set the number of data points per group.
        Graph1.NumSets = 3
    End Sub

</PRE><P><LI>Place the following line of code into the KeyPress event for Grid1:
<P>
<P><PRE>    Sub Grid1_KeyPress (KeyAscii As Integer)
      ' This adds each keystroke to the data in the current cell.
<PRE></PRE>        Grid1.Text = Grid1.Text + Chr$(KeyAscii)
    End Sub

</PRE><P><LI>For the Click event of Command1, enter the following code:
<P>
<P><PRE>    Sub Command1_Click ()
<PRE></PRE>   ' This Sub graphs the data in the Grid using the Graph control.
      ' Set the graph to the first point.
        Graph1.ThisSet = 1
        Graph1.ThisPoint = 1
    ' Load the GraphData array with all the values from the Grid,
    '    in order.
        For i = 1 To 3
            For j = 1 To 10
                Grid1.Row = j
                Grid1.Col = i
                Graph1.GraphData = Val(Grid1.Text)
            Next j
        Next i

      ' This actually graphs the array to the Graph control.
        Graph1.DrawMode = 2
    End Sub

</PRE></OL>This example will give you a grid with three columns (Months) and 10
rows. After you enter the data into the columns, choose the command
button (with the mouse or keys). The data will be taken from the grid
and graphed as a line graph.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
