

<HTML>
<HEAD>
<TITLE>BUG: Error with Edit Method After Rollback of Previous Edit </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119733">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/08/22">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You may receive an  Update without AddNew or Edit  or  No current record  run-time error message when using the Edit method on a dynaset, if you have previously used Rollback to roll back a transaction that contained an Edit method without a corres...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QBS0,QAB4,QAC1,QDLB,QDKW,QBD2,QAPN,QAKP,QDIX,QAA5,QAAP,QBXS,QA5V,QA5C V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error with Edit Method After Rollback of Previous Edit</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119733</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Programming System for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may receive an "Update without AddNew or Edit" or "No current record"
run-time error message when using the Edit method on a dynaset, if you have
previously used Rollback to roll back a transaction that contained an Edit
method without a corresponding Update method.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, you can either ensure that you perform an
Update before issuing the Rollback or use a "dummy" AddNew method after the
Rollback.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Visual Basic version 3.0. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To reproduce this problem, perform the following steps:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a command button (Command1) to the form.

<P><LI>Add the following code to the Command1_Click event:
<P>
<P><PRE>     Sub Command1_Click()
       Dim db As database
       Dim ds As dynaset
</PRE><P>
<P><PRE>       Set db = OpenDatabase("biblio.mdb")
       Set ds = db.CreateDynaset("select * from authors")
       ds.Filter = "au_id &gt; 1"
       Set ds = ds.CreateDynaset()
</PRE><P>
<P><PRE>       BeginTrans
       ds.Edit
</PRE><P>
<PRE>       'ds.update    ' This is the irst workaround.

       Rollback

       'ds.addnew    ' This is the second workaround.

       ds.Edit       ' The error occurs here.

     End Sub

</PRE><P><LI>Press F5 to run the code.
<P>
</OL>An "Update without AddNew or Edit" error message will display on the second
ds.Edit statement. (If you have the Microsoft Jet 2.0/Visual Basic 3.0
Compatibility Layer installed, you may receive a "No current record" error
at this point instead.)
<P>
To work around this problem, you can perform an Update immediately before
the Rollback. This will have no permanent effect: the Rollback will undo
the Update operation because the Update is inside the transaction. Another
option is to perform an AddNew before the first Edit after the Rollback.
(The AddNew will be voided by the Edit because the Edit occurs before an
Update.)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 3.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
