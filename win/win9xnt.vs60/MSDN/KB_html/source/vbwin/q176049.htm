

<HTML>
<HEAD>
<TITLE>BUG: Run-time Error "This Array is Fixed or Temporarily Locked" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176049">
<META NAME="KBModify" CONTENT="1998/01/23">
<META NAME="KBCreate" CONTENT="1997/10/31">
<META NAME="Keywords" CONTENT="vb5all VBKBEnv kberrmsg VS97FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  With an EXE made from a Visual Basic project, you receive the following error:     Run-time error 10:     This Array is fixed or temporarily locked   The error does not occur when the Visual Basic project is run in the design environment.  CAUSE ==...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QAAP,QAB4,QAM1,QAH7,QAH6,QAFF,QAD7,QAKP,QAYL,QAVX,QAVW,QBWS,QAJN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Run-time Error "This Array is Fixed or Temporarily Locked"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176049</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
With an EXE made from a Visual Basic project, you receive the following
error:
<P>
<PRE>   Run-time error 10:
   "This Array is fixed or temporarily locked"

</PRE>The error does not occur when the Visual Basic project is run in the design
environment.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error occurs when your project uses the Microsoft Data-bound Grid
control and you pass an element of a variant array to a procedure in a
class module. This problem only occurs in Visual Basic 5.0 if the Visual
Basic 5.0 Service Pack 2 is installed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are several possible workarounds for this problem:
<P>
- Dimension the array as a type other than Variant. For example, dimension
<PRE>  the array as type String.

  -or-

</PRE>- Pass the element of the array by value.
<P>
<PRE>  -or -

</PRE>- Use a temporary variable to store and retrieve the value of the array
<PRE>  element. For example, this code uses a variable "temp" to store and
  retrieve the value of the first element of "myarray":

     temp = myarray(1)
     MyObject.MyMethod temp
     myarray(1) = temp

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new Standard EXE project.

<P><LI>Click Components on the Project menu, and then check "Microsoft
   Databound Grid Control."

<P><LI>Draw a dbGrid control and CommandButton on Form1.

<P><LI>Add the following code to Form1:
<P>
<P><PRE>      Dim o As Object
</PRE><P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         test
      End Sub

      Private Sub test()
         Set o = New Class1
         ReDim myarray(1) As Variant
         o.MyMethod myarray(1)
      End Sub

</PRE><P><LI>Click Add Class Module on the Project menu.

<P><LI>Add the following code to Class1:
<P>
<P><PRE>      Public Sub MyMethod(x As Variant)
</PRE><P>
<P><PRE>      End Sub
</PRE>
<P><LI>Make the EXE and then run the EXE. Click Command1 and note that you
   receive the run-time error #10 and the application will quit.
</OL> 
<PRE>Keywords          : vb5all VBKBEnv kberrmsg VS97FixlistSP2
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
