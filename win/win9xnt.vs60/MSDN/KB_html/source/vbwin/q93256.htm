

<HTML>
<HEAD>
<TITLE>FIX: UAE/GPF Occurs If EXE Uses Variable Length String in Type </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q93256 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1992/12/02">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  An Unrecoverable Application Error (UAE) or general protection (GP fault can occur in the resulting executable program under the following conditions:   - Your program assigns text to a variable length string  - The variable length string is an ele...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QBS0,QAH4,QAYL,QATX,QBJZ,QBWS,QAR4,QAMA,QDL9,QBWQ,QBWO,QBWN,QAY2,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: UAE/GPF Occurs If EXE Uses Variable Length String in Type</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q93256 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00
WINDOWS
kbenv kbbuglist
<P>
 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 2.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An Unrecoverable Application Error (UAE) or general protection (GP fault
can occur in the resulting executable program under the following
conditions:

<UL><LI>Your program assigns text to a variable length string
<LI>The variable length string is an element of a user defined type
<LI>You ran the program in the Visual Basic environment immediately before
   you made the executable version of the program.
<P>
</UL>The UAE or GP fault occurs when the EXE is run after the VB.EXE environment
has been closed. If the project used to generate the EXE is still loaded
in the VB.EXE environment, the EXE will run without incident.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Load the project and compile it (make the EXE file) without executing the
project first. This will create an EXE which will operate without causing
the GP fault or UAE.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Microsoft Visual Basic
programming system for Windows, version 2.0. This problem was corrected
in Microsoft Visual Basic version 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start VB.EXE.

<P><LI>Add Module1.BAS to the project by selecting New Module... from the
   File menu.

<P><LI>Add the following code in Module1.BAS:
<P>
   Type VBSAMPLE
<P><PRE>      X as String
</PRE>   End Type
   Dim Y as VBSAMPLE
<P>
<PRE>   Sub main ()
      Y.X = "hello"
   End Sub

</PRE><P><LI>From the Options menu, choose Project... Double-click the text 'Form1.'
   A dropdown box should display the options 'Sub Main' and 'Form1.'
   Select 'Sub Main.' Then choose the OK button.

<P><LI>Press the F5 key to run the example. Then from the File menu, choose
   Make EXE... Name the executable T1.EXE.

<P><LI>Close VB.EXE. (You do not need to save the project, unless you want
   to use it for future purposes.)

<P><LI>From the File Manager, try to run the T1.EXE program. This results
   in a UAE or GP fault and the loss of the mouse cursor.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist2.00 fixlist3.00 2.00 3.00<BR>
KBCategory: kbenv kbbuglist<BR>
KBSubcategory: EnvtDes<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
