

<HTML>
<HEAD>
<TITLE>PRB: Handling Errors Caused by the MSRDC Update Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142926">
<META NAME="KBModify" CONTENT="1996/10/23">
<META NAME="KBCreate" CONTENT="1996/01/22">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Using the Edit method, followed by the Update method with the RDC (Remote Data Control), can cause run-time errors generated by the ODBC API that are identified in the rdoErrors collection and in the Error event of the RDC that you can disregard.  ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QAPN,QBWS,QA7O,QAH4,QAMN,QAKP,QAXB,QAOE,QAB5,QACI,QAFF,QBT6,QBS0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Handling Errors Caused by the MSRDC Update Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142926</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Enterprise Edition of Microsoft Visual Basic for Windows,
   version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the Edit method, followed by the Update method with the RDC (Remote
Data Control), can cause run-time errors generated by the ODBC API that are
identified in the rdoErrors collection and in the Error event of the RDC
that you can disregard. "No Current Row" is an example of an error trapped
in the Error event, and "37000: [Microsoft][ODBC SQL Server Driver][SQL
Server] Incorrect syntax near the keyword 'WHERE'" is an example of an
error from the rdoErrors collection.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem, add error handling code to ignore error messages
that can be disregarded. The code to trap these errors needs to be located
in two places:

<UL><LI>The first place is the sub procedure that contains the
   MSRDC1.Resultset.Update method, where you will place an On Error Goto
   statement.

<LI>The second place is in the RDC's Error event in which you will set
   CancelError = True to disable its default error handling. The code
   example below will show you how to do this.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a issue in the Microsoft products listed
at the beginning of the article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce</h3>
 

<OL><P><LI>Start Visual Basic, or if it is already running, choose New Project from
   the File menu.

<P><LI>If the Microsoft RemoteData Control is not in the Toolbox, right click
   on the Toolbox and select "Custom Controls" from the pop-up menu. In
   the Custom Controls dialog box, click on the entry labeled "Microsoft
   RemoteData Control" and click OK to add the Microsoft RemoteData
   Control.

<P><LI>Double click on the RemoteData Control in the Toolbox to add a new
   RemoteData Control, named MSRDC1, to the form.

<P><LI>Right-click on the MSRDC and select Properties to set the DataSource
   property to a valid DSN, and the SQL property to an appropriate SQL
   statement.

<P><LI>Place three Text Boxes on the form and set their DataSource properties
   to MSRDC1 and their DataField properties to three different fields in
   the recordset.

<P><LI>Place two command buttons on form1 that will be named Command1 and
   Command2 by default.

<P><LI>Copy the following code into the General Declarations section of form1:
<P>
<PRE>   Private Sub Command1_Click()
     MSRDC1.Resultset.Edit
   End Sub

   Private Sub Command2_Click()
     On Error GoTo ehUpdate
     MSRDC1.Resultset.Update
   ehUpdate:
     Dim r As rdoError
     For Each r In rdoErrors
       Debug.Print "ehUpdate: ", r.Number, r.Description
     Next r
     rdoErrors.Clear
     Resume Next
   End Sub

   Private Sub MSRDC1_Error(ByVal Number As Long, _
     Description As String, ByVal Scode As Long, _
     ByVal Source As String, ByVal HelpFile As String, _
     ByVal HelpContext As Long, CancelDisplay As Boolean)
     Select Case Number
       Case 56524  '"No current row" error
         ' proper error handling
       Case Else
         ' other error handling
     End Select
     Debug.Print "MSRDC1_Error: ", Number, Description
     CancelDisplay = True   ' don't display default error handling
   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) or press F5 to start the
   application.

<P><LI>If the Debug window is not visible, Press CTRL+G to make it visible,
   then arrange it with your form1 so you can see both of them at the same
   time.

<P><LI>Click Command1 to execute the Edit method, change some data in one or
<P><PRE>    more of the bound Text Boxes, then click Command2 to execute the Update
    method. The data will be saved back to the table correctly but you
    will receive the following three errors from the error handling of the
    above code:
</PRE><P>
<PRE>     - MSRDC1_Error: 56524   No current row

     - ehUpdate: 0 21S02: [Microsoft][ODBC SQL Server Driver]Degree of
       derived table does not match column list

    -  ehUpdate: 40009      No current row

   Note: The errors received will vary depending on your environment so it
   is important for you to trap for any valid errors and handle them
   appropriately. An example of a valid error is one that would be
   encountered because of duplicate keys in a primary, unique index or the
   absence of data in a field created with the NOT NULL attribute.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: APrgDataOther
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
