

<HTML>
<HEAD>
<TITLE>How to Retrieve Hidden/System Files Using Dir[$]() Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104685">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/09/27">
<META NAME="Keywords" CONTENT="kbprg kbdocerr kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows by example how to use the Dir[$]() function in conjunction with the GetAttr() function to retrieve read-only, hidden, or system files.  MORE INFORMATION  The Dir[$] functions take a filespec and an attrmask as optional arguments....">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QBS0,QAB9,QAFI,QBV8,QA2S,QAPN,QAH4,QALW,QAUD,QAHE,QAFU,QBWS,QAPF,QBVR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Retrieve Hidden/System Files Using Dir[$]() Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104685</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows,
<PRE>  versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to use the Dir[$]() function in
conjunction with the GetAttr() function to retrieve read-only, hidden,
or system files.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Dir[$] functions take a filespec and an attrmask as optional
arguments.
<P>
If the attrmask argument specifies the volume label, the Dir[$] functions
ignores all other attributes. If the attrmask argument is ATTR_HIDDEN,
ATTR_SYSTEM, or ATTR_DIRECTORY, the functions also return the files that
do not have any special attributes.
<P>
If the filespec argument is used, the functions return files that do not
have any hidden, system, or directory attributes and meet the filespec
requirements.
<P>
To retrieve only read-only, hidden, or system files, use the Dir[$]()
functions in conjunction with the GetAttr() function. The following shows
by example how to retrieve only hidden files (files that have the HIDDEN
or ATTR_HIDDEN+ATTR_ARCHIVE attributes) by using the Dir() function in
conjunction with the GetAttr() function.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic or begin a new project if Visual Basic is already
   running. Form1 is created by default.

<P><LI>Place the following code in the general declarations area for Form1:
<P>
   Const ATTR_NORMAL = 0
   Const ATTR_READONLY = 1
   Const ATTR_HIDDEN = 2
   Const ATTR_SYSTEM = 4
   Const ATTR_VOLUME = 8
   Const ATTR_DIRECTORY = 16
   Const ATTR_ARCHIVE = 32

<P><LI>Add a List box and a command button to Form1.

<P><LI>Add the following code to the command button's click event procedure:
<P>
<PRE>   Sub Command1_Click ()
      Dim filename As String
      Dim attr As Integer
      ' retrieve hidden and normal files
      filename = Dir$("c:\", ATTR_HIDDEN)
      Do Until filename = ""
         attr = GetAttr("c:\" &amp; filename)
         ' if the file has the hidden attribute
         If (attr And ATTR_HIDDEN) Then
            ' select it
            List1.AddItem filename
         End If
         filename = Dir$
      Loop

   End Sub

</PRE><P><LI>Run the program and click the command button to see any existing
   hidden files in the root directory.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00 Dir Dir$ GetAttr docerr<BR>
KBCategory: kbprg kbdocerr kbcode<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
