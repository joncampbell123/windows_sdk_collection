

<HTML>
<HEAD>
<TITLE>PRB: ListView ItemClick Event Executes Multiple Times </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178753">
<META NAME="KBModify" CONTENT="1998/01/05">
<META NAME="KBCreate" CONTENT="1998/01/02">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The ItemClick Event in a ListView control executes multiple times when an item is selected with a single mouse click.  RESOLUTION  To work around this problem, use a Boolean value to allow only one event to execute per single click. This method is ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QBWS,QAMN,QAPN,QAO4,QAMB,QBS0,QA7O,QAOE,QAB5,QAIJ,QAFF,QBXT,QA5V,QANY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ListView ItemClick Event Executes Multiple Times</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178753</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The ItemClick Event in a ListView control executes multiple times when an
item is selected with a single mouse click.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, use a Boolean value to allow only one event to
execute per single click. This method is illustrated in the MORE
INFORMATION section of this article.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This following steps show you how to create a project that reproduces this
problem and how to workaround it.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new Standard EXE project in Visual Basic. Form1 is created by
   default.

<P><LI>Add a reference to the Microsoft Common Controls 5.0 by completing the
   following steps:
<P>
   a. From the Project menu, click Components to display the Components
<P><PRE>      dialog box.
</PRE><P>
   b. Check Microsoft Common Controls 5.0 and click OK.

<P><LI>Add a ListView control to Form1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<PRE>      Public bToggle As Boolean     'Boolean Flag

      Private Sub Form_Load()
      'Adds items to the ListView control
          ListView1.View = lvwList
          ListView1.ListItems.Add , , "Test1"
          ListView1.ListItems.Add , , "Test2"
          ListView1.ListItems.Add , , "Test3"
          ListView1.ListItems.Add , , "Test4"
          ListView1.ListItems.Add , , "Test5"
          ListView1.ListItems.Add , , "Test6"
          ListView1.ListItems.Add , , "Test7"
      End Sub

      Private Sub ListView1_ItemClick(ByVal Item As ComctlLib.ListItem)
      'This event only occurs if the Boolean flag is True.
         If bToggle = True Then
            'Comment all lines in this event except for the following
            'line to reproduce the bug.
            MsgBox ListView1.SelectedItem.Text
         End If
         bToggle = False
      End Sub

      Private Sub ListView1_MouseDown(Button As Integer, _
                                    Shift As Integer, _
                                    x As Single, _
                                    y As Single)
        'Set the Boolean flag to True. Comment the following line
        'to reproduce the bug.
         bToggle = True
      End Sub

</PRE><P><LI>If you want to reproduce the behavior, comment the appropriate lines.
   Otherwise, on the Run menu, click Start or press the F5 key to start the
   program. Click on an item in the ListView control to display a message
   box. Click OK to close the message box. If the appropriate lines were
   commented, the message box displays a second time. The correct behavior
   is the message box displays only once.
</OL> 
<PRE>Keywords          : vb5all
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
