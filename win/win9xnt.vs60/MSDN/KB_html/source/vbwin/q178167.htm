

<HTML>
<HEAD>
<TITLE>PRB: GeoFacts Sample Causes Automation Error on NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178167">
<META NAME="KBModify" CONTENT="1997/12/16">
<META NAME="KBCreate" CONTENT="1997/12/16">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all VBKBAutomation">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The GeoFacts.vbp sample project fails with the following run-time error when run on a Windows NT machine:     Run-time error '-2147467259 (80004005)':    Automation error  This error does not occur on a Windows 95 machine.  CAUSE =====  The run-tim...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAB4,QBWP,QBS0,QAH4,QAPF,QBBI,QA5B,QABI,QDL9,QBWQ,QBWO,QBWN,QBXS,QA2K V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: GeoFacts Sample Causes Automation Error on NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178167</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
   on the following platform: NT
<LI>Microsoft Visual Basic Professional and Enterprise Editions, 16-bit and
   32-bit, for Windows, version 4.0
   on the following platform: NT
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The GeoFacts.vbp sample project fails with the following run-time error
when run on a Windows NT machine:
<P>
<PRE>   Run-time error '-2147467259 (80004005)':
   Automation error

</PRE>This error does not occur on a Windows 95 machine.
<P>
<P><h2>CAUSE</h2>
 
<P>
The run-time error occurs on the following line of code:
<P>
<PRE>   Set shtWorld = GetObject("world.xls")

</PRE>The GetObject function fails because the full path to world.xls is not
specified in the argument.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When using the GetObject function, make sure that the full path to the file
name is specified. To correct the code in the GeoFacts.vbp sample, change
the following line of code (located in the Setup procedure in Module1):
<P>
<PRE>   Set shtWorld = GetObject("world.xls")

</PRE>to:
<P>
<PRE>   Set shtWorld = GetObject(app.path &amp; "\world.xls")

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q143461.htm">Q143461</A></B>
   TITLE     : XL97: CreateObject and GetObject Work Differently

   ARTICLE-ID: <B><A href="../vbwin/q178166.htm">Q178166</A></B>
   TITLE     : PRB: GeoFacts Sample Causes Type Mismatch Error with
               Excel 97
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 'world.xls' could not be found<BR>
Keywords          : VB4ALL VB4WIN vb5all VBKBAutomation<BR>
Version           : WINDOWS:4.0,5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
