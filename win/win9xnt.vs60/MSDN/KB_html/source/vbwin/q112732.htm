

<HTML>
<HEAD>
<TITLE>How to Seek a CD Track by Using the MCI Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112732">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/03/17">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The MCI Control supports seeking a certain Track by using the Commmand and To properties. In order to seek to a specific track, specify which track in the To property of the MCI Control. Then, using the Command property, perform the seek. This arti...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA7O,QAOE,QAMN,QAB5,QAPN,QBS0,QACI,QAIJ,QDMH,QAU5,QAFF,QA9N,QBWS,QBXM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Seek a CD Track by Using the MCI Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112732</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The MCI Control supports seeking a certain Track by using the Commmand
and To properties. In order to seek to a specific track, specify which
track in the To property of the MCI Control. Then, using the Command
property, perform the seek. This article gives an example.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The To property of the MCI Control will allow the seek to move to
another position based on the current time format. If you set the
TimeFormat property to MCI_FORMAT_TMSF (10), it will allow you to
move to the beginning of specific tracks.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example shows how to seek through all tracks on a CD
and play them for five seconds with the MCI Control.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add an MCI Control (MMControl1) to Form1.

<P><LI>Place the following code in the Form_Load event of Form1:
<P>
<PRE>   Sub Form_Load()
      MMControl1.DeviceType = "CDAudio"
      MMControl1.Command = "Open"
   End Sub

</PRE><P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Sub Command1_Click()
      ' Set the timeformat to allow seek to move between tracks:
      mmcontrol1.TimeFormat = 10
      ' Loop through all tracks and play each for five seconds:
      For i = 1 To MMControl1.Tracks
         MMControl1.To = Str$(i)
         MMControl1.Command = "Seek"
         MMControl1.Command = "Play"
         x = Timer
         While Timer &lt; x + 5
            DoEvents
         Wend
      Next
      ' Stop the CD:
      MMControl1.Command = "pause"
   End Sub

</PRE><P><LI>Run the program. The MCI Control should start playing Track 2
<P>
</OL>NOTE: Before starting this program, a CD must be inserted and ready
to play. Therefore, you should add code to detect when a CD has
been inserted and then run the above code.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, see the Multimedia Programmer's Reference,
CDAudio.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
