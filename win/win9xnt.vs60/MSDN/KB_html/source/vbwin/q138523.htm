

<HTML>
<HEAD>
<TITLE>PRB: MDI Child Form Drawn Incorrectly with Missing Title Bar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138523">
<META NAME="KBModify" CONTENT="1996/10/03">
<META NAME="KBCreate" CONTENT="1995/10/23">
<META NAME="Keywords" CONTENT="kbdisplay kbui kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If an MDI child form is maximized by setting the Windowstate property in the Load event of the MDI parent form, then the child form may be drawn incorrectly when first shown.  WORKAROUND  Resize the MDI parent form. Then the child form is drawn cor...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBTM,QAH4,QBJZ,QAI2,QAAP,QAPN,QABA,QBW1,QBXS,QAY5,QALZ,QA5F,QAMA,QBXU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: MDI Child Form Drawn Incorrectly with Missing Title Bar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138523</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic for Windows, version 3.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If an MDI child form is maximized by setting the Windowstate property in
the Load event of the MDI parent form, then the child form may be drawn
incorrectly when first shown.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Resize the MDI parent form. Then the child form is drawn correctly with the
Title Bar, Control Box and Restore button.
<P>
Or set the height and width of the child form to the ScaleHeight and the
ScaleWidth of the MDI parent instead of using numerical values. For
example, the following code sizes the child to the same dimensions as the
MDI parent form, and then maximizes the form:
<P>
<PRE>   MDIForm1.Width = 6000
   MDIForm1.Height = 3000
   Form1.Width = MDIForm1.ScaleWidth
   Form1.Height = MDIForm1.ScaleHeight
   Form1.WindowState = 2   ' Maximize the child window

</PRE>Replace the code in the MDIForm_Load procedure with this code to ensure
that the child form is painted correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new project. Form1 is created by default.

<P><LI>Add an MDI parent form by clicking MDI Form on the Insert menu in
   Visual Basic version 4.0 or by clicking New MDI Form on the File menu in
   Visual Basic version 3.0.

<P><LI>Set the MDIChild property of Form1 to True.

<P><LI>In the Load event of the MDI parent form, place the following code:
<P>
   MDIForm1.Width = 6000
   MDIForm1.Height = 3000
   Form1.Width = 6000
   Form1.Height = 3000
<PRE>   Form1.WindowState = 2   ' Maximize the child window

</PRE><P><LI>Run the code by pressing the F5 key. The child form appears to be drawn
   (painted) incorrectly. Refreshing the child form after it is maximized
   does correct the behavior.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 3.00 MDI vb4win vb4all<BR>
KBCategory: kbdisplay kbui kbcode kbprb<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 3, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
