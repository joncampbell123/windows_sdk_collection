

<HTML>
<HEAD>
<TITLE>PRB: Remote OLE Automation: Using Access Control Lists (ACL) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161821">
<META NAME="KBModify" CONTENT="1997/01/08">
<META NAME="KBCreate" CONTENT="1997/01/06">
<META NAME="Keywords" CONTENT="kbusage kbole kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When using a Client/Server Remote OLE Application, you receive the following error when attempting to create the server:      Run Time error '-2147023132 (800706e4)': OLE Automation Error   CAUSE =====  The server has been configured to  Allow Remo...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QAAP,QAB4,QBW7,QAD7,QAA1,QAKP,QANN,QARL,QA9Q,QAGI,QDMH,QAK7,QBWO,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Remote OLE Automation: Using Access Control Lists (ACL)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161821</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition, 32-bit only, for Windows,
   version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using a Client/Server Remote OLE Application, you receive the
following error when attempting to create the server:
<P>
<PRE>   "Run Time error '-2147023132 (800706e4)': OLE Automation Error"

</PRE><h2>CAUSE</h2>
 
<P>
The server has been configured to "Allow Remote Creates by ACL," and the
client has been set up to use an "Authentication" of "None."
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can either change the server to "Allow All Creates" or change the
client to a compatible authentication level. Changes to the server are made
in the Remote Automation Connection Manager. Changes to the Client are made
in step 4 of the Application Setup Wizard. A compatibility chart is
included in the MORE INFORMATION section of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Many of the examples given by Microsoft on creating Remote OLE servers
suggest using an "Authentication" level of "None" in step 4 of the Setup
Wizard for the client application.
<P>
Step 4 of the Setup Wizard calls for you to "Add OLE Servers." At this
point, you need to change the drop-down box to "List Files of Type:"
"Remote OLE Servers (*.vbr)," and select the VBR file that was created when
the Server executable was compiled. The VBR file should have the same name
and be in the same directory as the server executable.
<P>
Immediately after selecting the VBR file, you will see the "Remote OLE
Servers Details" dialog box. The last option in the dialog box is
"Authentication." This setting is defaulted to "1 - None." In all cases,
using an "Authentication" of "None" will cause an error when the client
attempts to create an object on the server which has been configured for
"Allow Remote Creates by ACL".
<P>
The available "Authentication" options are:
<P>
<PRE>   0 - Default            Use network default.

   1 - None               No authentication.

   2 - Connect            Connection to the server is authenticated.

   3 - Call               Authenticates only at the beginning of each
                          remote procedure call when the server receives
                          the request. Does not apply to connection-based
                          protocol sequences (those starting with the
                          prefix "ncacn").

   4 - Packet             Verifies that all data received is from the
                          expected client.

   5 - Packet Integrity   Verifies that none of the data transferred
                          between client and server has been modified.

   6 - Packet Privacy     Verifies all previous levels, and encrypts the
                          argument values of each remote procedure call.

</PRE>Refer to "Building Client/Server Applications with Visual Basic," Part 2:
Client Server Design, Chapter 7: Implementing OLE Servers, Page 131 - 132,
for more information on data authentication.
<P>
To assist you in determining which settings to use in the Setup Wizard, the
following charts show which combinations of operating systems, protocols,
security policies, and authentication levels will work. The values at the
beginning of each row are RPC protocols. The values at the top of each
column are authentication levels. These charts apply to "Allow Remote
Creates by ACL" only.
<P>
NOTE: The table below does not cover the case where Microsoft Windows 95 is
being used as the server because Microsoft Windows 95 does not support
Access Control Lists (ACL) authentication. Using Windows 95 for Remote OLE
Automation in this manner will always produce the error described above.
<P>
 
<P>
Client = Win 32 (Win NT 3.51 or Win95)
Server = Win NT 3.51
<P>
<PRE>                    0       1       2       3       4       5       6
                    ---------------------------------------------------

   ncacn_np         OK      error   OK      OK      OK      OK      OK

   ncacn_ip_tcp     OK      error   OK      OK      OK      OK      OK

   ncadg_ip_udp     error   error   error   error   error   error   error

   ncacn_nb_nb      OK      error   OK      OK      OK      OK      OK

   ncacn_nb_tcp     OK      error   OK      OK      OK      OK      OK

   ncacn_nb_ipx     OK      error   OK      OK      OK      OK      OK

   ncacn_spx        OK      error   OK      OK      OK      OK      OK

   ncadg_ipx        error   error   error   error   error   error   error

</PRE> 
<P>
Client = Win 16 (WFW 3.11, Win 3.1)
Server = Win NT 3.51
<P>
<PRE>                    0       1       2       3       4       5       6
                    -----------------------------------------------------

   ncacn_np         Log On  error   Log On  Log On  Log On  Log On  Log On

   ncacn_ip_tcp     Log On  error   Log On  Log On  Log On  Log On  Log On

   ncadg_ip_udp     error   error   error   error   error   error   error

   ncacn_nb_nb      Log On  error   Log On  Log On  Log On  Log On  Log On

   ncacn_nb_tcp     Log On  error   Log On  Log On  Log On  Log On  Log On

   ncacn_nb_ipx     Log On  error   Log On  Log On  Log On  Log On  Log On

   ncacn_spx        Log On  error   Log On  Log On  Log On  Log On  Log On

   ncadg_ipx        error   error   error   error   error   error   error
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbole kbprb<BR>
KBSubcategory: IAPOLE<BR>
Additional reference words: 4.00 kbdsd
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
