

<HTML>
<HEAD>
<TITLE>When to Use the New 3.0 DAO TypeLib in Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129857">
<META NAME="KBModify" CONTENT="1995/11/27">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Visual Basic version 4.0 includes two TypeLibs for data access objects (DAO):   - Microsoft DAO 2.5/3.0 Compatibility Library TypeLib   - Microsoft DAO 3.0 Object Library  This article explains when and why you should upgrade to the newer 3.0 TypeL...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAH4,QBXS,QA5F,QAW6,QAMA,QBHQ,QDKY,QAC1,QAN0,QANZ,QANF,QAH6,QA1S V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>When to Use the New 3.0 DAO TypeLib in Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129857</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual Basic version 4.0 includes two TypeLibs for data access
objects (DAO):

<UL><LI>Microsoft DAO 2.5/3.0 Compatibility Library TypeLib

<LI>Microsoft DAO 3.0 Object Library
<P>
</UL>This article explains when and why you should upgrade to the newer 3.0
TypeLib.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft DAO 2.5/3.0 Compatibility Library is provided for
compatibility with older DAO methods. Objects and methods that have
changed significantly or were replaced in the newer DAO 3.0 TypeLib are
preserved in the DAO 2.5/3.0 TypeLib. These include such things as:
DynaSets, SnapShots, and Tables as well as methods (CreateDynaset,
CreateSnapshot, and so on) that are specific to these objects.
<P>
The DAO 2.5/3.0 also provides access to the new, recommended DAO 3.0
methods (OpenRecordset, and so on). This TypeLib is provided so that your
Visual Basic version 3.0 code will port to Visual Basic version 4.0. But
once this is completed, Microsoft recommends that you convert to the newer
DAO 3.0 methods, which are available only in Visual Basic version 4.0.
<P>
The DAO 3.0 TypeLib is provided for speed and forward compatibility. The
older DAO methods are not available in the DAO 3.0 TypeLib. It contains
only the newer and more efficient methods. If your code runs with the DAO
3.0 TypeLib, it will run with future versions of of the Microsoft Jet
database engine. Microsoft recommends that you update your Visual Basic
projects so that they run with the DAO 3.0 TypeLib.
<P>
<P><h3>How to Change the Version of the DAO TypeLib</h3>
 
<P>
You can change the version of the TypeLib that you are using by choosing
Tools References from the menu. This brings up a dialog with all of the
available TypeLibs.
<P>
Note that if you choose to use the newer DAO 3.0 and continue to use
obsolete DAO 2.5 methods and objects, you may see some unexpected errors.
For example, under DAO 2.5, the following code is perfectly acceptable:
<P>
<PRE>   Dim DS As Dynaset
   Dim DB As Database
   Set DB = OpenDatabase("Biblio.MDB")
   Set DS = DB.CreateDynaset("Authors")

</PRE>However, if you chose to use the DAO 3.0 Library, the references to Dynaset
and CreateDynaset will generate this error:
<P>
<PRE>   User-defined type not defined

</PRE>This is because the Dynaset object and CreateDynaset method do not exist in
the DAO 3.0 Library. The code could be rewritten properly as:
<P>
<PRE>   Dim RS As RecordSet
   Dim DB As Database
   Set DB = DBEngine.Workspaces(0).OpenDatabase("Biblio.Mdb")
   Set RS = DB.OpenRecordSet("Authors", dbOpenDynaset)

</PRE>Note that when you reload a Project that was saved with a particular
TypeLib, Visual Basic detects this and loads the appropriate TypeLib.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg<BR>
KBSubcategory: APrgData<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
