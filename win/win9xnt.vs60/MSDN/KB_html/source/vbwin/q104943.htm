

<HTML>
<HEAD>
<TITLE>VB3 Manipulate Groups &amp; Items in Program Manager Using DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104943">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1993/10/03">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Program Manager has a DDE command-string interface that allows other applications to create, display, delete, and reload groups; add items to groups; replace items in groups; delete items from groups; and close Program Manager. The following comman...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QAH4,QAFF,QAMN,QA7O,QAOE,QAGB,QAB5,QAB4,QAAP,QBS0,QAPN,QADZ,QAUJ,QADO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 Manipulate Groups &amp; Items in Program Manager Using DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104943</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0 and 3.0
<LI>Microsoft Visual Basic for Windows, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Program Manager has a DDE command-string interface that allows other
applications to create, display, delete, and reload groups; add
items to groups; replace items in groups; delete items from groups;
and close Program Manager. The following commands perform these actions:

<UL><LI>CreateGroup
<LI>Reload (Windows 3.1 only)
<LI>DeleteGroup
<LI>ShowGroup
<LI>ReplaceItem (Windows 3.1 only)
<LI>DeleteItem (Windows version 3.1 only)
<LI>AddItem
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Perform the following steps to produce an application that manipulates
Program Manager using DDE:

<OL><P><LI>Start Visual Basic or if Visual Basic is already running, choose New
   Project from the File menu (ALT, F, N). Form1 is created by default.

<P><LI>Add a Textbox control (Text1) to Form1.

<P><LI>Add a Label control (Label1) to Form1 and change the caption to Group.

<P><LI> Add a Textbox control (Text2) to Form1 and change the name to GGroup.

<P><LI>Add a Label control (Label2) to Form1 and change the caption to Item.

<P><LI>Add a Textbox control (Text3) to Form1 and change the name to GItem.

<P><LI>Add a Label control (Label3) to Form1 and change the caption to Command
   Line.

<P><LI>Add a Textbox control (Text4) to Form1 and change the name to ItemExe.

<P><LI>Add a Command Button control (Command1) to Form1 and name it CGroup for
   create group.

<P><LI>Add the following code to the CGroup_Click event of Form1:
<P>
<P><PRE>    Sub CGroup_Click ()
    Dim cmd As String
       On Error GoTo CGError
       text1.LinkMode = 0
       text1.LinkTopic = "Progman|Progman"
       text1.LinkMode = 2
       cmd = "[CreateGroup(" + GGroup.Text + ")]"
       text1.LinkExecute cmd
<PRE></PRE>    CGDone:   text1.LinkMode = 0
       Exit Sub
    CGError:
       MsgBox "Error Adding Group"
       Resume CGDone
    End Sub

</PRE><P><LI>Add a Command Button control (Command2) to Form1 and name it DGroup for
<P><PRE>    Delete Group.
</PRE>
<P><LI>Add the following code to the DGroup_Click event of Form1:
<P>
<P><PRE>    Sub DGroup_Click ()
    Dim cmd As String
       On Error GoTo DGError
       text1.LinkMode = 0
       text1.LinkTopic = "Progman|Progman"
       text1.LinkMode = 2
       cmd = "[DeleteGroup(" + GGroup.Text + ")]"
       text1.LinkExecute cmd
<PRE></PRE>    DGDone:   text1.LinkMode = 0
       Exit Sub
    DGError:
       MsgBox "Error Deleting Group"
       Resume DGDone
    End Sub

</PRE><P><LI>Add a Command Button control (Command3) to Form1 and name it SGroup
<P><PRE>    for ShowGroup.
</PRE>
<P><LI>Add the following code to the SGroup_Click event of Form1:
<P>
<P><PRE>    Sub SGroup_Click ()
       Dim cmd As String
       On Error GoTo SGError
       text1.LinkMode = 0
       text1.LinkTopic = "Progman|Progman"
       text1.LinkMode = 2
       cmd = "[ShowGroup(" + GGroup.Text + ", 2" + ")]"
       text1.LinkExecute cmd
       cmd = "[ShowGroup(" + GGroup.Text + ", 1" + ")]"
       text1.LinkExecute cmd
    SGDone:
       text1.LinkMode = 0
       Exit Sub
    SGError:
       MsgBox "Error Showing Group"
       Resume SGDone
    End Sub
</PRE>
<P><LI>Add a Command Button control (Command4) to Form1 and name it Reload.

<P><LI>Add the following code to the Reload_Click event of Form1:
<P>
<P><PRE>    Sub Reload_Click ()
    Dim cmd As String
       On Error GoTo RLError
       text1.LinkMode = 0
       text1.LinkTopic = "Progman|Progman"
       text1.LinkMode = 2
       cmd = "[Reload(" + GGroup.Text + ")]"
       text1.LinkExecute cmd
<PRE></PRE>    RLDone:   text1.LinkMode = 0
       Exit Sub
    RLError:
       MsgBox "Error Reloading Group"
       Resume RLDone
    End Sub

</PRE><P><LI>Add a Command Button control (Command5) to Form1 and name it
<P><PRE>    AItem for add item.
</PRE>
<P><LI>Add the following code to the AItem_Click event of Form1:
<P>
<P><PRE>    Sub AItem_Click ()
    Dim cmd As String
       On Error GoTo AIError
       text1.LinkMode = 0
       text1.LinkTopic = "Progman|Progman"
       text1.LinkMode = 2
       '*** The ShowGroup is necessary because AddItem changes the group
       '*** with the focus. ShowGroup forces the group you want the
       '*** action taken to get the focus.
       If (Len(GGroup.Text) &gt; 0) Then
<PRE></PRE>          cmd = "[ShowGroup(" + GGroup.Text + ", 2" + ")]"
          text1.LinkExecute cmd
          cmd = "[ShowGroup(" + GGroup.Text + ", 1" + ")]"
          text1.LinkExecute cmd
       End If
       cmd = "[Additem(" + ItemExe.Text + "," + GItem.Text + ")]"
       text1.LinkExecute cmd
    AIDone:
       text1.LinkMode = 0
       Exit Sub
    AIError:
       MsgBox "Error adding Item"
       Resume AIDone
    End Sub

</PRE><P><LI>Add a Command Button control (Command6) to Form1 and name it
<P><PRE>    DItem for delete item.
</PRE>
<P><LI>Add the following code to the DItem_Click event of Form1:
<P>
<P><PRE>    Sub DItem_Click ()
       Dim cmd As String
       On Error GoTo DIError
       text1.LinkMode = 0
       text1.LinkTopic = "Progman|Progman"
       text1.LinkMode = 2
       '*** ShowGroup is necessary because DeleteItem changes the group
       '*** with the focus. ShowGroup forces the group you want the action
       '*** taken to get the focus.
       If (Len(GGroup.Text) &gt; 0) Then
<PRE></PRE>          cmd = "[ShowGroup(" + GGroup.Text + ", 2" + ")]"
          text1.LinkExecute cmd
          cmd = "[ShowGroup(" + GGroup.Text + ", 1" + ")]"
          text1.LinkExecute cmd
       End If
       cmd = "[DeleteItem(" + GItem.Text + ")]"
       text1.LinkExecute cmd
    DIDone:   text1.LinkMode = 0
       Exit Sub
    DIError:
       MsgBox "Error Deleting Item"
       Resume DIDone
    End Sub

</PRE><P><LI>Add a Command Button control (Command7) to Form1 and name it
<P><PRE>    RItem for replace item.
</PRE>
<P><LI>Add the following code to the RItem_Click event of Form1:
<P>
<P><PRE>    Sub RItem_Click ()
    Dim cmd As String
       On Error GoTo RIError
       text1.LinkMode = 0
       text1.LinkTopic = "Progman|Progman"
       text1.LinkMode = 2
       '*** ShowGroup forces the group you want the action taken on
       '*** to get the focus.
       If (Len(GGroup.Text) &gt; 0) Then
<PRE></PRE>          cmd = "[ShowGroup(" + GGroup.Text + ", 2" + ")]"
          text1.LinkExecute cmd
          cmd = "[ShowGroup(" + GGroup.Text + ", 1" + ")]"
          text1.LinkExecute cmd
       End If
       cmd = "[ReplaceItem(" + GItem.Text + ")]"
       text1.LinkExecute cmd
       cmd = "[Additem(" + ItemExe.Text + "," + GItem.Text + ")]"
       text1.LinkExecute cmd
    RIDone:
       text1.LinkMode = 0
       Exit Sub
    RIError:
       MsgBox "Error Replacing Item"
       Resume RIDone
    End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) or press the F5 key to run
<P><PRE>    the program. Enter the group you want created in the GGroup textbox
    and click the Create Group button. You will now see the group you
    created in Program Manager. To add an item to a group, enter the
    group in the GGroup textbox. Enter the item you want added in the
    GItem textbox and enter the command line in the ItemExe textbox.
    The item will now be in the group you specified.
</PRE><P>
</OL>For more information, refer to the "Programmers Reference, Volume 1:
Overview Microsoft Windows SDK," chapter 17, "Shell Dynamic DataExchange
Interface." Also, look in the Windows SDK Help file in the Progman topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbprg kbcode<BR>
KBSubcategory: IAPDDE<BR>
Additional reference words: 1.00 2.00 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
