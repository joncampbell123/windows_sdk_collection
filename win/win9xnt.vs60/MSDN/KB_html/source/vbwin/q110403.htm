

<HTML>
<HEAD>
<TITLE>How to Create a Read-Only Text Box Using SendMessage API </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110403">
<META NAME="KBModify" CONTENT="1995/07/20">
<META NAME="KBCreate" CONTENT="1994/01/20">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Visual Basic does not have a Read-Only property for a text box. But you can create a read-only text box by calling the Windows API SendMessage function with the EM_SETREADONLY message.  MORE INFORMATION  Setting the text box state to read-only allo...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QATX,QAUD,QBXS,QAMB,QBS0,QAH4,QARA,QAY5,QAPN,QALS,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a Read-Only Text Box Using SendMessage API</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110403</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual Basic does not have a Read-Only property for a text box. But you can
create a read-only text box by calling the Windows API SendMessage function
with the EM_SETREADONLY message.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Setting the text box state to read-only allows the user to scroll and
highlight the text in the text box, but does not allow them to edit it.
The program can still modify the text by changing the text property.
<P>
To create a read-only text box, call the Windows API SendMessage function,
using the EM_SETREADONLY message constant as the second parameter. The
SendMessage function requires the following parameters:
<P>
<PRE>   ret&amp; = SendMessage(hWnd%, uMsg%, wParam%, lParam&amp;)

</PRE>where:
<P>
<PRE>   ret&amp;     holds the return value of the function call.
   hWnd%    identifies the window handle that is to receive the message.
   uMsg%    the message to be sent (EM_SETREADONLY).
   wParam%  specifies whether to set or remove the read-only state of
            the edit control. A value of TRUE sets the state to
            read-only; a value of FALSE sets the state to read/write.
   lParam&amp;  not used for this message, set its value to 0&amp;.

</PRE>The return value of this function is nonzero if the function was
successful, and it is zero if an error occurred.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example loads a file into a text box, and then sets the
text box state to read-only:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a text box (Text1) to Form1. Select the text box and press the F4
   key to display the Properties window. Set the MultiLine property of
   Text1 to True and set the Scrollbars property to 3 - Both.

<P><LI>Add the following constants and declarations to the module level or to
   the general declarations of your code:
<P>
   Const WM_USER = &amp;H400
   Const EM_SETREADONLY = (WM_USER + 31)
<P>
<PRE>   ' Enter the following Declare statement as one, single line:
   Declare Function SendMessage Lib "User" (ByVal hWnd As Integer,
      ByVal wMsg As Integer, ByVal wParam As Integer,
      ByVal lParam As Any) As Long

   NOTE: If you add the Const declarations to the .BAS module, you need to
   delcare them as Global Const.

</PRE><P><LI>Add the following code to the Form_Load Sub procedure:
<P>
<PRE>   Sub Form_Load()
      Dim TmpStr As String
      Dim ret as Long

      Open "C:\AUTOEXEC.BAT" For Input As #1
      While Not Eof(1)
         ' Read a line of text in from the input file:
         Line Input #1, TmpStr
         ' Append it to the text box, adding carriage return and line feed:
         Text1.Text = Text1.Text &amp; TmpStr &amp; Chr$(13) &amp; Chr$(10)
      Wend
      ' Set the text box to read-only mode:
      ret = SendMessage(Text1.hWnd, EM_SETREADONLY, True, 0&amp;)

      If ret = 0 Then    ' Check the return value for error
         MsgBox "Could Not Set Text Box to Read-Only."
      End If
   End Sub

</PRE><P><LI>Start the program, or press the F5 key. When the program loads, it will
   read the AUTOEXEC.BAT file into the text box, and then set the read-only
   state of the text box. Then the user can scroll and highlight the text
   in the text box but won't be able to edit it.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgOther
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 20, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
