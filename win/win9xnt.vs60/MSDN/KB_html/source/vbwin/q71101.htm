

<HTML>
<HEAD>
<TITLE>Why Output Might Not Display from VB Form_Load Procedure </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q71101 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1991/04/06">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Any graphics or output done within a Form_Load procedure will not display on the form unless you first make the form visible with the Form1.Show method or if you set the form's AutoRedraw property to be true (non-zero).  MORE INFORMATION  When the ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPF,QA5V,QAPN,QAB9,QAFF,QAY5,QAU3,QAUD,QAMR,QAI2,QBXS,QBVV,QAYX,QAYW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Why Output Might Not Display from VB Form_Load Procedure</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q71101 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0 and 3.0
<LI>Microsoft Visual Basic programming system for Windows, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Any graphics or output done within a Form_Load procedure will not
display on the form unless you first make the form visible with the
Form1.Show method or if you set the form's AutoRedraw property to be
true (non-zero).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When the Form_Load procedure executes (at the beginning of the
program), by default the form is not yet displayed. Therefore, during
the Form_Load event, no graphics are displayed to the nonexistent form
unless you first Show the form (at run time) or set the form's
AutoRedraw property (at design time or run time).
<P>
A better approach to drawing graphics to the form is to have the
graphics drawn to the form during a Sub Form_Paint procedure. This
allows the Form.AutoRedraw property to be set to FALSE, increasing the
speed performance of your program. Visual Basic does not have to
refresh the screen image of your form as it does when a form is
overlapped with another window. You (as the programmer) are
responsible for refreshing the form, and Sub Form_Paint is the most
logical place to handle this situation.
<P>
Listed below are three examples of drawing graphics to your form. The
first example shows how the graphics fail to be displayed to the form
when drawn from within a Form_Load event procedure. The second example
shows how you could draw a circle to the form, but the Form.AutoRedraw
property must be set to TRUE for the circle to be retained in the
event the form needs to be refreshed. The third example is the best
approach; it is the fastest and most efficient of the three.
<P>
For each example below, add the following Function procedure as a code
procedure to Form1.
<P>
Function Minimum! (n1!, n2!)
<PRE>    If n1! &lt; n2! Then
        Minimum! = n1!
    Else
        Minimum! = n2!
    End If
</PRE>End Function
<P>
<P><h3>Example 1</h3>
 
<P>
No graphic is displayed to the form in the following:
<P>
<PRE>Sub Form_Load
   Row = Form1.ScaleHeight / 2
   Col = Form1.ScaleWidth / 2
   Radius = Minimum(Row, Col)   ' Function that returns smaller number.
   Form1.Circle (Col, Row), Radius
End Sub

</PRE><h3>Example 2</h3>
 
<P>
This example will work, but the AutoRedraw property of Form1 must be
TRUE for the screen to refresh properly:
<P>
<PRE>Sub Form_Load
   Form1.Show
   Form1.AutoRedraw = -1
   Row = Form1.ScaleHeight / 2
   Col = Form1.ScaleWidth / 2
   Radius = Minimum(Row, Col)   ' Function that returns smaller number.
   Form1.Circle (Col, Row), Radius
End Sub

</PRE><h3>Example 3</h3>
 
<P>
This is the best example. AutoRedraw should be set to FALSE for
better speed and efficiency.
<P>
<PRE>Sub Form_Paint
   Row = Form1.ScaleHeight / 2
   Col = Form1.ScaleWidth / 2
   Radius = Minimum(Row, Col)   ' Function that returns smaller number.
   Form1.Circle (Col, Row), Radius
End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
