

<HTML>
<HEAD>
<TITLE>Data Forms Designer Doesn't  Recognize MS Access 7.0 Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148266">
<META NAME="KBModify" CONTENT="1997/03/10">
<META NAME="KBCreate" CONTENT="1996/03/07">
<META NAME="Keywords" CONTENT="APrgOther kbtool kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  DataForms Designer under Windows 95 does not recognize a Microsoft Access 7.0 database and generates the error:  Can't open DataBase  c:\xxx.mdb  It may not be a Database or the file may be corrupt .  Steps to Reproduce the Problem  1. Start Visual...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBWS,QBS0,QBMH,QBJZ,QDN9,QAG2,QBXS,QA2Q,QAZV,QAY2,QAKJ,QDM0,QAKD,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Data Forms Designer Doesn't  Recognize MS Access 7.0 Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148266</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS
kbusage
<P>
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
DataForms Designer under Windows 95 does not recognize a Microsoft Access
7.0 database and generates the error: "Can't open DataBase "c:\xxx.mdb" It
may not be a Database or the file may be corrupt".
<P>
<P><h3>Steps to Reproduce the Problem</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F,
   N).

<P><LI>From the Add-ins menu select Data Form Designer. If Data Form Designer
   is not available choose Add-in-manager and add it to the menu.

<P><LI>After selecting Data Form Designer click on the Opendatabase button on
   Data form designer dialog and select the Northwind.mdb from the samples
   directory of the Access application. The error message will display at
   this point.
<P>
</OL><h2>CAUSE</h2>
 
<P>
In the dfd.frm which is in the data wizard sample, there is a subroutine
<PRE>Sub cmdOpenDB_Click which includes a case statement that incorrectly has a
</PRE></OL>dlgDBOpen.Flags setting of &amp;H4 or the constant value for
cdlOFNHideReadOnly. The dlgDBOpen.Flags needs to be assigned the
cdlOFNExplorer constant value which can be located in the object browser.
<P>
<P><h2>RESOLUTION</h2>
 

<OL><P><LI>Start VB4-32 and load the dfd.vbp project from the samples\datawiz
   directory of VB4-32.

<P><LI>View the code of dfd.frm file and locate the cmdOpenDB_Click procedure.

<P><LI>Change the value assigned to the dlgDBOpen.Flags setting which is shown
   below with the incorrect setting.
<P>
   With dlgDBOpen
<PRE>         .FilterIndex = 1
         .FileName = msDBName  '""
         .CancelError = True
         .Flags = &amp;H4
         .Action = 1
   End With

</PRE></OL>To change the constant value for dlgDBOpen.Flags:

<OL><P><LI>Highlight the &amp;H4 value.

<P><LI>Press the F2 key to bring up the Object Browser.

<P><LI>From the Libraries/Projects drop down list box Select "MSComDlg -
   Microsoft Common Dialog Control."

<P><LI>Under Classes/Modules, select FileOpenConstants.

<P><LI>Under Methods/Properties, select cdlOFNExplorer, then click the Paste
   button.

<P><LI>From the VB file menu, choose Make Ole Dll File, and save to the
   samples\datawiz directory of VB4-32.

<P><LI>In a new project, detach then reattach the DataForm Designer to the Add-
   ins menu. It will now recognize a Microsoft Access 7.0 database.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432<BR>
KBCategory: kbusagekbtool<BR>
KBSubcategory: APrgOther
<P>

<BR>
Keywords            : APrgOther kbtool kbusage<BR>
Version             : 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
