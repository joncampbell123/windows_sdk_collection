

<HTML>
<HEAD>
<TITLE>FILE: Programmatically Retrieve the Members of a DLL Class </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172988">
<META NAME="KBModify" CONTENT="1997/08/26">
<META NAME="KBCreate" CONTENT="1997/08/21">
<META NAME="Keywords" CONTENT="vb5all VBKBWinAPI kbsample">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows you how to programmatically retrieve the class names and members of a dll or ActiveX file that contains a type library. You can get this information by using the Object Browser in Visual Basic or you can programmatically retrieve...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBXS,QBMH,QAUJ,QDM0,QBVR,QBWS,QANF,QBHQ,QAY2,QBT6,QAMB,QDNN,QBV4,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Programmatically Retrieve the Members of a DLL Class</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172988</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows you how to programmatically retrieve the class names and
members of a dll or ActiveX file that contains a type library. You can get
this information by using the Object Browser in Visual Basic or you can
programmatically retrieve this information. The sample program uses an
unsupported file Tlbinf32.dll to retrieve some of the type library
information, but is not a complete substitute for the Object Browser.
<P>
NOTE: The file Tlbinf32.dll is not supported by Microsoft Technical Support
either electronically or via telephone. This file is subject to change
without notice.
<P>
A Visual Basic project that demonstrates how to use this file to get the
class names and members from a dll or ActiveX controls is available for
download from the Microsoft Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/clsnmmbr.exe">Clsnmmbr.exe</A> <I>(size: 20335 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The Object Browser in Visual Basic shows you the collections and member
names of a dll class. You may want to develop an add-in for use in other
development environments that has the same functionality as the object
browser and to add some automation capabilities. This sample shows you how
to retrieve this information programmatically by using the file
tlbinf32.dll. This file is stored in the OS\System directory of your
installation disk and is copied to your computer's system folder during the
Visual Basic installation.
<P>
After downloading and running the self-extracting file, the following files
are extracted to your hard drive:

<UL><LI>From1.frm (4K)
<LI>Form1.frx (1K)
<LI>Project1.vbp (1K)
<LI>Project1.vbw (1K)
<LI>Readme.txt
<P>
</UL>When you run the project in Visual Basic by pressing the F5 key, click the
Choose file button to select a dll or ActiveX file. If the file contains a
type library, the class names and members are displayed in the list box.
<P>
You can duplicate this project by completing the steps shown in the
following section.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic and chose Standard Exe or, if Visual Basic is already
   running, choose New Project from the File menu.

<P><LI>Set a reference to the file Tlbinf32.dll by completing the following
   steps:
<P>
   a. From the Project menu, click References. The References dialog box
<P><PRE>      is displayed.
</PRE><P>
   b. From the References dialog box, click Browse.
<P>
   c. From your Windows system directory, select the file Tlbinf32.dll.

<P><LI>Add the following controls to the Form1 form and set the indicated
   properties:
<P>
<PRE>   Control               Property Name             Property Setting
   ----------------------------------------------------------------
   Command Button        Name                      Command1
                         Caption                   Choose File
                         Height                    495
                         Left                      4800
                         TabIndex                  3
                         Top                       720
                         Width                     1815

   Command Button        Name                      Command2
                         Caption                   End
                         Height                    495
                         Left                      4800
                         TabIndex                  4
                         Top                       1320
                         Width                     1815

   Text Box              Name                      Text1
                         Height                    375
                         Left                      1080
                         TabIndex                  1
                         Top                       120
                         Width                     5535

   List Box              Name                      List1
                         Height                    2205
                         Left                      120
                         Top                       720
                         Width                     4455

   Common Dialog         Name                      CommonDialog1

   Label                 Name                      Label1
                         Caption                   Selected DLL
                         Height                    375
                         Left                      0
                         TabIndex                  2
                         Top                       120
                         Width                     1095

</PRE><P><LI>Copy and paste the following code to the Code window of the Form1 form.
<P>
<P><PRE>      Private Sub Form_Load()
<PRE></PRE>          strFilter = "DLL Files (*.dll)|*.dll|"
          strFilter = strFilter &amp; "OCX Files (*.ocx)|*.ocx|"
          strFilter = strFilter &amp; "All Files (*.*)|*.*"
          CommonDialog1.Filter = strFilter
      End Sub

      Private Sub Command1_Click()
          Dim x As TypeLibInfo
          Dim y As CoClasses
          Dim z As Interfaces
          Dim w As Members
          Dim u As MemberInfo
          Dim i As Integer, j As Integer, n As Integer, k As Integer
          Dim strFilter As String
          Dim strName As String, strMembers As String

          On Error Resume Next
          CommonDialog1.ShowOpen
          List1.Clear
          Text1.Text = ""

          'Program ends if you click the Cancel button in the
          'file open dialog box
          If CommonDialog1.Flags = 0 Then
              End
          End If

          'Get information from type library
          Set x = TypeLibInfoFromFile(CommonDialog1.filename)
          Set y = x.CoClasses

          'Show Type Library information in the List box
          For i = 1 To y.Count
              If i &lt;&gt; 1 Then
                  strName = ""
                  List1.AddItem strName
              End If
              strName = "Class Name: " &amp; y.Item(i).Name
              List1.AddItem strName
              Set z = y.Item(i).Interfaces
              For n = 1 To z.Count
                  Set w = z.Item(n).Members
                  For k = 1 To w.Count
                      Set u = w.Item(k)
                      strMembers = "      Member: " &amp; u.Name
                      List1.AddItem strMembers
                  Next
              Next
          Next
          Set z = Nothing
          Set y = Nothing
          Set x = Nothing
          Set w = Nothing

          'Display filename in the text box
          Text1.Text = CommonDialog1.filename

          'If the file does not contain type library information
          'then display this error message.
          If Err.Number = 91 Then
              Dim strMsgTitle As String, strMsgError As String
              Dim intResponse
              strMsgTitle = "No Type Library"
              strMsgError = "You chose a file without a type library. "
              strMsgError = strMsgError &amp; "Choose another file."
              Err.Clear
              intResponse = MsgBox(strMsgError, vbOKCancel, strMsgTitle)

              If intResponse = vbOK Then
                  Command1_Click
              End If

          End If

      End Sub

      Private Sub Command2_Click()
          End
      End Sub

</PRE><P><LI>Press the F5 key to run the program. Select a .dll or an ActiveX control
   file. If the file contains a type library, the class names and members
   are displayed in the list box.
<P>
</OL>(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Arsenio Locsin, Microsoft Corporation
 
<PRE>Keywords          : vb5all VBKBWinAPI kbsample
Version           : WINDOWS:5.0
Platform          : WINDOWS
Solution Type     : kbfile</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
