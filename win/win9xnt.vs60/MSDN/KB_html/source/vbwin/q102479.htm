

<HTML>
<HEAD>
<TITLE>FIX: Domain Functions Available Only Within SQL Statement </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102479">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/08/03">
<META NAME="Keywords" CONTENT="APrgDataAcc kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you try to use the domain aggregate function examples provided in the Microsoft Visual Basic version 3.0 for Windows Help file, you will receive this error message:     Reference to undefined Function or array  CAUSE =====  The examples for the ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAY5,QAN0,QAB9,QA9A,QAR4,QAPF,QBV8,QAPN,QA5F,QAMA,QBXS,QABM,QBW3,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Domain Functions Available Only Within SQL Statement</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102479</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbbuglist kbfixlist
<P>
 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic
<PRE>  programming system for Windows, version 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you try to use the domain aggregate function examples provided in the
Microsoft Visual Basic version 3.0 for Windows Help file, you will
receive this error message:
<P>
<PRE>   Reference to undefined Function or array

</PRE><h2>CAUSE</h2>
 
<P>
The examples for the domain aggregate functions are incorrect. The domain
aggregate functions, like the SQL aggregate functions, can be used only
within an SQL statement.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use the domain aggregate functions within an SQL statement, as in the
following example. Enter the following as one, single line:
<P>
<PRE>   Set Dn = Db.CreateDynaset("Select DAvg(""AU_ID"", ""AUTHORS"")
      FROM Authors")

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Visual Basic version
3.0 Help file. This problem has been corrected in Visual Basic version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example demonstrates how to print to the form an average of
all the AU_ID values in the Authors table from the BIBLIO.MDB database that
comes with Microsoft Visual Basic version 3.0 for Windows:

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project if Visual
   Basic is already running. Form1 is created by default.

<P><LI>Add the following code to the Click event of Form1:
<P>
<PRE>   Sub Form_Click()
      Dim Db As Database
      Dim Dn As Dynaset

      Set Db = OpenDatabase("C:\VB\BIBLIO.MDB")
      ' Note: enter the following Set Dn code as one, single line.
      Set Dn = Db.CreateDynaset("Select DAvg(""AU_ID"", ""AUTHORS"")
         FROM Authors")
         Print Dn(0) ' This is the equivelant of
                     ' Form1.Print Dn.Fields(0).Value
      ' It is always a good idea to close the database objects:
      Dn.Close
      Db.Close

   End Sub

</PRE><P><LI>Run the example. Then click the form.
<P>
</OL>All the other domain aggregate functions work in a similar way. It is only
the example that is incorrect in the Visual Basic Help file. The other
information explaining how to use the function parameters is correct.
<P>
The Following are the Domain Aggregate Functions:
<P>
<PRE>   DAvg
   DCount
   DFirst
   DLast
   DLookup
   DMin
   DMax
   DStDev
   DStDevP
   DSum
   DVar
   DVarP
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 3.00 fixlist4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgDataAcc<BR>
Keywords          : APrgDataAcc kbbuglist kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
