

<HTML>
<HEAD>
<TITLE>PRB: Visual Basic Displays Incorrect Edition Splash Screen </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149619">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1996/04/05">
<META NAME="Keywords" CONTENT="SetIns kbenv kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  After installing the Professional or Enterprise Edition of Visual Basic, the Startup splash screen displays Standard Edition. Any attempt to use the Professional or Enterprise controls or features fails and shows the error message:     License file...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDL9,QBWQ,QBWO,QBWN,QAMA,QA5F,QAA1,QBWP,QA5B,QAEF,QAF4,QDI2,QBVV,QBSO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual Basic Displays Incorrect Edition Splash Screen</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149619</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
After installing the Professional or Enterprise Edition of Visual Basic,
the Startup splash screen displays Standard Edition. Any attempt to use the
Professional or Enterprise controls or features fails and shows the error
message:
<P>
<PRE>   License file not found.

</PRE><h2>STATUS</h2>
 
<P>
The LICENSES key is corrupt or is missing the Professional or Enterprise
licensing information and cannot be read properly. Microsoft has confirmed
this to be a problem in Microsoft Visual Basic for Windows, version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual Basic and all custom controls store licensing information under
the HKEY_CLASSES_ROOT\LICENSES key. The keys under this key correspond to
components in the Visual Basic environment, third party .OCX files, and
other Windows applications. If there is any damage to this key, the
licensed components cannot retrieve their licensing information and fail to
load properly or fail to load at all.
<P>
This problem is most prevalent on Windows 3.x machines where the registry
is limited to 64K of data. Information stored beyond this 64K boundary can
not be read. Many applications now use OLE and other technologies that
require registration. As a result, a registry size above 64K is not
uncommon. Since much of the information is usually unwanted remnants of
removed or upgraded software, a periodic cleaning is recommended. This can
be accomplished by using Regcln16.exe from the Visual Basic for Windows 4.0
CD-ROM.
<P>
This problem can and does occur on Windows 95 and Windows NT machines,
although it is far less frequent. The registry is not limited to 64K on
these platforms so the problem is usually registry corruption. Although the
size of the registry is not limited, it can benefit from a periodic
cleaning using Regclean.exe.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this issue in Windows 3.x:

<OL><P><LI>Uninstall Visual Basic and delete all *.OCX and *.OCA files.

<P><LI>Delete OC25.DLL.

<P><LI>Rename Reg.dat and restart Windows.

<P><LI>Reinstall Visual Basic and all other software packages that use the
   registry.
<P>
</OL>To work around this issue in Windows 95 and Windows NT:

<OL><P><LI>Using a registry editor, delete the HKEY_CLASSES_ROOT\LICENSES key.

<P><LI>Run Regclean.exe and delete all *.OCX and *.OCA files.

<P><LI>Delete OLEPRO32.DLL.

<P><LI>Restart Windows and reinstall Visual Basic.
<P>
</OL>NOTE: The preceding methods are generally more successful but the method
following works under 64K (Windows 3.x), and if the registry is not
corrupted. This method does not interfere with any other applications.
<P>
<P><h3>Alternative Method</h3>
 

<OL><P><LI>Install Visual Basic.

<P><LI>Run Regclean.exe (Windows 95 or NT) or Regcln16.exe (Windows 3.x)

<P><LI>Delete the \LICENSES key.

<P><LI>Launch the File Manager and select the \SETUP directory on the
   Visual Basic CD-ROM.

<P><LI>Use the Extract.exe utility to find and decompress the Visual Basic
   registration file. To do this, in the Run dialog box (on the File menu,
   Run submenu), type:
<P>
<P><PRE>      EXTRACT.EXE /A /L C:\WINDOWS\ VB4-1.CAB *.REG
</PRE><P>
   Press ENTER.
   (This assumes C:\WINDOWS\ is the Windows directory of the machine.)

<P><LI>Use Regedit.exe to register the registration files. To do this, in the
   Run dialog box (on the File menu, Run submenu) type:
<P>
<P><PRE>      REGEDIT.EXE OLE2.REG
</PRE><P>
   Press ENTER. Then type:
<P>
<P><PRE>     REGEDIT.EXE VBxxx.REG
</PRE><P>
   Press ENTER.
  (This assumes xxx is PRO or ENT, depending on the version.)

<P><LI>Reinstall third party custom controls and any software that may
   use the registry to store licensing information.
</OL> 
<PRE>Keywords          : SetIns kbenv kbprb
Version           : 4.00 | 4.00
Platform          : NT WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
