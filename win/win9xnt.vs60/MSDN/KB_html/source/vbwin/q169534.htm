

<HTML>
<HEAD>
<TITLE>PRB: VB 4.0 16-Bit Add-ins Fail After Installing VB 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169534">
<META NAME="KBModify" CONTENT="1997/06/09">
<META NAME="KBCreate" CONTENT="1997/06/03">
<META NAME="Keywords" CONTENT="kberrmsg vb416 vb4win vb5all VBKBAddin VBKBEnv VBKBRegistry VBKBVB kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  After Microsoft Visual Basic 5.0 is installed, any attempt to access Microsoft Visual Basic 4.0 16-bit Add-Ins on the same system causes the following error message to appear:                      ' could not be loaded.    Remove it from the list o...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAMA,QA56,QA55,QBFY,QAH4,QA5F,QAA1,QDI2,QATX,QASR,QBXT,QA5V,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: VB 4.0 16-Bit Add-ins Fail After Installing VB 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169534</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Microsoft Visual Basic Professional and Enterprise Editions, 16-bit
   only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After Microsoft Visual Basic 5.0 is installed, any attempt to access
Microsoft Visual Basic 4.0 16-bit Add-Ins on the same system causes the
following error message to appear:
<P>
<PRE>   "&lt;Name of Add-In&gt;' could not be loaded.
   Remove it from the list of available Add-Ins?"

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs because the new type information installed by Microsoft
Visual Basic 5.0 is unreadable by 16-bit Microsoft Visual Basic 4.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
By registering a .REG file, such as the one included below, you should be
able to work around this problem.
<P>
<P><h3>Step By Step Example</h3>
 

<OL><P><LI>Open NotePad or any other text editor.

<P><LI>Copy the following .REG file information into the new document.
  
   IMPORTANT NOTE: Due to the width constraints imposed by this article's
   format, the underscore character ("_") is used as a line continuation
   character when it appears at the end of a line. When the information
   below is copied into a text editor, the underscores at the end of the
   lines should be deleted and the lines which follow the underscores
   should be appended to the end of those lines. There are no leading or
   trailing spaces. For example, a line such as:
  
<P><PRE>      [HKEY_CLASSES_ROOT\TypeLib\_
      {EF404E00-EDA6-101A-8DAF-00DD010F7EBB}
</PRE><P>
   Should be interpreted as:
<P>
<P><PRE>      [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}
</PRE><P>
   Now copy the following information into your text editor:
   
   REGEDIT4
<P>
   ; Main VB5/VB4 IDE Extensibility Typelib Key
   ;
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}]
<P>
   ; VB4 Sub-Keys
   ; Information on 32-bit VB 4.0 below is important to keep if it is also
   ; installed on the machine. It is not necessary otherwise.
   ;
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\4.0]
   @="Microsoft Visual Basic 4.0 Development Environment"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\4.0\0]
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}_
<P><PRE>       \4.0\0\win16]
</PRE>   @="C:\\Program Files\\Visual Basic4\\16-bit\\vbext.olb"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}_
<P><PRE>       \4.0\0\win32]
</PRE>   @="C:\\Program Files\\Visual Basic4\\32-bit\\vbext32.olb"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\4.0\_
   FLAGS]
   @="0"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\4.0\_
   HELPDIR]
   @="C:\\Program Files\\Visual Basic4\\16-bit"
<P>
   ; VB5 Sub-Keys
   ;
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\5.0]
   @="Microsoft Visual Basic 5.0 Extensibility"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\5.0\0]
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}_
<P><PRE>       \5.0\0\win16]
</PRE>   @="C:\\Program Files\\Visual Basic4\\16-bit\\VBEXT.OLB"
   HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\5.0\0\_
   win32]
   @="C:\\Program Files\\DevStudio\\VB5\\VB5EXT.OLB"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\5.0\_
   FLAGS]
   @="0"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\5.0\_
   HELPDIR]
   @="C:\\Program Files\\DevStudio\\VB5"
<P>
   ; Additional Visual Basic 4.0 Sub-Key.
   ; Because this is the highest version, the 16-bit IDE will use it.
   ; Information on 32-bit Visual Basic 4.0 below is important to keep if
   ; it is also installed on the machine. It is not necessary otherwise.
   ;
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\99.0]
   @="Microsoft Visual Basic 4.0 Development Environment"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}_
<P><PRE>       \99.0\0]
</PRE>   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}_
<P><PRE>       \99.0\0\win16]
</PRE>   @="C:\\Program Files\\Visual Basic4\\16-bit\\vbext.olb"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}_
<P><PRE>       \99.0\0\win32]
</PRE>   @="C:\\Program Files\\Visual Basic4\\32-bit\\vbext32.olb"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\99.0\_
   FLAGS]
   @="0"
   [HKEY_CLASSES_ROOT\TypeLib\{EF404E00-EDA6-101A-8DAF-00DD010F7EBB}\99.0\_
   HELPDIR]
   @="C:\\Program Files\\Visual Basic4\\16-bit"
<P>
   ;End Reg File

<P><LI>All occurrences of the following text strings within the document must
   be replaced with the correct path strings. Make sure that the double
   back slash "\\" is used to delimit each folder.
<P>
<PRE>   Replace This                      With This
   ------------------------------------------------------------------------
   C:\\Program Files\\DevStudio\\    &lt;Your Path to Visual Basic 5.0&gt;
      VB5
   C:\\Program Files\\               &lt;Your Path to Visual Basic 4.0 32-Bit&gt;
      Visual Basic4\\32-bit
   C:\\Program Files\\               &lt;Your Path to Visual Basic 4.0 16-Bit&gt;
      Visual Basic4\\16-Bit

</PRE><P><LI>Save the file as text with a .REG extension, i.e. VBFIX.REG.

<P><LI>Open Microsoft Windows Explorer, locate and double-click the .REG file
   to register the proper entries in the Windows Registry.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post more information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>On a machine with 16-bit Microsoft Visual Basic 4.0 installed, install
   an edition of Microsoft Visual Basic 5.0.

<P><LI>Start 16-bit Visual Basic 4.0.

<P><LI>Select Add-In Manager from the Add-Ins Menu.

<P><LI>Choose any Add-In by clicking its check box.

<P><LI>Choose OK. After choosing OK, the error described at the beginning of
   this article will occur.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg vb416 vb4win vb5all VBKBAddin VBKBEnv VBKBRegistry VBKBVB kbprb<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
