

<HTML>
<HEAD>
<TITLE>PRB: Capitalization in Visual Basic 4.0 Differs from 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129712">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/05/02">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Variable case is persistent after the first reference of the variable has been set.  CAUSE =====  This happens because Visual Basic maintains a single name table for the entire project where all names that are not case-sensitive are stored as a sin...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAYL,QAUJ,QAGX,QA5F,QAMA,QAJQ,QARM,QAH4,QANF,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Capitalization in Visual Basic 4.0 Differs from 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129712</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Variable case is persistent after the first reference of the variable has
been set.
<P>
<P><h2>CAUSE</h2>
 
<P>
This happens because Visual Basic maintains a single name table for the
entire project where all names that are not case-sensitive are stored as a
single entry. This forces all occurrences of the same name, regardless of
where it is used (Sub procedure, parameter, dim, type, or whatever), to be
treated the same.
<P>
The names are based on where they are declared. The case of the name in the
last Declare statement always wins. Each name is tagged in the name table
with whether or not it has a corresponding Declare statement. If it does,
any access to the name from a statement that is not a Declare statement
causes the new name to have the same case as the name in the name table.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. This design brings Visual Basic for Windows
behavior more in line with the embedded version of Visual Basic,
Applications Edition in Excel and other Microsoft products.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Variable case in form files (.FRM) and modules (.BAS) in Visual Basic
version 4.0 is handled differently from the way it was handled in version
3.0.
<P>
In Visual Basic for Windows version 3.0, the case of your variables was
decided by the most recent line parsed by the environment containing the
variable.
<P>
This behavior changed in Visual Basic version 4.0. When you first define a
variable either by explicitly declaring it or implicitly by referencing the
variable in a line that gets parsed (assuming Option Explicit is not
enforced), that is the case that will be used throughout your program.
<P>
This occurs for all variables in scope at the line where the variable name
is referenced.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
In Visual Basic version 3.0:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the Form1_Click procedure:
<P>
   Dim MYVAR
<PRE>   'This creates a variable name in all Caps.

   myvar = 3
   'This changes BOTH instances of the variable name to lower case.

</PRE><P><LI>Note that the following is the final result:
<P>
   Dim myvar
   myvar = 3
<P>
</OL>In Visual Basic version 4.0:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the Form1_Click procedure:
<P>
   Dim MVAR
<PRE>   'This creates a variable name in all caps.

   MyVar = 3
   'This variable name is changed to match the case of the original
   'reference.

</PRE><P><LI>Note that the following is the final result:
<P>
   Dim MYVAR
   MYVAR = 3
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 case sensitivity insensitive insensitivity<BR>
vb4win vb4all<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
