

<HTML>
<HEAD>
<TITLE>BUG: ActiveForm Returns Wrong Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174212">
<META NAME="KBModify" CONTENT="1997/09/25">
<META NAME="KBCreate" CONTENT="1997/09/23">
<META NAME="Keywords" CONTENT="VBKBCtrl VBKBInt VBKBObj VBKBVB">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When the ActiveForm property of the Screen object is queried, the wrong form is returned as the active form. This behavior occurs after setting the enabled property of a Command button on another form to False. The second form is listed as the acti...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QBXS,QBS0,QA5D,QAUD,QAO4,QAMB,QAJD,QACI,QAI2,QABB,QBWS,QAKP,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ActiveForm Returns Wrong Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174212</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the ActiveForm property of the Screen object is queried, the wrong
form is returned as the active form. This behavior occurs after setting the
enabled property of a Command button on another form to False. The second
form is listed as the active form, when the form with the calling code is
actually the active form.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, insert the following line of code immediately
after the code that sets the enabled property of the button:
<P>
<PRE>   Me.SetFocus

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior occurs only the first time the enabled property of the button
is set to False. During subsequent attempts or if the button's enabled
property is initially False, the problem does not occur.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new "Standard EXE" project in Visual Basic 5.0.

<P><LI>Add an MDI form to the project.

<P><LI>Add a standard form to the project.

<P><LI>Set the MDI Child property of Form1 and Form2 to True.

<P><LI>Place a Command button on Form1. Set its caption to "Disable."

<P><LI>Insert the following code into the Click event of this button:
<P>
<P><PRE>      Form2.Command1.Enabled = False
<PRE></PRE>      'Me.SetFocus         'Uncomment to Workaround this Problem
      MsgBox Screen.ActiveForm.Name

</PRE><P><LI>Add a second Command button to Form1. Set its caption to "Enable."

<P><LI>Insert the following code into the Click event of this button:
<P>
<P><PRE>      Form2.Command1.Enabled = True
</PRE>
<P><LI>Add a Command button to Form2.

<P><LI>Add the following code to the Load event of the MDI form:
<P>
<P><PRE>      Form1.Show
      Form2.Show
      MDIForm1.Arrange 1
</PRE>
<P><LI>Run the project, and then click the button labeled "Disable." Note that
<P><PRE>    the message box displays "Form2" when the active form is actually
    Form1.
</PRE>
<P><LI>Click the button labeled "Enable," and then click the button labeled
<P><PRE>    "Disable" one more time. Note that this time, "Form1" is now correctly
    returned as the active form.
</OL></PRE> 
<PRE>Keywords          : VBKBCtrl VBKBInt VBKBObj VBKBVB
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
