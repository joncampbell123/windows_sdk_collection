

<HTML>
<HEAD>
<TITLE>BUG: MDI Child Form Is Drawn Without Title in Certain Cases </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136529">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/09/11">
<META NAME="Keywords" CONTENT="kbui kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  An MDI child form is drawn incorrectly at first when it is maximized in the Load event procedure of the MDI parent form by setting the child form's Windowstate property when the child form's height and width dimensions match those of the parent for...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QAH4,QBTM,QBS0,QAI2,QABA,QA5B,QAPN,QABB,QBW1,QAKP,QBWS,QBXU,QBXS,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: MDI Child Form Is Drawn Without Title in Certain Cases</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136529</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bti and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An MDI child form is drawn incorrectly at first when it is maximized in the
Load event procedure of the MDI parent form by setting the child form's
Windowstate property when the child form's height and width dimensions
match those of the parent form. When drawn, the child form is missing the
Title bar, Control box, and Restore button.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If the MDI parent form is resized, the child form is drawn correctly
with its Title bar, Control box, and Restore button.
<P>
The form is also drawn correctly if the height and width of the child form
is set to the ScaleHeight and the ScaleWidth of the MDI parent instead of
numerical values. For example, the following code sizes the child to the
same dimensions as the MDI parent form, and then maximizes the form:
<P>
<PRE>   MDIForm1.Width = 6000
   MDIForm1.Height = 3000
   Form1.Width = MDIForm1.ScaleWidth
   Form1.Height = MDIForm1.ScaleHeight
   Form1.WindowState = 2   'Maximize the child window

</PRE>Replace the code in step 4 of the "Steps to Reproduce Problem" section of
this article with this code to see that the child form is painted correctly
when the example is run.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>On the File menu, click New Project. Form1 is created by default.

<P><LI>Add a MDI parent form. In version 4.0, click MDI Form on the Insert
   menu. In version 3.0, click New MDI Form on the File menu.

<P><LI>Set the MDIChild property of Form1 to True.

<P><LI>In the Load event of an MDI parent form, place this code:
<P>
   MDIForm1.Width = 6000
   MDIForm1.Height = 3000
   Form1.Width = 6000
   Form1.Height = 3000
<PRE>   Form1.WindowState = 2   'Maximize the child window

</PRE><P><LI>Run the code by pressing the F5 key.
<P>
</OL>Observe that the child form has been incorrectly painted. Refreshing the
child form after it is maximized does not result in the child form being
correctly painted.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 4.00 buglist3.00 buglist4.00 vb4win vb4all<BR>
KBCategory: kbui kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
