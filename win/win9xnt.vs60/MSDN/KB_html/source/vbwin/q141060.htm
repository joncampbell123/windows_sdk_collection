

<HTML>
<HEAD>
<TITLE>VB3 Using Visual Basic 3.0 to Play WAVE Files Stored in a DLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141060">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1995/12/11">
<META NAME="Keywords" CONTENT="kbmm kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  By calling the necessary Windows API, a Visual Basic program can access and play wave files stored in a dynamic-link library (DLL). Generally, a DLL that contains only resources such as wave files is referred to as a resource-only library.  NOTE: V...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA4Q,QAH4,QDL9,QBWO,QBWN,QBFY,QBWQ,QBHQ,QAY5,QA5F,QAMA,QANF,QACJ,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 Using Visual Basic 3.0 to Play WAVE Files Stored in a DLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141060</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) version 3.1
<LI>Microsoft Visual Basic version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By calling the necessary Windows API, a Visual Basic program can access and
play wave files stored in a dynamic-link library (DLL). Generally, a DLL
that contains only resources such as wave files is referred to as a
resource-only library.
<P>
NOTE: Visual Basic 3.0 does not support the insertion of resources such as
wave files into a DLL. A third-party tool such as the Microsoft C++
Compiler and its accompanying Resource Compiler are needed to accomplish
this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example shows how to create a resource-only library using
Microsoft Visual C++ 1.5. For this example, the resource-only library
contains the two wave files Ding.wav and Chimes.wav.

<OL><P><LI>Create a text file and place the following lines of code in it:
<P>
<PRE>   #include &lt;windows.h&gt;
   int FAR PASCAL LibMain(HANDLE hInstance, WORD wDataSeg, WORD wHeapSize,
   LPSTR lpszCmdLine)
   {
      if (wHeapSize &gt; 0)
         UnlockData(0);
      return 1;
   }

</PRE><P><LI>Save the above file with the extension .c.

<P><LI>Create another file and place the following text in it (the lines below
   assume that both wave files are currently located in the c:\windows
   directory):
<P>
<P><PRE>    Sound1 WAVE c:\windows\ding.wav
    Sound2 WAVE c:\windows\chimes.wav

<P><LI>Save this file with the extension .rc. This will identify it as a
    resource file.

<P><LI>From within Visual C++ version 1.5, click New on the Project menu to
    specify the name of your project. Then set the Project Type to "Windows
    dynamic-link library (.DLL)" and click OK.

<P><LI>Use the Edit dialog box that appears next to add the .c and .rc files
    created in steps 1-3.

<P><LI>On the Project menu, click Build. This will take the files created above
   and generate the resource-only library from them. This DLL contains the
   two wave files Ding.wav and Chimes.wav.
</PRE><P>
</OL>The following Visual Basic 3.0 code can then be used to play the wave
files imbedded in the DLL created above:

<OL><P><LI>In the Visual Basic programs "General Declaration" section add the
   following code:
<P>
<PRE>   Declare Function sndPlaySound Lib "mmsystem.dll" (ByVal lpRes As Any,
   ByVal wflags As Integer) As Integer

   Declare Function LoadLibrary Lib "kernel" (ByVal lpLibFileName As
   String) As Integer

   Declare Function FindResource Lib "kernel" (ByVal hInstance As Integer,
   ByVal lpname As String, ByVal lpType As Any) As Integer

   Declare Function LoadResource Lib "kernel" (ByVal hInstance As Integer,
   ByVal hResInfo As Integer) As Integer

   Declare Function LockResource Lib "kernel" (ByVal hResData As Integer)
   As Long

   Declare Function FreeResource Lib "kernel" (ByVal hResData As Integer)
   As Integer

   Declare Sub FreeLibrary Lib "kernel" (ByVal hInstance As Integer)

   Const SND_MEMORY = 4

</PRE><P><LI>In a subroutine add the following Visual Basic code. This is the code
   that actually opens the DLL and plays the Ding.wav file:
<P>
   Dim hInstance As Integer
   Dim hResInfo As Integer
   Dim hRes As Integer
   Dim lpRes As Long
   Dim iReturn As Integer
<P>
   hInstance = LoadLibrary("c:\wavedll.dll")
   hResInfo = FindResource(hInstance, "Sound1", "WAVE")
   hRes = LoadResource(hInstance, hResInfo)
   lpRes = LockResource(hRes)
   iReturnVal = sndPlaySound(lpRes, SND_MEMORY)
<P>
   iReturnVal = FreeResource(hRes)
   FreeLibrary(hInstance)

<P><LI>You can then call the subroutine the code in step 9 was added to
   whenever you want the sound played.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbmm kbprg<BR>
KBSubcategory: MMWave<BR>
Additional reference words: 3.00 vb3 vbasic
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
