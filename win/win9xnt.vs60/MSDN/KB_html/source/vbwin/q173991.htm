

<HTML>
<HEAD>
<TITLE>BUG: Error Disassociating Resultset from rdoConnection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173991">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1997/09/17">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Attempting to disassociate a Resultset based on a parameterized rdoQuery object by setting the Resultset's ActiveConnection property to Nothing will result in an error:     Run-Time Error '40070':    This property or method is not supported when us...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBXS,QAAP,QAB4,QABA,QBWQ,QAW6,QBWS,QAKP,QA2Q,QAY2,QAN0,QANF,QANE,QA2O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error Disassociating Resultset from rdoConnection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173991</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
   on the following platforms: NT, Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Attempting to disassociate a Resultset based on a parameterized rdoQuery
object by setting the Resultset's ActiveConnection property to Nothing will
result in an error:
<P>
<PRE>   Run-Time Error '40070':
   This property or method is not supported when using the currently
   selected cursor library.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when the Resultset is based on a parameterized rdoQuery
object. It also occurs using the UserConnection object with the same
circumstances.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The only workaround is to not use a parameterized rdoQuery object to create
a Resultset.
<P>
You can set the Resultset ActiveConnection property to Nothing if:
<P>
- The Resultset is based on a SQL Select statement or a non-parameter
<PRE>  rdoQuery,

  - and -

</PRE>- the CursorDriver is rdUseClientBatch, the type is rdOpenStatic, and the
<PRE>  locktype is rdConcurBatch.

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new project.

<P><LI>Click References on the Project menu, and check Microsoft Remote Data
   Object 2.0.

<P><LI>Add a Command Button to Form1.

<P><LI>Add the following code to the General Declarations of Form1:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         Dim Rs As rdoResultset
         Dim Cn As rdoConnection
         Dim strConnect As String
         Dim Query1 As rdoQuery

         strConnect = "Driver={SQL Server};Server=MyServer;" &amp; _
         "Database=pubs;Uid=sa;Pwd="
         rdoEnvironments(0).CursorDriver = rdUseClientBatch
         Set Cn = rdoEnvironments(0).OpenConnection(dsName:="", _
         Prompt:=rdDriverNoPrompt, ReadOnly:=False, Connect:=strConnect)

         'To run without error, uncomment the next line and comment the
         'following 2 lines.
         'Set Query1 = Cn.CreateQuery("Query1", _
           "SELECT au_id, au_lname, au_fname FROM authors")
         Set Query1 = Cn.CreateQuery("Query1", _
           "SELECT au_id, au_lname, au_fname FROM authors WHERE au_id = ?")
         Cn.rdoQueries("Query1").rdoParameters(0) = "238-95-7766"

         Set Rs = Cn.rdoQueries("Query1").OpenResultset(rdOpenStatic, _
           rdConcurBatch)
         Set Rs.ActiveConnection = Nothing       ' This causes the error
         Rs.MoveLast
         Rs.MoveFirst
           Do Until Rs.EOF
           Debug.Print Rs(1)
           Rs.MoveNext
         Loop
         Cn.Close
      End Sub

</PRE><P><LI>Press the F5 key to run the project. Click Command1. You will receive
   the run-time error '40070' when setting the ActiveConnection to Nothing.
</OL> 
<PRE>Keywords          : vb5all
Version           : WINDOWS:5.0
Platform          : NT Win95 WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
