

<HTML>
<HEAD>
<TITLE>BUG: Incorrect Popup Menu Events Fired with Invisible Menus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116058">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/06/09">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When the following conditions are met, Visual Basic may incorrectly fire a menu's Click event for the first visible menu item under the first menu on the form:   - You use the PopupMenu method to display a menu that has its Visible    property set ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVI,QBS0,QAPN,QAF0,QA01,QAO4,QAH4,QAFF,QBWR,QBWS,QAAP,QADR,QDKW,QACI,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Incorrect Popup Menu Events Fired with Invisible Menus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116058</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the following conditions are met, Visual Basic may incorrectly fire a
menu's Click event for the first visible menu item under the first menu on
the form:

<UL><LI>You use the PopupMenu method to display a menu that has its Visible
   property set to False.

<LI>The PopupMenu is not the first (leftmost) menu on the form, and the
   first menu on the form also has its Visible property set to False.
<P>
</UL>Under these conditions, the Click event for the first visible menu item on
the first menu will be fired immediately after the PopupMenu method is
called, so the desired PopupMenu will not be displayed.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, either:

<UL><LI>Make the first menu on the form visible.
<P>
</UL>Or:

<UL><LI>Place all popup menus on a separate form. Then you can leave all the
   menus on your popup menus visible, but make the form that contains
   them invisible. To make the form invisible, set the form's visible
   property to false. You can invoke popup menus from other forms by
   referring to the form name and then the menu name, as in this example:
<P>
   PopupMenu Form2.Menu2
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Visual Basic version 3.0. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following menu items:
<P>
<PRE>    Caption           Name       Visible
    ------------------------------------
    Menu1             mMenu1     False
    ....Menu1Item1    mMenu11    True
    Menu2             mMenu2     False
    ....Menu2Item1    mMenu21    True

</PRE><P><LI>Add the following code for menu items:
<P>
<PRE>   Sub mMenu11_Click ()
      Msgbox "Item1"
   End Sub

   Sub mMenu21_Click ()
      MsgBox "Item2"
   End Sub

</PRE><P><LI>Add the following code to the Form_MouseDown event:
<P>
<PRE>   ' Place following two lines of code on one, single line:
   Sub Form_MouseDown (button As Integer, Shift As Integer, X As Single,
      Y As  Single)

      If button = 2 Then
         PopupMenu mMenu2
      Else
         PopupMenu mMenu1
      End If

   End Sub

</PRE><P><LI>Run the application.

<P><LI>Click the client area of Form1. Then click the Item1 popup menu item.
   The correct message box will appear.

<P><LI>With Right mouse button, click the client area of Form1. The Item1
   message box will appear, indicating the click event was generated
   for the first menu item under top-level menu 1.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 3.00 buglist3.00 hidden<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
