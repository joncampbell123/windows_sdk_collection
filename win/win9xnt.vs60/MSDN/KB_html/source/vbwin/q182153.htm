

<HTML>
<HEAD>
<TITLE>BUG: Error When Loading Visual Datatools Add-In </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182153">
<META NAME="KBModify" CONTENT="1998/03/09">
<META NAME="KBCreate" CONTENT="1998/03/06">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When launching the Visual Datatools Add-in, the following errors may occur:     Object variable or with block not set  followed by:     Visual Basic can not open the Database Tools project file. Please delete             .dsp and try again.  CAUSE ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAAP,QA56,QA55,QAH0,QBWS,QAR4,QAB4,QAA1,QDI2,QA2Q,QAKP,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error When Loading Visual Datatools Add-In</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182153</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Professional, and Enterprise
   Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When launching the Visual Datatools Add-in, the following errors may occur:
<P>
<PRE>   Object variable or with block not set

</PRE>followed by:
<P>
<PRE>   Visual Basic can not open the Database Tools project file. Please delete
   &lt;project&gt;.dsp and try again.

</PRE><h2>CAUSE</h2>
 
<P>
When the MSDN application is launched, it overwrites the LocalServer32
value for the MSDEV.APPLICATION CLSID, which is found at the below registry
location. It replaces this value with a path that points to the Infoviewer
application (IV5.EXE):
<P>
<PRE>   HKEY_CLASSES_ROOT\
    CLSID\
     {FB7FDAE2-89B8-11CF-9BE8-00A0C90A632C}\
      LocalServer32

</PRE><h2>RESOLUTION</h2>
 
<P>
WARNING: Using Registry Editor incorrectly or creating your own .reg files
can cause serious, system-wide problems that may require you to reinstall
Windows to correct them. Microsoft cannot guarantee that any problems
resulting from the use of Registry Editor can be solved. Use this tool at
your own risk. Change the Registry entry containing the incorrect path back
to the correct location of the Developer Studio Shared IDE (MSDEV.EXE)
after running MSDN.
<P>
The following registry information contained between the asterisks can be
modified to contain the correct path to MSDEV.EXE on your machine and then
saved to a file with a .reg extension to aid in changing this registry
value. After creating the file, double-click on it to launch the Registry
Editor, which will merge this information into the Registry.
<P>
*************
REGEDIT4
<P>
[HKEY_CLASSES_ROOT\CLSID\{FB7FDAE2-89B8-11CF-9BE8-
00A0C90A632C}\LocalServer32]
@="C:\\PROGRAM FILES\\DEVSTUDIO\\SHAREDIDE\\BIN\\MSDEV.EXE"
*************
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Install and launch the MSDN Library, January 1998 edition. Other
   previous editions of the MSDN Library may also cause the same behavior.

<P><LI>Close the MSDN application

<P><LI>Start Visual Basic 5.0.

<P><LI>From the Add-Ins menu, select Add-in Manager.

<P><LI>Select the Microsoft Datatools Add-in and press OK.
<P>
   NOTE: Selecting the Microsoft Datatools Add-in may prompt the
   installation of the Visual Datatools which is located on Visual Basic
   5.0 CD-ROM. This will only occur if Developer Studio Shared IDE
   (MSDEV.EXE) has not previously been installed by either Visual C++ 5.0
   or Visual InterDev 1.0. After installing, repeat these steps from the
   beginning.

<P><LI>From the Add-ins menu, select the "Visual Database Tools" Add-in. At
   this point the two errors described at the beginning of this article may
   occur. IV5.EXE may show up in the process list although MSDN is not
   running. This process may be terminated by selecting it in the Task
   Manager process list and pressing the "End Process" button.
</OL> 
<PRE>Keywords          : vb5all
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbpending</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
