

<HTML>
<HEAD>
<TITLE>PRB: Can't See Changed Data If Update VB 3.0 DB App to VB 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137023">
<META NAME="KBModify" CONTENT="1996/04/16">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Applications written and compiled in Visual Basic 3.0 that check and reflect a changing data source do not show changed records after that application is compiled Visual Basic 4.0.  RESOLUTION  This problem does not occur if you occasionally call t...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QAZV,QA5V,QAN0,QBWS,QAPN,QA5F,QAMA,QAXB,QAIJ,QAFF,QAGI,QA1S,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Can't See Changed Data If Update VB 3.0 DB App to VB 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137023</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Applications written and compiled in Visual Basic 3.0 that check and
reflect a changing data source do not show changed records after that
application is compiled Visual Basic 4.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This problem does not occur if you occasionally call the Idle method of the
DBEngine object using this line of code:
<P>
<PRE>   DBEngine.Idle dbFreeLocks

</PRE>This line of code is needed only for databases saved in Microsoft Jet
versions 1.x and 2.x. Databases created with Microsoft Jet version 3.0 do
not exhibit this behavior, and programs written only to manipulate Jet 3.0
databases do not require the call to the Idle method.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Double-click the Label button in the Toolbox to add a label control
   (Label1) to Form1.

<P><LI>Add a timer control (Timer1) to Form1 by double-clicking the Timer
   button in the Toolbox.

<P><LI>Insert the following code in the General Declarations section of Form1:
<P>
   Dim db As Database
   Dim ds As Recordset

<P><LI>Add the following code to the Form_Load and Form_Unload event
   procedures:
<P>
<PRE>   Private Sub Form_Load()
      ' Replace the next line with the path to your VB 4.0 directory:
      Set db = DBEngine(0).OpenDatabase("c:\vb\biblio.mdb")
      Set ds = db.OpenRecordset("Authors")
   End Sub

   Private Sub Form_Unload()
      ds.Close
      db.Close
   End Sub

</PRE><P><LI>Change the Interval property of the Timer control to 3000 (3 seconds).

<P><LI>Insert the following code in the Timer1_Timer event procedure:
<P>
<PRE>   Private Sub Timer1_Timer()
      Dim s As String
      s = Time$ + " / " + ds("Author")
      Label1.Caption = s
   End Sub

</PRE><P><LI>On the Run menu, click start (ALT, R, S), or press the F5 key to run
   the program.

<P><LI>Start another copy of Visual Basic, and load and run the VisData sample
   application located in \Vb\Samples\Visdata. Open the same Biblio.mdb
   database referenced in your code. Open the Authors table, make a change
   to the Author field of the first record, and update the database. With
   Visual Basic 3.0, the change will be visible immediately in the running
   application, but with Visual Basic 4.0 no change will be evident.
<P>
   To correct this behavior, add the following line of code to the
   Timer1_Timer event procedure:
<P>
<P><PRE>      DBEngine.Idle dbFreeLocks
</PRE><P>
</OL>NOTE: The Biblio.mdb database that ships with Visual Basic 4.0 is saved as
a Microsoft Jet 2.0 database. You can use VisData to convert this to a
Microsoft Jet 3.0 database. If the above example is followed using Visual
Basic 4.0 and a Microsoft Jet 3.0 database, no call to DBEngine.Idle is
necessary.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
