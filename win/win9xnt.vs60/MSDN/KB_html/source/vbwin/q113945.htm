

<HTML>
<HEAD>
<TITLE>How to Read Windows Registered User &amp; Organization </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113945">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/04/20">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The example in this article demonstrates how to extract user registration information for use in an About box for programs running under Microsoft Windows. It shows you how to retrieve this information from the string table resource inside USER.EXE...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGU,QBS0,QDL9,QBWO,QBWN,QA4Q,QAH4,QBWQ,QATX,QAIM,QBWF,QAIC,QAB9,QA01,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Read Windows Registered User &amp; Organization</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113945</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The example in this article demonstrates how to extract user registration
information for use in an About box for programs running under Microsoft
Windows. It shows you how to retrieve this information from the string
table resource inside USER.EXE.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The registered owner and organization of Microsoft Windows versions 3.x are
stored as string resources in USER.EXE. By knowing the resource identifier,
you can use the LoadString Windows API function to read these values into
your Visual Basic program. For the registered owner, the resource
identifier is 514, and for the registered organization, the resource
identifier is 515.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example shows you how to implement this into your Visual
Basic program.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following lines to the general declarations section of Form1:
<P>
<PRE>   ' Enter each of the following Declare statements as one, single line:
   Declare Function GetModuleHandle Lib "Kernel" (ByVal Module As String)
      As Integer
   Declare Function LoadString Lib "User" (ByVal hInst As Integer,
      ByVal wID As Integer, ByVal buf As Any, ByVal size As Integer)
      As Integer

</PRE><P><LI>Add a command button (Command1) to the form, and place the following
   code in the click event:
<P>
<PRE>   Sub Command1_Click ()
      Dim hInst As Integer
      Dim user As String, organization As String, title As String
      Dim length As Integer

      hInst = GetModuleHandle("user.exe")

      ' Get user name:
      user = Space$(256)
      length = LoadString(hInst, 514, user, Len(user))
      user = Left$(user, length)

      ' Get organization:
      organization = Space$(256)
      length = LoadString(hInst, 515, organization, Len(organization))
      organization = Left$(organization, length)

      title = "This copy of Windows Registered to:"
      MsgBox user &amp; Chr(13) &amp; Chr(10) &amp; organization, , title

   End Sub

</PRE><P><LI>Press the F5 key to run the program. When you click the command button,
   the registered user and organization should be displayed in the message
   box.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
The information in this article came from a companion application for
"Windows Questions and Answers" by Matt Pietrek ("Microsoft Systems
Journal," Vol. 8, No. 10). It is also located on the Microsoft Developers
Network (MSDN) CD number 6.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 MSJ CodeSampleMSDN<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
