

<HTML>
<HEAD>
<TITLE>BUG: Setup Wizard Closes With Error: Invalid Property Value... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170372">
<META NAME="KBModify" CONTENT="1997/06/19">
<META NAME="KBCreate" CONTENT="1997/06/19">
<META NAME="Keywords" CONTENT="kberrmsg kbtool TlsSetWiz vb4all vb4win vb5all VBKBToolkit">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When starting the Microsoft Visual Basic Application Setup Wizard, a dialog appears with the error:      Invalid property value, an unexpected error has occurred   If you click the OK button, the Setup Wizard terminates.  CAUSE =====  When the Setu...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDKO,QDKN,QDKM,QDKL,QDKJ,QDKI,QDKH,QBS0,QAAP,QDI2,QAB5,QAB4,QDIZ,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Setup Wizard Closes With Error: Invalid Property Value...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170372</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Professional, and Enterprise
   Editions for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When starting the Microsoft Visual Basic Application Setup Wizard, a dialog
appears with the error:
<P>
<PRE>   "Invalid property value, an unexpected error has occurred"

</PRE>If you click the OK button, the Setup Wizard terminates.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the Setup Wizard begins, a system configuration file is read. If the
devices listed in the configuration file cannot be located, the error
occurs and the Setup Wizard terminates.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two methods to resolve this error:

<OL><P><LI>Reinstall the unlocated device(s).
<P>
</OL>-or-
<P>

<OL><P><LI>Comment the appropriate line in the configuration file.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When Microsoft Visual Basic is installed, a system configuration file is
created. This configuration file includes information about devices
installed on the computer at the time of installation.
<P>
In Microsoft Visual Basic Version 4.0 there may be three configuration
files. The original configuration files are:

<UL><LI>16 bit: &lt;VB directory&gt;\SETUPKIT\KITFIL16\SW16TMPL.INI

<LI>32 bit: &lt;VB directory&gt;\SETUPKIT\KITFIL32\SW32TMPL.INI
<P>
</UL>If the Setup Wizard has been used once successfully, an additional
configuration file is created for all future uses:
<P>
<PRE>   &lt;Windows directory&gt;\SWDEPEND.INI

</PRE></OL>In Microsoft Visual Basic Version 5.0, the configuration file is:
<P>
<P>
<PRE>   &lt;VB directory&gt;\SETUPKIT\KITFIL32\VB5DEP.INI

</PRE>The following is a sample of a VB5DEP.INI (other files similar):
<P>
<PRE>   [SetupWiz]
   Uses1=D:\DStudio\VB5\setupkit\kitfil32\VB5StKit.dll
   Drive1=1.44 MB,1457664,512
   Drive2=2.88 MB,2915328,1024
   Drive3=1.2 MB,1213952,512
   Drive4=720 KB,730112,1024
   Drive5=360 KB,362496,1024
   BootStrap=D:\DStudio\VB5\SETUPKIT\KITFIL32\SETUP.EXE
   VBExe=D:\DStudio\VB5\VB5.EXE
   RemoveInstallEXE=D:\DStudio\VB5\SETUPKIT\KITFIL32\ST5UNST.EXE

</PRE>The Application Setup Wizard reads this configuration file during
initialization. If devices described in the log file are not found on the
system, the error occurs and the Setup Wizard terminates.
<P>
In the sample above, Drive1 is a 1.44MB floppy drive. If this device was
removed from the system (and not replaced with a similar device), the Setup
Wizard would be unable to find the device and the error would occur. This
situation typically occurs with computers that have removable disk drives.
<P>
The error can be corrected by either of two methods:

<OL><P><LI>Reinstall the missing device.
<P>
</OL>-or-

<OL><P><LI>Comment the line in the configuration file by adding a semicolon (;) at
   the beginning of the line.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbtool TlsSetWiz vb4all vb4win vb5all VBKBToolkit<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
