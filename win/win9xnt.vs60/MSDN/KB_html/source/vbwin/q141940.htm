

<HTML>
<HEAD>
<TITLE>List Boxes Can Shrink When a Form Is Saved in Text Format </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141940">
<META NAME="KBModify" CONTENT="1996/01/05">
<META NAME="KBCreate" CONTENT="1996/01/02">
<META NAME="Keywords" CONTENT="kbfixlist kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Every time a project is run, a list box appears with a smaller height than when the form was previously saved. The behavior seems to depend on whether the form was saved in text format or binary, and the font used in the list box. The list box does...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAUR,QAU7,QADF,QBS0,QATX,QAMB,QAH4,QAKJ,QDNG,QAO4,QAKP,QBWS,QBTI,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>List Boxes Can Shrink When a Form Is Saved in Text Format</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141940</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic,
<PRE>  16-bit only, for Windows, version 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Every time a project is run, a list box appears with a smaller height than
when the form was previously saved. The behavior seems to depend on whether
the form was saved in text format or binary, and the font used in the list
box. The list box does not grow any smaller once an executable is made.
<P>
The same problem described above can also occur for a file list box.
<P>
<P><h2>STATUS</h2>
 
<P>
This problem was fixed in both 16- and 32-bit versions of Visual Basic 4.0
(where all forms are saved only in a text format).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The problem described above occurs under certain circumstances. First, the
height of the list box shrinks after the form has been saved in text
format. (To save a form in text format, highlight the form in the project
window and on the File menu, click Save File As, with the Save As Text
check box selected.) If the form is saved consistently in the Binary
format, then the problem is not reproducible.
<P>
Secondly, the problem seems to only occur for certain fonts in the list
box. MS Sans Serif and Truetype fonts such as Arial are font choices where
the problem does not occur. Small Fonts and Courier are examples of fonts
in the list box where the problem does occur.
<P>
<P><h2>Workaround</h2>
 
<P>
The following are three possible workarounds:

<UL><LI>Explicitly set the height of the list box in the Load event of the
   form. This will always override whatever height is specified in the
   property window at design time.
<P>
   For example, in the Form_Load event, place the following line of code:
<P>
<P><PRE>      List1.Height = 3860  'Scalemode of the form is set for Twips
</PRE><P>
   -or-

<LI>Consistently save the form in binary format. The problem only appears
   when the program is run after saving the form in text format.
<P>
   -or-

<LI>Choose a font for the list box where the problem is not reproducible,
   such as MS Sans Serif.
<P>
</UL><h3>Steps to Reproduce the Problem</h3>
 

<OL><P><LI>Start a new Visual Basic project. Form1 appears by default.

<P><LI>Place a list box on the form (it will be called List1 by default) and
   set the height property of the list box to 6630 twips (or a suitable
   high value).

<P><LI>In the property window, set the FontName for the list box to Small
   Fonts. Also, type in a size of 24 for the font (the problem occurs for
   all sizes of the font, but is most easily seen for larger sizes).

<P><LI>In the Activate event for the form, place the following line of code:
<P>
<P><PRE>      Debug.Print List1.Height
</PRE>
<P><LI>Run the program by pressing the F5 key. Notice that the Debug window
   correctly shows the original height of the list box. Stop the program.

<P><LI>Save Form1 in a text format, that is, on the File menu, click Save File
   As, and check the Save As Text check box.

<P><LI>Run the program by pressing the F5 key. Notice that the debug window
   still shows the original height of the list box. Stop the program.

<P><LI>Save Form1 once again in text format--when Visual Basic asks if you
   want to replace Form1, click Yes.

<P><LI>Run the program again. Now the Debug window shows that the list box
   height has decreased to 6030 twips.
<P>
</OL>After each successive save of the form in text format, the list box height
will decrease every time the project is run. However, the problem only
surfaces after the second save of the form in text format.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 4.00<BR>
KBCategory: kbfixlist kbusage<BR>
KBSubcategory: prgctrlsstd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
