

<HTML>
<HEAD>
<TITLE>VB3 How to Scroll an Embedded Word 6 Document in VB OLE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118646">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1994/07/26">
<META NAME="Keywords" CONTENT="kbole kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Word for Windows version 6.0 does not supply scroll bars that would allow an activated document embedded in the Visual Basic 3.0 OLE container control to be scrolled through. This article describes how to provide buttons that allow the user to scro...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAPN,QA7O,QAOE,QAMN,QAB5,QBS0,QAW6,QADO,QA9Q,QBLP,QBXQ,QA5F,QAMA,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 How to Scroll an Embedded Word 6 Document in VB OLE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118646</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
<LI>Microsoft Word for Windows, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Word for Windows version 6.0 does not supply scroll bars that would allow
an activated document embedded in the Visual Basic 3.0 OLE container
control to be scrolled through. This article describes how to provide
buttons that allow the user to scroll through an embedded Word for Windows
version 6.0 document that has been activated for visual editing.
<P>
To scroll through the window, you must call a Word Basic method such as
VLine. However, if you call the method from within a scroll-bar event, the
code does not work. The problem is that when the scroll bar receives the
focus, the Word document object in the OLE control is deactivated. If you
try to activate the Word Document object in the scroll-bar event, the
insertion point moves to the beginning of the document, causing you to lose
the current position in the document. This problem happens with any control
that can receive the focus.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To work around the problem, use a control that cannot receive the focus
(for example, the image-control or the spin button). You can use the image
control to simulate a button. When you click it, the focus remains on the
OLE container control, and therefore the Word document object stays
activated. This allows you to call a Word Basic method such as VLine to
allow you to scroll through the window in the click event of the image
control.
<P>
<P><h3>Example</h3>
 

<OL><P><LI>Start Visual Basic; Form1 is created by default.

<P><LI>Add an OLE container control to Form1 (Ole1 is the default name for the
   control).

<P><LI>The insert object dialog box should appear after you draw the OLE
   container control on the form. Choose Create from the File option, and
   choose an existing Word .DOC file that is more than a page in length.
   The "Link" and "Display As Icon" check boxes should not be checked.
   Choose the "OK" button when you are done; the document should now be
   embedded in the OLE container control.

<P><LI>Add a spin button to Form1 (Spin1 is the default name of the control).

<P><LI>Place the following code in the spin-down event:
<P>
<PRE>      Sub Spin1_SpinDown ()
         If Ole1.AppIsRunning Then
            Ole1.Object.Application.WordBasic.VLine 1
         Else
            Ole1.Action = 7 'Activate
         End If
      End Sub

</PRE><P><LI>Place the following code in the spin-up event.
<P>
<PRE>      Sub Spin1_SpinUp ()
         If Ole1.AppIsRunning Then
            Ole1.Object.Application.WordBasic.VLine -1
         Else
            Ole1.Action = 7 'Activate
         End If
      End Sub

</PRE><P><LI>Save the project.

<P><LI>Run the application.

<P><LI>Double-click the OLE control to activate the Word .DOC object for visual
   editing.
<P>
</OL>10.Press the spin button to scroll up and down the document.
<P>
<P><h3>Notes</h3>
 

<UL><LI>You can speed up the scrolling by changing the delay property on the
   spin button. You can also change the number of lines that the VLine
   method scrolls through.

<LI>Some other controls that do not receive the focus are the shape, line,
   frame, 3D frame, 3D panel, and label controls.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbole kbprg kbcode<BR>
KBSubcategory: IAPOLE<BR>
Additional reference words: 3.00 scrollbar
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
