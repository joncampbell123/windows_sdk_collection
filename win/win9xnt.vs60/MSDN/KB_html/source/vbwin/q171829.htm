

<HTML>
<HEAD>
<TITLE>FIX: GetChunk Freezes Unless Other Events Happening </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171829">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/07/23">
<META NAME="Keywords" CONTENT="vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The GetChunk operation pauses unless other events are happening. Other events could include moving the mouse, which would trigger the GetChunk to continue.  STATUS ======  Microsoft has confirmed this to be a bug in the Microsoft products listed at...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDO3,QAR4,QAM1,QA56,QA55,QAH4,QACI,QAVX,QAPN,QATK,QAO4,QANJ,QAHT,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: GetChunk Freezes Unless Other Events Happening</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171829</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
   on the following platform: Alpha
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The GetChunk operation pauses unless other events are happening. Other
events could include moving the mouse, which would trigger the GetChunk to
continue.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 2, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Run Visual Basic or, if Visual Basic is already running, choose New
   Project from the File menu (ALT, F, N). Form1 is created by default.
   Add the following code to the General Declarations of Form1:
<P>
<P><PRE>      Option Explicit
      Private bwait As Boolean
</PRE>
<P><LI>Place an Internet Transfer Control (Inet1) on Form1, and add the
   following code:
<P>
<P><PRE>      Private Sub Inet1_StateChanged(ByVal State As Integer)
<PRE></PRE>        Dim s$, t$
        Debug.Print "StateChanged:", State
        If State = icResponseCompleted Then
           t$ = ""
           s$ = Inet1.GetChunk(1024)
           DoEvents
           While Len(s$) &lt;&gt; 0
               t$ = t$ &amp; s$
               s$ = Inet1.GetChunk(1024)
               DoEvents: DoEvents: DoEvents
               Debug.Print ".";
           Wend
           Debug.Print
           Debug.Print Left$(t$, 20), Len(t$)
           bwait = True
        End If
      End Sub

</PRE><P><LI>Place a CommandButton (Command1) on Form1, and add the following code:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         Dim i As Integer
         Dim tmp As Single

         For i = 1 To 5
          tmp = Timer
          While tmp + 1 &gt; Timer
               DoEvents: DoEvents: DoEvents
          Wend
          bwait = False
          Inet1.Execute "<B>http://msw</B>"
          While Not (bwait)
           DoEvents
          Wend
         Next
      End Sub

</PRE><P><LI>Press the F5 key to run it, and then press the ENTER key to invoke the
   command_click. (NOTE: Do not move the mouse or touch the keyboard.)

<P><LI>Watch your debug window. The first time you access the page, it works.
   However, the second time, you need to pause. Press Ctrl-break quickly
   and you are at the Doevents statement following the GetChunk. If you
   move the mouse, the GetChunk will continue.
</OL> 
<PRE>Keywords          : vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2
Technology        : kbInetDev
Version           : WINDOWS:5.0
Platform          : NT WINDOWS
Hardware          : ALPHA
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
