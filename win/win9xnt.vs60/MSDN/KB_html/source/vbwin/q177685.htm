

<HTML>
<HEAD>
<TITLE>HOWTO: Handle Missing DataPoints with MSChart </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177685">
<META NAME="KBModify" CONTENT="1997/12/05">
<META NAME="KBCreate" CONTENT="1997/12/04">
<META NAME="Keywords" CONTENT="vb5all vb5howto VBKBAX VBKBComp VBKBCtrl">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The last argument of the SetData method determines if the data point is a null value. When this flag is True, the data point is null and the value is omitted from the chart. It is often desirable that a data point is omitted rather than treated as ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANO,QBC9,QBC8,QAII,QAYY,QAKD,QA5V,QAPN,QA4Q,QBS0,QAE1,QAML,QAIJ,QDH6,QANA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Handle Missing DataPoints with MSChart</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177685</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The last argument of the SetData method determines if the data point is a
null value. When this flag is True, the data point is null and the value is
omitted from the chart. It is often desirable that a data point is omitted
rather than treated as zero. This article illustrates how to use the MS
Chart control to create data points that are omitted, or missing, from the
plot.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The SetData method has four arguments:

<UL><LI>Row - an integer that identifies the row containing the data point
   value.

<LI>Column - an integer that identifies the column containing the data point
   value.

<LI>DataPoint - a double that is the data point value.

<LI>NullFlag - an integer flag that indicates if the data point value is a
   null value.
<P>
</UL>The last argument determines if the data point is displayed on the chart.
If the NullFlag is true, the data point is a null value and the data point
is omitted from the chart. If the NullFlag is set to False or is omitted,
the data point is displayed as a zero value.
<P>
The next section illustrates how you can create a sample project that uses
MS Chart to plot missing data points.
<P>
<P><h3>Steps to Create Sample Project</h3>
 

<OL><P><LI>Start a new Standard EXE project in Visual Basic. Form1 is created by
   default.

<P><LI>Add a CommandButton, Check box, and an MS Chart Control to Form1.

<P><LI>Copy the following code to the Code window of Form1:
<P>
<PRE>        Option Explicit
        Option Base 1
        Dim vArray(2, 6) As Variant

        Private Sub Form_Load()
           Dim i, j
           For i = 1 To 2
            For j = 1 To 6
                vArray(i, j) = Int((Rnd(10) + Rnd(10) * 10) * 10)
            Next j
           Next i

          Command1.Caption = "SetData Method"
          Check1.Caption = "Null Data Point"
          Check1.Value = vbChecked
        End Sub

        Private Sub Command1_Click()
            Dim intCount As Integer, dataflag As Boolean
            Dim column As Integer, row As Integer, anumber As Variant

            If Check1.Value = vbChecked Then
                vArray(1, 4) = vbNull
            Else
                vArray(1, 4) = 0
            End If

            With MSChart1
             .chartType = VtChChartType2dLine
             .ColumnCount = 2
             .RowCount = 6

               For column = 1 To .ColumnCount
                  For row = 1 To .RowCount
                  If (vArray(column, row)) &lt;&gt; vbNull Then
                     dataflag = False
                  Else
                     dataflag = True
                  End If
                  .DataGrid.SetData row, column, _
                                    vArray(column, row), _
                                    dataflag
                  Next row
               Next column

               With .DataGrid
                .ColumnLabelCount = 1
                .ColumnLabel(1, 1) = "abc"
                .ColumnLabel(2, 1) = "xyz"
                .RowLabelCount = 1
                .RowLabel(1, 1) = "Jan"
                .RowLabel(2, 1) = "Feb"
                .RowLabel(3, 1) = "Mar"
                .RowLabel(4, 1) = "Apr"
                .RowLabel(5, 1) = "May"
                .RowLabel(6, 1) = "Jun"
               End With

             .ShowLegend = True
            End With
        End Sub

</PRE><P><LI>Click Start on the Run menu, or press the F5 key to start the program.
   Click SetData Method to display a chart with a missing data point.
   Uncheck the Null Data Point check box and click SetData Method to
   display the chart without a Null data point (the data point is zero).
<P>
 (c) Microsoft Corporation 1997, All Rights Reserved. Contributions by
</OL>Arsenio Locsin, Microsoft Corporation
 
<PRE>Keywords          : vb5all vb5howto VBKBAX VBKBComp VBKBCtrl
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
