

<HTML>
<HEAD>
<TITLE>FIX: IPF Opening or Saving Form with Tab Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171816">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/07/23">
<META NAME="Keywords" CONTENT="vb5all VBKBAX VBKBComp VBKBCtrl VBKBSSTab VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Attempting to open or save a form containing an SSTab control may cause Visual Basic to terminate with one of the following errors:     “VB5 caused an invalid page fault in module TABCTL32.OCX at     0137:212fef0b”   -or-     “VB5 caused an invalid...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAUR,QDO3,QA56,QA55,QA7O,QAB5,QAR4,QAOE,QAMN,QAM1,QA5F,QAMA,QAU7,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: IPF Opening or Saving Form with Tab Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171816</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise
   Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Attempting to open or save a form containing an SSTab control may cause
Visual Basic to terminate with one of the following errors:
<P>
<PRE>   “VB5 caused an invalid page fault in module TABCTL32.OCX at
    0137:212fef0b”

 -or-

   “VB5 caused an invalid page fault in module OLEAUT32.DLL at
   0137:653468ec”

 -or-

   “VB5.exe Exception: Access violation (if using Windows NT)”

</PRE><h2>CAUSE</h2>
 
<P>
This problem can occur if the form (.frm file) contains incorrect
information for the SSTab's child controls. This problem should only occur
when the .frm file has been incorrectly edited outside of Visual Basic
(such as with a text editor), or if the .frm file is otherwise corrupt.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 2, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new "Standard EXE" project in Visual Basic 5.0.

<P><LI>Choose Components from the Project menu and select "Microsoft
   Tabbed Dialog Control 5.0."

<P><LI>Place an SSTab control on Form1.

<P><LI>Add two TextBox controls (Text1, Text2) to Tab 0.

<P><LI>Add two TextBox controls (Text3, Text4) to Tab 1.

<P><LI>Save the project (Form1.frm and Project1.vbp).

<P><LI>Exit Visual Basic.

<P><LI>Start Notepad and open Form1.frm.

<P><LI>Delete the following lines from Form1.frm:
<P>
<PRE>      Tab(0).Control(1)=   "Text2"
      Tab(0).Control(1).Enabled=   0   'False
      ...
      Tab(1).Control(1)=   "Text4"
      Tab(1).Control(1).Enabled=   0   'False
      ...
      Begin VB.TextBox Text4
         Height          =   495
         Left            =   840
         TabIndex        =   4
         Text            =   "Text4"
         Top             =   1200
         Width           =   2775
      End
      ...
      Begin VB.TextBox Text2
         Height          =   495
         Left            =   -74160
         TabIndex        =   2
         Text            =   "Text2"
         Top             =   1200
         Width           =   2055

      End

</PRE><P><LI>Save Form1.frm and close Notepad.

<P><LI>Restart Visual Basic and open Project1.vbp. Note that an error occurs.
<P>
</OL>These steps will also reproduce the problem if you create the original
project in Visual Basic 4.0, edit the .frm file, then open the project in
Visual Basic 5.0. In this case, the problem will occur when attempting to
save the form.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: crash gpf<BR>
Keywords          : vb5all VBKBAX VBKBComp VBKBCtrl VBKBSSTab VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2<BR>
Version           : 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbservicepack<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
