

<HTML>
<HEAD>
<TITLE>BUG: "What's This?" Button Disappears from MDI Child Forms </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173638">
<META NAME="KBModify" CONTENT="1997/09/25">
<META NAME="KBCreate" CONTENT="1997/09/09">
<META NAME="Keywords" CONTENT="vb5all VBKBObj VBKBVB">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Setting both the WhatsThisButton property and the WhatsThisHelp property of an MDI child form to True does not enable the What's This button to appear in the title bar of the form.  RESOLUTION  According to the Help for Visual Basic 5.0, the What's...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTM,QAPN,QBS0,QBXS,QABA,QBE7,QBE6,QAH4,QA5D,QAY5,QAM1,QAIJ,QABB,QANS,QAJD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: "What's This?" Button Disappears from MDI Child Forms</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173638</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Setting both the WhatsThisButton property and the WhatsThisHelp property of
an MDI child form to True does not enable the What's This button to appear
in the title bar of the form.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
According to the Help for Visual Basic 5.0, the What's This? button will
appear in the title bar of a form when the WhatsThisHelp property and the
WhatsThisButton property are both set to True and the following properties
are also set as shown:
<P>
<PRE>   ControlBox = True

   MinButton = False and/or MaxButton = False
   BorderStyle = 1 - Fixed Single or BorderStyle = 2 - Sizable
      Or
   BorderStyle = 3 - Fixed Dialog

</PRE>However, the What's This? button fails to appear in the title bar of an MDI
child form even when the conditions above are met.
<P>
To work around this problem, you can use the Windows SetParent API to make
one form the child of another and create the illusion of an MDI form in
which the What's This button is functional.
<P>
<P><h3>Step-by-Step Instructions</h3>
 

<OL><P><LI>Start a new Standard EXE project. Form1 is added by default.

<P><LI>Add another form (Form2) to the project.

<P><LI>Set the following properties of Form2:
<P>
<P><PRE>      MaxButton = False
      MinButton = False
      WhatsThisButton = True
      WhatsThisHelp = True
</PRE>
<P><LI>Insert the following code to Form1's General Declarations section:
<P>
<P><PRE>      Private Declare Function SetParent Lib "user32" _
      (ByVal hWndChild As Long, ByVal hWndNewParent As Long) As Long
</PRE><P>
<P><PRE>      Private Declare Function GetWindowLong Lib "user32" _
      Alias "GetWindowLongA" _
      (ByVal hwnd As Long, ByVal nIndex As Long) As Long
      Private Declare Function SetWindowLong Lib "user32" _
      Alias "SetWindowLongA" _
      (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) _
      As Long
</PRE><P>
<P><PRE>      Const WS_CHILDWINDOW = &amp;H40000000
      Const GWL_STYLE = (-16)
</PRE>
<P><LI>Insert the following code to Form1's Load event procedure:
<P>
<P><PRE>      Private Sub Form_Load()
<PRE></PRE>         Dim x As Long
         Dim y As Long
         'Set Form1 as the parent of form2
         x = SetParent(Form2.hwnd, Form1.hwnd)
         Form2.Show
      
         x = GetWindowLong(Form2.hwnd, GWL_STYLE)
         y = x + WS_CHILDWINDOW
         x = SetWindowLong(Form2.hwnd, GWL_STYLE, y)
      End Sub

</PRE><P><LI>Press the F5 key to run the program. You will see Form2 acting as
   Form1's child with a What's This? Button on its toolbar.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new Standard EXE project. Form1 is added by default.

<P><LI>Add a MDI form (MDIForm1) to the project.

<P><LI>Set the following properties of Form1:
<P>
<P><PRE>      MaxButton = False
      MDIChild = True
      MinButton = False
      WhatsThisButton = True
      WhatsThisHelp = True
</PRE>
<P><LI>Press the F5 key to run the project. The What's This ('?') button
   disappears from Form1's title bar.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: vb5<BR>
Keywords          : vb5all VBKBObj VBKBVB<BR>
Version           : WINDOWS:5.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
