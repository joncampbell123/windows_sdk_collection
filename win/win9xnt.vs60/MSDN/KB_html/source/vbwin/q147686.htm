

<HTML>
<HEAD>
<TITLE>How to Get Current Drive's Free Disk Space in VB 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147686">
<META NAME="KBModify" CONTENT="1997/05/09">
<META NAME="KBCreate" CONTENT="1996/02/28">
<META NAME="Keywords" CONTENT="APrgOther vb4all vb4win">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows how to find out how much free disk space is available on the current drive by calling the DiskSpaceFree function found in STKIT416.DLL for Win16 or STKIT432.DLL for Win32. Both dynamic-link libraries (DLLs) ship with the Setup ki...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW5,QBS0,QAY5,QAPN,QAB9,QBV8,QBFY,QANF,QAH4,QAC9,QBWS,QAWH,QAMN,QAIJ,QACJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Get Current Drive's Free Disk Space in VB 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147686</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows how to find out how much free disk space is available on
the current drive by calling the DiskSpaceFree function found in
STKIT416.DLL for Win16 or STKIT432.DLL for Win32. Both dynamic-link
libraries (DLLs) ship with the Setup kit in Microsoft Visual Basic version
4.0 for Windows. The DiskSpaceFree function is useful for finding the free
space available on a drive. If you use the DiskSpaceFree function in your
Visual Basic program, you need to distribute STKIT416.DLL or STKIT432.DLL
to your customers.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There is also a function in the Win32 API (Application Programmers
Interface) called GetDiskFreeSpace provided by the Win32 operating system
that retrieves information about a specified disk, including the amount of
free space on the disk. Refer to Method II in the example below. There are
also other functions in the STKIT416.DLL or STKIT432.DLL that may be
useful. You can use the AllocUnit function to get the disk allocation unit
for the current drive, and use the SetTime function to set the destination
file's date and time to the source file's date and time.
<P>
Examples of using these SETUPKIT functions are also included in the
\VB\SETUPKIT\SETUP1\SETUP1.VBP project which is part of the SetupWizard.
<P>
<P><h3>Steps to Finding Out How Much Free Space Is Available on Drive C</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add two Label controls (Label1 and Label2) and one Command button
   (Command1) to Form1.

<P><LI>Using the following table as a guide, set the properties of the controls
   you added in step 2.
<P>
<PRE>   Control Name   Property       New Value
</PRE></OL> 
<P>
<PRE>   Command1       Caption        Press for Free Space on Drive C
   Label1         AutoSize       True
   Label2         AutoSize       True

</PRE><P><LI>Place the following code in the general declarations section of
   Form1:
<P>
<P><PRE>      #If Win32 Then
      Private Declare Function DiskSpaceFree Lib "STKIT432.DLL" Alias _
      "DISKSPACEFREE" () As Long
      Private Declare Function GetDiskFreeSpace Lib "kernel32" Alias _
      "GetDiskFreeSpaceA" ( ByVal lpRootPathName As String, _
      lpSectorsPerCluster As Long, lpBytesPerSector As Long, _
      lpNumberOfFreeClusters As Long, lpTotalNumberOfClusters As Long) _
      As Long
      #Else
      Private Declare Function DiskSpaceFree Lib "STKIT416.DLL" () As Long
      #End If
</PRE>
<P><LI>Place the following code in the Command1 Click event procedure of Form1:
<P>
<P><PRE>      Private Sub Command1_Click()
      Dim free_Space As Long
      ChDrive "C:"
      ' Method I (using the Win16 API).
      free_Space = DiskSpaceFree()
      Label1.Caption = "(Method I: ) The total free space on Drive C: = " _
      &amp; Str$(free_Space) &amp; " bytes"
      ' Method II (using the Win32 API).
      #If Win32 Then
      Dim numSectorsPerCluster As Long
      Dim numBytesPerSector As Long
      Dim numFreeClusters As Long
      Dim numTotalClusters As Long
      Dim success As Boolean
      success = GetDiskFreeSpace("C:\", numSectorsPerCluster, _
      numBytesPerSector,  numFreeClusters, numTotalClusters)
      free_Space = numSectorsPerCluster * numBytesPerSector * _
      numFreeClusters
      Label2.Caption = _
      "(Method II:) The total free space on Drive C: = " &amp; _
      Str$(free_Space) &amp; " bytes"
      #Else
      Label2.Caption = "Use Method I for Win16 applications"
      #End If
      End Sub
</PRE>
<P><LI>From the Run menu, click Start (ALT, R, S), or press the F5 key to run
   the program. Click the Command1 button to view the free disk space on
   drive C.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : APrgOther vb4all vb4win<BR>
Version             : 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
