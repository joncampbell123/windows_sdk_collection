

<HTML>
<HEAD>
<TITLE>FIX: Public Properties of VB4 Class Are Passed by Reference </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166928">
<META NAME="KBModify" CONTENT="1997/08/22">
<META NAME="KBCreate" CONTENT="1997/04/15">
<META NAME="Keywords" CONTENT="VB4WIN vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you have a Visual Basic 4.0 class with a public property implemented like the following:    Public MyProp As Integer  Visual Basic 4.0 passes the property by reference (ByRef).  However, if your property is implemented in Visual Basic 4.0 using ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAH4,QAMA,QA4Q,QAFF,QA5F,QAH7,QAH6,QAD7,QAE5,QA0K,QAR4,QANF,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Public Properties of VB4 Class Are Passed by Reference</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166928</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional,
   and Enterprise Editions for Windows, version 5.0
<LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you have a Visual Basic 4.0 class with a public property implemented
like the following:
<P>
<PRE>  Public MyProp As Integer

</PRE>Visual Basic 4.0 passes the property by reference (ByRef).
<P>
However, if your property is implemented in Visual Basic 4.0 using property
procedures (Property Get, Property Let, Property Set), it will be passed by
value (ByVal).
<P>
<P><h2>STATUS</h2>
 
<P>
This problem has been fixed in Visual Basic 5.0. All properties are now
passed by value (ByVal) for consistency.
<P>
In addition, all code internal to the class still has direct access to
member variable data:
<P>
<PRE>  MyClass.CLS
  ===========
  Public MyProp As Integer

  Public Sub MyMethod()
    MyProp = 5  '// This has direct access to the class data
  End Sub
  ===========

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Microsoft has acknowledged that this change in behavior may be an issue for
some developers porting Visual Basic 4.0 code to Visual Basic 5.0. Code
that relies on the ByRef functionality stated above will need to be
modified.
<P>
One possible way to modify the Visual Basic 4.0 for porting to Visual Basic
5.0 is shown below:
<P>
Original Visual Basic 4.0 code:
<P>
<PRE>   MyClass.CLS
   ===========
   Public MyProp As Integer
   ===========

   MyBas.BAS
   =========
   Sub Compute(ByRef iTarget As Integer)
     Dim iTemp as Integer
     '// implementation code
     iTarget = iTemp
   End Sub

   Sub Main()
     Dim MyObject As MyClass
     MyObject.MyProp = 97
     Call Compute(MyObject.MyProp)
   End Sub
   =========

</PRE>Modified Sub Main() for Visual Basic 5.0:
<P>
<PRE>   Sub Main()
     Dim MyObject As MyClass
     Dim iTtemp1 As Integer
     Dim iTemp2 As Integer
     MyObject.MyProp = 97
     iTemp1 = MyObject.MyProp
     iTemp2 = iTemp1
     Call Compute(iTemp2)
     If iTemp1 &lt;&gt; iTemp2 Then
       MyObject.MyProp = iTemp2
       iTemp1 = iTemp2
     End If
   End Sub

</PRE>Exposing public variables is not a recommended programming technique. The
following demonstrates possible modifications to MyClass.CLS, illustrating
a data-hiding technique to preserve class member data:
<P>
<PRE>   MyClass.CLS
   ===========
   Private m_MyProp As Integer

   Public Property Let MyProp(NewValue As Integer)
     '// implement validation code and data formatting
     m_MyProp = NewValue
   End Property

   Public Property Get MyProp() As Integer
     MyProp = m_MyProp
   End Property
   ===========
</PRE> 
<PRE>Keywords          : VB4WIN vb5all
Version           : 4.0 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
