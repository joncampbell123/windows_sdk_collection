

<HTML>
<HEAD>
<TITLE>FIX: OLE Client: Copying Linked Object Gives Err: Can't Paste </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97619 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/04/15">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you use the OLE client control to paste a linked OLE object onto the clipboard and then later copy the same OLE object from the clipboard back to the OLE client control, you may see this error message:     Can't Paste  This occurs whether the li...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QBPG,QAW6,QA9Q,QA9N,QBJZ,QBVP,QA5B,QAY2,QANH,QAMN,QBWS,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: OLE Client: Copying Linked Object Gives Err: Can't Paste</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97619 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 2.00
WINDOWS
kbole kbbuglist
<P>
 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 2.0
</PRE>- Microsoft Professional Toolkit  for Visual Basic programming
<PRE>  system for Windows, version 1.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use the OLE client control to paste a linked OLE object onto the
clipboard and then later copy the same OLE object from the clipboard
back to the OLE client control, you may see this error message:
<P>
<PRE>   Can't Paste

</PRE>This occurs whether the linked OLE object is created from an existing
file (OleClient1.Action =  1) or from an OLE object on the clipboard
(OleClient1.Action = 4). This problem occurs only with a linked object,
not with an embedded object.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in both the Standard and
Professional Editions of Microsoft Visual Basic version 2.0 for Windows
and in the Microsoft Professional Toolkit for Visual Basic programming
system version 1.0 for Windows. This bug was corrected in Visual Basic
version 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example uses Microsoft Excel version 4.0 as the application
associated with the OLE object, however the bug does not depend on Excel;
it occurs no matter which application is associated with the OLE object.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Microsoft Excel. The Sheet1 worksheet is created by default.

<P><LI>In the R1C1 cell, enter Fixed Assets.

<P><LI>From the Edit menu, choose Copy (ALT+E+C).

<P><LI>Start Visual Basic or from the File menu, choose New Project (ALT+F+N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>From the File menu, choose Add File. In the Files box, select the
   OLECLIEN.VBX custom control file. The OLE client tool appears in the
   Toolbox.

<P><LI>Add an OLE client control (OleClient1) to Form1.

<P><LI>Add a command button (Command1) to Form1.

<P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Sub Command1_Click ()
      Const OLE_LINKED = 0
      Const OLE_COPY = 4
      Const OLE_PASTE = 5
      Const OLE_UPDATE = 6
      Const OLE_DELETE = 10

      If OleClient1.PasteOK Then
         OleClient1.Protocol = "StdFileEditing"
         OleClient1.ServerType = OLE_LINKED
         OleClient1.Action = OLE_PASTE  ' Get object from clipboard
         OleClient1.Action = OLE_COPY   ' Copy the object back onto the
                                        ' clipboard
         OleClient1.Action = OLE_UPDATE ' Display object
         OleClient1.Action = OLE_PASTE  ' Attempt to paste the
                                        ' object onto the clipboard
         OleClient1.Action = OLE_DELETE
      Else
         MsgBox "Contents of the Clipboard in unacceptable format"
      End If
   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT+R+S) to run the program.

<P><LI>Click the Command1 button. It should work, but instead the program
<P><PRE>    stops and gives the "Can't paste" error message. The Excel object is
    successfully linked to OleClient1 and displayed, and the linked object
    is also copied successfully onto the clipboard.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00 errmsg buglist1.00 buglist2.00<BR>
fixlist3.00<BR>
KBCategory: kbole kbbuglist<BR>
KBSubcategory: IAPOLE<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
