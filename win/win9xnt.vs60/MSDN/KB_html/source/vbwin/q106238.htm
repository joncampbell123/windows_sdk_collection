

<HTML>
<HEAD>
<TITLE>How to Copy and Paste DDE Links Using CF_LINK in Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106238">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/11/03">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Visual Basic programs can provide an Edit Copy command that puts text onto the Clipboard along with the information needed to make a DDE link to that text. Likewise, you can provide an Edit Paste command that extracts the text and an Edit Paste Lin...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBJZ,QBS9,QANH,QA6A,QBT6,QATX,QBV4,QA9N,QAFF,QAMB,QAZ2,QAJZ,QAHP,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Copy and Paste DDE Links Using CF_LINK in Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106238</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual Basic programs can provide an Edit Copy command that puts text
onto the Clipboard along with the information needed to make a DDE link to
that text. Likewise, you can provide an Edit Paste command that extracts
the text and an Edit Paste Link command that extracts the DDE link
information, and then initiates a DDE conversation to the source text.
You can implement these clipboard operations using the GetText and SetText
format CF_LINK (&amp;HBF00) with a string of the format:
<P>
<PRE>   Application|Topic!Item

</PRE>The Visual Basic manuals and Help menu do not describe how to use the
Clipboard format CF_LINK.
<P>
NOTE: Visual Basic only supports Clipboard DDE operations for text.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When a Visual Basic DDE source program uses SetText with format CF_LINK,
the format of the string is exe|topic!item.

<UL><LI>exe is the value of App.EXEName.
<LI>topic is a form's LinkTopic value.
<LI>item is the Name of a control.
<P>
</UL>For example:
<P>
<PRE>   Project1|Form1!Text1

</PRE><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose Open Project
   (ALT, F, O) if Visual Basic is already running. Form1 is created.

<P><LI>Change the form property LinkMode to 1 - Source.

<P><LI>Place a text box named Text1 on the form.

<P><LI>From the Window menu, choose Menu Design and create the following
   menu structure.
<P>
<PRE>   Caption     Name        Indent Level
   ------------------------------------
   Edit        mEdit         0
   Copy        mCopy         1
   Paste       mPaste        1
   Paste Link  mPasteLink    1

</PRE><P><LI>Enter the following code in the general declarations section:
<P>
   Const CF_TEXT = 1
   Const CF_LINK = &amp;HBF00

<P><LI>Enter the following code into the form:
<P>
<PRE>   Sub mEdit_Click ()
      mCopy.Enabled = Text1.SelLength &gt; 0
      mPaste.Enabled = Clipboard.GetFormat(CF_TEXT)
      mPasteLink.Enabled = Clipboard.GetFormat(CF_LINK)
   End Sub

   Sub mCopy_Click ()
      Clipboard.Clear
      Clipboard.SetText Text1.SelText, CF_TEXT
      Clipboard.SetText "Project1|Form1!Text1", CF_LINK
   End Sub

   Sub mPaste_Click ()
      Text1.LinkMode = 0  ' discontinue previous link
      Text1.SelText = Clipboard.GetText(CF_TEXT)
   End Sub

   Sub mPasteLink_Click ()
      Dim topic As String  ' app|topic!item
      Dim bang As Integer  ' index of ! within topic

      topic = Clipboard.GetText(CF_LINK)
      bang = InStr(topic, "!")
      If bang &lt;&gt; 0 Then
         Text1.LinkMode = 0
         Text1.LinkTopic = Mid$(topic, 1, bang - 1)
         Text1.LinkItem = Mid$(topic, bang + 1)
         On Error Resume Next
         Text1.LinkMode = 1  ' automatic
         If Err &lt;&gt; 0 Then
            MsgBox "Cannot paste link"
         End If
      End If
   End Sub

</PRE><P><LI>From the File menu, choose Make EXE and click OK. This creates
   PROJECT1.EXE.

<P><LI>Launch PROJECT1.EXE twice so that two instances are running. Position
   them so that you can see them both at the same time. In the first
   instance, select the text in the text box, then from the Edit menu
   choose copy. Switch to the second instance and from the Edit menu
   choose Paste Link. Switch back to the first instance and change the
   contents of the text box. These changes appear immediately in the
   second instance.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: docerr 3.00<BR>
KBCategory: kbinterop kbprg kbcode<BR>
KBSubCategory: IAPDDE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
