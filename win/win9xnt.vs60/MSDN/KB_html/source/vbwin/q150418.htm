

<HTML>
<HEAD>
<TITLE>How To Create an Access Database Through Visual Basic 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150418">
<META NAME="KBModify" CONTENT="1996/09/17">
<META NAME="KBCreate" CONTENT="1996/04/29">
<META NAME="Keywords" CONTENT="kbusage kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how to create an Access database programmatically with a code example. The code is useful if you need a database with a specific number of fields and records for testing purposes.  MORE INFORMATION  An Access database called ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QDKY,QA7O,QAH4,QBS0,QA1S,QAZV,QAVX,QAVW,QA7N,QBXS,QBWS,QAOE,QANF,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Create an Access Database Through Visual Basic 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150418</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to create an Access database programmatically
with a code example. The code is useful if you need a database with a
specific number of fields and records for testing purposes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
An Access database called TEST.MDB is created when you click the command
button. In this example, the database contains 55 records with each record
containing 40 integer fields. By changing some of the code, you alter the
number of records and fields and the contents of the records.
<P>
In the Form_Load event, the code checks to see if the database exists. If
the database does not exist, a command button is shown on the form.
Clicking the command button creates the database.
<P>
<P><h3>Code Example</h3>
 

<OL><P><LI>Start Visual Basic 4.0. If it is already running, from the File menu,
   click New Project.

<P><LI>Add a command button, data control, and a DBGrid control on Form1.
   Set the DataSource property of the DBGrid control to the Data control.

<P><LI>Copy the following code sample to the Form1 code window:
<P>
<P><PRE>      Option Explicit
      Dim rs1 As Recordset
      Dim rs2 As Recordset
      Dim db As Database
      Dim td As TableDef
      Dim fl As Field
</PRE><P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         Dim iFields As Integer, iRecords As Integer

         ' Create the database.
         Set db = CreateDatabase("C:\test.mdb", dbLangGeneral)
         Set td = db.CreateTableDef("Table1")

         'Now that the database is created, add fields to the database
         For iFields = 1 To 5 'The last number can be changed.
            Set fl = td.CreateField("Field " &amp; CStr(iFields), dbInteger)
            td.Fields.Append fl
         Next iFields

         db.TableDefs.Append td

         ' Now that the database has fields, add records through a
         ' recordset.
         Set rs1 = db.OpenRecordset("Table1", dbOpenTable)
         For iRecords = 1 To 10  ' For each row
            rs1.AddNew           ' add a new record.

            For iFields = 1 To 5      ' For each field in the record
               rs1("Field " &amp; CStr(iFields)) = iFields  ' add a number.
            Next iFields

            rs1.Update
         Next iRecords

         ' Close both the recordset and database.
         rs1.Close
         db.Close

         ' Populate the DBGrid control with the contents of the Recordset.
         Set db = OpenDatabase("C:\test.mdb")
         Set rs1 = db.OpenRecordset("Select * from Table1")
         Set Data1.Recordset = rs1

         Command1.Visible = False
      End Sub

      Private Sub Form_Load()
         If Dir("C:\test.mdb") = "" Then
            Command1.Caption = "Create Database"
            Command1.Visible = True
         End If

      End Sub

</PRE><P><LI>Press the F5 key, or click Start on the Run menu to run the program.
   Click the Command button, and populate the DBGrid control. Note that
   the file TEST.MDB is also created.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbusage kbhowto kbcode<BR>
KBSubcategory: AprgDataAcc
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 17, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
