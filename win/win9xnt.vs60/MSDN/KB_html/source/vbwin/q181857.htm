

<HTML>
<HEAD>
<TITLE>PRB: RDO Run-time Error '40060': Incorrect Type for Parameter </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181857">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1998/02/27">
<META NAME="Keywords" CONTENT="VBKBRDOResultSet">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When assigning the value of a field from one Resultset to another (such as, rs2!FieldX = rs1!FieldY), you may get the following error:     Run-time error '40060'    Incorrect type for parameter  CAUSE =====  FieldY has a NULL value.  RESOLUTION  To...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAAP,QAB4,QAKD,QBWS,QBXS,QBWQ,QA5V,QAY2,QAMA,QALZ,QAKP,QAHE,QAP2,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: RDO Run-time Error '40060': Incorrect Type for Parameter</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181857</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When assigning the value of a field from one Resultset to another (such as,
rs2!FieldX = rs1!FieldY), you may get the following error:
<P>
<PRE>   Run-time error '40060'
   Incorrect type for parameter

</PRE><h2>CAUSE</h2>
 
<P>
FieldY has a NULL value.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, do one of the following:

<UL><LI>Use the following assignment expression:
<P>
<P><PRE>      rs2!FieldX = rs1!FieldY.Value
</PRE>
<LI>Assign the value of the field to a Variant variable as an intermediate
   step:
<P>
<P><PRE>      MyVariant = rs1!FieldY
      rs2!FieldX = MyVariant
</PRE><P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Use ISQL/W or another tool to create a table using the following SQL
   statement:
<P>
<P><PRE>      CREATE TABLE dbo.TestNull (
<PRE></PRE>        ID int NOT NULL ,
        F1 varchar (10) NULL ,
        CONSTRAINT PK_TestAddNew_1__15 PRIMARY KEY  CLUSTERED
          (
          ID
          )
      )

</PRE><P><LI>Add a record, leaving F1 with a NULL value. You may do this in
   ISQL/W or VISDATA in Visual Basic.

<P><LI>In Visual Basic 5.0, create a new project.

<P><LI>Reference Microsoft Remote Data Objects 2.0.

<P><LI>Add a command button (Command1) and the following code:
<P>
<P><PRE>      Private Sub Command1_Click()
      Dim cn As rdoConnection, rs1 As rdoResultset, rs2 As rdoResultset
<PRE></PRE>        rdoEngine.rdoDefaultCursorDriver = rdUseServer
        Set cn = rdoEngine(0).OpenConnection("", rdDriverNoPrompt, False, _
          "Driver={SQL Server};Server=moonbase;uid=sa;pwd=;database=pubs")
        Set rs1 = cn.OpenResultset("SELECT * FROM TestNull", _
          rdOpenKeyset, rdConcurValues, rdExecDirect)
        rs1.MoveLast
        Set rs2 = cn.OpenResultset("SELECT * FROM TestNull", _
          rdOpenKeyset, rdConcurValues, rdExecDirect)
        rs2.Edit
        rs2!F1 = rs1!F1
        rs2.Update
        rs1.Close
        rs2.Close
        cn.Close
      End Sub

</PRE><P><LI>Run the project and click the command button and the error message
   will appear.

<P><LI>Change the line:
<P>
<P><PRE>       rs2!F1 = rs1!F1
</PRE><P>
   to:
<P>
<P><PRE>       rs2!F1 = rs1!F1.Value
</PRE>
<P><LI>Run the project again, and the error will not appear.
<P>
</OL>(c) Microsoft Corporation 1998, All Rights Reserved.
Contributions by Malcolm Stewart, Microsoft Corporation
 
<PRE>Keywords          : VBKBRDOResultSet
Version           : WINNT:5.0 WIN95:5.0
Platform          : Win95 winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
