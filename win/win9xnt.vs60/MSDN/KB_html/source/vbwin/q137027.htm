

<HTML>
<HEAD>
<TITLE>BUG: ScrollBars Don't Display on DBList Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137027">
<META NAME="KBModify" CONTENT="1996/11/19">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="kbui kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Symptom 1 ---------  When binding a DBList control to a Data control whose RecordSource property is set to a Select statement with a Where clause, the ScrollBars do not display on the DBList control. This is true even if the number of rows returned...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAPN,QBS0,QAN0,QBXS,QBAE,QANY,QAHV,QBXQ,QAH4,QAHP,QBI8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ScrollBars Don't Display on DBList Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 19, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137027</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
<P><h3>Symptom 1</h3>
 
<P>
When binding a DBList control to a Data control whose RecordSource property
is set to a Select statement with a Where clause, the ScrollBars do not
display on the DBList control. This is true even if the number of rows
returned by the Select statement exceeds the list size of the control (the
number of items DBList can display without scrolling).
<P>
<P><h3>Symptom 2</h3>
 
<P>
Also, if the height of the DBList control is set to display only one item
at a time, the ScrollBars do not display on the DBList control.
<P>
<P><h2>CAUSE</h2>
 
<P>
The DBList ScrollBar relies on the RecordCount property of the RecordSet.
When using Select with a Where clause in the RecordSource property,
RecordSet.RecordCount returns a value of 1. Usually this count is less than
the maximum number of items DBList can display without scrolling, so
ScrollBars are not displayed.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Listed below are different ways to work around this problem depending on
the symptoms occurring:
<P>
<P><h3>Symptom 1</h3>
 

<UL><LI>Issue a Recordset.MoveLast before showing the DBList control. For
   example, if Data1 is the Data control to which DBList is bound, place
   the following code in the Form_Load event procedure to solve the
   problem:
<P>
   Data1.Refresh
   Data1.RecordSet.MoveLast
<P>
 -or-

<LI>Issue a MoveNext enough times so that the RecordCount will return
   something greater than the number of items that can be visible in the
   DBList without scrolling. For example, if DBList can display 10 items at
   one time, place the following code in the Form_Load event procedure,
   assuming Data1 is the name of the Data Control:
<P>
   Data1.Refresh
   For x% = 0 To 10
<P><PRE>      Data1.RecordSet.MoveNext
</PRE>   Next x%
<P>
</UL><h3>Symptom 2</h3>
 

<UL><LI>Add the following code in the Activate event of the form that contains
   the DBList control:
<P>
   DBList1.SetFocus
   SendKeys "{Down}{Up}"
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the DBList control included
with the products listed above. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
<P><h3>Symptom 1</h3>
 

<OL><P><LI>Start a new project in Visual Basic 4.0. Form1 is created by default.

<P><LI>Add two DBList controls (DBList1 and DBList2) to Form1.

<P><LI>Add two Data Controls (Data1 and Data2) to Form1.

<P><LI>From the Properties window, set the properties for each control as
   follows:
<P>
   Data1:
<P>
<P><PRE>      DatabaseName = Biblio.mdb
      RecordSource = Authors
      RecordsetType = 1 - Dynaset
</PRE><P>
   Data2:
<P>
<P><PRE>      DatabaseName = Biblio.mdb
      RecordSource = Select Author From Authors where Au_Id &gt; 0
      RecordsetType = 1 - Dynaset
</PRE><P>
  DBList1:
<P>
<P><PRE>      RowSource = Data1
      ListField = Author
</PRE><P>
  DBList2:
<P>
<P><PRE>      RowSource = Data2
      ListField = Author
</PRE>
<P><LI>Press the F5 key to run the application. DBList1 will have a ScrollBar,
   and DBList2 will not.
<P>
</OL><h3>Symptom 2</h3>
 

<OL><P><LI>Start a new project in Visual Basic 4.0. Form1 is created by default.

<P><LI>Add a Data control and a DBListbox on the form.

<P><LI>Set the Data controls Databasename property to "Biblio.mdb"

<P><LI>Set the Data controls Recordsource property to "Publishers"

<P><LI>Set the DBList controls RowSource property to Data1.

<P><LI>Set the DBList controls BoundColumn property to PubID.

<P><LI>Set the DBList controls ListField property to Name.

<P><LI>Set the height of the DBList control to show only one item at a time.

<P><LI>Press the F5 key to run the application.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 buglist4.00 vb4win vb4all<BR>
KBCategory: kbui kbprg kbbuglist<BR>
KBSubcategory: APrgDataOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 19, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
