

<HTML>
<HEAD>
<TITLE>How to Import Text File into Microsoft Access Table Using DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113905">
<META NAME="KBModify" CONTENT="1996/04/16">
<META NAME="KBCreate" CONTENT="1994/04/19">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows you how to implement the built-in TransferText command of Microsoft Access to import data from a text file into a Microsoft Access Table using DDE. This method is faster than the alternate method outlined in the following article...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA1S,QDN9,QBS0,QAA1,QAZ2,QAY4,QBJZ,QDI2,QABA,QBW7,QATX,QAMB,QAI5,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Import Text File into Microsoft Access Table Using DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113905</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows you how to implement the built-in TransferText command
of Microsoft Access to import data from a text file into a Microsoft Access
Table using DDE. This method is faster than the alternate method outlined
in the following article in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A href="../vbwin/q103807.htm">Q103807</A></B>
<PRE>TITLE     : How to Convert a Text File into a New Access Database

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The TransferText command is used in Access Basic to import data from a text
file into a table. If the table specified doesn't exist, the TransferText
command creates the table. If the table does exist, the text file's format
must match that of the existing table.
<P>
The text file can be comma delimited with strings enclosed in quotation
marks or it can be of fixed width. The delimiter and fixed width settings
can be set up in Microsoft Access by choosing Imp/Exp Setup from the File
menu. For more information on these settings, please consult the Microsoft
Access Help menu.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Using Notepad, create the following file to import and save it as
   C:\ACCESS\SHIPPERS.TXT:
<P>
   4,"world traveller"
   5,"frazier freight"
   6,"longfellow hauling"
   7,"toolsmith shipping"

<P><LI>Start Microsoft Access and open the C:\ACCESS\NWIND.MDB database.

<P><LI>Start a new project in Visual Basic (ALT, F, N). Form1 is created by
   default.

<P><LI>Place a text box (Text1) and a command button (Command1) on the form.

<P><LI>Add the following code to the click event of Command1:
<P>
<PRE>   Sub Command1_Click ()
      Dim cmd As String      ' Holds DDEExecute command.
      On Error GoTo DDEerr   ' Error trap.

      ' Make sure there isn't an existing DDE conversation:
      text1.LinkMode = 0

      ' Set up the DDE link:
      text1.LinkTopic = "MSACCESS|C:\ACCESS\NWIND.MDB"
      text1.LinkItem = "All"
      text1.LinkMode = 2

      ' DDEExecute command to import text file into Microsoft Access Table:
      cmd = "[TransferText ,,'Shippers','C:\ACCESS\SHIPPERS.TXT']"

      ' Execute the TransferText command and close the DDE link:
      text1.LinkExecute cmd
      text1.LinkMode = 0
      MsgBox "Transfer OK"
      Exit Sub

   DDEerr:
      ' An error has occurred.
      MsgBox Error
      MsgBox "Error in transfer."
      Exit Sub
   End Sub

</PRE><P><LI>Run the Visual Basic program and click the command button to import the
   information in the text file into the Shippers table. A message box will
   be displayed showing you whether or not the transfer was successful.
<P>
</OL>For more information on how to implement DDE with Microsoft Access, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q96845.htm">Q96845</A></B>
   TITLE     : How to Use DDE to Display Microsoft Access Data in VB
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 4.00 vb416<BR>
KBCategory: kbinterop kbprg kbcode<BR>
KBSubcategory: IAPDDE
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
