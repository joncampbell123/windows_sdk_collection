

<HTML>
<HEAD>
<TITLE>PRB: Message Box Appears Behind Form Set as Top-Most Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178401">
<META NAME="KBModify" CONTENT="1997/12/22">
<META NAME="KBCreate" CONTENT="1997/12/22">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A Visual Basic form can be displayed as the top z-ordered (or top-most) window by using the SetWindowPos API function. Under Windows 95, if the top- most window then displays a message box, the message box may display behind the top-most window. Th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QBS0,QAFF,QAH4,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Message Box Appears Behind Form Set as Top-Most Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178401</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
   on the following platform: Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A Visual Basic form can be displayed as the top z-ordered (or top-most)
window by using the SetWindowPos API function. Under Windows 95, if the top-
most window then displays a message box, the message box may display behind
the top-most window. The user cannot continue or exit the program because
the user cannot close the message box.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not display a message box from a form set as the top-most window. If you
must use a message box from the form, unload the form first before
displaying the message box.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new Standard EXE project in Visual Basic. Form1 is created by
   default.

<P><LI>Add the two CommandButtons to Form1 form. Set the following Form1 form
   properties:
<P>
<PRE>   Form1 Form Property            Setting
   ---------------------------------------
   BorderStyle                    0-None
   StartUpPosition                2-CenterScreen

</PRE><P><LI>Copy the following code to the Code window of Form1 form:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Declare Function SetWindowPos Lib "user32" _
<PRE></PRE>         (ByVal hwnd As Long, _
         ByVal hWndInsertAfter As Long, _
         ByVal x As Long, _
         ByVal y As Long, _
         ByVal cx As Long, _
         ByVal cy As Long, _
         ByVal wFlags As Long) As Long
      Const HWND_TOPMOST = -1
      Const SWP_NOMOVE = &amp;H2
      Const SWP_NOSIZE = &amp;H1

      Private Sub Form_Load()
          Dim lngWindowPosition As Long
          Command1.Caption = "Show Message Box"
          Command2.Caption = "End Program"
          LngWindowPosition = SetWindowPos(Form1.hwnd, _
                                           HWND_TOPMOST, _
                                           0, _
                                           0, _
                                           0, _
                                           0, _
                                           SWP_NOMOVE Or SWP_NOSIZE)
      End Sub

      Private Sub Command1_Click()
          MsgBox "From Message Box", vbSystemModal
      End Sub

      Private Sub Command2_Click()
          End
      End Sub

</PRE><P><LI>Save the Project and compile the project into an executable file. This
   problem only occurs from an EXE file.

<P><LI>Run the executable file.

<P><LI>Click Show Message Box to display the message box.

<P><LI>Click on the desktop or another application to de-activate Project1.

<P><LI>Click on the form of Project1 to activate Project1.

<P><LI>Click OK to dismiss the message box.
<P>
</OL>NOTE: You may need to repeat steps 6-9 several times to reproduce the
problem where the Message Box is displayed behind the top-most window and
cannot be dismissed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: topmost top most modal<BR>
Keywords          : vb5all<BR>
Version           : WINDOWS:5.0<BR>
Platform          : Win95 WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
