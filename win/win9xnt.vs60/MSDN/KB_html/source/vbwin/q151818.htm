

<HTML>
<HEAD>
<TITLE>HOWTO: Build a Setup Program Creating Multiple Groups/Icon </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151818">
<META NAME="KBModify" CONTENT="1997/06/09">
<META NAME="KBCreate" CONTENT="1996/05/30">
<META NAME="Keywords" CONTENT="kbusage TlsSetWiz VB4ALL VB4WIN kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  By default, the Visual Basic 4.0 Setup Wizard creates one program group using the project name, and one icon within the program group for the executable file generated by the project. This article shows how to create additional program groups and m...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIM,QBS0,QAA1,QAH4,QABO,QAFI,QDI2,QDIZ,QAMA,QAGI,QBXB,QATJ,QA5F,QADX,QA4F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Build a Setup Program Creating Multiple Groups/Icon</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151818</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By default, the Visual Basic 4.0 Setup Wizard creates one program group
using the project name, and one icon within the program group for the
executable file generated by the project. This article shows how to create
additional program groups and more than one icon within a group for any
additional executable files you want to ship by customizing the Visual
Basic Setup Toolkit's SETUP1.VBP project.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The SETUP1.VBP project in the Visual Basic 4.0 Setup Toolkit has two
functions defined in the SETUP1.BAS file, CreateOSProgramGroup() and
CreateOSLink(), that allow you to add program groups and icons. By
default, the Form_Load event of SETUP1.FRM calls these two functions to
create only one program group and one program icon. More program groups
and icons can be added by calling these two functions multiple times and
specifying new group names and additional executable file names. After you
rebuild the SETUP1.EXE file, the modified version will be used in
subsequent Setup programs created by the Visual Basic Setup Wizard. The
SETUP1.VBP project is located in \SETUPKIT\SETUP1 subdirectory of the main
Visual Basic directory.
<P>
NOTE: Customizing SETUP1.EXE will make it unusable for other projects.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Backup all files in \SETUPKIT\SETUP1 subdirectory of the main Visual
   Basic directory. This directory is also mirrored on the product CD-ROM
   in the VB\SETUPKIT\SETUP1 directory.

<P><LI>Load SETUP1.VBP, and locate the Form_Load event of the SETUP1.FRM.

<P><LI>In Form_Load event, look for the section with the following comments:
<P>
<P><PRE>      '
      'Create program groups and icons (or links, i.e. shortcuts)
      '
</PRE>
<P><LI>Find the lines where CreateOSProgramGroup() and CreateOSLink() are
   called:
<P>
<P><PRE>      CreateOSProgramGroup frmSetup1, strGroupName, strGrpPath
      CreateOSLink frmSetup1, gsDest.strAppDir &amp; gstrAppExe, "", _
      gstrAppName
</PRE>
<P><LI>Comment out those lines.

<P><LI>Before the line:
<P>
<P><PRE>      If fCreateGroup Then
</PRE><P>
<P><PRE>      set fCreateGroup and fAdditionalIcons to TRUE:
</PRE><P>
<P><PRE>      fCreateGroup = TRUE
      fAdditionalIcons = TRUE
</PRE>
<P><LI>Suppose this setup program will create one program group called
   MyGroup1 that contains MyExe1.Exe and MyExe2.Exe, and another group
   called MyGroup2 that contains MyExe3.Exe and MyExe4.Exe. Suppose that
   the destination directory for each of the EXE files is $(APPPATH) –
   the default. In the places where CreateOSProgramGroup and CreateOSLink
   are originally called (step 4), type in the following code:
<P>
<P><PRE>      CreateOSProgramGroup frmSetup1, "MyGroup1", "MyGroup1.GRP"
      CreateOSLink frmSetup1, gsDest.strAppDir &amp; "MyExe1.EXE", "",_
      "MyExe1", TRUE
      CreateOSLink frmSetup1, gsDest.strAppDir &amp; "MyExe2.EXE", "",_
      "MyExe2", TRUE
</PRE><P>
<P><PRE>      CreateOSProgramGroup frmSetup1, "MyGroup2", "MyGroup2.GRP"
      CreateOSLink frmSetup1, gsDest.strAppDir &amp; "MyExe3.EXE", "",_
      "MyExe3", TRUE
      CreateOSLink frmSetup1, gsDest.strAppDir &amp; "MyExe4.EXE", "",_
      "MyExe4", TRUE
</PRE><P>
</OL>NOTE: Under Windows NT, a program remover icon is created at the last
program group. For this example, the icon will be at MyGroup2.

<OL><P><LI>Build SETUP1.EXE.

<P><LI>Use Setup Wizard to build the setup program. This setup program will
   create two program groups, and each program group will contain two EXE
   files.

<P><LI>Restore the original SETUP1.VBP files to the \SETUPKIT\SETUP1
   subdirectory of your main Visual Basic directory.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage TlsSetWiz VB4ALL VB4WIN kbhowto<BR>
Version             : 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
