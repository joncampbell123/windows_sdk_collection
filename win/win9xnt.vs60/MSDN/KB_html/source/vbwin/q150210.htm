

<HTML>
<HEAD>
<TITLE>BUG: DBCombo Control Does Not Allow Selection on Modal Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150210">
<META NAME="KBModify" CONTENT="1996/10/16">
<META NAME="KBCreate" CONTENT="1996/04/23">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If a DBCombo control is placed on a form that is shown modally, then the user is unable to click a selection of the drop-down list. This behavior only occurs in an EXE file, it does not occur in the Design Environment of Visual Basic.  STATUS =====...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QA7O,QAOE,QAMN,QAPN,QDKW,QBXS,QAH4,QACI,QAYZ,QAI2,QABI,QBWS,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: DBCombo Control Does Not Allow Selection on Modal Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150210</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic for Windows, 16-bit and 32-bit, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If a DBCombo control is placed on a form that is shown modally, then the
user is unable to click a selection of the drop-down list. This behavior
only occurs in an EXE file, it does not occur in the Design Environment of
Visual Basic.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, the function below can be used to simulate
showing a form modally. The workaround allows the DBCombo control to be
used.
<P>
Instead of showing a form modally, show the form using a method such as the
one documented below. For example, to simulate invoking Form1 modally, call
the method as shown below:
<P>
<PRE>   ShowModalForm Form1

</PRE>The subroutine ShowModalForm is shown below, and can be placed in a Form or
standard code module:
<P>
<PRE>   Public Sub ShowModalForm(frmTarget As Form)
      Dim ofrm As Object
      'Disable all the forms
      For Each ofrm In Forms
        ofrm.Enabled = False
      Next ofrm

      'Now show the target form non-modal
      frmTarget.Show
      'If the frmTarget was disabled by the loop above
      'make sure it is now enabled
      frmTarget.Enabled = True

      'Sit in a loop until the target form is dismissed
      Do While frmTarget.Visible = True
      DoEvents
      Loop

      'We have left the loop, so the dialog has been dismissed
      'Now Enable the forms, and exit the procedure
      For Each ofrm In Forms
       ofrm.Enabled = True
      Next ofrm
   End Sub

</PRE><h3>Steps To Reproduce the Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Insert a new form into the project by choosing Insert...Form.

<P><LI>On the new Form (Form2), place a Data control and a DBCombo control.

<P><LI>Set the Databasename property of the Data control to Biblio.mdb, found
   in the vb directory. Set the Recordsource property to Authors.

<P><LI>Set the RowSource property of the DBCombo control to Data1, and the
   ListField property of the DBCombo control to Author.

<P><LI>In the Click event for Form1, place the following code to invoke Form2
   modally:
<P>
<P><PRE>      Form2.Show vbModal
</PRE>
<P><LI>Compile an EXE by choosing File...Make EXE from the menu.

<P><LI>Using File Manager, or Windows Explorer invoke the EXE for the project.

<P><LI>Click Form1 so that Form2 is shown. Choose the drop-down list for the
   DBCombo control, and note that a selection of the list cannot be made.
<P>
</OL>To work around this problem above using the workaround, the ShowModalForm
routine can be placed into the project and the line of code in the Click
event of Form1 can be changed to:
<P>
<PRE>   ShowModalForm Form2
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgOther<BR>
Additional reference words: 4.00 vb4win vb4all buglist4.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
