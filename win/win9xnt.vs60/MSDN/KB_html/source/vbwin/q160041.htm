

<HTML>
<HEAD>
<TITLE>How To Modify the Windows Default Cursor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160041">
<META NAME="KBModify" CONTENT="1996/11/29">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="kbusage kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The MousePointer property in Visual Basic (which applies to Form, MDIForm, and a set of selected controls) allows you to modify the cursor's shape for a Visual Basic application. However, if the cursor is moved away from the Visual Basic applicatio...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAO2,QABA,QBWS,QAH4,QDL9,QBWQ,QBWO,QBWN,QAK7,QAJH,QA5F,QAMA,QAFF,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Modify the Windows Default Cursor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160041</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The MousePointer property in Visual Basic (which applies to Form, MDIForm,
and a set of selected controls) allows you to modify the cursor's shape for
a Visual Basic application. However, if the cursor is moved away from the
Visual Basic application, its shape is determined by other applications or
by the Desktop.
<P>
This article describes how to modify the cursor's default settings so that
these changes are reflected throughout the Desktop.
<P>
NOTE: Due to a bug in Windows NT, this article only applies to Windows 95.
Microsoft is researching this issue and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
At times, you may want to design an application in Visual Basic
that allows the user to run other applications or tasks within the same
application while a task is running.
<P>
A simple way to inform the user that this particular state exists is to
modify the cursor to be both an arrow and an hourglass until the first task
is completed. You can accomplished this easily with the SetSystemCursor
API.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example simulates starting a task with the first
CommandButton and halting it with the second CommandButton:.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the General Declarations section of Form1:
<P>
   Private Const IDC_APPSTARTING = 32650&amp;
   Private Const IDC_ARROW = 32512&amp;
   Private Const OCR_NORMAL = 32512&amp;
<P>
<PRE>   Private Declare Function LoadCursor Lib "user32" Alias "LoadCursorA"
   (ByVal hInstance As Long, ByVal lpCursorName As Long) As Long
   Private Declare Function SetSystemCursor Lib "user32" (ByVal hcur As
   Long, ByVal id As Long) As Boolean

</PRE><P><LI>Add two CommandButtons, Command1 and Command2, to Form1.

<P><LI>Add the following code to the Click event of Command1:
<P>
<PRE>   Private Sub Command1_Click()
   Dim hcursor As Long, ret_val As Long

       hcursor = LoadCursor(0, IDC_APPSTARTING)
       ret_val = SetSystemCursor(hcursor, OCR_NORMAL)

   End Sub

</PRE><P><LI>Add the following code to the Click event of Command2:
<P>
<PRE>   Private Sub Command2_Click()
   Dim hcursor As Long, ret_val As Long

       hcursor = LoadCursor(0, IDC_ARROW)
       ret_val = SetSystemCursor(hcursor, OCR_NORMAL)

   End Sub

</PRE><P><LI>Run the project by pressing the F5 key. Click on Command1 to modify the
   cursor. Move the cursor around over other applications and click on them
   for activation. Finally, click on Command2 to restore the cursor to its
   original shape.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbhowto<BR>
KBSubcategory: kbnocat<BR>
Additional reference words: 4.00 vb4win vb432 kbstream
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
