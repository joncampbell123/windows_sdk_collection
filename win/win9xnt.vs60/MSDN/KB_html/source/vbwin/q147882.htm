

<HTML>
<HEAD>
<TITLE>DAO: How to Assign a Recordset to a Data Control in VB 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147882">
<META NAME="KBModify" CONTENT="1996/07/25">
<META NAME="KBCreate" CONTENT="1996/03/01">
<META NAME="Keywords" CONTENT="kbprg kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Some improvements have been made to the data control in Microsoft Visual Basic version 4.0 for Windows. One of these improvements is the capability to assign back the results of a Recordset object to the data control itself. This was not possible i...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBS0,QAMN,QA7O,QAB5,QBXS,QANF,QAOE,QAMB,QAW6,QBWS,QAYY,QA5V,QAH4,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DAO: How to Assign a Recordset to a Data Control in VB 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 25, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147882</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Some improvements have been made to the data control in Microsoft Visual
Basic version 4.0 for Windows. One of these improvements is the capability
to assign back the results of a Recordset object to the data control
itself. This was not possible in Microsoft Visual Basic version 3.0 for
Windows.
<P>
This article demonstrates how to assign a Table-type, Dynaset-type, or
Snapshot-type Recordset object back to a data control's Recordset property.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The OpenRecordset method has three possible types of records that it can
produce. Below is a portion of the Visual Basic Online Help that describes
the Openrecordset method that mentions these three types:
<P>
<PRE>   dbOpenTable to open a table-type Recordset object.
   dbOpenDynaset to open a dynaset-type Recordset object.
   dbOpenSnapshot to open a snapshot-type Recordset object.

</PRE>Also, the following was taken directly from Chapter 4 of the "Guide to Data
Access Objects" book contained in the "Professional Features" Visual Basic
manual:
<P>
<PRE>   When you open a database using the data control, a Recordset object is
   automatically created based on the control's RecordSource property. You
   can address this Recordset with the following syntax:

      Data1.Recordset

</PRE>All of the Recordset properties and methods discussed in this chapter can
be used with the data control's Recordset. In addition, you can assign the
data control's Recordset object to any Recordset variable you create. For
example:
<P>
<PRE>   Dim MyRecordset As Recordset
   Set MyRecordset = Data1.Recordset

</PRE>Conversely, you can assign a Recordset object that you create
programmatically or with a data control to another data control, using the
following syntax:
<P>
<PRE>   Set Data1.Recordset = MyRecordset

</PRE>When you assign a new Recordset object to the data control's Recordset
property, you must use the data control's Refresh method to rebuild the
Recordset and allow the data control to properly display it. In addition,
you must make sure that the DataField property of all bound controls
attached to the data control reflect valid fields in the new Recordset.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic or on the File menu, click New Project (ALT, F, N) if
   Visual Basic is already running. Form1 is created by default.

<P><LI>Add three command buttons (Command1, Command2, and Command3), add two
   text boxes (Text1, and Text2) and one data control to Form1.

<P><LI>Set the following properties:
<P>
<PRE>   Default     Property          Value of Property
   -------------------------------------------------

   Command1    Caption          Assign Table-type
   Command2    Caption          Assign Dynaset-type
   Command3    Caption          Assign Snapshot-type
   Data1       DatabaseName     BIBLIO.MDB
   Data1       RecordSource     Titles
   Text1       DataSource       Data1
   Text1       Datafield        Title
   Text2       DataSource       Data1
   Text2       Datafield        Year Published

</PRE><P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Private Sub Command1_Click()
     Dim ws As Workspace
     Dim db As Database
     Dim tbl As Recordset
     Set ws = DBEngine.Workspaces(0)
     Set db = ws.OpenDatabase("Biblio.mdb")
     Set tbl = db.OpenRecordset("titles", dbOpenTable)
     Set Data1.Recordset = tbl
   End Sub

</PRE><P><LI>Add the following code to the Command2_Click event:
<P>
<PRE>   Private Sub Command2_Click()
     Dim ws As Workspace
     Dim db As Database
     Dim rs As Recordset
     Set ws = DBEngine.Workspaces(0)
     Set db = ws.OpenDatabase("Biblio.mdb")
     Dim StrSQL As String
     StrSQL = "Select * from titles where title like 'a*' "
     Set rs = db.OpenRecordset(StrSQL, dbOpenDynaset)
     Set Data1.Recordset = rs
   End Sub

</PRE><P><LI>Add the following code to the Command3_Click event:
<P>
<PRE>   Private Sub Command3_Click()
     Dim ws As Workspace
     Dim db As Database
     Dim sn As Recordset
     Set ws = DBEngine.Workspaces(0)
     Set db = ws.OpenDatabase("Biblio.mdb")
     Dim StrSQL As String
     StrSQL = "Select * from titles where title like 'the*' "
     Set sn = db.OpenRecordset(StrSQL, dbOpenSnapshot)
     Set Data1.Recordset = sn
   End Sub

</PRE><P><LI>On the Run menu, click Start (ALT, R, S), or press the F5 key to run the
   program. Click the Command1 button to view the records as a table-type
   Recordset, click the Command2 button to view the records as a
   Dynaset-type Recordset, or click the Command3 button to view the records
   as a Snapshot-type Recordset.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432<BR>
KBCategory: kbprg kbcode kbhowto kbwebcontent<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 25, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
