

<HTML>
<HEAD>
<TITLE>How to Use SizeMode Property of OLE Control to Size Display </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112043">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/02/28">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows by example how to use the SizeMode property of the OLE Control for Visual Basic version 3.0 to obtain a proportional display in a limited screen space.  MORE INFORMATION  The SizeMode property of the OLE Control determines how th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMN,QAPN,QA7O,QAB5,QAOE,QA9Q,QBS0,QAW6,QABA,QAHV,QAH6,QAH4,QAFR,QBXS,QAW9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use SizeMode Property of OLE Control to Size Display</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112043</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to use the SizeMode property of the
OLE Control for Visual Basic version 3.0 to obtain a proportional display
in a limited screen space.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The SizeMode property of the OLE Control determines how the OLE control
is sized or how its image is displayed when it contains an object.
<P>
Here are the valid settings for the SizeMode property:
<P>
<PRE> 0 (Default) Clip -- The object is displayed in actual size. If the
   object is larger than the OLE control, its image is clipped by
   the control's borders, showing the upper-left portion of the image.

 1 Stretch -- The object's image is sized to fill the OLE control. The
   height of the image is stretched (or shrunk) to fit the OLE control.
   The same thing happens to the width. As a result, you may get a
   distorted image. Height and width are independent, not proportional.

 2 Autosize -- The OLE control is resized to display the entire object.
   The object is displayed in actual size. By using the resize event of
   the OLE control, you can adjust the HeightNew and WidthNew parameters
   to maintain size limits of the OLE control. However, the display
   behaves as if you had used the clip setting.

</PRE><h3>Step-by-Step Example</h3>
 
<P>
The goal of this example is to obtain a proportional display that is
restricted to a limited screen space, that of the size of the form the OLE
control is on.
<P>
The example uses AutoSize and Stretch settings to find a proportional best
fit. The height and width of the container form supply the maximum height
and width of the image. The Autosize property supplies best-fit
information.
<P>
Then the Autosize property is set to Stretch mode for display.

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>Add an MSOLE2 control to the form. When the Insert Object dialog box
   asks what type of object to insert, select the Create From File
   option and a Microsoft Word .DOC file.

<P><LI>Set the SizeMode property of the OLE control to 1 (Stretch).

<P><LI>Add the following code to the Form_Load event:
<P>
<PRE>   Sub Form_Load()
      OLE1.Top = 0
      OLE1.Left = 0
   End Sub

</PRE><P><LI>Add the following code to the Resize event of the OLE control:
<P>
<PRE>   Sub OLE1_Resize (heightNew As Single, WidthNew As Single)
      Dim wRatio As Single, hRatio As Single, cRatio As Single
      Dim MaxHeight As Single, MaxWidth As Single

      If OLE1.SizeMode = 2 Then
         MaxHeight = Me.Height
         MaxWidth = Me.Width
         'Calculate hRatio
         If heightNew &gt; MaxHeight Then
            hRatio = 1 - (heightNew - MaxHeight) / heightNew
         Else
            hRatio = 1 + (MaxHeight - heightNew) / heightNew
         End If
         'Calculate wRatio
         If WidthNew &gt; MaxWidth Then
            wRatio = 1 - (WidthNew - MaxWidth) / WidthNew
         Else
            wRatio = 1 + (MaxWidth - WidthNew) / WidthNew
         End If
         'Pick best ratio for cRatio
         If hRatio &lt; wRatio Then
            cRatio = hRatio
         Else
            cRatio = wRatio
         End If
         'Apply changes
         OLE1.Height = CInt(cRatio * heightNew)
         OLE1.Width = CInt(cRatio * WidthNew)
         OLE1.SizeMode = 1
      ElseIf OLE1.SizeMode = 1 Then
         'Use AutoSize to recalculate ratio.
         OLE1.SizeMode = 2
      End If
   End Sub

</PRE><P><LI>Run the program.
<P>
</OL>When you double-click the OLE control and make changes to your document,
you should see the control itself change size to fit proportionally on
your form.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 OLE Automation OA OLE2<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
