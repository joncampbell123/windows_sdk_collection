

<HTML>
<HEAD>
<TITLE>HOWTO: Change an Access Database Password </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170961">
<META NAME="KBModify" CONTENT="1997/07/03">
<META NAME="KBCreate" CONTENT="1997/07/02">
<META NAME="Keywords" CONTENT="vb432 vb4win vb5all vb5howto VBKBVBA kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Microsoft Access 7.0 and 97 MDB files can be password protected. This article demonstrates how to change the password associated with a Microsoft Access 7.0 or 97 MDB file.  MORE INFORMATION  Microsoft Access 7.0 and 97 use Jet 3.0 and Jet 3.5 MDB ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWK,QA1S,QAZV,QDKY,QBFY,QAEF,QAPN,QBS0,QDN9,QAUT,QA5B,QAVX,QAVW,QAH4,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Change an Access Database Password</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170961</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   32-bit only, for Windows, version 4.0
<LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Access 7.0 and 97 MDB files can be password protected. This
article demonstrates how to change the password associated with a Microsoft
Access 7.0 or 97 MDB file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Access 7.0 and 97 use Jet 3.0 and Jet 3.5 MDB files,
respectively. For the code below to work correctly, you must have a
reference to an appropriate Microsoft DAO Object Library.
<P>
The database password can be changed by using the NewPassword method. The
following example changes the password of the MyDB.mdb database from
"MyPassword1" to "MyPassword2":
<P>
<PRE>   Sub ChangeDBPassword ()
      Dim Db As Database

      Set Db = OpenDatabase("C:\My Documents\MyDB.mdb",True, _
         False,";pwd=MyPassword1")
      Db.NewPassword "MyPassword1","MyPassword2"
      Db.Close
   End Sub

</PRE>The code above does not handle the possibility of trying to open the
database with the wrong password, which would generate an error. Every
application that tries to open password protected databases should be able
to handle this scenario.
<P>
To remove password protection from a database, use an empty string for the
second parameter of the NewPassword method. For example:
<P>
<PRE>   Db.NewPassword "MyPassword2", ""

</PRE>To assign a database password to a MDB that is currently without a
password, use an empty string for the first parameter of the NewPassword
method. For example:
<P>
<PRE>   Db.NewPassword "", "MyPassword1"

</PRE>You can also change, assign or remove a database password using the
CompactDatabase method. When using this method on a database with a
password, the Optional arguments must be provided:
<P>
<PRE>   Sub CompactDB ()
      ' Compact the database, supplying the password
      DBEngine.CompactDatabase "C:\My Documents\MyDB.mdb", _
         "C:\My Documents\Test.MDB", dbLangGeneral, dbVersion30, _
         ";pwd=MyPassword1"
   End Sub

</PRE>The new database has the same password as the old. Here you compact a MDB
with a password of "MyPassword1" and give the new database a password of
"MyNewPWD":
<P>
<PRE>   DBEngine.CompactDatabase "C:\My Documents\Test.mdb", _
      "C:\My Documents\TestII.MDB", dbLangGeneral &amp; ";pwd=MyNewPWD", _
      dbVersion30, ";pwd=MyPassword1"

</PRE>With this line, you can remove the database password:
<P>
<PRE>   DBEngine.CompactDatabase "C:\My Documents\TestII.mdb", _
      "C:\My Documents\TestIII.MDB", dbLangGeneral &amp; ";pwd=", _
      dbVersion30, ";pwd=MyNewPWD"

</PRE>This line compacts a database without a password and assigns a password of
"NewPassword" to the new database:
<P>
<PRE>   DBEngine.CompactDatabase "C:\My Documents\TestIII.mdb", _
     "C:\My Documents\TestIV.mdb", dbLangGeneral &amp; _
     ";pwd=NewPassword", dbVersion30
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : vb432 vb4win vb5all vb5howto VBKBVBA kbhowto<BR>
Version             : 4.0 5.0 7.0 97<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
