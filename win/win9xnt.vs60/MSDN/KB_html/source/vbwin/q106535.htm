

<HTML>
<HEAD>
<TITLE>How VB Can Determine If Table Is Locked By Other Processes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106535">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/11/10">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how to detect if a database table has any records locked by other users or processes. If you open the table with the options to deny read and write access, a trappable error will indicate that other users or processes are usi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA5V,QBJZ,QBTI,QAUR,QABT,QBXS,QBWS,QAY2,QAU7,QAH4,QAIJ,QAK7,QAHT,QAJ6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How VB Can Determine If Table Is Locked By Other Processes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106535</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to detect if a database table has any records
locked by other users or processes. If you open the table with the options
to deny read and write access, a trappable error will indicate that other
users or processes are using the table. This information is useful for
managing tables in a multiuser or network system.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example uses one program (PROGLOC1.EXE) to optionally lock a
record in a table. A separate, concurrent program (PROGLOC2) checks to see
if any records in the table are currently locked.

<OL><P><LI>Make PROGLOC1.EXE by following these steps in Visual Basic:
<P>
   a. Start a new project in Visual Basic. Form1 is created by default.
<P>
   b. Add a large command button to Form1.
<P>
   c. Enter the following code for the Command1_Click event procedure:
<P>
<PRE>      Sub Command1_Click ()
         Dim db As database
         Set db = OpenDatabase("biblio.mdb")
         Dim ds As dynaset
         Set ds = db.CreateDynaset("authors")
         ds.Edit     ' Locks the first record in the dynaset.
         MsgBox "First record in dynaset is locked. Press OK to unlock."
         command1.Caption = "record now unlocked"
      End Sub

   d. Choose Save File As from the File menu, and save as PROGLOC1.FRM.
      Choose Save Project As from the File menu, and save as PROGLOC1.MAK.

   e. Choose Make EXE File from the File menu to create PROGLOC1.EXE.

</PRE><P><LI>Make PROGLOC2 by following these steps in Visual Basic:
<P>
   a. Start a new project in Visual Basic. Form1 is created by default.
<P>
   b. Add a large command button to Form1.
<P>
   c. Enter the following code for the Command1_Click event procedure:
<P>
<PRE>      Sub Command1_Click ()

         Dim db As database
         Set db = OpenDatabase("biblio.mdb")
         Dim tb As table
         ' See if table has locks by opening and denying others Read/Write:
         On Error Resume Next
         Set tb = db.OpenTable("authors", 3) ' 3 = Deny Read &amp; Write (2+1)
         If Err = 0 Then
            command1.Caption = "not locked"
         Else
            command1.Caption = "locked due to err=" &amp; err
         End If
         tb.Close
         ' If no error here you could reopen table without denying access.

      End Sub

   d. Optional steps to save this sample program:
      Choose Save File As from the File menu, and save as PROGLOC2.FRM.
      Choose Save Project As from the File menu, and save as PROGLOC2.MAK.

   e. Run PROGLOC1.EXE from Windows File Manager and click the command
      button to lock a record. Leave the following message box up without
      pressing OK:

        First record in dynaset is now locked. Press OK to unlock.

   f. Start PROGLOC2 from Visual Basic by pressing the F5 key. Click the
      command button to report whether or not a record is locked.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 row locking multiuser<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgDataOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
