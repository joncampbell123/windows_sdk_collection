

<HTML>
<HEAD>
<TITLE>PRB: VB5 .OCX Property Missing from VB4 Properties Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169772">
<META NAME="KBModify" CONTENT="1997/06/09">
<META NAME="KBCreate" CONTENT="1997/06/06">
<META NAME="Keywords" CONTENT="vb432 vb4win vb5all VBKBAX VBKBComp VBKBCtrl VBKBEnv kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A public property of an ActiveX Control (.OCX) created in Visual Basic 5.0 does not appear in the Properties Window when the control is used in Visual Basic 4.0's design environment.  CAUSE =====  By default, a Public Property Let procedure passes ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAB5,QA7O,QAMN,QAHV,QAOE,QBWC,QA5F,QAMA,QAH7,QAH6,QANY,QAD7,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: VB5 .OCX Property Missing from VB4 Properties Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169772</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Professional, and Enterprise
   Editions for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A public property of an ActiveX Control (.OCX) created in Visual Basic 5.0
does not appear in the Properties Window when the control is used in Visual
Basic 4.0's design environment.
<P>
<P><h2>CAUSE</h2>
 
<P>
By default, a Public Property Let procedure passes its arguments by
reference and not by value. When these arguments are passed by reference
from an ActiveX Control (.OCX), the property will not be visible in the
Visual Basic 4.0 Properties Window.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, be sure that all arguments passed by a Public
Property Let procedure are passed by value. For example, if you have the
following property procedure definition:
<P>
<PRE>   Public Property Let MyProperty(newValue As Boolean)

</PRE>it needs to be changed to:
<P>
<PRE>   Public Property Let MyProperty(ByVal newValue As Boolean)

</PRE>to work correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In Visual Basic 5.0, start a new ActiveX Control project. UserControl1
   is created by default. Change the Project name (not the file name) to
   "UserCtl1."

<P><LI>Add the following code to the General Declarations section of
   UserControl1:
<P>
<P><PRE>      'A public variable is always visible in the Properties Window.
      Public VisibleProperty as Boolean
</PRE><P>
<P><PRE>      Public Property Get HiddenProperyA() as Boolean
      End Property
</PRE><P>
<P><PRE>      Public Property Let HiddenPropertyA(newValue as Boolean)
<PRE></PRE>        'By default the argument is passed by reference.
        'This property will not be displayed in Properties Window.
      End Property

      Public Property Get HiddenPropertyB() as Boolean
      End Property

      Public Property Let HiddenPropertyB(ByVal newValue as Boolean)
         'This argument is passed by value.
         'This property will be displayed in Properties Window.
      End Property

</PRE><P><LI>Save the project and select 'Make UserCtl1.ocx...' from the File menu.
   Close Visual Basic 5.0.

<P><LI>If Visual Basic 4.0 is installed on the same system as Visual Basic 5.0,
   skip to step 5. If Visual Basic 4.0 is installed on a different system,
   you will need to create a set of distribution disks or a net setup to
   install your ActiveX Control on the Visual Basic 4.0 computer. Once the
   ActiveX Control is successfully installed and registered on the Visual
   Basic 4.0 system, you can continue.

<P><LI>Create a new project in Visual Basic 4.0. Form1 is created by default.

<P><LI>Select Custom Controls from the Tools menu and select your ActiveX
   Control. It should be listed as 'UserCtl1.'

<P><LI>Add your ActiveX Control to Form1 and view the Properties Window. You
   should be able to see and set the values of "VisibleProperty" and
   "HiddenPropertyB" in the Properties Window. You cannot see the
   "HiddenPropertyA" property in the Properties Window.
<P>
   In the Object Browser you will be able to see all of the control's
   properties. All of these properties can be set in code at runtime.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : vb432 vb4win vb5all VBKBAX VBKBComp VBKBCtrl VBKBEnv kbprb<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
