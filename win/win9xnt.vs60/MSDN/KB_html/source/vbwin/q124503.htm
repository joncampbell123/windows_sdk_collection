

<HTML>
<HEAD>
<TITLE>FIX: GPF in VBDB300.DLL When Use ODBC to Connect to Oracle DB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124503">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1995/01/03">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When trying to use ODBC with Visual Basic for Windows to get table information from an Oracle database, you may receive the following error message:     An error has occurred in your application...  When you choose the Close button, the following g...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB4,QA94,QA9E,QBKN,QA1S,QATR,QAKP,QBXS,QAR4,QAH4,QAVZ,QDN9,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: GPF in VBDB300.DLL When Use ODBC to Connect to Oracle DB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124503</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbbuglist kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Professional Edition of Microsoft Visual Basic for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When trying to use ODBC with Visual Basic for Windows to get table
information from an Oracle database, you may receive the following error
message:
<P>
<PRE>   An error has occurred in your application...

</PRE>When you choose the Close button, the following general protection (GP)
fault error message appears:
<P>
<PRE>   VB caused a GPF in module VBDB300.DLL at 000A:1B0F

</PRE>If you choose Ignore, your application may continue to run as expected.
<P>
<P><h2>CAUSE</h2>
 
<P>
It appears that this GP fault is caused within the file VBDB300.DLL by an
incompatibility with specific network configurations. However, neither
Microsoft nor Oracle have been able to duplicate this problem.
<P>
The problem has been reported to occur with both Oracle 6 and Oracle 7 on a
variety of network software with a variety of network protocols. There is
no one specific network or protocol that reproduces the problem.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The following workaround has been found to be successful if in addition to
Visual Basic, you also have both Microsoft Access version 2.0 and the
Microsoft Access 2.0/Visual Basic 3.0 Compatibility Layer installed:
<P>
In the VB.INI or &lt;appname&gt;.INI file (see page 148 of "Professional Features
book 2"), add the following to the [ODBC] section (create one if needed):
<P>
<PRE>   [ODBC]
   AttachableObjects='TABLE'

</PRE>For more information about this .INI file entry, please see the Help menu
in Microsoft Access version 2.0. Search for "INI Files," and select the
"Customizing MSACC20.INI Setting" topic.
<P>
For additional information about the Compatibility Layer and how to get it,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q113951.htm">Q113951</A></B>
   TITLE     : How to Obtain &amp; Distribute the Compatibility Layer

</PRE><h2>STATUS</h2>
 
<P>
This bug was corrected in Microsoft Visual Basic version 4.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
If you have a network configuration on which the problem does occur, the
following piece of code will demonstrate the problem:
<P>
<PRE>   Sub Command_Click()
      Dim db as Database
      Dim ds as Dynaset
      Set db = OpenDatabase("", 0, 0, "ODBC;")

      ' You will be prompted for the ODBC server information.
      Set ds = db.CreateDynaset("&lt;tablename&gt;")
      db.TableDefs.Refresh
   End Sub

</PRE>The error occurs on the last line of code where the Refresh is trying to
load the table information from the Oracle database into memory.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 gpfault buglist3.00 gpf fixlist4.00<BR>
KBCategory: kbprg kbbuglist kberrmsg<BR>
KBSubcategory: APrgDataODBC<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
