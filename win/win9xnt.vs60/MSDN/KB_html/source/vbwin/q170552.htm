

<HTML>
<HEAD>
<TITLE>HOWTO: Establish a One-to-Many Relation with a DBCombo </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170552">
<META NAME="KBModify" CONTENT="1997/12/12">
<META NAME="KBCreate" CONTENT="1997/06/24">
<META NAME="Keywords" CONTENT="VB4WIN vb5all vb5howto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Often it is desirable to have a DBCombo pick-list to allow users to choose a single data item and have a set of records from a different but related table display. Most often this scenario is based on two tables with a one- to-many relationship. Th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA5V,QA7N,QAY2,QBS0,QAB5,QAOE,QAMN,QBJZ,QAPN,QBWS,QAH4,QA2R,QA2Q,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Establish a One-to-Many Relation with a DBCombo</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170552</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Often it is desirable to have a DBCombo pick-list to allow users to choose
a single data item and have a set of records from a different but related
table display. Most often this scenario is based on two tables with a one-
to-many relationship. The DBCombo box lists records from the table on the
"one" side of the relationship and other controls show the records from the
table on the "many" side of the relationship.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A one-to-many relationship is based on a field that exists in both tables
in the relationship. The field in the one side of the relationship is a
unique field. The same field in the many side of the relationship can
contain duplicate values. Two Data controls should be used to coordinate
the two tables.
<P>
The DBCombo box must present records from the one side table using a field
that is easily interpreted by the user. Usually, the field presented to the
user is different than the field used in the relationship. That being the
case, after a selection is made in the DBCombo box the corresponding
relationship field or join field must be retrieved. The relationship field
from the current record selected in the DBCombo box can then be used to
filter the data from the many side table in the second data control using
an SQL "WHERE" clause in the RecordSource property of the data control.
<P>
<P><h3>Sample Program</h3>
 
<P>
This program uses the Biblio database's Titles and Publishers table to
illustrate creating a one-to-many relation with a DBCombo box. There is a
one-to-many relation between the Publishers and Titles tables in the Biblio
database joined on the PubID field. The DBCombo box shows a list of
possible Publishers' names and the DBGrid control displays the related
records on the many side of the relationship, namely the Titles table:

<OL><P><LI>Start Visual Basic, or, if it is already running, click New Project from
   the File menu.

<P><LI>Place the following objects on the Form1 form and set the appropriate
   properties:
<P>
<PRE>    Control           Name         Property          Value
    ------------------------------------------------------------------
    Data Control      Data1        DatabaseName      Biblio.mdb
                                   RecordSource      SELECT * FROM
                                                     [Publishers]
                                                     ORDER BY [Name];
    Data Control      Data2        DatabaseName      Biblio.mdb
                                   RecordSource      Titles
    DBCombo Box       DBCombo1     RowSource         Data1
                                   ListField         Name
                                   Style             2 - dbcDropdownList
    DBGrid Control    DBGrid1      DataSource        Data2

</PRE><P><LI>Copy and paste the following code to the Form1 Code Window:
<P>
<P><PRE>      Private Sub DBCombo1_Click(Area As Integer)
<PRE></PRE>        If Area = dbcAreaList Then 'User clicked item from the
           'combo list.
           'Move the data1 recordset to the currently selected
           'publisher's record.
          Data1.Recordset.Bookmark = DBCombo1.SelectedItem
           'Change the RecordSource property for the DBGrid to only
           'show records for the currently selected publisher.
          Data2.RecordSource = "SELECT * FROM [Titles] WHERE_
          [PubID] = " &amp; Data1.Recordset("PubID")
          Data2.Refresh
        End If
      End Sub

</PRE><P><LI>Press the F5 key to run the project or click Run Project from the
   Tools menu.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about database relationships, search for the keywords
"Relational Database Design" in the Microsoft Visual Basic 5.0 Books
Online.
 
<PRE>Keywords          : VB4WIN vb5all vb5howto
Version           : WINDOWS:4.0,5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
