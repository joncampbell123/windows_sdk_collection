

<HTML>
<HEAD>
<TITLE>Difference of WorkSpace in VB4 and SetDefaultWorkSpace in VB3 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147878">
<META NAME="KBModify" CONTENT="1996/03/05">
<META NAME="KBCreate" CONTENT="1996/03/01">
<META NAME="Keywords" CONTENT="kbprg kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  In Microsoft Visual Basic version 4.0 for Windows the DAO (Data Access Object) model was changed with the addition of WorkSpace objects. Thus you can now program the default Workspace(0) or work with multiple Workspaces. In Microsoft Visual Basic v...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAW6,QBWS,QA5F,QAMA,QAH4,QDL9,QBWQ,QBWO,QBWN,QABA,QBXS,QAYZ,QANF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Difference of WorkSpace in VB4 and SetDefaultWorkSpace in VB3</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147878</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   32-bit only, for Windows, version 4.0
</UL> 
<P>
SUMMARY
 
<P>
In Microsoft Visual Basic version 4.0 for Windows the DAO (Data Access
Object) model was changed with the addition of WorkSpace objects. Thus you
can now program the default Workspace(0) or work with multiple Workspaces.
In Microsoft Visual Basic version 3.0 for Windows, you were only allowed to
work with the default Workspace with the SetDefaultWorkSpace statement,
mostly used for security purposes. Now, with this new addition in Visual
Basic 4.0 you can use WorkSpace objects for improved Transaction support.
<P>
This article demonstrates how to use the new WorkSpace object in Visual
Basic 4.0 for Windows.
<P>
MORE INFORMATION
 
<P>
According to information from the Visual Basic Online Help, the description
of the WorkSpace Object is as follows:
<P>
A Workspace object defines a session for a user. It contains open databases
and provides mechanisms for simultaneous transactions and for a secure
workgroup. The Workspaces collection contains all active, unhidden
Workspace objects of the DBEngine object.
<P>
According to the Visual Basic Online help, you use the CreateWorkSpace
method to create a new Workspace object.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic or on the File menu, click New Project (ALT, F, N) if
   Visual Basic is already running. Form1 is created by default.

<P><LI>Add two Command buttons (Command1, and Command2) to Form1.

<P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Private Sub Command1_Click()
     Dim ws As Workspace
     Dim db As Database
     Dim tbl As Recordset
     Set ws = Workspaces(0)
     Set db = ws.OpenDatabase("biblio.mdb")
     Set tbl = db.OpenRecordset("titles", dbOpenTable)
     Do Until tbl.EOF
       Print tbl("title")
       tbl.MoveNext
     Loop
   End Sub

</PRE><P><LI>Add the following code to the Command2_Click event:
<P>
<PRE>   Private Sub Command2_Click()
     Dim NewSpace As Workspace
     DBEngine.IniPath = "C:\windows\vb.INI"
     Set NewSpace = DBEngine.CreateWorkspace("New", "Admin", "")
     DBEngine.Workspaces.Append NewSpace
   End Sub

</PRE><P><LI>On the Run menu, click Start (ALT, R, S), or press the F5 key to run the
   program. Click the Command1 button to open the default workspace similar
   to the Visual Basic 3.0 default workspace, then click the Command2
   button to create a new Workspace.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432<BR>
KBCategory: kbprg kbcode kbhowto<BR>
KBSubcategory: APrgDataODBC<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
