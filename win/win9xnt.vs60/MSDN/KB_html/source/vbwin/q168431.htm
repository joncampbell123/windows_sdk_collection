

<HTML>
<HEAD>
<TITLE>PRB: Launching VB5 ActiveX Documents from Internet Explorer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168431">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1997/05/12">
<META NAME="Keywords" CONTENT="AXSDKDocObjects vb5all kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When browsing to an ActiveX Document using Microsoft Internet Explorer, the document will fail to load the associated VBD file correctly. Instead, Microsoft Internet Explorer will display the following message:      Opening:               from     ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRJ,QBV9,QBWA,QBS0,QDNQ,QAA1,QAHV,QAFF,QBWS,QAPF,QABA,QDIY,QA2S,QAY2,QAW6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Launching VB5 ActiveX Documents from Internet Explorer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168431</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When browsing to an ActiveX Document using Microsoft Internet Explorer, the
document will fail to load the associated VBD file correctly. Instead,
Microsoft Internet Explorer will display the following message:
<P>
<PRE>   "Opening:
   &lt;filename&gt; from &lt;URL&gt;

   Some files can contain viruses or otherwise be harmful to your
   computer. It is important to be certain that this file is from a
   trustworthy source.

   What would you like to do with this file?"

</PRE>The user is presented with a choice of Opening or Saving the VBD file. If
the user selects Open, the Open With window is displayed asking which
application should launch the file. None of the applications listed,
including Microsoft Internet Explorer, will successfully launch the VBD
file.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Setup Wizard for Microsoft Visual Basic 5.0 creates a set of files to
be used for Internet download of ActiveX Documents. These files include a
cabinet (CAB), VBD, and a hypertext-markup HTM file.
<P>
Unfortunately, without changes to the HTM file, an ActiveX Document will
not launch correctly when a user browses to the HTM file using Microsoft
Internet Explorer 3.x.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Below is a sample of an original HTM file created using the Microsoft
Visual Basic 5.0 Setup Wizard. Following the example, is another sample
that shows a working HTM file.
<P>
<P><h3>Example 1 - Original HTM File</h3>
 
<P>
<PRE>   &lt;HTML&gt;
   &lt;OBJECT ID="SampleDoc1"
   CLASSID="CLSID:11111111-1111-1111-1111-111111111111"
   CODEBASE="Project1.CAB#version=1,0,0,0"&gt;
   &lt;/OBJECT&gt;

   &lt;SCRIPT LANGUAGE="VBScript"&gt;
   Sub Window_OnLoad
       Document.Open
       Document.Write "&lt;FRAMESET&gt;"
       Document.Write "&lt;FRAME src=""sampledoc1.vbd""&gt;"
       Document.Write "&lt;/FRAMESET&gt;"
       Document.Close
   End Sub
   &lt;/SCRIPT&gt;
   &lt;/HTML&gt;

</PRE><h3>Example 2 - Changed HTM File</h3>
 
<P>
<PRE>   &lt;HTML&gt;
   &lt;OBJECT ID="SampleDoc1"
   CLASSID="CLSID:11111111-1111-1111-1111-111111111111"
   CODEBASE="Project1.CAB#version=1,0,0,0"&gt;
   &lt;/OBJECT&gt;
   &lt;SCRIPT LANGUAGE="VBScript"&gt;
   Sub Window_OnLoad
       Location.href = "sampledoc1.vbd"
   End Sub
   &lt;/SCRIPT&gt;
   &lt;/HTML&gt;

</PRE>The changes to the Window_OnLoad procedure allow the VBD file to be
launched successfully, thus the ActiveX Document will initialize and
display within Microsoft Internet Explorer.
<P>
To convert an HTM file created with Setup Wizard, do the following:

<OL><P><LI>Make a copy of your original HTM file.

<P><LI>Open the Original HTM file into Notepad.

<P><LI>Remove the lines in the Window_OnLoad procedure. Make note of the VBD
   filename on the third line of the procedure.

<P><LI>Place the following code within the Window_OnLoad procedure:
<P>
<PRE>      Sub Window_OnLoad
          Location.href = "filename.vbd"
      End Sub

    where "FILENAME.VBD" must be replaced with the name of your VBD
    (including quotation marks).

</PRE><P><LI> Save the HTM file.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
 
<PRE>Keywords          : AXSDKDocObjects vb5all kbtool kbprb
Technology        : kbole kbInetDev
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
