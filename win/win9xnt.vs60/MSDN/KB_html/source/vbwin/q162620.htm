

<HTML>
<HEAD>
<TITLE>BUG: Setup Incorrectly Prompts to Overwrite Existing Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162620">
<META NAME="KBModify" CONTENT="1997/01/27">
<META NAME="KBCreate" CONTENT="1997/01/24">
<META NAME="Keywords" CONTENT="kbsetup kbtool kbbug">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you run Setup files that you created with the Visual Basic Application Setup Wizard, the following warnings appear:     Setup is about to replace a pre-existing file(s). This may cause loss of    data for an existing application.  followed by:...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBS0,QDI2,QASR,QBWS,QA36,QAUR,QAAP,QDIZ,QANE,QAJH,QAHD,QAEF,QA3A,QAYZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Setup Incorrectly Prompts to Overwrite Existing Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162620</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run Setup files that you created with the Visual Basic Application
Setup Wizard, the following warnings appear:
<P>
<PRE>   Setup is about to replace a pre-existing file(s). This may cause loss of
   data for an existing application.

</PRE>followed by:
<P>
<PRE>   Installing over an existing installation without first removing it may
   damage that installation or cause future attempts to remove the
   installation to fail.

</PRE>This warning occurs even when the files are marked as "shared" in the
Application Setup Wizard.
<P>
<P><h2>CAUSE</h2>
 
<P>
If a Template is defined in step 7 (the final step) of the Application
Setup Wizard the resulting .lst and .vbz are incorrect for system-shared
files that you added manually in step 7.
<P>
<P><h2>RESOLUTION</h2>
 

<OL><P><LI>Recreate your images without using your template and do not choose to
   save a template in step 7 of the Application Setup Wizard. Save the
   template in the Finish dialog box after the Application Setup Wizard
   has compressed all the files.
<P>
   -or-

<P><LI>Modify your existing .lst and .vbz files. In the .lst files, modify the
   7th field of the appropriate system file so it contains $(Shared). In
   the .vbz, modify the 7th field so it contains -1. For example, when the
   warning occurs referencing Mfcans32.dll, the .lst file looks like the
   following:
<P>
</OL>File5=1,,MFCANS32.DL_,MFCANS32.DLL,$(WinSysPath),,,6/21/1995,149504,3.2.0.0
<P>
<PRE>   and the .vbz file looks like:

</PRE></OL>File11=E:\vbtemp\MFCANS32.DLL,0,$(WinSysPath),,|32760|,-1,0,0,0,,,0
<P>
<PRE>   Modify the .lst file as follows:

</PRE>File5=1,,MFCANS32.DL_,MFCANS32.DLL,$(WinSysPath),,$(Shared),6/21/1995,14950
4,3.2.0.0
<P>
<PRE>   and change the .vbz entry to:

</PRE>File11=E:\vbtemp\MFCANS32.DLL,0,$(WinSysPath),,|32760|,-1,-1,0,0,,,0
<P>
<PRE>   The Template file (.vbz) should now be correct and generate correct
   images in the future.

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Visual Basic
version 4.0. Microsoft is researching this problem and will post new
information here as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When the Setup Wizard creates the template in step 7, it creates an
incorrect .lst and .vbz file for the current images and all future images
that use the template (.vbz).
<P>
Specifically, it does not mark the system files as Shared in the .lst and
.vbz files. Thus, when the Application Setup Wizard runs it does not
correctly overwrite the system files that are older and it prompts the user
with the warnings.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a simple application and build it into an .exe.

<P><LI>Start the Application Setup Wizard.

<P><LI>Point to the Visual Basic Application created in step 1.

<P><LI>Click Next until you arrive at step 3 and point it to an empty
    directory on your hard drive.

<P><LI>Click Next until you arrive at step 7 (the final step).

<P><LI>In step 7, click "Add Files...".

<P><LI>Select a system DLL, such as Mfcans32.dll from your \Windows\System32
    subdirectory, and then click OK.

<P><LI>Now Select the DLL that you just added in the list box and click "Files
    Details...".

<P><LI>Note that it says "Install as a Shared File." Click OK.

<P><LI>Click Save Template.

<P><LI>Name the template file and click Save.

<P><LI>Click Finish.

<P><LI>Edit the .vbz and the .lst. Note that it is incorrect.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbtool kbbug<BR>
KBSubcategory: TlsSetWiz SetIns<BR>
Additional reference words: 4.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
