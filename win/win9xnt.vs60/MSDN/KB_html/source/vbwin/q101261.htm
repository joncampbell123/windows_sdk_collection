

<HTML>
<HEAD>
<TITLE>UPD: Invalid file format Error When Run VB app's EXE File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101261">
<META NAME="KBModify" CONTENT="1997/09/17">
<META NAME="KBCreate" CONTENT="1993/07/08">
<META NAME="Keywords" CONTENT="PrgCtrlsStd kbbuglist kbfile kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You may encounter the following error when running a Visual Basic executable (EXE) file:     Invalid file format  Or you may encounter the following error when loading a Visual Basic project or form:     Error loading '               '. A control c...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QARR,QBWS,QAKP,QA5F,QAMA,QBJZ,QAC1,QAAP,QAUY,QAB4,QAVZ,QAMN,QAJ4,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>UPD: Invalid file format Error When Run VB app's EXE File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101261</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbfile kbfixlist kbbuglist
<P>
 
The information in this article applies to:
<P>
- The Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may encounter the following error when running a Visual Basic
executable (EXE) file:
<P>
<PRE>   Invalid file format

</PRE>Or you may encounter the following error when loading a Visual Basic
project or form:
<P>
<PRE>   Error loading '&lt;form filename&gt;'. A control could not be loaded due
   to a load error. Continue?

</PRE><h2>CAUSE</h2>
 
<P>
This problem will occur when you have installed a new version of a
custom control and the internal property list of the control has
incorrectly changed in a way that breaks backward compatibility.
<P>
This problem is known to occur when you have installed the Visual
Basic version 3.0 GRID.VBX file over an earlier version of the grid.
Specifically, the problem will occur for an existing Visual Basic
application, built using a previous version of the grid, that sets the
HelpContextID property of the grid.
<P>
In the case where the problem occurs when you load a project into
Visual Basic that contains a grid, the problem will only occur when
the form file(s) containing the grid have been saved in binary format.
<P>
This problem is also known to occur when using Visual Basic version
2.0 and the CMDIALOG.VBX control. For more information on this problem,
please see the following article in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A href="../vbwin/q100611.htm">Q100611</A></B>
<PRE>TITLE     : FIX: VB 2.0 Prof Demo Causes Error: Invalid File Format

</PRE><h2>WORKAROUND</h2>
 
<P>
There are several ways that you can work around this problem:
<P>
If you are using a Visual Basic version 3.0 application and you encounter
this problem, you can:

<UL><LI>Acquire an updated copy of GRID.VBX  from Microsoft (see instructions in
   the More Information section below).

<LI>Replace the Visual Basic version 3.0 of GRID.VBX with an earlier
   version. A disadvantage of this strategy is that applications requiring
   the Visual Basic version 3.0 grid will not run.
<P>
</UL>If you are a developer of a Visual Basic version 3.0 application that uses
the grid, you can:

<UL><LI>Acquire an updated copy of GRID.VBX  from Microsoft (see instructions in
   the More Information section below). You will need to build your
   application using this grid.

<LI>Rename GRID.VBX to a different name such as MSGRID3.VBX and rebuild the
   application using the renamed grid. A disadvantage of this strategy is
   that the grid will not be automatically updated when a new version of
   the grid (such as a version of the grid containing bug fixes) is
   released.
<P>
</UL>The following shows the date, time, size, and version number of the
GRID.VBX file that leads to this problem:
<P>
<PRE>  Date: 28-APR-1993
  Time: 12:00 a.m.
  Size: 44667
  Version: Not Marked

</PRE>The following shows the date, time, size, and version number of the
GRID.VBX file that fixes this problem:
<P>
<PRE>  Date: 15-JUNE-1993
  Time: 5:26 p.m.
  Size: 45136
  Version: 03.00.0538

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. The problem is corrected by the updated
version of GRID.VBX.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>How to Obtain Updated Copy of GRID.VBX</h3>
 
<P>
To obtain the updated copy of GRID.VBX, download VBGRID.EXE, a
self-extracting file, on these services:

<UL><LI>Microsoft's World Wide Web site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon
      Click Knowledge Base, and select the product
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/vbgrid.exe">VBGRID.EXE</A> <I>(size: 41336 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder
      Get <A href="http://support.microsoft.com/download/support/mslfiles/vbgrid.exe">VBGRID.EXE</A> <I>(size: 41336 bytes)</I> 
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location
      Type "mssupport" (without the quotation marks)
      Double-click the MS Software Library icon
      Find the appropriate product area
      Locate and Download VBGRID.EXE
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/vbgrid.exe">VBGRID.EXE</A> <I>(size: 41336 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>Add a Visual Basic version 1.0 or 2.0 version of GRID.VBX to Form1.

<P><LI>Put a grid control (Grid1) on Form1

<P><LI>Set the HelpContextID property of Grid1 to 1 (or some non-zero value).

<P><LI>From the File menu, choose Make EXE File (ALT, F, K) and create an EXE
   called PROJECT1.EXE.

<P><LI>Replace the older version of grid with the Visual Basic version 3.0
   version of GRID.VBX, which has a date and time of 28-APR-1993 12:00 am.

<P><LI>Run the PROJECT1.EXE file created in step 5.
<P>
</OL>You should encounter an "Invalid file format" error. If you replace the
Visual Basic version 3.0 grid with the version of the grid used in Step 2
and re-run PROJECT1.EXE, the program should run correctly.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 softlib update3.00 S14643<BR>
KBCategory: kbprg kbfile kbfixlist kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>
Keywords          : PrgCtrlsStd kbbuglist kbfile kbfixlist kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
