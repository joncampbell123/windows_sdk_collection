

<HTML>
<HEAD>
<TITLE>INFO: Troubleshooting Visual Basic Setup Wizard Issues </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182116">
<META NAME="KBModify" CONTENT="1998/03/09">
<META NAME="KBCreate" CONTENT="1998/03/05">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all vb5howto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The information included in this article provides some insight into preventing errors resulting from installing a Microsoft Visual Basic program using the Application Setup Wizard. The information in this article is divided into different areas tha...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBS0,QDI2,QDIR,QAJH,QAH6,QBVV,QA5F,QAMA,QBXS,QA7O,QAOE,QAMN,QAB5,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Troubleshooting Visual Basic Setup Wizard Issues</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182116</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions
   for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The information included in this article provides some insight into
preventing errors resulting from installing a Microsoft Visual Basic
program using the Application Setup Wizard. The information in this article
is divided into different areas that need to be considered before deploying
an application: Environment, Operating System, Installed Applications of
the Development Machine, and Third-Party Controls.
<P>
NOTE: This article does not cover specific issues using the Application
Setup Wizard to create Internet Component Download distribution sets.
Although the information may be helpful in the creation of such
distribution sets, this article is intended for standard application
deployment.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Environment</h3>
 
<P>
When developing an application, the development machine needs to stay free
of any external applications or Internet downloaded components that are not
specifically necessary for the development of the application. For example,
beta software should not be used because it is possible that beta
components may be included when you create the application distribution
set.
<P>
Another area that can affect the development environment is the browsing of
the Internet on the development machine. Depending on the security level of
your browser software, some sites can download new components and install
them. This may not affect the development of the application but, when
creating the application distribution set, may cause unknown file versions
and/or non-redistributable files to be included with your application. The
preferred method of avoiding this problem is to not use your development
machine for browsing the Internet. If this is not possible, consult your
Internet browser's documentation for instructions on how to avoid
downloading components or how to successfully uninstall components after
they have been installed.
<P>
Please refer to the "Application Distribution Set Methodology" section
later in this article before using the Setup Wizard to build the
application distribution set.
<P>
<P><h3>Operating System</h3>
 
<P>
If possible, develop the application on the same operating system the
target machine will use. This will ensure that operating specific versions
of the supporting files are similar in the development and target
environment. Also, service packs often fix many known problems with the
operating systems and, with some operating systems, a certain Service Pack
release is required to install a Visual Basic application. The latest
Service Packs can be found at the following location:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/downloads/default.asp">http://support.microsoft.com/support/downloads/default.asp</A></B>

</PRE><h3>Applications Installed on Development Machine</h3>
 
<P>
Applications installed on the development machine may affect the Setup
Wizard in many ways. For instance, the presence of Microsoft Office 97 may
have newer versions of some files and have additional controls that did not
ship with Visual Basic. Once again, it is best to keep the development
machine as clean as possible so as not to introduce any component that can
alter the Visual Basic environment.
<P>
For the most part, having multiple versions of Visual Basic on the same
machine does not alter the development environment. With the Setup Wizard,
however, having multiple versions can cause the application to not install
correctly due to newer versions of components and the inability of the
Setup Wizard to correctly determine dependency information and/or register
these components. To ensure a good distribution of the application, the
development machine should have only one version of Visual Basic installed.
<P>
Again, please refer to the "Application Distribution Set Methodology"
section of this article before using the Setup Wizard to build the
application distribution set.
<P>
<P><h3>Third-party Controls</h3>
 
<P>
Third-party controls are controls that do not ship with Visual Basic and
are supplied by a third-party vendor. These controls can be incompatible
with other pieces of the application or even the operating system itself.
If you suspect a third-party control may be causing a problem with your
distribution set, you should create a test setup using the Setup Wizard for
a very simple application (the Calc.vbp sample project that comes with
Visual Basic is a good sample application). Create a distribution set using
the Setup Wizard for a sample application such as Calc.vbp. If this setup
is successful, begin eliminating the third-party controls from the original
setup one-by-one and re-test. This helps you decide if a control is causing
the problem. If you identify a control that is causing the problem, contact
the vendor to for additional information regarding the control.
<P>
<P><h3>Application Distribution Set Methodology</h3>
 
<P>
The information below lists the ideal way to create a setup routine for
your Visual Basic application. It is meant to be used as a guideline for
setting up a clean environment for creating trouble-free application
distribution sets and is not intended to be used as a step-by-step example.

<OL><P><LI>Use a clean development machine that has as little as possible
   installed. A clean installation of the Windows operating system plus
   Visual Basic and AntiVirus software would be the ideal environment.

<P><LI>In an ideal environment, the development machine should have the same
   version of Windows (95 or NT) as the target machines. This may not be
   possible due to differences on the target machines. Use the operating
   system that is the  most common among your target machines.

<P><LI>Install the latest Service Pack updates for both the operating system
   and for Visual Basic to ensure you are using the most up to date files
   available.

<P><LI>Using AntiVirus software, check the machine for all known viruses. This
   ensures that you will not be distributing a virus to your target
   users.

<P><LI>Test the application using the Visual Basic IDE, ensuring all components
   of the application work as designed.

<P><LI>Run the Setup Wizard on your project to create the necessary
   distribution files.

<P><LI>Test the application on the development machine by installing the
   application and ensuring all components of the application work as
   intended.

<P><LI>Again, use AntiVirus software to check the machine.

<P><LI>Test the installation on a target machine. Testing on more than
   one target machine can also help identify issues before the application
   is deployed to clients.
<P>
   This should lead to a resolution of most issues dealing with the
   installation of a custom application using the Setup Wizard. If the
   above information does not lead to a resolution, please check the
   Microsoft Knowledge Base for any known issues or contact Microsoft
   Technical Support for help resolving the issue. The Microsoft Knowledge
   base can be accessed directly from the Internet using the following URL:
<P>
<P><PRE>      <B><A href="http://support.microsoft.com/support">http://support.microsoft.com/support</A></B>
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q161344.htm">Q161344</A></B>
   TITLE     : INFO: Visual Basic 4.0 and Visual Basic 5.0 Compatibility

   ARTICLE-ID: <B><A href="../vbwin/q174135.htm">Q174135</A></B>
   TITLE     : INFO: Setup Cannot Continue...System Files Are Out of Date

   ARTICLE-ID: <B><A href="../vbwin/q162518.htm">Q162518</A></B>
   TITLE     : PRB: "Unexpected error; quitting" Installing VB4 Application

   ARTICLE-ID: <B><A href="../vbwin/q178354.htm">Q178354</A></B>
   TITLE     : HOWTO: Setup Wizard Dependency Files

   ARTICLE-ID: <B><A href="../vstudio/q164529.htm">Q164529</A></B>
   TITLE     : FILE: Updated Automation System Files

   ARTICLE-ID: <B><A href="../vbwin/q180071.htm">Q180071</A></B>
   TITLE     : FILE: MSVBVM50.EXE Installs Visual Basic 5.0 Run-time Files
</PRE></OL> 
<PRE>Keywords          : VB4ALL VB4WIN vb5all vb5howto
Version           : WINDOWS:4.0,5.0
Platform          : WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
