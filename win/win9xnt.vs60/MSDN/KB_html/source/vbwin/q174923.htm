

<HTML>
<HEAD>
<TITLE>HOWTO: Use the PostData Parameter in WebBrowser Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174923">
<META NAME="KBModify" CONTENT="1998/01/16">
<META NAME="KBCreate" CONTENT="1997/10/09">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all vb5howto AXSDK">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The WebBrowser control has a Navigate method with PostData as a parameter. This allows the user to post data to the specified URL with the WebBrowser control.  MORE INFORMATION  Navigate specifications:     Navigates to the resource identified by a...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALZ,QBS0,QAHE,QBBI,QAMN,QA7O,QAOE,QAB5,QDOT,QANF,QAYY,QAFZ,QA3N,QATX,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Use the PostData Parameter in WebBrowser Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174923</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation and Enterprise Editions for
   Windows, version 5.0
<LI>Microsoft Visual Basic Enterprise Edition, 16-bit and 32-bit, for
   Windows, version 4.0
<LI>Microsoft ActiveX SDK, version 1.0
   on the following platforms: NT, Win95, x86
<LI>Internet Explorer, versions 3.0, 3.01, 3.02, 4.0, 4.01
<LI>Internet Client SDK, version 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The WebBrowser control has a Navigate method with PostData as a parameter.
This allows the user to post data to the specified URL with the WebBrowser
control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Navigate specifications:
<P>
<PRE>   Navigates to the resource identified by a Universal Resource Locator
   (URL), or to the file identified by a full path.

</PRE>Syntax:
<P>
<PRE>   object.Navigate URL [Flags,] [TargetFrameName,] [PostData,] [Headers]

</PRE>PostData Optional:
<P>
Data to send to the server during the HTTP POST transaction. For example,
the POST transaction is used to send data gathered by an HTML form. If this
parameter does not specify any post data, the Navigate method issues an
HTTP GET transaction. This parameter is ignored if URL is not an HTTP URL.
<P>
NOTE: The post data specified by PostData is passed as a SAFEARRAY
structure. The variant should be of type VT_ARRAY and point to a SAFEARRAY.
The SAFEARRAY should be of element type VT_UI1, dimension one, and have an
element count equal to the number of bytes of post data.
<P>
Sample to PostData to URL server
 

<OL><P><LI>Start Visual Basic. If Visual Basic is already running, choose New
   Project from the File menu (ALT, F, N). Form1 is created by default.

<P><LI>Add a WebBrowser control (WebBrowser1) to Form1.

<P><LI>Add a CommandButton (Command1) to Form1.

<P><LI>Add the following code to the Command1_Click event of Form1:
<P>
<PRE>      Sub Command1_Click()
         Dim URL As String
         Dim Flags As Long
         Dim TargetFrame As String
         Dim PostData() As Byte
         Dim Headers As String

         URL = "<B>http://YourServer</B>" ' A URL that will accept a POST
         Flags = 0
         TargetFrame = ""

         PostData = "Information sent to host"

         ' VB creates a Unicode string by default so we need to
         ' convert it back to Single byte character set.
         PostData = StrConv(PostData, vbFromUnicode)

         Headers = ""

         WebBrowser1.Navigate URL, Flags, TargetFrame, PostData, Headers
      End Sub

</PRE><P><LI>Press the F5 key to run the program and the information in the PostData
   variable will be sent to the server specified in the URL parameter.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: POST Navigate<BR>
Keywords          : VB4ALL VB4WIN vb5all vb5howto AXSDK<BR>
Technology        : internet kbinetdev<BR>
Version           : WINDOWS:1.0,3.0, 3.01,3.02,4.0,4.01,5.0<BR>
Platform          : NT Win95 WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 16, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
