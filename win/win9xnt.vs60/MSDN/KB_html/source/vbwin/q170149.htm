

<HTML>
<HEAD>
<TITLE>PRB: Recordset Name Property is Limited to 256 Characters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170149">
<META NAME="KBModify" CONTENT="1997/07/14">
<META NAME="KBCreate" CONTENT="1997/06/16">
<META NAME="Keywords" CONTENT="kberrmsg vb4all vb4win vb5all VBKBDAO VBKBDB VBKBJet VBKBObj">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Name property of a DAO Recordset object is limited to 256 characters. It only reports the first 256 characters of the SQL statement used to create the new Recordset. If the SQL statement is longer than 256 characters, and you refresh the Data C...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QAPN,QBS0,QALS,QAVT,QARM,QAC2,QBWD,QAH4,QAAP,QAB4,QBXS,QABM,QAR5,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Recordset Name Property is Limited to 256 Characters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170149</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Name property of a DAO Recordset object is limited to 256 characters.
It only reports the first 256 characters of the SQL statement used to
create the new Recordset. If the SQL statement is longer than 256
characters, and you refresh the Data Control in the code later on, you will
receive one of the following errors:
<P>
<PRE>   "Run-time error '3061': Too few parameters. Expected 1."

   "Run-time error '3075': Syntax error in string in query expression
   'xxxx'."

</PRE><h2>CAUSE</h2>
 
<P>
When you set the Data Control's Recordset property to an existing
Recordset, it obtains its RecordSource property from the DAO Recordset's
Name property, which allows a maximum length of 256 characters.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Store the SQL statement into a string variable. Before refreshing the Data
Control, set its RecordSource Property to this variable. For example:
<P>
<PRE>   Data1.RecordSource = SQLStr
   Data1.Refresh

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a Data Control(Data1) and a CommandButton (Command1) to Form1.

<P><LI>In the Click event of Command1, place the following code:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>        Dim DB As Database, RS As Recordset
        Dim SQLStr As String

        Set DB = DBEngine.Workspaces(0).OpenDatabase("Biblio.MDB")

        'This SQL Statement cause Run-time error 3075.
        SQLStr = "Select PubID, Name, [Company Name], Address, " _
         &amp; "City, State, PubID, Name, [Company Name], Address, City, " _
         &amp; "State, PubID, Name, [Company Name], Address, City, State, " _
         &amp; "PubID, Name, [Company Name], Address, City, State " _
         &amp; "from Publishers Where PubID = 2 and State = 'MA'"

        'This SQL Statement cause Run-time error 3061.
        'SQLStr = "Select PubID, Name, [Company Name], Address, City, " _
        ' &amp; "State, PubID, Name, [Company Name], Address, City, State, " _
        ' &amp; "PubID, Name, [Company Name], Address, City, State, " _
        ' &amp; "PubID, Name, [Company Name], Address, City, State, " _
        ' &amp; "PubID from Publishers Where PubID = 2 and State = 'MA'"

        Set RS = DB.OpenRecordset(SQLStr, dbOpenDynaset)
        Set Data1.Recordset = RS
        Debug.Print RS.Name
        Debug.Print Data1.RecordSource
        Data1.Refresh

      End Sub

</PRE><P><LI>Start the program by pressing the F5 key.

<P><LI>Click the Command1 button to execute the code. You will receive one of
   the errors listed above.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg vb4all vb4win vb5all VBKBDAO VBKBDB VBKBJet VBKBObj<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
