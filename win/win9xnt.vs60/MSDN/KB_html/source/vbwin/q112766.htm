

<HTML>
<HEAD>
<TITLE>How To Get the Total Playing Time of an Audio CD </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112766">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/03/20">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The MultiMedia Application Programming Interface (API) and the MCI Control have built-in methods that retrieve the total playing time of a CD. The Length property of the MCI Control will retrieve total playing time of the current media.  MORE INFOR...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWH,QANY,QADP,QACE,QAGF,QAU3,QAMR,QAH4,QAFH,QBS0,QAE5,QAYS,QAIJ,QBWS,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Get the Total Playing Time of an Audio CD</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112766</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The MultiMedia Application Programming Interface (API) and the MCI Control
have built-in methods that retrieve the total playing time of a CD. The
Length property of the MCI Control will retrieve total playing time of
the current media.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
After setting the MCI Control's TimeFormat property to MCI_FORMAT_TMSF(10)
and summing the values returned by the DateAdd function to add the total
time values for minutes and seconds together, you can calculate a CD's
total playing time.
<P>
DateAdd starts adding from 12:00:00 AM, so you need to check to see if the
total time is less than one hour. If it is, strip off the first three
characters (12:) and the AM. If the time is greater than one hour, strip
off the AM so that the return value looks like this:
<P>
1:09:43

<UL><LI>or -
<P>
</UL>57:45
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a text box (Text1) and an MCI Control (MMControl1) to Form1.

<P><LI>Place the following code in the Form_Load event of Form1:
<P>
<PRE>   Sub Form_Load ()
      ' Initialize the CD:
      mmcontrol1.TimeFormat = 10
      mmcontrol1.DeviceType = "CDAudio"
      mmcontrol1.Command = "Open"
      ' Dimension variables:
      Dim Length As Variant
      Dim CDSeconds As Integer, CDMinutes As Integer
      ' Calculate minutes and seconds:
      CDSeconds = CDSeconds + (mmcontrol1.Length And &amp;HFF00&amp;) / &amp;H100
      CDMinutes = CDMinutes + (mmcontrol1.Length And &amp;HFF)
      ' Sum minutes and seconds:
      Length = DateAdd("s", CDSeconds, Length) ' Add Seconds
      Length = DateAdd("n", CDMinutes, Length) ' Add Minutes
      ' Determine if total running time is less than one hour:
      If (Left$(Length, 2)) = "12" Then ' Less than 1 hour
         Text1.Text = Mid(Length, 4, (Len(Length) - 4))
      Else ' Greater than 1 hour:
         Text1.Text = Left(Length, (Len(Length) - 3))
      End If
   End Sub

</PRE><P><LI>Run the program. You should see the total playing displayed in the
   Text1 box.
<P>
</OL>NOTE: Before starting this program, a CD must be inserted and ready to
play. Therefore, you should add code to detect when a CD has been inserted
and then run the above code.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, see the Multimedia Programmer's Reference, CDAudio
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
