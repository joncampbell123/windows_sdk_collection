

<HTML>
<HEAD>
<TITLE>PRB: Known16dll Key Entry Changes Normal DLL Search Path </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149430">
<META NAME="KBModify" CONTENT="1996/05/22">
<META NAME="KBCreate" CONTENT="1996/04/02">
<META NAME="Keywords" CONTENT="kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A Visual Basic program may not run under Windows 95 because a 16-bit DLL that has been listed in the registry as a Known16dll has been moved from the Windows\System directory.  CAUSE =====  The Registry has a Known16dll key entry for a DLL that has...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QAFI,QBXB,QATJ,QBS0,QDNN,QAN1,QABA,QAGQ,QAEF,QDNF,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Known16dll Key Entry Changes Normal DLL Search Path</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 22, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149430</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional, and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
<LI>Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A Visual Basic program may not run under Windows 95 because a 16-bit DLL
that has been listed in the registry as a Known16dll has been moved from
the Windows\System directory.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Registry has a Known16dll key entry for a DLL that has previously been
loaded. If there is an entry in this key for a specific DLL then Windows
will look for the DLL file in the Windows\System directory first and then
follow the normal DLL search path. If this DLL has been moved to another
location, the key entry will still be in the registry. This could cause the
wrong version of a DLL to be used.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use RegEdit to find and delete the Known16dll entry for this DLL. Windows
95 will now search for the DLL in the normal way. Once Windows 95 finds
loads the DLL, a new Known16dll key entry is made in the registry.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The registry key Known16dlls is located in the following section of the
registry:
<P>
<PRE>   \\HKEY_LOCAL_MACHINE
        System
           CurrentControlSet
              Control
                 SessionManager

</PRE>If there is an entry in the Known16dll key for a DLL that a Visual Basic
program requires , Windows 95 will first look in the Windows\System
directory, AND then follow the normal search path below.
<P>
<P><h3>Under Win16</h3>
 

<OL><P><LI>The current directory.

<P><LI>The Windows directory.

<P><LI>The Windows system directory.

<P><LI>The directory containing the executable file for the current task.

<P><LI>The directories listed in the PATH environment variable.

<P><LI>The list of directories mapped in a network
<P>
</OL>If the DLL is moved from the Windows\System directory to a new location,
the Known16dll key is not deleted; because of this, Windows will continue
to look for the DLL in the Windows\System directory first.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprb<BR>
KBSubcategory: EnvtRun
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 22, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
