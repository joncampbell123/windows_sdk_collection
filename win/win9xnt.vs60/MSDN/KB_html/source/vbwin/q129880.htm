

<HTML>
<HEAD>
<TITLE>PRB: No Error On Invalid SetDefaultWorkspace in VB 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129880">
<META NAME="KBModify" CONTENT="1996/04/16">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Executing the SetDefaultWorkspace command with invalid parameters does not generate any error until a Database is opened or a Workspace is created. However, in Visual Basic version 3.0, this error is generated by the SetDefaultWorkspace statement. ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA1S,QDKY,QAAP,QAPN,QAB4,QAZV,QAH4,QA5F,QAMA,QAK7,QBXS,QACI,QBWS,QAVY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: No Error On Invalid SetDefaultWorkspace in VB 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129880</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit and 32-bit, for Windows, version 4.0
<LI>Professional Edition of Microsoft Visual Basic for Windows,
   version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Executing the SetDefaultWorkspace command with invalid parameters does not
generate any error until a Database is opened or a Workspace is created.
However, in Visual Basic version 3.0, this error is generated by the
SetDefaultWorkspace statement.
<P>
The SetDefaultWorkspace statement establishes the user ID and password for
protected (security-enabled) Microsoft Jet databases. If you aren't using a
protected database, this statement is ignored.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Visual Basic version 3.0, the SetDefaultWorkspace command immediately
attempted to verify the parameters passed to it for the current session. In
Visual Basic 4.0, the Username and Password parameters passed to the
SetDefaultWorkspace statement set properties on the DBEngine object. These
properties are not applied until a Workspace is created or a Database is
opened.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The SetDefaultWorkspace statement is included in Visual Basic version 4.0
for compatibility with earlier versions. For Visual Basic version 4.0
applications, Microsoft recommends that you use the properties of the
Workspace object instead. See the "Example Resolution" section near the end
of this article for an example.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
To reproduce the SetDefaultWorkspace error, you must have a password
protected Microsoft Access database. Visual Basic version 4.0 does not ship
with a secure database. If you have Microsoft Access, you can add security
to a database by opening the database and choosing Change Password from the
Security menu.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the Form1_Click event procedure:
<P>
<PRE>   Sub Form1_Load ()
      Dim DB As Database
      SetDefaultWorkspace "Admin", "WrongPassword"
      ' VB3: Error occurs on SetDefaultWorkspace
      Set DB = OpenDatabase("MyDB.MDB")
      ' Insert the name of a secured Microsoft Access database in
      ' the line above.
   End Sub

</PRE><P><LI>Start the program by choosing Start from the Run menu or by pressing the
   F5 key.
<P>
</OL>In Visual Basic version 3.0, this will generate an immediate error on the
SetDefaultWorkspace statement because there is no existing System.MDA.
<P>
In Visual Basic version 4.0, the error does not occur until you attempt to
open a secure database. Replace the above code with the following. Note: to
run this sample you must have the Microsoft DAO 2.5/3.0 Compatibility
Library selected in the Tools References dialog.
<P>
<PRE>   Sub Form1_Load ()
      Dim DB As Database
      SetDefaultWorkspace "Admin", "WrongPassword"
      Set DB = DBEngine.Workspaces.OpenDatabase("MyDB.MDB")
      ' Insert the name of a secured Microsoft Access database
      ' in the line above.
      ' VB4: Error occurs on OpenDatabase.
   End Sub

</PRE></OL><h3>Example Resolution</h3>
 
<P>
The implication here is that you may need to move your error trapping code
if you are currently trapping for errors on the SetDefaultWorkspace
statement.
<P>
To update your code to use the correct Microsoft DAO 3.0 syntax, replace
the above version 4.0 example with the following:
<P>
<PRE>   Sub Form1_Click()
      Dim WS As WorkSpace
      Dim DB As Database
      DBEngine.DefaultUser = "Admin"
      DBEngine.DefaultPassword = "WrongPassword"
      Set WS = DBEngine.CreateWorkSpace("WS")
      Set DB = WS.Opendatabase("MyDB.MDB")
      ' Insert the name of a secured Microsoft Access database in the
      ' line above.
   End Sub

</PRE>Error trapping may have to be moved in order to accommodate the multiple
Workspace capability of Visual Basic version 4.0. Error trapping should be
set up to trap on the Opendatabase or CreateWorkspace methods.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
