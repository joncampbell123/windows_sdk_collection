

<HTML>
<HEAD>
<TITLE>PRB: MSFlexGrid Doesn't Return All Rows w/UseODBC Data Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171952">
<META NAME="KBModify" CONTENT="1997/08/04">
<META NAME="KBCreate" CONTENT="1997/07/25">
<META NAME="Keywords" CONTENT="vb5all VBKBAX VBKBComp VBKBCtrl VBKBDB VBKBInt VBKBStd">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The MSFlexGrid control does not return all rows when bound to a Data control whose DefaultType is UseODBC.  RESOLUTION  All of the following are possible workarounds:   - Change the DefaultType property of the Data control to UseJet.   - Replace th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QBS0,QA5V,QAUD,QAYY,QAPN,QBWQ,QAHV,QAKC,QBWS,QBC6,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: MSFlexGrid Doesn't Return All Rows w/UseODBC Data Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171952</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
   on the following platforms: NT, Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The MSFlexGrid control does not return all rows when bound to a Data
control whose DefaultType is UseODBC.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
All of the following are possible workarounds:

<UL><LI>Change the DefaultType property of the Data control to UseJet.

<LI>Replace the Data control with the Remote Data Control.

<LI>Replace the MSFlexGrid control with the DBGrid control.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DefaultType property of the Data control is new to Visual Basic 5.0.
It determines what type of data source (Jet or ODBCDirect) to use when
creating a Recordset.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Visual Basic and create a Standard EXE. Form1 is added by
   default.

<P><LI>Bring up the Components dialog window by selecting the menu item
   Project/Components. Select "Microsoft FlexGrid Control 5.0" and
   click OK.

<P><LI>Add a MSFlexGrid control (MSFlexGrid1) and a Data control (Data1)
   to Form1.

<P><LI>Set the DefaultType property of Data1 to UseODBC.

<P><LI>Set the DataSource property of MSFlexGrid1 to Data1.

<P><LI>Add the following lines of code to the Load event of Form1:
<P>
<P><PRE>      'Replace MY_SERVER with an appropriate SQL pubs database DSN.
      Data1.Connect = "ODBC;DSN=MY_SERVER;UID=SA;PWD="
      Data1.RecordSource = "SELECT * FROM TITLES"
      Data1.Refresh
</PRE><P>
<P><PRE>      'Number of rows in the Recordset.
      MsgBox Data1.Recordset.RecordCount
</PRE><P>
<P><PRE>      'Number of rows in MSFlexGrid1 excluding the title row.
      MsgBox MSFlexGrid1.Rows - 1
</PRE>
<P><LI>Press the F5 key to run the project and note the discrepancy in the
   numbers displayed.
</OL> 
<PRE>Keywords          : vb5all VBKBAX VBKBComp VBKBCtrl VBKBDB VBKBInt VBKBStd
Version           : 5.0
Platform          : NT Win95 WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
