

<HTML>
<HEAD>
<TITLE>VB3 How to Associate a File Extension with Your Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119281">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1994/08/11">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If your application makes use of data files and processes command-line arguments, you may want to associate the extension of your application's data file with your executable program name by modifying the REG.DAT file.  MORE INFORMATION  You can ma...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QBWS,QBWO,QBJZ,QBWP,QAJH,QDL9,QBWQ,QBWN,QAY2,QAGI,QAB9,QBV8,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 How to Associate a File Extension with Your Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119281</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0 and 3.0
<LI>Microsoft Visual Basic Programming System for Windows, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If your application makes use of data files and processes command-line
arguments, you may want to associate the extension of your application's
data file with your executable program name by modifying the REG.DAT file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can make modifications to the REG.DAT file by calling the RegCreateKey&amp;
and RegSetValue&amp; application programming interface (API) functions.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start Visual Basic for Windows. If Visual Basic is already running,
   choose New Project from the File menu (ALT+F, N). Form1 is created by
   default.

<P><LI>Add the following code to the general declarations section of Form1,
   taking care to enter each Declare statement on one single line:
<P>
<PRE>   Declare Function RegCreateKey&amp; Lib "SHELL.DLL" (ByVal hKey&amp;, ByVal
   lpszSubKey$, lphKey&amp;)

   Declare Function RegSetValue&amp; Lib "SHELL.DLL" (ByVal hKey&amp;, ByVal
   lpszSubKey$, ByVal fdwType&amp;, ByVal lpszValue$, ByVal dwLength&amp;)

   ' Return codes from Registration functions.
   Const ERROR_SUCCESS = 0&amp;
   Const ERROR_BADDB = 1&amp;
   Const ERROR_BADKEY = 2&amp;
   Const ERROR_CANTOPEN = 3&amp;
   Const ERROR_CANTREAD = 4&amp;
   Const ERROR_CANTWRITE = 5&amp;
   Const ERROR_OUTOFMEMORY = 6&amp;
   Const ERROR_INVALID_PARAMETER = 7&amp;
   Const ERROR_ACCESS_DENIED = 8&amp;

   Const HKEY_CLASSES_ROOT = 1
   Const MAX_PATH = 256&amp;
   Const REG_SZ = 1

</PRE><P><LI>Place the following code in the Form_Click event of Form1:
<P>
<PRE>   Sub Form_Click ()

     Dim sKeyName As String   'Holds Key Name in registry.
     Dim sKeyValue As String  'Holds Key Value in registry.
     Dim ret&amp;                 'Holds error status if any from API calls.
     Dim lphKey&amp;              'Holds created key handle from RegCreateKey.

     'This creates a Root entry called "MyApp".
     sKeyName = "MyApp"
     sKeyValue = "My Application"
     ret&amp; = RegCreateKey&amp;(HKEY_CLASSES_ROOT, sKeyName, lphKey&amp;)
     ret&amp; = RegSetValue&amp;(lphKey&amp;, "", REG_SZ, sKeyValue, 0&amp;)

     'This creates a Root entry called .BAR associated with "MyApp".
     sKeyName = ".bar"
     sKeyValue = "MyApp"
     ret&amp; = RegCreateKey&amp;(HKEY_CLASSES_ROOT, sKeyName, lphKey&amp;)
     ret&amp; = RegSetValue&amp;(lphKey&amp;, "", REG_SZ, sKeyValue, 0&amp;)

     'This sets the command line for "MyApp".
     sKeyName = "MyApp"
     sKeyValue = "c:\mydir\my.exe %1"
     ret&amp; = RegCreateKey&amp;(HKEY_CLASSES_ROOT, sKeyName, lphKey&amp;)
     ret&amp; = RegSetValue&amp;(lphKey&amp;, "shell\open\command", REG_SZ, sKeyValue,
    MAX_PATH)

   End Sub

</PRE><P><LI>Press ALT+F, V to save the project. Then press F5 to run the
   program. Click once on the form and exit the application.

<P><LI>If you are running Windows version 3.1 or Windows for Workgroups, choose
   Run from the File menu (Alt+F, R) in Program Manager and then type
   "REGEDIT /V" (without the quotes) to run the registration database
   editor. When examining the REG.DAT, you will see the following entries:
<P>
<P><PRE>      .bar = MyApp
      MyApp = My Application
<PRE></PRE>        |
         -- Shell
              |
               -- open
                    |
                     -- command = c:\mydir\my.exe %1

   If you are running Windows NT, choose File Run (Alt+F, R) on the Program
   Manager and type "REGEDT32". This will run the registration database
   editor for Windows NT. The .BAR and MyApp entries can be found under
   the HKEY_CLASSES_ROOT on your local machine.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgOther<BR>
Additional reference words: 1.00 2.00 3.00 vb3only<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
