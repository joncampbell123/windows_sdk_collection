

<HTML>
<HEAD>
<TITLE>VB3 Keeping the Current Record the Same After Using Refresh </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97181 ">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1993/04/11">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  In Visual Basic version 3.0 for Windows, when the Refresh method updates the recordset for a data control, it recreates the recordset and resets the current record. This invalidates all existing bookmarks for that recordset. This behavior is by des...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBS0,QAXB,QAPN,QA7O,QBT6,QAN0,QBV4,QA62,QAC1,QBXS,QAMN,QBSO,QAHP,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 Keeping the Current Record the Same After Using Refresh</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97181 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Visual Basic version 3.0 for Windows, when the Refresh method
updates the recordset for a data control, it recreates the
recordset and resets the current record. This invalidates all
existing bookmarks for that recordset. This behavior is by
design. It is not a Visual Basic bug but rather a design feature
of the data control.
<P>
However, this behavior may be undesirable if you want to
refresh the recordset and maintain the current record. This
article explains how to restore the current record after
executing the Refresh method.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Although there is no simple way to retain the current record after
executing the Refresh method, you can restore the current record.
To do so, store unique field data for the current record. Then
use the stored field data to execute the Refresh method followed
by the FindFirst method. The FindFirst method uses the stored
field data to restore the current record.
<P>
The following steps demonstrate how to restore the current record
after executing the Refresh method:

<OL><P><LI>Start Visual Basic, or from the File menu, choose New Project
   (ALT, F, N) if Visual Basic is already running. Form1 is
   created by default.

<P><LI>Put a data control (Data1) on Form1.

<P><LI>Set the DatabaseName property for Data1 to &lt;path name&gt;BIBLIO.MDB
   where &lt;path name&gt; represents the full path to the Visual Basic
   BIBLIO.MDB sample database.

<P><LI>Set the RecordSource property of Data1 to Authors, which is the
   name of the table in the BIBLIO.MDB database.

<P><LI>Put a Text box (Text1) on Form1

<P><LI>Set the DataSource property of Text1 to Data1

<P><LI>Set the DataField property of Text1 to Author, which is the name
   of the field (column) in the Authors table.

<P><LI>Put a command button (Command1) on Form1

<P><LI>Change the Caption property of Command1 to Refresh.

<P><LI>Add the following code to the Command1_Click event
<P>
<P><PRE>    Sub Command1_Click ()
</PRE><P>
<P><PRE>       Dim CurrRec As Variant
</PRE><P>
<P><PRE>       'Hide the text box and emulate it by drawing a border
       text1.Visible = False
       Line (text1.Left, text1.Top)-(text1.Left + text1.Width,
<PRE></PRE>                text1.Top + text1.Height), , B

       'Store the value of a unique field for the current record
       CurrRec = Data1.RecordSet!Au_ID

       'Update the RecordSet
       Data1.Refresh

       'Restore the current record by using the stored field value
       'to find
       Data1.RecordSet.FindFirst "Au_ID = " &amp; CurrRec

       text1.Visible = True

    End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) or press the F5 key
<P><PRE>    to run the program.
</PRE>
<P><LI>Using the data control, move to the next record. You should see
<P><PRE>    "Atre, Shaku" displayed in the text box
</PRE>
<P><LI>Using the data control, move further into the file. To do this,
<P><PRE>    click the right arrow or click the rightmost button -- the one
    with the arrow and bar -- to move to the end of the file.
</PRE>
<P><LI>Click the Refresh button. The name of the first author in the
<P><PRE>    recordset is displayed in Text1 for an instant. Then the
    current author is redisplayed.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgDataAcc<BR>
Additional reference words: 3.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
