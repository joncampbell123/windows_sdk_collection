

<HTML>
<HEAD>
<TITLE>BUG: Generic / Text Only Printer Driver Prints 66 Lines </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87767 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/08/05">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Choosing the Generic / Text Only printer drivers in Microsoft Windows versions 3.0 and 3.1 may cause incorrect printing results in Visual Basic for Windows. Visual Basic expects to print 66 lines per page, but the generic printer driver only prints...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QADF,QBXT,QA5V,QAIB,QAOX,QDL9,QBWO,QBWN,QATX,QAMB,QALQ,QBWS,QBWA,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Generic / Text Only Printer Driver Prints 66 Lines</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87767 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 2.0
<LI>Microsoft Visual Basic programming system for Windows, version 1.0
<LI>Microsoft Windows versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Choosing the Generic / Text Only printer drivers in Microsoft Windows
versions 3.0 and 3.1 may cause incorrect printing results in Visual
Basic for Windows. Visual Basic expects to print 66 lines per page, but
the generic printer driver only prints 60 lines per page. This results
in six lines being printed on a separate page.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around the problem, select a different printer driver.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Generic / Text Only
printer driver included with the Microsoft products listed at the beginning
of this article. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When using the Generic / Text Only printer driver, the example below
prints 60 lines on the first page, 6 lines on the second page, and
then 60 lines on the third page. You may also encounter some lines
being overwritten also with the Generic / Text Only driver supplied
with Windows version 3.0.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>From the Windows Control Panel, choose the Printers icon.

<P><LI>From the Printers option, choose the Add Printer button.

<P><LI>Select the Generic / Text Only printer driver.

<P><LI>Choose the Install button. There is additional help on pages 145-147 of
   the "Microsoft Windows version 3.0 User's Guide." Note: You may need
   your Windows disks to install the Generic / Text Only driver.

<P><LI>After the Generic / Text Only driver has been installed and is the
   default printer, you can proceed to run a test in Visual Basic.

<P><LI>Start Visual Basic or if Visual Basic is already running, choose New
   Project from the File menu (ALT, F, N). Form1 is created by default.

<P><LI>Add the following code to the Form_Click event procedure of Form1:
<P>
<PRE>   Sub Form_Click ( )
      For i% = 1 to 200
         Printer.Print "This is a test of line number ";i%
      Next i%
      Printer.EndDoc
   End Sub

</PRE><P><LI>From the Run menu, choose Start to run the program.

<P><LI>Run the same code, by pressing the F5 function key and then click
   Form1 once, to run the test. This should produce five pages of
   text, the first and third pages should have 60 lines of text, while
   the second and fourth pages will only contain 6 lines of text. The
   fifth page should be half covered with lines of text. This is where
   the problem is, Visual Basic sends 66 lines to be printed per page,
   but the Generic / Text Only printer driver is setup to print only
   60 lines. Then the printer driver does a formfeed, after printing
   the 6 lines on the second page to go on to the third page. The
   printer driver may also display a problem on some lines of code
   being overwritten (every fifth line may be overwritten).
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist1.00 buglist2.00 1.00 2.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
