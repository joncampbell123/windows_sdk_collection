

<HTML>
<HEAD>
<TITLE>How to Clear the Legend Information from a Graph Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113997">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/04/21">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Graph Control is one of the most versatile of the custom controls included with Visual Basic Professional, but it is also complex and can be difficult to master. It is easy to add legends using the LegendText property, but removing legends is n...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QAMB,QBS0,QAOE,QA7O,QAMN,QAB5,QAY2,QAJX,QADR,QBXS,QBWS,QAPN,QDKD,QDH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Clear the Legend Information from a Graph Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113997</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows, version 3.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Graph Control is one of the most versatile of the custom controls
included with Visual Basic Professional, but it is also complex and can be
difficult to master. It is easy to add legends using the LegendText
property, but removing legends is not at all intuitive. It is necessary to
set the DataReset property to 5 to clear the legend information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how switching a graph between different
numbers of sets produces an anomalous result when the DataReset property is
not used.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a graph control (Graph1) and 2 command buttons (Command1 and
   Command2) to Form1. Be sure to make the Graph control large
   enough to accommodate the legend

<P><LI>Add the following code to the Command1_Click and Command2_Click event
   procedures of Form1:
<P>
<PRE>   Sub Command1_Click ()
      ' Remove the apostrophe from following line to remove the legend:
      ' graph1.DataReset = 5
      graph1.ThisPoint = 1
      graph1.LegendText = "1992"
      graph1.ThisPoint = 2
      graph1.LegendText = ""
      graph1.NumSets = 1
      graph1.DrawMode = 2
   End Sub

   Sub Command2_Click ()
      graph1.LegendText = "1992"
      graph1.NumSets = 2
      graph1.ThisPoint = 2
      graph1.LegendText = "1993"
      graph1.DrawMode = 2
   End Sub

</PRE><P><LI>Run the application by choosing Start from the Run menu or by
   pressing the F5 key.
<P>
</OL>Click the Command1 and Command2 buttons back and forth several times and
observe the result. You will see that the legend from the previous data was
not completely deleted. Now remove the apostrophe from the second line of
code in the Command1_Click event procedure and repeat the process. You will
see that it is now deleted.
<P>
<P><h2>REFERENCES</h2>
 
<P>
This article is based on the following articles in the Microsoft Knowledge
Base:
<P>
ARTICLE-ID: <B><A href="../vbwin/q81999.htm">Q81999</A></B>
<PRE>TITLE     : BUG: Graph: AutoInc Increments ThisPoint Instead of ThisSet

</PRE></OL>ARTICLE-ID: <B><A href="../vbwin/q82155.htm">Q82155</A></B>
<PRE>TITLE     : VB Graph Control: ThisPoint, ThisSet Reset to 1 at Run Time

</PRE>ARTICLE-ID: <B><A href="../vbwin/q96450.htm">Q96450</A></B>
<PRE>TITLE     : Set DrawMode to 2 Or 3 to Update Changes to Graph at Run Time
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
