

<HTML>
<HEAD>
<TITLE>PRB: Access Key Causes Different Event Order than Mouse Click </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74905 ">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1991/08/04">
<META NAME="Keywords" CONTENT="EnvtRun PrgCtrlsStd VB4ALL VB4WIN vb5all kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  In Visual Basic, events may be generated in a different order if you choose a control (such as a button, a check box, or an option box) using an access key rather than with the mouse. The events that occur in a different order are Click, LostFocus,...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAO4,QAFF,QBWS,QAMN,QAOX,QBW7,QAI5,QA7O,QAOE,QAB5,QA5F,QAMA,QA1S V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Access Key Causes Different Event Order than Mouse Click</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74905 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0, 3.0, 4.0
<LI>Microsoft Visual Basic programming system for Windows, version 1.0
<LI>Microsoft Visual Basic for MS-DOS, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Visual Basic, events may be generated in a different order if you
choose a control (such as a button, a check box, or an option box)
using an access key rather than with the mouse. The events that occur
in a different order are Click, LostFocus, and GotFocus.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
By inserting the DoEvents statement as the very first statement in the
Click event handler, you can cause the LostFocus and GotFocus events to be
handled before the body of the Click event handler.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. It is not a bug in Visual Basic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can create an access key at design-time by changing the Caption
property of a control to include an ampersand (&amp;). The access key is the
character after the ampersand, and at run-time you press the ALT+character
key to choose the control. (See page 120 of the "Microsoft Visual Basic:
Programmer's Guide" version 1.0. manual.)
<P>
When you press an access key (ALT+character) to choose a control, the Click
event is generated before the LostFocus and GotFocus event; however, when
you choose a control by clicking the mouse, the LostFocus and GotFocus
events are generated before the Click event.
<P>
The example below shows this different order of events. The example
uses command buttons, but also applies to Check and Option boxes:

<OL><P><LI>Open a new form and create two CommandButtons.

<P><LI>Enter the code as shown further below.

<P><LI>Change the Caption property of Command2 to "Command&amp;2."

<P><LI>Run the program.

<P><LI>When Command1 has the focus and you click Command2, the following events
   are generated in the following order:
<P>
<P><PRE>    - Command1_LostFocus
    - Command2_GotFocus
    - Command2_Click
</PRE>
<P><LI>When Command1 has the focus and you press the access key, ALT+2, the
   following events are generated in the following order:
<P>
<P><PRE>    - Command2_Click
    - Command1_LostFocus
    - Command2_GotFocus
</PRE><P>
</OL>Sample Code:
 
<P>
<PRE>   Sub Command1_Click ()
      Print "Command1_click"
   End Sub

   Sub Command1_LostFocus ()
      Print "Command1_lostfocus"
   End Sub

   Sub Command1_GotFocus ()
       Print "Command1_gotfocus"
   End Sub

   Sub Command2_Click ()
       Print "Command2_click"
   End Sub

   Sub Command2_LostFocus ()
      Print "Command2_lostfocus"
   End Sub

   Sub Command2_GotFocus ()
      Print "Command2_gotfocus"
   End Sub

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q177992.htm">Q177992</A></B>
   TITLE     : HOWTO: Intercept Keyboard Input from Visual Basic
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: shortcutkey hotkey<BR>
Keywords          : EnvtRun PrgCtrlsStd VB4ALL VB4WIN vb5all kbfasttip<BR>
Version           : WINDOWS:1.0,2.0,3.0,4.0,5.0<BR>
Platform          : MS-DOS WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
