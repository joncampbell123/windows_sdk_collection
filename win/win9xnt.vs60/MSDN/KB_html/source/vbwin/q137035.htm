

<HTML>
<HEAD>
<TITLE>PRB: Font Dialog Box Lists Fonts Not Supported by Printer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137035">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="kbui kbprint kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Font dialog box shows fonts with certain styles not supported by the current printer, even after setting the Flags property in the Common Dialog control to the PrinterFonts constant.  CAUSE =====  If the Flags property is set to PrinterFonts on...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAKJ,QADF,QAPN,QA01,QAIJ,QBXS,QABA,QA5F,QAMA,QA5B,QAHE,QABB,QBMH,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Font Dialog Box Lists Fonts Not Supported by Printer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137035</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Font dialog box shows fonts with certain styles not supported by the
current printer, even after setting the Flags property in the Common Dialog
control to the PrinterFonts constant.
<P>
<P><h2>CAUSE</h2>
 
<P>
If the Flags property is set to PrinterFonts only, the Font dialog box may
still allow graphic device interface (GDI) simulation.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This can be resolved by setting the Flags property to two constants merged
together using the Or operator.  These constants are PrinterFonts and
NoSimulations.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-By-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a Common Dialog control to Form1, and set its Name property to
   CMDialog.

<P><LI>Add the following to the general declarations section of Form1:
<P>
<PRE>   ' In Visual Basic 4.0 the constants would be:
   Const vbCFNoSimulations = &amp;H1000&amp;
   Const vbCFPrinterFonts = &amp;H2&amp;

   ' In Visual Basic 3.0 the name of the constants would be:
   Const CF_NoSimulations = &amp;H1000&amp;
   Const CF_PrinterFonts = &amp;H2&amp;

   Either set of constant names would work as long as you are consistent in
   your usage. The rest of this article uses the version 4.0 constants.

</PRE><P><LI>Add the following to the Form_Load event procedure:
<P>
<PRE>   Private Sub Form_Load()
      ' The following line can be written either like this:
      CMDialog.Flags = vbCFNoSimulations Or vbCFPrinterFonts

      ' or like this:
      ' CMDialog.Flags = vbCFNoSimulations + vbCFPrinterFonts

      CMDialog.Action = 4
   End Sub

</PRE><P><LI>Start the program by pressing the F5 key or by clicking Start on the Run
   menu.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For a more complete description of the Flag property constants, please see
the Language Reference, the Constant.txt file in Visual Basic 3.0, and the
Object Browser in Visual Basic 4.0.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 3.00 vb4win vb4all<BR>
KBCategory: kbui kbprint kbprg<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
