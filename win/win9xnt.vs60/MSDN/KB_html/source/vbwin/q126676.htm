

<HTML>
<HEAD>
<TITLE>How to Use the MaskedEdit Control for Currency Format </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126676">
<META NAME="KBModify" CONTENT="1997/03/18">
<META NAME="KBCreate" CONTENT="1995/02/28">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The maskededit control requires that you enter a number for each of the pound sign (#) character place holders and enter a space for each of the ampersand (*) place holders. The control tests each character you enter to make sure it matches the spe...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAFF,QBC9,QBC8,QANO,QAUD,QBS0,QAPN,QABI,QAII,QACI,QAMN,QAKC,QA7O,QAOE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use the MaskedEdit Control for Currency Format</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126676</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbcode
<P>
 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The maskededit control requires that you enter a number for each of the
pound sign (#) character place holders and enter a space for each of the
ampersand (&amp;) place holders. The control tests each character you enter to
make sure it matches the specified mask. This is inconvenient for currency
format. For example, if the mask is #####.##, you'd have to enter 00012.25;
and if the Mask is &amp;&amp;&amp;&amp;#.##, you'd have to enter four spaces and then 12.25
(as in "  12.25").
<P>
This article shows by example how to gain the flexibility of entering any
number. The application uses the period (.) to define the decimal point,
and right aligns the number to the decimal point. Then you can enter the
pennies.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic (ALT, F, N). Form1 is created by
   default.

<P><LI>Add two Masked Edit controls (MaskedEdit1 and MaskedEdit2) to Form1, and
   assign these properties:
<P>
<PRE>   Default Name    Mask       Format      PromptChar
   -------------------------------------------------
   MaskedEdit1     #####.##   $####0.00   (Space)
   MaskedEdit2     #####.##   $####0.00   (Space)

</PRE><P><LI>Add the following code to the GotFocus event of MaskedEdit1:
<P>
<PRE>   Sub MaskedEdit1_GotFocus ()
      maskededit1.SelStart = 0
      maskededit1.SelLength = Len(maskededit1)
   End Sub

</PRE><P><LI>Add the following code to the KeyPress event of MaskedEdit1:
<P>
<PRE>   Sub MaskedEdit1_KeyPress (keyascii As Integer)
      Call Masked_Key_Press(MaskedEdit1, keyascii)
      If keyascii = 13 Then SendKeys "{tab}"
   End Sub

</PRE><P><LI>Add the following code to the GotFocus event of MaskedEdit2:
<P>
<PRE>   Sub MaskedEdit2_GotFocus ()
      maskededit2.SelStart = 0
      maskededit2.SelLength = Len(MaskedEdit2)
   End Sub

</PRE><P><LI>Add the following code to the Keypress event of MaskedEdit2:
<P>
<PRE>   Sub MaskedEdit2_KeyPress (keyascii As Integer)
      Call Masked_Key_Press(MaskedEdit2, keyascii)
      If keyascii = 13 Then SendKeys "{tab}"
   End Sub

</PRE><P><LI>Add the following Sub procedure to the general declarations section of
   the form:
<P>
<PRE>   Sub Masked_Key_Press (MskEdit As MaskEdBox, keyascii As Integer)

      ' Calculate the location of the decimal point in the mask:
      mask_cents_pos = InStr(MskEdit.Mask, ".")
      mask_dollars = mask_cents_pos - 1

      ' Check for period keypress:
      If keyascii = 46 And MskEdit.SelStart &lt; 6 Then
         tlen = MskEdit.SelStart + 1       ' Store current location.
         MskEdit.SelStart = 0
         MskEdit.SelLength = tlen          ' Highlight up to the current
         tempo = MskEdit.SelText           ' position &amp; save selected text.
         MskEdit.SelLength = mask_dollars
         MskEdit.SelText = ""              ' Clear to the left of decimal.
         MskEdit.SelStart = mask_cents_pos - tlen
         MskEdit.SelLength = tlen           ' Reposition caret
         MskEdit.SelText = tempo            ' and paste copied data.
         MskEdit.SelStart = mask_cents_pos  ' Position caret after cents.
      End If
   End Sub

</PRE><P><LI>Press the F5 key to run the program. Enter numbers, and observe the
   result when you press the period (decimal point) key.
<P>
</OL>This code shows a single method for handling various numeric input into the
masked edit box. You may want to use this as a starting point and add
additional code for special cases.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 Format Mask Maskededit accounting right<BR>
justify justification dollar line up<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
