

<HTML>
<HEAD>
<TITLE>PRB: Version Compatibility of OLE Servers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143042">
<META NAME="KBModify" CONTENT="1996/05/02">
<META NAME="KBCreate" CONTENT="1996/01/24">
<META NAME="Keywords" CONTENT="kbole kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When distributing an update to an OLE server you may receive the following error when accessing the server with an existing OLE client:     Run-time error '-2147319765 (8002802b)':      Ole Automation error      Element not found.  CAUSE =====  Ver...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9Q,QARL,QBJZ,QAB4,QAH4,QBWS,QAY2,QBS0,QAJQ,QAAP,QAC1,QAXB,QAUR,QAPN,QAJN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Version Compatibility of OLE Servers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143042</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When distributing an update to an OLE server you may receive the following
error when accessing the server with an existing OLE client:
<P>
<PRE>   Run-time error '-2147319765 (8002802b)':
     Ole Automation error
     Element not found.

</PRE><h2>CAUSE</h2>
 
<P>
Version compatible is when objects and/or methods have been added to the
type library, but no changes have been made to existing properties.
Version identical is when interfaces are the same such that the type
library is exactly the same as the old version.
<P>
Making an update to an OLE server, which is version compatible but is not
version identical, causes this error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You must recompile the OLE client with the reference to the updated OLE
server and redistribute the OLE client.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Prior to following this example, make sure you have built the OLE server
and OLE client. For additional information on building OLE clients and
servers, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q129801.htm">Q129801</A></B>
   TITLE     : How to Create and Use a Minimal OLE Automation Server

</PRE><h3>Phase One - Modify the Client</h3>
 
<P>
You will have to make the following modifications to the OLE client
project:

<OL><P><LI>Change the code in the Form1_Click event procedure to:
<P>
<P><PRE>      Dim MyObj As New Project1.Class1
      Print MyObj.MyString
      Print MyObj.MyFunction
</PRE>
<P><LI>Delete the code from the Form1_Load event procedure.

<P><LI>From the Tools menu, select Options. In the Project tab set the Project
   Name to Client.

<P><LI>Add a reference to the OLE server by selecting Tools-Reference from the
   menu and marking the checkbox which references the OLE server(Project1)
   in order to successfully compile the OLE client.

<P><LI>Make an executable file. Save the OLE client executable file as
   CLIENT.EXE. Also save the OLE client project.
<P>
</OL><h3>Phase Two - Modify the Server</h3>
 
<P>
Modify the server to make a version compatible but not version identical
server. This will involve changing the OLE interface by simply adding a
method to the class module.

<OL><P><LI>Open the OLE server project previously created.

<P><LI>In the Class Module insert the following code in the general
   declarations section:
<P>
<P><PRE>      Private Function MyFunction2() as Integer
</PRE><P>
<P><PRE>      End Function
</PRE>
<P><LI>From the Tools menu, choose Options. In the Project tab place the name
   of the previously created OLE server in the "Compatible OLE Server"
   editbox.

<P><LI>From the File menu, select Make EXE File. Select Options from the file
   dialog and change the version number to 1.

<P><LI>Start the program by choosing Start from the Run menu or by pressing
   the F5 key to register the OLE server.

<P><LI>Save the project. Exit Visual Basic.
<P>
</OL><h3>Phase Three - Test the OLE Client</h3>
 

<OL><P><LI>Run the OLE client executable file.

<P><LI>Click Form1. You'll see the following error message:
<P>
<P><PRE>      Run-time error '-2147319765 (8002802b)':
<PRE></PRE>        Ole Automation error
        Element not found.

</PRE></OL><h3>Phase Four - Fix the OLE Client</h3>
 
<P>
In order to make the OLE client execute properly again it will have to be
recompiled referencing the updated OLE server.

<OL><P><LI>Open the OLE client project.

<P><LI>Make a new executable file.

<P><LI>Run the executable file. Click Form1. You will see this output:
<P>
<P><PRE>      Life is like a box of chocolates.
      You never know what you're gonna get.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.0 vb4win vb4all OLE version compatibility<BR>
KBCategory: kbole kbusage<BR>
KBSubcategory: iapole<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
