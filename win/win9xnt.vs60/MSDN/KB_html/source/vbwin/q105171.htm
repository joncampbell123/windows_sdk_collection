

<HTML>
<HEAD>
<TITLE>PRB: Error 13 (Type Mismatch) &amp; Error 3061 w/ SQL Queries </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105171">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/10/12">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Incorrect SQL syntax can cause either of the following error messages:   - Type Mismatch (Error 13)  - 1 parameter expected but only 0 were supplied (Error 3061)  You may receive one of the above errors with a data access object method that contain...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAN0,QAAP,QAB4,QABM,QAPN,QBWS,QAY2,QBS0,QBXS,QA2Q,QAH4,QAG2,QAMN,QAIJ,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error 13 (Type Mismatch) &amp; Error 3061 w/ SQL Queries</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105171</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Incorrect SQL syntax can cause either of the following error messages:

<UL><LI>Type Mismatch (Error 13)
<LI>1 parameter expected but only 0 were supplied (Error 3061)
<P>
</UL>You may receive one of the above errors with a data access object method
that contains a SQL statement, or when using the Refresh method on a Data
control that has its RecordSource property set to a SQL statement.
<P>
<P><h2>CAUSE</h2>
 
<P>
The SQL syntax is incorrect.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Correct the SQL syntax. See the examples in the Steps to Reproduce Behavior
section below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a data control (Data1) and two command buttons (Command1 and
   Command2) to Form1.

<P><LI>Set the following properties for the Data1 control:
<P>
<PRE>   Control           Property           Value Set
   ------------------------------------------------------
   Data1             DataBaseName       C:\VB\BIBLIO.MDB
   Data1             RecordSource       Authors

</PRE><P><LI>Add the following code to the Command1 Click event procedure:
<P>
<PRE>   Sub Command1_Click ()
      data1.RecordSource = "Select * from authors where author = 4"
      data1.Refresh        ' This gives the type mismatch error
   End Sub

   NOTE: If you change the SQL query to the following, you will receive
   the 3061 error (1 parameter expected but only 0 were supplied):

      data1.RecordSource = "Select * from authors where author = brown"

   The following query corrects the SQL syntax. It should work correctly
   without giving an error:

      data1.RecordSource = "Select * from authors where author = 'brown'"

</PRE><P><LI>Add the following code to the Command2 Click event procedure:
<P>
<PRE>   Sub Command2_Click ()
      Dim db As database
      Dim ds As dynaset
      Set db = OpenDatabase("C:\VB\BIBLIO.MDB")
      sqlquery1$ = "Select * from authors where author = 4"
      Set ds = db.CreateDynaset(sqlquery1$) 'Gives type mismatch error
   End Sub

   NOTE: If you change the SQL query to the following, you will receive
   the 3061 error (1 parameter expected but only 0 were supplied):

      sqlquery1$ = "Select * from authors where author = brown"

   The following query corrects the SQL syntax. It should work correctly
   without giving an error:

      sqlquery1$ = "Select * from authors where author = 'brown'"

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) or press the F5 key to run
   the program. Click the Command1 button to get the error. Then restart
   the program, and click the Command2 button to get the error.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
