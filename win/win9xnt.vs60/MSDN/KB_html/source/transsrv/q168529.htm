

<HTML>
<HEAD>
<TITLE>BUG: SP2 Causes Control Panel and RAS Problems on WinNT 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168529">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1997/05/14">
<META NAME="Keywords" CONTENT="kbenv kbsetup TSrvConfig TSrvDeploy TSrvGen TSrvInstall">
<META NAME="KBArea" CONTENT="Support; KB; transsrv">
<META NAME="Description" CONTENT="  Microsoft Transaction Server 1.0 Service Pack 2, released March 1997, introduced a client configuration feature. When a package is exported, Microsoft Transaction Server now produces an executable file. When run on client computers, this executable...">
<META NAME="Product" CONTENT="transsrv">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBTX,QDO3,QARL,QAAP,QAA1,QAR4,QDI2,QAIJ,QBWS,QDNN,QA01,QDIZ,QBVV,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SP2 Causes Control Panel and RAS Problems on WinNT 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168529</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Transaction Server, version 1.0 Service Pack 2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Transaction Server 1.0 Service Pack 2, released March 1997,
introduced a client configuration feature. When a package is exported,
Microsoft Transaction Server now produces an executable file. When run on
client computers, this executable file makes the necessary changes to the
registry and copies and registers any necessary DLLs. This allows the
client computer to access the Microsoft Transaction Server application. If
you downloaded Microsoft Transaction Server 1.0 Service Pack 2 before
May 2, 1997, be aware that the client installation executable file
improperly overwrites two components of the Windows NT operating system:
Cfgmgr32.dll and Setupapi.dll. After the client installation has occurred
on a computer running Windows NT 4.0, certain Control Panel functions will
malfunction, and RAS may also be disabled. Client computers running
Windows 95 clients are not affected. After you install Transaction
Server 1.0 Service Pack 2a, you should regenerate any client configuration
executable files you may have created.
<P>
The following are some symptoms you may observe after running the client
configuration executable file on a client computer running Windows NT:

<UL><LI>Explorer may cause a general protection fault when you open the Fonts
   folder in Control Panel. Shortly afterwards, Windows NT will restart.

<LI>You may be halted by an unending series of message boxes when you start
   Add/Remove programs in Control Panel click the Windows NT Setup tab. To
   stop the message boxes, you must end Rundll32.exe with Task Manager.

<LI>Control Panel Modems does not start.

<LI>You receive the following error when you start Control Panel Devices:
<P>
   Configuration Manager: This routine is not implemented in this version
   of the operating system.

<LI>The RAS client may not start, claiming that no ports exist.
<P>
</UL>These symptoms only occur if a client installation executable file has
already overwritten the copies of Cfgmgr32.dll and Setupapi.dll that are
located in your Winnt\System32 directory.
<P>
<P><h2>CAUSE</h2>
 
<P>
Cfgmgr32.dll and Setupapi.dll have been overwritten by incorrect versions.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To determine whether you have the incorrect versions of these DLLs, do the
following:

<OL><P><LI>On the client computer, check the Winnt\System32 directory for the
   Cfgmgr32.dll and Setupapi.dll files.

<P><LI>If any of the following is true, you have copies of the incorrect DLLs:
<P>
<P><PRE>    - Cfgmgr32.dll is 23,552 bytes.
</PRE><P>
<P><PRE>    - Cfgmgr32.dll's properties sheet has no Version information tab.
</PRE><P>
<P><PRE>    - Setupapi.dll is 327,072 bytes.
</PRE><P>
</OL>If either of these two DLLs is incorrect, you need to obtain the correct
versions of the DLLs that come with Windows NT 4.0.
<P>
If you have not run the client installation executable file on your
computer, the copies of Cfgmgr32.dll and Setupapi.dll (which are located in
your Winnt\System32 directory) should still be correct. You can also use
these files to restore any other affected Windows NT 4.0 computers to their
correct state. For Windows NT 4.0 Service Pack 2 and earlier, the correct
size for these files is:

<UL><LI>Cfgmgr32.dll     58,128 bytes

<LI>Setupapi.dll    286,480 bytes
<P>
</UL>If all your copies of Cfgmgr32.dll and Setupapi.dll are incorrect, you must
restore them from your Windows NT 4.0 compact disc. To do this, perform the
following steps:

<OL><P><LI>Search for Cfgmgr32.dl_ and Setupapi.dl_ on the Windows NT 4.0 compact
   disc.

<P><LI>Open a command prompt window and run the following commands:
<P>
<P><PRE>      expand &lt;SetupPath&gt;\cfgmgr32.dl_ &lt;SystemPath&gt;\cfgmgr32.dll
</PRE><P>
<P><PRE>      expand &lt;SetupPath&gt;\setupapi.dl_ &lt;SystemPath&gt;\setupapi.dll
</PRE><P>
   For example, assuming that the Windows NT 4.0 compact disc is in drive D
   and you have installed Windows NT 4.0 into the C:\Winnt directory, you
   would type:
<P>
<P><PRE>      expand d:\i386\cfgmgr32.dl_ C:\Winnt\System32\cfgmgr32.dll
</PRE><P>
<P><PRE>      expand d:\i386\setupapi.dl_ C:\Winnt\System32\setupapi.dll
</PRE><P>
</OL>Because you installed the correct DLL's into your system directory, you do
not need to restart the computer.
<P>
NOTE: The instructions given above only apply to versions of Windows NT 4.0
that are earlier than Service Pack 3.
<P>
If you have previously installed Transaction Server 1.0 Service Pack 2, you
should install Transaction Server 1.0 Service Pack 2a over Service Pack 2
and regenerate any client configuration executables you may have created.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Transaction
Server version 1.0 Service Pack 2. This problem has been corrected in U.S.
Service Pack 2a for Microsoft Transaction Server version 1.0, dated May 6,
1997. For more information, contact your primary support provider.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, visit the Web sites at:

<UL><LI><B><A href="http://www.microsoft.com/transaction">http://www.microsoft.com/transaction</A></B>

<LI><B><A href="http://support.microsoft.com/support/default.asp">http://support.microsoft.com/support/default.asp</A></B> 
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: mts SP2<BR>
Keywords          : kbenv kbsetup TSrvConfig TSrvDeploy TSrvGen TSrvInstall<BR>
Version           : 1.0 SP2<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
