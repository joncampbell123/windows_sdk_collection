

<HTML>
<HEAD>
<TITLE>DHCP Server Offers Duplicate IP Addresses for Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160990">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1996/12/13">
<META NAME="Keywords" CONTENT="kbbug3.51 kbbug4.00 kbfix3.51 kbfix4.00 kbfix4.00.sp3 NTSrvWkst kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  In network environments that allow duplicate routes between DHCP clients and a DHCP server, a DHCP server gives out one IP address to two different clients. This problem occurs with DHCP Server for Windows NT 3.51 and 4.0.  CAUSE =====  The cause o...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBWD,QDO3,QDJG,QAC2,QBA3,QARL,QAM5,QAFO,QAYV,QAX1,QAR5,QAH6,QAA1,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DHCP Server Offers Duplicate IP Addresses for Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160990</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In network environments that allow duplicate routes between DHCP clients
and a DHCP server, a DHCP server gives out one IP address to two different
clients. This problem occurs with DHCP Server for Windows NT 3.51 and 4.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
The cause of this behavior is that, in some cases, the processing of the
second Discover packet causes the server to set the address state of the
address from leased to offered when the DHCP Server sends the second
Offer. The client will not reply to the second Offer, because it already
has an active lease. Because the DHCP Server does not receive a Request
packet in response to the Offer, the lease on the Offered address will
timeout and the address will be placed back into the pool of IP addresses
available for lease.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.51
and 4.0. This problem was corrected in the latest Microsoft Windows NT 4.0
U.S. Service Pack. For information on obtaining the service pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This problem may occur in several different network environments,
including Token Ring environments with large numbers of source routing
bridges (where the bridges would be set up in a way that would provide
multiple, unique routes between the server and client) and Ethernet
environments with multiple routers enabled with BOOTP relay agents or IP
helper addressing.
<P>
There was a fix for this behavior included in Service Pack 2 for Windows
NT 4.0 and Service Pack 5 for Windows NT 3.51. There are certain
circumstances in which the DHCP Server gives out the same IP address to
two different clients even though the appropriate service packs, mentioned
previously, were applied to the server(s).
 
<PRE>Keywords          : kbbug3.51 kbbug4.00 kbfix3.51 kbfix4.00 kbfix4.00.sp3 NTSrvWkst kbnetwork
Version           : 3.51 4.0
Platform          : winnt
Solution Type     : kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
