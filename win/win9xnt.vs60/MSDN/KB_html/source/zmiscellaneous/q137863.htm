

<HTML>
<HEAD>
<TITLE>Troubleshooting Plotter Problems in Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137863">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1995/10/08">
<META NAME="Keywords" CONTENT="kbhw kbprint kbtshoot win98 win95">
<META NAME="KBArea" CONTENT="Support; KB; win98x">
<META NAME="Description" CONTENT="  This article describes troubleshooting steps that may help you to resolve plotting problems in Windows 95 and Windows 98.  MORE INFORMATION  Print Troubleshooter  Windows 95 and Windows 98 include a Print Troubleshooter tool. To use the Print Troub...">
<META NAME="Product" CONTENT="win98x">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QBQU,QACT,QAIJ,QDL9,QBWO,QBWN,QBWQ,QDIV,QDJP,QAKG,QAA1,QAEF,QAMB,QAOX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting Plotter Problems in Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137863</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
********************************************************************
<PRE>     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA     

     This article discusses a Beta release of a Microsoft 
     product. The information in this article is provided as-is
     and is subject to change without notice. 

     No formal product support is available from Microsoft for 
     this Beta product. For information about obtaining support
     for a Beta release, please see the documentation included 
     with the Beta product files, or check the Web location 
     from which you downloaded the release.

     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA     
</PRE>********************************************************************
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 98
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes troubleshooting steps that may help you to resolve
plotting problems in Windows 95 and Windows 98.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Print Troubleshooter</h3>
 
<P>
Windows 95 and Windows 98 include a Print Troubleshooter tool. To use the
Print Troubleshooter tool, use the appropriate method:
<P>
Windows 95:

<OL><P><LI>Click Start, and then click Help.

<P><LI>On the Contents tab, double-click the Troubleshooting topic.

<P><LI>Double-click the If You Have Trouble Printing topic.
<P>
</OL>Windows 98:

<OL><P><LI>Click Start, and then click Help.

<P><LI>On the Contents tab, click the Troubleshooting topic.

<P><LI>Click the Windows 98 Troubleshooters topic, and then click Print.
<P>
</OL><h3>Reset the Plotter and Run a Self-Test</h3>
 

<OL><P><LI>Try turning off the plotter. After 5 to 10 seconds, turn the plotter
   back on. This will clear the plotter's memory.

<P><LI>Check the plotter's documentation for instructions on resetting the
   default settings and plotting a test page.

<P><LI>Perform a self-test on the plotter. The method for performing a
   self-test is different for different plotters.
<P>
   If the self-test fails, contact the plotter's manufacturer for
   assistance.

<P><LI>If possible, set up the plotter on your local computer. Verify that
   no plotter sharing devices or daisy-chained devices (such as a SCSI
   CD-ROM drive) are connected between the computer and plotter.
<P>
</OL><h3>Plotting from an MS-DOS Prompt</h3>
 
<P>
If you cannot plot at all in Windows, try the following steps:

<OL><P><LI>Restart your computer. For Windows 95, when you see the "Starting
   Windows 95" message, press the F8 key, and then choose Step-By-Step
   Confirmation, and then answer No to all questions. For Windows 98,
   press and hold down the CTRL key after your computer completes the
   Power On Self Test (POST), and then choose Step-By-Step Confirmation
   from the Startup menu. For more information about Windows 98 startup,
   see the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zzmiscellaneous/q178548.htm">Q178548</A></B>
<PRE></PRE>      TITLE     : No "Starting Windows 98" Message at Startup

</PRE><P><LI>Type the following line, and then press ENTER:
<P>
<P><PRE>      edit testplot.bat
</PRE>
<P><LI>Type the following lines in the new file:
<P>
<P><PRE>      Mode Com1:9600,n,8,1,p
      Pause
      Echo IN:SP1:PD4000,4000;SP0: &gt; COM1
</PRE><P>
   NOTE: If the plotter is not connected to COM1, substitute the
   correct port name in the lines above.

<P><LI>Save the file and then quit Edit.

<P><LI>Type the following line, and then press ENTER:
<P>
<P><PRE>      testplot.bat
</PRE>
<P><LI>Does the MODE command set up the port?
<P>
   For example, you should see these lines on your screen:
<P>
<P><PRE>      Resident portion of Mode loaded
      COM1: 9600,N,8,1,P
      Press any key to continue
</PRE>
<P><LI>Press ENTER.
<P>
   If a diagonal line is not plotted, there may be a problem with the
   port, the cable, or the plotter. You may want to try using a
   different plotter cable or a different plotter.
<P>
</OL><h3>Try Plotting to a Different Port</h3>
 
<P>
If plotting from COM1 does not work, try another communications port (such
as COM2).
<P>
NOTE: If you are continuing from the steps above, restart your computer
before following these steps.

<OL><P><LI>Click Start, point to Settings, and then click Printers.

<P><LI>Click the Plotter icon in the Printers folder.

<P><LI>On the File menu, click Properties.

<P><LI>Click the Details tab.

<P><LI>In the Print To The Following Port box, click "COM2 (Communications
   Port)."

<P><LI>Click OK.

<P><LI>Start Notepad.

<P><LI>Type some text in Notepad, and then try to plot the text.
<P>
</OL><h3>Plotting to a File</h3>
 
<P>
Try plotting to a file. If a file is created, copy the file to the port.

<OL><P><LI>Click Start, point to Settings, and then click Printers.

<P><LI>Click the Plotter icon in the Printers folder.

<P><LI>On the File menu, click Properties.

<P><LI>Click the Details tab.

<P><LI>In the Print To The Following Port box, click "FILE: (Creates file on
   disk)."

<P><LI>Click OK.

<P><LI>Start Notepad. Type some text in Notepad, and then try to plot the
   text. Name the output file Test.prn.

<P><LI>If the plotter driver does not plot to the file, try the same
   procedure in Safe mode.
<P>
</OL>If you cannot plot to a file in Safe mode, or if the output is poor, there
may be a problem with the plotter driver. Try removing the driver from the
Printers folder and reinstalling the driver. See the "Remove and Reinstall
the Plotter Driver" section later in this article for details. If the
driver plots to a file only in Safe mode, some other software is
conflicting with the driver. Try the steps in the next section.
<P>
<P><h3>Clean Boot the Computer</h3>
 
<P>
If you cannot plot at all in Windows, try a clean boot.
<P>
If no disk compression software, disk partitioning software, or other
third-party driver is necessary to start your computer, follow these steps
to try a clean boot:

<OL><P><LI>Rename the Config.sys file to Config.xxx. To do so, type the
   following line at a command prompt:
<P>
<P><PRE>      ren c:\config.sys config.xxx
</PRE>
<P><LI>Rename the Autoexec.bat file to Autoexec.xxx. To do so, type the
   following line at a command prompt:
<P>
<P><PRE>      ren c:\autoexec.bat autoexec.xxx
</PRE>
<P><LI>Restart your computer.
<P>
</OL><h3>Plotting from Notepad</h3>
 
<P>
Do not plot from WordPad or Paint. Paint prints raster data that plotters
cannot use. Plotting from WordPad does not work because WordPad cannot wrap
text correctly with the plotter driver. WordPad uses resolution to help
determine wrapping and plotters do not have a resolution.

<OL><P><LI>With the plotter still connected locally, restart your computer
   normally.

<P><LI>Click Start, point to Programs, point to Accessories, and then click
   Notepad.

<P><LI>Type some text in Notepad, and then try to plot the text.
<P>
</OL><h3>Device Manager Settings</h3>
 

<OL><P><LI>If you cannot plot from Notepad, verify that the port is set up
   correctly in Device Manager (for example, verify that there are no
   conflicts and that the port's resources are set correctly).
<P>
   NOTE: To open Device Manager, use the right mouse button to click My
   Computer, and then click Properties on the menu that appears.

<P><LI>Click the Device Manager tab, double-click "Ports (COM &amp; LPT)," and
   then double-click the appropriate port for plotter.

<P><LI>Click the Resources tab and verify that the settings are correct for
   the communications port. For example, the input/output range for a
   standard COM1 port is 03F8-03FF and its interrupt request line is 04.
   The input/output range for a standard COM2 port is 02F8-02FF and its
   interrupt request line is 03. Also, verify that the Conflicting Devices
   list reads "No conflicts."
<P>
</OL><h3>Change the Plotter Driver</h3>
 
<P>
Plotter drivers for different models change only items such as available
pens, paper sizes, and support for extended commands such as Arcs. Even if
all of these settings are wrong, you should still receive some kind of
output.
<P>
A newer plotter driver for use with Windows 95 and Windows 98 may be
available in the future from Microsoft or from the plotter's manufacturer.
Contact the plotter's manufacturer for further details.
<P>
<P><h3>Remove and Reinstall the Plotter Driver</h3>
 
<P>
If the problem seems to be corrected by using a different plotter driver,
remove and reinstall the plotter driver.
<P>
<P><h3>Remove and Reinstall the Communications Port</h3>
 

<OL><P><LI>If a conflict exists or the port's settings are incorrect, use Device
   Manager to remove the port.
<P>
   NOTE: To open Device Manager, use the right mouse button to click My
   Computer, and then click Properties on the menu that appears.

<P><LI>Click the Device Manager tab, double-click "Ports (COM &amp; LPT)," and
   then click the appropriate port for your plotter.

<P><LI>Click Remove, and then restart your computer.

<P><LI>In Control Panel, double-click the Add New Hardware icon, and then
   let the Add New Hardware Wizard detect the hardware in your computer.
<P>
</OL><h3>Hard Disk Maintenance</h3>
 
<P>
There should be at least 3 megabytes (MB) of free space on the hard disk
that contains the temporary folder.
<P>
Remove Temporary and Spool Files:

<OL><P><LI>Restart your computer. For Windows 95, when you see the "Starting
   Windows 95" message, press the F8 key, and then choose Safe Mode Command
   Prompt Only. For Windows 98, press and hold down the CTRL key after your
   computer completes the Power On Self Test (POST), and then choose Safe
   Mode Command Prompt Only from the Startup menu. For more information
   about Windows 98 startup, see the following article in the Microsoft
   Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zzmiscellaneous/q178548.htm">Q178548</A></B>
<PRE></PRE>      TITLE     : No "Starting Windows 98" Message at Startup

</PRE><P><LI>Type "set" (without quotation marks) and press ENTER. Note the
   location pointed to by the TEMP variable.

<P><LI>Change to the folder noted in step 2. For example, if TEMP is set
   to C:\Windows\Temp, type the following line and then press ENTER:
<P>
<P><PRE>      cd\windows\temp
</PRE>
<P><LI>Delete any temporary files in the folder. Temporary files usually have
   a .tmp extension. To delete these files, type the following line and
   then press ENTER:
<P>
<P><PRE>      del *.tmp
</PRE><P>
   NOTE: You should not delete these files from within the Windows
   graphical user interface (GUI) because Windows or a Windows-based
   program may be using one of these files.

<P><LI>Type the following line and press ENTER to change to the spool
   folder:
<P>
<P><PRE>      cd\windows\spool\printers
</PRE>
<P><LI>Delete any spool files in the folder. Spool files usually have a
   .spl extension. To delete these files, type the following line and
   then press ENTER:
<P>
<P><PRE>      del *.spl
</PRE>
<P><LI>Restart your computer normally.
<P>
</OL><h3>ScanDisk and Disk Defragmenter</h3>
 
<P>
If the hard disk becomes fragmented or there are cross-linked files on
the hard disk, you can encounter plotting problems. To check for these
problems, follow these steps:

<OL><P><LI>Click Start, point to Programs, point to Accessories, point to System
   Tools, and then click ScanDisk.

<P><LI>When ScanDisk is finished, click Start, point to Programs, point to
   Accessories, point to System Tools, and then click Disk Defragmenter.
<P>
</OL><h3>Plotting Problems Occur Only in One Program</h3>
 
<P>
If you plot from Microsoft Excel version 7.0 for Windows 95 and receive an
"I/O buffer overflow" error message on the plotter after about a quarter of
the spreadsheet is plotted, change the flow control setting in the port's
settings to Hardware from XON/XOFF.
<P>
If you can plot from all programs but one, follow these steps:

<OL><P><LI>What exactly is the plotting problem? Does the problem occur with one
   document only, or with all documents? As a test, try to plot a blank
   page inside the program. If this works, the program may have problems
   with memory.

<P><LI>Are you using a 32-bit or 16-bit program? 32-bit programs use the
   registry to obtain needed information, while 16-bit programs may use
   .ini files. If you are having problem plotting with a 16-bit program,
   an .ini file may need to be modified to accommodate the program.

<P><LI>Reinstall the program.

<P><LI>Contact the manufacturer of the program for specific settings that
   might affect plotting.
<P>
</OL><h3>Plotting Directly to Port</h3>
 

<OL><P><LI>Click Start, point to Settings, and then click Printers.

<P><LI>Click the Plotter icon in the Printers folder.

<P><LI>On the File menu, click Properties.

<P><LI>Click the Details tab.

<P><LI>Click Spool Settings.

<P><LI>Click "Print directly to the printer."

<P><LI>Click OK, and then click OK again.

<P><LI>Type some text in Notepad, and then try to plot the text.
<P>
</OL><h3>Changing the Flow Control</h3>
 

<OL><P><LI>Click Start, point to Settings, and then click Printers.

<P><LI>Click the Plotter icon in the Printers folder.

<P><LI>On the File menu, click Properties.

<P><LI>Click the Details tab.

<P><LI>Click Port Settings.

<P><LI>In the Flow Control box, click XON/XOFF.

<P><LI>Click OK, and then click OK again.

<P><LI>Type some text in Notepad, and then try to plot the text.

<P><LI>If the plotting problem persists, repeat steps 1-5.

<P><LI>In the Flow Control box, click Hardware.

<P><LI>Click OK, and then click OK again.

<P><LI>Type some text in Notepad, and then try to plot the text.
<P>
</OL>Selecting No Flow Control:

<OL><P><LI>If the plotting problem still occurs, repeat steps 1-5 above.

<P><LI>In the Flow Control box, click None.

<P><LI>Click OK, and then click OK again.

<P><LI>Type some text in Notepad, and then try to plot the text.
<P>
</OL><h3>Trying Different Paper Sizes</h3>
 

<OL><P><LI>Start Notepad.

<P><LI>Type some text in Notepad.

<P><LI>On the File menu, click Page Setup.

<P><LI>In the Size box, click a different paper size.

<P><LI>Click OK.

<P><LI>Try to plot the text.

<P><LI>If the text is not plotted, change the paper size and try to plot
   again.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information about troubleshooting printing and plotting
issues, please see the following articles in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q128345.htm">Q128345</A></B>
   TITLE     : Troubleshooting Printing Problems in Windows 95

   ARTICLE-ID: <B><A href="../win3x/q88375.htm">Q88375</A></B>
   TITLE     : Testing Serial Plotter Connections
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords          : kbhw kbprint kbtshoot win98 win95<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
