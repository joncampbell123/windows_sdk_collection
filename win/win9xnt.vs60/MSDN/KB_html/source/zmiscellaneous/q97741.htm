

<HTML>
<HEAD>
<TITLE>Optimizing DoubleSpace on Your Computer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97741 ">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1993/04/20">
<META NAME="Keywords" CONTENT="dblspace drvspace msdos win95 winplus kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; msdos">
<META NAME="Description" CONTENT=" NOTE: This information applies to both Microsoft DoubleSpace and Microsoft DriveSpace. For MS-DOS 6.22, Windows 95, and Microsoft Plus!, use DRVSPACE in place of DBLSPACE in all commands and file names.   After you use DoubleSpace to compress your h...">
<META NAME="Product" CONTENT="MS-DOS">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QDL9,QBWO,QBWN,QBW6,QDL7,QBWQ,QAH4,QAC9,QDJH,QBWS,QAIJ,QBW5,QACF,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Optimizing DoubleSpace on Your Computer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97741 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.00 6.20 6.22 | 95
<PRE>MS-DOS         | WINDOWS
</PRE>kbtool kbenv
<P>
 
The information in this article applies to:

<UL><LI>Microsoft MS-DOS operating system versions 6.0, 6.2, 6.22
<LI>Microsoft Windows 95
<LI>Microsoft Plus! for Windows 95
</UL> 
<P>
NOTE: This information applies to both Microsoft DoubleSpace and Microsoft
DriveSpace. For MS-DOS 6.22, Windows 95, and Microsoft Plus!, use DRVSPACE
in place of DBLSPACE in all commands and file names.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you use DoubleSpace to compress your hard disk, you may experience
one or more of the following symptoms:

<UL><LI>You may have less free conventional memory. As a result, you may be
   unable to run one or more MS-DOS-based programs. If you are running
   Windows 95 or Microsoft Plus! DriveSpace, the problem may occur only
   when you restart your computer in MS-DOS mode or boot to a Windows 95
   command prompt.

<LI>You may experience a slight performance degradation.
<P>
</UL><h2>CAUSE</h2>
 
<P>
To provide access to compressed drives, DoubleSpace loads a real-mode
device driver that requires a considerable amount of memory. If your
computer is not configured to provide access to the upper memory area
(UMA), the DoubleSpace driver must load in conventional memory.
<P>
Windows 95 and Microsoft Plus! include both real-mode and protected-mode
DriveSpace drivers. The real-mode DriveSpace driver is used to provide
access to compressed drives before Windows 95 starts and when you restart
your computer in MS-DOS mode or boot to a Windows 95 command prompt. The
protected-mode DriveSpace driver is used after Windows 95 starts to provide
protected-mode access to compressed drives.
<P>
Because the protected-mode DriveSpace driver replaces the real-mode driver
in memory after Windows 95 starts, the amount of conventional memory used
by the real-mode driver is normally not a concern when you are running MS-
DOS-based programs in Windows 95. However, if you frequently run MS-DOS-
based programs after restarting the computer in MS-DOS mode or after
booting to a Windows 95 command prompt, you may find that programs
requiring large amounts of conventional memory are unable to run.
<P>
The primary reason for performance degradation while running compression
software such as DoubleSpace is that each time a read or write is made from
or to the hard disk, data must be decompressed or compressed. This
decompression or compression of data places additional demand on the
processor in your computer. Computers with faster processors most likely
will not experience performance degradation after compression software is
installed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve the problem, refer to the appropriate section below.
<P>
<P><h3>MS-DOS 6.0, 6.2, or 6.22</h3>
 
<P>
To work around this problem when you are running MS-DOS 6.0, 6.2, or 6.22
DoubleSpace or DriveSpace, follow these steps:

<OL><P><LI>If you are using Microsoft Windows, set the TEMP environment variable
   to the host drive. To do so, follow these steps:
<P>
   a. Type "dblspace /list" (without quotation marks) at a command prompt
<P><PRE>      and then press ENTER to determine which drive is the host drive.
</PRE><P>
   b. Use the DIR command to determine if you have at least two megabytes
<P><PRE>      (MB) of free disk space on the host drive. If you do not, see the
      section titled "Using DoubleSpace to Manage Compressed Drives" in
      the "User's Guide" for instructions on decreasing the size of the
      compressed volume file (CVF). If you receive the message "Drive X is
      too fragmented to resize," see section 7.14 in the Readme.txt file.
</PRE><P>
   c. Change to the host drive and create a TEMP directory. For example,
<P><PRE>      if your host drive is drive H, type the following lines at a command
      prompt, pressing ENTER after each line:
</PRE><P>
<PRE>         h:
         md \temp

   d. Using a text editor such as MS-DOS Editor, edit the Autoexec.bat
      file and change the SET TEMP statement to point to the TEMP
      directory on the host drive. For example:

         set temp=h:\temp

</PRE><P><LI>If your computer contains an 80386 or higher processor, run MemMaker
   after you run DoubleSpace to ensure you are freeing as much convention-
   al memory as possible. If you have a VGA display adapter, run MemMaker
   in custom mode and choose Yes when you are prompted to use the mono-
   chrome region to obtain an additional 32K of upper memory block (UMB)
   space. If you have a Super VGA video display adapter, you can use the
   monochrome region, but you need to load the Monoumb.386 file if you use
   Microsoft Windows. For specific instructions, see section 2.3 of the
   Readme.txt file.

<P><LI>If your computer contains an 80286 processor and is low on conventional
   memory, consider purchasing a third-party memory manager to load device
   drivers, terminate-and-stay-resident (TSR) programs, and the Double-
   Space component (Dblspace.bin) in the upper memory area (UMA).

<P><LI>If your computer contains an 80286 or higher processor and has more
   than 1 MB of memory, ensure you are loading SMARTDrive.

<P><LI>If you are unable to run a particular program (such as an MS-DOS-based
   game) due to insufficient memory, you may want to move that software to
   the host drive and create a startup disk for drive A that does not
   contain the DoubleSpace component. To do so, follow these steps:
<P>
   a. Type "dblspace /list" (without quotation marks) at a command prompt
<P><PRE>      and then press ENTER to determine which drives are uncompressed or
      host drives.
</PRE><P>
   b. Use the XCOPY command to copy the program's directory to the host
<P><PRE>      drive. For example, if drive H is your host drive, type "xcopy
      c:\dir\*.* h:\dir\*.*  /s" (without quotation marks) at a command
      prompt and then press ENTER.
</PRE><P>
   c. Create a bootable floppy disk in drive A with the SYS command. For
<P><PRE>      example, type "sys c: a:" (without quotation marks) at a command
      prompt and then press ENTER.
</PRE><P>
   d. Type "deltree a:\dblspace.bin" (without quotation marks) at a
<P><PRE>      command prompt and then press ENTER to remove the DoubleSpace
      component.
</PRE><P>
   e. Confirm that all the files were copied to the host drive.
<P>
   f. Using a text editor such as MS-DOS Editor, create Config.sys and
<P><PRE>      Autoexec.bat files on drive A and include any TSRs or device drivers
      required by the program. You should also add a PATH statement to
      include the program's directory.
</PRE><P>
<P><PRE>      NOTE: If you are using a host drive, remember that the drive letter
      is different when you start the computer without the DoubleSpace
      component.
</PRE><P>
   g. Restart the computer with the new startup disk in drive A and run
<P><PRE>      the program to ensure you have configured the system correctly.
</PRE><P>
<P><PRE>      NOTE: Your compressed drive will not be accessible when you restart
      your computer from this floppy disk. However, the data on your drive
      is not lost. It will be accessible when you restart your computer
      from the hard disk.
</PRE><P>
   h. If everything is functioning correctly, restart your computer from
<P><PRE>      the hard disk and delete the program's directory from the compressed
      drive. For example, type "deltree /y c:\dir" (without quotation
      marks) at a command prompt and then press ENTER.
</PRE>
<P><LI>Some programs either implicitly (such as Microsoft Mail version 3.0) or
   explicitly (such as Paradox) encrypt data files. This encryption
   removes any patterns in the data, rendering it incompressible. Storing
   these files on a DoubleSpace drive does not save any disk space and
   increases file write time because DoubleSpace does the work of trying
   to compress the file, but cannot. These types of files, if updated
   often, should be stored on a uncompressed or host drive.
<P>
</OL><h3>Windows 95 or Microsoft Plus!</h3>
 
<P>
Optimizing Performance with Windows 95 or Microsoft Plus! DriveSpace:
<P>
To optimize your computer's performance while running Windows 95 or
Microsoft Plus! DriveSpace, follow these steps:

<OL><P><LI>Verify that the protected-mode DriveSpace driver is being used in
   Windows 95. To do so, double-click the System icon in Control Panel,
   and then click the Performance tab. If the Disk Compression line
   indicates that compressed drives are using MS-DOS Compatibility mode,
   the protected-mode DriveSpace driver is not being used.
<P>
   To cause the protected-mode DriveSpace driver to load when Windows 95
   starts, follow these steps:
<P>
   a. Make sure that the Drvspacx.vxd file is present in the Windows\
<P><PRE>      System\Iosubsys folder. If the file is not present, extract it to
      that folder from the Win95_09.cab cabinet file on the original
      Windows 95 CD-ROM or disk 9, or from the Plus_1.cab cabinet file on
      the original Microsoft Plus! CD-ROM or disk 1.
</PRE><P>
<P><PRE>      For information about using the Extract tool, type "extract" (with-
      out quotation marks) at a command prompt, or see the following
      article in the Microsoft Knowledge Base:
</PRE><P>
<PRE>         ARTICLE-ID: <B><A href="../zmiscellaneous/q129605.htm">Q129605</A></B>
         TITLE     : How to Extract Original Compressed Windows Files 

   b. Copy the Drvspace.bin file from the Windows\Command folder to the
      root folder of the boot drive as both Drvspace.bin and Dblspace.bin.
      To do so, type the following lines at a command prompt, pressing
      ENTER after each command

         copy c:\windows\command\drvspace.bin &lt;drive&gt;:\drvspace.bin /y
         copy c:\windows\command\drvspace.bin &lt;drive&gt;:\dblspace.bin /y

      where &lt;drive&gt; is the physical boot drive. If drive C is compressed,
      copy the Drvspace.bin file to the root folder of the host drive for
      drive C instead of the root folder of drive C.

      NOTE: The /Y switch causes the COPY command to replace existing
      files without prompting you for confirmation.

   After performing these steps, restart your computer and check to see if
   the problem has been resolved. If it has not, perform the following
   additional step:

   c. If you did not extract the Drvspacx.vxd file in step A because it
      already exists in the Windows\System\Iosubsys folder, extract it
      now. In addition, extract the Drvspace.bin file from disk 1 or the
      CD-ROM to the Windows\Command folder. After extracting this file,
      repeat step B.

</PRE><P><LI>Verify that the hard disks are not badly fragmented. Badly fragmented
   hard disks can affect the performance of DriveSpace 3, as well as the
   performance of other Windows 95 components. To ensure that your hard
   disks are not badly fragmented, run Disk Defragmenter to defragment
   them. To run Disk Defragmenter, click the Start button, point to
   Programs, point to Accessories, point to System Tools, and then click
   Disk Defragmenter.

<P><LI>Verify that the drive containing your Windows folder and the Windows
   swap file contains sufficient free disk space. For information about
   creating additional free disk space, view the "Disk Space Trouble-
   shooter" topic in Windows 95 Help.
<P>
</OL>Optimizing Conventional Memory for MS-DOS-Based Programs:
<P>
If you are unable to run an MS-DOS-based program when you restart your
computer in MS-DOS mode or boot to a Windows 95 command prompt after
running Windows 95 or Microsoft Plus! DriveSpace, reconfigure Windows 95
so that more conventional memory is available. To do so, use one of the
following methods:

<UL><LI>If you are running an MS-DOS-based program after restarting your
   computer in MS-DOS mode, modify the Config.sys and Autoexec.bat files
   that are used when the computer restarts in MS-DOS mode so that more
   conventional memory is available. You should modify the Config.sys and
   Autoexec.bat files that are specified in the properties for the program
   you are running in MS-DOS mode, the properties for the shortcut that
   starts the program you are running in MS-DOS mode, or the properties
   for the "Exit to Dos.pif" file that is used to start Windows 95 in
   MS-DOS mode.
<P>
   Use the following steps to modify the Config.sys and Autoexec.bat files
   that are used when the computer restarts in MS-DOS mode so that more
   conventional memory is available. After performing each step, check to
   see if you are able to run the MS-DOS-based program.
<P>
   a. Make sure that the Config.sys file that is used when the computer
<P><PRE>      restarts contains lines similar to the following (in the following
      order):
</PRE><P>
<PRE>         DEVICE=C:\WINDOWS\HIMEM.SYS
         DEVICE=C:\WINDOWS\EMM386.EXE NOEMS
         DOS=HIGH,UMB
         DEVICEHIGH=C:\WINDOWS\COMMAND\DRVSPACE.SYS /MOVE

      These lines make it possible for the real-mode DriveSpace driver to
      load into upper memory, which can free more conventional memory for
      MS-DOS-based programs.

      NOTE: If your MS-DOS-based program requires expanded memory,
      please see the program's documentation for information about how to
      configure Emm386.exe to provide expanded memory.

   b. Try loading device drivers in the Config.sys file using the
      DEVICEHIGH command instead of the DEVICE command. In addition, try
      loading memory-resident programs in the Autoexec.bat file using the
      LOADHIGH command.

   c. Remove any unnecessary drivers and memory-resident programs from the
      Config.sys and Autoexec.bat files that are used when you restart
      your computer in MS-DOS mode.

</PRE><LI>Use the Microsoft Startup Disk Wizard (Nocomp.exe) that is included
   with Microsoft Plus! to create a bootable floppy disk that does not
   load the real-mode DriveSpace driver. To run an MS-DOS-based program
   after booting from the floppy disk created by the Microsoft Startup
   Disk Wizard, the program must be installed on an uncompressed drive.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The DriveSpace compression drivers included with Windows 95 contain
processor-specific code designed for optimal performance on 80386 and
80486 processors. In addition, the DriveSpace 3 compression drivers
included with Microsoft Plus! contain code designed for optimal
performance on Pentium processors. The compression drivers included with
Windows 95 and Microsoft Plus! detect the type of processor that a
computer is using and then use the appropriate code.
<P>
Microsoft Plus! includes DriveSpace 3, which is an enhanced version of
DriveSpace that supports the ability to fine-tune compression for maximum
disk space, maximum system speed, or a balance between disk space and
system speed. If system performance is your primary concern, DriveSpace 3
can be configured accordingly, but doing so will cause your files to take
up considerably more disk space.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbenv<BR>
KBSubcategory: msdos win95 winplus dblspace drvspace<BR>
Additional reference words: 6.00 6.20 6.22 95 slow Ultima 6 Commander Keen<BR>
Serpent Great Battles of the NorthWest<BR>
Keywords          : dblspace drvspace msdos win95 winplus kbfaq<BR>
Version           : 6.00 6.20 6.22 | 95<BR>
Platform          : MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
