

<HTML>
<HEAD>
<TITLE>How to Restore, Convert, Troubleshoot Folders in Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119941">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1994/08/29">
<META NAME="Keywords" CONTENT="appscomp wpp95 win95 kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; win98x">
<META NAME="Description" CONTENT="  This article discusses how Windows 95 converts existing Windows and Windows for Workgroups groups to Windows 95 folders, how to rebuild or restore folders, how the [Restrictions] section from the PROGMAN.INI file is transferred to Windows 95, and h...">
<META NAME="Product" CONTENT="win98x">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QBWO,QDL9,QBWN,QBWQ,QAFI,QAEQ,QBWS,QA47,QAGQ,QDNF,QAY2,QAY0,QASR,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Restore, Convert, Troubleshoot Folders in Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119941</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
********************************************************************
<PRE>     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA

     This article discusses a Beta release of a Microsoft
     product. The information in this article is provided as-is
     and is subject to change without notice.

     No formal product support is available from Microsoft for
     this Beta product. For information about obtaining support
     for a Beta release, please see the documentation included
     with the Beta product files, or check the Web location
     from which you downloaded the release.

     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA
</PRE>********************************************************************
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 98
<LI>Microsoft Windows operating system, versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses how Windows 95 converts existing Windows and Windows
for Workgroups groups to Windows 95 folders, how to rebuild or restore
folders, how the [Restrictions] section from the PROGMAN.INI file is
transferred to Windows 95, and how to troubleshoot failed conversions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: In this article, the term "Windows" refers to Windows versions 3.1
and 3.11 and Windows for Workgroups versions 3.1 and 3.11.
<P>
<P><h3>Groups Versus Folders</h3>
 
<P>
Windows uses groups and group items represented by icons to provide access
to programs. The default groups for Windows are Main, Accessories, Games,
and StartUp. An example of an item within the Main group is Control Panel.
<P>
Windows 95 uses folders and links to provide the same functionality as
groups and items in previous versions of Windows.
<P>
<P><h3>Converting Groups to Folders</h3>
 
<P>
To facilitate the upgrade from Windows to Windows 95, an executable file
named GRPCONV.EXE is included with Windows 95. This file provides the
translation of groups and group items to folders and links.
<P>
Each group is converted to a folder, and its items are converted to shell
links, which are placed within that particular folder.
<P>
GRPCONV.EXE uses information from the registry to track changes in group
files that have occurred since the last time GRPCONV.EXE was run. There are
no entries in either the SYSTEM.INI or WIN.INI file that take precedence
over these system registry entries.
<P>
The last modified date and time of the PROGMAN.INI file and all group files
are stored in the system registry:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\GrpConv

</PRE>GRPCONV.EXE runs automatically after Setup has copied most of the files
needed for a complete installation and rebooted your computer. You can also
run GRPCONV.EXE manually. GRPCONV.EXE supports the following switches:

<UL><LI>/S
<P>
   GRPCONV.EXE, when run with the /S switch, rebuilds the default
   Windows 95 folders. A status dialog box titled "Start Menu Shortcuts"
   appears during the rebuilding process. When it is complete, you are
   returned to the desktop.

<LI>/M
<P>
   GRPCONV.EXE, when run with the /M switch, lets you manually convert
   existing Windows groups to Windows 95 folders. You can convert only one
   group at a time using this method. If the groups are in the directory in
   which you install Windows 95, they are automatically converted during
   Setup.
<P>
</UL>To re-create the default folders that ship with Windows 95:

<OL><P><LI>Click the Start button, and then click Run.

<P><LI>Type the following command:
<P>
<P><PRE>      grpconv /s
</PRE><P>
</OL>Use the following steps to convert existing Windows groups to the
Windows 95 format:

<OL><P><LI>Click the Start button, and then click Run.

<P><LI>Type the following:
<P>
<P><PRE>      grpconv /m
</PRE>
<P><LI>Click the group you want to convert.

<P><LI>Do one of the following:
<P>
<P><PRE>    - Click Open, then click Yes in the "Program Manager Group
      Converter" dialog box.
</PRE><P>
<P><PRE>      When you click Yes, a status dialog box titled "Start Menu Shortcuts"
      appears during the rebuilding process. When it is complete, you are
      returned to the desktop.
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - Convert the group by double-clicking the group name. For
      example, if you have a group called MYGROUP.GRP, you can
      double-click MYGROUP.GRP to convert it to the Windows 95
      folder format.
</PRE><P>
</OL><h3>Other GRPCONV.EXE Specifics</h3>
 

<UL><LI>The first time GRPCONV.EXE runs, the search path criteria for
   finding existing groups is strictly based on the contents of
   the PROGMAN.INI file in the current Windows directory (if it
   exists).

<LI>Group names and item names are not sorted prior to conversion.
   Group conversion begins with the first group in the directory,
   and shell links are created beginning with the first item in a
   group.

<LI>Memory required for conversion of groups is allocated per group
   item as needed and then released all at once at the end of
   processing each group. No temporary files are created during
   conversion.

<LI>All data in a .GRP file, except icon location (x, y coordinates
   in a group), is used during conversion and migrated to folders in
   the Windows 95 \PROGRAMS folder.

<LI>GRPCONV.EXE calls the shell link creation APIs directly, and as such
   does not call any executables during conversion.

<LI>Windows Program Manager has been known to create corrupted .GRP files
   that may work in their native environment, but have the potential to
   cause errors during conversion in Windows 95. GRPCONV.EXE recognizes
   corrupted .GRP files and properly converts them.

<LI>If one or more groups are not converted to folders, or if one or more
   items in a group are not converted to links, follow the methods outlined
   in the "Troubleshooting Group Conversion" section below.
<P>
</UL><h3>Restrictions Migration for Upgrades</h3>
 
<P>
GRPCONV.EXE migrates the [Restrictions] section of the PROGMAN.INI file
from previous versions of Windows into the Policies section of the
system registry.
<P>
<P><h3>Troubleshooting Group Conversion</h3>
 
<P>
If a group fails to be converted or if an error is displayed during
conversion, use the following steps to troubleshoot the problem:

<OL><P><LI>Use GRPCONV.EXE to convert a group file that was previously converted
   successfully. If this fails, GRPCONV.EXE has been corrupted, and you
   must replace this file with the GRPCONV.EXE file from your original
   Windows 95 disks. If this step is successful, continue with step 2.

<P><LI>Run the PROGMAN.EXE file that ships with Windows 95 and view the group
   that did not convert. If it displays and acts correctly in Program
   Manager, create a new group and copy (do not move) the items from the
   original group to the new one.

<P><LI>Close Program Manager and run GRPCONV.EXE in interactive mode
   (grpconv /m) to convert the newly created group. If this step fails,
   continue with step 4.

<P><LI>Run Program Manager, delete the items in the newly created group, and
   copy a few of the items from the original group into the new group. If
   this fails, repeat this step with different items until you have
   determined which item is causing the failure.
<P>
</OL>NOTE: It is also possible for a virus to cause conversion failure.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 tshoot<BR>
Keywords          : appscomp wpp95 win95 kbfaq<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
