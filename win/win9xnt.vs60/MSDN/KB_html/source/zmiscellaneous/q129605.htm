

<HTML>
<HEAD>
<TITLE>How to Extract Original Compressed Windows Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129605">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1995/04/30">
<META NAME="Keywords" CONTENT="kbtool win98 win95">
<META NAME="KBArea" CONTENT="Support; KB; win98x">
<META NAME="Description" CONTENT="  Windows 95 is available on CD-ROM or floppy disks, both of which contain compressed cabinet files. Windows 98 is available on CD-ROM, and it also contains compressed cabinet files. These cabinet files contain the actual Windows files. Because this ...">
<META NAME="Product" CONTENT="win98x">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIY,QA3P,QDL9,QBWO,QBWN,QBWQ,QATF,QANE,QAC9,QAY2,QAIJ,QDLP,QAHE,QAB5,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Extract Original Compressed Windows Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129605</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
********************************************************************
<PRE>     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA

     This article discusses a Beta release of a Microsoft
     product. The information in this article is provided as-is
     and is subject to change without notice.

     No formal product support is available from Microsoft for
     this Beta product. For information about obtaining support
     for a Beta release, please see the documentation included
     with the Beta product files, or check the Web location
     from which you downloaded the release.

     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA
</PRE>********************************************************************
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 98
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows 95 is available on CD-ROM or floppy disks, both of which contain
compressed cabinet files. Windows 98 is available on CD-ROM, and it also
contains compressed cabinet files. These cabinet files contain the actual
Windows files. Because this method of compression differs from that used
with versions of Windows before Windows 95, there is a tool (Extract.exe)
to decompress individual Windows files.
<P>
You can use the Extract tool to decompress Windows files from the original
media. This article describes how to use the Extract tool and contains the
following sections that apply to both Windows 95 and Windows 98:

<UL><LI>Location of Cabinet Files
<LI>Extracting Windows Files from an Unknown Cabinet File
<LI>Finding Windows Files
<LI>Extracting Windows Files from a Known Cabinet File
<LI>Listing the Contents of Cabinet Files
<LI>Copying Cabinet Files to a Hard Disk
<LI>Other Optional Switches
<P>
</UL>The following sections apply only to Windows 98:

<UL><LI>System File Checker Tool
<LI>Using a Windows 98 Startup Disk to Access a CD-ROM and Extract Files
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
To use the Extract tool, first copy the Extract.exe file from disk 1 to
the root folder of drive C if you are using Windows 95. Note that you can
skip this step if you are using Windows 98 and you have already created a
Windows 98 Startup disk. To create a Windows 98 Startup disk, see the
"Using a Windows 98 Startup Disk to Access a CD-ROM and Extract Files"
section of this article. To copy the Extract.exe file from disk 1 to the
root folder of drive C, type the following command at the MS-DOS prompt
<P>
<PRE>   copy &lt;sdrive&gt;:\extract.exe &lt;hdrive&gt;:\

</PRE>where &lt;sdrive&gt; is the drive that contains the Windows 95 CD-ROM or disk
and &lt;hdrive&gt; is your hard disk.
<P>
For example:
<P>
<PRE>   copy a:\extract.exe c:\

</PRE>The Extract tool has only a command-line interface (that is, there is no
GUI interface). Because Windows does not allow you to delete or overwrite
a file that is in use, you may have to restart your computer in Command
Prompt Only mode before you can use the Extract tool. If you receive an
"Access denied" error message when you try to delete a file before using
the Extract tool, or when you use the Extract tool to overwrite an
existing file, follow these steps to restart your computer in Command
Prompt Only mode and then use the Extract tool:

<OL><P><LI>Click Start, and then click Shut Down.

<P><LI>Click Restart or Restart The Computer, and then click OK or Yes.

<P><LI>If you are using Windows 95, when you see the "Starting Windows 95"
   message, press the F8 key, and then choose Command Prompt Only. If you
   are using Windows 98, when you restart your computer, press and hold
   the CTRL key until you see the Windows 98 Startup menu, and then choose
   Command Prompt Only.
<P>
</OL><h3>Location of Cabinet Files</h3>
 
<P>
From a CD-ROM:
<P>
If you are extracting Windows files from a CD-ROM, all of the cabinet
files are located in the Win95 or Win98 folder. For example, if you
want to extract a Windows 95 file from the Win95_02.cab file, and the
CD-ROM drive is drive D, use the following &lt;cabinet&gt; parameter for the
EXTRACT command:
<P>
<PRE>   d:\win95\win95_02.cab

</PRE></OL>From Disks:
<P>
If you are extracting Windows 95 files from disks, use the following table
to determine which disk contains the cabinet file you want:
<P>
<PRE>   Cabinet File    Disk
   -----------------------
   Mini.cab        Disk 1
   Precopy1.cab    Disk 1
   Precopy2.cab    Disk 2
   Win95_nn.cab    Disk nn

</PRE>For example, if you want to extract a file from the Win95_10.cab file on a
disk in drive A, insert disk 10 in drive A and use the following &lt;cabinet&gt;
parameter for the EXTRACT command:
<P>
<PRE>   a:\win95_10.cab

</PRE><h3>Extracting Windows Files from an Unknown Cabinet File</h3>
 
<P>
Extracting a Single File:
<P>
If you do not know which cabinet file contains the Windows file you want
to extract, use the following command to search all the cabinet files in
sequential order and then extract the file once it is found:
<P>
<PRE>   extract /a &lt;cabinet&gt; &lt;filename&gt; /l &lt;destination&gt;

</PRE>For example, to extract the Unidrv.dll file from disks in drive A into the
Windows\System folder on drive C, use the following command:
<P>
<PRE>   extract /a a:\win95_02.cab unidrv.dll /l c:\windows\system

</PRE>The /a switch causes the Extract tool to search all the cabinet files
starting with the first cabinet file mentioned on the command line (in
this example, Win95_02.cab). Insert the disk containing the first cabinet
file mentioned in the appropriate disk drive. You will be prompted to
insert additional disks as they are needed. If you are extracting from a
CD-ROM you must modify the &lt;cabinet&gt; parameter accordingly to reflect the
actual location of the cabinet files.
<P>
NOTE: In Windows 98, you should use the Base4.cab file in command lines
with the /a parameter.
<P>
If the Extract tool cannot find the specified Windows 95 file in any of
the cabinet files, the file may be located in the Mini.cab, Precopy1.cab,
or Precopy2.cab cabinet file. Use the following two commands to search
these cabinet files:

<UL><LI>extract /a a:\precopy1.cab &lt;filename&gt; /l &lt;destination&gt;

<LI>extract a:\mini.cab &lt;filename&gt; /l &lt;destination&gt;
<P>
</UL>NOTE: The first command searches the Precopy1.cab and the Precopy2.cab
cabinet files. The second command searches the Mini.cab cabinet file. If
you are extracting from a CD-ROM, you must modify the &lt;cabinet&gt; parameter
in these commands accordingly.
<P>
Extracting Multiple Files:
<P>
To extract multiple files, use the same syntax as above, but use a
wildcard designation for the &lt;filename&gt; parameter. For example, to extract
all the Windows 95 files with a .txt extension from disks in drive A to
the Windows folder on drive C, use the following command:
<P>
<PRE>   extract /a a:\win95_02.cab *.txt /l c:\windows

</PRE>Note that if you are extracting from a CD-ROM, you must modify the
&lt;cabinet&gt; parameter in this command accordingly.
<P>
<P><h3>Finding Windows Files</h3>
 
<P>
Finding a Single File:
<P>
You can use the Extract tool to determine which cabinet file contains a
particular Windows file. When you use this syntax, the Extract tool
searches the cabinet files but does not extract the file once it is found:
<P>
<PRE>   extract /a /d &lt;cabinet&gt; &lt;filename&gt;

</PRE>For example, to find the Windows 95 Unidrv.dll file, starting with the
Win95_02.cab file, using disks in the A drive, use the following command:
<P>
<PRE>   extract /a /d a:\win95_02.cab unidrv.dll

</PRE>Finding Multiple Files:
<P>
To find multiple files, use the same syntax as above, but use a wildcard
designation for the &lt;filename&gt; parameter. For example, to find all the
Windows 95 files with a .txt extension using disks in the A drive, use the
following command:
<P>
<PRE>   extract /a /d a:\win95_02.cab *.txt

</PRE><h3>Extracting Windows Files from a Known Cabinet File</h3>
 
<P>
Extracting a Single File:
<P>
If you know which cabinet file contains the file you want to extract, use
the following syntax to extract the file:
<P>
<PRE>   extract &lt;cabinet&gt; &lt;filename&gt; /l &lt;destination&gt;

</PRE>For example, to extract the Windows 95 Unidrv.dll file from the
Win95_10.cab file on a disk in drive A to the Windows\System folder
on drive C, use the following command:
<P>
<PRE>   extract a:\win95_10.cab unidrv.dll /l c:\windows\system

</PRE>Extracting Multiple Files:
<P>
To extract multiple files from a cabinet file, use the same syntax as
above, but use a wildcard designation for the &lt;filename&gt; parameter. For
example, to extract all the Windows 95 files that have a .txt extension
from the Win95_06.cab file on a disk in drive A to the Windows folder on
drive C, use the following command:
<P>
<PRE>   extract a:\win95_06.cab *.txt /l c:\windows\system

</PRE><h3>Listing the Contents of Cabinet Files</h3>
 
<P>
You can use the Extract tool to list the contents of cabinet files without
actually extracting any files. To display the contents of a cabinet file,
use the following syntax:
<P>
<PRE>   extract /d &lt;cabinet&gt;

</PRE>To display the contents of all the cabinet files in a cabinet chain,
starting with the specified cabinet file, use the following syntax:
<P>
<PRE>   extract /a /d &lt;cabinet&gt;

</PRE>For example, to display the contents of all the Windows 95 cabinet files
using disks in drive A, starting with the Win95_02.cab file, use the
following command:
<P>
<PRE>   extract /a /d a:\win95_02.cab

</PRE>NOTE: The /a switch causes the Extract tool to list the contents of all
the cabinet files in the cabinet chain, starting with the first cabinet
file mentioned.
<P>
<P><h3>Copying Cabinet Files to a Hard Disk</h3>
 
<P>
Although you cannot make copies of the original Windows 95 floppy disks
using the utilities that are included with Windows 95, you can use the
Extract tool to copy cabinet files from a CD-ROM or floppy disk to your
hard disk. To do so, use the following syntax:
<P>
<PRE>   extract /c &lt;cabinet&gt; &lt;destination&gt;

</PRE>For example, to copy the Win95_02.cab file from a disk in drive A to the
Windows folder on drive C, use the following command:
<P>
<PRE>   extract /c a:\win95_02.cab c:\windows

</PRE>NOTE: You cannot use the /a and /c switches at the same time. Therefore,
you cannot copy all the cabinet files using a single command.
<P>
<P><h3>Other Optional Switches</h3>
 

<UL><LI>Use the /y switch to cause the Extract tool to not prompt you before
   overwriting an existing file. If you use this switch when you are
   extracting a file, any file in the destination folder with the
   same name as the file you are extracting is automatically overwritten.
<P>
   For example, to extract the Unidrv.dll file from the Win95_02.cab file
   on a disk in drive A to the Windows\System folder on drive C and
   automatically overwrite any existing Unidrv.dll file that is already
   there, use the following command:
<P>
<P><PRE>      extract /y /a a:\win95_02.cab unidrv.dll /l c:\windows\system
</PRE>
<LI>Use the /e switch in place of the "*.*" wildcard designation when
   you are extracting or finding multiple files. For example, to
   extract all the files from the Win95_06.cab file on a disk in drive A
   to the Windows folder on drive C, use either of the following
   commands:
<P>
<P><PRE>    - extract /e a:\win95_06.cab /l c:\windows
</PRE><P>
<P><PRE>    - extract a:\win95_06.cab *.* /l c:\windows
</PRE><P>
</UL>For a complete list of the command-line switches for the Extract tool,
type "extract" (without quotation marks) at a command prompt.
<P>
<P><h3>System File Checker Tool</h3>
 
<P>
Windows 98 includes a System File Checker tool. You can use this tool
to verify the integrity of your operating system files, to restore them
if they are damaged, or to extract compressed files from the Windows 98
CD-ROM. To use System File Checker to extract a compressed file from the
Windows 98 CD-ROM, follow these steps:

<OL><P><LI>Click Start, point to Programs, point to Accessories, point to System
   Tools, and then click System Information.

<P><LI>On the Tools menu, click System File Checker.

<P><LI>Click "Extract one file from installation disk," type the name of the
   file you want to extract in the "Specify the system file you would like
   to restore" box, and then click Start.

<P><LI>In the Restore From box, type the path to the Win98 folder on the
   Windows 98 CD-ROM, type the destination folder in the Save File In box
   if necessary, and then click OK.

<P><LI>Click OK, click OK, and then click Yes when you are prompted to restart
   your computer.
<P>
</OL><h3>Using a Windows 98 Startup Disk to Access a CD-ROM and Extract Files</h3>
 
<P>
When you install Windows 98, you are prompted to create a Windows 98
Startup disk. A feature included in the Windows 98 Startup disk is support
for CD-ROM drives. This may be of benefit if you need to extract a file
from the Windows 98 CD-ROM but you are unable to use System File Checker
(for example, if your computer does not start properly).
<P>
NOTE: The Windows 98 Startup disk provides support for most types of
CD-ROM drives, including IDE and SCSI CD-ROM drives, but it may not
support your particular CD-ROM drive.
<P>
A Windows 98 Startup disk is required to perform the steps in the
following sections of this article. If you do not have one, you can create
one using any Windows 98-based computer to which you have access. To
create a Windows 98 Startup disk, follow these steps:

<OL><P><LI>Click Start, point to Settings, click Control Panel, and then double-
   click Add/Remove Programs.

<P><LI>Click the Startup Disk tab, click Create Disk, and then follow the
   instructions on the screen.
<P>
</OL>How to Start Your Computer with CD-ROM Support and Then Extract Files:
<P>
To start your computer with CD-ROM support and then extract files, use the
following steps:

<OL><P><LI>Insert the Windows 98 Startup disk in drive A, and then restart
   your computer.

<P><LI>When the Microsoft Windows 98 Startup menu appears, choose Start
   Computer With CD-ROM Support.

<P><LI>Insert the Windows 98 CD-ROM in the CD-ROM drive.

<P><LI>To extract files at the command prompt, you can use the information
   provided earlier in this article, or you can use the Extract Command
   Line Helper tool. To use Extract Command Line Helper, type "ext"
   (without quotation marks) at the command prompt, and then follow the
   instructions on the screen.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 98<BR>
Keywords          : kbtool win98 win95<BR>
Version           : WINDOWS:95,98<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
