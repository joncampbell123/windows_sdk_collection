

<HTML>
<HEAD>
<TITLE>PRB: Test "Parser Out of Memory" Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87455 ">
<META NAME="KBModify" CONTENT="1995/04/05">
<META NAME="KBCreate" CONTENT="1992/07/30">
<META NAME="Keywords" CONTENT="kbtool kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; mstest">
<META NAME="Description" CONTENT="  A  Parser out of memory  error occurs when running a Test for Windows, version 1.0 script file under Test Driver.  CAUSE =====  The  Parser out of memory  error in Test means the Test Driver pseudocode engine has exceeded its memory limit on an obj...">
<META NAME="Product" CONTENT="Visual Test">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QDNQ,QAVX,QAVW,QDNU,QAB4,QBW6,QAEF,QAAP,QBE7,QBE6,QATX,QAGI,QAU9,QAKC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Test "Parser Out of Memory" Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87455 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Test for Windows, version 1.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A "Parser out of memory" error occurs when running a Test
for Windows, version 1.0 script file under Test Driver.
<P>
<P><h2>CAUSE</h2>
 
<P>
The "Parser out of memory" error in Test means the Test Driver
pseudocode engine has exceeded its memory limit on an object. Three
types of objects can cause this error (listed in descending order
of probability):

<OL><P><LI>Code segment memory (64K)
</OL>2. Data segment memory (64K)
3. Parser table memory (tables are variably-sized)
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Reduce the size of the object causing the error. Resolution depends
on the object causing the error. Various methods of working around
the error are shown below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The "parser" is the part of Test Driver that translates the script
code entered by the programmer into machine-language pseudocode and
executes it.
<P>
<P><h3>Code Segment Memory</h3>
 
<P>
The most common cause of the "Parser out of memory" error message is
that the script code is larger than the 64K code segment. (One 64K
code segment is allotted for each script file.) Solve this problem by
dividing your large code script into two or more smaller scripts that
are called sequentially from a "driver" script. (For an example of
this technique, see the TSTSUITE application in
MSTEST\SAMPLES\TSTSUITE. DRIVER.MST is the driver script that calls
various other scripts from itself.)
<P>
Another technique, which can be used along with the first to shrink
code space, is to create a "wrapper" routine. In this case, a wrapper
routine is a SUB or FUNCTION that makes only one call to DLLs with
large numbers of parameters. Without a wrapper routine, numerous
direct DLL calls are made, generating more internal code, especially
with DLLs with large numbers of parameters.
<P>
<P><h3>Data Segment Memory</h3>
 
<P>
The second most probable cause of the "Parser out of memory" error is
a data segment memory overflow. If your script has many variables
(particularly arrays) and many quoted literal strings (particularly
long strings), you probably have run out of data segment memory. If
you suspect this has happened, you can:

<UL><LI>Remove some quoted string literals, particularly larger ones, and
   place them into an external data file. Strings can then be read in
   as needed during run time. If the problem persists, move more
   quoted literal strings to the external data file.

<LI>Consider replacing all arrays with their pointer compliments. (This
   will not work with variable-length string arrays, because they use
   string descriptors.) For example, if an array of 1000 integers is
   defined:
<P>
<PRE>        'Array syntax:
        Dim x%(1000)
        x%(0) = 32767   'Set first element of array to 32767.

        You can convert it to its pointer compliment with:

        'Pointer Syntax:
        Dim x As Pointer To Integer
        Allocate x, 1000
        x[0] = 32767    'Set first element of array to 32767.

        (Note: Arrays in Test Basic are in the form 0 - (n-1), so the
           above array of 1000 elements goes from x[0] to x[999].)

</PRE></OL><h3>Parser Table Memory</h3>
 
<P>
The least probable cause is an overflow of a parser table--a memory
area where code elements such as variables, user-defined TYPEs, SUBs
and FUNCTIONs, are stored.
<P>
A parser table overflow is rare, because code or data segment memory
will normally overflow first. However, if you still suspect this, try
to reduce the load on each parser table by reducing the number of SUBs
or FUNCTIONs in your program, the number of user-defined TYPEs, the
number of variables, and so on.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00<BR>
KBCategory: kbtool kbprg kbprb<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 5, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
