

<HTML>
<HEAD>
<TITLE>PRB: MIFST Frequently Asked Questions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182448">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/03/13">
<META NAME="Keywords" CONTENT="kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  This article contains the most frequently asked questions (FAQs) on the Microsoft Internet Finance Server Toolkit (MIFST).  MORE INFORMATION  MIFST Installation and Configuration  Q: Sockets Resource Manager sample code is not included in the produ...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QDJO,QDOP,QBVV,QAVZ,QBXB,QBXL,QAZV,QAAP,QAEF,QAJ6,QAVX,QAVW,QAUD,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: MIFST Frequently Asked Questions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182448</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Finance Server Toolkit
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains the most frequently asked questions (FAQs) on the
Microsoft Internet Finance Server Toolkit (MIFST).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>MIFST Installation and Configuration</h3>
 
<P>
Q: Sockets Resource Manager sample code is not included in the product.
<P>
A: It is available upon request (a Knowledge Base article is pending).
<P>
<P>
Q: Requests from Quicken are rejected by MIFST.
<P>
A: Quicken uses only a linefeed (instead of carriage-return/linefeed) to
separate the OFX headers. A temporary workaround for MIFST is available.
The question of whether CR-LF is required or not is currently being
debated.
<P>
<P>
Q: How do I use the "Validate FII OFX Response" option?
<P>
A: This will cause a 400 application error to be returned if there are any
errors in the response, and the response to be written to the log file. You
can use the Parser Shell Tool to see exactly what the error is.
<P>
<P>
Q: Where do I get the Parser Shell Tool?
<P>
A: Download the tool from the following Web site:
<P>
<PRE>     <B><A href="http://www.microsoft.com/industry/finserv/mifst/tools.htm">http://www.microsoft.com/industry/finserv/mifst/tools.htm</A></B>


</PRE>Q: Can I use MIFST 1.0 with Internet Information Server (IIS) 4.0?
<P>
A: MIFST 1.0 was designed and tested for IIS 3.0. Testing with IIS 4.0 has
begun, and no problems have been found so far.
<P>
<P>
Q: Can I install the Web Development Kit and Translation Server on the
same system?
<P>
A: This is an unsupported configuration. It is not tested for, and most
reports are that it does not work. Each component (Web kit, TS, and
Security Server) must be on its own machine.
<P>
<P>
<P><h3>Questions on MIFST Development</h3>
 
<P>
Q: How do I get the Translation Server to use my custom FII component?
<P>
A: There are two registry settings to set. The following lines can be
placed in a .reg script file, substituting the CLSIDs of your custom FII.
Double-clicking the .reg file causes the new registry settings to be
entered:
<P>
<PRE>   REGEDIT4

   [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\OFX_Gateway]
   "FI_Interface_Component"="{EFABEA05-9140-11D0-B091-00AA006C588C}"
   "FI_Interface_Module"="{EFABEA07-9140-11D0-B091-00AA006C588C}"


</PRE>Q: Why is there a memory leak in Get_Entity_Path()?
<P>
A: You may have seen this function documented in an SDK Errata. There is a
known memory leak that occurs any time it is called. Its functionality can
be achieved by the use of other Parser object functions, and it should not
be used at this time.
<P>
<P>
Q: Why does the parser hang (in an infinite loop) after returning from the
FI frame?
<P>
A: This may be due to an invalid aggregate tag. Make sure that all
aggregate objects are set to the proper name.
<P>
<P>
Q: Why don't the SDK Samples compile?
<P>
A1: Set Visual C++ directories to point to necessary libraries and header
files. A2: Remove the old SDK before installing new one, to make sure that
old files aren't being used.
<P>
<P>
Q: How can I turn off MIFST Crash Recovery?
<P>
A: You can't. When using Lite Synchronization, Crash Recovery is required
by the OFX Specification. When using Full Synchronization, it is not
required, but the current version of MIFST offers no way to disable it. See
pages 40 - 43 of the Gateway Development Guide and section 6.10.2 of the
OFX Specification.
<P>
<P>
Q: How can I add a custom installation OCX to the Gateway Administrator, as
mentioned on page 58 of the Gateway Development Guide?
<P>
A: At this time, no documentation is available for this.
<P>
<P>
Q: How can I use Directory Services to store and retrieve my custom FII
information?
<P>
A: Within the FII component, you can use the Directory Services component.
From outside the FII, you would need to directly call the stored procedures
in the Directory Services database. There is no SDK available for the
stored procedures at this time.
<P>
Q: Why does the ping tool terminate when a response is received?
<P>
A: If the response is greater than 65K (the maximum size for a text box),
this will occur.
<P>
<P>
Q: IParser::Validate() succeeds on a response that MIFST rejected as an
error. Why?
<P>
A: The successful return just means that the function did not encounter an
unexpected error; it does not indicate that the response itself is valid
OFX. To test for errors, you must call IParser-
&gt;get_Validate_Error_Count().
<P>
<P>
Q: When I correct a password in a request and resend it, the Translation
Server rejects the request. Why?
<P>
A: The previous request with the incorrect password is still in Crash
Recovery. If the new request has the same NEWFILEUID, the CRC value for the
new request will not match that of the previous request (since the
passwords are different). This is an ambiguity in the OFX specification,
and a resolution is being worked on. Once the Crash Recovery cleanup tasks
have removed the previous request, the new one will succeed. For
development purposes, you run the following ISQL commands to remove just
the problem request from Crash Recovery, assuming that you know the
NEWFILEUID (substitute this where you see NEWFILEUID below):

<OL><P><LI>In the Crash Recovery List Database, the following will return the
   Server and Database in which the data is stored. Make note of this.
<P>
<P><PRE>      CrashRecoveryIndexDel @FILEUID = "NEWFILEUID"
</PRE>
<P><LI>Then, still on the Crash Recovery List database, the following deletes
   the entry from the Crash Recover list database:
<P>
<P><PRE>      CrashRecoveryIndexDel @FILEUID = "NEWFILEUID"
</PRE>
<P><LI>Now go to the Crash Recovery database determined in step 1. On this
   database the following will delete the actual Crash Recovery Database
   entry:
<P>
<P><PRE>      OFX_Header_Del @FILEUID = "NEWFILEUID", @DeleteFlag="Y"
</PRE><P>
<P>
</OL><h3>Questions on the Web Development Kit</h3>
 
<P>
Q: Does the IOFXParseAndBuild interface support crash recovery? How do you
<PRE>   get/put OLDFILEID/NEWFILEID information?

</PRE></OL>A: The client-side IOFXParseAndBuild interface does not support crash
recovery, so you cannot specify OLDFILEID/NEWFILEID.
<P>
<P>
Q: In the OFX Headers, the Web client requests are hard-coded with SECURITY
TYPE = NONE. Will this be a problem if your Gateway is expecting a
different security type?
<P>
A: This will be fixed in the next version of MIFST.
<P>
<P>
Q: The Web client requires a valid SSL connection with the OFX server. How
do I handle this if I don't want to test with one?
<P>
A: If your OFX server does not have a valid certificate, you will need to
follow the instructions on page 8 of the Web Development Guide to turn off
the SSL verification.
<P>
<P>
Q: In the ParseAndBuild object of the Web client, the pointer pofxDoc-
&gt;pofxBankingRSV1-&gt;psyncrs-&gt;ptrnrs is not valid [is null] after the Parse()
method call. Why?
<P>
A: This is a bug in this release of MIFST. The next element in the
structure, pofxDoc-&gt;pofxBankingRSV1-&gt;psyncrs-&gt;szINCIMAGES, will contain the
pointer to ptrnrs.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbmifst<BR>
Keywords          : kbfaq<BR>
Version           : WINNT:3.0<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
