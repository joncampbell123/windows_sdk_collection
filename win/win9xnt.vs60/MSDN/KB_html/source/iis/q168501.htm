

<HTML>
<HEAD>
<TITLE>ASP Downloads Text Instead of Executing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168501">
<META NAME="KBModify" CONTENT="1997/11/07">
<META NAME="KBCreate" CONTENT="1997/05/13">
<META NAME="Keywords" CONTENT="iisinterop kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  Microsoft Active Server Pages (ASP) download instead of executing,  even after you install the ASP fix for IIS.  CAUSE =====  You may have a virtual directory defined to a physical directory  which parent is another virtual directory, and both have...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QBXB,QAFI,QDNQ,QDH9,QAP2,QBVV,QAO0,QBW7,QAI5,QA1S,QARM,QBWG,QBWP,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ASP Downloads Text Instead of Executing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168501</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Active Server Pages (ASP) download instead of executing, 
even after you install the ASP fix for IIS.
<P>
<P><h2>CAUSE</h2>
 
<P>
You may have a virtual directory defined to a physical directory 
which parent is another virtual directory, and both have different
permissions.
<P>
<P><h3>Example</h3>
 
<P>
Physical Directory c:\InetPub\wwwroot has an alias of "/" with Read 
Access
<P>
Physical Directory c:\InetPub\wwwroot\cgi-scripts has an alias of 
"/cgi-scripts" with Execute access.
<P>
If you were to type in &lt;server&gt;/cgi-scripts/&lt;filename&gt;.asp everything
would work. However, if you used the 8.3 naming convention
..  &lt;server&gt;/cgi-sc~1/&lt;filename&gt;.asp, the server would not find the 
virtual directory because it is not aware of long file names and 
their 8.3 equivalents). Because it did not find a virtual directory, 
it would reference the file through the physical directory structure. 
Therefore, it would load the ASP file with the roots access of Read.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
It is recommended that you never create virtual directories to physical 
directories under existing virtual directories.
 
<PRE>Keywords          : iisinterop kbinterop kbprb
Version           : winnt:3.0
Platform          : winnt
Hardware          : ALPHA x86
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
