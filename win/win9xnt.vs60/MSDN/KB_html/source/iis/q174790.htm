

<HTML>
<HEAD>
<TITLE>IIS Hangs When Querying a FoxPro Database w/ ASP or IDC/HTX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174790">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1997/10/06">
<META NAME="Keywords" CONTENT="iisodbc kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  When you query a FoxPro database using Active Server Pages (ASP) or the  Internet Database Connector (IDC/HTX), the Internet Information Server (IIS) appears to hang, and the web browser appears not to respond to the web site.  The web browsers' st...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QBXB,QAFI,QAYL,QBWG,QBVX,QBWP,QBFN,QBG2,QAK7,QAZV,QAVZ,QDNQ,QAX1,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>IIS Hangs When Querying a FoxPro Database w/ ASP or IDC/HTX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174790</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to: 

<UL><LI>Microsoft Internet Information Server versions 2.0 and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you query a FoxPro database using Active Server Pages (ASP) or the 
Internet Database Connector (IDC/HTX), the Internet Information Server (IIS)
appears to hang, and the web browser appears not to respond to the web site. 
The web browsers' status bar would read as follows:
<P>
<PRE>   Web site found. Waiting for reply...

</PRE>However, the web server gives no response.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior by the IIS server is caused by incorrect permissions being 
granted to the IUSR_machine-name account. The Visual FoxPro ODBC database 
driver will try to create *.tmp in the \Winnt\System32 directory. Because 
the IUSR_machine-name account does not have the Write and Delete permissions
to that \Winnt\System32, the process will fail causing the IIS server to no 
longer respond.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two possible solutions to this problem.
<P>
<P><h3>Option 1</h3>
 
<P>
Grant your anonymous user (IUSR_machine-name by default) or the authenticated
Windows NT user account the following permissions to the these directories:
<P>
When you apply these permissions, only apply them to all existing files, 
unless otherwise noted. Please be aware that where the IUSR account is 
noted you would need to add all user accounts that will be authenticated 
on the IIS server.

<OL><P><LI>Grant IUSR Read permission to the Root directory of the drive that 
   ASP is installed on.

<P><LI>Grant IUSR Write permission to the Windows NT directory.

<P><LI>Grant IUSR Read permission to the System32 directory.

<P><LI>Grant IUSR Read permission to the Inetserv directory.

<P><LI>Grant IUSR Read permission to the InetPub (or content directory)
   By default, the next two directories are located in Program Files, 
   Common Files, System and are only needed for ASP/ADO queries.

<P><LI>Grant IUSR Read permission to the OLE DB directory.

<P><LI>Grant IUSR Read permission to the ADO directory.

<P><LI>Grant IUSR Change permissions to the Database file and directory.
<P>
</OL><h3>Option 2</h3>
 
<P>
FoxPro uses the System's TEMP and TMP environment variables to specify the 
location of temporary files created during FoxPro operations. By default 
these environment variables are defined for users and are not system wide 
settings. To set these environment variables for the System, do the following:

<OL><P><LI>Right-click My Computer.

<P><LI>Choose Properties and select the Environment tab.

<P><LI>Click an entry in the System Variables List box (the one on top).

<P><LI>In the Variable and Value Edit control, type the following:
<P>
   Variable = TEMP
   Value = C:\Temp

<P><LI>Click the Set button. You will now see TEMP has been added to the list 
   of system variables. Repeat the process for the TMP variable. 

<P><LI>Log off and restart the computer.

<P><LI>Grant IUSR Read permission to the System32 directory.
<P>
   NOTE: Because the FoxPro driver no longer needs to create TEMP files in
   the System32 directory, the IUSR account should only have Read permissions
   to that directory.)
</OL> 
<PRE>Keywords          : iisodbc kberrmsg kbprb
Version           : 2.00 3.00
Platform          : winnt
Hardware          : ALPHA x86
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
