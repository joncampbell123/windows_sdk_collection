

<HTML>
<HEAD>
<TITLE>Configuring Internet Server Gopher Searches </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142859">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1996/01/21">
<META NAME="Keywords" CONTENT="iisconfig iishowto kbusage ntnetserv nttcp">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  The search function to search for files on a Gopher server is not included with Microsoft Internet Server. However, Microsoft Internet Server does support searching through the European Microsoft Windows NT Academic Centre (EMWAC) Wide Area Informa...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QABI,QA28,QDH8,QAA1,QDI2,QBSO,QBRZ,QAFI,QDMH,QBXB,QBFY,QAVZ,QDJ3,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Configuring Internet Server Gopher Searches</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142859</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The search function to search for files on a Gopher server is not included
with Microsoft Internet Server. However, Microsoft Internet Server does
support searching through the European Microsoft Windows NT Academic Centre
(EMWAC) Wide Area Information Server (WAIS) Toolkit, which is included in
the Windows NT Resource Kit. You can use these tools to prepare and search
full-text databases for computers running Microsoft Windows NT.
<P>
NOTE: If you install the WAIS Toolkit, make sure to do it after you install
the Microsoft Internet Information Server software.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following procedure shows how the server conducts searches for
information:

<OL><P><LI>The process passes the information typed in at the client as search
   strings.
</OL>2. The server does the search.
3. The filenames containing the strings are retrieved.
4. The server converts the filenames to a Gopher Menu.
5. The server sends the Gopher Menu to the client.
<P>
To configure the server for searches, you need to do the following:

<UL><LI>Configure an index of keywords to speed up the search.

<LI>Set up search tools, either by selecting them from other sources,
   or by writing your own.

<LI>Create tag information for all searches supported by a particular
   server.
<P>
</UL><h3>Creating an Index File</h3>
 
<P>
First, install the EMWAC WAIS software. Then you can create an index file
by using the WAIS Toolkit.

<OL><P><LI>Prepare a directory to work in, for example:
<P>
<P><PRE>      C:\Search
</PRE>
<P><LI>Create a subdirectory to hold the files you are going to index, for
   example:
<P>
<P><PRE>      C:\Search\Here
</PRE>
<P><LI>Put some text files into the C:\Search\Here directory. These files must
   be ASCII text files.
<P>
</OL><h3>To Create an Index</h3>
 

<OL><P><LI>Make C:\Search your current directory.

<P><LI>Execute the following command with these parameters:
<P>
<P><PRE>      waisindex -d myindex here\*
</PRE>
<P><LI>Check the messages from Waisindex to make sure that there are no errors.

<P><LI>In the C:\Search directory, type DIR to make sure that Waisindex has
   created the seven index files named Myindex.*.

<P><LI>Search your files. For the example, search for a word that you know is
   in the files.
<P>
</OL><h3>Searching the Index</h3>
 
<P>
The Waislook command in the EMWAC WAIS Toolkit allows you to search files
through the index file you created with Waisindex. Make sure C:\Search is
the current directory and execute the following command with these
parameters:
<P>
<PRE>   waisindex -d myindex word

</PRE></OL>where word is any word that you know appears in one of the files.
<P>
Check the output of Waislook, which will show you the names of the files
that contain the word you typed.
<P>
<P><h3>Configuring Log Records</h3>
 
<P>
When you set up a Gopher server, you can see who has been using it and how
many times your online information was accessed. Through Gopher you can log
incoming connections to the server.
<P>
To record logs properly:

<OL><P><LI>Determine in which directory the logs will be stored.

<P><LI>Specify the frequency with which logs are collected (every day, every
   week, every month, etc.).

<P><LI>Select the log tools you want to analyze the logs your server collects.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodiis gopher wais emwac<BR>
Keywords            : iisconfig iishowto kbusage ntnetserv nttcp<BR>
Version             : 1.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
