

<HTML>
<HEAD>
<TITLE>Configuring and Testing  a PERL Script with IIS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150629">
<META NAME="KBModify" CONTENT="1997/05/21">
<META NAME="KBCreate" CONTENT="1996/05/06">
<META NAME="Keywords" CONTENT="iisscript iissetup kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  The following PERL script can be used to test for the proper installation and execution of CGI scripts with Internet Information server.  MORE INFORMATION  Create a file with Notepad, and type the following lines of code. Save the file in the scrip...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QDNQ,QAVX,QAVW,QBWD,QDJ3,QDIZ,QBXB,QAVZ,QATJ,QBXP,QAFI,QBJZ,QBWP,QBWA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Configuring and Testing  a PERL Script with IIS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150629</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following PERL script can be used to test for the proper installation
and execution of CGI scripts with Internet Information server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Create a file with Notepad, and type the following lines of code. Save the
file in the scripts directory as Helloworld.pl.
<P>
print "HTTP/1.0 200 OK\n";
print "Content-Type: text/html\n\n";
<P>
print "&lt;HTML&gt;\n";
print "&lt;HEAD&gt;\n";
print "&lt;TITLE&gt;Hello World&lt;/TITLE&gt;\n";
print "&lt;/HEAD&gt;\n";
print "&lt;BODY&gt;\n";
print "&lt;H4&gt;Hello World&lt;/H4&gt;\n";
print "&lt;P&gt;\n";
print "Your IP Address is $ENV{REMOTE_ADDR}.\n";
print "&lt;P&gt;";
print "&lt;H5&gt;Have a nice day&lt;/H5&gt;\n";
print "&lt;/BODY&gt;\n";
print "&lt;/HTML&gt;\n";
<P>
Once you have created the file, you need to configure PERL to run securely
with Internet Information. Perl.exe should not be located in any of the
directories accessible by a user with a browser.
<P>
With a script mapping in the registry, you can place the Perl.exe outside
of the normal directory structure a user has access to.
<P>
<P><h3>To configure PERL script mapping</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Start Regedt32.exe and open HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\
   Services\W3SVC\Parameters\ScriptMap

<P><LI>Click Add Value from the Edit menu.

<P><LI>The Value Name is .pl

<P><LI>The Data type is REG_SZ.

<P><LI>The String value is &lt;the full path to perl.exe&gt;\perl.exe %s %s

<P><LI>Restart the WWW service.
<P>
</OL>Now that the registry has been configured, you can test the PERL script
with your browser. Using the defaults directory structure with IIS, the URL
would be the following:
<P>
<PRE>   <B>http://&lt;Server</B> Name&gt;/scripts/helloworld.pl?
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : iisscript iissetup kbsetup<BR>
Version             : 1.0 3.5 3.51<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
