

<HTML>
<HEAD>
<TITLE>Active Server Pages Script Appears in Browser </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163485">
<META NAME="KBModify" CONTENT="1998/02/10">
<META NAME="KBCreate" CONTENT="1997/02/20">
<META NAME="Keywords" CONTENT="iisapi iissecurity iiswww kbbug1.00 kbbug2.00 kbbug3.00">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  When you use Microsoft Internet Information Server, if you place a period (.) in a browser’s command line after any script-mapped file name, you receive unexpected results. The browser produces a document that contains the scripting information as ...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAR4,QAGU,QAVZ,QBW9,QAFI,QAYY,QAM1,QAL3,QAGI,QAKP,QBWA,QBXS,QBWP,QBFN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Active Server Pages Script Appears in Browser</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163485</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use Microsoft Internet Information Server, if you place a period
(.) in a browser’s command line after any script-mapped file name, you
receive unexpected results. The browser produces a document that contains
the scripting information as well as other data in the file.
<P>
For example, if you enter:
<P>
<PRE>   <B>http://server_name/asp_directory/file.asp.</B>

</PRE>You receive something like:
<P>
<PRE>   &lt;% emailx=request.form("email")
   remarkx=request.form("remark") Set Conn =
   Server.CreateObject("ADODB.Connection") Conn.Open "Local SQL
   Server", "sa", "DTide" Set RS = Conn.Execute("insert into
   Web_data.dbo.ASP_data(email,remark) values('" &amp; emailx &amp;
   "','" &amp; remarkx &amp; "')") %&gt;

   Your information has been added to our database.

</PRE>The browser should return a confirmation web page, without the script.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem affects any script-mapped files requested from a virtual
directory that has both read and execute permissions set. Adding one or
more extra periods onto the end of the URL causes the file to be displayed
in the browser, instead of run on the server. This allows end users to see
information that may be confidential, such as server-side script logic (for
example, the discount applied to the retail price from a database). This
problem affects any file in the script-map list, such as .asp, .ht., .id,
.PL, and so on.
<P>
This problem only occurs on virtual directories that have both read and
execute access. If read is disabled, the server-side information is not
viewable by the end user.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, do either of the following:

<UL><LI>Do not place script-mapped files in a directory that has both read and
   execute permissions.
<P>
   -or-

<LI>Get the hotfix mentioned below.
<P>
</UL>This hotfix has been posted to the following Internet location. You can
download any of these self-extracting files from the following service:
<P>
<PRE>   Internet (anonymous FTP)
   ftp ftp.microsoft.com
   Change to the bussys/winnt/winnt-public/fixes/usa/
   nt40/hotfixes-postSP2/iis-fix/ folder.
   Get Readme.1st (for instructions on downloading and installing the
   hotfix).

</PRE>Or use the following full URL on your client browser:
<PRE>   FTP://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/
   nt40/hotfixes-postSP2/iis-fix/readme.1st

</PRE>NOTE: After you apply the above fix, the default document in WWW Service
Properties cannot contain any forward slashes. Any forward slashes must be
converted to back slashes.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Internet
Information Server version 3.0.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.00 2.00 3.00 prodnt 4.00<BR>
Keywords          : iisapi iissecurity iiswww kbbug1.00 kbbug2.00 kbbug3.00<BR>
Version           : WinNT:3.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
