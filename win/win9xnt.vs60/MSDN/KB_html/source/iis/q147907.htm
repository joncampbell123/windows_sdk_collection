

<HTML>
<HEAD>
<TITLE>Error Starting IIS Services Without TCP/IP Installed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147907">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1996/03/04">
<META NAME="Keywords" CONTENT="iissetup kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  When you attempt to start the Component Services of the Internet Information Server (IIS) 1.0 in Windows NT 3.51 without the TCP/IP protocol installed first, the following error message appears:     Could not start the World Wide Web Publishing Ser...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACK,QAA1,QAVZ,QAB4,QBWP,QDI2,QAAP,QAPN,QAO4,QAIJ,QA4H,QAWI,QAK6,QDNT,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error Starting IIS Services Without TCP/IP Installed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147907</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 3.51
<LI>Microsoft Internet Information Server version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to start the Component Services of the Internet
Information Server (IIS) 1.0 in Windows NT 3.51 without the TCP/IP protocol
installed first, the following error message appears:
<P>
<PRE>   Could not start the World Wide Web Publishing Service service
   on &lt;computername&gt;.

   Error 10022:

</PRE>In addition, the following system events appear in Event Viewer:
<P>
<PRE>   Event ID: 4
   Source: W3SVC
   Description: HTTP Server was unable to initialize due to a shortage
   of available memory. The data is the error: 26 27 00 00

   Event ID: 7023
   Source: Service Control Manager
   Description: The World Wide Web Publishing Service service terminated
   with the following error:

   Event ID: 7023
   Source: Service Control Manager
   Description: The Gopher Publishing Service service terminated
   with the following error:

   Event ID: 7023
   Source: Service Control Manager
   Description: The FTP Publishing Service service terminated
   with the following error:

</PRE>When you install the TCP/IP protocol after you install IIS, the following
system events appear in Event Viewer:
<P>
<PRE>   Event ID: 3
   Source: W3SVC
   Description: HTTP Server could not initialize the socket
   library. The data is the error: 7A 00 00

   Event ID: 7023
   Source: Service Control Manager
   Description: The Gopher Publishing Service service terminated
   with the following error: The data area passed to a system
   call is too small.

   Event ID: 7023
   Source: Service Control Manager
   Description: The FTP Publishing Service service terminated
   with the following error: The data area passed to a system
   call is too small.

</PRE><h2>CAUSE</h2>
 
<P>
The TCP/IP protocol must be installed before you install the Internet
Information Server.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem:

<OL><P><LI>Start Internet Information Server Setup.

<P><LI>Click Remove All. This removes all previously installed components.

<P><LI>Shut down and restart Windows NT.

<P><LI>Reinstall the latest Windows NT Service Pack (currently SP4).

<P><LI>Install the TCP/IP protocol in Control Panel Network.

<P><LI>Shut down and restart Windows NT.

<P><LI>Install Internet Information Server.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Internet Information Server
version 1.0. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodiis winnt<BR>
Keywords            : iissetup kbnetwork<BR>
Version             : 1.0 3.51<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
