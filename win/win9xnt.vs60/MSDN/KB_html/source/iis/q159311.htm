

<HTML>
<HEAD>
<TITLE>Instantiating Remote Components in MTS and IIS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159311">
<META NAME="KBModify" CONTENT="1997/11/07">
<META NAME="KBCreate" CONTENT="1996/11/12">
<META NAME="Keywords" CONTENT="iisapi iishowto iissecurity kbtool">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  This article contains information on how to use Active Server Pages (ASP) to instantiate a remote Microsoft Transaction Server (MTS) component that resides on a separate computer from the Microsoft Internet Information Server (IIS) computer. This a...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANN,QAGI,QAJG,QAAD,QBXS,QBVV,QAK7,QA9A,QABA,QA5F,QAMA,QAIF,QAI5,QBG2,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Instantiating Remote Components in MTS and IIS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159311</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Transaction Server version 2.0
<LI>Microsoft Internet Information Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains information on how to use Active Server Pages (ASP)
to instantiate a remote Microsoft Transaction Server (MTS) component that
resides on a separate computer from the Microsoft Internet Information
Server (IIS) computer. This article also addresses the issues that may
arise from developing remote components for MTS 2.0 and IIS 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you are using NTLM security, it is not possible to directly call remote
components, regardless of the IIS application's activation setting (in-
process or out-of-process) or identity (local or domain user). To call
remote components when using NTLM security, you need to do the following:

<OL><P><LI>Create an intermediate MTS package with a domain identity.

<P><LI>Set the package activation to run in a dedicated server process.

<P><LI>Install an intermediate component that calls the remote component
   into the package. This intermediate component is then called from
   the ASP script and in turn, calls the remote component.
<P>
</OL>NOTE: When you use this technique, the direct caller, as seen by the remote
component, will not be the original IIS caller, but the identity of the
intermediate package.
<P>
If you are using Basic security, it is possible to call remote components
directly. However, this requires that you set the Basic Authentication
Domain to the domain and not the local machine. Although this setting
allows the remote components to see the direct caller as the original IIS
caller and not the intermediate package identity, it is not recommended.
For more information on Basic security, please see the IIS 4.0 online
documentation.
<P>
If you are using Anonymous security, it is possible to call remote
components directly. However, this requires that you set the Anonymous User
to a domain account. Although this setting allows the remote components to
see the direct caller as the original IIS caller and not the intermediate
package identity, it is not recommended. Anonymous security allows access
to everyone. Allowing everyone access to your domain, even through a
restricted account, can be a serious security risk. Therefore, it is
recommended that you do not set the Anonymous account to a domain account.
Instead, you should set the Anonymous User to the default (or some other
local account) and use the intermediate MTS package technique, following
the steps described above, to instantiate remote MTS components (without
having to use NTLM).
 
<PRE>Keywords          : iisapi iishowto iissecurity kbtool
Version           : WinNT:2.0,4.0
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
