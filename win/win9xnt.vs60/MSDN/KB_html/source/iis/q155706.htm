

<HTML>
<HEAD>
<TITLE>How to Use the IIS HTTP Environment Variable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155706">
<META NAME="KBModify" CONTENT="1997/04/18">
<META NAME="KBCreate" CONTENT="1996/09/05">
<META NAME="Keywords" CONTENT="iisconfig kbenv">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  You should know how to use the Internet Database Connector (IDC) in order to use the HTTP environment variables. These variables are returned to a HTX file or can be used as variables in the IDC SQLStatement: command line.  MORE INFORMATION  Syntax...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QALW,QAYL,QBWD,QAUJ,QDNQ,QALZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use the IIS HTTP Environment Variable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155706</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Internet Information Server versions 1.0 and 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You should know how to use the Internet Database Connector (IDC) in order
to use the HTTP environment variables. These variables are returned to a
HTX file or can be used as variables in the IDC SQLStatement: command line.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Syntax</h3>
 
<P>
Below is the proper syntax for the available variables. This requires the
use of .HTM, .IDC, and .HTX files.
<P>
The HTM document should contain a FORM with a Submit button. The Action
should launch the .IDC file and its Method equal to POST.
<P>
The IDC file, for this purpose, should be fully functional. However, it
does not have to return any data from your DSN. In addition, this is where
you place the reference for the HTX file.
<P>
The HTX file is where you will place the variables.
<P>
<P><h3>Variable Format</h3>
 
<P>
The use of these variable are a little different or cannot be used
depending on the version of Internet Information Server (IIS) you are
using. All variables must be in upper case.
<P>
The variables format are as follows:
<P>
These tags are running from IIS 1.0c and IIS 2.0 unless otherwise noted.

<UL><LI>&lt;%ALL_HTTP%&gt;    Returns all unparsed HTTP headers.

<LI>&lt;%HTTP_AUTHORIZATION%&gt;  IIS 1.0 ONLY :Returns the type of authorization
   used.

<LI>&lt;%AUTH_TYPE%&gt; IIS 2.0 ONLY : Returns the type of authorization used.

<LI>&lt;%HTTP_CONNECTION%&gt; Returns the type of connection established

<LI>&lt;%CONTENT_LENGTH%&gt; Returns the number of bytes expected from the client

<LI>&lt;%CONTENT_TYPE%&gt; Returns the content type from the body of a POST
   request.

<LI>&lt;%GATEWAY_INTERFACE%&gt;  Returns CGI specifications the server uses.

<LI>&lt;%HTTP_ACCEPT%&gt; Returns special-case header values

<LI>&lt;%LOGON_USER%&gt; IIS 2.0 ONLY : Returns Windows NT account

<LI>&lt;%PATH_INFO%&gt; Returns trailing part of the URL after the script name.

<LI>&lt;%PATH_TRANSLATED%&gt; Returns full path of script name.

<LI>&lt;%HTTP_PRAGMA%&gt; ONLY in  IIS 2.0
<P>
 -&lt;%QUERY_STRING%&gt; Returns query string.
<P>
 -&lt;%HTTP_REFERER%&gt; Returns the URL of the requesting HTM.

<LI>&lt;%REMOTE_ADDR%&gt; Returns the clients IP address.

<LI>&lt;%REMOTE_HOST%&gt; Returns the client hostname

<LI>&lt;%REMOTE_USER%&gt; Returns  the authenticated client name.
<P>
 -&lt;%REQUEST_METHOD%&gt; Returns the HTTP request method
<P>
 -&lt;%SCRIPT_NAME%&gt; Returns the name of the script program being executed

<LI>&lt;%SERVER_NAME%&gt; Returns the servers hostname or IP address.

<LI>&lt;%SERVER_PORT%&gt; Returns the TCP/IP port used.

<LI>&lt;%HTTP_SERVER_PORT_SECURE%&gt;DOES NOT WORK WITH OR WTIHOUT HTTP_ FROM
   SERVER OF CLIENT(IIS 1.0)  Returns a value of 1 or 0 .

<LI>&lt;%SERVER_PROTOCOL%&gt; Returns name and version of information retrieving
   protocol

<LI>&lt;%SERVER_SOFTWARE%&gt; Returns the name and version of the Web Server
   Software

<LI>&lt;%HTTP_USER_AGENT%&gt; Returns the name of the browser.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: iis http<BR>
Keywords            : iisconfig kbenv<BR>
Version             : 1.0 2.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
