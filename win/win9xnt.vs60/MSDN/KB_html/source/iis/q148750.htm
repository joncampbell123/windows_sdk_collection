

<HTML>
<HEAD>
<TITLE>CGI Scripts Compiled w/16-bit C Compilers Fail to Run on IIS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148750">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1996/03/20">
<META NAME="Keywords" CONTENT="iisscript kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  If you try to run a CGI script on (Internet Information Server) IIS from a Web Browser using http://            /Directory path&gt;/              ?,, you may get the following error:     HTTP/1.0 500 Server Error (The handle is invalid.)  CAUSE ===== ...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXP,QBFY,QBWA,QAOT,QDNQ,QAJQ,QAVZ,QAVX,QAVW,QAR4,QAMB,QAAP,QAIV,QAH4,QAEB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>CGI Scripts Compiled w/16-bit C Compilers Fail to Run on IIS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148750</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you try to run a CGI script on (Internet Information Server) IIS from a
Web Browser using <B>http://&lt;ServerName&gt;/Directory</B> path&gt;/&lt;FileName.exe&gt;?,, you
may get the following error:
<P>
<PRE>   HTTP/1.0 500 Server Error (The handle is invalid.)

</PRE><h2>CAUSE</h2>
 
<P>
CGI scripts compiled with 16-bit C compilers may fail to execute on
IIS.
<P>
For example, if you compile and build an executable file out of the
following C language source code using a 16-bit C compiler, and run the
.exe file from a MS-DOS window of a Microsoft Windows NT Workstation
version 3.51, the correct HTML output will send to the standard out.
However if you place the same executable file in the Script directory of
the IIS server and try to execute the same executable file from a web
browser using <B>http://&lt;ServerName&gt;/Directory</B> path&gt;/&lt;FileName.exe&gt;?, it will
fail to generate to web page.
<P>
<PRE>#include &lt;stdio.h&gt;

void main()
</PRE>{
<PRE>   printf( "Content-type: text/html\n\n" );
   printf( "&lt;BODY BGCOLOR=\"#FFFFF0\" TEXT=\"#0000FF\"&gt;" );
   printf( "&lt;TITLE&gt;This is a Test page&lt;/TITLE&gt;" );
   printf( "&lt;h2&gt;Hello World.&lt;/h2&gt;&lt;br&gt;" );
   printf( "&lt;h1&gt;&lt;center&gt;End of the test page.&lt;/center&gt;&lt;/h1&gt;" );
   printf( "&lt;/BODY&gt;\n" );

</PRE>}
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem compile and build the C Language Source code using
a 32-bit C compiler, such as Microsoft C++ 4.0 or C++ 2.0.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodiis<BR>
Keywords            : iisscript kbnetwork<BR>
Version             : 1.0 3.51<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
