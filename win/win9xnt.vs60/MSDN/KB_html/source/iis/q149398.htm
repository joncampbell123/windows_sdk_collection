

<HTML>
<HEAD>
<TITLE>IIS Logging to SQL Server Fails w/ Blank Username and Password </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149398">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1996/04/01">
<META NAME="Keywords" CONTENT="iisconfig iisinterop iisodbc kbenv kbinterop kbnetwork kbusage kbappnote">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  If you are using the IIS Service Properties Logging dialog box, and you select the Log to SQL/ODBC Database option, you have entered a correct DSN and Table. However, when you enter the username and password, they are replaced with blanks when the ...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAI5,QBWP,QA9E,QAUJ,QBW7,QA7A,QA69,QBG2,QAVZ,QAGI,QABB,QDMH,QAAD,QAWK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>IIS Logging to SQL Server Fails w/ Blank Username and Password</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149398</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 1.0
<LI>Microsoft Windows NT Server version 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you are using the IIS Service Properties Logging dialog box, and you
select the Log to SQL/ODBC Database option, you have entered a correct DSN
and Table. However, when you enter the username and password, they are
replaced with blanks when the dialog box is opened again.
<P>
The SQL Server log will record the following:
<P>
<PRE>   Failure condition - logon failed because there is no valid user account.

</PRE>The server will report the following error:
<P>
<PRE>   ODBC reported an error. The Datasource name "dsn" may be incorrect.
   Check the server's event log for details.

</PRE>The Server's event log indicates that SQL Server rejects the transaction
because it is not defined as a valid user.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is caused by an improper configuration of the Microsoft SQL Server
Login Security Mode for use with IIS. If the SQL Server Login Security Mode
is set to Windows NT Integrated option, then SQL Server uses Windows NT
authentication mechanisms for all connections and only trusted connections
are allowed into SQL Server.
<P>
The login name and SQL Server password submitted in the login request from
a DB-Library or Open Database Connectivity (ODBC) client application are
always ignored by SQL Server. Network users assigned user-level privileges
to SQL Server log in using their network username or the default login ID
(if the network username is not found in syslogins). Network usernames
assigned system administrator-level privilege log in as SA. With this
option, only named pipes or multi-protocol clients are supported. If you
have installed additional Net-Libraries, this option is not available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To resolve this issue set the Login Security Mode to Mixed. In this mode,
SQL Server allows both trusted and nontrusted connections.
<P>
For trusted (named pipes or multi-protocol) connections, SQL Server
examines the requested login name as specified by the client DB-Library or
ODBC application. If this login name matches the user's network username,
or if the login name is null or blank spaces, SQL Server first tries the
Windows NT Integrated login rules. If this fails, SQL Server uses the
Standard rules. If the requested login name is any other value, the user
must supply the correct SQL Server password, and SQL Server handles the
login using the Standard rules described in the Microsoft SQL Server Help
file.
<P>
NOTE: All login requests from nontrusted connections are handled using the
standard security rules.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodiis<BR>
Keywords            : iisconfig iisinterop iisodbc kbenv kbinterop kbnetwork kbusage kbappnote<BR>
Version             : 1.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
