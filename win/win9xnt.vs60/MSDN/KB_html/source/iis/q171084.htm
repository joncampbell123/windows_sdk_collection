

<HTML>
<HEAD>
<TITLE>How to Install a Certificate </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171084">
<META NAME="KBModify" CONTENT="1997/11/13">
<META NAME="KBCreate" CONTENT="1997/07/07">
<META NAME="Keywords" CONTENT="iishowto kbother">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  The following are the steps to successfully install a Certificate  using Key Manager with Internet Information Server (IIS).   MORE INFORMATION  1. Generate a Key Pair File and a Request File.      a. In the Microsoft Internet Server, click Key Man...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QAK7,QABG,QAUR,QAHH,QAA1,QBCF,QAYZ,QAH5,QAGU,QDI2,QA2Q,QAY2,QAGI,QAQT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Install a Certificate</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171084</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to: 

<UL><LI>Microsoft Internet Information Server versions 2.0 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following are the steps to successfully install a Certificate 
using Key Manager with Internet Information Server (IIS). 
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Generate a Key Pair File and a Request File. 
<P>
   a. In the Microsoft Internet Server, click Key Manager, or click
<P><PRE>      the Key Manager icon on the Internet Service Manager toolbar. 
</PRE><P>
   b. From the Key menu, click Create New Key.
<P>
   c. In the Create New Key and Certificate Request dialog box, fill 
<P><PRE>      in the requested information. 
</PRE><P>
   d. After you fill out the form, click OK.
<P>
   e. When you are prompted, retype the password you typed in the 
<P><PRE>      form, and click OK.
</PRE><P>
   f. An icon appears as the key is being created. When the key has 
<P><PRE>      been created, a screen appears giving you information about 
      the new keys and how to obtain a certificate.
</PRE><P>
   g. After you read the New Key Information screen, click OK. 
<P>
   h. From the Key menu in Key Manager, choose Export Key and 
<P><PRE>      then Backup File. Click OK to the warning dialog on your 
      hard disk. Type the key name in the File Name box, and 
      click Save.
</PRE><P>
<P><PRE>      NOTE: Backing up the Key is very important.
</PRE><P>
   i. To save the new key from the Servers menu, select Commit 
<P><PRE>      Changes Now. When asked if you want to commit all changes 
      now, click OK. 
</PRE>
<P><LI>Request a Certificate from a Certification Authority. 
<P>
   To get a Secure Sockets Layer (SSL) Server ID, complete the 
   Online Enrollment Form at the following location:
<P>
<P><PRE>      <B><A href="http://www.verisign.com">http://www.verisign.com</A></B> for a SSL Server ID
</PRE>
<P><LI>Install the Certificate on your Server. 
<P>
   a. In the Internet Server program group, click Key Manager. 
<P>
   b. In the Key Manager window, select the key pair that matches 
<P><PRE>      your signed certificate.
</PRE><P>
<P><PRE>      If you backed up the key pair file, you have to load it first. 
      To load a backed-up key file, click Key Manager on the Key menu,
      select Import Key and then Backup File. 
</PRE><P>
   c. Select the file name from the list, and click Open.
<P>
   d. From the Key menu, choose Install Key Certificate.
<P>
   e. Select the Certificate file from the list (for example, 
<P><PRE>      Certif.txt), and click Open. 
</PRE><P>
   f. When you are prompted, type the password that you used in 
<P><PRE>      creating the key pair. The key and certificate are combined 
      and stored in the registry of the server.
</PRE><P>
   g. Click Commit Changes Now on the Servers menu. 
<P>
   h. When you are asked if you want to Commit All Changes Now, 
<P><PRE>      click OK. 
</PRE><P>
</OL>Sending them via mail can corrupt certificates. If you try 
and install a corrupt certificate, you will get a wrong password 
error message. You will no longer be able to install the certificate
for that key, even if you get a non-corrupt copy. 
<P>
To uncorrupt the certificate:

<OL><P><LI>Load the certificate in Notepad.

<P><LI>No spaces can exist anywhere in the certificate.

<P><LI>Save it without an extension by selecting the All Files as type. 
   Do not check the unicode box.

<P><LI>Once you have fixed your certificate, you must delete the key 
   and re-import it. Make sure you have saved it first.
<P>
   To import the key, click Import on the Key menu, then select
   Backup file.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: iis<BR>
Keywords          : iishowto kbother<BR>
Version           : WinNT:2.0,3.0<BR>
Platform          : winnt<BR>
Hardware          : ALPHA x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
