

<HTML>
<HEAD>
<TITLE>Microsoft Membership Agent May Not Start </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171331">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1997/07/14">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sitemcis">
<META NAME="Description" CONTENT="  Microsoft Membership Agent may not start and may return the following error messages in the Event Viewer logs.  In the system log you will get the following error message:     Event ID: 7023    Source: Sevice Control Manager    Description: The Mem...">
<META NAME="Product" CONTENT="sitemcis">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAIJ,QBVV,QAO4,QACK,QBWS,QDIV,QAY2,QAPN,QANE,QAAP,QAIS,QAG8,QA4H,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Microsoft Membership Agent May Not Start</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Commercial Internet System (MCIS) version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Membership Agent may not start and may return the following
error messages in the Event Viewer logs.
<P>
In the system log you will get the following error message:
<P>
<PRE>   Event ID: 7023
   Source: Sevice Control Manager
   Description: The Membership Agent service terminated with the following
   error:
      The service has not been started.

</PRE>In the application log you will get the following error messages:
<P>
<PRE>   Event ID: 4123
   Source: Sicily
   Description: Initializing buffers and connection to Membership Backend
   SQL Server failed.

   Event ID: 12297
   Source: AccessCtl
   Description: Cannot update the plans list.

</PRE>If you started the Membership Agent from the command prompt, you will also
get the following error message:
<P>
<PRE>   The service terminated with the service specific error message:
   Could not start Membership Agent service on &lt;server name&gt; error 1062.

</PRE><h2>CAUSE</h2>
 
<P>
The problem occurs because the group_limited_access_plan is in a state in
which the count of the entries in group_limited_access_plan does not match
the number of rows returned by the query:
<P>
<PRE>   "select t.c_group_description, p.i_group_id, i_account_id, i_owner_id
   from group_limited_access_plan p, group_type t
   where p.i_group_id = t.i_group_id order by p.i_group_id ".

</PRE>This situation should never occur through the use of the administrative
tools that ship with Microsoft Membership Server.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, make the following changes to the stored procedure
"sp_enum_access_plans":
<P>
Change
<PRE>   "select count(*) from group_limited_access_plan"
</PRE>to
<PRE>   "select count(*) from group_limited_access_plan p, group_type t
   where p.i_group_id = t.i_group_id"

</PRE> 
<PRE>Keywords          : kbusage
Version           : WinNT:1.0
Platform          : winnt</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
