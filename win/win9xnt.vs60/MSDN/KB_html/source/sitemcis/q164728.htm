

<HTML>
<HEAD>
<TITLE>Signup SSO Must Support Creating Mail Forwarding Records </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164728">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1997/03/06">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; sitemcis">
<META NAME="Description" CONTENT="  Microsoft Commercial Internet System customers are likely to setup two- tiered mail domain structures such as starlight.com and jp.starlight.com or us.starlight.com. To make this work, the Signup SSO must support creating routing table entries with...">
<META NAME="Product" CONTENT="sitemcis">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAHE,QAGI,QAHT,QAYC,QBBI,QAY5,QAMS,QBXS,QBW3,QAFQ,QBV8,QAB9,QAKD,QAIF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Signup SSO Must Support Creating Mail Forwarding Records</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164728</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Commercial Internet System, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Commercial Internet System customers are likely to setup two-
tiered mail domain structures such as starlight.com and jp.starlight.com or
us.starlight.com. To make this work, the Signup SSO must support creating
routing table entries with forwarding records for the root domain (that is,
starlight.com can forward to us.starlight.com or to jp.starlight.com).
<P>
<P><h2>CAUSE</h2>
 
<P>
Additional optional parameters were added to the SignUp SSO CreateUser()
function to handle the case of a forwarding mail record like domain.com. If
the optional parameters are specified, the CreateUser function would make a
series of calls to the POP3CreateUser function to set the forwarding e-mail
records. If the optional parameters are specified, the CreateUser function
would make a series of calls to the POP3CreateUser function to set the
forwarding email records.
<P>
This would mean changing the CreateUser parameter list to include optional
parameters to specify the list of servers to set the forwarding record.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The parameter list for both CreateUser and POP3CreateUser are listed below:
<P>
<P><h3>SSO Function CreateUser()</h3>
 
<P>
Required:
LPSTR strLoginName(A&amp;A, POP3, IDS)
LPSTR strPassword(A&amp;A)
LPSTR strEmailDomain(POP3,IDS)
LPSTR strEmailServer(POP3)
LPSTR strVRoot(POP3)
ULONG ulMailboxSize(POP3)
LPSTR strCountry(IDS)
LPSTR strOgranization(IDS)
<P>
Optional:
LPSTR strGivenName(IDS)
LPSTR strSurName(IDS)
ULONG ulAccount(GETPROP only. Not require input)
LPSTR strEMailRoot(POP3,IDS)
LPSTR strMailServerList (POP3)
<P>
<P><h3>SS0 Function Pop3CreateUser()</h3>
 
<P>
Required:
wszServerName
wszEmail=A&amp;A::szLoginName + wszDomainName
dwCreateMailbox=TRUE
dwMailboxSize
wszVRoot
<P>
Optional:
wszForwardEmail=NULL
<P>
First, CreateUser will call POP3CreateUser with
<PRE>'strLoginName@stsrEmailDomain' as the value for wszEmail. This call would
</PRE>use the CreateUser strEmailServer, strVRoot, and ulMailboxSize parameters
as the value for the POP3CreateUser wszServerName, wszVRoot, and
dwMailboxSize parameters, respectively. The POP3CreateUser dwCreateMailbox
parameter would be set to TRUE and the optional POP3CreateUser
wszForwardEmail parameter would be set to NULL.
<P>
In CreateUser, the strMailServerList is a list of server names (separated
by a space) and the strEMailRoot is the root e-mail address (that is,
userid@domain.com). For each item in strMailServerList, CreateUser would
make a call to POP3CreateUser with the CreateUser strEMailRoot parameter as
the value for the POP3CreateUser wszEmail parameter and strLoginName +
strDomainName as the value for the wszForwardEmail parameter. The
POP3CreateUser dwCreateMailbox would be set to FALSE. Finally, if the
CreateUser strEMailRoot address is specified, it will be used as the e-mail
address put in IDS instead of strLoginName + strDomainName (that is, only
one entry will be put in IDS).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Commercial
Internet System, version 1.0.
We are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
 
<PRE>Version           : 1.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
