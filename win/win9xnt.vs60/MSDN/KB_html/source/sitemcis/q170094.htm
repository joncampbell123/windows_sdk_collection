

<HTML>
<HEAD>
<TITLE>MBS: Sync Task Scripts Fail with MS SQL Server version 6.5 SP2 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170094">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1997/06/13">
<META NAME="Keywords" CONTENT="kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; sitemcis">
<META NAME="Description" CONTENT="  The sync task scripts included in Membership Broker System (MBS) and noted in step 2 of the  Creating a publication  process on page 129 of the MBS documentation, will fail if Microsoft SQL 6.5 Service Pack 2 is installed prior to performing the st...">
<META NAME="Product" CONTENT="sitemcis">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QABM,QBWS,QAH6,QAZV,QBII,QDNQ,QABI,QABH,QBW2,QAFZ,QDO3,QDIZ,QAFO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MBS: Sync Task Scripts Fail with MS SQL Server version 6.5 SP2</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170094</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Commercial Internet System version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The sync task scripts included in Membership Broker System (MBS) and noted
in step 2 of the "Creating a publication" process on page 129 of the MBS
documentation, will fail if Microsoft SQL 6.5 Service Pack 2 is installed
prior to performing the step.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft SQL Server 6.5 Service Pack 2 corrects a problem that was worked
around in the existing MBS sync task script files.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following information should used in place of the MBS documentation if
SQL Server 6.5 Service Pack 2 has been installed:
<P>
<P><h3>Installing SQL Replication</h3>
 
<P>
The replication schema can be divided into three basic parts: Distribution,
Publisher, Subscriber.
<P>
For this set of instructions, we will assume that A is the publishing
computer which will also serve as the distribution computer and that B is
the subscribing computer.
<P>
Setting up Distribution:
<P>
You must install distribution server before you can perform the rest of
replication setup.
<P>
On computer A:
1. Ensure that your memory capacity has been expanded to a minimum of 8192
<PRE>   On the Server menu, click Configuration.

</PRE><P><LI>Create a Device and Log Device for the distribution database.

<P><LI>Install the distribution server. On the Server menu, click Replication
   Configuration, and then click Install Publishing.
<P>
</OL>When these steps are complete you should receive a dialog box that says:
<P>
<PRE>   Replication Publishing has been successfully installed.
   Do you wish to add publishing databases and Subscribers
   at this time?

</PRE></OL>Click Yes to continue with the replication installation or click No to come
back to it later. If you click No, you can continue later by clicking
Replication Configuration on the Sever menu, and then clicking Publishing.
<P>
The distribution server portion is now complete.
<P>
<P>
Setting up Publishing:

<OL><P><LI>On the Sever menu, click Replication Configuration, and then click
   Publishing.

<P><LI>Under "Enable Publishing to These Servers" click to select the Enable
   check box of the server(s) that will be the publishing server(s).

<P><LI>Click to select the Enable check box for the database(s) that will be
   the Publishing database(s) in the "Publishing Databases" list.
<P>
</OL>IMPORTANT: Click "Distribution Options" and select the distribution options
you need for Distribution Server:
<P>
<PRE>   Default is 'Commit Every 100 Transactions to Subscriber
   Continuous
   Server Type: SQL Server

</PRE></OL>You may want to lower the commit rate. All other defaults should be
acceptable.
<P>
NOTE: If the server that you went to be a publisher is not listed under
"Subscribing Server," click "New Subscriber" and register a new server. Whe
that is done, the server will appear in the Subscriber Server list.
<P>
You may also change the "Working Directory" while you are in the
Replication - Publishing dialog box by typing in the "Working Directory"
edit box.
<P>
The publishing server portion is now complete.
<P>
<P>
Setting up Subscribing - Part A:
<P>
As the SQL administrator you can register the subscribing servers from your
publishing or distribution server or manually set up subscribing on each
computer if you prefer.
<P>
Assuming you are administering everything from one computer:
On computer A, register computer B. On the Server menu, click Register
Server. You can also register a new server. On the Server menu, click
Registration Configuration, click Subscribing, and then click New Server.
<P>
NOTE: Ensure that the database(s) you want to make the subscriber(s) exists
on computer B.
<P>
Set focus to Computer B, click Registration Configuration on the Server
menu, and then click Subscribing.

<OL><P><LI>Click to select the Enable check box for Computer A in the "Enable
   Subscribing From These Servers:" list.
<P>
   NOTE: You are saying that you want to allow publishing from Computer A.

<P><LI>Click to select the Enable check box for the databases that you want to
   be the subscribing databases in the "Subscribing Databases:" list. These
   are the databases that will receive the replication data.
<P>
</OL>The basic distribution, publishing, and subscription topology portion is
now down.
<P>
<P>
Setting up Subscribing - Part B:
<P>
On the Manage menu, click Replication, and then click Subscription. You
should see the publishing database from Computer A.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MCIS 8430<BR>
Keywords          : kbsetup<BR>
Version           : WinNT:1.0<BR>
Platform          : winnt<BR>
Hardware          : ALPHA x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
