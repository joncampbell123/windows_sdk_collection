

<HTML>
<HEAD>
<TITLE>OL97: How to Correct Formatting and Parsing of Imported Contacts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166333">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1997/04/03">
<META NAME="Keywords" CONTENT="kbcode">
<META NAME="KBArea" CONTENT="Support; KB; outlook, exchange, office, officevba, vbapp, setup">
<META NAME="Description" CONTENT="  Importing contacts into Microsoft Outlook 97 results in incorrectly formatted or parsed address and fax number fields. Although the information may look correct when viewed in an Outlook form, it may result in erratic behavior when other routines o...">
<META NAME="Product" CONTENT="Outlook">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVO,QAR4,QAAP,QALZ,QBWS,QAYC,QBJZ,QAIF,QBUP,QDNQ,QAH4,QAC2,QBXD,QAFI,QAI2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OL97: How to Correct Formatting and Parsing of Imported Contacts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166333</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Outlook 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Importing contacts into Microsoft Outlook 97 results in incorrectly
formatted or parsed address and fax number fields. Although the information
may look correct when viewed in an Outlook form, it may result in erratic
behavior when other routines or programs use the information.
<P>
This article outlines a procedure using VBScript to correct this.
<P>
Microsoft has confirmed this to be a problem in Microsoft Outlook 97 for
Windows. This problem was corrected in Microsoft Outlook 97 version 8.02
for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>Follow these steps to create a new post form to correct the imported
contact records.
<P>
<P><h3>Design a New Post Form</h3>
 

<OL><P><LI>Open a new post message:
<P>
<P><PRE>    a. On the Inbox File menu, point to New, and then click "Post in This
       Folder."
</PRE><P>
<P><PRE>    b. On the Tools menu of the new Post form, click Design Outlook
       Form.
</PRE>
<P><LI>Insert a Command Button on the new form:
<P>
<P><PRE>    a. Click the (P.2) tab to go to a blank page on the form.
</PRE><P>
<P><PRE>    b. On the Form menu, click Control Toolbox.
</PRE><P>
<P><PRE>    c. On the Toolbox dialog, click CommandButton and drag it to the
       blank form page.
</PRE><P>
<P><PRE>    d. Right-click CommandButton1 and click Properties.
</PRE><P>
<P><PRE>    e. In the Caption window type, "Correct Contacts" and click OK.
</PRE>
<P><LI>Insert VBScript code:
<P>
<P><PRE>    a. On the Form menu, click View Code to open the Script Editor.
</PRE><P>
<P><PRE>    b. In the Script Editor, type or copy the following code:
</PRE><P>
<P><PRE>     Sub CommandButton1_Click()
     'This will only work on contacts in the CURRENT folder
     Set CurFolder=Application.ActiveExplorer.CurrentFolder
     If CurFolder.DefaultItemType=2 Then
       MsgBox "This process may take some time. You will be notified" &amp; _
       " when complete.",,"Contact Tools Message"
       Set MyItems=CurFolder.Items
<PRE></PRE>         For i = 1 to MyItems.Count
           Set MyItem=MyItems.Item(i)
      MyItem.MailingAddressStreet=MyItem.MailingAddressStreet
      MyItem.MailingAddressCity=MyItem.MailingAddressCity
      MyItem.MailingAddressState=MyItem.MailingAddressState
      MyItem.MailingAddressPostalCode=MyItem.MailingAddressPostalCode
      MyItem.MailingAddressPostOfficeBox=MyItem.MailingAddressPostOfficeBox
      MyItem.CompanyName=MyItem.CompanyName
      MyItem.HomeFaxNumber=MyItem.HomeFaxNumber
      MyItem.BusinessFaxNumber=MyItem.BusinessFaxNumber
      MyItem.OtherFaxNumber=MyItem.OtherFaxNumber
      MyItem.EMail1Address=MyItem.EMail1Address
      MyItem.EMail2Address=MyItem.EMail2Address
      MyItem.EMail3Address=MyItem.EMail3Address
      MyItem.Body=MyItem.Body
      MyItem.Sensitivity=MyItem.Sensitivity
           MyItem.Save
         Next
      MsgBox "Done!",64,"Contact Tools Message"
     Else
      MsgBox "The current folder is not a Contact folder.",64,"Contact" &amp; _
     " Tools Message"
     End If
     End Sub

     (Insert VBScript code step continued)

    c. On the Script Editor File menu, click Close to return to the form.

</PRE><P><LI>Rename the second page (p.2) tab and publish the new form:
<P>
<P><PRE>    a. On the Form menu, click Rename Page.
</PRE><P>
<P><PRE>    b. Type a name for this page such as, Correct Contacts, and
       click OK.
</PRE><P>
<P><PRE>    c. On the File menu, click Publish Form As.
</PRE><P>
<P><PRE>    d. In the "Form Name" box, type a name for your new form such as,
       "Correct Contacts" (without the quotation marks) and then click the
       "Publish In" button.
</PRE><P>
<P><PRE>    e. Click the "Forms Library" option button and click "Personal Forms"
       in the drop-down box.
</PRE><P>
<P><PRE>    f. Click OK and click Publish.
</PRE><P>
<P><PRE>    g. Close the message without saving.
</PRE><P>
</OL><h3>To Use Your New Form</h3>
 

<OL><P><LI>Navigate to the folder containing the contacts you wish to correct.

<P><LI>On the Contacts menu, click Choose Form.

<P><LI>In the Personal Forms list, click your new form and click OK.

<P><LI>Click the second page tab and click the button (Correct Contacts from
   Step 2e above) to correct the contacts in the current folder.
<P>
 NOTE: This only affects contact names in the current folder.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For information on manually correcting individual records, please see the
following article(s)in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID:  <B><A href="../outlook/q164401.htm">Q164401</A></B>
   TITLE     :  OL97: Using Contacts with Word's Insert Address Feature

   ARTICLE-ID:  <B><A href="../outlook/q164408.htm">Q164408</A></B>
   TITLE     :  OL97: Imported Fax Numbers May Not Work in Outlook

   ARTICLE-ID:  <B><A href="../outlook/q164477.htm">Q164477</A></B>
   TITLE     :  OL97: Address Displays Incorrectly on Imported Contacts

</PRE></OL>For more information about creating solutions with Microsoft Outlook 97,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../vbapps/q166368.htm">Q166368</A></B>
   Title     : OL97: How to Get Help Programming with Outlook

   Article-ID: <B><A href="../vbapps/q170783.htm">Q170783</A></B>
   Title     : OL97: Q&amp;A: Questions about Customizing or
               Programming Outlook
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OutSol OutSol97<BR>
Keywords          : kbcode<BR>
Version           : 97 8.02<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
