

<HTML>
<HEAD>
<TITLE>OL97: Automatic Resource Booking Available with Sample Scripts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178351">
<META NAME="KBModify" CONTENT="1998/03/10">
<META NAME="KBCreate" CONTENT="1997/12/19">
<META NAME="Keywords" CONTENT="GnlCal">
<META NAME="KBArea" CONTENT="Support; KB; outlook, exchange, office, officevba, vbapp, setup">
<META NAME="Description" CONTENT="  Automatic resource booking, a scheduling feature, is the ability to have a  resource  account, conference room, piece of equipment, or such, automatically accept or reject meeting requests based on availability. The Microsoft Schedule+ implementati...">
<META NAME="Product" CONTENT="Outlook">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAA1,QBJZ,QBVO,QDI2,QAGI,QBWS,QAPN,QAIM,QAPF,QBG2,QBVV,QAO4,QBWG,QDIZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OL97: Automatic Resource Booking Available with Sample Scripts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178351</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Outlook 97
<LI>Microsoft Exchange Server version 5.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Automatic resource booking, a scheduling feature, is the ability to have
a "resource" account, conference room, piece of equipment, or such,
automatically accept or reject meeting requests based on availability. The
Microsoft Schedule+ implementation of this feature allows the automatic
processing of meeting requests to take place without the use of a delegate
account, and without the resource account logging on. The implementation
is different in Microsoft Outlook 97. Outlook requires that either a
delegate be assigned to the resource account to accept/decline requests,
or that the account be logged on continuously so that automatic processing
can be enabled.
<P>
Microsoft Exchange Server 5.5 introduces a new feature that allows events,
such as a meeting request arriving in a mailbox, to trigger automated
scripts. This feature is the Microsoft Exchange Scripting Agent. One of
the Sample scripts on the Microsoft Exchange Server 5.5 compact disc,
automates the processing of meeting requests. Using this server script
provides the same level of automatic booking in Outlook as in Schedule+,
and provides several additional benefits.
<P>
NOTE: This is a sample script; support is not available for the script
beyond this explanation of how to install and use it. This sample is
provided as an example of how to use the scripting agent.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are several steps to complete in order to configure the Microsoft
Exchange Scripting agent install it and use the sample auto-booking script.

<UL><LI>Install the Scripting Agent
<LI>Assign Client Permissions
<LI>Install the AutoAccept Sample Script
<LI>Test the script
<P>
</UL>These steps assume that you have installed Microsoft Exchange Server 5.5
and Outlook 8.03.
<P>
<P><h3>Install the Scripting Agent</h3>
 
<P>
To verify that the scripting agent is already installed:
<P>
<PRE>   In Control Panel, click Services and in the Service list check for the
   "Microsoft Exchange Event Service."

</PRE>If the service is not listed, follow these steps:

<OL><P><LI>Re-run Setup from the Microsoft Exchange Server compact disc. This will
   start Maintenance Mode Setup.

<P><LI>Click Add/Remove Components.

<P><LI>Click to select Microsoft Exchange Server, then click Change Options.

<P><LI>Click to select "Microsoft Exchange Event Service."

<P><LI>Click OK twice to start Setup.

<P><LI>Restart the server if prompted.
<P>
</OL><h3>Assign Client Permissions</h3>
 
<P>
To install and manage scripts, the resource account must be specifically
granted a permission in the Event_Root container of the folder. To
assign permission so the resource account can install and manage the
script, follow these steps:

<OL><P><LI>Navigate to the Events Root entry that is under the site container.

<P><LI>Select the EventConfig entry for the server that contains the accounts
   that you want to install scripts for. For example, if a conference
   room account is on the server named CORPORATE, select the entry titled
   "EventConfig_Corporate".

<P><LI>On the File menu, click Properties and on the General tab, click Client
   Permissions to grant permission to the resource account.
<P>
</OL><h3>Install the AutoAccept Sample Script</h3>
 
<P>
To install the AutoAccept sample script, start from a computer that is
logged into the resource mailbox. To configure the script, follow these
steps:

<OL><P><LI>On the Server compact disc, open:
<P>
      Server\Support\Collab\Sampler\Scripts\AUTOACCEPT.

<P><LI>Double-click the Autoaccept.txt file to open it in Notepad.

<P><LI>On the Edit menu, click Select All, and on the Edit menu click Copy
    to copy the script to the clipboard.

<P><LI>In Outlook 8.03, click the Inbox of the Resource account mailbox.

<P><LI>On the File menu, click Properties and click to select the Agents tab.
    If you do not see an Agents tab, refer to the third question in the 
    "Common Questions and Answers" section below.

<P><LI>In Agents, click New. Type an appropriate name for the script such as,
    Process Meeting Requests.

<P><LI>Click to select the event "A New Item Is Posted In This Folder."

<P><LI>Click Edit Script. This will launch Notepad with boilerplate text.

<P><LI>On the Edit menu, click Select All and then press DELETE to clear the
    text.

<P><LI>On the Edit menu, click Paste. The text from Autoaccept.txt appears.

<P><LI>On the File menu, click Save, and then quit Notepad.
<P>
</OL><h3>Test the Script</h3>
 
<P>
To see the script work:

<OL><P><LI>Quit any client that is logged onto the resource account. The resource
   account does not need to be logged on for the script to execute.

<P><LI>Using a different account, in the Outlook Calendar folder on the
   Calendar menu, click New Meeting Request. Include the resource account
   in the meeting request.
<P>
</OL><h3>Common Questions and Answers</h3>
 
<P>
The AutoAccept script is a sample script. Microsoft offers no technical
support for samples; however there are several helpful resources that
will aid you in authoring and managing scripts.
<P>
Q.   Where can I get additional help?
<P>
A.   Additional help on configuring the event service and assigning client
<PRE>     permissions can be obtained in the Agents.hlp Help file located in the
     Server\Support\Collab\Sampler\Scripts folder. Additional information
     on the specific autoaccept script can be found in the Readme.txt file
     in the Server\Support\Collab\Sampler\Scripts\Autoaccept folder. Also,
     since most scripts are written to take advantage of the Collaborative
     Data Object (CDO) object model, all reference information on CDO on
     the Microsoft Web (www.microsoft.com) is applicable.

</PRE></OL>Q.   Why do I not see the event service in Control-Panel Service?
<P>
A.   It probably was not installed during Microsoft Exchange Server 5.5
<PRE>     Setup. Use the maintenance mode of Setup to add the event service
     component.

</PRE>Q.   Why do I not see the Agents tab when viewing Properties on a folder
<PRE>     from Outlook?

</PRE>A.   The Agents tab is provided by an extension in Outlook. This extension
<PRE>     is automatically added during the Outlook 8.03 Typical Setup. To make
     sure that the extension is installed, on the Tools menu click Options
     and on the General tab click Add-In Manager. There should be an entry
     for Server Scripting. If the entry is not there, rerun Outlook 8.03
     Setup and use the Add/Remove option to add the Server Scripting
     extension. If the extension is installed  and checked, and no Agent
     tab appears, then you do not have client permissions to install and
     manage scripts. These must be granted using the Microsoft Exchange
     Admin program as described in the section above titled "Assign Client
     permissions".

</PRE>Q.   Everything is installed properly, but the Script is not executing.
<PRE>     What's wrong?

</PRE>A.   Wait a few minutes. server scripts are processed asynchronously, and
<PRE>     there may be a couple of minutes lag time between processing.
     If you have waited more than 10 minutes with no action, then recheck
     the event that you selected for the script. For this sample, the event
     "A Message Is Posted To This Folder" is the only event that should be
     selected. Also verify that your code did in fact get copied intact
     into the script by using the Edit-Script button.

</PRE>Q.   What advantages does this script give me over the existing Outlook and
<PRE>     Schedule+ implementations of resource booking?

</PRE>A.   The advantages over the existing Outlook method are that the script
<PRE>     method does not require delegate interaction to manually
     accept/decline requests, and it does not require that the resource
     account be logged in to automatically process the request. The
     advantages over the Schedule+ implementation are that the processing
     works even when the meeting organizer is offline, and the meeting
     organizer does not have to be granted specific permission for the
     direct booking.

</PRE>Q.   The script is declining my request, even though the resource is
<PRE>     available. Why?

</PRE>A.   The example script as written only handles 30 minute appointments. If
<PRE>     your appointment is greater than 30 minutes in duration, the request
     will always be denied due to the decision logic in the script.
     Microsoft plans to remove this limitation in a subsequent sample
     script and will post more information here when that revision becomes
     available.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : GnlCal<BR>
Version           : WINDOWS:5.5,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
