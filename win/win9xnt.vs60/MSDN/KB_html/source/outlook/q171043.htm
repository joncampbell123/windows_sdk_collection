

<HTML>
<HEAD>
<TITLE>OL97: Microsoft Fax Does Not Process Dialing Properties </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171043">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1997/07/07">
<META NAME="Keywords" CONTENT="GnlDial kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; outlook, exchange, office, officevba, vbapp, setup">
<META NAME="Description" CONTENT="  When using Microsoft Word 97 with the Microsoft Outlook 97 Outlook Address Book to Mail Merge to Fax (also known as Broadcast Fax), the telephone number dials incorrectly. The Fax service dials local numbers with the area code and long-distance num...">
<META NAME="Product" CONTENT="Outlook">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDL4,QAVU,QAKC,QBVO,QBC6,QAH4,QAG8,QBJZ,QBWS,QBUP,QBVV,QAPN,QDNQ,QAIH,QAIF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OL97: Microsoft Fax Does Not Process Dialing Properties</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171043</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Outlook 97
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using Microsoft Word 97 with the Microsoft Outlook 97 Outlook Address
Book to Mail Merge to Fax (also known as Broadcast Fax), the telephone
number dials incorrectly. The Fax service dials local numbers with the area
code and long-distance numbers with the area code, but without the leading
+1.
<P>
<P><h2>CAUSE</h2>
 
<P>
When using Word to Mail Merge to Fax, the Microsoft Fax service dials
telephone numbers as they appear in the Outlook Fax number field. The
telephone numbers are not processed by the modem's dialing properties.
Outlook will automatically add the local area code if you do not enter an
area code when you type the telephone number in the Fax field. In this
situation, the Fax modem incorrectly dials both local and long-distance
telephone numbers with 10 digits.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
For Microsoft FAX to process the modem dialing properties, there must be a
+1 in front of the telephone number in the Fax field. The long distance
prefix of +1 forces the modem dialing properties to evaluate the telephone
number. The number should follow this format:
<P>
<PRE>   +1 (555)555-5555

</PRE>There are two methods of solving this problem.

<UL><LI>Prior to initially entering the Fax numbers in your Outlook contacts,
   you can set Outlook so that it automatically enters a +1 in the Fax
   number field as you enter new local and long-distance telephone numbers.
   This method effects all telephone numbers, not just Fax numbers.

<LI>If you need to modify existing contact Fax numbers, you will have to
   modify the records manually. Or, use the VBScript code below to
   accomplish a batch modification. The code example will only modify Fax
   numbers; it will not modify Phone field entries.
<P>
</UL><h3>Setting Outlook to Enter +1 for All New Fax Entries</h3>
 
<P>
Use the following steps to set Outlook so that all new telephone numbers
begin with a +1:

<OL><P><LI>Start Outlook.

<P><LI>On the Tools menu, click Options.

<P><LI>Under the General tab, click Dialing Options to open the Dialing
   Options dialog box.

<P><LI>Click to select "Automatically add country code to local phone numbers."

<P><LI>Click OK and OK to close all dialog boxes.
<P>
</OL>Now, whenever you add a new telephone number to a contact, Outlook will add
a +1 prefix and Microsoft Fax will properly process the modem dialing
properties. This method effects all telephone numbers, not just Fax
numbers.
<P>
<P><h3>VBScript to Modify Existing Fax Numbers</h3>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE></OL>Follow these steps to automatically modify your existing Fax numbers:

<OL><P><LI>Start Outlook and open the Contacts folder that contains the contact
    Fax numbers that you want to modify. This method adds a +1 to every Fax
    number in the selected folder. Telephone numbers that are not Fax
    numbers remain unchanged.

<P><LI>On the File menu, click New, and then Contact to open an Untitled
    Contact.

<P><LI>In the Untitled Contact on the Tools menu, click Design Outlook Form.

<P><LI>Click the (P.2) tab to open page two of the form.

<P><LI>On the Form menu, click Display This Page.

<P><LI>On the Form menu, click Control Toolbox.

<P><LI>From the Control Toolbox, drag a CommandButton to P2 of the Untitled
    Contact form.

<P><LI>On the Form menu, click View Code to open the Script Editor.

<P><LI>Type the following code into the Script Editor, and then on the File
    menu of the Script Editor, click Close to close the editor:
<P>
<PRE>       Sub CommandButton1_Click
       Dim FXNum(2)
       Plus1 = "+1"
       Set CurFolder = Application.ActiveExplorer.CurrentFolder
       For I = 1 to CurFolder.Items.Count
        Set CurItem=CurFolder.Items.Item(I)
         FXNum(0) = CurItem.BusinessFaxNumber
         FXNum(1) = CurItem.OtherFaxNumber
         FXNum(2) = CurItem.HomeFaxNumber
         For X = 0 to 2
           If FXNum(X) &lt;&gt; "" then
            Test = InStr(FXNum(X),Plus1)
            If Test = 0 then
               Count = Count + 1
          Select Case X
            Case 0
              CurItem.BusinessFaxNumber = Plus1 &amp; " " &amp; FXNum(X)
            Case 1
              CurItem.OtherFaxNumber = Plus1 &amp; " " &amp; FXNum(X)
            Case 2
              CurItem.HomeFaxNumber = Plus1 &amp; " " &amp; FXNum(X)
            End Select
          CurItem.Save
            End If
           End If
         Next
       Next
       MsgBox Count &amp; " Records modified" &amp; Chr(13) &amp; "Process Done"
       End Sub

 10. On the Untitled Contact Tools menu, click Design Outlook Form to exit
     the design mode.

</PRE></OL>Now when you click CommandButton1 on "P2" of the Untitled Contact form, the
VBScript code modifies all of the Fax numbers in your open Contact folder
so that they begin with the long distance prefix +1.
 
<PRE>Keywords          : GnlDial kbinterop
Version           : WINDOWS:97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : kbcode</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
