

<HTML>
<HEAD>
<TITLE>PRB: Placement of &lt;Script&gt; Tag Results in Unexpected Behavior </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152981">
<META NAME="KBModify" CONTENT="1996/10/29">
<META NAME="KBCreate" CONTENT="1996/06/26">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; scripting">
<META NAME="Description" CONTENT="  Microsoft Internet Explorer (IE) supports both JavaScript and VBScript functionality. For compatibility reasons, the default is JavaScript. If a block of        code is placed ahead of a block of          code, errors may result.  RESOLUTION  To pr...">
<META NAME="Product" CONTENT="Scripting">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAH4,QBWA,QAGI,QAY5,QAMB,QBV9,QAPN,QAAP,QAB4,QAL3,QAIF,QBV8,QAB9,QBRJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Placement of &lt;Script&gt; Tag Results in Unexpected Behavior</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152981</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic, Scripting Edition, versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Internet Explorer (IE) supports both JavaScript and VBScript
functionality. For compatibility reasons, the default is JavaScript. If a
block of &lt;Form&gt; code is placed ahead of a block of &lt;script&gt; code, errors
may result.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent these errors, always place &lt;script&gt; tags ahead of any objects
that call into functions defined with the tags. By moving the &lt;script&gt; tag
and associated code ahead of the form definition, the VBScript compiler is
invoked and the Button element correctly references the function it calls
in the onClick event.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. Internet Explorer 3.0 defaults to JavaScript
compilation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
As an HTML page containing VBScript or JavaScript, code is loaded by IE
3.0, it is parsed and compiled. If a form element makes a call to some
function that is later defined within a &lt;Script&gt; tag, errors can result if
the form element does not use the proper calling conventions.
<P>
IE 3.0 defaults to using the JavaScript compiler. When the compiler sees
the form element, it generates JavaScript code to make the function
call associated to the form element. If the &lt;Script&gt; tag is defined after
the form element and specifies Language="VBScript," this function call is
syntactically incorrect and an error results.
<P>
To avoid this error, all &lt;Script&gt; tags should be defined before any form or
other objects that make functions calls. The preferred placement of the
&lt;Script&gt; tag is within the &lt;Head&gt;&lt;/Head&gt; tags. By using this placement, any
function that may be called by a forms element has already been loaded and
compiled.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The HTML code below demonstrates the problem:
<P>
<PRE>   &lt;HTML&gt;
   &lt;Head&gt;&lt;title&gt;a test&lt;/title&gt;&lt;/Head&gt;
   &lt;body&gt;

   &lt;form name="vbtest"&gt;
   &lt;input type="button" Name="Button1" value="Press Me"
   onclick="btnPress"&gt;
   &lt;/form&gt;

   &lt;Script language="VBScript"&gt;
   sub btnPress
       alert "you pressed the button"
   end sub
   &lt;/script&gt;
   &lt;/body&gt;
   &lt;/HTML&gt;

</PRE>Because the compiler reads the form definition first, it compiles the
onClick event into a JavaScript reference. When the button is clicked, the
interpreter tries to find the appropriate JavaScript function to execute.
However, the function is in a block of VBScript code and is not seen by the
interpreter as executable JavaScript code. Therefore, an "object doesn't
support the property or method" error results.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: vbsEnvtIE vbObjMdlIE<BR>
Additional reference words: 1.00 1.10 2.00 kbdse kndsi vbscript vbs
<P>


<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
