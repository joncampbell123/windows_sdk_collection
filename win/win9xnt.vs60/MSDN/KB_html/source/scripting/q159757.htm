

<HTML>
<HEAD>
<TITLE>How To Read the Selected Items in a SELECT Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159757">
<META NAME="KBModify" CONTENT="1996/11/26">
<META NAME="KBCreate" CONTENT="1996/11/20">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; scripting">
<META NAME="Description" CONTENT="  This article demonstrates how to read what items are selected in a SELECT control on a Web page using Visual Basic Script. Many reference documents indicate that a SELECT control has a VALUE property. However, this is not true. The SELECT control d...">
<META NAME="Product" CONTENT="Scripting">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2Q,QAG2,QBS0,QAKD,QBWA,QA7O,QAOE,QAMN,QAB5,QDNQ,QBWS,QAPN,QABH,QBV8,QBFN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Read the Selected Items in a SELECT Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 26, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159757</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic, Scripting Edition, versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to read what items are selected in a SELECT
control on a Web page using Visual Basic Script. Many reference documents
indicate that a SELECT control has a VALUE property. However, this is not
true. The SELECT control does not have a VALUE property, but the items in
the OPTIONS collection of the SELECT control do.
<P>
If you are not familiar with the SELECT control, it is similar to the
ListBox control in Visual Basic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order to read what item(s) are selected in a SELECT control, you must
loop through the elements, and then check if the current element is
selected. If it is selected, then you can perform an action.
<P>
Use a text editor, such as Notepad.exe, to copy the following sample HTML
code into an HTML file:
<P>
********* BEGIN Page1.HTM *******************
&lt;HTML&gt;
<PRE>  &lt;SCRIPT LANGUAGE="VBSCRIPT"&gt;
    Sub ShowVals
      Dim SelStr
      For i = 0 to Form1.myselect.length - 1
        If Form1.myselect.options(i).selected = 1 Then
          selstr = selstr &amp; Form1.myselect.options(i).value &amp; chr(10)
        End If
      Next
      MsgBox SelStr,,"Selected Item(s)"
    End Sub
  &lt;/SCRIPT&gt;

  &lt;BODY&gt;
    &lt;FORM NAME="Form1"&gt;
      &lt;SELECT MULTIPLE NAME="MySelect"&gt;
        &lt;OPTION VALUE="10"&gt;Option 1 (10)
        &lt;OPTION VALUE="20"&gt;Option 2 (20)
        &lt;OPTION VALUE="30"&gt;Option 3 (30)
      &lt;/SELECT&gt;
      &lt;BR&gt;
      &lt;INPUT TYPE=BUTTON onClick="ShowVals()" VALUE="Show Value(s)"&gt;
    &lt;/FORM&gt;
  &lt;/BODY&gt;
</PRE>&lt;/HTML&gt;
*********  BEGIN End.HTM  *******************
<P>
<P><h3>Program Flow</h3>
 

<OL><P><LI>The onClick event of the button on the page calls the ShowVals
   subroutine.

<P><LI>The ShowVals subroutine creates a variable to hold the selected items
   (SelStr).

<P><LI>The "Form1.myselect.length" variable represents the number of items in
   the list. The For loop uses this value to determine how many iterations
   it needs in the loop.

<P><LI>In each iteration of the loop the program checks to see if the current
   item is selected.

<P><LI>If the current item is selected, then its value is concatenated onto the
   string described in step 2. "Chr(10)" is also added to the string, and
   it evaluates to a carriage-return character for cosmetic purposes.

<P><LI>A message box displays the string.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information, visit the Microsoft Site Builder Workshop at
<B><A href="http://www.microsoft.com/workshop">http://www.microsoft.com/workshop.</A></B>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbhowto<BR>
KBSubcategory: PrgCtrlsStd PrgSyntaxVBScript PrgObjMdlIE<BR>
Additional reference words: 1.00 1.10 2.00 kbdsi
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 26, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
