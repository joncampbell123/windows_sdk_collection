

<HTML>
<HEAD>
<TITLE>PRB: Unable to Access Script in ALX from Script in HTML </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163397">
<META NAME="KBModify" CONTENT="1997/02/11">
<META NAME="KBCreate" CONTENT="1997/02/10">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; scripting">
<META NAME="Description" CONTENT="  When attempting to invoke a script embedded in an .alx file from a script in an HTML page, which references that ALX via an HTML Layout control, the following error occurs:     VBScript runtime error. Line    : Type Mismatch  RESOLUTION  The follow...">
<META NAME="Product" CONTENT="Scripting">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAH4,QBWA,QAW6,QAPN,QAUJ,QAMB,QAKD,QAFF,QAGI,QAY2,QBS0,QAAP,QAB4,QABG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Unable to Access Script in ALX from Script in HTML</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163397</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic, Scripting Edition, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When attempting to invoke a script embedded in an .alx file from a script
in an HTML page, which references that ALX via an HTML Layout control, the
following error occurs:
<P>
<PRE>   VBScript runtime error. Line &lt;n&gt;: Type Mismatch

</PRE><h2>RESOLUTION</h2>
 
<P>
The following two steps are required to work around this problem:

<OL><P><LI>Upgrade to Microsoft Visual Basic, Scripting Edition, version 2.0
   or later.

<P><LI>Place the common code that needs to be executed by both the HTML and the
   ALX in the HTML file. While scripts in an HTML file cannot invoke
   scripts in an ALX file, scripts embedded in an ALX file can invoke
   scripts embedded in the containing HTML file.
<P>
</OL>In VBSCRIPT 1.0, scripts could not be invoked in either direction and
instead yielded the following error:
<P>
<PRE>   VBScript runtime error. Line &lt;n&gt;: Type Mismatch

</PRE></OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Launch Notepad, and copy and paste the following code into the file:
<P>
<P><PRE>      &lt;HTML&gt;
      &lt;HEAD&gt;
      &lt;TITLE&gt;New Page&lt;/TITLE&gt;
</PRE><P>
<P><PRE>      &lt;SCRIPT LANGUAGE=VBSCRIPT&gt;
<PRE></PRE>      Sub cmdHtm_Click
         ' Demonstrates the inability of the container to call
         ' contained code
         ' Clicking on cmdHTM will generate a scripting error
         ALXFunc
      End Sub

      Sub HTMFunc()
         ' Demonstrates the ability to call code from the container
         MsgBox "Code in the HTML file was invoked!"
      End Sub

      Sub cmdChangeALXButtonProps_Click()
         ' Demonstrates the it's possible for code in an HTML file to
         ' modify the properties of object contained in an embedded ALX.
         layout1_alx.cmdAlx.caption = "Click me!"
         layout1_alx.cmdAlx.backColor = &amp;h80000010
      End Sub
      &lt;/SCRIPT&gt;
      &lt;/HEAD&gt;
      &lt;BODY&gt;

      &lt;OBJECT ID="cmdHtm" WIDTH=99 HEIGHT=88
          CLASSID="CLSID:D7053240-CE69-11CD-A777-00DD01143C57"&gt;
          &lt;PARAM NAME="Caption" VALUE="Button in HTML"&gt;
          &lt;PARAM NAME="Size" VALUE="2611;2328"&gt;
          &lt;PARAM NAME="ParagraphAlign" VALUE="3"&gt;
      &lt;/OBJECT&gt;
      &lt;P&gt;
      &lt;OBJECT ID="cmdChangeALXButtonProps"
         CLASSID="CLSID:D7053240-CE69-11CD-A777-00DD01143C57"
         STYLE=
        "TOP:150pt;LEFT:100pt;WIDTH:74pt;HEIGHT:66pt;TABINDEX:0;ZINDEX:0;"&gt;
         &lt;PARAM NAME="Caption" VALUE="Change Caption"&gt;
         &lt;PARAM NAME="Size" VALUE="2611;2338"&gt;
         &lt;PARAM NAME="ParagraphAlign" VALUE="3"&gt;
      &lt;/OBJECT&gt;
      &lt;P&gt;
      &lt;OBJECT ID="layout1_alx"
         CLASSID="CLSID:812AE312-8B8E-11CF-93C8-00AA00C08FDF"
         STYLE="LEFT:0;TOP:0"&gt;
         &lt;PARAM NAME="ALXPATH" REF VALUE="oneway.alx"
      &lt;/OBJECT&gt;
      &lt;/BODY&gt;
      &lt;/HTML&gt;

</PRE><P><LI>Save the file as Oneway.htm.

<P><LI>Create a new file, copy and paste the following code into the new file:
<P>
<P><PRE>      &lt;SCRIPT LANGUAGE="VBS"&gt;
<PRE></PRE>      Sub cmdAlx_Click
         ' Demonstrates invoking code located in containing HTML
         HTMFunc
      End Sub

      Sub ALXFunc()
         ' Demonstrates the inability of the container to call
         ' contained code
         MsgBox "Code in ALX was invoked!"
      End Sub
      &lt;/SCRIPT&gt;

      &lt;DIV ID="layout1" STYLE="LAYOUT:FIXED;WIDTH:78pt;HEIGHT:69pt;"&gt;
      &lt;OBJECT ID="cmdAlx"
         CLASSID="CLSID:D7053240-CE69-11CD-A777-00DD01143C57"
         STYLE=
            "TOP:0pt;LEFT:0pt;WIDTH:74pt;HEIGHT:66pt;TABINDEX:0;ZINDEX:0;"&gt;
         &lt;PARAM NAME="Caption" VALUE="ALX Button"&gt;
         &lt;PARAM NAME="Size" VALUE="2611;2328"&gt;
         &lt;PARAM NAME="ParagraphAlign" VALUE="3"&gt;
      &lt;/OBJECT&gt;
      &lt;/DIV&gt;

</PRE><P><LI>Save the file as Oneway.alx in the same directory as Oneway.htm.

<P><LI>Launch Internet Explorer 3.x, and load Oneway.htm.

<P><LI>Click on the button labeled "ALX Button," and observe the message box
   indicating that code in the HTML file has been executed. This
   demonstrates that it's possible from code in an ALX file to call script
   code located in the containing HTML file.

<P><LI>Click on the button labeled "Button in HTML," and observe the VBSCRIPT
   error indicating that it isn't possible from an HTML file to execute \
   code embedded in an ALX file.

<P><LI>Click on the button labeled "Change Caption," and observe that it is
   possible from a containing HTML file to change the properties of objects
   contained in a referenced ALX file.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: AXSDKSripting<BR>
Additional reference words: 2.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
