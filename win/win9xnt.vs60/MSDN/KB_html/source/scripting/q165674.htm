

<HTML>
<HEAD>
<TITLE>INFO: Display Icons in Treeview Control with ImageList Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165674">
<META NAME="KBModify" CONTENT="1997/03/25">
<META NAME="KBCreate" CONTENT="1997/03/24">
<META NAME="Keywords" CONTENT="PrgCtrlsStd">
<META NAME="KBArea" CONTENT="Support; KB; scripting">
<META NAME="Description" CONTENT="  To Display icons in the Treeview control using the ImageList control, you have to load the images into Image controls and associate the Image controls with the ImageList control. You need to do this because Visal Basic, Scripting Edition (VBScipt),...">
<META NAME="Product" CONTENT="Scripting">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBLP,QAB5,QA7O,QAW6,QAPN,QAOE,QAMN,QDNQ,QAUJ,QAKD,QBXS,QA4H,QAYY,QBS0,QBSO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Display Icons in Treeview Control with ImageList Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165674</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic, Scripting Edition, versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To Display icons in the Treeview control using the ImageList control, you
have to load the images into Image controls and associate the Image
controls with the ImageList control. You need to do this because Visal
Basic, Scripting Edition (VBScipt), does not support LoadPicture in version
1.x.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Following is a sample of how to display icons in a Treeview control using
the ImageList control and Image control.
<P>
<PRE>   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;TITLE&gt;New Page&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY&gt;

   &lt;OBJECT ID="ImageList1" WIDTH=38 HEIGHT=38
    CLASSID="CLSID:58DA8D8F-9D6A-101B-AFC0-4210102A8DA7"&gt;
       &lt;PARAM NAME="_Version" VALUE="65536"&gt;
       &lt;PARAM NAME="_ExtentX" VALUE="804"&gt;
       &lt;PARAM NAME="_ExtentY" VALUE="804"&gt;
       &lt;PARAM NAME="_StockProps" VALUE="1"&gt;
       &lt;PARAM NAME="BackColor" VALUE="-2147483643"&gt;
       &lt;PARAM NAME="MaskColor" VALUE="12632256"&gt;
   &lt;/OBJECT&gt;

   &lt;OBJECT ID="Image1" WIDTH=0 HEIGHT=0
    CLASSID="CLSID:4C599241-6926-101B-9992-00000B65C6F9"
    DATA="DATA:application/x-
   oleobject;BASE64,QZJZTCZpGxCZkgAAC2XG+QACEAAEBgAA
   //8AAIMDAACDAwAAsIFn2krCzxG1
   hACqAKcdGmx0AAA2BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAA
   KAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAA
   AAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/
   AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
   AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAAAAAAAAAAP
   C/8AAAAAAAAAAAAAAAAACw/7/wAAAAAAAAAAAAAAAA8L//uPAAAAAAAAAAAA
   AAALD/v/i/8AAAAAAAAAAAAADwv/+4/7jwAAAAAAAAAAAAsP+//7/4uPAAAA
   AAAAAAAPC//7//uPi48AAAAAAAAACw/7//v/i4+L8AAAAAAAAA8L//v/+4+L
   j/AAAAAAAAALD/v/+/+Lj4vwAAAAAAAADwv/+//7j4uP8AAAAAAAAAsP+//7
   /4uPi/AAAAAAAAAPC//7//v/i4/wAAAAAAAACw/7//v/+4+L8AAAAAAAAA8L
   //v/+/+Lj/AAAAAAAAALD/v/+//7j4vwAAAAAAAADwv/+//7/4uP8AAAAAAA
   AAsA+//7//v/i/AAAAAAAAAA+wD7APv/+4/wAAAAAAAAAAD7APsA+/+L8AAA
   AAAAAAAAAL+/vwD7j/AAAAAAAAAAAAAL+/v7D4vwAAAAAAAAAAAAD7+/vwuP
   8AAAAAAAAAAAAAD7+/vwC/AAAAAAAAAAAAAAAL8AD7AAAAAAAAAAAAAAAAAA
   AAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////
   ////P////g////wD///8AP///AA///wAD//8AAP//AAA//wAAD/8AAA//AAA
   P/wAAD/8AAA//AAAP/wAAD/8AAA//AAAP/wAAD/8AAA//AAAP/wAAD//AAA/
   /8AAP//wAD//8AA///AAP//8AD///zh////+f/////8oAAAAEAAAACAAAAAB
   AAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAA
   AACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////
   AAAAAAAAAAAAAA8AAAAAAAAACwsAAAAAAAAPD4sAAAAAAAsLj4sAAAAADw/7
   j4sAAAALC/+LjwAAAA8P+4+LAAAACwv/+48AAAAPD/v/iwAAAAvwD/uPAAAA
   AL+wD4sAAAAAAPvwDwAAAAAAv7+wAAAAAAAL8AAAAAAAAAAAAAAA5/8AAMP/
   AADA/wAAwD8AAMAPAADABwAAwAcAAMAHAADABwAAwAcAAMAHAADABwAA8AcA
   APgHAAD4BwAA/n8AAA==
   "&gt;
   &lt;/OBJECT&gt;

   &lt;OBJECT ID="Image2" WIDTH=0 HEIGHT=0
    CLASSID="CLSID:4C599241-6926-101B-9992-00000B65C6F9"
    DATA="DATA:application/x-
   oleobject;BASE64,QZJZTCZpGxCZkgAAC2XG+QACEAAEBgAA
   //8AAIMDAACDAwAAsIFn2krCzxG1
   hACqAKcdGmx0AAA2BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAA
   KAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAA
   AAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/
   AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAC7sACIgA
   AAcAAMzMAAAADgu7CwiIBwAAAADMzAwAAA4LuwgIiAdwBweQzMwMwAAOC7sL
   CIgHcAAAcMzMDMwADgu7CAiIB3cHB5DMzAzMwA4LuwsIiAdwAABwzMwMzMAO
   C7sICIgHdwcHkMzMDMzADgu7CwiIB3AAAHDMzAzMwA4LuwgIiAd3BweQzMwM
   zMAOCwsLCAgHcAAAcMzMDMzADgsLCAgIB3cHB5DMzAzMwA4LuwsICAdwAABw
   zMwMzMAOCwsICIgHdwcHkMzMDMzADgsLCwiIB3AAAHDMzAzMwA4LCwgIiAd3
   BweQzMwMzMAOC7sLCIgHcAAAcMzMDMzADgsLCAiIB3cHB5DMzAzMwA4LCwsI
   iAd3AAlwzMwMzMAOCwsICIgHd3CAkMDMDMzADgsLCwAAB3d3CADADAzMwA4L
   CwiwiIB3dwCAzMwMzMAOC7sLiwiIB3cAAMzMDMzAAAu7CLiwiIB3AADMzAzM
   wAAAAAuLiwiIBwAAAAAMzMAAAIiAuLiwiIAAAAiIgMzAAAAIiAuLgAAAAAAA
   iIgMwAAAAIiAuLAAAAAAAAiIgMAAAAAIiAuAAAAAAAAAiIgAAAAAAIiAsAAA
   AAAAAAAAAAAAAAAIiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwQcYHwAD
   CA8AAAAHAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
   AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABgA
   gAAYAMAAHADgAB4A8AP/APgD/4D8A//A/wP///+D//8oAAAAEAAAACAAAAAB
   AAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAA
   AACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////
   AAAAAAAAAAAADgsIAAgMwAAOCwgHiAzAwA4LCAcIDMDADgsIB4gMwMAOCwAH
   CAzAwA4LAAeIDMDADgsIBwgMwMAOCwgHiAzAwA4LCAcIDMDADgsAB3gMwMAO
   C4CAcAzAwAAAuAgAAADAAAgLAAAAiAAAAIAAAAAIgAAAAAAAAACAAcMAAAAB
   AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgEAA
   AMBgAADh8AAA8fgAAA==
   "&gt;
   &lt;/OBJECT&gt;

    &lt;OBJECT ID="Image3" WIDTH=0 HEIGHT=0
    CLASSID="CLSID:4C599241-6926-101B-9992-00000B65C6F9"
    DATA="DATA:application/x-
   oleobject;BASE64,QZJZTCZpGxCZkgAAC2XG+QACEAAEBgAA
   //8AAIMDAACDAwAAsIFn2krCzxG1
   hACqAKcdGmx0AAA2BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAA
   KAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAA
   AAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/
   AAAA//8A/wAAAP8A/wD//wAA////AAd3d3AAd3cAAAAAAAAAAAAAAAB3cAAH
   dwAAAAAAAAAAD///AA//8Ad3AAAAAAAAAA////////8AB3cAAAAAAAAP////
   //////AHcAAAAAAAD///////////AHcAAAAAAA////////////AHAAAAAAAP
   ////////////B3AAAAAAD///93d3d3d3dwB3d3dwAA/////////////wAAAA
   dwAP////////////////8AdwD/////////////////8AcA//////////////
   ////8HAP//////////////////B3D//////////////////wBw////d3d3d3
   d3d3d3d3dwcP//////////////////8HD///////////////////Bw//////
   /////////////wcP//////////////////8HD///////////////////Bw//
   /////////////////wcP///3d3d3d3d3d3d3d3cHD///////////////////
   Bw////n/+fmZ+f/5/5n//wcP///5//n5//n/+fn/n/8HD///+fn5+Z/5+fn5
   /5//Bw////mfmfn/+Z+Z+f+f/wcP///5//n5mfn/+f+Z//8HD///////////
   ////////Bw///////////////////wcAAAAAAAAAAAAAAAAAAAAAgcP//wAA
   //8AAD//AAAP/wAAB/8AAAP/AAAD/wAAAf8AAAAHAAAAAwAAAAEAAAABAAAA
   AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
   AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEoAAAAEAAAACAAAAAB
   AAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAA
   AACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////
   AHd3d3cAAAAAAAAAAHcAAAAP////AHAAAA//////B3AAD/zMzMzAB3cP////
   ///wBw////////8HD/zMzMzMzAcP////////Bw////////8HD/zMzMzMzAcP
   +f+Z+fmfBw/5n5/5+fkHD/n5mfmfnwcP////////BwAAAAAAAAAHAP8AAAA/
   AAAAHwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
   AAAAAAAAAAAAAAAAAA==
   "&gt;
   &lt;/OBJECT&gt;
   &lt;OBJECT  ID="TreeView1"
      TYPE="application/x-oleobject"
      CLASSID="CLSID:0713E8A2-850A-101B-AFC0-4210102A8DA7"
      CODEBASE="/scripts/comctl32.ocx"
     WIDTH=100% HEIGHT=82% &gt;
   &lt;/OBJECT&gt;

   &lt;FORM&gt;&lt;INPUT NAME="Button1" TYPE="BUTTON" VALUE="Click Here"&gt;&lt;/FORM&gt;

       &lt;SCRIPT LANGUAGE="VBScript"&gt;
   &lt;!--

   Sub Button1_OnClick()
       Dim nodX, imgX

      ImageList1.ImageHeight = 16
      ImageList1.ImageWidth = 16

      Set imgX = ImageList1.ListImages.Add(1,"open",Image1.picture)
      Set imgX = ImageList1.ListImages.Add(2,"closed",Image2.picture)
      Set imgX = ImageList1.ListImages.Add(3,"leaf",Image3.picture)

       TreeView1.ImageList = ImageList1    ' Initialize ImageList.

       Set nodX = TreeView1.Nodes.Add(,, "r", "Root", 1)

       Set nodX = TreeView1.Nodes.Add(,, "r1", "Root1", 2)

       Set nodX = TreeView1.Nodes.Add(,, "r2", "Root2", 3)

    end sub
   --&gt;
       &lt;/SCRIPT&gt;


   &lt;/BODY&gt;
   &lt;/HTML&gt;
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : PrgCtrlsStd<BR>
Version             : 1.00 1.10<BR>
Platform            : WINDOWS<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
