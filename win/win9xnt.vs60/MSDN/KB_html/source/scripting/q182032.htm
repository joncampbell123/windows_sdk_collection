

<HTML>
<HEAD>
<TITLE>FIX: MsgBox "Permission Denied" Error in WebBrowser Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182032">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1998/03/04">
<META NAME="Keywords" CONTENT="AXSDKSripting kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; scripting">
<META NAME="Description" CONTENT="  When navigating to a page in an application that hosts the Microsoft WebBrowser control, you will get the following scripting error message:     Permission Denied  This error occurs specifically at a location in script code where the VBScript metho...">
<META NAME="Product" CONTENT="Scripting">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QAOE,QAUD,QBRJ,QA7O,QAMN,QBV9,QAB4,QAAP,QDNQ,QAR4,QAPN,QA01,QAO4,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: MsgBox "Permission Denied" Error in WebBrowser Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182032</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic, Scripting Edition, versions 1.0, 1.1, 2.0
<LI>Microsoft Internet Explorer (Programming), versions 3.0, 3.01, 3.02
<LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft Visual C++, 32-bit Editions, versions 4.2b, 5.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When navigating to a page in an application that hosts the Microsoft
WebBrowser control, you will get the following scripting error message:
<P>
<PRE>   Permission Denied

</PRE>This error occurs specifically at a location in script code where the
VBScript method MsgBox is called.
<P>
It also occurs if the WebBrowser control is being hosted using Visual C++
and the Microsoft Foundation Classes' (MFC) default control containment
support.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error occurs because the IOleInPlaceFrame implementation of the
control container is not returning S_OK from the EnableModeless method.
<P>
MFC's control containment support returns E_NOTIMPL, which causes the
scripting engine to not allow a message box to be displayed; hence, the
"Permission Denied" error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Modify the control container to return S_OK from the
IOleInPlaceFrame::EnableModeless method. EnableModeless should prepare the
top-level frame for the display or removal of a modal dialog box based on
the supplied Boolean parameter. Refer to the documentation for
IOleInPlaceFrame::EnableModeless for more information on how to implement
this method.
<P>
This problem does not occur when hosting the Internet Explorer 4.0
WebBrowser control in an MFC application.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Microsoft
Internet Explorer 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
MFC containers can use a call to CWinApp::EnableModeless to fully implement
this function and return S_OK. Here is a code sample:
<P>
<PRE>   STDMETHODIMP CMyOleControlContainer::XMyOleIPFrame::EnableModeless(BOOL
     f)
   {
      METHOD_PROLOGUE_EX(CMyOleControlContainer, OleIPFrame)

      CWinApp* pApp = AfxGetApp();
      if ( ! pApp )
         return E_FAIL;

      pApp-&gt;EnableModeless( f );
      return S_OK;
   }

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information on modifying MFC control containment support to
override this method, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q141277.htm">Q141277</A></B>
   TITLE     : How to Override an Interface in an MFC Application

</PRE> 
<PRE>Keywords          : AXSDKSripting kberrmsg
Technology        : kbInetDev
Version           : WINDOWS:1.0,1.1,2.0,3.0,3.01,3.02; WINNT:4.2b,5.0
Platform          : WINDOWS winnt
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
