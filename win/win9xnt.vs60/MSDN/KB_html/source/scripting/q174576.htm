

<HTML>
<HEAD>
<TITLE>HOWTO: Returning Arrays from Server-Side Objects in ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174576">
<META NAME="KBModify" CONTENT="1997/10/03">
<META NAME="KBCreate" CONTENT="1997/10/01">
<META NAME="Keywords" CONTENT="AXSFVBS">
<META NAME="KBArea" CONTENT="Support; KB; scripting">
<META NAME="Description" CONTENT="  Active Server Pages developers programming in VBScript (VBS) often encounter  Type Mismatch  errors when attempting to return arrays form server-side objects to server-side script code. This article explains how to do this in VBS version 2.0.  MORE...">
<META NAME="Product" CONTENT="Scripting">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QDNQ,QBS0,QAW6,QAUD,QATX,QAGI,QAH4,QAYL,QBWA,QAP2,QALW,QAG1,QBSO,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Returning Arrays from Server-Side Objects in ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174576</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic, Scripting Edition, version 2.0
<LI>Microsoft Active Server Pages, versions 1.0, 1.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Active Server Pages developers programming in VBScript (VBS) often
encounter "Type Mismatch" errors when attempting to return arrays form
server-side objects to server-side script code. This article explains how
to do this in VBS version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
VBS is not as flexible as Visual Basic when it comes to passing variables
of different types to or from objects. This is because VBS stores all
variables as VARIANTS. Thus, it must convert these VARIANTS to other types
when calling methods on objects.
<P>
A common scenario is to call a method on a server-side object that returns
an array of strings, or some other type, to ASP. Depending on how the
server-side object is coded, this may cause a "Type Mismatch" error in the
script. The key to making this work, is declaring the object method to
return a VARIANT. Inside the method, store the array of data in a VARIANT
and return this variable to the server-side script.
<P>
The code segments below show a method on a Visual Basic 5.0 object, and the
ASP script that calls this method.
<P>
Visual Basic 5.0 Object Method:
<P>
<PRE>   Public Function GetArray() As Variant
    Dim MyVar(5) As Variant
    MyVar(0) = "String 0"
    MyVar(1) = "String 1"
    MyVar(2) = "String 2"
    MyVar(3) = "String 3"
    MyVar(4) = "String 4"
    GetArray = MyVar
   End Function

</PRE>Active Server Pages Script:
<P>
<PRE>   &lt;HTML&gt;
   &lt;BODY&gt;
   &lt;%
     Set Array_Obj = Server.CreateObject("Project1.Class1")
     myarray = Array_Obj.GetArray()
     Response.Write myarray(0) &amp; "&lt;P&gt;"
     Response.Write myarray(1) &amp; "&lt;P&gt;"
     Response.Write myarray(2) &amp; "&lt;P&gt;"
     Response.Write myarray(3) &amp; "&lt;P&gt;"
     Response.Write myarray(4) &amp; "&lt;P&gt;"
   %&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE> 
<PRE>Keywords          : AXSFVBS
Technology        : kbDSupport
Version           : WINDOWS:2.0; WINNT:1.0,1.0b
Platform          : WINDOWS winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
