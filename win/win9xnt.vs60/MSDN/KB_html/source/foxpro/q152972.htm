

<HTML>
<HEAD>
<TITLE>How to Pass Values from VFP Back to Calling AppleScript </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152972">
<META NAME="KBModify" CONTENT="1996/06/28">
<META NAME="KBCreate" CONTENT="1996/06/26">
<META NAME="Keywords" CONTENT="kbprg kb3rdparty kbinterop kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Visual FoxPro evaluates the Apple Script command DO SCRIPT argument as an expression. This article describes the specific command syntax that must be used to use returned values successfully in AppleScripts. Visual FoxPro will only return character...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAUD,QAKD,QA01,QAL3,QA56,QA55,QBXS,QALW,QAPF,QAFR,QAY2,QATX,QAPN,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Pass Values from VFP Back to Calling AppleScript</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 28, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152972</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual FoxPro evaluates the Apple Script command DO SCRIPT argument as an
expression. This article describes the specific command syntax that must be
used to use returned values successfully in AppleScripts. Visual FoxPro
will only return character and numeric data; all others must be converted
before being returned.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following examples show syntax for returning different data types as
values from Visual FoxPro to a calling AppleScript:
<P>
<P><h3>EXAMPLE 1</h3>
 
<P>
To return a numeric value from a program file (.PRG):
<P>
AppleScript:
<P>
<PRE>   tell application "Microsoft Visual FoxPro"
     display dialog "Enter thickness in inches:" default answer 1
     set param1 to the text returned of the result
     display dialog "Enter width in inches:" default answer 6
     set param2 to the text returned of the result
     display dialog "Enter length in feet:" default answer 8
     set param3 to the text returned of the result
     Do Script "BdFeet(" &amp; param1 &amp; "," &amp; param2 &amp; "," &amp; param3 &amp; " ) "
     display dialog "Calculated board feet: " &amp; the result
   end tell

</PRE>Visual FoxPro:
<P>
<PRE>   * BdFeet.PRG - Program to return the board feet based on TWL
   * nThick  - Thickness (in)
   * nWidth  - Width     (in)
   * nLength - Length    (ft)
   *
   #DEFINE nInPerCuFt 144
   #DEFINE nInPerLinFt 12
   PARAMETERS nThick, nWidth, nLength

   nBoardFeet = nThick * nWidth *  nLength * nInPerLinFt
   nBoardFeet = nBoardFeet / nInPerCuFt

   RETURN nBoardFeet

</PRE><h3>EXAMPLE 2</h3>
 
<P>
To set and return a numeric value from an object property:
<P>
AppleScript:
<P>
<PRE>   tell application "Microsoft Visual FoxPro"
     activate
     Do Script "_screen.resettodefault('backcolor')"
     -- Syntax 1 incorrect example to set backcolor to red
     Do Script "_screen.backcolor = RGB(255,0,0)"
     -- grab the backcolor
     Do Script "_screen.backcolor"
     display dialog "The current value of the backcolor is " &amp; the result
     -- Syntax 2 correct example to set backcolor to red
     Do Script "Store RGB( 255, 0, 0 ) to _screen.backcolor"
     -- grab the backcolor
     Do Script "_screen.backcolor"
     display dialog "The current value of the backcolor is " &amp; the result
   end tell

</PRE>Both syntax 1 and 2, if executed directly in Visual FoxPro, would assign a
value to a property. In AppleScript, only Syntax 2 would work as expected.
The equal sign in Visual FoxPro is used as an assignment and a comparison
operator. Syntax 1 is simply a test for equivalence, but Syntax 2 will
correctly store the value to the property.
<P>
<P><h3>EXAMPLE 3</h3>
 
<P>
To return a numeric value from a MessageBox:
<P>
AppleScript:
<P>
<PRE>   tell application "Microsoft Visual FoxPro"
     activate
     -- iconless message box with yes no cancel, note no equals sign
     Do Script "MESSAGEBOX('What happens happens.', 3 , 'Acceptance')"
     if the result is 6 then
       -- yes    (6)
       set btnclicked to "Yes"
     else if the result is 7 then
       -- no     (7)
       set btnclicked to "No"
     else
      -- cancel (2)
      set btnclicked to "Cancel"
     end if
     display dialog "The user chose " &amp; the result &amp; "."
   end tell

</PRE><h3>EXAMPLE 4</h3>
 
<P>
To return a text value and a logical value as a text value from a table:
<P>
AppleScript:
<P>
<PRE>   tell application "Microsoft Visual FoxPro"
     activate
     Do Script "USE :samples:data:customer"
     display dialog "Enter a key in all caps." default answer "LETSS"
     set keyval to the text returned of the result
     -- note concatenation and inclusion of single quotes for argument
     Do Script "LOCATE for Cust_Id = '" &amp; keyval &amp; "'"
     -- forced conversion of logical result to string
     Do Script "IIF(FOUND(),'TRUE','FALSE')"
     if the result is "TRUE" then
       -- note argument syntax
       Do Script "customer.company"
       display dialog "Key: " &amp; keyval &amp; ", Company: " &amp; the result
     else
       display dialog "Key: " &amp; keyval &amp; " not found."
     end if
   end tell
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00b VFoxMac passing<BR>
KBCategory: kbprg kbinterop kb3rdparty kbhowto<BR>
KBSubcategory: FxinteropDbase
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 28, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
