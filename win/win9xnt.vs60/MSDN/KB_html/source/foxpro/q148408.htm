

<HTML>
<HEAD>
<TITLE>PRB: When Event Fires Again Upon Leaving a Grid Column </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148408">
<META NAME="KBModify" CONTENT="1996/03/14">
<META NAME="KBCreate" CONTENT="1996/03/12">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If there is only one column enabled in a grid and you try to use SetFocus to move the focus programmatically to another object such as a command button, the focus moves to the command button correctly but the grid also moves the active grid cell to...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QACI,QAO4,QADO,QAE1,QARR,QAH4,QDMN,QA9N,QANJ,QAEF,QAWF,QAUY,QAKJ,QAJP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: When Event Fires Again Upon Leaving a Grid Column</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 14, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148408</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If there is only one column enabled in a grid and you try to use SetFocus
to move the focus programmatically to another object such as a command
button, the focus moves to the command button correctly but the grid also
moves the active grid cell to highlight the next available cell. Because
there is only one active column, there is no "next available cell," so the
cell that's activated ends up being the same that fired the When event, so
the When event of that column fires again.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are a number of workarounds for this situation:

<UL><LI>Add a small dummy column to the grid so that the focus can move off the
   original cell that implemented the When event onto the dummy column.
<P>
   -or-

<LI>Set the SelectedOnEntry property to False so that the effect is less
   noticeable.
<P>
   -or-

<LI>If the problem is that the When event fires when you manually try to
   move to another object in the VALID, check for movement key presses such
   as TAB or ENTER in the KeyPress method of the column, and substitute
   with CTRL+TAB, which will prevent the attempt to move the pointer to the
   next column.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form. Place a grid (Grid1) and a command button (Command1)
   on the form.

<P><LI>Set the following properties of the Grid:
<P>
   ColumnCount=3
   Column1.Enabled=.F.
   Column2.Enabled=.T.
   Column3.Enabled=.F.

<P><LI>Place the following code in the When event for Grid1.Column2.Text1:
<P>
   WAIT WINDOW 'In WHEN for Col2' NOWAIT

<P><LI>Add the following code to the Valid method Grid1.Column2.Text1:
<P>
   THISFORM.Command1.SetFocus

<P><LI>Run the form, and press TAB from within the grid. The focus moves to
   Command1, but the When event of the grid still fires.

<P><LI>To remedy the problem, add the following code to the KeyPress method for
   Grid1.Column2.Text1:
<P>
   IF nKeyCode=9 OR nKeyCode=13
<P><PRE>     NODEFAULT
     KEYBOARD '{CTRL+TAB}'
</PRE>   ENDIF
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 14, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
