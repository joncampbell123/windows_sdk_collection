

<HTML>
<HEAD>
<TITLE>How To Use and Call the GetUserName API </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139625">
<META NAME="KBModify" CONTENT="1996/10/17">
<META NAME="KBCreate" CONTENT="1995/11/14">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Windows NT and Windows 95 may require that users log on to a computer or network. On occasion, you may want to use the login user id for your application. By using the GetUserName API call, you can discover the name of the user who is currently log...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAGU,QAGI,QA4H,QAUD,QDIT,QDL9,QBWQ,QBWN,QBWP,QAIF,QAEB,QA6A,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Use and Call the GetUserName API</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139625</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows NT and Windows 95 may require that users log on to a computer or
network. On occasion, you may want to use the login user id for your
application. By using the GetUserName API call, you can discover the name
of the user who is currently logged on to the system. This article shows by
example how to use and call the Win32 GetUserName API.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Having the user id of the currently logged in user can be helpful in
multiuser programming for situations such as updating a table field with
the user id of a user who has a record locked.
<P>
The GetUserName API call is specific to Windows 95 and Windows NT and
cannot be used in Windows or Windows for WorkGroups.
<P>
The return value held in the variable lpUserIDBuffer is null terminated, so
to get just the user ID, the following sample code trims the actual return
value by using the LEFT, LEN, and ALLTRIM functions.
<P>
<P><h3>Sample Code</h3>
 
<P>
**--------------------------------------------------------**
<PRE>** Program: Getuser.prg                                   **
** Purpose: Demonstrates how to use and call the Win32    **
** GetUserName API.                                       **
</PRE>**--------------------------------------------------------**
PUBLIC  lpUserIDBuffer, ;
<PRE>        nBufferSize, ;
        RetVal

RetVal         = 0
</PRE>lpUserIDBuffer = SPACE(25) &amp;&amp; Return buffer for user ID string
<PRE>nBufferSize    = 25        &amp;&amp; Size of user ID return buffer

</PRE>DECLARE INTEGER GetUserName IN Win32API AS GetName ;
<PRE>        STRING  @lpUserIDBuffer, ;
        INTEGER @nBufferSize

</PRE>RetVal=GetName(@lpUserIDBuffer, @nBufferSize)
<P>
DEFINE WINDOW ShowInfo FROM 0,0 TO 5,70 ;
<PRE>        FLOAT CLOSE ;
        TITLES "User ID Information" ;
        FONT "Courier",10

</PRE>ACTIVATE WINDOW ShowInfo
MOVE WINDOW ShowInfo CENTER
<P>
@ 0,1 SAY "User ID  : " + ;
<PRE>  LEFT(lpUserIDBuffer,nbuffersize-1)

</PRE><h3>General Information</h3>
 
<P>
For an alternative to this method that will work on any of the platforms,
including Windows 3.1 and Windows for Workgroups, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q99921.htm">Q99921</A></B>
   TITLE     : Obtaining Network User IDs from Within FoxPro

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information on this API function, please refer to the online
Win32API help file under the "GetUserName" topic. Note that this help file
is available only on the compact disc version of Visual FoxPro. It is not
shipped with the floppy disk version.
<P>
For more information about the DECLARE DLL command, please refer to the
Visual FoxPro online Help file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 WIN32API<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 17, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
