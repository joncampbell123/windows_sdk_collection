

<HTML>
<HEAD>
<TITLE>How to Use Grid MouseDown Code to Prevent Row/Partition Resize </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146222">
<META NAME="KBModify" CONTENT="1997/11/14">
<META NAME="KBCreate" CONTENT="1996/02/14">
<META NAME="Keywords" CONTENT="FxprgGrid kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  There are no Grid properties that can be used to disable the ability to use the mouse to resize the Grid HeaderHeight and RowHeight or move the Partition Slider. However, code can be placed in the user procedure associated with the Grid MouseDown e...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QAW6,QARR,QBVV,QACI,QAEF,QAUY,QAEB,QANJ,QA4P,QAO2,QAJP,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use Grid MouseDown Code to Prevent Row/Partition Resize</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146222</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbprg kbhowto kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There are no Grid properties that can be used to disable the ability to
use the mouse to resize the Grid HeaderHeight and RowHeight or move the
Partition Slider. However, code can be placed in the user procedure
associated with the Grid MouseDown event to prevent any of the following
actions being made with the mouse:

<UL><LI>Resizing the Grid HeaderHeight
<LI>Resizing the Grid RowHeight
<LI>Moving the Partition Slider
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
To cause the mouse action to be ignored at certain times, a NODEFAULT is
conditionally executed in the Grid MouseDown code depending on the mouse
coordinates. This effectively prevents access to the three previously
listed properties. The following code example is designed for a grid that
can be used in a form, on a page of a pageframe or within a container,
regardless of nesting level.
<P>
Place the following code in the procedure associated with the MouseDown
event for the grid.
<P>
****** Start of Grid MouseDown
<P>
*************************************************************
* If the grid is on a form (not in a container or pageframe),
* this section may be omitted. It iterates through
* object nesting level for all objects above the grid in the
* hierarchy and makes necessary adjustments to nXCoord and
* nYCoord. This allows the NODEFAULT to be called at the appropriate
* time regardless of whether the grid is in a container, page in
* a pageframe, or a combination that contains several layers.
<P>
LOCAL cObjlist, nTopTotal, nLeftTotal
<P>
cObjlist = ''
nLeftTotal = 0
nTopTotal = 0
<P>
<PRE>cObjlist = SYS(1272,this)        &amp;&amp; Get object hierarchy for grid
IF TYPE('ThisFormSet') = 'O'     &amp;&amp; In a Formset?
  * If so, remove Formset from object list
  cObjlist=SUBSTR(cObjlist,AT('.',cObjlist)+1)
</PRE>ENDIF
<P>
* Strip off grid name and replace form name with 'thisform'
cObjlist='thisform' + SUBSTR(cObjlist,AT('.',cObjlist), ;
<PRE>  RAT('.',cObjlist) - AT('.',cObjlist))

IF !'thisform'==(cObjlist)   &amp;&amp; Something more than thisform in hierarchy?
  FOR i=1 TO OCCURS('.',cObjlist) &amp;&amp; Number of '.'s = depth of hierarchy
    IF TYPE("EVAL(cObjList+'.left')")='N'   &amp;&amp; Does Obj have Left property?
      nLeftTotal = nLeftTotal+EVAL(cObjlist+'.left') + ;
        IIF('3.10' $ OS(1) OR 'NT' $ OS(1),1,0)  &amp;&amp; Add it in
    ENDIF
    IF TYPE("EVAL(cObjList+'.top')")='N'    &amp;&amp; Does Obj have Top property?
      nTopTotal=nTopTotal+EVAL(cObjlist+'.top')  &amp;&amp; Add it in
    ENDIF
    IF EVAL(cObjlist+'.baseclass')='PageFrame' &amp;&amp; Is object a PageFrame?
      IF EVAL(cObjlist+'.tabs')=.T. &amp;&amp; Does PageFrame have Tabs?
        nTopTotal=nTopTotal+24 + ;
          IIF('3.10' $ OS(1) OR 'NT' $ OS(1),2,0)   &amp;&amp; Add in Tab height
      ELSE
        nTopTotal=nTopTotal + ;
          EVAL(cObjlist+'.borderwidth') + ;
          IIF(EVAL(cObjlist+'.SpecialEffect')&lt;2,1,0)
        nLeftTotal=nLeftTotal+EVAL(cObjlist+'.borderwidth')
      ENDIF
      nLeftTotal=nLeftTotal+1+ IIF('3.10' $OS(1) OR 'NT' $ OS(1),1,0)
    ENDIF
    * Pare last object from list
    cObjlist=SUBSTR(cObjlist,1,RAT('.',cObjlist)-1)
  ENDFOR
</PRE>ENDIF
<P>
<PRE>nXCoord=nXCoord-nLeftTotal   &amp;&amp; Compensate nX- and nYCoord for top and left
nYCoord=nYCoord-nTopTotal    &amp;&amp; of all containers that hold the Grid

*
</PRE>* End of section to omit if grid is directly on form
****************************************************
<P>
WITH this
<P>
<PRE>  * Each of these checks the position of the mouse when the MouseDown
  * is called. If the position is where the click should be ignored,
  * NODEFAULT is issued.

  * This makes rows not resizable

  IF nXCoord &lt; .partition + .Left + 20 AND ;
      nYCoord &gt; .Top + .HeaderHeight + .RowHeight - 5 AND ;
      nYCoord &lt; .Top + .HeaderHeight + .RowHeight + 7
    NODEFAULT
  ENDIF

  * This makes header not resizable

  IF nXCoord &lt; .partition + .Left + 20 AND ;
      nYCoord &gt; .Top + .HeaderHeight - 5 AND ;
      nYCoord &lt; .Top + .HeaderHeight + 7
    NODEFAULT
  ENDIF

  * This makes partition not moveable

  IF MOD(.ScrollBars,2) = 1       &amp;&amp; Check for horizontal scrollbar
    IF nXCoord &lt; .partition + .Left + 6 AND ;
    nXCoord &gt;= .partition + .Left AND ;
      nYCoord &gt; .Top + .Height - 19
      NODEFAULT
    ENDIF
  ENDIF

</PRE>ENDWITH
<P>
<P><h3>Notes</h3>
 
<P>
There are 12 x 20 pixel areas where the pointer changes to a two-headed
up/down arrow and the HeaderHeight or RowHeight may be resized. For the
HeaderHeight, this is at the lower edge of the Header on the left side of
the grid. For the RowHeight, this is at the lower edge of the first row of
data on the left side of the grid. Likewise, there is a 19 x 6 pixel area
where the pointer changes to a two-headed left/right arrow and the
Partition Slider may be moved. This is the small black rectangle to the
left of the grid's horizontal scroll bar. Although the pointer will still
change when moved over these areas when you use the code example, you will
not be able to make adjustments.
<P>
There are slight differences between the calculation of the location of
objects placed within pageframe and container objects in Windows 95,
Windows NT, and Windows 3.1x. The following code conditionally makes these
adjustments depending on the operating system:
<P>
<PRE>   IIF('3.10' $ OS(1) OR 'NT' $ OS(1),1,0)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGrid<BR>
Keywords          : FxprgGrid kbcode kbhowto kbprg<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
