

<HTML>
<HEAD>
<TITLE>How To Modify a Shortcut Menu at Run Time </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155403">
<META NAME="KBModify" CONTENT="1997/03/13">
<META NAME="KBCreate" CONTENT="1996/08/28">
<META NAME="Keywords" CONTENT="FxtoolMBuilder vfoxwin kbhowto kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Visual FoxPro menu generator, Genmenu.prg, now contains a new generator directive to accommodate support for the new shortcut menus. The generator directive is called #PREPOP. Normally, GENMENU adds the contents of the Cleanup snippet at the en...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKR,QAF0,QAH4,QANE,QAB9,QAPN,QBWR,QBV8,QAAW,QBWS,QABI,QABH,QAVI,QANS,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Modify a Shortcut Menu at Run Time</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155403</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Visual FoxPro menu generator, Genmenu.prg, now contains a new
generator directive to accommodate support for the new shortcut menus. The
generator directive is called #PREPOP. Normally, GENMENU adds the contents
of the Cleanup snippet at the end of the menu definition. With shortcut
menus, the ACTIVATE POPUP command is inserted prior to the contents of the
Cleanup snippet. Therefore, none of the Cleanup code executes until after
the menu is deactivated. The #PREPOP generator directive places the
Cleanup code (not including Procedures or functions) prior to the ACTIVATE
POPUP command. This new functionality allows you to disable, enable, mark,
or unmark menu items at run time.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This example demonstrates the use of the #PREPOP generator directive. In
the example, a command button toggles the form's AlwaysOnTop property
between true (.T.) and false (.F.). Based on the value of this property, a
check mark appears next to a menu bar within the shortcut menu. The
following steps create the example:

<OL><P><LI>Create a shortcut menu named NewShort.

<P><LI>Use the layout below to add three menu prompts to the shortcut menu:
<P>
<PRE>       Prompt            Result
       --------------------------

       \&lt;Date           Command
       \&lt;Test           Command
       \&lt;AlwaysOnTop    Procedure

</PRE><P><LI>In the procedure of AlwaysOnTop prompt, type the following code:
<P>
       IF TYPE("oRef") = "O"
<PRE>          oRef.command1.Click
       ENDIF

</PRE><P><LI>Click the View menu and click General Option to access the Setup and
    CleanUp snippets. In the Setup snippet, type the following  code:
<P>
       PARAMETER oRef
       #PREPOP
<P>
    Close the Setup snippet box.

<P><LI>Open the CleanUp snippet and type the following code:
<P>
       SET MARK OF BAR 3 OF SHORTCUT TO oRef.AlwaysOnTop
<P>
    Close the CleanUp snippet box.

<P><LI>Generate the menu.

<P><LI>Create a form named ShortCut.

<P><LI>In the RightClick method of the form, add the following code:
<P>
       DO NewShort.mpr WITH THIS

<P><LI>Place a command button on the form and change the following
    properties:
<P>
       Caption = NotAlwaysOnTop
       Name = Command1

<P><LI>In the Click method of the command button, type the following code:
<P>
      IF THIS.Caption = "NotAlwaysOnTop"
<PRE>         THISFORM.AlwaysOnTop = .T.
         THIS.Caption = "AlwaysOnTop"
      ELSE
         THIS.Caption = "NotAlwaysOnTop"
         THISFORM.AlwaysOnTop = .F.
      ENDIF

</PRE></OL>Run the form and click the command button to set the AlwaysOnTop property
to true. Then right-click the form to bring up the shortcut menu,
NewShort. A check mark now appears next to the AlwaysOnTop menu bar. Press
the command button again to set the form's AlwaysOnTop property to false.
Right-click again to invoke the shortcut menu. The check mark disappears
from the menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: #preprop short cut clean up right click<BR>
Keywords            : FxtoolMBuilder vfoxwin kbhowto kbtool<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
