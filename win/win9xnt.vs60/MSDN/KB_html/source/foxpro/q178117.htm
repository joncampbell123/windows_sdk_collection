

<HTML>
<HEAD>
<TITLE>PRB: Application Loses Focus or Opens Minimized on Startup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178117">
<META NAME="KBModify" CONTENT="1997/12/22">
<META NAME="KBCreate" CONTENT="1997/12/15">
<META NAME="Keywords" CONTENT="FxprgClassoop VFoxMac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you launch a Visual FoxPro application, it appears to open minimized or loses focus.  CAUSE =====  This behavior occurs when you include the following code in the Init event of a Top-Level form:     APPLICATION.VISIBLE=.F.  RESOLUTION  Move th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADO,QAPN,QAJH,QAH4,QAO4,QAMB,QA56,QA55,QAUD,QAEB,QBWS,QAEF,QBXT,QA5V,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Application Loses Focus or Opens Minimized on Startup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178117</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you launch a Visual FoxPro application, it appears to open minimized
or loses focus.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs when you include the following code in the Init event
of a Top-Level form:
<P>
<PRE>   APPLICATION.VISIBLE=.F.

</PRE><h2>RESOLUTION</h2>
 
<P>
Move the following line:
<P>
<PRE>   APPLICATION.VISIBLE=.F.

</PRE>to the Activate event of the Top-Level form.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The line Application.Visible=.F. hides the main Visual FoxPro window. The
reason the application loses focus and appears to open minimized is related
to the sequence of events. Because the form's Init event sets the
application's Visible property to false, the application is hidden and
focus returns to the last active object or application. Even though the
application no longer has focus, the code continues executing as a
background process.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>To illustrate this behavior, create a program called Runhide.prg with
   the following code:
<P>
<P><PRE>     LOST=CREATEOBJECT('NOFOCUS')
     LOST.SHOW
     READ EVENTS
     RETURN
</PRE><P>
<P><PRE>     DEFINE CLASS nofocus AS FORM
     AUTOCENTER = .T.
     HEIGHT  = 450
<PRE></PRE>     WIDTH   = 640
     CAPTION = "Lost Focus Form"
     VISIBLE = .T.
     SHOWWINDOW=2
     WINDOWTYPE=0
     ADD OBJECT frmcaption AS frmcap WITH Top=225, Left=220
     PROCEDURE INIT
     APPLICATION.VISIBLE=.F.
     ENDPROC
     PROCEDURE CLICK()
     THISFORM.RELEASE
     CLEAR EVENTS
     APPLICATION.VISIBLE=.T.
     ENDPROC
     ENDDEFINE

     DEFINE CLASS frmcap AS LABEL
     FONTNAME="ARIAL"
     FONTSIZE=10
     FONTBOLD=.T.
     CAPTION="Click anywhere on the form to close"
     VISIBLE=.T.
     AUTOSIZE=.T.
     ENDDEFINE

</PRE><P><LI>From the command line, type the following:
<P>
<P><PRE>      DO RUNHIDE
</PRE>
<P><LI>To illustrate hiding the main Visual FoxPro window while the application
   retains focus, create a program called Nohide.prg with the following
   code:
<P>
<P><PRE>     NOTLOST=CREATEOBJECT('HASFOCUS')
     NOTLOST.SHOW
     READ EVENTS
     RETURN
</PRE><P>
<P><PRE>     DEFINE CLASS hasfocus AS FORM
     AUTOCENTER = .T.
     HEIGHT  = 450
<PRE></PRE>     WIDTH   = 640
     CAPTION = "Lost Focus Form"
     VISIBLE = .T.
     SHOWWINDOW=2
     WINDOWTYPE=0
     ADD OBJECT frmcaption AS frmcap WITH Top=225, Left=220
     PROCEDURE ACTIVATE
     APPLICATION.VISIBLE=.F.
     ENDPROC
     PROCEDURE CLICK()
     THISFORM.RELEASE
     CLEAR EVENTS
     APPLICATION.VISIBLE=.T.
     ENDPROC
     ENDDEFINE

     DEFINE CLASS frmcap AS LABEL
     FONTNAME="ARIAL"
     FONTSIZE=10
     FONTBOLD=.T.
     CAPTION="Click anywhere on the form to close"
     VISIBLE=.T.
     AUTOSIZE=.T.
     ENDDEFINE

</PRE><P><LI>From the command line, type the following:
<P>
<P><PRE>      DO NOHIDE
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual FoxPro Help, version 5.00; search on: "Application"
Visual FoxPro Help, version 5.00; search on: "Visible"
<P>
 
<PRE>Keywords          : FxprgClassoop VFoxMac vfoxwin
Version           : WINDOWS:5.0,5.0a
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
