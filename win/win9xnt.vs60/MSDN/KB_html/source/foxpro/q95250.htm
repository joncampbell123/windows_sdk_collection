

<HTML>
<HEAD>
<TITLE>How to Recycle Deleted Records in a Multiuser Environment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95250 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/02/04">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The DELETE command does not physically remove a record from the database file. Instead, it places a flag on the record indicating that the record has been deleted. The record can be retrieved by issuing the RECALL command.  The PACK command physica...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAEF,QBCT,QAGC,QAGB,QDKD,QAH4,QDMH,QACI,QBGA,QA7O,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Recycle Deleted Records in a Multiuser Environment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95250 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS. versions 1.02, 2.0, 2.5, and 2.5a
<LI>Microsoft FoxBASE+ for MS-DOS, version 2.1
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
<LI>Microsoft FoxBASE+ for Macintosh, version 2.1
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The DELETE command does not physically remove a record from the
database file. Instead, it places a flag on the record indicating that
the record has been deleted. The record can be retrieved by issuing
the RECALL command.
<P>
The PACK command physically removes deleted records from the file.
After the PACK command has been issued, deleted records cannot be
recalled. Using PACK requires exclusive use of the file.
<P>
In a multiuser environment, it may be difficult to obtain exclusive
use of the file for packing. If the file isn't packed, the amount of
disk space required to store deleted records will continue to grow. To
work around this problem, you can recycle deleted records by using the
technique illustrated below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code snippets blank out all fields in the record when a
record is deleted from the file. When an attempt is made to append a
new record to the database, the program first checks to see if any
blank deleted records are available. If a deleted record is available,
the program uses the record to store the new data. If a deleted record
is not available, the program appends a blank record.
<P>
This code snippet deletes a record in FoxBASE+:
<P>
<PRE>   DELETE
   *   Insert code here to replace each field with a blank character,
   *   date or numeric value.

</PRE>This code snippet deletes a record in FoxPro:
<P>
<PRE>   IF LOCK()
      SCATTER MEMVAR MEMO BLANK   *  See note below on memo fields.
      GATHER MEMVAR MEMO          *  MEMO keyword available only
      DELETE                      *  in FoxPro 2.0.
   ENDIF

</PRE>The following line must be added to a FoxBASE+ or FoxPro 1.02 program
for databases that contain memo fields:
<P>
<PRE>   REPLACE memofield WITH ""  &amp;&amp; memofield is the memo field name

</PRE>This code snippet either recycles a deleted record or appends a new
blank record in FoxBASE+ and FoxPro:
<P>
<PRE>   LOCATE FOR DELETED()
   IF EOF()
      APPEND BLANK
   ELSE
      RECALL
   ENDIF

</PRE>Unused space in memo files will not be recycled. To recover unused
space in memo files, you must issue a PACK (FoxBASE+) or PACK MEMO
(FoxPro) command.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft FoxPro "Commands &amp; Functions," pages 134, 315, and 580
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxMac FoxDos FoxWin 2.00 2.10<BR>
2.x 2.50 2.50a<BR>
multiuser<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgMultiuser<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
