

<HTML>
<HEAD>
<TITLE>How To Change a Grid's RecordSource Property Programmatically </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140306">
<META NAME="KBModify" CONTENT="1996/10/17">
<META NAME="KBCreate" CONTENT="1995/11/29">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to change the RecordSource property of a grid programmatically. It also allows you to click the column heading to change the order of the table.  MORE INFORMATION  The method that does most of the work is SetGrid. ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QARR,QBWS,QAE1,QA2Q,QAMB,QDMN,QBXS,QA7O,QA7N,QAG2,QA01,QAW6,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Change a Grid's RecordSource Property Programmatically</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140306</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to change the RecordSource property of a
grid programmatically. It also allows you to click the column heading to
change the order of the table.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The method that does most of the work is SetGrid. It allows the user to
select a table from an Open File dialog box. It sets the RecordSource
property of the grid and the column headings to the field names in the
table. It removes the any extra columns if the tables differ in the number
of the fields they contain.
<P>
The order is set in the Click event of the header. Setting the order by
clicking the column header can only be done programmatically because it
requires a subclass of the header. Columns and headers can only be
subclassed in code.
<P>
When the following code is run, the user will be presented with a dialog
box to select a table. After table selection, the form appears. To change
the table on which the grid is based, the user can click the button and
they will again be presented with a dialog box to select a table.
<P>
<P><h3>Code Sample</h3>
 
<P>
* Begin Code
PUBLIC oGridForm
oGridForm = CREATEOBJECT("myForm")
oGridForm.Show
<P>
DEFINE CLASS myForm AS FORM
<P>
<PRE>    Height = 350
    ADD OBJECT myGrid AS myGrid WITH Top = 20, LEFT = 20,;
      Height = 200
    ADD OBJECT myCommand as COMMANDBUTTON WITH Top = 250,;
      Left = 20, Height = 30, Caption = "Change Grid"

    PROCEDURE myCommand.Click
        This.Parent.myGrid.SetGrid()
        GO TOP
        ThisForm.ReFresh
    ENDPROC

</PRE>ENDDEFINE
<P>
DEFINE CLASS myGrid AS GRID
<P>
<PRE>    ColumnCount = 0

    PROCEDURE Init
        This.Parent.myGrid.SetGrid()
        ThisForm.Refresh
    ENDPROC

    PROCEDURE SetGrid
        ThisForm.Lockscreen = .T.
        lcFileName = GETFILE("DBF","Select the Table:")
        USE (lcFileName)
        lcAlias = ALIAS()
        This.RecordSource = ""
        This.RecordSource = lcAlias
        SELECT (lcAlias )
        FOR i = 1 TO FCOUNT()
            IF This.ColumnCount &lt; i
               This.AddObject("column" + ALLTRIM(STR(i)),"MyColumn")
            ENDIF
            This.Columns(i).Visible = .t.
            This.Columns(i).ControlSource = FIELD(i)
            This.Columns(i).Header1.Caption = FIELD(i)
        ENDFOR
        FOR i = FCOUNT() + 1 TO This.ColumnCount
            This.RemoveObject("Column"+ALLTRIM(STR(i)))
        ENDFOR
        ThisForm.Caption = lcAlias
        ThisForm.Lockscreen = .F.
     ENDPROC

</PRE>ENDDEFINE
<P>
DEFINE CLASS myColumn as Column
<P>
<PRE>    ADD OBJECT Header1 as myHeader WITH Visible = .T.

</PRE>ENDDEFINE
<P>
DEFINE CLASS myHeader AS HEADER
<P>
<PRE>    PROCEDURE Click
       FOR nCount = 1 TO 254
           IF !EMPTY(TAG(nCount))
              IF This.Caption = TAG(nCount)
                 SET ORDER TO This.Caption
                 EXIT
              ENDIF
           ELSE
              EXIT
           ENDIF
       ENDFOR
       This.Parent.Parent.ReFresh
       This.Parent.Parent.SetFocus
    ENDPROC

</PRE>ENDDEFINE
* End Code
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 17, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
