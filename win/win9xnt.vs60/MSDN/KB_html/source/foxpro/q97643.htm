

<HTML>
<HEAD>
<TITLE>PRB: @...GET-Popup From Array Contains Blank Elements </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97643 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/04/19">
<META NAME="Keywords" CONTENT="kbenv kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Elements of an array viewed by an @...GET - Popup FROM         do not appear in the popup list. Also, as the @...GET - Popup is activated within FoxPro version 2.5 for WINDOWS, the scroll bars begin to disappear and continue to do so with each succ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY2,QAAF,QAXC,QAB9,QDL9,QBWQ,QBWO,QBWN,QA9N,QAVX,QAVW,QABA,QBXQ,QBSO,QBQU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: @...GET-Popup From Array Contains Blank Elements</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97643 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Elements of an array viewed by an @...GET - Popup FROM &lt;array&gt; do not
appear in the popup list. Also, as the @...GET - Popup is activated
within FoxPro version 2.5 for WINDOWS, the scroll bars begin to disappear
and continue to do so with each successive activation of the popup until
the entire scroll bar has disappeared.
<P>
<P><h2>CAUSE</h2>
 
<P>
DIMENSIONing an array places the array in a physical location in
memory. When you create an @...GET - Popup from the array, the popup
references the array's physical memory location. If the array is
RELEASEd from memory and new data is copied into the previously
RELEASEd array, the array is placed into a new physical memory
location. However, the @...GET - Popup points to the original physical
memory location. As a result, the popup appears to contain blank values for
each element in the original array.
<P>
In FoxPro for Windows, an additional problem occurs. The
popup scroll bar begins to disappear with each successive attempt to use
the popup.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In the Command Window, type "MODIFY COMMAND test.prg" (without the
   quotation marks).

<P><LI>In test.prg, type
<P>
<P><PRE>      DIMENSION poparray(500)
      USE customer
      @ 2,2 GET mycno ;
<PRE></PRE>          PICTURE "@^ 1;2" ;
          VALID myproc() DEFAULT "1"
      @ 7,2 GET yourcno ;
          PICTURE "@^" ;
          FROM poparray DEFAULT "Yes"
      READ CYCLE

      FUNCTION myproc
      RELEASE poparray
      COUNT FOR cno = "A" TO mcount
      &amp;&amp; COUNT FOR Cust_ID="A" TO mcount   in Visual FoxPro
      GO TOP
      DIMENSION poparray(mcount)
      COPY TO ARRAY poparray FIELDS cno FOR cno="A"
      &amp;&amp;COPY TO ARRAY poparray FIELDS Cust_id FOR Cust_id="A"
      SHOW GETS
      RETURN .T.

</PRE></OL><h2>RESOLUTION</h2>
 

<OL><P><LI>In the first DIMENSION statement of the program file, DIMENSION the
   array to the maximum number of rows it will ever contain.

<P><LI>In both DIMENSION statements, specify a row and column number, as in
   the following example:
<P>
<P><PRE>      DIMENSION poparray(10,1).
</PRE>
<P><LI>Remove the RELEASE command from the VALID PROCEDURE.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxWin FoxDos 2.00 2.50 2.50a<BR>
2.50b 2.60 2.60a<BR>
KBCategory: kbenv kbprg kbprb<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
