

<HTML>
<HEAD>
<TITLE>PRB: DO &lt;Program Name&gt; Runs Cached Version of Program </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156342">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/23">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you run a program file, change the default directory, and then attempt to run a different program of the same name from that directory, the first program runs again.  CAUSE =====  For performance purposes, program or procedure code is cached in ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAEF,QAJX,QADR,QBXB,QATJ,QAFI,QBWS,QAJQ,QAJH,QBFY,QAUJ,QAPF,QAB9,QDKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: DO &lt;Program Name&gt; Runs Cached Version of Program</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156342</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you run a program file, change the default directory, and then attempt
to run a different program of the same name from that directory, the first
program runs again.
<P>
<P><h2>CAUSE</h2>
 
<P>
For performance purposes, program or procedure code is cached in memory.
The version in memory is used when the same procedure or program name is
executed again.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use the CLEAR PROGRAM command before running the second program of the same
name.
<P>
-or-
<P>
Reference the program explicitly by path, for example:
<P>
<PRE>   DO .\&lt;progname&gt;

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Run the following code from a program (.prg) file:
<P>
<PRE>   * Start of code example
   *
   LOCAL lcCurDir, lnI
   lcCurDir=SET('default')+CURDIR()   &amp;&amp; Save the current directory
   CLEAR
   MD c:\testxx            &amp;&amp; Make the new directory
   FOR lnI = 1 TO 2
      MD 'c:\testxx\t'+ALLTRIM(STR(lnI))   &amp;&amp; Make one of the subdirs
      CD 'c:\testxx\t'+ALLTRIM(STR(lnI))   &amp;&amp; Change to it
      * Put the program code into the clipboard
      _CLIPTEXT = '? " This is in My_Prog from T'+ALLTRIM(STR(lnI))+'"'
      KEYBOARD '{ctrl + v}'      &amp;&amp; This will paste it into the program
      KEYBOARD '{ctrl + w}'      &amp;&amp; This will close the editor
      MODIFY COMMAND My_Prog &amp;&amp; Open the editor - then the above 2
                             &amp;&amp;     keystrokes will be processed
      DO My_Prog             &amp;&amp; Run the program
   ENDFOR

   FOR lnI = 1 TO 2
      CD 'c:\testxx\t'+ALLTRIM(STR(lnI))   &amp;&amp; Change to one of the subirs
      DELETE FILE My_Prog.FXP              &amp;&amp; Delete the .PRG/.FXP file
      DELETE FILE My_Prog.PRG
      CD ..
      RD 'c:\testxx\t'+ALLTRIM(STR(lnI))   &amp;&amp; Remove the subdir
   ENDFOR

   CD (lcCurDir)            &amp;&amp; Switch to the original default
   RD c:\testxx             &amp;&amp; Remove the directory
   *
   * End of code example

</PRE>Both messages printed to the FoxPro desktop refer to the T1 directory.
<P>
Demonstration of Workaround 1:

<OL><P><LI>Add a CLEAR PROGRAM command immediately before the DO My_Prog command in
   the above example:
<P>
<P><PRE>      CLEAR PROGRAM
      DO My_Prog
</PRE>
<P><LI>Rerun the program, and note that the first message printed to the FoxPro
   desktop refers to the T1 directory, and the second refers to T2.
<P>
</OL>Demonstration of Workaround 2:

<OL><P><LI>Remove the CLEAR PROGRAM command if added above, and change the DO
   My_Prog command in the above example to read as follows:
<P>
<P><PRE>      DO .\My_Prog
</PRE>
<P><LI>Rerun the program, and note that the first message printed to the FoxPro
   desktop refers to the T1 directory, and the second again refers to T2.
<P>
</OL>You can hard code the path name, but the .\&lt;filename&gt; works for any current
directory.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>
Additional reference words: 3.00 3.00b 5.00 kbdse VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
