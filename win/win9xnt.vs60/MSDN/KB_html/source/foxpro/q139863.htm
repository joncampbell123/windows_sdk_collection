

<HTML>
<HEAD>
<TITLE>How to Determine the Variable Type </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139863">
<META NAME="KBModify" CONTENT="1995/11/20">
<META NAME="KBCreate" CONTENT="1995/11/19">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using the Visual FoxPro TYPE() function, you must ensure that the expression passed to the function is always be of the character type. You can use a user-defined function (UDF) to determine the type of a variable without trying to convert the...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAUD,QAP2,QAY5,QAB9,QADK,QBV8,QBSO,QAPF,QAH4,QALW,QAJQ,QADF,QDMW,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Determine the Variable Type</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139863</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using the Visual FoxPro TYPE() function, you must ensure that the
expression passed to the function is always be of the character type. You
can use a user-defined function (UDF) to determine the type of a variable
without trying to convert the variable to a character string. This article
shows you how to do it.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Open a program file, and type the following function into it:
<P>
   FUNCTION ALLTYPE
<P><PRE>    *
    *  Purpose:  Determine the data type of a variable
<PRE></PRE>    *  Syntax:   m.cNewValue = ALLTYPE(&lt;Variable Name&gt;)
    *  Parms:    xxx (Can be Character, Numeric, Date, or Logical)
    *            The variable for which the type is to be determined.
    *  Return:   lcType:  C for Character
    *                     N for Numeric
    *                     D for Date
    *                     L for Logical
    *  Example:  lcTheType=ALLTYPE(Variable)
    *
    PARAMETER xxx
    local llType,lcType
    lcTemperror=ON('ERROR')
    ON ERROR llType=.f.
    llType=.T.
    xxx=xxx+" "
    IF llType
      lcType="C"
    ENDIF
    llType=.T.
    xxx=!xxx
    IF llType
      lcType="L"
    ENDIF
    llType=.T.
    xxx=xxx+1
    IF llType
      lcType="N"
    ENDIF
    llType=.T.
    xxx=MONTH(xxx)
    IF llType
      lcType="D"
    ENDIF
    ON ERROR &amp;lcTemperror
   RETURN lcType

</PRE><P><LI>Save and close the program file.

<P><LI>In the Command window, type the following:
<P>
   SET PROCEDURE TO &lt;Program File&gt;
   x=3
   ? ALLTYPE(x)

<P><LI>The value returned is N.
<P>
</OL>The TYPE() function may be used to obtain the same result if the variable
is placed enclosed in quotation marks. For example, the following will also
return N:
<P>
<PRE>   ? TYPE('x')
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 20, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
