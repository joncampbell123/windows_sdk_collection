

<HTML>
<HEAD>
<TITLE>HOWTO: Adding Copy and Paste Functionality to Grid Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168835">
<META NAME="KBModify" CONTENT="1997/05/21">
<META NAME="KBCreate" CONTENT="1997/05/21">
<META NAME="Keywords" CONTENT="FxprgGeneral vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a Grid control object based on the Grid32.OCX is placed on a form, the cut, copy, and paste menu items are not available. Additionally, the hot keys, such as CTRL+V, do not function. This article shows how to use properties of the Grid control...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9N,QAB5,QA7O,QAOE,QAMN,QAPN,QARR,QBV4,QAEF,QBT6,QASB,QAHP,QBWS,QAW6,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Adding Copy and Paste Functionality to Grid Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168835</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a Grid control object based on the Grid32.OCX is placed on a form, the
cut, copy, and paste menu items are not available. Additionally, the hot
keys, such as CTRL+V, do not function. This article shows how to use
properties of the Grid control to emulate these editing functions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Since neither the system menu options nor the shortcut keys for cut, copy,
and paste work within the Grid control, the Grid32.OCX object properties
must be used to accomplish these functions. To emulate these editing
functions, the Clip, Col, Row, and Text properties of the Grid control must
be used.
<P>
The example provided below uses a TextBox control and a Grid control to
demonstrate how to copy, cut, and paste a text string between the two
objects programmatically.
<P>
The following steps create a form containing a Grid control that has copy,
cut, and paste functionality:

<OL><P><LI>Create a form and place a TextBox and an OLE Container Control on it.

<P><LI>In the OLE Container Control, click Insert Control and choose the
   Grid Control object.

<P><LI>Right-click the Grid control and choose Grid properties. Click the
   General tab and change both the Row and Col properties to 3 and click
   Apply.

<P><LI>In the Init of the form, place the following code:
<P>
<P><PRE>       ** This code places text values in the Grid object **
       Thisform.OleControl1.Row=1
       ThisForm.OleControl1.Col=1
       Thisform.Olecontrol1.Text="Test1"
       ThisForm.OleControl1.Row=1
       ThisForm.Olecontrol1.Col=2
       ThisForm.OleControl1.Text="Test2"
       Thisform.OleControl1.Row=1 &amp;&amp; Resets focus to first cell.
       ThisForm.OleControl1.Col=1
</PRE>
<P><LI>Add three command buttons to the form and set the following properties
   and events as directed below:
<P>
<P><PRE>       Command1
<PRE></PRE>        Caption="Copy to Grid"
        Click Event:
        Thisform.OleControl1.Text=ThisForm.Text1.Value

       Command2
        Caption="Copy From Grid"
        ThisForm.Text1.Value=Thisform.OleControl1.Clip

       Command3
        Caption="Cut From Grid"
        Click Event:
        ThisForm.Text1.Value=ThisForm.OleControl1.Text
        ThisForm.OleControl1.Text=""

</PRE><P><LI>Save the form and run it.

<P><LI>Type "Hello" (without the quotes) in the text box and press "Copy to
   Grid." The word "Hello" appears in the Grid control.

<P><LI>Click on the cell containing "Test2" with the mouse and then select
   "Copy from Grid." "Test2" appears in the text box.

<P><LI>Click on the cell containing "Hello" and select "Cut From Grid."
   "Hello" appears in the text box and the contents of the first cell of
   the Grid control disappear.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information on the properties of the Grid control, invoke
the Visual Basic Help file by clicking the Grid control and pressing the F1
key.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxprgGeneral vfoxwin<BR>
Version             : 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
