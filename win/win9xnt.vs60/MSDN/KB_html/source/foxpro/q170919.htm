

<HTML>
<HEAD>
<TITLE>PRB: Error "Record is not Locked" with ComboBox in Grid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170919">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1997/07/01">
<META NAME="Keywords" CONTENT="vfoxmac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you place a combobox in a grid, the following error might occur when you choose an item from the combobox:     Record is not locked  If the RowSourceType is set to 6-Fields and the RowSource of the combobox is set to a field in the same table ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV3,QA5V,QAPN,QA7O,QBXS,QAHP,QA7N,QBWS,QARR,QBVV,QA2Q,QAAP,QAB4,QAG2,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error "Record is not Locked" with ComboBox in Grid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170919</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you place a combobox in a grid, the following error might occur when
you choose an item from the combobox:
<P>
<PRE>   Record is not locked

</PRE>If the RowSourceType is set to 6-Fields and the RowSource of the combobox
is set to a field in the same table that the grid is bound to, then the
error will occur.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Add the records of the field that the combobox is based on to an array and
then basing the RowSource of the combobox on the array to prevent the error
from occurring. You can also use a RowSourceType of 3-SQL Statement as
another option.
<P>
To modify the form created in the Steps to Reproduce Behavior section
below, make these changes to the form:

<OL><P><LI>From the Form menu, choose New Property. Type in "testarray[1,1]"
   (without quotes) as the name of the new property. Click Add.

<P><LI>In the Load method of the form, place the following code to populate
   the array:
<P>
<P><PRE>      SELECT company FROM customer INTO ARRAY Thisform.testarray ORDER BY 1
</PRE><P>
<P><PRE>      A modified version of the above SELECT statement can be used if the
      RowSourceType of the combobox is 3-SQL Statement. The modified
      statement below would be put in for the RowSource property:
</PRE><P>
<P><PRE>      SELECT company FROM customer INTO CURSOR test ORDER BY 1
</PRE><P>
<P>
</OL>Note that using a RowSourceType of either 3-SQL Statement or 5-Array will
change the value in the customer field of the table. This happens because
the control source property of the column is set to that field by default
when the grid is created. With the RowSourceType of 6-Fields, the customer
field is not changed. The combobox acts as a navigation control in this
case. This would be redundant since the grid itself can be used as a
navigation control.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Type the following commands in the Visual FoxPro Command window
   to set the default folder and create a new form:
<P>
<P><PRE>      SET DEFAULT TO HOME()+"Samples\Data"
      CREATE FORM test
</PRE>
<P><LI>Right-click on the form, and select Data Environment.
   Right-click in the Data Environment window, and select Add. Add the
   Customer table.

<P><LI>Click on the heading of the table in the Data environment, drag
   it to the form, and release the button. After you release
   the mouse button, a grid appears on the form.

<P><LI>Change the ColumnCount property of the grid to 3 or more.

<P><LI>Right-click the grid, and click Edit.

<P><LI>Click the combobox tool of the Forms Control toolbar and place it in
   the second column of the grid.

<P><LI>Make the CurrentControl property of the second column equal to the
   combobox and also set the Sparse property of the column to false (.F.).

<P><LI>Select the combobox and set the RowSourceType to 6-Fields and set
   the RowSource property to Customer.company, the second field in the
   table.

<P><LI>Run the form, click the combobox, and select an item other than
   the current item.
<P>
</OL>The error "Record is not locked" will occur. If you click OK, the current
record in the grid changes to the record for the item chosen in the
combobox. If the fields are saved into an array and the combobox's
RecordSourceType property is set to "Array" and the RecordSource is set to
the array name, then the error will not occur nor will the record pointer
move.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : vfoxmac vfoxwin<BR>
Version             : MACINTOSH:3.0b; WINDOWS:3.0,3.0b<BR>
Platform            : MACINTOSH WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
