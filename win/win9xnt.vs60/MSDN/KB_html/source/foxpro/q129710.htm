

<HTML>
<HEAD>
<TITLE>PRB: Visual FoxPro Setup Problems with Disk 2 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129710">
<META NAME="KBModify" CONTENT="1996/10/21">
<META NAME="KBCreate" CONTENT="1995/05/02">
<META NAME="Keywords" CONTENT="kbsetup kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT=" NOTE: Some products mentioned in this article are manufactured by vendors independent of Microsoft; we make no warranty, implied or otherwise, regarding these products' performance or reliability.   When you run the Setup program for Visual FoxPro v...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC9,QAA1,QDI2,QBVV,QDI7,QAKP,QDIZ,QA9N,QAB4,QAVX,QAVW,QBHJ,QBB1,QDNG,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual FoxPro Setup Problems with Disk 2</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129710</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
NOTE: Some products mentioned in this article are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Setup program for Visual FoxPro version 3.0 from floppy
disks, after removing Disk 1, inserting Disk 2, and pressing ENTER, you
receive the "Insert Disk 2" message continuously, or you might receive any
of the following error messages:

<UL><LI>Could not read from the file named &lt;drive&gt;:\VFP2.CAB.

<LI>Unable to expand VFP2.CAB.

<LI>The compressed file '&lt;drive&gt;\VFP2.CAB' cannot be decompressed
   and may be corrupted.

<LI>System Error: cannot read from drive A:

<LI>Setup: Could not read from file named A:\VFP2.CAB"
<P>
</UL><h2>CAUSE</h2>
 
<P>
There are several possible causes for these errors:

<UL><LI>Software virus.

<LI>Hardware failure.

<LI>Bad floppy disk.

<LI>Compatibility problem with the Distribution Media Format (DMF) used on
   disk 2 (and subsequent disks in the series).
<P>
</UL><h2>WORKAROUNDS</h2>
 
<P>
To isolate the cause of this problem, perform the following checks, and
apply the indicated solution.

<OL><P><LI>Test for viruses. Use an up-to-date virus checking program to verify
   that you do not have a virus on your system. Do this first. If you have
   a virus on your system, any further tests on the diskettes may give you
   false results. Moreover, if the Visual FoxPro installation disks have
   been infected by a virus on your system, you risk infecting other
   machines on which you attempt to install Visual FoxPro.
<P>
   SOLUTION: If you have a virus, disinfect your computer system using an
   up-to-date anti-virus program. An anti-virus program may not work on the
   DMF-formatted disk. If you cannot disinfect disk 2, request a set of
   replacement disks. Replacement disks are not DMF-formatted and are
   available in 1.44 MB media only.

<P><LI>Test the floppy drive. If you have diagnostics software that will check
   the functioning of your floppy drive, use it to verify that your floppy
   drive is working properly. If you have had no problems reading and
   writing to standard floppy disks, your floppy drive is probably not the
   cause of the problem.

<P><LI>Test for a bad disk. If you have another computer available, try to
   install the disks on that machine. If you have the same problem on the
   other computer(s), that does not necessarily mean that the disks are
   bad. Both machines may have a problem reading DMF-formatted disks.
<P>
   CAUTION: Disk 2 (and subsequent disks in the installation series) uses
   DMF. DMF is a new format. Many existing disk utilities such as Norton
   Disk Doctor, Central Point's PC Tools, and Microsoft's ScanDisk do not
   recognize DMF and may try to write over the file on the installation
   disks. Therefore, you should NOT attempt to use disk utilities to
   diagnose, or even examine DMF-formatted disks.
<P>
   NOTE: You cannot copy DMF-formatted disks using the MS-DOS COPY or
   DISKCOPY commands. Instead, use the copy switch (/C) with EXTRACT.EXE
   utility, located on disk 1.
<P>
   SOLUTION: If you have a bad disk, request a set of replacement disks.
   Replacement disks are not DMF-formatted and are available in 1.44 MB
   media only.

<P><LI>Check for problems related to the DMF format. (For a description of DMF,
   see the MORE INFORMATION section, below.) The four known DMF issues and
   their solutions are outlined below:
<P>
   a. Incompatible floppy drives.
<P>
<P><PRE>      You may have problems if your floppy drive is one of the
      following types:
</PRE><P>
<P><PRE>       - SCSI floppy drives, including Flopticals.
       - Floppy drives attached via older MicroSolutions Compaticards.
       - Apple Macintosh floppy drives (even via SoftPC).
       - Early Gateway 2000 Handbook or Colorbook notebooks.
</PRE><P>
<P><PRE>      SOLUTION: Request a set of replacement disks. Replacement disks are
      not DMF-formatted and are available in 1.44 MB media only.
</PRE><P>
   b. Incompatible operating systems.
<P>
<P><PRE>      Operating systems other than Windows version 3.1 (or later) may
      not have the correct floppy drive system files to support DMF.
      Problems have been reported on the following:
</PRE><P>
<P><PRE>       - OS/2 Warp Version 3.0.
</PRE><P>
<PRE>         DMF was developed before OS/2 Warp was released so there was no
         opportunity for compatibility testing. These errors have also been
         reported on OS/2 versions 2.0 and 2.1. Microsoft has been unable
         to reproduce these problems under OS/2 2.0 or 2.1 in testing.

         For more information about the DMF and OS/2 Warp Version 3.0,
         please see the following article in the Microsoft Knowledge Base:

         ARTICLE-ID: <B><A href="../setup/q122280.htm">Q122280</A></B>
         TITLE     : Error Running Setup from DMF Disks Under OS/2

       - SoftWindows for the Macintosh.

         SoftWindows is not a supported configuration for any of the
         Microsoft Windows-based applications. There has been no formal
         testing of our applications running under SoftWindows.

         For more information about the DMF and SoftWindows, please see the
         following article in the Microsoft Knowledge Base:

         ARTICLE-ID: <B><A href="../setup/q122279.htm">Q122279</A></B>
         TITLE     : Error Installing Application on Power Mac Running
                     SoftWindows

         SOLUTION: Request a set of replacement disks. Replacement disks
         are not DMF-formatted and are available in 1.44 MB media only.

   c. MS-DOS does not recognize that the disk format on disk 2 is
      different from the disk format on disk 1.

      Change-line support on the floppy drive informs MS-DOS when a disk
      and/or the format of a disk has changed. If MS-DOS determines the
      format of the first disk but does not realize that the formatting
      of the second disk is different, the second disk cannot be read.

      Use the DIR command on disk 2. If you see a screenful of spurious
      characters, this is probably a changeline problem. If you receive
      disk read errors, a flawed disk cache may be involved.

      SOLUTION: Choose one of the following four methods to work around
      this problem:

       - Method One: Add the MS-DOS DRIVPARM command to your CONFIG.SYS
         file using the following syntax:

          For a 1.44-MB A: drive      For a 1.44-MB B: drive
          --------------------------------------------------
          DRIVPARM=/d:0 /f:7          DRIVPARM=/d:1 /f:7

         -or-

       - Method Two: Remove Setup Disk 2 from the floppy disk drive and
         press ENTER. Then insert the disk in the drive again and press
         ENTER.

         -or-

       - Method three: With Setup Disk 2 in the floppy disk drive, follow
         these steps:

         a. Bring up the Windows File Manager.

         b. Select the drive that contains the Setup disk (for example, A:)
            and press the F5 key to update the directory window. If this
            doesn't work, you may need to select another drive, and then
            switch back to the drive that contains the Setup disk.

         c. Press ALT+TAB to switch back to the Setup program, and continue
            installing the application.

         -or-

       - Method four: If none of the previous methods work, you can force
         the tree to be re-read by following these steps:

         a. Press ALT+TAB to switch to the Windows Program Manager.

         b. Shell to MS-DOS.

         c. At the MS-DOS prompt, change to the installation drive.

         d. Press CTRL+C to clear the cache and force MS-DOS to re-read
            the tree.

         e. Type exit to exit MS-DOS and return to Windows.

         f. Press ALT+TAB to return to the Setup program, and continue
            installing the application.

         NOTE: You may have to repeat this process between each
         disk change.

   d. Helix Multimedia Cloaking is running during installation.

      SOLUTION: Disable Helix Multimedia Cloaking during installation. For
      more information about the DMF and Helix Multimedia Cloaking, please
      see the following article in the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../setup/q128333.htm">Q128333</A></B>
      TITLE     : "File Cannot be Decompressed" with Helix Multimedia
                  Cloaking

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Besides a virus or hardware problem, the other major causes of disk 2
failures relate to the new Distribution Media Format (DMF) used for the
installation disks.
<P>
The root of DMF-related problems is not DMF itself. The two underlying
causes are:

<UL><LI>DMF is a new technology that some operating systems or utilities cannot
   handle reliably.

<LI>Some disk controllers may not recognize the disk change when disk 1
   (standard floppy format) is removed and disk 2 (DMF format) is inserted
   in the drive.
<P>
</UL><h3>What is DMF?</h3>
 
<P>
DMF is a special read-only format for 3.5-inch floppy disks that permits
storing 1.7 MB of data (a 17.7% increase over the standard 1.44 MB format).
<P>
This is achieved by reducing the inter-sector gap, and adding three sectors
per track. This does not affect the ability of arbitrary floppy drives to
read the disk, because we have not changed the magnetic recording density.
With this reduced inter-sector gap, however, there is not enough room
between sectors to allow a floppy drive to reliably write to a DMF disk.
<P>
Disks formatted with DMF cannot be copied to a standard high density
3.5-inch disk using the MS-DOS DISKCOPY or Windows COPY commands.
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q120006.htm">Q120006</A></B>
   TITLE     : XL5C: How to Copy Files from Cabinets on DMF-Formatted Disks

   ARTICLE-ID: <B><A href="../setup/q122209.htm">Q122209</A></B>
   TITLE     : Error Message Occurs When Using Extract Utility

   ARTICLE-ID: <B><A href="../setup/q121802.htm">Q121802</A></B>
   TITLE     : "Could Not Read From File..." Running Maintenance Mode
               Setup

   ARTICLE-ID: <B><A href="../word/q79207.htm">Q79207</A></B>
   TITLE     : WinWord Setup Fails on Disk 2; DRIVPARM Solution

</PRE>SoftWindows is manufactured by Insignia Solutions, a vendor independent of
Microsoft; we make no warranty, implied or otherwise, regarding this
product's performance or reliability.
<P>
OS/2 Warp Version 3.0 is manufactured by International Business Machines, a
vendor independent of Microsoft; we make no warranty, implied or otherwise,
regarding this product's performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin tshoot t-shoot trouble-shoot<BR>
installation set up<BR>
KBCategory: kbsetup kbtshoot kbprb<BR>
KBSubcategory: FxsetupGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
