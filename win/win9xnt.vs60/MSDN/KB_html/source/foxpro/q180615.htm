

<HTML>
<HEAD>
<TITLE>PRB: Text Box Value Does Not Change If ControlSource Is .NULL. </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180615">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1998/02/05">
<META NAME="Keywords" CONTENT="FxtoolFormdes VFoxMac vfoxwin vfp50abug vfp50bug kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When the ControlSource property of a text box control is set to the custom property of a form and the custom property is .NULL., the text in the control cannot be changed. If the text in the control is edited, the text changes to .NULL. when the co...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QBT6,QAHP,QAPN,QATX,QAMB,QAH4,QA7O,QAOE,QAMN,QAB5,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Text Box Value Does Not Change If ControlSource Is .NULL.</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180615</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the ControlSource property of a text box control is set to the custom
property of a form and the custom property is .NULL., the text in the
control cannot be changed. If the text in the control is edited, the text
changes to .NULL. when the control loses focus.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Change the class definition in the code below to add the KeyPress method as
follows:
<P>
<PRE>   DEFINE CLASS NewTextBox AS textbox
      PROCEDURE KeyPress
      LPARAMETERS nKeyCode, nShiftAltCtrl
              *-- Once the text has changed, set the custom
              *-- property of the form to the text box.
         ThisForm.custom_prop = This.Value
      ENDPROC
   ENDDEFINE

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a program using the code below that creates a form with a custom
   property and two text boxes. The ControlSource of the first text box is
   set to the form's custom property.
<P>
<P><PRE>      frmMain = CREATEOBJECT("frmBase")
      frmMain.Show
      READ EVENTS
</PRE><P>
<P><PRE>      DEFINE CLASS frmBase AS Form
</PRE><P>
<PRE>           *-- Set the property to a character type.
           custom_prop = ""

           PROCEDURE Init
               ThisForm.custom_prop = .NULL.
           ENDPROC

           PROCEDURE Unload
         CLEAR EVENTS
      ENDPROC

          *-- Create the text box that gives the problem.
          ADD OBJECT text AS NewTextBox WITH ;
             Left = 100, ;
             Top = 0, ;
             Width = 250, ;
             Name = "txtText",;
             NullDisplay = ".NULL.",;
             ControlSource = "thisform.custom_prop"

         *-- Create another text box to give you something to tab into.
         ADD OBJECT text2 AS TextBox WITH ;
            Left = 100, ;
            Top = 50, ;
            Width = 250, ;
            Name = "txtText2"
      ENDDEFINE

      DEFINE CLASS NewTextBox AS textbox
      ENDDEFINE

</PRE><P><LI>Run the program and enter text into the first text box.

<P><LI>Tab to the next text box.
<P>
   The text in the control changes to .NULL.
<P>
</OL> 
<PRE>Keywords          : FxtoolFormdes VFoxMac vfoxwin vfp50abug vfp50bug kbcode
Version           : MACINTOSH:3.0b; WINDOWS:3.0,3.0b,5.0,5.0a
Platform          : MACINTOSH WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
