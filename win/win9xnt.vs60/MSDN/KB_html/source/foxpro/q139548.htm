

<HTML>
<HEAD>
<TITLE>How to Use the GetDiskFreeSpace API Call </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139548">
<META NAME="KBModify" CONTENT="1995/11/16">
<META NAME="KBCreate" CONTENT="1995/11/13">
<META NAME="Keywords" CONTENT="kbprg kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  By using the GetDiskFreeSpace API call, you can determine how much disk space a drive has, how much is used, and how much is free. This article explains how to use and call the Win32 GetDiskFreeSpace API.  MORE INFORMATION  In many cases, such as b...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW5,QAGI,QDIT,QAH4,QAWH,QAC9,QAIF,QAZA,QADP,QA4Q,QAYY,QAKC,QBXM,QBC6,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use the GetDiskFreeSpace API Call</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 16, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139548</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By using the GetDiskFreeSpace API call, you can determine how much disk
space a drive has, how much is used, and how much is free. This article
explains how to use and call the Win32 GetDiskFreeSpace API.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In many cases, such as backing up or restoring user data, you need to know
various characteristics about the media with which you are working (such as
whether or not it is fixed or removable) and about the amount of available
space on that media.
<P>
By using the GetDiskFreeSpace API call, you can derive the low-level
information about the disk (such as bytes per sector and sectors per
cluster), and then use that information for your calculations.
<P>
The following code demonstrates the syntax and use of this API call and
gives some of the more common calculations you may need to perform.
<P>
<P><h3>Code Sample</h3>
 
<P>
**---------------------------------------------------------------**
<PRE>** Program: Getspace.prg                                         **
** Purpose: Demonstrates how to declare and call the Win32       **
**          GetDiskFreeSpace API.                               **
</PRE>**---------------------------------------------------------------**
PUBLIC  lpRootPathName, ;
<PRE>        lpSectsPerCluster, ;
        lpBytesPerSector, ;
        lpNumberOfFreeClusters, ;
        lpTotalNumberOfClusters

lpRootPathName       = "A:\"
lpSectsPerCluster    = 0
lpBytesPerSect       = 0
</PRE>lpNumOfFreeClusters  = 0
<PRE>lpTotNumOfClusters   = 0

</PRE>DECLARE INTEGER GetDiskFreeSpace IN Win32API AS GetDiskSpace ;
<PRE>        STRING  @lpRootPathName, ;
        INTEGER @lpSectsPerCluster, ;
        INTEGER @lpBytesPerSect, ;
        INTEGER @lpNumOfFreeClusters, ;
        INTEGER @lpTotNumOfClusters

</PRE>RetVal=GetDiskSpace(@lpRootPathName, @lpSectsPerCluster, @lpBytesPerSect, ;
<PRE>        @lpNumOfFreeClusters, @lpTotNumOfClusters)

</PRE>DEFINE WINDOW ShowInfo FROM 0,0 TO 12,70 ;
<PRE>        FLOAT CLOSE ;
        TITLES "Drive Information for " + ;
        ALLTRIM(lpRootPathName) ;
        FONT "Courier",10

</PRE>ACTIVATE WINDOW ShowInfo
MOVE WINDOW ShowInfo CENTER
<P>
<PRE>@ 0,1 SAY "Drive &amp; path name            : " + ;
   ALLTRIM(lpRootPathName)
@ 1,1 SAY "Sectors per cluster          : " + ;
   ALLTRIM(STR(lpSectsPerCluster))
@ 2,1 SAY "Bytes per Sector             : " + ;
   ALLTRIM(STR(lpBytesPerSect))
@ 3,1 SAY "Number of free clusters      : " + ;
   ALLTRIM(STR(lpNumOfFreeClusters))
@ 4,1 SAY "Total number of clusters     : " + ;
   ALLTRIM(STR(lpTotNumOfClusters))
</PRE>@ 5,1 SAY "==================================================="
<PRE>@ 6,1 SAY "Total disk space             : " + ;
   ALLTRIM(STR(lpSectsPerCluster * lpBytesPerSect * lpTotNumOfClusters))
@ 7,1 SAY "Free disk space              : " + ;
   ALLTRIM(STR(lpSectsPerCluster * lpBytesPerSect * lpNumOfFreeClusters))
@ 8,1 SAY "Used disk space              : " + ;
   ALLTRIM(STR(lpSectsPerCluster * lpBytesPerSect * ;
   (lpTotNumOfClusters - lpNumOfFreeClusters)))

</PRE>**--------------------------&lt;End Code&gt;---------------------------**
<P>
When this code is run on a 1.44-megabyte floppy disk, the following output
is what you would get if the floppy disk is a new, formatted floppy disk
that contains no data:
<P>
<PRE>Drive &amp; path name        : A:\
Sectors per cluster      : 1
Bytes per sector         : 512
</PRE>Number of free clusters  : 2847
Total number of clusters : 2847
 
<PRE>Total disk space         : 1457664
Free disk space          : 1457664
Used disk space          : 0

</PRE>Using this API call, you can quickly and easily determine how much disk
space you have available for your program. A related disk API
(GetVolumeInformation) provides information about the disk physical
characteristics such as the file system and file compression.
<P>
For additional information on this API function, please see the
"GetDiskFreeSpace" topic in the Win32API help file. Note that this help
file is available only on the compact disc version of Visual FoxPro; it is
not shipped with the disk version. For more information, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q139172.htm">Q139172</A></B>
   TITLE     : PRB: Visual FoxPro CD-ROM Compact Disc Includes Extra Files

</PRE>For information about the DECLARE - DLL command, please search the Visual
FoxPro Help file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin drive volume space free attributes<BR>
KBCategory: kbprg kbcode kbhowto<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 16, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
