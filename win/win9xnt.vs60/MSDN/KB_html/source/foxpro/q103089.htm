

<HTML>
<HEAD>
<TITLE>How to Move the Cursor to the End of an @ ... EDIT Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103089">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/08/18">
<META NAME="Keywords" CONTENT="kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In order to facilitate text editing, you may need to place the cursor at the end of an edit region both upon entering a screen and upon moving to another record in the database. Listed below are two different methods of doing this.  MORE INFORMATIO...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAO2,QACI,QAPN,QAH4,QANE,QAEF,QBM2,QANJ,QA9N,QAB9,QBRD,QA5V,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Move the Cursor to the End of an @ ... EDIT Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103089</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In order to facilitate text editing, you may need to place the cursor at
the end of an edit region both upon entering a screen and upon moving to
another record in the database. Listed below are two different methods of
doing this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1</h3>
 
<P>
To begin editing at the end of a field created with @ ... EDIT, use the
WHEN clause of the @ ... EDIT command to send CTRL+A and RIGHT ARROW
keystrokes to the keyboard buffer.
<P>
Normally, the cursor will appear at the first character in the field
when the cursor is moved to an @ ... EDIT field. However, if CTRL+A
and the RIGHT ARROW key are pressed, the cursor will appear at the end
of the data.
<P>
To automatically move the cursor whenever it enters of an @ ... EDIT
field, these keystrokes must be sent to the keyboard buffer through
the WHEN clause of the @ ... EDIT field.
<P>
NOTE: For the CTRL+A key combination to work properly, the FoxPro
system menu must contain the Select All menu command (_MED_SLCTA) on
the default Edit menu (_MSM_EDIT), and the shortcut key for the Select
All menu command must be defined as CTRL+A.
<P>
The following code demonstrates how to move to the last character of
an @ ... EDIT field.
<P>
<PRE>   SET SYSMENU TO
   SET SYSMENU AUTOMATIC

   DEFINE PAD medit OF _MSYSMENU PROMPT "Edit" COLOR SCHEME 3
   DEFINE PAD mquit OF _MSYSMENU PROMPT "Quit" COLOR SCHEME 3
   ON PAD medit OF _MSYSMENU ACTIVATE POPUP selectall
   ON SELECTION PAD mquit OF _MSYSMENU DO zzz

   DEFINE POPUP selectall MARGIN RELATIVE SHADOW COLOR SCHEME 4
   DEFINE BAR _MED_SLCTA OF selectall PROMPT "Select All" ;
      KEY CTRL+A, "CTRL+A"
   Y = 'This is a test'
   @ 2,2 GET x DEFAULT SPACE(10)
   @ 4,2 EDIT y DEFAULT SPACE(0) SIZE 4,20 WHEN yyy()
   READ CYCLE

   PROCEDURE yyy
   KEYBOARD "{CTRL+A}"
   KEYBOARD "{RIGHTARROW}"
   RETURN .t.

   PROCEDURE zzz
   SET SYSMENU TO DEFAULT
   CLEAR READ

</PRE><h3>Method 2</h3>
 
<P>
In order to describe the steps necessary to create a screen that
automatically moves the cursor to the bottom of an edit region, this
method makes the following assumptions:

<UL><LI>The database used by the screen is called CUSTOMER.DBF.
<LI>The memo field is called NOTES.
<LI>The first GET field in the screen is for the field CNO.
<LI>The first field and the EDIT region are not disabled.
<LI>A series of buttons is employed to navigate the database.
<P>
</UL>Upon executing a screen program, the first object activated is usually the
first GET field. Therefore, the WHEN procedure of the first GET field will
be used to send the cursor to the EDIT field. However, since you might want
to enter data in the first GET field, a conditional test must be performed
to allow this to happen only the first time the field is entered. To set up
this condition, place the statement
<P>
<PRE>   m.flag = .f.

</PRE>in the Setup code for the screen in the Screen Builder. By testing this
variable in the WHEN clause of the CNO field (the first field) and then
changing its value, you can allow entry into CNO instead of always jumping
to the EDIT field. Placing the following code in the WHEN clause for the
CNO field will accomplish this:
<P>
<PRE>   IF ! FLAG
     _CUROBJ=OBJNUM(customer.notes)  &amp;&amp; moves cursor to EDIT field
     m.flag = .t.                    &amp;&amp; allow access to CNO next time
   ENDIF

</PRE>Now that you have arranged to have your cursor move to the EDIT region, you
are ready to perform the desired function; namely, moving the cursor to the
bottom. In preparation, the EDIT region must be set so that the entire
field is SELECTed ON ENTRY. Then, place the following code in the WHEN
clause for the EDIT field:
<P>
<PRE>   KEYBOARD("{DNARROW}")

</PRE>Because the entire field is selected, you only need to code one "down
arrow" character to move to the bottom of the field. The only step
remaining is to modify the VALID procedure for the navigation buttons. This
code usually consists of a DO CASE statement to process the different
buttons. Usually, the last statement in the VALID procedure will be SHOW
GETS (used to refresh the screen). Add a line immediately before the SHOW
GETS line as follows:
<P>
<PRE>   _CUROBJ = OBJNUM(customer.notes)

</PRE>This is the same statement you used in the WHEN procedure of the first
field to move the cursor to the EDIT field. When the screen is generated
and run, every time you move to another record using the buttons, the
cursor will be placed at the bottom of the EDIT field.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin SBuilder 2.50 2.50a 2.50b<BR>
2.50c 2.60 2.60a<BR>
KBCategory: kbtool kbprg kbcode<BR>
KBSubcategory: FxtoolSbuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
