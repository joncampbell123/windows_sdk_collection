

<HTML>
<HEAD>
<TITLE>"Syntax Error" When Verifying UDF() in Report Writer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113754">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/04/13">
<META NAME="Keywords" CONTENT="kbprg kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are verifying an user-defined function (UDF) in the Expression Builder, a  Syntax Error  appears. The  Syntax Error  message occurs because the Expression Builder cannot evaluate UDFs and expects instead to find an internal function.  Howe...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QAB9,QBV8,QAUD,QAVX,QAVW,QAUJ,QAB4,QBE7,QBE6,QACE,QAJQ,QA7Y,QAJ9,QBSO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>"Syntax Error" When Verifying UDF() in Report Writer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113754</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6x
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for Macintosh, version 2.5x, 2.6a
<LI>Microsoft FoxBASE+ for MS-DOS, version 2.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you are verifying an user-defined function (UDF) in the Expression
Builder, a "Syntax Error" appears. The "Syntax Error" message occurs
because the Expression Builder cannot evaluate UDFs and expects instead to
find an internal function.
<P>
However, if the UDF() function exists as a stand-alone .PRG file and has
previously been tested, the function will operate properly in a report when
the report is previewed or printed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A UDF is a program routine that must always return a value of some type. It
can be created in two forms: external and internal. An internal function is
a subroutine within a .PRG file, and its name must be preceded with the
FUNCTION statement. An external function is a single .PRG file, with a
maximum of eight characters for its name.
<P>
The external form must be used so that the Report Writer can find it as a
stand-alone .PRG file in the default directory or SET PATH list (SET
PROCEDURE TO is not evaluated).
<P>
Once you have created the function, you can test the function by invoking
it from the Command window or from within a program. In the following
example, a function to print a time stamp (minute resolution) on each
record is needed. To do this, create the file STAMP.PRG, which contains
this single line:
<P>
<PRE>   RETURN LTRIM(STR(SECONDS()/60))+':'+LTRIM(STR(SECONDS()%60,10,3))

</PRE>This function returns the number of seconds since midnight divided by 60 to
show the number of minutes (no decimals), concatenated with the modulus of
SECONDS to show the remainder of seconds and hundredths of seconds. To test
this function, type the following commands in the Command window:
<P>
<PRE>   SET TALK ON  &amp;&amp; if not on already
   ? Stamp()

</PRE>FoxPro should return a character string consisting of the minutes, a colon,
the seconds, a decimal point, and the hundredths of seconds. Although the
function name is STAMP, it must be invoked as STAMP() to cause FoxPro to
look for an internal function of the same name. When it cannot be found,
FoxPro will then look externally for a file with the same name.
<P>
After the function has been successfully tested, you can use it in the
report. To use the function, create a field on the report and enter the
name of the function followed by a left and right parentheses, as shown in
the test above.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxMac FoxDos FoxWin 2.00 2.10<BR>
2.50 2.50a 2.50b 2.50c 2.60 2.60 calculate report variable RWriter<BR>
KBCategory: kbprg kberrmsg<BR>
KBSubcategory: FxtoolRwriter<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
