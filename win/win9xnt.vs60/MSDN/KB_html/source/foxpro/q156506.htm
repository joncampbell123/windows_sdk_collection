

<HTML>
<HEAD>
<TITLE>PRB: ADD OBJECT Syntax Error from Browser Code Snippet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156506">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/25">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A code snippet exported by the Class Browser generates a syntax error if the code uses the ADD OBJECT command to add an object to a container object in a class. It appears that the Class Browser exported the code incorrectly. In fact, Visual FoxPro...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBJZ,QAPN,QAW6,QABO,QBWS,QBTI,QABG,QAY2,QAAP,QAUR,QBV8,QA56,QA55,QA3P V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ADD OBJECT Syntax Error from Browser Code Snippet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156506</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A code snippet exported by the Class Browser generates a syntax error if
the code uses the ADD OBJECT command to add an object to a container object
in a class. It appears that the Class Browser exported the code
incorrectly. In fact, Visual FoxPro has a language limitation that does not
allow the ADD OBJECT command to add an object to a container object in a
class definition.
<P>
<P><h2>CAUSE</h2>
 
<P>
Even though the Class Browser cannot produce actual working code in this
situation, it documents the intent of the class rather than omit the code
altogether.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the Class Browser to export code from within a class. Code
exported may be incorporated in a program or it may just be used for the
purpose of documentation.
<P>
The Class Browser designers decided it would be helpful to document code
even though it cannot work because of a language limitation of Visual
FoxPro. While the code does not work, the Class Browser describes in code
what the developer achieved through the visual user interface.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In Visual FoxPro click New on the File menu and click the Form button to
   start the form designer.

<P><LI>Click Create Formset on the Form menu. In the Properties sheet for  the
   formset, change the name property to "Testfrm1" (without the quotes).

<P><LI>Click the Command Button tool on the Form Control toolbar, and
   click on the middle of the form to place the command button on the form.

<P><LI>Set the following properties for the command button:
<P>
<P><PRE>      Top = 51
      Left = 112
      Height = 32
      Width = 140
</PRE><P>
   This step is optional, but it establishes the values shown in this
   example.

<P><LI>Click Save as class on the File menu. In the Save As Class dialog box
   click the "Entire Form Set" option button, and name the class "Testfrm1"
   and the class library "testfrm1.vcx."

<P><LI>Close the Form Designer. Save the form as Testfrm1.scx.

<P><LI>Select Class Browser on the Tools menu.

<P><LI>In the Class Browser Opening dialog box select your class library:
   Testfrm1.vcx

<P><LI>Click the line "testfrm1.vcx."

<P><LI>Click the "View Code" button (the third button from the left).

<P><LI>Click "Select All" on the Edit menu, then select "Copy" from the Edit
<P><PRE>    menu to put the code in the Clipboard.
</PRE>
<P><LI>Close the Class Browser, and in the Command window type the following:
<P>
<P><PRE>       MODIFY COMMAND Testfrm1
</PRE>
<P><LI>Paste the code from the Clipboard into Testfrm1.prg.

<P><LI>At the top of the code insert the following commands:
<P>
<P><PRE>       PUBLIC oformset1
       oformset1=CREATEOBJECT("formset1")
       oformset1.Show()
       RETURN
</PRE><P>
<P><PRE>    The entire program should look like the following:
</PRE><P>
<P><PRE>       PUBLIC oformset1
       oformset1=CREATEOBJECT("testfrm1")
       oformset1.Show()
       RETURN
</PRE><P>
<P><PRE>       **************************************************
<PRE></PRE>       *-- Formset:      testfrm1 (c:\VFP50\testfrm1.vcx)
       *-- ParentClass:  formset
       *-- BaseClass:    formset
       *
       DEFINE CLASS testfrm1 AS formset

         DataSession = 1
         AutoRelease = .T.
         Name = "Testfrm1"

         ADD OBJECT form1 AS form WITH ;
           DoCreate = .T., ;
           Caption = "Form1", ;
           Name = "Form1"

         ADD OBJECT testfrm1.form1.command1 AS commandbutton WITH ;
           Top = 51, ;
           Left = 112, ;
           Height = 32, ;
           Width = 140, ;
           Caption = "Command1", ;
           Name = "Command1"

       ENDDEFINE
       *
       *-- EndDefine: testfrm1
       **************************************************

</PRE><P><LI>Save and run the program Testfrm1.prg.
<P>
</OL>The program stops with the following error:
<P>
<PRE>   Syntax error

</PRE></OL>The following line is highlighted:
<P>
<PRE>   ADD OBJECT testfrm1.form1.command1 AS commandbutton WITH ;
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxtoolClassbrow FxprgClassoop<BR>
Additional reference words: 5.00 kbdsd VFoxwin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
