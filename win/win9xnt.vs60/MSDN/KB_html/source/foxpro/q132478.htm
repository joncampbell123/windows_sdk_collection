

<HTML>
<HEAD>
<TITLE>PRB: Grid Column's CurrentControl Reverts to Text1 Default </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132478">
<META NAME="KBModify" CONTENT="1996/01/09">
<META NAME="KBCreate" CONTENT="1995/07/12">
<META NAME="Keywords" CONTENT="kbprg kbui kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you use the SQL SELECT command, and set the grid's RecordSource property to the newly queried cursor file, the grid column's current control (Check1 for example) reverts to Text1 (the default control).  CAUSE =====  The SQL SELECT code include...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QABI,QBT6,QBV4,QA7S,QAPN,QA2Q,QBWS,QARR,QA5V,QAO2,QAHP,QAG2,QAY4,QAMY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Grid Column's CurrentControl Reverts to Text1 Default</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132478</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the SQL SELECT command, and set the grid's RecordSource
property to the newly queried cursor file, the grid column's current
control (Check1 for example) reverts to Text1 (the default control).
<P>
<P><h2>CAUSE</h2>
 
<P>
The SQL SELECT code includes a SELECT ... INTO CURSOR TESTCURSOR command,
which is the RecordSource for the grid. When this happens, the original
cursor must be destroyed before the new cursor can be created. When the
orginal cursor is destroyed, the grid columns and the controls in the
columns are also destroyed, as well as the check box. In this case, the
check box is destroyed. The SQL SELECT code sets the grid's RecordSource to
the new cursor. At this point, the columns are automatically created with
the default settings. There is no code to recreate the check box.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To retain the controls in the grid columns, add the following statement
prior to executing the SQL SELECT command:
<P>
<PRE>      THISFORM.Grid1.RecordSource = ""

</PRE>For more information, please see the example workaround in the More
Information section of this article.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Issue the following commands:
<P>
   CREATE TABLE Testdbf (id N(1), region C(10))
   INSERT INTO Testdbf VALUES (0, "North")
   INSERT INTO Testdbf VALUES (1, "South")
   INSERT INTO Testdbf VALUES (0, "North")
   INSERT INTO Testdbf VALUES (1, "South")

<P><LI>Create a form named Test.

<P><LI>Add the Testdbf table to the Test form's Data Environment.

<P><LI>Drag the Testdbf table to the form. A grid is added to the form.

<P><LI>Set the following PEMs (properties, events, and methods) for the grid:
<P>
   .ColumnCount = 2
   .RecordSource = "testcursor"

<P><LI>Select Grid1.Column1 in the Properties window.

<P><LI>Click the check box tool on the toolbar. On the grid, Check1 should
   appear under Grid1.Column1 in the Properties window.

<P><LI>Change the Grid1.Column1.CurrentControl property to Check1.

<P><LI>Add a text box to the form.

<P><LI>Add a command button to the form, and set the following PEMs:
<P>
<P><PRE>    .Caption = "SQL"
    .Click
       SELECT * FROM Testdbf ;
<PRE></PRE>          WHERE region = ALLTRIM(thisform.text1.value) ;
          INTO CURSOR testcursor
       THISFORM.Grid1.RecordSource = "testcursor"
       THISFORM.Grid1.SetFocus

</PRE><P><LI>In the Form1.Load event, add this line of code:
<P>
<P><PRE>    SELECT * FROM Testdbf WHERE region = "North" ;
       INTO CURSOR testcursor
</PRE>
<P><LI>Save and run form. The grid is populated with "North" records only, and
<P><PRE>    Grid1.Column1 displays a check box.
</PRE>
<P><LI>Type "South" (without the quotation marks) in the text box.

<P><LI>Click the SQL button.

<P><LI>Widen the ID column. The grid is populated with the "South" records
<P><PRE>    only, and Grid1.Column1 no longer displays a check box control. It
    now displays the default control, which is a text box with a value of 1
    for both records.
</PRE><P>
</OL><h3>Example Workaround</h3>
 

<OL><P><LI>Modify the Test form.

<P><LI>In the Command1.Click event, add the following statement prior to
   executing the SQL SELECT command:
<P>
<P><PRE>      THISFORM.Grid1.RecordSource = ""
</PRE><P>
   For example:
<P>
<P><PRE>      THISFORM.Grid1.RecordSource = ""
      SELECT * FROM Testdbf ;
<PRE></PRE>         WHERE region = ALLTRIM(thisform.text1.value) ;
         INTO CURSOR testcursor
      THISFORM.Grid1.RecordSource = "testcursor"
      THISFORM.Grid1.SetFocus

</PRE><P><LI>Type the CLEAR ALL command in the Command window.

<P><LI>Save and run the form.

<P><LI>Type "South" in the text box.

<P><LI>Click the SQL button. Now the grid is populated with the "South" records
   only, and Grid1.Column1 redisplays the check box control.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin refresh<BR>
KBCategory: kbprg kbui kbcode kbprb<BR>
KBSubcategory: FxotherGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
