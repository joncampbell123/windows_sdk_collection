

<HTML>
<HEAD>
<TITLE>BUG: Mouse Click Causes Problems with MENU TO Command </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100812">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1993/06/29">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Clicking the mouse anywhere other than on the prompts that are displayed when a menu is created with the @...PROMPT and MENU TO commands will cause FoxPro to endlessly cycle through all the displayed prompts. The only way to exit this cycle is to p...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QACF,QAGB,QAFX,QAGC,QAF0,QAEF,QAKP,QAUD,QAMB,QAJX,QADR,QAC2,QAA7,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Mouse Click Causes Problems with MENU TO Command</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100812</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Clicking the mouse anywhere other than on the prompts that are
displayed when a menu is created with the @...PROMPT and MENU TO
commands will cause FoxPro to endlessly cycle through all the
displayed prompts. The only way to exit this cycle is to press ESC to
cancel the program or to click a quit prompt. The mouse will not cause
problems when a prompt is clicked on. The mouse will also function
while in the endless cycle if a prompt is clicked. However, the
keyboard will be disabled while in the endless cycle. You can
sometimes use ON KEY LABEL assignments to break out of the endless
cycle.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
FoxPro for Windows offers several alternative ways to create menus
similar to popup menus. These methods should be used if the MENU TO
and @... PROMPT method causes problems. Using the Menu Builder or
using push buttons are two alternatives.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro 2.5 for
Windows. This problem was corrected in FoxPro 2.5a for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The MENU TO command is used to activate menu popups created with
@...PROMPT. It is an old command that is included in FoxPro for
backward compatibility with FoxBASE+. FoxBASE+ programs that are
converted to FoxPro for Windows may contain menu popups that are
created with these commands. These menu popups will work properly if
only the keyboard is used to choose the menu items or if the mouse is
clicked only on the actual prompts.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
The following sample program can be used to illustrate the problem:
<P>
<PRE>   ON KEY LABEL F12 WAIT WINDOW "Hello"    &amp;&amp; This may stop the cycle.
   ON KEY LABEL F9 CANCEL              &amp;&amp; This may cancel the program.

   CLEAR

   DEFINE WINDOW test AT 0,0 SIZE 25,100
   ACTIVATE WINDOW test

   PRIVATE menuch
   STORE 0 TO menuch

   PRIVATE xx
   STORE .T. TO xx
   DO WHILE xx
      CLEAR
      DO menus
      @ 12,26 PROMPT " 1"
      @ 13,26 PROMPT " 2"
      @ 14,26 PROMPT " 3"
      @ 15,26 PROMPT " 4"

      MENU TO menuch

      IF menuch = 4
         CLEAR ALL
         CANCEL
      ENDIF
   ENDDO

   RETURN

   PROCEDURE menus

   @ 12,18 SAY "           Not connected               "
   @ 13,18 SAY "           Not connected               "
   @ 14,18 SAY "           Not connected               "
   @ 15,18 SAY "           Quit the Application        "
   @ 18,18 SAY "    Please select the desired choice   "
   @ 19,18 SAY "       Press &lt;RETURN&gt; when ready       "
   @ 20,18 SAY "    F9 Cancels the program also        "
   RETURN

</PRE><h2>REFERENCES</h2>
 
<P>
"Language Reference," version 2.5, pages L3-646 and L3-150 to L3-151
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: MBuilder FoxWin 2.50 FAR buglist2.50<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxtoolMBuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
