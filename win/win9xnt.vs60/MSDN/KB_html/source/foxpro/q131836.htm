

<HTML>
<HEAD>
<TITLE>PRB: Grid Not Refreshing Displaying a Cursor From Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131836">
<META NAME="KBModify" CONTENT="1997/02/06">
<META NAME="KBCreate" CONTENT="1995/06/21">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a Grid's RecordSource property is set to a cursor and that cursor is updated at run time by using a  SQL Select Into Cursor               command, the grid does not display any data even if you Refresh it by using the ThisForm.Refresh or ThisFor...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QARR,QAPN,QAH4,QAXB,QBT6,QBWS,QBV4,QBVV,QAUY,QA5V,QA2Q,QAY2,QAO4,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Grid Not Refreshing Displaying a Cursor From Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131836</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a Grid's RecordSource property is set to a cursor and that cursor is
updated at run time by using a "SQL Select Into Cursor &lt;CursorName&gt;"
command, the grid does not display any data even if you Refresh it by using
the ThisForm.Refresh or ThisForm.&lt;GridName&gt;.Refresh command.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you execute a SQL Select statement into the same cursor specified in
the grid's RecordSource property, the original cursor has to be destroyed
before the new cursor can be created. When this happens, the grid columns
and the RecordSource are also cleared and then re-created. The grid's
record source is set to the new cursor, and the grid automatically creates
columns. The new grid is working from scratch, so it does not load the data
from the cursor.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To refresh the grid in this situation, set the Grid's RecordSource property
to itself as in this example:
<P>
<PRE>    thisform.grid1.recordsource=thisform.grid1.recordsource

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q140653.htm">Q140653</A></B>
   TITLE     : PRB: Cursor-Based Grid Goes Blank If SQL SELECT Resets
               Cursor

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form, and add the CUSTOMER.DBF table (in the \VFP\SAMPLES\DATA
   directory) to the Data Environment.

<P><LI>Place the following code in the Load event of the form:
<P>
   CREATE CURSOR Compdisp (company c(40),city c(15),country c(15))

<P><LI>Place the following code in the Destroy event of the form:
<P>
   SELECT Compdisp
   USE

<P><LI>Create a grid on the form, and give the grid the following property
   settings:
<P>
   ColumnCount=3
   RecordSourceType=Alias
   RecordSource=Compdisp

<P><LI>Add a text box to the form.

<P><LI>Add a command button with the following code in its Click event:
<P>
   SELECT company,city,country;
<P><PRE>      FROM customer;
      WHERE customer.country=thisform.text1.value;
      INTO CURSOR Compdisp
</PRE>   THISFORM.GRID1.REFRESH

<P><LI>Run the Form. Type "France" in the text box, and then click the command
   button.
<P>
</OL>The grid should display all records where Customer.Country="France," but it
doesn't. The grid is blank. THISFROM.GRID1.REFRESH does not seem to update
the grid. This happens even if the Cursor is not created in the Load event
of the Form.
<P>
To have the grid display the data correctly, place the following command as
the last line of code for the Click event of the command button:
<P>
<PRE>   ThisForm.Grid1.RecordSource =ThisForm.Grid1.RecordSource
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGrid VFoxMac VFoxWin<BR>
Additional reference words: 5.00 3.00b 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
