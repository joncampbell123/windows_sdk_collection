

<HTML>
<HEAD>
<TITLE>Contents of FOXDATA.TXT in FOXPROW\GOODIES\FOXDATA </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108173">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/12/07">
<META NAME="Keywords" CONTENT="kbreadme">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Below is the complete FoxPro for Windows FOXDATA.TXT file found in the FOXPROW\GOODIES\FOXDATA subdirectory.  MORE INFORMATION                FoxData   FoxData is a sample application that shows how FoxPro can be used as a dynamic data exchange (DD...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA6A,QAIH,QAUJ,QA9N,QAFI,QBS9,QBXS,QBVP,QDMF,QAUD,QBXB,QAZ2,QATJ,QBWS,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Contents of FOXDATA.TXT in FOXPROW\GOODIES\FOXDATA</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108173</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Below is the complete FoxPro for Windows FOXDATA.TXT file found in the
FOXPROW\GOODIES\FOXDATA subdirectory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
 
<P>
<PRE>             FoxData

</PRE> 
<P>
FoxData is a sample application that shows how FoxPro can be used as a
dynamic data exchange (DDE) server. You can use FoxData to paste or link
the contents of a FoxPro table or query to a Microsoft Excel spreadsheet,
for example, or to create a tab-delimited Microsoft Word document. Full
source code is included with the application. FoxData is located in the
FOXPROW\GOODIES\FOXDATA directory.
<P>
A copy of this FoxData help information is also available in the
FOXPROW\GOODIES\FOXDATA directory and is named FOXDATA.TXT. You may want to
print FOXDATA.TXT to the printer for easier viewing.
<P>
 
<P>
<PRE>     FoxData DDE Server Dialog

</PRE> 
<P>
The FoxData DDE Server dialog contains these options:
<P>
Copy push button
<PRE>    Copies the selected table or query to the Clipboard, and puts
    sufficient DDE link information on the Clipboard to support the
    Paste or Paste Link options in the client application.
    Choosing Paste from a client application pastes a one-time
    snapshot of the copied FoxPro table or query into the client
    application's active document or spreadsheet. Choosing Paste
    Link creates a link between the client application and the
    FoxPro table or query so that the linked information will be
    refreshed at least as often as every time you open the linked
    document or spreadsheet. Data may be updated even more
    frequently, depending upon the client application.

    Use the popup to select the type of file (Table/DBF or Query)
    you want to copy. Select a file from the Copy Table or Query
    list, then choose Copy.

</PRE>Quit push button
<PRE>    Exits FoxData without taking any action.

</PRE>Help push button
<PRE>    Displays help information about FoxData.

</PRE>Include Field Names check box
<PRE>    Check this check box to include the names of table or query
    fields in the data copied to the Clipboard.

</PRE>Directory push button
<PRE>    Displays the Select Directory dialog so you can choose the
    drive and/or directory on which the desired table or query
    is located.

</PRE>Directory text display area
<PRE>    Displays the currently selected directory. To change the
    directory, choose the Directory... push button.

</PRE>Number of DDE Clients area
<PRE>    Displays the number of active DDE connections, and includes
    the following push button:

    Show Log push button
      Enabled only when an error occurs in copying the table or
      query to the Clipboard. Choose this button to view a log
      of the error(s).

</PRE> 
<P>
<PRE>   Using the FoxData Application

</PRE> 
<P>
To use the FoxData sample application, choose Do... from the FoxPro
Program menu and select FOXDATA.APP from the FOXPROW\GOODIES\FOXDATA
directory. The FoxData DDE Server dialog is displayed. Use this
dialog to select a table or query and copy it to the Clipboard. Then
access the client application and paste or link the copied data to the
client application.
<P>
Copying from a FoxPro table to a Microsoft Excel spreadsheet
<PRE>  To copy, for example, the contents of the Sales table from FoxPro
  to a Microsoft Excel spreadsheet, select the Sales table from the
  FoxData DDE Server dialog and choose Copy. The contents of the
  Sales table are placed on the Clipboard. Click on cell A1 in a
  blank spreadsheet in Microsoft Excel, then choose Paste, Paste
  Special or Paste Link from the Edit menu in Excel. The contents of
  the Sales table are now pasted into the appropriate cells in the
  Excel spreadsheet.

</PRE>Copying from a FoxPro table to a Microsoft Word document
<PRE>   To copy the contents of the table to Microsoft Word, you can choose
   Paste Special from the Word Edit menu and then choose Paste Link
   from the Paste Special dialog. The contents of the Sales table are
   formatted as tab-delimited rows in Microsoft Word.

</PRE>NOTE: It may take your computer a few moments to display the results of
linking data between applications, especially if you're transferring large
amounts of information. For example, if you choose Paste Link to paste
FoxPro data into a spreadsheet, Excel first may fill the spreadsheet cells
with the comment "#N/A" while the DDE transfer is taking place. In a moment
or two the "#N/A" will clear from each cell and you will see the linked
table fields and rows displayed in the appropriate cells. When you transfer
data to a Microsoft Word document, Windows may display the hourglass for a
moment or two, until the transfer is complete.
<P>
 
<P>
<PRE>          Editing a Link

</PRE> 
<P>
To change the link between a FoxPro table or query and a client
application, you can edit the link. The following illustrations refer to
the links established in the "Using the FoxData Application" examples
above.
<P>
Editing a link in a Microsoft Excel spreadsheet
<PRE>  To remove field names from the displayed FoxPro table or query
  information in a linked Excel spreadsheet, for example, select a
  non-blank cell and choose F2 to edit the cell's contents. Change
  the word "All" at the end of the command to "Data", then press
  CTRL+SHIFT+ENTER. The linked fields in the spreadsheet are
  redisplayed without field names.

</PRE>Editing a link in a Microsoft Word document
<PRE>  To edit a link in a Microsoft Word document, choose Links... from
  the Edit menu in Word. Select the link you want to edit, then
  choose Change Link.... In the Change Link dialog, edit the
  information in the Item text box. For example, change the word
  "All" in the Item text box to "Data" and choose OK until you
  return to the document. The linked data is redisplayed without
  field names.

</PRE>For more information about manipulating linked data, refer to the
manuals for the linked applications.
<P>
 
<P>
<PRE>     DDE Commands and FoxData

</PRE> 
<P>
As a DDE server, FoxData responds to predetermined DDE commands. These
commands are described in the following section. Normally you would build
these commands into the application that is trying to access the data. The
syntax used depends very much on the application that you're using. For
example, Microsoft Excel has INITIATE, REQUEST and TERMINATE commands in
its macro language. Microsoft Word uses DDEInitiate, DDERequest and
DDETerminate from WordBasic. See your application's manual for how to use
DDE with that application. (Note that sometimes you will need to find
additional programming documentation to supplement the manuals that come
with the product. Sometimes the information is in text files supplied on
the application disks.)
<P>
 
<P>
<PRE>   Using FoxData as a DDE Server

</PRE> 
<P>
FoxData supports dynamic data exchange (DDE) as a source (server).
<P>
This section describes the five topics that FoxData supports as a DDE
server and the items that are valid for each topic. The five topics are
&lt;table name&gt;, &lt;query name&gt;, "SQL &lt;expr&gt;", &lt;directory&gt; and "System".
<P>
<P>
&lt;table name&gt; Topic
 
<P>
<PRE>  When requesting the contents of a table, you may specify the
  directory the object is in, followed by a semicolon, the key word
  TABLE, and then the name of an existing table.

  The syntax for this topic is:

       [&lt;path&gt;;]TABLE &lt;table name&gt;

  For example, to request the contents of the Sales table in the
  FoxPro FOXDATA subdirectory, you can type just the name of the
  table or its full path:

      TABLE Sales

      -or-

      c:\FOXPROW\GOODIES\FOXDATA;TABLE Sales

  NOTE: Do not enclose table name in brackets ([]).

  The following table lists the items that are valid with the
  &lt;table name&gt; topic.

  Item         Returns
  -----------------------------------------------------------------

  All          All the data in the table, including field names.
  Data         All rows of data without field names.
  NextRow      The next row in the table or query. When you first
               initiate a channel, NextRow returns the first row. If
               the current row is the last record and you execute
               NextRow, the request fails.
  PrevRow      The previous row in the table or query. If PrevRow is
               the first request over a new channel, the last row of
               the table or query is returned. If the current row is
               the first record, the request for PrevRow fails.
  FirstRow     The data in the first row of the table or query.
  LastRow      The data in the last row of the table or query.
  &lt;fieldname&gt;  The value of field &lt;fieldname&gt; for the current row.
  FieldCount   The number of the fields in the table or query.
  FieldNames   A list of field names.

  The &lt;table name&gt; topic also supports a DDE poke command from
  another application. You can change the contents of a field by
  supplying a field name and the new data value.


</PRE>&lt;query name&gt; Topic
 
<P>
<PRE>  The &lt;query name&gt; topic supports the same items as the &lt;table name&gt;
  topic. To copy a query using FoxData the query output must be
  directed to a table or cursor. When requesting the results of
  a query, you may specify the directory the object is in, followed
  by a semicolon, the key word QUERY, and then the name of an
  existing query.

  The syntax for this topic is:

       [&lt;path&gt;;]QUERY &lt;query name&gt;

  For example, to request the results of the Westsale query in the
  FoxPro FOXDATA subdirectory, you can type just the name of the
  query or its full path:

      QUERY Westsale

      -or-

      c:\FOXPROW\GOODIES\FOXDATA;QUERY Westsale

  NOTE: Do not enclose query names in brackets ([]).

  For a list of items that are valid with the &lt;query name&gt; topic,
  refer to the table of items in the &lt;table name&gt; topic above.


</PRE>"SQL &lt;expr&gt;"
 
<P>
<PRE>  The "SQL &lt;expr&gt;" topic returns the results of the specified SQL
  expression. The syntax for this topic is:

    [&lt;path&gt;;]SQL &lt;sql SELECT statement&gt;

  For example, to select all fields from the Sales table in the
  FoxPro FOXDATA directory, enter:

     c:\FOXPROW\GOODIES\FOXDATA;SQL Select * from Sales;

  To select only the values in the Fourthqtr field in the Sales
  table, enter:

     c:\FOXPROW\GOODIES\FOXDATA;SQL Select Fourthqtr from Sales;

  NOTE: End each SQL statement with a semicolon (;).

  The "SQL &lt;expr&gt;" topic supports the same items as the &lt;table name&gt;
  and &lt;query name&gt; topics.


</PRE>&lt;directory&gt; Topic
 
<P>
<PRE>  &lt;directory&gt; is the directory that contains tables, queries, screens
  and other directory elements. This topic can be a fully qualified
  path. After you initiate a DDE link with a directory, you can
  request a listing of the objects in that directory. Initiating
  this Topic has the effect of setting the default directory to the
  one specified.

  Item          Returns
  ----------------------------------------------------------------

  TableList     A list of .DBF files in the path
  QueryList     A list of .QPR files in the path
  MacroList     A list of .FKY files in the path
  ReportList    A list of .FRX files in the path
  ScreenList    A list of .SPR files in the path
  FormList      Synonym for ScreenList
  ModuleList    A list of .APP and .PRG files in the path


</PRE>"System" Topic
 
<P>
<PRE>  "System" is a standard topic for all Windows applications.
  It returns information about the topics FoxData supports.
  The following table lists the valid items for the "System" topic.

  Item         Returns
  -------------------------------------------------------------

  SysItems     A list of items supported by the topic "System"
  Format       A list of the formats FoxData can copy onto
               the Clipboard
  Status       "Busy" or "Ready"
  &lt;command&gt;    Executes a FoxPro command

        Note: To send a command to FoxData, use the DDEExecute
        statement. Some commands may interfere with the
        internal operation of FoxData. If you wish to send
        extensive command sequences to FoxPro it is probably
        better to write a server to specifically match
        your needs.

</PRE> 
<P>
<PRE>     Installing FoxData as a
     Program Manager Icon

</PRE> 
<P>
To install FoxData as an application in the Microsoft Windows Program
Manager, click on your FoxPro program group window to make it active, then
choose New... from the File menu in Program Manager. In the New Program
Object dialog, choose the New Program Item radio button, then choose OK.
Enter the following information in the Program Item Properties dialog:
<P>
<PRE>  Text Box Name        Enter
  -------------------------------------------------------

  Description          FoxData
  Command Line         c:\foxprow\foxprow.exe foxdata.app
  Working Directory    c:\foxprow\goodies\foxdata

</PRE>Choose the Change Icon... push button. In the Change Icon dialog, choose
the Browse... push button. In the Browse dialog, choose the
C:\FOXPROW\GOODIES\FOXDATA directory, be sure that Icon Files is selected
in the List Files of Type popup, and then select FOXDATA.ICO as the icon
file. Choose OK until you return to the Program Item Properties dialog,
then choose OK to return to the FoxPro program group window in the Program
Manager and view the newly installed FoxData icon. Now when you double-
click on the FoxData icon, FoxPro launches the FoxData application and
displays the FoxData DDE Server dialog.
<P>
 
<P>
<PRE>     More About FoxPro and DDE

</PRE> 
<P>
For more information about using DDE with FoxPro, refer to the "Dynamic
Data Exchange (DDE)" chapter in the FoxPro "Developer's Guide."
<P>
Note that the commands outlined above are modeled on Microsoft Access's DDE
Server functionality and are designed to be compatible. If you are careful
to follow these command standards when you write programs that use FoxData,
you'll be able to use either FoxPro or Microsoft Access to store your data.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b<BR>
KBCategory: kbreadme<BR>
KBSubcategory: FxinteropDde<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
