

<HTML>
<HEAD>
<TITLE>FIX: VFP 3 Form or Class Modified in VFP 5 Loses Method Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163023">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="buglist5.00 FxtoolFormdes vfoxwin vfpfix5.0a kbtool kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Modifying a form created in Visual FoxPro 3.0 or 3.0b may, under certain circumstances, result in temporary or permanent loss of event or method procedure code.  -or-  Instantiating a class created in Visual FoxPro 3.0 or 3.0b may, under certain ci...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA56,QA55,QAPN,QABO,QAB9,QBE7,QBE6,QBV8,QAR4,QAI2,QBWS,QBVV,QABG,QAUR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: VFP 3 Form or Class Modified in VFP 5 Loses Method Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163023</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Modifying a form created in Visual FoxPro 3.0 or 3.0b may, under certain
circumstances, result in temporary or permanent loss of event or method
procedure code.
<P>
-or-
<P>
Instantiating a class created in Visual FoxPro 3.0 or 3.0b may, under
certain circumstances, result in temporary or permanent loss of event or
method procedure code.
<P>
This can happen if both of the following conditions are true:

<UL><LI>Code is contained in method or event procedures within dependent
   controls, such as the following:
<P>
<P><PRE>      - Option buttons in option groups
      - Command buttons in CommandGroups
      - Grid columns in grids or headers within columns
      - Pages in PageFrames
</PRE>
<LI>The Visual FoxPro 3.0x form is modified under Visual FoxPro 5.0 without
   being first run or compiled under Visual FoxPro 5.0, or the Visual
   FoxPro 3.0x class is instantiated under Visual FoxPro 5.0 without being
   first compiled under Visual FoxPro 5.0.
<P>
</UL>This loss of code does not occur if any of the following are true:

<UL><LI>If code is not contained in dependent controls.

<LI>If the Visual FoxPro 3.x form or class is run or instantiated prior to
   modification in Visual FoxPro 5.

<LI>The form or class is compiled with COMPILE FORM or COMPILE CLASSLIB
   before form modification or class instantiation.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Issuing a COMPILE FORM or COMPILE CLASSLIB command against the form or
class library sometimes, but not always, repairs the file in question. If
any other changes are made to the form or class and the form or class is
saved, compiling is not likely to retrieve the lost code.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The format of compiled object code has been changed between Visual FoxPro
3.0x and Visual FoxPro 5.0. Any event or method procedure code is
automatically recompiled when a Visual FoxPro 3.0x form is modified or run
in Visual FoxPro 5.0. Classes created in Visual FoxPro 3.0x must be first
run or compiled in Visual FoxPro 5.0 in order to be modified in Visual
FoxPro 5.0.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Use the following steps to demonstrate the behavior in the Form Designer:

<OL><P><LI>Create a form in Visual FoxPro 3.0b.

<P><LI>Add a command group to the form.

<P><LI>In the Click method of each command button, add a WAIT WINDOW command.

<P><LI>Close the Form Designer and save the form.

<P><LI>Modify the form in Visual FoxPro 5.

<P><LI>Attempt to view the click method code for each of the command buttons.
   They appear empty.

<P><LI>Run the form in Visual FoxPro 5.0, and click on the command buttons. No
   code is executed.
<P>
</OL>In the above example, issuing a COMPILE FORM &lt;form file name&gt; command
repairs the form. More complex forms may or may not be successfully
repaired with COMPILE FORM.
<P>
Use the following steps to demonstrate the behavior in the Class Designer:

<OL><P><LI>Create a class in Visual FoxPro 3.0b based on CommandGroup:
<P>
<P><PRE>      CREATE CLASS cmdgroup OF cmdgrp3 AS COMMANDGROUP
</PRE>
<P><LI>In the Click method of each command button, add a WAIT WINDOW command.

<P><LI>Close the Class Designer and save the class.

<P><LI>Instantiate the class in Visual FoxPro 5.0 by issuing the following
   commands in the Command window or from a program file:
<P>
<P><PRE>      SET CLASSLIB TO cmdgrp3
      x=CREATEOBJECT('cmdgroup')
      x.command1.CLICK()
      RELEASE x
</PRE><P>
   Note that no WAIT WINDOW is executed.

<P><LI>Modify the class:
<P>
<P><PRE>      MODIFY CLASS cmdgroup OF cmdgrp3
</PRE>
<P><LI>Attempt to view the Click method code for each of the command buttons.
   They will appear empty.
<P>
</OL>In the above example, issuing the following:
<P>
<PRE>   COMPILE CLASSLIB cmdgrp3

</PRE></OL>will repair the class. More complex classes may or may not be successfully
repaired with COMPILE CLASSLIB.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: delete program remove object<BR>
Keywords          : buglist5.00 FxtoolFormdes vfoxwin vfpfix5.0a kbtool kbbuglist kbfixlist<BR>
Version           : 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
