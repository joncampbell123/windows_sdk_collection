

<HTML>
<HEAD>
<TITLE>PRB: OLE Word 6 Object Does Not Close Itself in Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130302">
<META NAME="KBModify" CONTENT="1995/10/09">
<META NAME="KBCreate" CONTENT="1995/05/16">
<META NAME="Keywords" CONTENT="kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In the operating environment of Windows NT version 3.5, when you navigate through Visual FoxPro and activate Microsoft Word 6.0 for Windows (the 16- bit version) to edit a  bound  object, the instance of Word does not quit when you skip to the next...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAIH,QAGB,QBWS,QA56,QA55,QAUD,QA5V,QAKR,QAHE,QBJZ,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: OLE Word 6 Object Does Not Close Itself in Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 9, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130302</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the operating environment of Windows NT version 3.5, when you navigate
through Visual FoxPro and activate Microsoft Word 6.0 for Windows (the 16-
bit version) to edit a "bound" object, the instance of Word does not quit
when you skip to the next record or quit Visual FoxPro.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The only way to quit the instance of Word is to use PVIEWER.EXE (a program
provided with the Windows NT Resource Kit) to kill the "NTVDM" process (the
Windows NT 16-bit applications process).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
On a system running Windows NT version 3.5, Workstation:

<OL><P><LI>From the Windows file manager, copy one of the Word 16 templates to the
   Word startup directory. For example, copy PRESENT1.DOT to the
   C:\WORD16\STARTUP directory.

<P><LI>In Visual FoxPro, create a table named Testword.dbf that has
   PRESENT1.DOT as an embedded Word Object in a general field. The easiest
   way to do this is to follow these steps:
<P>
   a. In the Command window, enter the following command:
<P>
<P><PRE>      CREATE TABLE Testword (gfield1 g)
</PRE><P>
   b. Open the Testword table in a Visual FoxPro work area.
<P>
   c. Browse the table, and use the APPEND command to add a blank record to
<P><PRE>      the table.
</PRE><P>
   d. Press ALT+TAB to return to Program Manager. Then start Microsoft
<P><PRE>      Word.
</PRE><P>
   e. In Word, open the PRESENT1.DOT document. This .DOT file is an empty
<P><PRE>      template.
</PRE><P>
   f. Select the entire document. Then from Word's Edit menu, choose Copy
<P><PRE>      to copy the document to the clipboard.
</PRE><P>
   g. Close Word.
<P>
   h. Return to Visual FoxPro.
<P>
   i. Browse the Testword table. Double-click gfield1. An empty edit
<P><PRE>      window will appear.
</PRE><P>
   j. From the Edit menu, choose Paste to copy the contents of PRESENT1.DOT
<P><PRE>      from the clipboard into gfield1. Double-click the empty window. Enter
      some text in the field so it can be seen.
</PRE><P>
   l. Save gfield1. Append two more empty records to the table.

<P><LI>In Visual FoxPro, create a form that has an OLE bound control that is
   bound to the general field in the table created in step 2. Then add a
   command button to the form. Add the following commands to the Click
   method of the command button:
<P>
   SKIP
   THISFORM.Refresh

<P><LI>Close and save the form as TESTWORD.SCX.

<P><LI>Press CTRL+ESC to open the Task Manager. Close all the processes in
   Windows NT except Visual FoxPro, Program Manager, and File Manager.

<P><LI>Go to File Manager. Start PVIEWER.EXE from the WINDOWS\RESKIT directory.
   A dialog box titled "Process Viewer" is presented. All of the processes
   currently active in Windows NT are listed in alphabetical order. Notice
   that there is no process named "NTVDM..."

<P><LI>Press ALT+TAB to return to Visual FoxPro.

<P><LI>If it is not still open, open the TESTWORD.DBF table.

<P><LI>Run the TESTWORD.SCX form by typing the "DO FORM Testword" command in
   the Command window.

<P><LI>Double-click the gfield1 OLE object. Word opens for "in place
<P><PRE>    activation." Press ALT+TAB to switch to the Process Viewer window. Note
    that an entry for "NTVDM..." has been added to the process list. Switch
    back to Visual FoxPro.
</PRE>
<P><LI>Save gfield1, and click the command button to move to the next record.

<P><LI>Press ALT+TAB to switch to the Process Viewer window. Notice that there
<P><PRE>    is still an entry for "NTVDM..."
</PRE>
<P><LI>Switch back to Visual FoxPro. Quit Visual FoxPro.

<P><LI>Return to the Process Viewer. The entry for NTVDM is still there.
<P><PRE>    Select it with the mouse, and click the Kill Process button.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 bound OLE Windows NT hang winword<BR>
KBCategory: kbinterop kbprb<BR>
KBSubcategory: FxinteropWinword<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 9, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
