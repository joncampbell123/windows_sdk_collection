

<HTML>
<HEAD>
<TITLE>BUG: _CLIPTEXT Variable Causes GP Fault in Debug Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123452">
<META NAME="KBModify" CONTENT="1995/11/21">
<META NAME="KBCreate" CONTENT="1994/12/01">
<META NAME="Keywords" CONTENT="kbtool kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A general protection (GP) fault occurs when you store a value that exceeds 254 characters in the _CLIPTEXT system memory variable while attempting to type additional characters in the Debug window.  RESOLUTION  The _CLIPTEXT system memory variable ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QBKN,QAVX,QAKD,QBW6,QA9N,QATX,QAMB,QAEF,QAH4,QAFO,QBE7,QBE6,QAJX,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: _CLIPTEXT Variable Causes GP Fault in Debug Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123452</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A general protection (GP) fault occurs when you store a value that exceeds
254 characters in the _CLIPTEXT system memory variable while attempting to
type additional characters in the Debug window.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The _CLIPTEXT system memory variable has an internal storage limit of 254
characters. To copy larger amounts of text to the clipboard, you must store
the text data to a memory variable as in this example:
<P>
<PRE>   _CLIPTEXT = &lt;Memory Var&gt;

</PRE>This way, you can copy blocks of text exceeding 254 characters to the
clipboard. Also, by storing memory variables to _CLIPTEXT in this manner,
you increase the clipboard capacity based on the amount of memory
available.
<P>
To avoid a GP fault and still use Debug, store the characters into a memory
variable prior to using _CLIPTEXT in the Debug window. The following code
illustrates how the data could be stored prior to using the variable in the
Debug Window.
<P>
* Type the following commands from the Command window;
<P>
<PRE>   MODIFY COMMAND Clipit

   * Program Clipit comments start here.
   * The program will store a replicated value to a memory variable.
   * Then the variable value is stored into the system memory variable
   * called _CLIPTEXT.
   *
   * Initialize memory variables.
   M = 0       &amp;&amp; Multiplier Value
   S = " "     &amp;&amp; String value to replicate
   R = " "     &amp;&amp; Contains the Result of replication.
   CLEAR       &amp;&amp; Clear the initial display screen.
   @ 1,5 SAY "Enter Value for Multiplier " GET M
   @ 3,5 SAY "Enter Symbol to replicate " GET S
   READ
   R = Replicate("&amp;S",(M))
   _CLIPTEXT = R+" ** End of String ** "  &amp;&amp; Store value to _cliptext
   ? _CLIPTEXT                            &amp;&amp; Display Results
   * End of Clipit program.

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start FoxPro for MS-DOS or FoxPro for Windows.

<P><LI>In the Command window, type _CLIPTEXT=REPLICATE("*",255).

<P><LI>Activate the Debug Window.

<P><LI>Press CTRL+V  to paste the cliptext into the Debug Window.

<P><LI>Immediately type 1234567890.

<P><LI>Click the bottom left scroll box of the Debug Window and drag it all the
   way to the right.

<P><LI>You should see ***1u (actually that is an umlaut "u").

<P><LI>When you click the "u," a GP fault occurs in Windows, or an application
   error occurs in MS-DOS.
<P>
</OL>NOTE: After you paste the asterisks, the bottom scroll box does not move
all the way left as it should.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos 2.50 2.50a 2.50b 2.60 2.60a<BR>
buglist2.50 buglist2.50a buglist2.50b buglist2.60 buglist2.60a edit cut<BR>
copy paste GPF<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: FxtoolDebug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
