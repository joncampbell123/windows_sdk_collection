

<HTML>
<HEAD>
<TITLE>Creating a Report for a One-to-Many Relationship </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113178">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/03/28">
<META NAME="Keywords" CONTENT="kbprint kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using FoxPro's Report Writer, you can produce a report that displays records from databases engaged in a one-to-many relationship. In a one-to- many relationship, the parent record prints once and all corresponding (related) child records print out...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWI,QA5V,QAZV,QA7O,QA7N,QBXS,QAKJ,QAOX,QABO,QDI1,QA2Q,QAZZ,QAY2,QAK5,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Creating a Report for a One-to-Many Relationship</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113178</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions  2.0, 2.5, 2.5a, 2.5b
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using FoxPro's Report Writer, you can produce a report that displays
records from databases engaged in a one-to-many relationship. In a one-to-
many relationship, the parent record prints once and all corresponding
(related) child records print out.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code opens the INVOICES and DETAIL database files, sets the
order in the child database based on the INO field, and establishes a one-
to-many relationship. In this example, INVOICES.DBF is the parent database
and DETAIL.DBF is the child database.
<P>
<PRE>   SELECT 1
   USE c:\&lt;foxpro directory&gt;\tutorial\invoices.dbf
   SELECT 2
   USE c:\&lt;foxpro directory&gt;\tutorial\detail.dbf
   SET ORDER TO TAG ino OF c:\&lt;foxpro directory&gt;\tutorial\detail.cdx
   SELECT 1
   SET RELATION TO ino INTO detail ADDITIVE
   SET SKIP TO detail

</PRE>NOTE: If you have a parent-child-grandchild relationship, you will need to
SELECT the parent and SET SKIP TO both the child and the grandchild. For
example:
<P>
<PRE>   SELECT parent
   SET SKIP TO child,grandchild

</PRE>Using the data grouping band is an easy and intuitive method of producing a
one-to-many report. The data grouping must be based on the field that
relates the two databases. In the example above, the invoice number (INO)
field links the INVOICE and DETAIL databases.
<P>
After you have established the previously described one-to-many
relationship, do the following to create a one-to-many report:

<OL><P><LI>In the Command window, type:
<P>
<P><PRE>      CREATE REPORT one_many
</PRE>
<P><LI>Create a data grouping band based on the INVOICES.INO field.

<P><LI>Using the sizing bars, increase the size of the group band, if
   necessary.

<P><LI>Place the INO and CNO fields from the INVOICES database in the data
   grouping band.

<P><LI>Place each field from the DETAIL database in the Detail band of
   the report.

<P><LI>From the Report menu, choose Page Preview.
<P>
</OL>The one-to-many report will be displayed on the page preview screen.
<P>
The data grouping band executes each time the data grouping changes. For
example, when the INO field changes its value, the fields within the data
group header print. This functionality causes the parent record data to
print one time.
<P>
The Detail band of the report contains the fields from the child
(DETAIL.DBF) database. This band executes each time a child record is
available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.00 2.50 2.50a 2.50b<BR>
RWriter<BR>
KBCategory: kbprint kbcode<BR>
KBSubcategory: FxtoolRwriter<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
