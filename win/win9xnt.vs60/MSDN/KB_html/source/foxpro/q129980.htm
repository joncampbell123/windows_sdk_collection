

<HTML>
<HEAD>
<TITLE>Private Data Session Resets the Environment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129980">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1995/05/09">
<META NAME="Keywords" CONTENT="kbenv kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A data session is a set of work areas used by a form, form set, report, or label. This article explains the use of a private data session in a form or form set and the settings it affects.  MORE INFORMATION  When a form or a form set is loaded, it ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QABA,QAPN,QBAO,QAYY,QAK7,QAJQ,QAO4,QAI2,QAL3,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Private Data Session Resets the Environment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129980</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A data session is a set of work areas used by a form, form set, report, or
label. This article explains the use of a private data session in a form or
form set and the settings it affects.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When a form or a form set is loaded, it uses the Default Data session by
default. This means that the work areas and all settings are global. You
can however define private data sessions with your form and form sets by
modifying the DATASESSION property of the form.
<P>
When a data session is private, work areas are private to the object. Thus,
two forms can use the same tables, and the record pointer can move
independently in both forms. This can be particularly useful with the
Visual FoxPro object model, where multiple instances of the same object can
exist and you might need to access multiple records in the same table.
<P>
In addition to scoping work areas, a private data session of a form affects
some SET commands that control the environment. Private data sessions use:

<UL><LI>The default Visual FoxPro settings.
<P>
</UL>Modifying these settings in a program or in the Command window has no
effect on the SET commands if a form has a PRIVATE data session. The
following SET commands are scoped to private data sessions:
<P>
<PRE>   SET ANSI
   SET AUTOSAVE
   SET BLOCKSIZE
   SET CARRY
   SET CENTURY
   SET COLLATE
   SET CONFIRM
   SET CURRENCY
   SET DATABASE
   SET DATE
   SET DECIMALS
   SET DELETED
   SET DELIMITERS
   SET EXACT
   SET EXCLUSIVE
   SET FIELDS
   SET FIXED
   SET LOCK
   SET MARK TO
   SET MEMOWIDTH
   SET MULTILOCKS
   SET NEAR
   SET NULL
   SET PATH
   SET POINT
   SET REFRESH
   SET REPROCESS
   SET SAFETY
   SET SEPARATOR
   SET TALK
   SET UNIQUE

</PRE>If you need to modify the default settings that are used by a form with a
private data session, you can do the following:

<UL><LI>If you have a Data Environment and the AUTOLOADTABLES property is set to
   .T., you can add your SET code in the BEFOREOPENTABLES event handler.
   This event is executed before the tables are opened. The
   BEFOREOPENTABLES event is executed before the Load event of the Form
   Set. For example, if the default setting for TALK is ON, and you want to
   modify this setting while your form is running, type the following in
   the Method for the BEFOREOPENTABLES event:
<P>
<P><PRE>      SET TALK OFF
</PRE>
<LI>If you do not have a DataEnvironment associated with a form, place the
   code in the LOAD event of the form.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 VFoxWin<BR>
KBCategory: kbenv kbtool<BR>
KBSubcategory: FxtoolGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
