

<HTML>
<HEAD>
<TITLE>How To Replace a Text Field Value from a Shortcut Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156086">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/17">
<META NAME="Keywords" CONTENT="kbtool kbui kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows you how to place the value chosen from a shortcut menu choice into a text field of a form.  MORE INFORMATION  The shortcut menu available in Visual FoxPro 5.0 provides a useful method to display choices to a user. Once the user m...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAF0,QDKR,QBT6,QBV4,QANS,QBV8,QAHP,QATX,QAH4,QBWR,QAUD,QANE,QAB9,QAMB,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Replace a Text Field Value from a Shortcut Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156086</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows you how to place the value chosen from a shortcut menu
choice into a text field of a form.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The shortcut menu available in Visual FoxPro 5.0 provides a useful method
to display choices to a user. Once the user makes a choice from the
shortcut menu, the code places the text string from the menu bar into the
text field. Because the shortcut menu disappears after a selection, this
technique presents the user with choices while saving room on the form for
other objects. This technique is useful if you simply want to present a
user with choices and do not need all the functionality of a list or combo
box object.
<P>
The steps listed below illustrate how to create a shortcut menu that
appears when the user right-clicks a text box object:

<OL><P><LI>Create a shortcut menu with the Menu Builder.

<P><LI>Add a menu bar to this menu with the prompt titled "One" (without the
   quotation marks).

<P><LI>Change the Result to Command and add the following code:
<P>
<P><PRE>      _Screen.ActiveForm.Text1.Value=PRMBAR(POPUP(),BAR())
</PRE>
<P><LI>Add another menu bar to the menu with the prompt "Two," change the
   Result to Command, and add the same code listed in step 3.

<P><LI>Generate the menu and name it "Testmenu."

<P><LI>Create a form called Test.scx with the CREATE FORM command and add a
   text box to it.

<P><LI>In the RightClick event of the text box, place the following code:
<P>
<P><PRE>      Do Testmenu.mpr
</PRE>
<P><LI>Execute the form with the DO command, position the cursor over the text
   box, and click the right mouse button. When the menu appears, select the
   bar titled "One." The text box now contains the string value of the
   shortcut menu bar.
<P>
</OL>A DEFINE POPUP command actually creates the shortcut menu; therefore,
several Visual FoxPro functions return information useful to programmers.
For example, the PRMBAR() function returns the text string of the menu bar.
<P>
The syntax of the PRMBAR() function in step 3 needs some clarification. The
PRMBAR() function requires the menu name as its first argument. The POPUP()
function returns the name of the currently active menu. The BAR() function
returns an integer representing the chosen menu bar item.
<P>
"Shortcut" is the default name the Menu Builder assigns to the DEFINE POPUP
command. If you need to change the name of the menu, simply choose Menu
Options from the View menu in the Menu Builder. After you change the name
of the menu and generate the menu code, the POPUP() function automatically
resolves the new name.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbui kbhowto<BR>
KBSubcategory: FxprgGeneral FxtoolMbuilder<BR>
Additional reference words: 5.00 kbdsd vfoxwin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
