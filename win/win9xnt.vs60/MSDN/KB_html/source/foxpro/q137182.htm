

<HTML>
<HEAD>
<TITLE>PRB: List Box Shows .F. from an Empty Array </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137182">
<META NAME="KBModify" CONTENT="1995/09/26">
<META NAME="KBCreate" CONTENT="1995/09/21">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A list box on a form displays .F. when the RowSource property is set to a dimensioned array, as opposed to an array initialized from an SQL statement, a view, or a remote view.  Furthermore, when your redimension the array and pass a value to the n...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAPN,QAVX,QBWS,QAVW,QAKD,QAH4,QAXB,QAD7,QAP2,QAY2,QAUJ,QAH6,QAUD,QAH7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: List Box Shows .F. from an Empty Array</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 26, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137182</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A list box on a form displays .F. when the RowSource property is set to a
dimensioned array, as opposed to an array initialized from an SQL
statement, a view, or a remote view.
<P>
Furthermore, when your redimension the array and pass a value to the new
element, the list box does not reflect the new value.
<P>
<P><h2>CAUSE</h2>
 
<P>
Arrays, by nature, have a default logical (.F.) data type. If the list box
is not properly refreshed, it will not reflect the current values in the
array.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In the Init event for the form, change the data type to match the data
being passed to it. For example, if you are passing a character string to
the first element of the array, issue this command:
<P>
<PRE>   thisform.test(1)=""   &amp;&amp; No spaces between the quotation marks

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Make the array a property of the form. Open your form in the Form Designer.
On the Form menu, click New Property. Then type the name of the array, and
make sure you give it at least one element or row as in this example:
<P>
<PRE>   test(1)

</PRE>Then add the following code to the Load event:
<P>
<PRE>   thisform.test(1)=""   &amp;&amp; This assigns the data type to character.

</PRE>If you run the form at this time, you will observe that the list box is
blank. If you had not set the data type to character in this example, you
would have seen the familiar .F. value displayed.
<P>
You can test this without a form by dimensioning an array from the Command
window:
<P>
<PRE>   DIMENSION test(1)    &amp;&amp; The parenthesis are necessary as well as at
                           least a length of 1.

</PRE>Open the Debug window (on the Tools menu, click Debug Window). In the left
partition of the Debug window, type the following lines in order:
<P>
<PRE>   test(1)
   ALEN(test)
   EMPTY(test)

</PRE>The values for these are .F., 1, and .T. respectively. The first line shows
you the default data type. The second shows you the length or number of
elements (or number of rows in a single-column array) in the array. The
third shows you the results from the evaluation of whether the element is
empty or not.
<P>
In the Command window, type:
<P>
<PRE>   test(1)=""

</PRE>The value in the debug window for test(1) changes to "". This tells you
that it is now a character data type with no string assigned to it. Now you
can apply this to a form in Visual FoxPro.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form. Accept the default form and object names (form1, text1,
   list1, and so on).

<P><LI>Add a text box, a list box, and a command group to the form. The order
   they are added is not important.

<P><LI>On the Form menu, click New Property. Then type test(1) in the Name
   field, and then click OK. This makes the array a property of the form.

<P><LI>Right-click the form, and click Properties.
<P>
   a. In the Properties window, click Methods, and then double-click Init.
<P>
   b. In the open window, type:
<P>
<PRE>      thisform.test(1)=""   &amp;&amp; To assign the data type to character.

</PRE><P><LI>Select the list box from the Object menu in the Properties window.
<P>
   a. Click the Data tab.
<P>
   B. Type thisform.test as the RowSource to establish the source for
<P><PRE>      the data for each row in the list box.
</PRE><P>
   C. Set the RowSource Type to 5 - Array. This establishes the type
<P><PRE>      of source for the values in the list box.
</PRE>
<P><LI>On the Object menu in the Properties window, click Commandgroup1.
   Click the All tab, and change the ButtonCount to 3 from the default
   of 2.
<P>
   a. Click the form. Then select the Commandgroup1 object on the form,
<P><PRE>      and stretch the object vertically to reveal all three buttons.
</PRE><P>
   b. From the Object menu in the Properties window, select Command1 under
<P><PRE>      Commandgroup1.
</PRE><P>
   c. In the Properties window, click the All tab, and select the Caption
<P><PRE>      property. Type UPDATE, and press ENTER.
</PRE><P>
   d. Click the Methods tab, double-click the Click event, and enter this
<P><PRE>      code:
</PRE><P>
<P><PRE>      IF EMPTY(thisform.test(1))
<PRE></PRE>         thisform.test(1)=thisform.text1.value
      ELSE
         x=ALEN(thisform.test)
         x=x+1
         DIMENSION thisform.test(x)
         thisform.test(x)=thisform.text1.value
         thisform.list1.requery
      ENDIF
      thisform.text1.value=""
      thisform.text1.setfocus

      This code checks for a value in test(1). If it is empty, the code
      passes the value from text1 to test(1), the first element of the
      array. Otherwise, it gets the length of the array, adds 1 to it,
      redimensions the array to the new length, and passes the value of
      text1 to it. To refresh the array, it uses the requery method in the
      list1 box. Finally, it sets the value in text to "" (blank) and
      returns to text1.

</PRE><P><LI>On the Object menu in the Properties window, click Command2 under
   Commandgroup1.
<P>
   a. Click the All tab, and type SORT in the Caption property.
<P>
   b. Click the Methods tab, double-click the Click event, and enter
<P><PRE>      this code:
</PRE><P>
<PRE>       =ASORT(thisform.test)    &amp;&amp; Sorts the values in the array
      thisform.text1.value=""  &amp;&amp; Sets the value of text1 to ""
      thisform.text1.setfocus  &amp;&amp; Puts the cursor back in text1
      thisform.list1.refresh   &amp;&amp; Refreshes the list box

</PRE><P><LI>On the Object menu in the Properties window, click Command3 under
   Commandgroup1.
<P>
   a. Click the All tab, and type EXIT in the Caption property.
<P>
   b. Click the Methods tab, double-click the Click event, and enter this
<P><PRE>      code:
</PRE><P>
<PRE>      thisform.release   &amp;&amp; Clears the form from memory and the screen

</PRE><P><LI>Click the red exclamation mark on the Standard toolbar to run the form.
   Click Yes if prompted to save changes.
<P>
   NOTE: When the form came up on the screen, the list box was blank. If
   you had not put the line test(1)="" in the Init event of the form, you
   would see a .F. in the list box.

<P><LI>Enter your last name in the Text1 box, and click UPDATE. Your last name
<P><PRE>    should appear as the first item in the list box.
</PRE>
<P><LI>Enter your first name in the Text1 box, and click UPDATE. Your first
<P><PRE>    name should appear as the first item in the list box.
</PRE>
<P><LI>Enter your middle name in the Text1 box, and click UPDATE. Your middle
<P><PRE>    name should appear as the first item in the list box.
</PRE>
<P><LI>Click the SORT button. You will see the names sorted in alphabetical
<P><PRE>    order.
</PRE>
<P><LI>When you are finished, click EXIT. Your form will disappear.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 26, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
