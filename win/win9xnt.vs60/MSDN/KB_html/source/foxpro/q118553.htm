

<HTML>
<HEAD>
<TITLE>How to Dynamically Change Values in Populated _PDPARMS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118553">
<META NAME="KBModify" CONTENT="1995/04/18">
<META NAME="KBCreate" CONTENT="1994/07/24">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To change values or escape codes in the _PDPARMS array programmatically and have them take effect the next time a print job is sent to the printer, you must use the Xbase version of the non-PostScript printer drivers instead of the C-based driver, ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAOX,QADF,QBXS,QAU9,QAA1,QABX,QDI2,QABA,QAUD,QAGB,QACT,QABG,QAKD,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Dynamically Change Values in Populated _PDPARMS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118553</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, 2.5b, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To change values or escape codes in the _PDPARMS array programmatically and
have them take effect the next time a print job is sent to the printer, you
must use the Xbase version of the non-PostScript printer drivers instead of
the C-based driver, which is DRIVER2.PLB.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When DRIVER2.PLB is used, the _PDPARMS array is populated when the default
printer driver is set. After that, _PDPARMS is not read from memory, and
DRIVER2.PLB, along with the settings saved in the FOXUSER.DBF, controls how
the escape codes are sent to the printer. Therefore, any changes that are
made programmatically to _PDPARMS are ignored.
<P>
To change the printer driver from DRIVER2.PLB to the non-PostScript Xbase
driver, DRIVER.PRG, do the following:

<OL><P><LI>Open the GENPD.PJX project, which is normally found in the
   &lt;FoxPro_directory&gt;\GOODIES\PDRIVERS subdirectory.

<P><LI>Open the GEN_PD.PRG file and search for the following line:
<P>
<P><PRE>      _PDRIVER = "DRIVER.PRG"
</PRE>
<P><LI>Follow the instructions in GEN_PD.PRG that describe how to use the Xbase
   version of the non-PostScript printer driver.

<P><LI>Rebuild the GENPD.APP file and copy it into the main FoxPro directory.
<P>
</OL>The code below demonstrates how to programmatically change to condensed and
bold print by changing the escape codes in _PDPARMS. The array elements
that control condensed and bold printing are _PDPARMS(9) and _PDPARMS(11),
respectively. This code assumes that there is a printer driver named HP3
saved in the Printer Driver Setup dialog box. Note that the escape codes
below are case sensitive.
<P>
<PRE>   ** Begin Code Example **

   SET PDSETUP TO "hp3"
   SET PRINTER TO LPT1
   SET PRINTER ON
   **
    _PDPARMS(9)=CHR(27)+"(s16.6H"      &amp;&amp; Set up for condensed print.
   _PDPARMS(11)=CHR(27)+"(s3B"         &amp;&amp; Turn on bold.
   **
   ?"This is a test of printing in BOLD and CONDENSED."
   **
   _PDPARMS(9)=CHR(27)+"(s10H"         &amp;&amp; Return to normal printing.
   _PDPARMS(11)=CHR(27)+"(s0B"         &amp;&amp; Not bold.
   **
   ?"Now return to normal printing"
   **
   SET PRINT OFF
   SET PRINT TO

   ** End Code Example **

</PRE></OL>For a listing of the array elements in _PDPARMS, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q95309.htm">Q95309</A></B>
   TITLE     : How _PDPARMS Array Is Created for a Printer Driver
               Setup
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 2.50a 2.50b 2.60 pdparms<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 18, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
