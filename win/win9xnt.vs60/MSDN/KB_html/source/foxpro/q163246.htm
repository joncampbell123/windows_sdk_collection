

<HTML>
<HEAD>
<TITLE>PRB: Visual FoxPro Loses Graphing when Office 97 Removed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163246">
<META NAME="KBModify" CONTENT="1997/02/07">
<META NAME="KBCreate" CONTENT="1997/02/06">
<META NAME="Keywords" CONTENT="kbinterop kbole kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The following symptoms may occur:   - When modifying or building a query with a graph as the destination,    you see the following message:        MSGraph does not appear to be installed properly. Graph could not       be made.   - You need to plac...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QAA1,QA9N,QACI,QDH6,QANJ,QDI2,QBVV,QAW6,QDKD,QA56,QA55,QAPN,QDNE,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual FoxPro Loses Graphing when Office 97 Removed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163246</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following symptoms may occur:

<UL><LI>When modifying or building a query with a graph as the destination,
   you see the following message:
<P>
<P><PRE>      MSGraph does not appear to be installed properly. Graph could not
      be made.
</PRE>
<LI>You need to place a graph as an insertable object in an OLE Container
   Control on a form, but the Insert Object dialog box does not show
   Microsoft Graph as an insertable object.

<LI>When building a query, the graph icon in the Query Destination dialog
   box cannot be selected.
<P>
</UL><h2>CAUSE</h2>
 
<P>
The Office 97 setup process replaces Graph5 with Graph8 as the association
for .gra extension files.
<P>
Removing Office 97 entirely leaves the registry without any reference to a
graphing tool associated with the .gra extension. Visual FoxPro cannot find
a graphing tool to use in graphing the results of a query.
<P>
Using the "Add/Remove software" functions of Windows 95 or WindowsNT to
remove only Graph8 does not remove those files nor the registry entries.
<P>
Removing Office 97 removes all references to the graph files previously
installed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
One alternative for resolving this is to re-install Office 97. If the
system should not have Office 97, then remove all portions of Office 97
except Graph and Graph Help.
<P>
Another alternative is to install or reinstall Office 95. That will
reinstall and re-register MS Graph5.
<P>
Re-installing MS Graph5 from the Visual FoxPro distribution disk does not
solve the problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Existing graphs stored in general fields display correctly when the table
is opened and browsed and the general field is double-clicked. The
presentation data stored as part of the "Binary Large Object Bitmap"
contents of the general field contains the information to render the
embedded OLE document--that is, the graph.
<P>
Double-clicking that displayed image results in the following error
message:
<P>
<PRE>   OLE error code 0x80040154: Class is not registered.

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>On a Windows 95 or Windows NT system, install Microsoft Office 97.

<P><LI>Uninstall Office 97.

<P><LI>Open Visual FoxPro, and make a new form.

<P><LI>Click the OLE Container Control tool on the Forms toolbar.

<P><LI>In the Insert Object dialog box, examine the list of insertable objects.
   MS Graph does not appear as a choice.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbole kbtool kbprb<BR>
KBSubcategory: FxinteropGeneral FxtoolQueryvwdes vfoxwin<BR>
Additional reference words: 3.00 3.00b 5.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
