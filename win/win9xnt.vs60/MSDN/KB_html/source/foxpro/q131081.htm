

<HTML>
<HEAD>
<TITLE>How to Set Object's BackColor to Button Face's BackColor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131081">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/06/02">
<META NAME="Keywords" CONTENT="kbtool kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to set the BackColor of an object to the current button-face color. You can use this in a program to change the BackColor of the form or form page color to match that of the button face or 3D color.  MORE INFORMATI...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QBWS,QAO4,QAG9,QBXS,QAB9,QAI2,QA5D,QA2Q,QAW6,QAG2,QAJD,QAQ7,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Set Object's BackColor to Button Face's BackColor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131081</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to set the BackColor of an object to the
current button-face color. You can use this in a program to change the
BackColor of the form or form page color to match that of the button face
or 3D color.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example Using Code</h3>
 
<P>
The following program displays a form that contains one command button
(Button1). The code in the Click procedure sets the BackColor of the form
to the current BackColor of the button face.

<OL><P><LI>From the File menu, choose New. Select the Program option, and choose
   the New File button to bring up the Modify Program window.

<P><LI>Enter the following code:
<P>
   oMyForm = CREATEOBJECT("MyForm")
   oMyForm.show
   READ EVENTS
<P>
   DEFINE CLASS MyForm AS FORM
<P>
<P><PRE>      ADD OBJECT Button1 AS COMMANDBUTTON WITH ;
<PRE></PRE>         caption="QUIT"

      PROCEDURE Click
         Local cColor cRGB
         m.cRGB = RGBSCHEME(1,2)
         m.cColor = 'RGB(' + SUBSTR(m.cRGB, AT(',', m.cRGB, 3) +1)
         This.BackColor = EVAL(cColor)
      ENDPROC

      PROCEDURE button1.Click
         CLEAR EVENTS
      ENDPROC
   ENDDEFINE

</PRE><P><LI>Save the Program, and run it. When the form displays, click an area of
   the form to see the BackColor of the form change to the BackColor of the
   button.
<P>
</OL><h3>Step-by-Step Example Using the Form Designer</h3>
 
<P>
To add this functionality to a Form by using the Visual FoxPro Form
Designer, follow these steps:

<OL><P><LI>Add a command button to the form by using the Form Control Toolbar.

<P><LI>Using the secondary (right) mouse button, click the new command button
   object. Select Properties from the menu that appears.

<P><LI>Select the Layout tab in the Properties dialog box. Change the Caption
   property to QUIT.

<P><LI>Select the Methods tab in the Properties dialog box, and double-click
   the Click event to open the Code window for the Click Procedure of
   the command button. In the Code window for the Click event, type:
<P>
   THISFORM.RELEASE
<P>
   NOTE: This code differs from that used in the code example. The command
   THISFORM.RELEASE is used instead of CLEAR EVENTS because the READ EVENTS
   is not used to keep the form in memory when DO FORM &lt;formname&gt; is used.

<P><LI>Using the primary (left) mouse button, double-click the Form to open the
   Code window for the different events available for the Form.

<P><LI>Select Click from the Procedure list, and add the following code to this
   Click event:
<P>
   Local cColor cRGB
   m.cRGB = RGBSCHEME(1,2)
   m.cColor = 'RGB(' + SUBSTR(m.cRGB, AT(',', m.cRGB, 3) +1)
   This.BackColor = EVAL(cColor)

<P><LI>Save the Form, and run it.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
