

<HTML>
<HEAD>
<TITLE>How to Pass an Array to a Routine in an LCK Library </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119636">
<META NAME="KBModify" CONTENT="1995/08/28">
<META NAME="KBCreate" CONTENT="1994/08/18">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are writing libraries using the FoxPro Library Construction Kit (LCK), you can pass variables or array elements to a function in the library. You can also pass an array by reference into an library function. Once the reference is passed, e...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIJ,QAH6,QAH7,QAD7,QBHQ,QDIV,QAH4,QAKD,QAY5,QAIC,QBWS,QBSO,QA6A,QAK9,QAKC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Pass an Array to a Routine in an LCK Library</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119636</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro Library Construction Kit for MS-DOS,
   versions 2.0, 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro Library Construction Kit for Windows,
   versions 2.5, 2.5a, 2.5b, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you are writing libraries using the FoxPro Library Construction Kit
(LCK), you can pass variables or array elements to a function in the
library. You can also pass an array by reference into an library function.
Once the reference is passed, each element can be accessed from within the
library routine. The code to do this is shown below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<PRE>   /* C code that creates the DLL. */

   #include &lt;windows.h&gt;
   #include &lt;pro_ext.h&gt;

   /* The Putback() function is optional. It sends the element of the
      array back to the FoxPro screen so you can see that the routine
      has found the array element. */

   void Putback(long arr_element)
   {
        Value val;

        val.ev_type = 'I';
        val.ev_width =10;
        val.ev_long = arr_element;
        _PutStr("\nThe current value is -");
        _PutValue(&amp;val);
   }



   void FAR load_array(ParamBlk FAR *parm)
   {
        int     start;         /* Starting value of Loop. */
        long    array[50];     /* Create array to hold FoxPro array. */
        Value   val;           /* Create Value structure. */
        Locator loc;           /* Create Locator structure. */

        start=0;
        loc = parm-&gt;p[0].loc;  /* Store the contents of the FoxPro array
                                  in the Locator structure. */

        /* Get the number of elements from the FoxPro array. */

        loc.l_subs = (int)_ALen(parm-&gt;p[0].loc.l_NTI, AL_ELEMENTS);

        /* FOR loop to get the array elements. */

        for(start=0;start != loc.l_subs ; start ++){
           loc.l_sub1=(start+1);

        /* Store the contents of the FoxPro array in a Value Structure. */
           _Load(&amp;loc,&amp;val);

        /* Copy the contents of the FoxPro array to the function array.*/
             array[start]=val.ev_long;

             Putback(array[start]); /* Calls the structure Putback. */
   }
   }

   FoxInfo myFoxInfo[]={
      {"LOAD_ARRAY",(FPFI)load_array,1,"R"},
   };

   FoxTable _FoxTable={
      (FoxTable FAR*)0, sizeof(myFoxInfo) / sizeof(FoxInfo), myFoxInfo
   };

   /* End of C code. */

</PRE>This code is used in FoxPro:
<P>
<PRE>   SET LIBRARY TO lckarray.dll
   DIMENSION foxarray(5)
   foxarray(1)=10
   foxarray(2)=20
   foxarray(3)=30
   foxarray(4)=40
   foxarray(5)=50
   ? load_array(@foxarray)

</PRE>There will be a .T. at the end of the elements listed. This should not
cause a problem since passing the elements back to FoxPro is not necessary.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos LCK 2.00 2.50 2.50a 2.50b 2.60<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxtoolLck<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
