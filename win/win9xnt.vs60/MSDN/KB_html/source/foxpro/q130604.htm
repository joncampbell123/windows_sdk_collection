

<HTML>
<HEAD>
<TITLE>How to Retrieve Table Properties in a Program </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130604">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/05/23">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Visual FoxPro introduces new table properties (triggers, validation rules, and comments) that are available to fields in tables that belong to databases. This article describes how to look up these table properties by using a program.  MORE INFORMA...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QATP,QAPN,QAY5,QAMB,QAKR,QBV8,QAB9,QARR,QAUD,QAIB,QALW,QDI1,QAZZ,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Retrieve Table Properties in a Program</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130604</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual FoxPro introduces new table properties (triggers, validation rules,
and comments) that are available to fields in tables that belong to
databases. This article describes how to look up these table properties by
using a program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The new properties are available only if the table belongs to a database.
You can use the DISPLAY DATABASE and LIST DATABASE commands to view, list
to a file, or print all the table properties. The following examples apply
only to the case where you want a program to retrieve the table properties
to store in variables or for some other purpose.
<P>
<P><h3>Validation Rule</h3>
 
<P>
Use the AFIELDS() or DBGETPROP() function to obtain the value of the
Validation Rule table property.
<P>
AFIELDS() places information about the table structure into an array.
The syntax for AFIELDS() is:
<P>
<PRE>   cResult=AFIELDS(ArrayName[,TableName | WorkArea])

</PRE>Parameters:

<UL><LI>ArrayName specifies a pre-existing array or a new array.

<LI>TableName or WorkArea is optional. if a table name or work area is not
   provided, Visual FoxPro populates the array with data from the current
   work area.
<P>
</UL>AFIELDS() creates a multi-dimensional array, the Validation Rule is stored
in column 10. The following example retrieves the Validation Rule from a
table named MYDATA.DBF:
<P>
<PRE>   cResult=AFIELDS(myarray,mydata)
   ?myarray(1,10)

</PRE>DBGETPROP() retrieves several table properties. The following example shows
how to return the Validation Rule of a table by using the DBGETPROP()
function:
<P>
<PRE>   cResult=DBGETPROP('mydata', 'TABLE', 'RuleExpression')

</PRE>In this example:

<UL><LI>mydata is the table name.

<LI>TABLE specifies that the property you want is a table property.

<LI>RuleExpression is the property you want.
<P>
</UL><h3>Validation Text</h3>
 
<P>
Use the AFIELDS() or DBGETPROP() function to obtain the value for the
Validation Text table property.
<P>
AFIELDS() creates a multi-dimensional array, the Validation Text is stored
in column 11. The following example retrieves the Validation Text for a
table named MYDATA.DBF:
<P>
<PRE>   cResult=AFIELDS(myarray,mydata)
   ?myarray(1,11)

</PRE>The following example shows how to return the Validation Text of a table
by using the DBGETPROP() function:
<P>
<PRE>   cResult=DBGETPROP('mydata', 'TABLE', 'RuleText')

</PRE><h3>Insert Trigger</h3>
 
<P>
Use the DBGETPROP() function to obtain the Insert Trigger, as in this
example:
<P>
<PRE>   cResult=DBGETPROP('mydata', 'TABLE', 'InsertTrigger')

</PRE><h3>Update Trigger</h3>
 
<P>
Use the DBGETPROP() function to obtain the Update Trigger, as in this
example:
<P>
<PRE>   cResult=DBGETPROP('mydata', 'TABLE', 'UpdateTrigger')

</PRE><h3>Delete Trigger</h3>
 
<P>
Use the DBGETPROP() function to obtain the Delete Trigger, as in this
example:
<P>
<PRE>   cResult=DBGETPROP('mydata', 'TABLE', 'DeleteTrigger')

</PRE><h3>Table Comments</h3>
 
<P>
Use the DBGETPROP() function to obtain the Table Comments:
<P>
<PRE>   cResult=DBGETPROP('mydata', 'TABLE', 'Comment')

</PRE><h3>Primary Key</h3>
 
<P>
Use the DBGETPROP() function to obtain the tag name of a Primary key, as in
this example:
<P>
<PRE>   cResult=DBGETPROP('mydata', 'TABLE', 'PrimaryKey')

</PRE><h3>Path</h3>
 
<P>
Use the DBGETPROP() or DBF() function to obtain the path to the table. The
following example shows how to return the path of a table by using the
DBGETPROP() function:
<P>
<PRE>   cResult=DBGETPROP('mydata', 'TABLE', 'Path')

</PRE>To obtain the path to a table by using the DBF() function, SET FULLPATH
must be used, as in this example:
<P>
<PRE>   SET FULLPATH ON
   cResult=DBF('mydata')
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
