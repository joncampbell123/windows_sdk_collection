

<HTML>
<HEAD>
<TITLE>PRB: FoxPro Converts Excel TIME Formatted Data to Numeric </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119404">
<META NAME="KBModify" CONTENT="1995/06/26">
<META NAME="KBCreate" CONTENT="1994/08/15">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are APPENDing or IMPORTing FROM an .XLS file that has a field with the TIME format h:mm:ss into a character field in a .DBF file, the data will appear to be converted to a numeric equivalent in a character field.  For example, a worksheet ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QACE,QAU3,QAMR,QA7O,QA7N,QAFH,QAYY,QAUD,QAPF,QAH4,QDNG,QAI4,QA4Q,QAY4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: FoxPro Converts Excel TIME Formatted Data to Numeric</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 26, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119404</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are APPENDing or IMPORTing FROM an .XLS file that has a field with
the TIME format h:mm:ss into a character field in a .DBF file, the data
will appear to be converted to a numeric equivalent in a character field.
<P>
For example, a worksheet cell formatted as TIME h:mm:ss in Microsoft Excel
that contains 8:33:00 when appended into a FoxPro character field will
appear as 0.35625. In fact, 8:33:00 is 35.625% of 24 hours.
<P>
The information that you see as "numeric" in the character field is in fact
exactly how Microsoft Excel stores the data in its cells. The display that
we see as 8:33:00 in Microsoft Excel is Microsoft Excel's representation of
a TIME formatted field; that is, the Microsoft Excel cell actually contains
0.35625, not 8:33:00.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The following code sample may be of assistance for making the time data
usable within FoxPro.
<P>
IMPORTANT: The following code has not been fully tested.
<P>
<PRE>   * NUM2TIME.PRG
   * ------------
   *
   * Syntax    : NUM2TIME(&lt;ExpN1&gt;, &lt;ExpN2&gt;)
   * Parameters: &lt;ExpN1&gt; Percentage of 24 hours
   *           : &lt;ExpN2&gt; 12 or 24 (clock type)
   * Returns   : Character
   * Default   : 24 Hour clock
   *
   * This procedure accepts a numeric parameter that
   * represents a percentage of 24 hours. For example
   * it will convert .75000 to 18:00:00 or 06:00:00p
   * depending on the value of &lt;ExpN2&gt;. This is the
   * format that time data imported from a Microsoft
   * Excel spreadsheet will appear in for example.
   *
   * This function will provide granularity up to one
   * second. The number passed into m.Deltanum should
   * extend to five decimal places.
   *
   * VALID input range for &lt;ExpN1&gt; ranges from 0.0
   * through 0.99999.
   * ------------------------------------------------
   PARAMETERS m.deltanum, m.clocktype
   IF m.deltanum &gt;= 0.00 AND m.deltanum &lt;= 0.999999999999999
      m.hrs = ALLTRIM(STR(INT(((86400*m.deltanum)/60)/60)))
      m.min = ALLTRIM(STR(INT((86400*m.deltanum)/60);
         -(VAL(m.hrs)*60)))
      m.sec = ALLTRIM(STR(INT((86400*m.deltanum);
         -((VAL(m.hrs)*60)*60)-(VAL(m.min)*60))))
      IF m.clocktype = 12
         m.pm = .F.
         IF VAL(m.hrs) &gt;12
            m.hrs = ALLTRIM(STR(VAL(m.hrs)-12))
            m.pm = .T.
         ENDIF
         m.ret = IIF(LEN(m.hrs)=2,m.hrs,'0'+m.hrs)+':';
            +IIF(LEN(m.min)=2,m.min,'0'+m.min)+':';
            +IIF(LEN(m.sec)=2,m.sec,'0'+m.sec);
            +IIF(m.pm,'p','a')
      ELSE
         m.ret = IIF(LEN(m.hrs)=2,m.hrs,'0'+m.hrs)+':';
            +IIF(LEN(m.min)=2,m.min,'0'+m.min)+':';
            +IIF(LEN(m.sec)=2,m.sec,'0'+m.sec)
      ENDIF
   ELSE
      m.ret = '**:**:**'
   ENDIF
   RETURN m.ret
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.60<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: FxinteropSpread<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 26, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
