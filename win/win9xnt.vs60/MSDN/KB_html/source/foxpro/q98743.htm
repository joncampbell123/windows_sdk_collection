

<HTML>
<HEAD>
<TITLE>ERR: "Not a Database File"; How to Modify Database Header </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98743 ">
<META NAME="KBModify" CONTENT="1997/12/22">
<META NAME="KBCreate" CONTENT="1993/05/12">
<META NAME="Keywords" CONTENT="FxinteropDbase kberrmsg kbother">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When FoxPro returns the error message  Not a Database File,  you can sometimes correct the damaged file's header by using a hexadecimal file editor.  WARNING: Before attempting to modify a database in this way, it is STRONGLY recommended that you b...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA7O,QA7N,QALG,QAZV,QBVV,QAGC,QALX,QAB4,QAKC,QAG8,QDI1,QBC6,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ERR: "Not a Database File"; How to Modify Database Header</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98743 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.60 3.00 5.00 | 2.00 2.5x 2.60
<PRE>WINDOWS             | MS-DOS
</PRE>kbother kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When FoxPro returns the error message "Not a Database File," you can
sometimes correct the damaged file's header by using a hexadecimal file
editor.
<P>
WARNING: Before attempting to modify a database in this way, it is STRONGLY
recommended that you back up the database.
<P>
The structure of the database file header is given below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The "Not a database file" error message in FoxPro 2.x may be caused by a
record count value in the table header that is greater than the actual
number of records. The Hexedit.app, distributed with Visual FoxPro 5.0 may
be used in an attempt to correct the record count. In the Hexedit.app, a
hexadecimal representation of the record count may be found at Address:
0000000 in columns 4, 5, 6, and 7. Use the calculator in Windows 95 or
Windows NT to convert from decimal to hexadecimal and remember to reverse
the order of the numbers as per this article.
<P>
For information about performing table maintenance using FoxPro low-level
file functions, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q135905.htm">Q135905</A></B>
   TITLE     : How to Retrieve Records that were Previously Zapped

   ARTICLE-ID: <B><A href="../foxpro/q139758.htm">Q139758</A></B>
   TITLE     : How to Modify the Table Header from FoxPro

</PRE>**********************************************************************
WARNING: ANY USE BY YOU OF THE INFORMATION PROVIDED IN THIS ARTICLE IS
AT YOUR OWN RISK. Microsoft provides this information "as is" without
warranty of any kind, either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness
for a particular purpose.
**********************************************************************
<P>
The table below identifies the bytes in the first part of the header:
<P>
<PRE>   Byte number   Description
   -------------------------------------------------------------

   1             File-type identifier:
                    03 - DBF without memo (FoxBASE+/FoxPro/dBASE
                         III PLUS/dBASE IV)
                    83 - DBF with memo (FoxBASE+/dBASE III PLUS)
                    8B - dBASE III with memo
                    F5 - FoxPro with memo
   2-4           Date of last update (YYMMDD)
   5-8           Number of records in file*
   9-10          Offset to start of data**
   11-12         Size of record***
   13-28         Not used
   29            Flag for compound index****
   30-32         Not used

   * The number of records in the database is stored in reverse
     format. In other words, if those bytes were equivalent to F4 01
     00 00, there would be 500 records in the database. 1F4h is the
     hexadecimal equivalent of decimal 500.

  ** The offset to the start of the data is computed from the
     beginning of the file to the first data record. It also is stored
     in reverse format. For example, if bytes 9 and 10 are 41 02, the
     first data record would begin at 241h, or 577 decimal bytes from
     the beginning of the file.

 *** The size of the record also is stored in reverse format; the
     number represents the sum of the field sizes plus 1 because of
     the deletion flag.

</PRE>**** The flag for the compound index will be 01h if there is a
<PRE>     structural .CDX file attached to the database, and 00h if there
     is not an associated structural .CDX file.

</PRE>The second part of the header depends on the number of fields in the
database. Each field uses 32 bytes. There is also a single terminating
byte (0Dh) at the very end.
<P>
The field definition is as follows:
<P>
<PRE>   Byte number   Description
   ------------------------------------------------------

   1-11          Field name
   12            Field type
                 Character 43h
                 Date      44h
                 Logical   4Ch
                 Memo      4Dh
                 Numeric   4Eh
   13-14         Offset of field from beginning of record
   15-16         Not used
   17-18         Field length (nonnumeric fields)
   17            Field length (numeric fields)
   18            Field decimals (numeric fields)
   19-32         Not used

</PRE>FoxPro limits field names to ten characters; thus the eleventh byte, or the
last (rightmost) byte, after the field name, must be null (00h). The field
length is dependent upon the data type. Character fields use the
seventeenth and eighteenth bytes, in reverse format.
<P>
Memo, date, and logical fields, which have fixed lengths of 10, 8, and 1,
respectively, need only the first byte (17). The remaining bytes are
generally nulls. However, keep in mind that there is a terminating byte of
0Dh at the very end of the header.
<P>
After the terminating 0Dh byte, the actual database data begins. The first
byte of each record is the deletion flag. If the record has been deleted,
but not packed, this byte will be 2Ah (an ASCII asterisk); otherwise, it is
20h (an ASCII space).
<P>
For DBF files created in Visual FoxPro for Windows, or 2.x DBF files added
to a Database Container (DBC), the backlink information is stored between
byte 0DH and the beginning of the data.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"FoxPro Version 2 Programming Guide," Chapter 11, by Michael Antonovich
FoxPro for MS-DOS "Developer's Guide," version 2.0, Appendix B
FoxPro for MS-DOS "Update," version 2.5, pages 4-20 to 4-21
FoxPro for Windows "Developer's Guide," version 2.5, Appendix A
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 VFoxWin 3.00 FoxDos FoxWin 2.00 2.50 2.50a<BR>
errmsg err msg repair corrupt not a table/dbf 2.50b 2.60<BR>
KBCategory: kbother kberrmsg<BR>
KBSubcategory: FxinteropDbase<BR>
Keywords          : FxinteropDbase kberrmsg kbother<BR>
Version           : 2.5x 2.60 3.00 5.00 | 2.00 2.5x<BR>
Platform          : MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
