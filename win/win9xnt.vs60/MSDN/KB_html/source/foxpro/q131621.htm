

<HTML>
<HEAD>
<TITLE>How to Hide the "FoxPro Run Command" Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131621">
<META NAME="KBModify" CONTENT="1995/09/14">
<META NAME="KBCreate" CONTENT="1995/06/14">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  By using the FOXTOOLS.FLL library that ships with FoxPro, you can execute an MS-DOS command or program without seeing the  FoxPro Run Command  window or another MS-DOS session. This is done by registering and calling the Windows API WinExec() funct...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB9,QBV8,QAH4,QBWS,QAY5,QAGI,QAGB,QABH,QABI,QAGQ,QAPF,QAVI,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Hide the "FoxPro Run Command" Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 14, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131621</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By using the FOXTOOLS.FLL library that ships with FoxPro, you can execute
an MS-DOS command or program without seeing the "FoxPro Run Command" window
or another MS-DOS session. This is done by registering and calling the
Windows API WinExec() function as demonstrated in this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following program creates a sample function that executes an MS-DOS
command or program and keeps the MS-DOS window hidden. The program takes
one parameter, the command to be executed.
<P>
To maintain control over the MS-DOS window, the program sends the command
through a PIF file. To keep this window hidden, use the Windows PIF Editor
to make the following changes to the PIF file you use (this example uses
FOXRUN.PIF in the FoxPro directory):

<OL><P><LI>Select the "Close Window on Exit" check box.

<P><LI>Set "Display Usage" to "Windowed."
<P>
</OL><h3>Code Sample</h3>
 
<P>
*-------------------- RUN.PRG -----------------------
* Sample program to Execute an MS-DOS command and keep
* the MS-DOS window hidden.
*
* To use this function in FoxPro to create a new directory,
* use one of the following two commands that illustrate two
* ways to call the function and achieve the same result:
*
*    =RUN("MD C:\FPW26\TESTDIR")
*
*    DO RUN WITH "MD C:\FPW26\TESTDIR"
*
<P>
FUNCTION run
PARAMETER doscmd
<P>
SET LIBRARY TO SYS(2004)+"foxtools.fll" ADDITIVE
<P>
winexec = REGFN("WinExec", "CI", "I")
<P>
* To have control over the visibility of the
* MS-DOS command, call it through a PIF file.
<P>
* IMPORTANT: (1) Be sure the "Close Window on Exit" check box in
* in the PIF file is selected. (2) Be sure "Windowed" is the
* selected "Display Usage."
<P>
cmdstart = SYS(2004)+"FOXRUN.PIF /C "
<P>
* Now concatenate the 2 pieces of the command:
<P>
fullcmd = cmdstart + doscmd
<P>
retval = CALLFN(winexec, fullcmd, 0)
<P>
RELEASE LIBRARY SYS(2004)+"foxtools.fll"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.60a FoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 14, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
