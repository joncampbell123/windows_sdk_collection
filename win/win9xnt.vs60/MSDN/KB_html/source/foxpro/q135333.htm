

<HTML>
<HEAD>
<TITLE>PRB: Decimals Don't Display Properly in Grid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135333">
<META NAME="KBModify" CONTENT="1995/08/22">
<META NAME="KBCreate" CONTENT="1995/08/20">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Numbers displayed in a grid show four decimal places instead of two.  CAUSE =====  The Grid.Column.Sparse property is not set to false, and there is no InputMask property defined for the Textbox object of the grid.  RESOLUTION  For the column that ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBXS,QBV4,QBT6,QAYY,QARR,QABA,QAHP,QACI,QBWC,QA7O,QA4F,QBAO,QAW6,QAL3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Decimals Don't Display Properly in Grid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 22, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135333</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Numbers displayed in a grid show four decimal places instead of two.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Grid.Column.Sparse property is not set to false, and there is no
InputMask property defined for the Textbox object of the grid.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
For the column that is used to display the numeric data, set the Sparse
property to false, and enter a valid input mask for the Textbox object.
Note that setting the Sparse property to false can result in some
performance degradation.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Numeric fields in a table can have two to nine decimal places. Currency
fields have an automatic default of four decimal places. When displaying
any numeric or currency information in a grid, it is necessary to set two
properties of the grid to limit the display to two and only two decimal
places.
<P>
The first property is the Sparse value. By default, the Sparse property is
set to true. According to the information in the Visual FoxPro Help file,
the Sparse property specifies whether the CurrentControl property affects
all or only the active cell in a Column object.
<P>
When the Sparse property is set to true, only the column's active cell uses
the CurrentControl property setting to accept and display data. The other
cells use the default text box. If the Sparse property is set to false, all
cells in the Column object will use the CurrentControl property setting to
display data.
<P>
The second property that must be set is the InputMask, which governs how
data is entered and displayed in a control. A grid is a combination of
several different objects including a text box, so it is necessary to apply
some kind of an input mask to the grid text box control. In this situation,
a valid input mask would consist of the following:
<P>
<PRE>   999,999,999.99

</PRE>Setting both of these properties allows the desired level of control when
displaying numeric data in a grid. The setting of the DECIMALS value, such
as SET DECIMALS TO 2, has no effect on the data displayed in the grid.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form.

<P><LI>Add the Orders table to the form's data environment.

<P><LI>Drag the table from the data environment to the form. A grid will
   automatically be created.

<P><LI>Run the form.
<P>
</OL>The data shown in the Order_amt field will display data with four decimal
places. Following the steps outlined in this article will result in the
data being displayed with two decimal places.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 decimals currency<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGrid<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 22, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
