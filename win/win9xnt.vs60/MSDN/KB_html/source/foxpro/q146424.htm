

<HTML>
<HEAD>
<TITLE>PRB: "Entry point GetFreeSystemResources not found" Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146424">
<META NAME="KBModify" CONTENT="1996/02/20">
<META NAME="KBCreate" CONTENT="1996/02/15">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A method for obtaining Windows system resources is described in the following Microsoft Knowledge Base article:     ARTICLE-ID: Q111508    TITLE     : How to Check Available Windows System Resources  If this method is used under Windows 95 or Windo...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QBWP,QAIM,QAY5,QAUD,QBC9,QBC8,QANO,QABH,QAGU,QABI,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Entry point GetFreeSystemResources not found" Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146424</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A method for obtaining Windows system resources is described in the
following Microsoft Knowledge Base article:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q111508.htm">Q111508</A></B>
   TITLE     : How to Check Available Windows System Resources

</PRE>If this method is used under Windows 95 or Windows NT, the following error
occurs when the function is registered with RegFn():
<P>
<PRE>   Entry point GetFreeSystemResources not found

</PRE><h2>CAUSE</h2>
 
<P>
The GetFreeSystemResources function is not contained in the API libraries
searched by default.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In the RegFn function, you need to explicitly reference User.exe where this
API function is contained.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
This is a modification of the code example in article <B><A href="../foxpro/q111508.htm">Q111508</A></B>. Enter the
following commands into a program file, and run the file:
<P>
* Beginning of Check System Resources program
<P>
<PRE>   LOCAL nGetSysRes, nRetVal

   #DEFINE sysreso 0
   #DEFINE gdireso 1
   #DEFINE userreso 2

   * Load the FOXTOOLS.FLL library
   SET LIBRARY TO HOME() + "FOXTOOLS.FLL" ADDITIVE

   * Call RegFN() to register the GetFreeSystemResources() function
   nGetSysRes = RegFn("GetFreeSystemResources", "I","I")

   * If RegFn() returned a value that is greater than -1, it can be
   * assumed that the function was successfully registered.
   IF nGetSysRes &gt; -1
      nRetVal = CallFn(nGetSysRes, sysreso)
      WAIT WINDOW "Free System Resources:"+STR(nRetVal,3,0)+"%" TIMEOUT 1
      nRetVal = CallFn(nGetSysRes, gdireso)
      WAIT WINDOW "Free GDI Resources:"+STR(nRetVal,3,0)+"%"  TIMEOUT 1
      nRetVal = CallFn(nGetSysRes, userreso)
      WAIT WINDOW "Free User Resources are:"+STR(nRetVal,3,0)+"%" TIMEOUT 1
   ENDIF

   * Unload FOXTOOLS.FLL from memory

   RELEASE LIBRARY HOME()+ "FOXTOOLS.FLL"

</PRE>* End of Check System Resources program
<P>
<P><h3>Resolution</h3>
 
<P>
If the following line in the example:
<P>
<PRE>   nGetSysRes = RegFn("GetFreeSystemResources", "I","I")

</PRE>is modified to read as follows:
<P>
<PRE>    nGetSysRes = RegFn("GetFreeSystemResources", "I","I","USER.EXE")

</PRE>the example will successfully return system resources in Windows 3.1x,
Windows 95, and Windows NT.
<P>
NOTE: The values returned vary in significance depending on the operating
system. Under Windows NT, resources are dynamically allocated, and
GetFreeSystemResources will always return 90% for GDI, USER, and SYSTEM.
Under Windows 95, these are allocated differently. For a discussion of GDI
and USER heaps under Windows 95, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win32sdk/q125699.htm">Q125699</A></B>
   TITLE     : GDI Objects and Windows 95 Heaps

   ARTICLE-ID: <B><A href="../win32sdk/q125676.htm">Q125676</A></B>
   TITLE     : New User Heap Limits Under Windows 95
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
