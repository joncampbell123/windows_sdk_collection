

<HTML>
<HEAD>
<TITLE>How to Control the Occurrence of a Default Event </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131095">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/06/04">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  An event is an action generated by a user, a program, or the system. When an event is triggered, Visual FoxPro processes some default system tasks. For example, pressing a key triggers the keypress event that causes the letter to be displayed in a ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO4,QAPN,QAH4,QABA,QBV4,QBT6,QA7O,QAOE,QAMN,QAB5,QAHP,QACI,QABG,QBXS,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Control the Occurrence of a Default Event</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131095</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
An event is an action generated by a user, a program, or the system. When
an event is triggered, Visual FoxPro processes some default system tasks.
For example, pressing a key triggers the keypress event that causes the
letter to be displayed in a text box. With Visual FoxPro, you can control
the occurrence of system events. This article describes how to prevent
system processing of events, and how to cause default events to occur
before user-generated or code-generated events occur.
<P>
You can add code to a method to customize operations that occur when an
event is triggered. When an event handler is customized, system processing
occurs in addition to the tasks defined in user code. By default, the user
code is processed first followed by system processing.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Preventing System Processing from Occurring</h3>
 
<P>
Use the NODEFAULT keyword in method code to prevent system processing of
events. For example, in an input field, you can prevent some characters
from being displayed by using the NODEFAULT clause in a Keypress event
handler. The default behavior when a key is pressed is to display the
character being typed. The NODEFAULT keyword is used in the MAIN form of
the CONTROLS project located in the SAMPLES\CONTROLS directory.
<P>
For more information about NODEFAULT, search for DEFINE CLASS in the Visual
FoxPro Help menu.
<P>
<P><h3>Forcing System Processing to Occur Before User-Defined Code Is Processed</h3>
 
<P>
You can cause the system code for the event to be processed first - before
the user-defined code is prcessed. This is useful, for example, if you want
to control the starting position of a text selection when the control gets
the focus. Default processing of the GotFocus event causes the SelStart
property to be set to zero (0), and the insertion point (cursor) is
positioned before the first character displayed in the control.
<P>
You can't just set the value of the SelStart property in the GotFocus event
because the GotFocus default processing occurs after user code is
processed, so the SelStart property is reset to zero (0). The default
processing of the GotFocus event must occur before the value of the
SelStart property is customized.
<P>
To make the default processing occur first, you need to modify the GotFocus
event code in the GotFocus event handler to follow this sequence:

<OL><P><LI>Call the base class GotFocus event.

<P><LI>Set the SelStart property in the GotFocus event code of the text box.

<P><LI>Place the NODEFAULT clause, which stops the default processing of
   GotFocus from occurring again after your code.
<P>
</OL>The following example code demonstrates this method.
<P>
<P><h3>Sample Code to Place in the GotFocus Method of a Text Box Control</h3>
 
<P>
* First, force default processing:
Textbox::GotFocus()
<P>
* Set the SelStart property:
This.SelStart = 4
<P>
* Default processing already occurred, so prevent it from occurring again:
NODEFAULT
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin form selection<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgClassoop<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
