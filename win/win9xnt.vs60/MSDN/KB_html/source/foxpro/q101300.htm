

<HTML>
<HEAD>
<TITLE>PRB: Epson Printer Driver Causes Top of Page Reset </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101300">
<META NAME="KBModify" CONTENT="1995/05/22">
<META NAME="KBCreate" CONTENT="1993/07/11">
<META NAME="Keywords" CONTENT="kbprint kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If one of the Epson printer drivers is chosen for a printer driver and the PDDOCEND procedure is called, the top of the page will be reset to where the printer stops printing instead of to the true top of the page. Unless the printer is manually re...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QACT,QAOX,QADF,QBXS,QAMB,QA5V,QA7O,QABG,QA7N,QBXT,QAIB,QAU9,QBHQ,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Epson Printer Driver Causes Top of Page Reset</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 22, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101300</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0 and 2.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If one of the Epson printer drivers is chosen for a printer driver and the
PDDOCEND procedure is called, the top of the page will be reset to where
the printer stops printing instead of to the true top of the page. Unless
the printer is manually realigned with the top of the page, each page of
future output will be split over two pages.
<P>
<P><h2>CAUSE</h2>
 
<P>
The printer driver sends the setup code [_PDPARMS(3)] for the printer. This
code initializes the printer and resets the printer's top of page setting.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, do ONE of the following:

<UL><LI>Do not use the printer drivers.
<P>
   -or-

<LI>Create an "End of Document" user procedure for the driver that
   returns the formfeed character [CHR(12)] plus the original code.
<P>
   -or-

<LI>Modify the P_CODES database and rebuild GENPD.APP.
<P>
   In order to modify the P_CODES table it is necessary to thoroughly
   understand how to control the specific printer using whatever language
   the printer requires. For example, HP laser printers use a language
   called 'PCL' or Printer Control Language, PostScript printers use
   various 'levels' of the PostScript language, and dot matrix printers
   use specific code sequences preceded by an attention or ESCAPE
   character, usually CHR(27). Consult your printer documentation or
   contact the manufacturer for more information on sending codes to
   your specific printer.
<P>
   The P_CODES table contains fields with descriptive field names that
   describe the function of the printer code contained within the field.
   For example, the P_6LPI field contains the code to set the printer to
   6 lines per inch, if applicable. Because this article discusses the
   codes used to reset the printer, any such escape codes or commands
   should be stored in the P_SETUP field of the P_CODES table.
<P>
   To modify the P_SETUP field for the Epson E/F/J/RX/LQ driver, open
   the P_CODES database, and move the record pointer to the record where
<PRE>   'Epson E/F/J/RX/LQ' is contained in the P_NAME field. You can then
   add a formfeed character to the existing setup code by issuing the
   command

      REPLACE P_SETUP WITH CHR(12)+P_SETUP

   in the command window.

   For more information about modifying the P_CODES database, please see
   the following article in the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../foxpro/q89000.htm">Q89000</A></B>
      TITLE     : How to Edit the FoxPro P_CODES Database


</PRE></UL><h2>MORE INFORMATION</h2>
 
<P>
The following code reproduces this problem. To use this code without the
printer driver loaded, comment out the lines that contain "&amp;&amp; Comment
this".
<P>
<PRE>   SET TALK OFF
   _PEJECT="NONE"
   _PADVANCE="FORMFEED"

   * The following line of code will set the printer driver to the
   * Epson E/F/RX/LQ driver.

   _PDSETUP="Epson Generic"  &amp;&amp; Comment this

   * The following line of code will enable FoxPro to use the
   * DRIVER2.PLB library file, which contains the code to print
   * using escape codes.

   SET LIBRARY TO c:\&lt;foxpro&gt;\goodies\pdrivers\driver2.plb &amp;&amp; Comment this

   SET PRINTER TO dummy.txt
   SET PRINTER ON
   PRINTJOB

   FOR x = 1 TO 32
      ? x
   ENDFOR

   * The following line of code will send the End of Document escape
   * codes. This is a procedure contained in the DRIVER2.PLB library.

   ? PDDOCEND()                 &amp;&amp; Comment this

   ENDPRINTJOB
   SET PRINTER OFF
   SET PRINTER TO

   * The following line of code will remove the DRIVER2.PLB library
   * from memory.

   SET LIBRARY TO               &amp;&amp; Comment this

   MODIFY COMMAND dummy.txt
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 pdparms<BR>
KBCategory: kbprint kbprg kbprb<BR>
KBSubcategory: FxprintDriver<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 22, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
