

<HTML>
<HEAD>
<TITLE>BUG: "Variable 'G_PDDRIVER' Not Found" Upon Startup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106163">
<META NAME="KBModify" CONTENT="1995/04/18">
<META NAME="KBCreate" CONTENT="1993/11/02">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a resource file containing a default printer driver setup is marked read-only, a series of error messages is generated upon startup of FoxPro and the default printer driver is not loaded.  CAUSE =====  This situation occurs when the following co...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADF,QAIM,QBXS,QAA1,QABA,QDI2,QDIZ,QBVV,QA5V,QAB4,QAYL,QAGB,QAEF,QBV8,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: "Variable 'G_PDDRIVER' Not Found" Upon Startup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106163</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a resource file containing a default printer driver setup is marked
read-only, a series of error messages is generated upon startup of
FoxPro and the default printer driver is not loaded.
<P>
<P><h2>CAUSE</h2>
 
<P>
This situation occurs when the following conditions are met:

<UL><LI>The resource files (FOXUSER.DBF and FOXUSER.FPT) are marked read-only
   (usually for a multiuser purpose).

<LI>A default printer driver was set by choosing the Set Default button in
   the Printer Setup dialog box.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To work around this problem, do one of the following:

<UL><LI>Add the line PDSETUP="&lt;setup name&gt;" to the CONFIG.FP file instead of
   using the Set Default button in the Printer Setup dialog box. This will
   result in a specific setup being loaded during startup as desired.
<P>
   -or-

<LI>Delete the default printer driver setup record from the FOXUSER.DBF and
   do not set a default printer driver. To access the resource file, issue
   the SET RESOURCE OFF command, change the attributes of the resource file
   so that it is not read-only, issue the USE &lt;resource filename&gt; command,
   and then issue the BROWSE command to view the records. The ID field for
   printer driver setups will contain "PDSETUP" and the Name field will
   contain the name that the specific printer driver setup was saved as.
   The default record will contain a hyphen (-) to the left of that name.
   Either mark the record for deletion or remove the hyphen, save and close
   the file, restore the Read-Only attribute, and set the resource to that
   file.
<P>
   -or-

<LI>Do not allow the sharing of a single resource file. Instead, give each
   user a resource file of his or her own and remove the Read-Only
   attribute.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft FoxPro versions
2.5, 2.5a, 2.5b, 2.6, and 2.6a for MS-DOS . We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>From the File menu, choose Printer Setup.

<P><LI>Select the Printer Driver Setup check box.

<P><LI>Create a new printer driver or select an existing one from the list and
   choose the Set Default button to set it as the default.

<P><LI>Return to the Command window and issue the SET RESOURCE OFF command.

<P><LI>From the Filer, change the attributes of the resource file (FOXUSER.DBF
   and FOXUSER.FPT) to Read-Only.

<P><LI>Quit FoxPro.

<P><LI>Restart FoxPro.
<P>
</OL>On startup, a wait window containing "Source not available" will appear and
GENPD.APP will generate a series of error messages of the form "Variable
<PRE>'G_PDxxxxxxx not found. Cancel, Suspend, Ignore", and the default printer
</PRE></OL>driver will not be loaded.
<P>
The DISPLAY STATUS command will reveal that the resource file remains open
in work area 1 under a .TMP file alias. Issuing the SET RESOURCE OFF
command will have no effect, and the SET RESOURCE TO command will result in
a "File is in use" error message. The USE command will close the temporary
resource file in work area 1; however, you will not have access to
previously saved printer driver setups.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the resource file, the CONFIG.FP file, and
printer drivers, see Chapter 2, "Customizing FoxPro," in the "Installation
and Configuration" manual, and Chapter 16, "FoxPro in a Multi-User
Environment," and Chapter 17, "Printer Drivers," in the "Developer's
Guide."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.50 2.50a 2.50b 2.60 2.60a buglist2.50<BR>
buglist2.50a buglist2.50b g_pddriver variable source default errmsg err msg<BR>
2.60 buglist2.60 buglist2.60a<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 18, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
