

<HTML>
<HEAD>
<TITLE>FIX: SELECT - SQL from Table with 252 Fields Causes Page Fault </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162072">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1997/01/13">
<META NAME="Keywords" CONTENT="FxprgSql FxprgTable vfoxwin vfpfix5.0a kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Issuing a SELECT - SQL statement using a table that has more than 251 fields may cause Visual FoxPro to terminate with an Invalid Page Fault.  NOTE: This behavior has been duplicated with as few as 190 fields under a variety of conditions (projects...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2Q,QAG2,QBWS,QA7O,QA7N,QAY2,QBJQ,QABM,QAR4,QAPN,QAH4,QBWA,QA56,QA55,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: SELECT - SQL from Table with 252 Fields Causes Page Fault</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162072</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Issuing a SELECT - SQL statement using a table that has more than 251
fields may cause Visual FoxPro to terminate with an Invalid Page Fault.
<P>
NOTE: This behavior has been duplicated with as few as 190 fields under a
variety of conditions (projects open, variables in memory, and so forth).
The exact number of fields that causes this behavior may vary.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The workaround to the Invalid Page Fault is to perform the SQL SELECT as
identified in the second and third SELECT statements in the "Steps to
Reproduce Behavior" section below.
<P>
<PRE>   SELECT *, .T. FROM &lt;table&gt;

   -or-

   SELECT * FROM &lt;table&gt; INTO CURSOR &lt;cursorname&gt; NOFILTER

</PRE><h2>STATUS</h2>
 
<P>
This problem has been fixed in Visual FoxPro 5.0a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Issuing a SELECT - SQL statement using a table that has more than 251
fields may cause Visual FoxPro to terminate with an Invalid Page Fault. The
following code creates a table with 252 fields, inserts a single record,
and performs three different SQL SELECT statements. Generally, the first
SELECT statement causes an Invalid Page Fault.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Create and run a program with the following code:
<P>
<PRE>   fldlist="("
   FOR i = 1 TO 251
        fldlist=fldlist+"fld"+ALLTRIM(STR(i))+" C(5),"
   ENDFOR

   fldlist=fldlist+"FLD"+ALLTRIM(STR(i))+" C(5))"

   valuelst=""
   valuelst=valuelst+REPLICATE("'"+'DATA'+"', ",i-1)+"'DATA'"

   CREATE TABLE manyflds FREE &amp;fldlist
   INSERT INTO manyflds VALUES (&amp;valuelst)

   SELECT * FROM manyflds        &amp;&amp; Causes an Invalid Page Fault in VFP 5
   SELECT *,.T. FROM manyflds    &amp;&amp; Works fine
   SELECT * FROM manyflds INTO CURSOR temp NOFILTER  &amp;&amp; Works fine
</PRE> 
<PRE>Keywords          : FxprgSql FxprgTable vfoxwin vfpfix5.0a kbprg kbbuglist kbfixlist
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
