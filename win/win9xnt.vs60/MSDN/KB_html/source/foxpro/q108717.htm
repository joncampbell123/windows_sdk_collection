

<HTML>
<HEAD>
<TITLE>BUG: Resource Manager Error When Printing Lots of Fonts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108717">
<META NAME="KBModify" CONTENT="1996/12/18">
<META NAME="KBCreate" CONTENT="1993/12/16">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When FoxPro is printing a large number of fonts under Windows 3.x (16-bit Windows), FoxPro displays the following error message:     Resource Manager Internal Consistency Error  Additionally, Visual FoxPro then displays the following error message:...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADF,QAB4,QDL9,QBWQ,QBWO,QBWN,QBXS,QAOX,QAKP,QAUD,QAAP,QBC9,QBC8,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Resource Manager Error When Printing Lots of Fonts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108717</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When FoxPro is printing a large number of fonts under Windows 3.x (16-bit
Windows), FoxPro displays the following error message:
<P>
<PRE>   Resource Manager Internal Consistency Error

</PRE>Additionally, Visual FoxPro then displays the following error message:
<P>
<PRE>   Win32s - Error Unhandled Exception detected. Application will be
   terminated.

</PRE>NOTE: Visual FoxPro 3.0b for Windows prints a much greater number of fonts
than Visual FoxPro 3.0 for Windows does before displaying the error
message.
<P>
<P><h2>CAUSE</h2>
 
<P>
FoxPro is not properly releasing graphics device interface (GDI) resources
under Windows.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
The following program demonstrates the problem:
<P>
SET TALK OFF
CLEAR
m.points = 10
@ 12,20 SAY 'Enter the point size ' GET m.points PICTURE '99'
READ
@ 12,0
@ 12,30 SAY 'Printing'
SET CONSOLE OFF
IF afont[FONTS]
<PRE>   SET PRINT ON
   _PLINENO = 56
   m.counter = 1
   m.numfonts = ALEN(fonts,1)
   DO WHILE m.counter &lt;= m.numfonts
      m.this_font = LTRIM(fonts(m.counter))
      SET CONSOLE ON
      @ 12,39 SAY SPACE(20)
      @ 12,39 SAY m.this_font
      SET CONSOLE OFF
      m.sizes = AFONT(sizes,(m.this_font))
      IF _PLINENO &gt; 52
         DO rpthead
      ENDIF
      ?
      ? 'This is a 10 point sample of ' + m.this_font
      IF ALEN(sizes) = 1 .AND. TYPE('sizes(1)') = 'L' .AND. sizes(1) = .T.
         ?? '. This is a scalable font.'
      ENDIF
      ?   'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + ;
          'abcdefghijklmnopqrstuvwxyz' + ;
          '1234567890!@#$%^&amp; ; ())' FONT m.this_font,m.points
      ? 'This is ' + m.this_font + ' bold.'
      ?   'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + ;
          'abcdefghijklmnopqrstuvwxyz' + ;
          '1234567890!@#$%^&amp; ; ())' FONT m.this_font,m.points STYLE 'B'
      ? 'This is ' + m.this_font + ' italic.'
      ?   'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + ;
          'abcdefghijklmnopqrstuvwxyz' + ;
          '1234567890!@#$%^&amp; ; ())' FONT m.this_font,m.points STYLE 'I'
      ? 'This is ' + m.this_font + ' underline.'
      ?   'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + ;
          'abcdefghijklmnopqrstuvwxyz' + ;
          '1234567890!@#$%^&amp; ; ())' FONT m.this_font,m.points STYLE 'U'
      m.counter = m.counter + 1
   ENDDO
   EJECT
   SET PRINT OFF
   SET CONSOLE OFF
</PRE>ENDIF
RETURN
<P>
PROCEDURE rpthead
EJECT
_PLINENO = 1
?
? 'A LISTING OF YOUR AVAILABLE WINDOWS FONTS' AT 25
? '-----------------------------------------' AT 25
?
RETURN
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 3.00b FoxWin 2.50 2.50a 2.50b 2.60<BR>
2.60a buglist2.50 buglist2.50a buglist2.50b buglist2.60 buglist3.00<BR>
buglist3.00b errmsg err msg ice<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprintFont<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
