

<HTML>
<HEAD>
<TITLE>PRB: FoxPro Default Directory Changed After IME Started </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177786">
<META NAME="KBModify" CONTENT="1997/12/12">
<META NAME="KBCreate" CONTENT="1997/12/08">
<META NAME="Keywords" CONTENT="FoxWin FxprgIntl vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The FoxPro default folder randomly switches to the Windows folder during design or run-time under the Double-Byte Character (DBC) Windows 3.1 environment if Input Method Editor (IME) is engaged.  RESOLUTION  Use the absolute directory path when ref...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFI,QDL9,QBWQ,QBWO,QBWN,QBXB,QATJ,QAVX,QAVW,QA56,QA55,QAIJ,QABA,QAUD,QDI1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: FoxPro Default Directory Changed After IME Started</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177786</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.5b
<LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The FoxPro default folder randomly switches to the Windows folder during
design or run-time under the Double-Byte Character (DBC) Windows 3.1
environment if Input Method Editor (IME) is engaged.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use the absolute directory path when referencing a table.
<P>
For example, instead of using C:\Dir1\Dir2\Test.dbf as following:
<P>
<PRE>   ** Assume C:\Dir1\Dir2 is the application directory
   set defa to (sys(5)+sys(2003))
   Use test.dbf

</PRE>Use the following commands:
<P>
<PRE>   ** Declare a public variable Direc and store the startup directory
   ** when the program is started.

   Direc=sys(5)+sys(2003)

   ** During program execution, reference the table with the following:

   Use (Direc+"Test.dbf")

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Install any US or Localized version of Visual FoxPro version 3.0b on any
   Double-Byte Character (DBC) version of Windows version 3.1. For example,
   the Traditional Chinese (TC) version of Visual FoxPro 3.0b on the
   Traditional Chinese (TC) version of Windows 3.1.

<P><LI>Start Visual FoxPro version 3.0b and issue the following command:
<P>
<P><PRE>      ? SYS(2003)
</PRE><P>
   This returns the Visual FoxPro 3.0b directory, such as \VFP30, if SET
   DEFAULT is not defined elsewhere.

<P><LI>Launch the (Input Method Editor) IME by pressing CTRL-SPACE.

<P><LI>In the FoxPro Command window type:
<P>
<P><PRE>      ? SYS(2003)
</PRE><P>
   NOTE: The command returns the Windows directory, for example, \Windows.
<P>
   The IME program and associated IME tables are stored under the Windows
   folder.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ime<BR>
Keywords          : FoxWin FxprgIntl vfoxwin<BR>
Version           : WINDOWS:2.5b,3.0,3.0b<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
