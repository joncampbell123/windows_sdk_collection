

<HTML>
<HEAD>
<TITLE>HOWTO: Creating a Connection Programmatically </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176830">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/11/17">
<META NAME="Keywords" CONTENT="FxprgClientsvr FxprgGeneral VFoxMac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Under some circumstances, you may need to modify the properties of a connection at run time. This article describes each of the properties and the default values of a connection. The sample code illustrates how to create a connection and use the DB...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBG2,QAPN,QAH4,QAMB,QABA,QAYY,QBBI,QA9E,QAK6,QAKD,QAB4,QDO9,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Creating a Connection Programmatically</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176830</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Under some circumstances, you may need to modify the properties of a
connection at run time. This article describes each of the properties and
the default values of a connection. The sample code illustrates how to
create a connection and use the DBSETPROP() function to set the properties
of a connection programmatically.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following table indicates the data types and default values associated
with each of the properties of a connection.
<P>
<PRE>   Property       Connection Designer Label    Data Type   Default Value
   ---------------------------------------------------------------------

   DispLogin        Display Login               Numeric        1
   Asynchronous     Asynchronous Execution      Logical        .F.
   DispWarnings     Display Warnings            Logical        .F.
   BatchMode        Batch Processing            Logical        .T.
   Transactions     Automatic Transactions      Numeric        1
   PacketSize       Packet Size                 Numeric        4096
   Comment                                      Character      ''
   ConnectTimeOut   Connection (sec)            Numeric        15
   IdleTimeOut      Idle (min)                  Numeric        3
   QueryTimeOut     Query (sec)                 Numeric        3
   WaitTime         Wait Time (ms)              Numeric        100

</PRE>The sample code below creates and modifies the properties of a connection:
<P>
<PRE>   *Begin code
   LOCAL lcconnstring, lcconname, lnconnections, lbconnexists
   lcconnstring    =  "'DSN=PUBS;DATABASE=pubs;UID=sa;PWD='"
   lcconnname      =   "VFPCONN"
   lnconnections   =   0
   lbconnexists    =   .F.
   IF !FILE('VFPCONN.DBC')
   CLOSE DATA ALL
   CREATE DATABASE VFPCONN
   ELSE
   OPEN DATABASE VFPCONN
   ENDIF
   lnconnections=ADBOBJECTS(CONNECTS,'CONNECTION')
   IF lnconnections&gt;0
   FOR i=1 TO ALEN(CONNECTS,1)
   IF UPPER(CONNECTS[i])=lcconnname
   lbconnexists=.T.
   EXIT
   ENDIF
   NEXT
   ENDIF
   IF !lbconnexists
   CREATE CONNECTION &amp;lcconnname CONNSTRING (lcconnstring)
   ENDIF
   * Set connection properties to custom values.
   =DBSETPROP('VFPCONN','Connection','DispLogin', 3)
   =DBSETPROP('VFPCONN','Connection','Asynchronous', .T.)
   =DBSETPROP('VFPCONN','Connection','DispWarnings', .T.)
   =DBSETPROP('VFPCONN','Connection','BatchMode', .F.)
   =DBSETPROP('VFPCONN','Connection','Transactions', 2)
   =DBSETPROP('VFPCONN','Connection','PacketSize',8192)
   =DBSETPROP('VFPCONN','Connection','Comment', 'Comment Added')
   =DBSETPROP('VFPCONN','Connection','ConnectTimeOut', 10)
   =DBSETPROP('VFPCONN','Connection','IdleTimeOut', 0)
   =DBSETPROP('VFPCONN','Connection','QueryTimeOut', 0)
   =DBSETPROP('VFPCONN','Connection','WaitTime',150)
   MODI CONNECTION VFPCONN
   RETURN
   *End code.

</PRE>After running the program code, a dialog appears titled "Connection
Designer-VPFCONN." Click the Verify Connection button and a message
indicating the connection was successful should appear.
<P>
NOTE: In order to use the connection, an ODBC Data source matching the
Data source name specified in the connection string must exist.
<P>
If the ODBC Data source does not exist, the following ODBC error message is
returned:
<P>
<PRE>   Connectivity error [Microsoft][ODBC Driver Manager] Data source name not
   found and no default driver specified.

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q137445.htm">Q137445</A></B>
   TITLE     : How to Display View and Connection Properties

   ARTICLE-ID: <B><A href="../foxpro/q132231.htm">Q132231</A></B>
   TITLE     : Properties You can Access with SQLGETPROP()

</PRE>Visual FoxPro Help, version 4.00.950; search on: "DBSETPROP()"
<P>
 
<PRE>Keywords          : FxprgClientsvr FxprgGeneral VFoxMac vfoxwin
Version           : MACINTOSH:3.0b; WINDOWS:3.0,3.0b,5.0,5.0a
Platform          : MACINTOSH WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
