

<HTML>
<HEAD>
<TITLE>FIX: Microsoft Excel Worksheets w/ Formulas Import Incorrectly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137949">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/10/09">
<META NAME="Keywords" CONTENT="FxtoolGeneral kbbuglist kbfixlist kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a Microsoft Excel spreadsheet's cells contain formulas, the Import function in Visual FoxPro will not import the data correctly. All or part of the data may be invalid when it is imported to the .dbf file.  WORKAROUND  There are two ways to work...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAR4,QDI1,QAZZ,QA56,QA55,QAUR,QAKD,QAB9,QA9E,QA6A,QAAP,QBWS,QDKW,QAEQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Microsoft Excel Worksheets w/ Formulas Import Incorrectly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137949</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbtool kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a Microsoft Excel spreadsheet's cells contain formulas, the Import
function in Visual FoxPro will not import the data correctly. All or part
of the data may be invalid when it is imported to the .dbf file.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are two ways to work around this problem. Both correctly resolve the
cells containing formulas. However, the first is the easiest and
recommended method to use.

<UL><LI>In Microsoft Excel, save the file as as a .dbf file. Then open the .dbf
   file in Visual FoxPro with the USE &lt;dbf name&gt; command.

<LI>Use an ODBC connection to the Microsoft Excel file. Create a remote view
   or cursor that can be then copied to a ,dbf file with the COPY TO &lt;new
   table name&gt; command. The actual steps in creating the ODBC connection
   are beyond the scope of this article due to the varying factors which
   weigh in the process. For more information about ODBC, please see the
   following articles in the Microsoft Knowledge Base:
<P>
   ARTICLE-ID: <B><A href="../foxpro/q130732.htm">Q130732</A></B>
<PRE>   TITLE     : How To Create a Data Source to Access Microsoft Excel Files

   ARTICLE-ID: <B><A href="../foxpro/q130137.htm">Q130137</A></B>
   TITLE     : How to Use ODBC to Run SQL SELECT on Microsoft Excel Data

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0b for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In Microsoft Excel, create a new worksheet with the following values in
   the respective cells:
<P>
<PRE>   Cell   Content
   --------------
   A1     Field1
   B1     Field2
   A2     25
   B2     =A2 * 3

   NOTE: Cell B2 displays the number 75 when you move off of it by pressing
   the TAB key.

</PRE><P><LI>Save the worksheet as xl2dbf.

<P><LI>Close the worksheet.

<P><LI>Switch to Visual FoxPro, and on the File menu, click Import.

<P><LI>In the Import dialog box, select .xls as the Type and xl2dbf.xls saved
   in step 2 as the specific worksheet to import.

<P><LI>Click OK. An xl2dbf.dbf file will be created.

<P><LI>Browse the imported table, and note that the value in Field2 will be a
   random date, or other invalid value, rather than the correct value of
   75.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin fixlist3.00b buglist3.00 missing<BR>
incorrect<BR>
blank zero xcel<BR>
KBCategory: kbtool kbfixlist kbbuglist<BR>
KBSubcategory: FxtoolGeneral<BR>
Keywords          : FxtoolGeneral kbbuglist kbfixlist kbtool<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
