

<HTML>
<HEAD>
<TITLE>BUG: READ DEACTIVATE Runs When BROWSE Called From VALID of GET </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129229">
<META NAME="KBModify" CONTENT="1997/05/06">
<META NAME="KBCreate" CONTENT="1995/04/20">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxprgBrowse kbcode vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a READ with a DEACTIVATE clause, calling a BROWSE from the VALID clause of a GET triggers the READ DEACTIVATE clause.  CAUSE =====  As the active window changes, the READ DEACTIVATE is executed. In FoxPro version 2.x, the READ DEACTIVATE is not ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFN,QBXS,QAPN,QAUD,QAY2,QBWT,QBFM,QAYV,QAYL,QAGI,QA56,QA55,QAH4,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: READ DEACTIVATE Runs When BROWSE Called From VALID of GET</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129229</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a READ with a DEACTIVATE clause, calling a BROWSE from the VALID clause
of a GET triggers the READ DEACTIVATE clause.
<P>
<P><h2>CAUSE</h2>
 
<P>
As the active window changes, the READ DEACTIVATE is executed. In FoxPro
version 2.x, the READ DEACTIVATE is not called when the BROWSE is executed
from the VALID clause of the GET.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
An alternative is to modify your code to use a Form and a Grid instead of
the BROWSE command. The Grid object is part of the form and interacts with
all of the objects in a form. Another option is to code a special case in
the READ DEACTIVATE clause. For example, you could set a flag when the
BROWSE is first activated. In the READ DEACTIVATE, verify the value of the
variable, and if the BROWSE has been called, RETURN .F. from the READ
DEACTIVATE. The following sample code illustrates this method:
<P>
<PRE>   *Declare a variable that will control whether the READ DEACTIVATE
   * returns .T.
   cDeactBrow=.f.
   CREATE TABLE test (one c(6) , two C(20))
   APPEND BLANK

   DEFINE WINDOW wintest FROM 1,1 TO 20,20 FLOAT GROW ZOOM
   ACTIVATE WINDOW wintest
   @ 1,1 GET nvar DEFAULT 1 PICTURE "@*N Show Browse" VALID browser()
   READ CYCLE MODAL ;
   DEACTIVATE readdeact()

   CLEAR WINDOWS

   PROCEDURE browser
   cDeactBrow=.f.
   BROWSE NORMAL

   PROCEDURE readdeact
   WAIT WINDOW "READ DEACT Shouldn't be called"
   IF cDeactBrow=.F. &amp;&amp;Case where you are in the VALID clause of the GET
       RETURN .F.
       cDeactBrow=.T. &amp;&amp; Reset the variable
       ELSE
       RETURN .T.
   ENDIF

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This illustrates a behavioral difference between FoxPro versions 2.x and
Visual FoxPro version 3.0 for Windows. Because the BROWSE window is
different from the READ window, the behavior exhibited in Visual FoxPro for
Windows seems more logical.
<P>
For more information about differences between FoxPro 2.x and Visual FoxPro
version 3.0, search for "Differences Between FoxPro 2.6 and Visual FoxPro"
using the FoxPro Help menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: grid<BR>
Keywords            : buglist3.00 buglist3.00b buglist5.00 FxprgBrowse kbcode vfpbug5.0a kbbuglist<BR>
Version             : 3.0 3.0b 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
