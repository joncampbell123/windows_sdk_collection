

<HTML>
<HEAD>
<TITLE>How to Use a Builder to Change a Text Box Name to a Field Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139159">
<META NAME="KBModify" CONTENT="1995/11/28">
<META NAME="KBCreate" CONTENT="1995/11/06">
<META NAME="Keywords" CONTENT="kbtool kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Usually, when you want to change the name of a text box control, you must select each control, and then change the Name property of each control. However, it is possible to create a Builder that changes the name of multiple controls at once. The ex...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QAUJ,QBT6,QBV4,QAB5,QAMN,QAOE,QA7N,QAHP,QAH4,QARM,QA2Q,QBWD,QAHV,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use a Builder to Change a Text Box Name to a Field Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139159</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Usually, when you want to change the name of a text box control, you must
select each control, and then change the Name property of each control.
However, it is possible to create a Builder that changes the name of
multiple controls at once. The example presented in this article assumes
that you want to change the name of the text box controls to the name of
the field specified as the control source.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are several ways to register and call a custom builder. This article
explains a method that includes two basic steps.

<OL><P><LI>Create a new program file that executes the desired changes by entering
   the following code:
<P>
   * Builder code to change name of selected text boxes
   * to underlying control
   x =""
   nObjects = 0
<P>
   *The ASELOBJ() function creates an array referencing the selected
   *controls. It also returns the number of selected controls
   *Hence, nObjects is the number of selected controls
   *aSelobjects is the name of the array created by ASELOBJ()
<P>
   nObjects = ASELOBJ(aSelobjects)
<P>
   *The FOR loop cycles through the array of selected controls
   IF nObjects &gt; 0
<P><PRE>     FOR nCnt = 1 TO nObjects
<PRE></PRE>        *store the name of the table and field to a variable x
        x = ASELOBJECTS(nCnt).ControlSource
        *The ATC() function locates the decimal separating the
        *table name and field name.
        *The SUBSTR() function then extracts the field name
        *and resets the control's name to that of the field
        ASELOBJECTS(nCnt).Name = SUBSTR(x,ATC('.',x)+1)
     NEXT
   ENDIF

</PRE><P><LI>Register the program properly in the Builder.dbf table. The program must
   be properly registered before the builder becomes available in the Form
   Designer.
<P>
   a. Open the Builder.dbf table located in the \Vfp\Wizards directory.
<P>
   b. Append a new blank record. Three fields in the table must be filled:
<P><PRE>      in: Name, Type, and Program. The Name field is the name you want to
      give to the builder. For example, the Name field can contain "Field
      name builder."
</PRE><P>
   c. Enter Multiselect in the type field. With this keyword, the builder
<P><PRE>      is used when multiple controls are selected.
</PRE><P>
   d. Enter the name of the program including the path in the program
<P><PRE>      field.
</PRE><P>
   e. Close the Builder.dbf table. When you select multiple text box
<P><PRE>      controls and call a builder, your new builder should appear as one of
      the available choices.
</PRE><P>
</OL>NOTE: as mentioned previously, this builder is designed to change the name
of the text box control to the field name specified as the control source.
It derives the field name from the entry in the ControlSource property,
assuming that the entry is of the type:
<P>
<PRE>   table.field

</PRE></OL>You could modify the code to rename the controls differently.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin wizard<BR>
KBCategory: kbtool kbhowto kbcode<BR>
KBSubcategory: FxotherGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 28, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
