

<HTML>
<HEAD>
<TITLE>PRB: Visual FoxPro Form Is Inaccessible with Foundation READ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162682">
<META NAME="KBModify" CONTENT="1997/01/27">
<META NAME="KBCreate" CONTENT="1997/01/27">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a Visual FoxPro form is run within a converted FoxPro 2.x application and program execution falls back to the Foundation READ, then some or all of the controls on the form do not respond to keyboard or mouse input.  RESOLUTION  Use a READ EVEN...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFN,QAGB,QANE,QA56,QA55,QBWS,QAO4,QAMB,QAAW,QAEF,QAPN,QAH4,QAEB,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual FoxPro Form Is Inaccessible with Foundation READ</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162682</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a Visual FoxPro form is run within a converted FoxPro 2.x application
and program execution falls back to the Foundation READ, then some or all
of the controls on the form do not respond to keyboard or mouse input.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use a READ EVENTS to set up the wait state, rather than a Foundation READ,
which uses a READ VALID.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order to create a wait state in FoxPro 2.x, the Foundation READ was
used. This allowed an application using the FoxPro run time to continue to
execute while waiting for user input--selection of a menu option, for
example. In Visual FoxPro, the Foundation READ is no longer necessary, but
the wait state must still be established to create an application, which
uses the run time. This is now done with the READ EVENTS command.
<P>
If a Visual FoxPro form is instantiated, either with DO FORM or
CREATEOBJECT() within an application employing a Foundation READ, the
form's controls may be inaccessible. This occurs if program execution
is halted at the Foundation READ (READ VALID command) when the Visual
FoxPro form is instantiated.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Run the following code from a program (.prg) file:
<P>
<P><PRE>      * Beginning of program file
      ********************************************************************
      * This simulates a FoxPro 2.x application with a menu, screen, and
      * Foundation READ. A Visual FoxPro form has been added to this also,
      * simulating what occurs if such a form is added to an existing
      * FoxPro 2.x type application, which is run under Visual FoxPro.
      *
      SET PROCEDURE TO SYS(16)
<PRE></PRE>      lValid = .F.      &amp;&amp; Sets the Foundation READ variable

      * Establish menu
      SET SYSMENU TO
      DEFINE PAD do_screen OF _MSYSMENU PROMPT "Do Screen"
      DEFINE PAD do_form OF _MSYSMENU PROMPT "Do Form"
      DEFINE PAD do_exit OF _MSYSMENU PROMPT "Exit"

      ON SELECTION PAD do_screen OF _MSYSMENU DO do__screen
      ON SELECTION PAD do_form OF _MSYSMENU DO show__form
      ON SELECTION PAD do_exit OF _MSYSMENU DO do__exit

      * Establish Foundation READ or READ EVENTS

      READ VALID lValid             &amp;&amp; Comment this and
      * READ EVENTS                 &amp;&amp; uncomment this for workaround
      SET PROC TO
      SET SYSMENU TO DEFAULT

         PROCEDURE do__screen
            DEFINE WINDOW wind1 FROM 1,1 TO 20,30 ;
               FLOAT GROW CLOSE SYSTEM TITLE "Read Screen"
            ACTIVATE WINDOW wind1
            @ 10,8 GET gnChoice DEFAULT 1 ;
              FUNCTION '*3  \!Close me' SIZE    3,12
            READ
            CLEAR WINDOW
         ENDPROC

         PROCEDURE do__exit
            lValid = .T.
            CLEAR EVENTS
            CLEAR READ ALL
            MOUSE CLICK
         ENDPROC

         PROCEDURE show__form
            PUBLIC ox
            ox = CREA('form1')
            ox.SHOW()
         ENDPROC

      DEFINE CLASS form1 AS FORM
         CAPTION = "VFP Form"
         ADD OBJECT command1 AS COMMANDBUTTON WITH ;
            TOP = 120, ;
            LEFT = 130, ;
            HEIGHT = 25, ;
            CANCEL = .T. ,;
            CAPTION = "Close me"
         PROCEDURE command1.CLICK
            THISFORM.RELEASE()
         ENDPROC
      ENDDEFINE
      *
      * End of program file

</PRE><P><LI>Click "Do Screen" on the menu. A FoxPro 2.x style READ screen is
   displayed. Click the "Close me" button to close the screen.

<P><LI>Click "Do Form" on the menu. A Visual FoxPro form is instantiated and
   displayed. Click the "Close me" button to attempt to close the form. The
   button will not be accessible. Close the form by clicking on the Close
   [x] button in the upper right corner or by pressing Ctrl+F4.

<P><LI>Select Exit from the menu.
<P>
</OL>To demonstrate the workaround, comment out the "READ VALID lValid" line in
the above example by starting the line with an asterisk, remove the
asterisk from the beginning of the "* READ EVENTS" line, and rerun the
program. The screen still works as before, and now the "Close me" command
button on the form is also accessible.
<P>
<P><h2>REFERENCE</h2>
 
<P>
For additional information on the Foundation READ and READ EVENTS, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q87694.htm">Q87694</A></B>
   TITLE     : Menu Appears, Then Application Exits to Operating System
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgRead<BR>
Additional reference words: 3.00 3.00b 5.00 vfoxwin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
