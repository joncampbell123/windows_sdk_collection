

<HTML>
<HEAD>
<TITLE>How To Send to the Serial Port by Using Mscomm32.ocx </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139526">
<META NAME="KBModify" CONTENT="1997/01/08">
<META NAME="KBCreate" CONTENT="1995/11/12">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes the settings necessary to send data to the serial port by using Mscomm32.ocx. Mscomm32.ocx ships with the Professional Edition of Visual FoxPro. It can be used in Windows 95 or Windows NT only.  MORE INFORMATION  The most fre...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJ9,QAPN,QABA,QAKG,QAH6,QAKD,QBWC,QAKC,QDJP,QBXS,QBAO,QATX,QAA1,QBBI,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Send to the Serial Port by Using Mscomm32.ocx</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139526</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes the settings necessary to send data to the serial
port by using Mscomm32.ocx. Mscomm32.ocx ships with the Professional
Edition of Visual FoxPro. It can be used in Windows 95 or Windows NT only.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The most frequently used properties to send data to the serial port using
the mscomm control are as follows:
<P>
<P><h3>CommPort</h3>
 
<P>
The CommPort property specifies the communications port number. A numeric
property that corresponds to the Comm port. By default, this property is
set to 1 corresponding to com1. Valid values are 1, 2, 3, or 4 depending on
the serial ports installed on the computer and their configuration.
<P>
<P><h3>Settings</h3>
 
<P>
The Settings property configures the baud rate, parity, data bits, and stop
bits for the serial port. It is a character string with individual values
separated by commas. By default, the Settings property contains 9600,N,8,1.
This corresponds to 9600 baud, no parity, 8 data bits, and 1 stop bit.
<P>
<P><h3>PortOpen</h3>
 
<P>
The PortOpen property specifies a logical value that controls whether or
not the serial port is open and active. Once the previous properties are
set to begin using the serial port, you can set this property to true.
<P>
<P><h3>Output</h3>
 
<P>
The Output property is assigned the string of characters to be sent to the
serial port. To output the string "Hello World" to the serial port after
the previous properties are set, use the following command:
<P>
<PRE>   myform.mycomm.output = "Hello World"

</PRE>Other properties that may be also be needed depending on the application
are as follows:
<P>
<P><h3>CommEvent</h3>
 
<P>
The CommEvent property contains a value that represents the most recent
communications event or errors.
<P>
<P><h3>Sthreshold</h3>
 
<P>
The Sthreshold property specifies the minimum number of characters in the
output buffer that are sent.
<P>
<P><h3>OutBufferCount</h3>
 
<P>
The OutBufferCount control returns the number of characters waiting in the
transmit buffer. This should always be zero if the Sthreshold property is
zero. Setting the OutBufferCount property to zero will clear the transmit
buffer.
<P>
<P><h3>OutBufferSize</h3>
 
<P>
The OutBufferSize property specifies the size of the transmit buffer. By
default, this buffer is 512 bytes. The larger the transmit buffer, the less
memory available to other applications. Slow baud rates and large text
strings written to the serial port may mean you need to make this value
larger.
<P>
Following is a sample that shows how to set up the comm control and dial
the phone number 555-1234 by using the standard Hayes Modem commands.
<P>
<PRE>   PUBLIC ComForm
   ComForm = CREATEOBJECT('Form')
   ComForm.AddObject("Testcom","Olecontrol","MSCOMMLib.MSComm")
   ComForm.Testcom.CommPort = 2 &amp;&amp; Use Comm2, The second Serial Port.
   ComForm.Testcom.Settings = "14400,N,8,1"  &amp;&amp; 14.4 Kbaud, No Parity,
                                             &amp;&amp; 8 data Bits, 1 Stop Bit
   ComForm.Testcom.PortOpen = .T.
   ComForm.Testcom.Output = "ATDT555-1234" + chr(13) &amp;&amp; Dialing the number
   * The chr(13) is needed to complete the modem command sequence
   ComForm.Testcom.PortOpen = .F.
   ***** End Code *****
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
