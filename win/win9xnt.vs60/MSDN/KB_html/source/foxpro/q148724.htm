

<HTML>
<HEAD>
<TITLE>How to Fill Second List with Values from Multiselect List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148724">
<META NAME="KBModify" CONTENT="1996/03/27">
<META NAME="KBCreate" CONTENT="1996/03/20">
<META NAME="Keywords" CONTENT="kbtool kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using multiple page pageframes, you may find it useful to populate a list box on a following page with the values selected from a multiple- select list box on a previous page.  This article demonstrates how to fill the first multiple-select li...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAPN,QA2Q,QAE1,QBWS,QAY2,QBXS,QAG2,QAIB,QAIA,QBWA,QAO4,QBCF,QAGU,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Fill Second List with Values from Multiselect List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148724</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using multiple page pageframes, you may find it useful to populate a
list box on a following page with the values selected from a multiple-
select list box on a previous page.
<P>
This article demonstrates how to fill the first multiple-select list box
from an array created by an SQL SELECT statement and then take the user's
selections from this list box to fill the second list box on another page
of the pageframe.
<P>
The form has a command button that resets the multiple-select list so that
the user can start making selections on a clean unselected list. Initially,
this button is disabled; it becomes enabled when at least one selection is
made in the multiple-select list box. When the user clicks the button to
reset the list, the command button again becomes disabled.
<P>
The form also checks whether a selection was made on the first list. If no
items are chosen in the first list, the display value of the second list
shows "No Selection Made" in the list. This feature is optional.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: To select multiple items from a multiple-select list, hold down the
CTRL key while clicking with the mouse. To select a contiguous range of
items, click first item in the range, and then hold down the SHIFT key as
you click the last item.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a new form.

<P><LI>In the form designer, choose New Property from the Form menu. Enter the
   following array in the name box. Then click OK:
<P>
   aSelected(1)
<P>
   Again choose New Property from the Form menu. Enter the variable that
   will be used to count the selected items in the name box. Then click OK:
<P>
   nCount

<P><LI>Right-click the form, and select Data Environment. Then right-click the
   Data Environment window, and click Add. Click the Other button, and add
   the Employee table from the \VFP\Samples\Data directory.

<P><LI>Add a page frame to the form by selecting the PageFrame control from the
   Form Controls toolbar and clicking the form. Resize the page frame if
   needed.

<P><LI>Right-click the page frame, and select Edit. A hatched border is drawn
   around the page frame.

<P><LI>Right-click Page1 and select Properties. Select the All tab from the
   Properties sheet, and add the following code to the listed events for
   Page1 of the page frame:
<P>
   Activate event:
<P>
<PRE>   Thisform.nCount=0                 &amp;&amp; Reset nCount when page is selected
   Thisform.aSelected=" "            &amp;&amp; Reinitialize array to empty string
   DIMENSION Thisform.aSelected(1)   &amp;&amp; Redimension array to one element

   FOR i=1 TO This.List1.ListCount   &amp;&amp; Loop through number items in List
      IF This.List1.Selected=.T.     &amp;&amp; If an item is selected in List,
         This.List1.Selected=.F.     &amp;&amp; the Selected property is .T.
      ENDIF
   ENDFOR

   This.List1.ListIndex=0            &amp;&amp; Reset the index number of List box
   This.List1.RowSource=This.List1.RowSource
   This.Refresh                      &amp;&amp; Force List and Form to refresh

   Deactivate event:

   This.Command1.Enabled=.F.
   LOCAL narraycnt
   narraycnt=1

   FOR i=1 TO This.List1.ListCount    &amp;&amp; Loop through Selected array, if
      IF This.List1.Selected(i)=.T.   &amp;&amp; true, increment nCount variable.
         Thisform.nCount=Thisform.nCount+1
      ENDIF
   ENDFOR

   IF Thisform.nCount=0               &amp;&amp; No selection made, set nCount=1
      Thisform.nCount=1
      Thisform.aSelected(Thisform.nCount)="No Selection Made!"
   ENDIF

   DIMENSION Thisform.aSelected(Thisform.nCount)  &amp;&amp; Dimension array

   FOR i=1 TO This.List1.Listcount     &amp;&amp; Loop through items in List,
      IF This.List1.Selected(i)=.T.    &amp;&amp; if Selected-look at List property
         Thisform.aSelected(narraycnt)=This.List1.List(i)
         narraycnt=narraycnt+1
      ENDIF
   ENDFOR

</PRE><P><LI>With the pageframe still in edit mode, add a list box to Page1 of the
   page frame by selecting the ListBox control from the Form Controls
   toolbar and clicking Page1.

<P><LI>Right-click the list box and select Properties, or click the Properties
   window if it is already available. Select the All tab from the
   Properties sheet, and modify the following properties and events:
<P>
   RowSource - Enter the following on one, single line:
<P>
   SELECT DISTINCT Employee.Title from Testdata!Employee ORDER BY
<P><PRE>      Employee.Title INTO CURSOR mlist WHERE NOT EMPTY(Employee.Title)
</PRE><P>
   RowSourceType: 3 - SQL Statement
<P>
   MultiSelect: .T.
<P>
   Click Event:
<P>
<PRE>   This.Parent.Command1.Enabled=.T.           &amp;&amp;  Enable 'RESET' button

</PRE><P><LI>Add a command button to page 1 while the page frame is in edit mode.
   Configure the command button with the following properties and events:
<P>
   Caption: Reset List
<P>
   Click Event:
<P>
<PRE>   This.Parent.List1.ListIndex=0            &amp;&amp;  Reset ListIndex property
   This.Parent.List1.RowSource=This.Parent.List1.RowSource
   This.Parent.Refresh                      &amp;&amp;  Refresh List and Page
   This.Enabled=.F.                         &amp;&amp;  Disable 'RESET' button
   This.Parent.List1.Setfocus               &amp;&amp; Put focus on list

</PRE><P><LI>With the page frame in edit mode, click the Page2 tab on the page
<P><PRE>    frame.  Add the following events to Page2 of the pageframe:
</PRE><P>
<P><PRE>    Activate event:
</PRE><P>
<PRE>    This.List1.Requery             &amp;&amp; Issue Requery to display/refresh

</PRE><P><LI>Add a list box to Page2 with the following properties:
<P>
<P><PRE>    RowSource: Thisform.aSelected
</PRE><P>
<P><PRE>    RowSourceType: 5 - Array
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin listbox multiselect<BR>
listcount selected list<BR>
KBCategory: kbtool kbhowto kbcode<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
