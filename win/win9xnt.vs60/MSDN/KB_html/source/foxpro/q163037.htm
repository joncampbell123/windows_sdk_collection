

<HTML>
<HEAD>
<TITLE>BUG: Label Properties Cause Illegal Operation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163037">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="buglist5.00 FxprgClassoop kbprg vfoxwin vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Running a program that instantiates a form containing a label that has properties of Autosize and WordWrap together causes a stack fault.  In Windows 95, the message shows a dialog box with Visual FoxPro as its title saying the following:     This ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAC2,QAH4,QAB4,QDKA,QAY5,QAPN,QAAP,QAVS,QBE7,QBE6,QA6Y,QAVX,QAVW,QAO1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Label Properties Cause Illegal Operation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163037</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Running a program that instantiates a form containing a label that has
properties of Autosize and WordWrap together causes a stack fault.
<P>
In Windows 95, the message shows a dialog box with Visual FoxPro as its
title saying the following:
<P>
<PRE>   This Program has performed an illegal operation and will be shut down.

</PRE>The Details button opens a message saying the following:
<P>
<PRE>   VFP caused a stack  fault in module VFP.EXE.

</PRE>In Windows NT, the message is in a Dr. Watson dialog box and says the
following:
<P>
<PRE>   An application error has occurred and an application error log is being
   generated. VFP.exe - Exception: stack overflow [0xc00000fd].
   Address&lt;...&gt;.

</PRE>After the error message appears, VFP shuts down.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The error does not occur if the label properties include either AutoSize or
WordWrap, but not both.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The same error may occur from a label on a form generated by the Form
Builder. The workaround in that situation is different. For more
information on that form of the problem, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q162253.htm">Q162253</A></B>
   TITLE     : PRB: Form Builder Form Causes Illegal Operation

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
Copy the following code into a program named LabelTest.prg, then run the
program:
<P>
<PRE>   ********************************************************
   *- LabelTest.prg
   *-  A program to demonstrate the effect of combining the
   *-  Autosize and WordWrap properties on a label.
   ********************************************************
   PUBLIC x
   x=CREATEOBJECT("Form")
   x.AddObject("mylabel","test")
   x.Visible=.t.

   DEFINE CLASS test AS label
     AutoSize = .T.
     WordWrap = .T.


     PROCEDURE Init
       LOCAL lcTest,lcname
       lcname=THIS.NAME+"A" &amp;&amp; Get a unique name
       THIS.PARENT.ADDOBJECT(lcname,'label')
       lcTest=lcname

       WITH THIS.PARENT.&amp;lcTest
         .AUTOSIZE=THIS.AUTOSIZE
         .WORDWRAP=THIS.WORDWRAP   &amp;&amp; Comment this line for success.
         .VISIBLE=.T.
       ENDWITH
     ENDPROC
  ENDDEFINE
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist5.00 FxprgClassoop kbprg vfoxwin vfpbug5.0a kbbuglist<BR>
Version             : 5.0a 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
