

<HTML>
<HEAD>
<TITLE>FIX: Exiting ON SHUTDOWN Window Disables GET Objects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124348">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1994/12/28">
<META NAME="Keywords" CONTENT="buglist2.60a fixlist5.00 FoxWin FxprgGeneral KBQ vfoxwin kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If an ON SHUTDOWN procedure calls a window that is then exited, the mouse can only access the current GET object in the READ that was active when the ON SHUTDOWN procedure was called.  CAUSE =====  Control is not passed from the ON SHUTDOWN procedu...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKA,QAB9,QAGQ,QBXS,QAW6,QAPN,QAA5,QAR4,QBV8,QAXC,QDL9,QBW7,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Exiting ON SHUTDOWN Window Disables GET Objects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124348</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50a 2.50b 2.60 2.60a 3.00
WINDOWS
kbprg kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If an ON SHUTDOWN procedure calls a window that is then exited, the mouse
can only access the current GET object in the READ that was active when the
ON SHUTDOWN procedure was called.
<P>
<P><h2>CAUSE</h2>
 
<P>
Control is not passed from the ON SHUTDOWN procedure back to the previous
READ level if the RELEASE WINDOW command is used.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Replace the "RELEASE WINDOW window1" command with the "DEACTIVATE WINDOW
window1" command to send control back to the previous screen.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a program containing the following commands, and run it:
<P>
   ON SHUTDOWN DO shutdialog
<P>
   mbutton = 1
   @ 10, 10 GET mbutton ;
<P><PRE>      PICTURE "@*HN Button1; Button2" ;
      SIZE 2, 12, 2
</PRE>   READ CYCLE
<PRE>   ON SHUTDOWN         &amp;&amp; To clear the setting

   PROCEDURE shutdialog
   DEFINE WINDOW window1 FROM 0,0 TO 4,45
   ACTIVATE WINDOW window1
   @ 1,2 SAY 'Type "q" To Quit Or Any Key To Continue:'
   mwindow1=INKEY(0,"H")

   IF mwindow1=113 or mwindow1=81     &amp;&amp; INKEY() values for "q" and "Q"
      QUIT
   ELSE
      RELEASE WINDOW window1   &amp;&amp; Becomes DEACTIVATE WINDOW window1
   ENDIF

</PRE><P><LI>Press ALT+F4 to invoke ON SHUTDOWN.

<P><LI>Press a key other than q to exit the ON SHUTDOWN window. The mouse will
   only access the GET object which was active when ON SHUTDOWN was called.
   Moving between GET objects with the cursor keys will allow the object
   that has the focus to be accessed with the mouse.
<P>
</OL>The RELEASE WINDOW &lt;windowname&gt; command does not release the window. This
can be verified by going into the Window menu and seeing Window1 even after
the RELEASE WINDOW command has been executed. However, the RELEASE WINDOW
command releases the window correctly if executed outside the ON SHUTDOWN
procedure.
<P>
Using DEACTIVATE WINDOW &lt;windowname&gt; in place of RELEASE WINDOW allows the
GETS to work as expected.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: FxprgGeneral KBQ fixlist5.00 VFoxWin FoxWin buglist2.60a<BR>
Additional reference words: 3.00 2.50a 2.50b 2.60 2.60a<BR>
Keywords          : buglist2.60a fixlist5.00 FoxWin FxprgGeneral KBQ vfoxwin kbbuglist kbfixlist kbprg<BR>
Version           : 2.50a 2.50b 2.60 2.60a 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
