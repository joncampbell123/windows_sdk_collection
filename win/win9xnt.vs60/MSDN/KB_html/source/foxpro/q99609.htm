

<HTML>
<HEAD>
<TITLE>PRB: GET VALID Routine Is Not Called When Switching Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99609 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/06/02">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The GET VALID routine in a program is not called when the user switches between windows either by pressing CTRL+F1 or by choosing Next Window from the window's Control-menu box. To demonstrate this behavior, run the following program:     DEFINE WI...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFM,QAH4,QAXC,QA7O,QA7N,QAKR,QAHE,QDL9,QBWQ,QBWO,QBWN,QAB9,QBVV,QBFN,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: GET VALID Routine Is Not Called When Switching Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99609 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The GET VALID routine in a program is not called when the user switches
between windows either by pressing CTRL+F1 or by choosing Next Window from
the window's Control-menu box. To demonstrate this behavior, run the
following program:
<P>
<PRE>   DEFINE WINDOW test1 FROM 2,2 TO 10,20 ;
     FLOAT ;
     GROW ;
     CLOSE ;
     SYSTEM ;
     TITLE "TEST1"
   ACTIVATE WINDOW TEST1
   @ 2,2 GET x DEFAULT "Hello!" VALID hello()

   DEFINE WINDOW test2 FROM 12,2 TO 20,20 ;
     FLOAT ;
     GROW ;
     CLOSE ;
     SYSTEM ;
     TITLE "TEST2"
   ACTIVATE WINDOW TEST2
   @ 2,2 GET y DEFAULT "Goodbye!" VALID hello()

   READ CYCLE
   CLEAR ALL

   PROCEDURE hello
     WAIT WINDOW WLAST()

</PRE><h2>CAUSE</h2>
 
<P>
This is the expected behavior for FoxPro.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To force the VALID routine to execute, place it in the READ DEACTIVATE
clause. The following steps demonstrate how to do this through the FoxPro
Screen Builder.

<OL><P><LI>Add the following to the Setup code:
<P>
<P><PRE>      PUBLIC hasvalid  &amp;&amp; Memory variable used to determine if field
<PRE></PRE>                       &amp;&amp; has associated VALID clause.
      hasvalid = .F.

</PRE><P><LI>In the WHEN snippet for each GET field, add one of the following lines
   as appropriate:
<P>
<PRE>      hasvalid = .T.   &amp;&amp; If the GET field has a VALID routine.
      hasvalid = .F.   &amp;&amp; If the GET field does not have a VALID
                       &amp;&amp; routine.

</PRE><P><LI>In the VALID snippet for each GET field that has a VALID routine, add
   the following line as a procedure:
<P>
<PRE>      DO (varread())   &amp;&amp; Causes the procedure that is named the same
                       &amp;&amp; as the current GET field to execute.

</PRE><P><LI>Define all VALID procedures in the cleanup code. The name of each
   procedure should be the name of the associated GET field.

<P><LI>Add the following code to the READ DEACTIVATE clause:
<P>
<P><PRE>      IF hasvalid
<PRE></PRE>         DO (varread()) &amp;&amp; Named expression to cause proper procedure
                        &amp;&amp; to execute. Preferred to macro
                        &amp;&amp; substitution.
      ENDIF
      RETURN .F.        &amp;&amp; Necessary to keep the READ from
                        &amp;&amp; terminating.

</PRE></OL>The GET VALID routine is also called when the user switches between windows
by clicking on another window.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 2.50a<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgMacrosub
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
