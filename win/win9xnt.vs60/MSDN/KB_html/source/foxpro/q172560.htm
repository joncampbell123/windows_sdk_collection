

<HTML>
<HEAD>
<TITLE>HOWTO: Switching Focus to a Visual FoxPro Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172560">
<META NAME="KBModify" CONTENT="1997/08/11">
<META NAME="KBCreate" CONTENT="1997/08/11">
<META NAME="Keywords" CONTENT="FxinteropGeneral FxprgFoxtools vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you create a local Visual FoxPro OLE Automation Server that displays a user interface (UI), the UI may not have focus when initiated. To force the Visual FoxPro OLE server to have focus you can call the SetForegroundWindow API from the client an...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADO,QA56,QA55,QAH4,QAGI,QA9Q,QAPN,QBS0,QAH7,QAH6,QAD7,QAIF,QBHQ,QBVV,QA63 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Switching Focus to a Visual FoxPro Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172560</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you create a local Visual FoxPro OLE Automation Server that displays a
user interface (UI), the UI may not have focus when initiated. To force the
Visual FoxPro OLE server to have focus you can call the SetForegroundWindow
API from the client and pass the window handle of the Visual FoxPro OLE
Server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When calling the Show Method of a Visual FoxPro OLE Server from a client
application, such as a Visual Basic executable, the Visual FoxPro UI may
not receive focus.
<P>
Here is a method of forcing the Visual FoxPro OLE Server to have focus and
control:

<OL><P><LI>In the Visual FoxPro Class Designer, create a class with a property to
   hold the window handle. Call the property "myHwind."

<P><LI>In the Show Method of the Visual FoxPro Class, add the following code:
<P>
<P><PRE>      SET LIBRARY TO HOME()+"\foxtools.fll" &amp;&amp; If FoxTools is in the Home
<PRE></PRE>                                            &amp;&amp; directory.
      Thisform.myHwind = mainhwnd()
      SET LIBRARY TO

</PRE></OL>This code loads the Foxtools library and calls mainhwnd, which returns the
window handle for the main Visual FoxPro window, in this case it would be
your OLE Server Form. The code places the window handle into the class
property myHwind and then releases the Foxtools library.

<OL><P><LI>In the client, add the following code:
<P>
<P><PRE>      DECLARE Integer SetForegroundWindow in WIN32API long whnd
      ox.Show()
      whnd = ox.myHwind
      x = SetForegroundWindow(whnd)
</PRE><P>
</OL>This code assumes that the Visual FoxPro OLE server was instantiated
elsewhere in the program using the Createobject command. This code uses the
DECLARE as you would in Visual FoxPro; the syntax would be different in
Visual Basic. The code then calls the Show Method. At this point, the UI
for the OLE Server appears, but it does not have focus. Next get the window
handle that was stored in as a class property, call SetForegroundWindow,
and pass the window handle of the application to get focus.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the SetForegroundWindow, please refer to the
Win32 SDK
<P>
For more information about the Mainhwnd function, please refer to the
Foxtools.hlp in the tools directory that is installed with Visual FoxPro.
<P>
(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by David
Botzenhart, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OLE<BR>
Keywords          : FxinteropGeneral FxprgFoxtools vfoxwin<BR>
Technology        : kbole<BR>
Version           : WINDOWS:5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
