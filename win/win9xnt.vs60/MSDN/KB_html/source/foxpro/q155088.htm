

<HTML>
<HEAD>
<TITLE>BUG: ListBox Control Scrolls Slowly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155088">
<META NAME="KBModify" CONTENT="1997/01/20">
<META NAME="KBCreate" CONTENT="1996/08/21">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When scrolling with the scroll bar in the ListBox control of Visual FoxPro, the scrolling speed is unreasonably slow. The Visual FoxPro ListBox may be many times slower than the @...GET-List of version 2.6. The scrolling speed of the ListBox is not...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO9,QBVR,QBXQ,QAHP,QAMR,QA56,QA55,QAU3,QBB2,QA7O,QAOE,QANE,QAMN,QALA,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ListBox Control Scrolls Slowly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155088</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When scrolling with the scroll bar in the ListBox control of Visual FoxPro,
the scrolling speed is unreasonably slow. The Visual FoxPro ListBox may be
many times slower than the @...GET-List of version 2.6. The scrolling speed
of the ListBox is not dependent on the RowSourceType of the control or the
size of the data set being scrolled.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Following are two workarounds for this behavior:

<OL><P><LI>Recreate a ListBox-like object by subclassing a grid with the following
   properties:
<P>
   ColumnCount  = 1
<PRE>   DeleteMark   = .F.
   RecordMark   = .F.
   ScrollBars   = 2 - Vertical
   HeaderHeight = 0
   GridLines    = 0 - None
   RowHeight    = FontSize + 2

   The result will be similar in function to a ListBox and will scroll
   considerably faster with the scroll bar. However, if you are using
   repeated arrow keys to scroll, the grid is slower than the ListBox.

   One limitation of this approach is the limited selection of
   RecordSourceTypes of the grid as compared to the RowSourcetypes of the
   ListBox. The following tables illustrate this:

   Grid RecordSourceTypes:

      0 - Table
      1 - Alias
      2 - Prompt
      3 - Query (.QPR)

   ListBox RowSourceTypes:

      0 - None
      1 - Value
      2 - Alias
      3 - SQL Statement
      4 - Query (.QPR)
      5 - Array
      6 - Fields
      7 - Files
      8 - Structure
      9 - Popup

</PRE><P><LI>Define and activate a POPUP.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following table illustrates the difference in scrolling speed. The test
case used a ListBox sized to show 10 rows and populated with the company
field from a customer table in the Visual FoxPro:Samples:Data folder. The
customer table contains 91 records. The Time column reflects the time
necessary to scroll via the down arrow from top to bottom:
<P>
<PRE>   Machine              Product                  Time     Rate (r/s)
   -------------------- ---------------------    -------- ----------

   Power Mac 9500/132   Visual FoxPro/Mac 3.0     5.5      16.5
   Power Mac 9500/132   FoxPro/Mac 2.6            0.9     102.0
   Power Mac 7100/66    Visual FoxPro/Mac 3.0    26.0       3.5
   Power Mac 7100/66    FoxPro/Mac 2.6            2.8      32.5
   GateWay Pentium120   Visual FoxPro/Win 3.0     0.8     115.0

   Machine Details:

   - Power Mac 9500/132 32MB, VM 40MB, 7.5.3, ATI XClaim GA 4MB-
     1024x768xMillions

   - Power Mac 7100/66 AV 16MB, 24MB VM, 864x624xThousands

   - GateWay Pentium120, Windows NT Server 3.51,SP3, 32MB, 44 MB Swap,
     ATI PCI Video 2MB-1024x768x256
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>
Additional reference words: 3.00b speed crawl redraw vfoxmac kbdse
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
