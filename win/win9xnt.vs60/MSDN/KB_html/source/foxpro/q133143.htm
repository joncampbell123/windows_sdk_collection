

<HTML>
<HEAD>
<TITLE>PRB: VFP300.ESL Goes in System Directory, Not App's Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133143">
<META NAME="KBModify" CONTENT="1995/07/27">
<META NAME="KBCreate" CONTENT="1995/07/25">
<META NAME="Keywords" CONTENT="kbsetup kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  By design, the Setup Wizard places the Visual FoxPro version 3.0 runtime library (VFP300.ESL) into the \Windows\System subdirectory instead of the directory where the rest of the application files are installed.  NOTE: The advantage of keeping the ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAFI,QBXB,QATJ,QASR,QDI2,QA56,QA55,QAJZ,QAJH,QBHQ,QDIZ,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: VFP300.ESL Goes in System Directory, Not App's Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133143</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
By design, the Setup Wizard places the Visual FoxPro version 3.0 runtime
library (VFP300.ESL) into the \Windows\System subdirectory instead of the
directory where the rest of the application files are installed.
<P>
NOTE: The advantage of keeping the VFP300.ESL in the \Windows\System
subdirectory is that you can have multiple Visual FoxPro applications share
a single VFP300.ESL runtime library.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To install the runtime library (VFP300.ESL) into the application directory
instead of the \Windows\System subdirectory, as the FoxPro version 2.x
Setup Wizard does, follow these steps:

<OL><P><LI>Copy VFP300.ESL to your distribution tree directory.

<P><LI>Run the Setup Wizard.

<P><LI>In step 2 of the Setup Wizard procedure, select the Visual FoxPro 3.0
   Runtime check box.

<P><LI>In step 6 of the Setup Wizard procedure, ensure that VFP300.ESL is set
   to AppDir under the Target Directory column.
<P>
   NOTE: The VFP300.ESL file should be listed in the grid of Step 6 because
   the .ESL file is now in your distribution tree directory.

<P><LI>In step 7 of the Setup Wizard procedure, click the Finish button.

<P><LI>Install the disk images.
<P>
</OL>Placing the VFP300.ESL file in the application directory provides
compatibility for FoxPro version 2.x applications that have SYS(2004)
references. For example, consider this command:
<P>
<PRE>   SET LIBRARY TO SYS(2004)+"FOXTOOLS.FLL" ADDITIVE

</PRE></OL>Here FOXTOOLS.FLL is a file in the application directory.
<P>
This approach does have a disadvantage. Each Visual FoxPro application must
have its own copy of the runtime library. A better approach is to replace
all SYS(2004) references with SYS(16). The SYS(16) function returns the
application path and at the same time allows you to take advantage of
having multiple Visual FoxPro applications sharing a single VFP300.ESL
runtime library.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Specify the following in the Setup Wizard:
<P>
   Step 1: &lt; your Distribution Tree directory &gt;.
   Step 2: Select the Visual FoxPro 3.0 Runtime and Win32s check boxes.
   Stepa 3 - 6: Complete as appropriate
<P>
   NOTE: In Step 6, you won't see VFP300.ESL listed in the grid. The grid
   in Step 6 lists only those files located in &lt; your Distribution Tree
   directory &gt;.
<P>
   Step 7: Click Finish.
<P>
   The Setup Wizard automatically copies the compressed version of the
   VFP300.ESL file from the \VFP\DISTRIB directory to your disk images
   directory.

<P><LI>Run SETUP.EXE from the disk images. It installs VFP300.ESL in the
   \Windows\System subdirectory.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbsetup kbtool kbprb<BR>
KBSubcategory: FxotherGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
