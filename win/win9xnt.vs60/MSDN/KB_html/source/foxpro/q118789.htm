

<HTML>
<HEAD>
<TITLE>FIX: Group Totals Are Incorrect in Report Writer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118789">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/07/31">
<META NAME="Keywords" CONTENT="FxtoolRwriter kbbuglist kbfixlist kbprg kbprint">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you print or preview a page out of sequence in the Report Writer, the group total reports the value from the previously processed record instead of the actual group total.  WORKAROUND  See  Workaround  in the  More Information  section below. ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QAWH,QAR4,QADP,QABH,QBWA,QBE7,QBE6,QAAP,QAGF,QAOX,QAE5,QA7O,QA7N,QBCI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Group Totals Are Incorrect in Report Writer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118789</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.6x | 2.5x
<PRE>WINDOWS   | MACINTOSH
</PRE>kbprint kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for Macintosh, versions 2.5x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you print or preview a page out of sequence in the Report Writer, the
group total reports the value from the previously processed record instead
of the actual group total.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
See "Workaround" in the "More Information" section below.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new report.

<P><LI>USE the INVOICES.DBF table.

<P><LI>Create a data grouping based on CNO+STR(INO).

<P><LI>In the Group Info dialog box, select "New Page (Page No. =1)" and
    "Reprint Header On Subsequent Pages".

<P><LI>Place CNO and INO in the group header band as separate fields.

<P><LI>Place IDATE and ITOTAL in the Detail band.

<P><LI>Place an expression, ITOTAL, in the group footer band. Choose the
    Calculate check box, and then select Sum. Reset the grouping at the
    CNO+STR(INO) group level.

<P><LI>From the Report menu, choose Page Preview.
<P>
    Note that the total on page 1 is correct.

<P><LI>Using the spinner next to Page, select page 15.
<P>
    Note that the ITOTAL field in the Detail band and the ITOTAL field in
    the group footer band do not match.

<P><LI>Look at page 14. Note that the ITOTAL field in the Detail band is the
   same as the ITOTAL field in the group footer band on page 15.
<P>
</OL>This same behavior occurs when only selected pages are printed.
<P>
If you display or print pages 1-15 sequentially, all the totals are
correct.
<P>
<P><h3>Workaround</h3>
 

<OL><P><LI>Do steps 1-6 above.

<P><LI>Create an expression in the group footer band that calls a user-defined
   function (UDF) as follows:
<P>
   pSUM(cno+STR(ino),RECNO())

<P><LI>Create the UDF PSUM.PRG file as follows:
<P>
   * PSUM.PRG
   * ---------------
   PARAMETERS mGrouping, mSavRec
   SUM itotal FOR cno+STR(ino) = mGrouping TO mRetval
   GOTO mSavRec
   RETURN mRetval
   * ---------------------
   * EOP PSUM.PRG

<P><LI>Preview or print the report. The totals are correct at any point.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: vFoxwin Fixlist3.00 FoxMac FoxWin 2.50 2.50a<BR>
2.50b 2.50c 2.60 2.60a buglist2.50 buglist2.50a buglist2.50b buglist2.50c<BR>
buglist2.60 buglist2.60a RWriter<BR>
KBCategory: kbprint kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxtoolRwriter<BR>
Keywords          : FxtoolRwriter kbbuglist kbfixlist kbprg kbprint<BR>
Version           : 2.5x 2.6x | 2.5x<BR>
Platform          : MACINTOSH WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
