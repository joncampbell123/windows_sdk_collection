

<HTML>
<HEAD>
<TITLE>How to Disable a Button &amp; Move the Focus to a Specified Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139874">
<META NAME="KBModify" CONTENT="1995/11/20">
<META NAME="KBCreate" CONTENT="1995/11/19">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using a command button to set the focus to another object, you may sometimes want to disable the command button and move the focus to another object until another event occurs or a value is entered in a field. This article shows by example how...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QADO,QAO4,QBBI,QA5D,QAW6,QBXS,QAJD,QBWS,QABA,QANS,QACI,QAB9,QA9N,QA4P V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Disable a Button &amp; Move the Focus to a Specified Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139874</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using a command button to set the focus to another object, you may
sometimes want to disable the command button and move the focus to another
object until another event occurs or a value is entered in a field. This
article shows by example how to do it.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The most obvious solution, doesn't work. You can't use the SetFocus method
followed by "Enabled=.F." in the Click event of a command button. When the
Click event of the command button is activated, the command button becomes
disabled, but the focus is not moved to the specified control. The focus
moves to the next object in the Tab Order instead of to the specified
object.
<P>
This occurs because the Default event processing occurs after user-defined
code is run. When the default event procedure for the Click event is run,
it discovers that the control is no longer enabled and defaults to setting
the focus to the next object in the Tab order, so the user-specified
SetFocus method is nullified.
<P>
To move the focus to the object specified in the Click event of the command
button, you need to use the NoDefault clause. This results in the focus
being moved to the correct object.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a form, and add three command buttons to the form. label the
   buttons Button 1, Button 2, and Button 3.

<P><LI>In the Click event of Button 1, add this code:
<P>
   ThisForm.Command3.SetFocus
   ThisForm.Command1.Enabled=.F.

<P><LI>Run the form.

<P><LI>Click Button 1, and you will see it become disabled. However, the focus
   is set to Button 2 (the next item in the tab order). Close the form.

<P><LI>Modify the form to add NoDefault to the first line of the Button 1 Click
   event:
<P>
   NoDefault
   ThisForm.Command3.SetFocus
   ThisForm.Command1.Enabled=.F.

<P><LI>Rerun the form, and click Button 1. The focus should now be on Button 3.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information on the use of the NODEFAULT command, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q131095.htm">Q131095</A></B>
   TITLE     : How to Control the Occurrence of a Default Event

</PRE></OL>For additional information on SetFocus behavior, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q130525.htm">Q130525</A></B>
   TITLE     : PRB: SetFocus Doesn't Work When Called in the Valid Event
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin got disable commandbutton<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxotherGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 20, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
