

<HTML>
<HEAD>
<TITLE>RUN /N Not Working Correctly with MS-DOS Batch File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106660">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/11/11">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In FoxPro for Windows versions 2.5, 2.5a, and 2.5b, the order in which lines of code are executed within a program file may seem to be altered when you are using the RUN command with a /N parameter to execute an MS-DOS executable or batch file. The...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QAH4,QBJZ,QBXS,QAUR,QBV8,QAB9,QAHE,QDL9,QBWQ,QBWO,QBWN,QAY2,QAG2,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>RUN /N Not Working Correctly with MS-DOS Batch File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106660</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In FoxPro for Windows versions 2.5, 2.5a, and 2.5b, the order in which
lines of code are executed within a program file may seem to be altered
when you are using the RUN command with a /N parameter to execute an MS-DOS
executable or batch file. The /N parameter stands for NOWAIT and allows
program execution to continue before the command is completed. This makes
it seem as if the MS-DOS batch file is not being executed until after the
other commands.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In FoxPro for Windows, the /N parameter is used for calling Windows-based
applications with the RUN command. The /N parameter of the RUN command has
an optional numeric value that can be included immediately after it to
specify how the Windows-based application is opened. The possible settings
include /N1, /N2, /N3, /N4, and /N7.
<P>
These parameters are not intended for use with MS-DOS executables or batch
files. If any of these parameters are used to call an MS-DOS executable or
batch file, Windows will execute the file in the background and FoxPro will
remain the active application.
<P>
<P><h3>Steps to Reproduce the Behavior</h3>
 

<OL><P><LI>In FoxPro for Windows, from the File menu, choose New.

<P><LI>Select File, and then choose the New button.

<P><LI>In the text editing window, type "DIR" (without the quotation marks).

<P><LI>From the File menu, choose Save, and use RUNTEST.BAT as the filename.
   Choose the Save button.

<P><LI>From the File menu, choose New.

<P><LI>Select Program, and then choose the New button.

<P><LI>Enter the following two lines of code in the program window:
<P>
<P><PRE>      RUN /N4 runtest.bat
      WAIT WINDOW "This is a test"
</PRE>
<P><LI>From the File menu, choose Save, and use ATEST.PRG as the program name.
   Choose the Save button.

<P><LI>Run the program you just created, by issuing the following command in
   the Command window:
<P>
<P><PRE>      DO atest
</PRE><P>
</OL>The WAIT WINDOW message will appear on the screen before FoxPro shells to
MS-DOS to execute the RUN command. This is because the batch file is
running in the background, while FoxPro continues to execute the program
code. This makes it seem like the WAIT WINDOW command is executed before
the batch file, when actually both commands are being executed
simultaneously under the multitasking environment.
<P>
To correct this situation, remove the /N parameter from the RUN command.
For example:
<P>
<PRE>   RUN runtest.bat

</PRE></OL>This allows FoxPro to execute the RUN command first and then execute the
following code after returning from the RUN command.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Language Reference," L3-840
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxWin 2.50 2.5a 2.5b<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
