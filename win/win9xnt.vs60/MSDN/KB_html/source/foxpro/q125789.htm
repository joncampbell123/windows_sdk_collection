

<HTML>
<HEAD>
<TITLE>BUG: Variable Passed/Declared as PRIVATE in UDF Not Returned </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125789">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1995/02/06">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Under the following conditions, the PARAMETER variable will take on the value of the local variable in the UDF when the READ is issued, and the value of the passed variable (x) is never changed in the calling program.  This problem occurs if the fo...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QBE7,QBE6,QAD7,QAKD,QAH7,QAH6,QBVV,QAHE,QBFN,QAUD,QBXS,QAUJ,QAH4,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Variable Passed/Declared as PRIVATE in UDF Not Returned</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125789</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Under the following conditions, the PARAMETER variable will take on the
value of the local variable in the UDF when the READ is issued, and the
value of the passed variable (x) is never changed in the calling program.
<P>
This problem occurs if the following steps are taken:

<OL><P><LI>A variable is passed by reference to a UDF or PROCEDURE such as
   myfunc(x).

<P><LI>The passed variable is received in the UDF or PROCEDURE PARAMETER
   statement with a different variable name such as PARAMETER y.

<P><LI>A variable with the passed name is declared locally in the UDF or
   PROCEDURE such as x=&lt;value&gt;.

<P><LI>A READ is executed against the PARAMETER variable.
<P>
</OL><h2>WORKAROUND</h2>
 
<P>
Adopt a naming scheme that avoids the problem. For example:

<UL><LI>Do not use the passed variable name in the UDF.
<P>
   -or-

<LI>Let the PARAMETER variable have the same name as the passed variable.
<P>
   -or-

<LI>Do not issue a READ against the PARAMETER variable.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Run the following code, noting the comments as it is stepped through in the
Trace Window. Enter 2 into the GET and note that it is not passed back to x
in the calling program.
<P>
<PRE>   CLEAR
   SET UDFPARMS TO REFERENCE
   ACTIVATE WINDOW DEBUG      &amp;&amp; put X and Y in it.
   SET STEP ON
   PUBLIC x

   x=1
   =getx(x)
   @ 11,5 SAY x             &amp;&amp; does not change!
   RELEASE WINDOW TRACE
   RELEASE WINDOW DEBUG
   SET UDFPARMS TO VALUE    &amp;&amp; reset to default

   FUNCTION getx
   PARAMETER y
   PRIVATE x
   x=4
   @ 5, 5 GET y    &amp;&amp; Y contains the correct passed value, 1

   @ 7,5 SAY y

   @ 9,5 SAY x     &amp;&amp; local X contains 4

   * observe that the GET Y takes on the value of the
   * local X as soon as the READ is executed.
   * Enter a new value in GET Y and
   * observe that the value of Y does not change,
   * only the local X value changes
   READ

</PRE></OL><h3>Notes</h3>
 
<P>
Any of the following will allow the value of y to return to x properly:

<UL><LI>Issue the READ against another variable &lt;varname&gt; and set y=&lt;varname&gt;.
<P>
   -or-

<LI>Use x as the PARAMETER variable in the UDF.
<P>
   -or-

<LI>Do not use the variable x in the UDF at all.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos buglist2.50 buglist2.50a<BR>
buglist2.50b buglist2.60 buglist2.60a 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
