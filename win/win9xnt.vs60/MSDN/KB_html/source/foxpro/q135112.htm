

<HTML>
<HEAD>
<TITLE>How to Use GENDBC to Create Utility that Recreates Complex CDX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135112">
<META NAME="KBModify" CONTENT="1996/01/05">
<META NAME="KBCreate" CONTENT="1995/08/16">
<META NAME="Keywords" CONTENT="kbtool kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Gendbc.prg is a program file that is included with Visual FoxPro and is used to generate code for the purpose of rebuilding a database container (.DBC) file. It is installed by default in the VFP30\Tools\Gendbc directory. Once this program is run w...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QAH4,QBWA,QAMB,QAZV,QBXR,QAMA,QA39,QABG,QA3W V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use GENDBC to Create Utility that Recreates Complex CDX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135112</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Gendbc.prg is a program file that is included with Visual FoxPro and is
used to generate code for the purpose of rebuilding a database container
(.DBC) file. It is installed by default in the VFP30\Tools\Gendbc
directory. Once this program is run with your database open, it will
generate code that will recreate the .DBC file, any tables and indexes, and
any persistent relations that exist in the database. If any changes are
made to the structure of your database, you must rerun Gendbc.prg for the
changes to be reflected in the code generated by it.
<P>
NOTE: The resulting generated program is primarily used in case your
database container becomes corrupt. It will rebuild the structure; however,
lost data is irrecoverable. It is a good idea to back up your data on a
regular basis. For more information on Gendbc.prg and its use, please see
the online documentation or help file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
While its main purpose is to create code for rebuilding a database (.DBC)
file, Gendbc.prg can also be used for a variety of other purposes. One such
purpose would be for creating code for rebuilding indexes that are attached
to the tables contained in the database.
<P>
The following code is an excerpt from Testdata.prg, which is the program
file generated by GENDBC with the Testdata.dbc in use. Testdata.dbc is
installed by default in the VFP30\Samples\Data directory.
<P>
<PRE>   ***** Create each index for CUSTOMER *****
   INDEX ON COMPANY TAG COMPANY
   INDEX ON CONTACT TAG CONTACT
   INDEX ON POSTALCODE TAG POSTALCODE
   ALTER TABLE 'CUSTOMER' ADD PRIMARY KEY CUST_ID TAG CUST_ID

   ***** Create each index for PRODUCTS *****
   ALTER TABLE 'PRODUCTS' ADD PRIMARY KEY PRODUCT_ID TAG PRODUCT_ID

   ***** Create each index for ORDITEMS *****
   INDEX ON ORDER_ID+STR(LINE_NO,5,0) TAG ORDER_ID
   INDEX ON PRODUCT_ID TAG PRODUCT_ID

   ***** Create each index for ORDERS *****
   INDEX ON CUST_ID TAG CUST_ID
   INDEX ON EMP_ID TAG EMP_ID
   ALTER TABLE 'ORDERS' ADD PRIMARY KEY ORDER_ID TAG ORDER_ID

   ***** Create each index for EMPLOYEE *****
   ALTER TABLE 'EMPLOYEE' ADD PRIMARY KEY EMP_ID TAG EMP_ID

</PRE>These segments of code can be placed into a separate program file,
procedure, function, stored procedure, or method and can be called at any
time to rebuild the indexes of the tables that are in the Testdata.dbc
database. You can execute Gendbc.prg with your database open and it will
generate similar code for recreating your database and any indexes attached
to the tables contained in it.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin Utilities Tools CDX DBC<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
