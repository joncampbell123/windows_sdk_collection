

<HTML>
<HEAD>
<TITLE>FIX: COPY TO DELIMITED Creates File with No Carriage Returns </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110539">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/03/23">
<META NAME="Keywords" CONTENT="kbbuglist kbcode kbfixlist kbtshoot kbusage">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In FoxPro for Windows and FoxPro for MS-DOS, the following commands create a delimited ASCII file, with each record terminated by a carriage return and linefeed (CR/LF) combination. In FoxPro for Macintosh, the same commands create a delimited ASCI...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QA5V,QBT6,QBV4,QAGB,QA50,QDO0,QDO9,QAR4,QAIH,QAH4,QAHP,QA9N,QA8T,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: COPY TO DELIMITED Creates File with No Carriage Returns</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110539</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50b
MACINTOSH
kbusage kbfixlist kbbuglist kbtshoot kbcode
<P>
 
<PRE> The information in this article applies to:

  - Microsoft FoxPro for Macintosh, version 2.5b
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In FoxPro for Windows and FoxPro for MS-DOS, the following commands create
a delimited ASCII file, with each record terminated by a carriage return
and linefeed (CR/LF) combination. In FoxPro for Macintosh, the same
commands create a delimited ASCII file, with each record terminated by a
linefeed only.
<P>
<PRE>   USE customer
   COPY TO newfile TYPE DELIMITED

</PRE>Many programs, such as Microsoft Word for Macintosh, require that delimited
records be terminated by a carriage return at the end of each record.
This problem occurs regardless of the delimiter used; for example, the
problem occurs whether the DELIMITED or DELIMITED WITH TAB clause is used.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two possible workarounds for this problem:

<UL><LI>Load the text file into an editor that recognizes the linefeed
   characters, and then use the editor's search and replace feature to
   replace each linefeed with a carriage return.
<P>
   To do this using the FoxPro file editor, perform the following:
<P>
   1. In the Command window, type "MODIFY FILE &lt;filename&gt;" (without
<P><PRE>      the quotation marks).
</PRE><P>
   2. From the Edit menu, choose Find.
<P>
   3. In the Look For text box, type "\n" (without the quotation
<P><PRE>      marks) to search for the linefeed.
</PRE><P>
   4. In the Replace With text box, type "\r\n" (without the quotation
<P><PRE>      marks) to replace the linefeed with a carriage return and a linefeed.
</PRE><P>
   5. Choose Replace All.
<P>
   NOTE: For more information on searching for special characters, see
   the following sections of the online Help file:
<P>
<P><PRE>    - FoxPro FOXHELP.HLP online Help file, "Find Dialog" jump text,
      under the "Interface A-Z" topic
</PRE><P>
<P><PRE>    - FoxPro FOXHELP.DBF online Help file, "Find" topic, under "The
      FoxPro Interface" section
</PRE><P>
   -or-

<LI>Write a program that performs low-level file I/O and adds a carriage
   return to each line, as shown in the following sample program.
<P>
   USE SYS(2004)+"\tutorial\customer.dbf"
   COPY TO test.txt TYPE DELIMITED FOR RECNO() &lt; 5
<P>
<PRE>   infile=FOPEN("test.txt",10)         &amp;&amp; read-only, unbuffered
   IF infile &gt; 0       &amp;&amp; file opened?
      SET SAFETY OFF   &amp;&amp; no warnings
      outfile=FCREATE("test2.txt",0)  &amp;&amp; create read/write file
      IF outfile &gt; 0
         FOR F=1 TO FCOUNT()       &amp;&amp; loop through fields +
            =FSEEK(outfile,0,2)     &amp;&amp; go to end of file
            =FWRITE(outfile,CHR(34)+FIELD(F)+CHR(34)+ ;
               IIF(F=FCOUNT(),[],[,])) &amp;&amp; write field names
         ENDFOR
         =FWRITE(outfile,CHR(13))    &amp;&amp; carriage return (CR) +
         DO WHILE NOT FEOF(infile)   &amp;&amp; now get data from
            linein=FGETS(infile)      &amp;&amp; the input file
            =FSEEK(outfile,0,2)      &amp;&amp; point to end of file
            =FWRITE(outfile,linein+CHR(13))&amp;&amp; write data with CR terminator
         ENDDO
         =FCLOSE(outfile)   &amp;&amp; close output file
      ENDIF
      =FCLOSE(infile)       &amp;&amp; close input file
   ENDIF

   USE                      &amp;&amp; close the database

   NOTE: The plus sign ("+") at the end of a line denotes a code block that
   is necessary only if saving the field names is necessary, such as when
   you are creating a Word Merge list.

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
FoxPro 2.6a for Macintosh.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac 2.50b fixlist2.60a buglist2.50b line<BR>
feed hard return soft return tshoot trouble-shoot<BR>
KBCategory: kbusage kbfixlist kbbuglist kbtshoot kbcode<BR>
KBSubcategory:<BR>
Keywords          : kbbuglist kbcode kbfixlist kbtshoot kbusage<BR>
Version           : 2.50b<BR>
Platform          : MACINTOSH<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
