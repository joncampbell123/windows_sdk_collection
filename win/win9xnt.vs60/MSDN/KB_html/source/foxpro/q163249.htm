

<HTML>
<HEAD>
<TITLE>HOWTO: Wizstyle Button Classes Have Usercontrolmode in VFP5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163249">
<META NAME="KBModify" CONTENT="1997/03/20">
<META NAME="KBCreate" CONTENT="1997/02/06">
<META NAME="Keywords" CONTENT="FxprgClassoop FxtoolFormdes FxtoolWizscreen vfoxwin kbhowto kbkeyword kbtool kbusage">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The txtbtns and pictbtns classes contained in the Wizstyle.vcx library of Microsoft Visual FoxPro for Windows version 5.0 have a new custom property that controls the enabled/disabled property of a ComboBox, ListBox, or Spinner control placed on th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QAHP,QBXS,QAB5,QAOE,QAMN,QBWS,QAUR,QBV3,QA4P,QBV4,QAJQ,QAY2,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Wizstyle Button Classes Have Usercontrolmode in VFP5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163249</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00
WINDOWS
kbkeyword kbusage kbtool kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The txtbtns and pictbtns classes contained in the Wizstyle.vcx library of
Microsoft Visual FoxPro for Windows version 5.0 have a new custom property
that controls the enabled/disabled property of a ComboBox, ListBox, or
Spinner control placed on the same form.
<P>
The Form wizard automatically drops a txtbtns object named "BUTTONSET1" on
any form it builds. All TextBox controls populated from fields in tables
are disabled until the Edit button of the BUTTONSET1 collection is clicked.
Clicking Save or Revert again disables those controls.
<P>
In Visual FoxPro 3.0 and 3.0b the developer had to add code to the click
methods of those buttons to control the enabled/disabled status of an
additional ComboBox, ListBox, or Spinner control in order to control
whether event methods of those would be allowed to modify values elsewhere
in a table or property.
<P>
When set to .F. the new "Usercontrolmode" property of the txtbtns and
pictbtns classes let the affected controls (ComboBox, ListBox, or Spinner)
work the same as they did in Visual FoxPro 3.0.
<P>
When Usercontrolmode is set to .T. the "Edit," "Save," and "Revert" buttons
enable and disable those controls the same way they enable/disable the
TextBox controls on that form.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Demonstrate the Usercontrolmode Property</h3>
 

<OL><P><LI>Issue the following command in the Command window:
<P>
<P><PRE>      SET DEFAULT TO HOME()+"\samples\data"
</PRE>
<P><LI>Open the Testdata database.

<P><LI>Select Wizards and then Form from the Tools menu.

<P><LI>In the Wizard Selection dialog box, click OK for the Form Wizard.

<P><LI>In the Form Wizard dialog box, click the double arrow button to
   select all fields from the customer table, then click Finish.

<P><LI>Select the "Save form and modify it in the Form Designer" option, then
   click Finish. (The form is saved as Customer.scx by default.)

<P><LI>Click Save in the Save As dialog box.

<P><LI>Size the form so that you can see the buttons at the bottom.

<P><LI>From the Form Controls toolbar select a ComboBox, and place it on the
   form.

<P><LI>In the property sheet for the ComboBox set RowSourceType to
<P><PRE>    "5 - Array."
</PRE>
<P><LI>Set RowSource to Thisform.myarray.

<P><LI>Click New Property from the Form menu. Define a new property by
   typing "myarray(20)" (without the quotes) into Name field and click
   "Add." Then click Close.

<P><LI>In the Init event method of the ComboBox enter the following:
<P>
<P><PRE>       SELECT DISTINCT country FROM customer ;
<PRE></PRE>          INTO ARRAY thisform.myarray NOCONSOLE
       This.DisplayValue = Thisform.country1.value  &amp;&amp; the textbox
       This.refresh

</PRE><P><LI>Run the form. Note that the ComboBox is enabled. Click Exit.

<P><LI>Back in the development mode, select the BUTTONSET1 control.

<P><LI>In the property sheet for BUTTONSET1 scroll down to the custom
   properties and find "Usercontrolmode." Set that to .T. (True). (It
   is not a toggled property, so type the string ".T." without quotes
   in the property setting combo box at the top of the sheet.)

<P><LI>Run the form. Note that the combo box is disabled. Click Edit and
   notice that the combo box, and all of the text boxes, are enabled.
   Click Revert and notice that the controls are disabled.
<P>
</OL>Using this feature in a project, the developer may want to change the
DisabledBackColor property to white to match the backcolor of all of the
other controls on the form.
<P>
(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Chris Jensen, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbkeyword kbusage kbtool kbhowto<BR>
KBSubcategory: FxprgClassoop FxtoolFormdes FxtoolWizscreen vfoxwin<BR>
Additional reference words: 5.00<BR>
Keywords          : FxprgClassoop FxtoolFormdes FxtoolWizscreen vfoxwin kbhowto kbkeyword kbtool kbusage<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
