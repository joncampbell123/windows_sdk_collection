

<HTML>
<HEAD>
<TITLE>HOWTO: How to Convert a Word Table to a FoxPro Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176655">
<META NAME="KBModify" CONTENT="1997/12/15">
<META NAME="KBCreate" CONTENT="1997/11/12">
<META NAME="Keywords" CONTENT="FoxMac FoxWin VFoxMac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Sometimes, you may need to convert a Word table object into a FoxPro or Visual FoxPro table (.dbf) file. The Word table object is not really a .dbf file and FoxPro cannot directly read the data contained in the Word table. This article provides thr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBJZ,QAUR,QA5V,QBTI,QBRZ,QBWS,QDO7,QDI1,QA7O,QA7N,QARR,QAH4,QAZZ,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: How to Convert a Word Table to a FoxPro Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176655</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.6, 2.6a
<LI>Microsoft Visual FoxPro for Windows, versions 3.0b, 5.0, 5.0a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft FoxPro for Macintosh, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes, you may need to convert a Word table object into a FoxPro or
Visual FoxPro table (.dbf) file. The Word table object is not really a .dbf
file and FoxPro cannot directly read the data contained in the Word table.
This article provides three methods of converting a Word table into a .dbf
file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The first two methods utilize the functionality of Microsoft Word. The
third method uses FoxPro's low-level file functions to read a text file and
place data from each of the "fields" in the Word table into the
corresponding field of a FoxPro table.
<P>
For demonstration purposes, the code examples use a Word table containing
five columns and eight rows. The sample data for the table appears below:
<P>
<PRE>   First Name       Last Name    State      DOB       Terms
   George           Washington    VA     2/22/1732      2
   John             Adams         MA     10/30/1735     2
   Thomas           Jefferson     VA     04/13/1743     2
   James            Madison       VA     03/16/1751     2
   James            Monroe        VA     04/28/1758     2
   John             Adams         MA     04/11/1767     1
   Andrew           Jackson       SC     03/15/1767     3

</PRE><h3>Method One</h3>
 

<OL><P><LI>Create the table described above in Word. Select the entire table and
   then click Copy from the Edit menu.

<P><LI>Start Microsoft Excel and open an empty worksheet.

<P><LI>Place the cursor in the first cell of the worksheet and click Paste from
   the Edit menu. The contents of the table should appear in the
   spreadsheet.

<P><LI>On the File menu, click Save As, and then select DBF 3 (dBase III) from
   the "Save File as Type" list. Next, click Save. This saves the table as
   a .dbf file.

<P><LI>Open the table in FoxPro with the USE command. If FoxPro prompts for a
   code page, choose 1252 - Windows ANSI.
<P>
</OL>This method converts the contents of the first row of the Word table to
the field names of the .dbf file.
<P>
<P><h3>Method Two</h3>
 

<OL><P><LI>Using Word, create and save the table described in the More Information
   section. On the Table menu, click Select Table.

<P><LI>Click the Table menu again and select "Convert Table to Text."

<P><LI>In the "Convert Table to Text" dialog box, select commas in the
   "Separate Text With" section and click OK.

<P><LI>On the File menu, click "Save As", and then select MS-DOS Text from the
   "Save as File Type." Name the file Test.txt and click Save.

<P><LI>Create a table in FoxPro with the same structure as the Word table.

<P><LI>In the FoxPro Command window, issue the following command:
<P>
<P><PRE>      APPEND FROM &lt;filename&gt; TYPE DELIMITED
</PRE><P>
   The APPEND FROM places one record in the table for each row in the text
   file.
<P>
</OL>If the Word table contains headings for each column, the first record of
the new .dbf file now contains this data. Use the FoxPro DELETE command to
remove this record.
<P>
<P><h3>Method Three</h3>
 

<OL><P><LI>Using Word, create the table described in the More Information section.
   Select the table in Word and then copy and paste the table to a new Word
   Document.

<P><LI>On the File menu, click Save As and save the file as an MS-DOS Text
   file.

<P><LI>Create a .dbf file in FoxPro that contains the same fields as the Word
   table. The size of each field should be large enough to accommodate all
   the data from the contents of the largest field.

<P><LI>Copy the following code into a program file in FoxPro and then execute
   the code:
<P>
<P><PRE>      PARAMETERS nrows
</PRE><P>
<P><PRE>      USE ztable1.DBF
</PRE><P>
<P><PRE>      =AFIELDS(atbldata,"ztable1")
      x=1
      fname=""
      STORE FOPEN('test.txt') TO hTextFile  &amp;&amp; Open the file.
<PRE></PRE>      STORE FSEEK(hTextFile, 0, 2) TO FileEnd     &amp;&amp; Move pointer to EOF.
      STORE FSEEK(hTextFile, 0) TO FileTop        &amp;&amp; Move pointer to BOF.
      IF FileEnd &lt;= 0                             &amp;&amp; Is file empty?
      WAIT WINDOW 'This file is empty!' NOWAIT
      ELSE
      FSIZE=FSEEK(hTextFile,0,2)               &amp;&amp; Determine file size.
      =FSEEK(hTextFile,0,0)                    &amp;&amp; Go to the top of file.
      DO WHILE x &lt;= nrows
      APPEND BLANK
      FOR i= 1 TO ALEN(atbldata,1)   &amp;&amp; Loop for each field in Array.
      FieldData = FGETS(hTextFile, FileEnd)  &amp;&amp; Store contents in
                                             &amp;&amp; a variable.
      fname=ALLTRIM(atbldata(i,1))     &amp;&amp; Trims blanks from data.
      REPLACE (fname) WITH FieldData   &amp;&amp; Places data in .dbf
                                              &amp;&amp; file field.
      ENDFOR
      x=x+1                       &amp;&amp; Increment counter for next field.
      ENDDO
      ENDIF
      = FCLOSE(hTextFile)                          &amp;&amp; Close the file.

</PRE></OL>To use this program with the data provided above, use the following syntax:
<P>
<PRE>      DO Tbltodbf.prg with 7

</PRE>NOTE: The number 7 in the above command indicates the number of rows in the
Word table.
<P>
This code makes the following assumptions:

<UL><LI>A FoxPro table named Zwordtbl.dbf exists with the same structure as the
   Word table.

<LI>The Word table is saved to an MS-DOS text file called Test.txt.

<LI>All the fields in the Word table will be treated as character field
   types.

<LI>The number of rows to import from the Word table is known and passed
   to the program.

<LI>The first row in the Word table is treated like a record in the FoxPro
   table.

<LI>The Word table contains no fields longer than 254 characters.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : FoxMac FoxWin VFoxMac vfoxwin<BR>
Version           : MACINTOSH:2.6a,3.0b; WINDOWS:2.6,2.6a,3.0b,5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
