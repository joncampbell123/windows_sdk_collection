

<HTML>
<HEAD>
<TITLE>How To Use the Pinnacle Graph Control to Graph Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161183">
<META NAME="KBModify" CONTENT="1996/12/18">
<META NAME="KBCreate" CONTENT="1996/12/18">
<META NAME="Keywords" CONTENT="kb3rdparty kbole kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article explains how to use the Pinnacle Publishing Graph ActiveX control that ships with Visual Basic. The Pinnacle Graph control is available in a 16- or 32-bit version.  MORE INFORMATION  This example uses the Pinnacle Graph Control that sh...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QAB5,QAOE,QAMN,QAHV,QBS0,QBWS,QAMB,QAVT,QADZ,QABO,QBT6,QBJZ,QBV4,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Use the Pinnacle Graph Control to Graph Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161183</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to use the Pinnacle Publishing Graph ActiveX
control that ships with Visual Basic. The Pinnacle Graph control is
available in a 16- or 32-bit version.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This example uses the Pinnacle Graph Control that ships with Visual Basic
4.0. In order to use the Pinnacle Graph Control, it must first be properly
registered. For more information about registering controls, please see the
Microsoft Knowledge Base article referenced below.
<P>
In Visual FoxPro, perform the following steps:

<OL><P><LI>Add the Pinnacle Graph ActiveX control. On the Tools menu, click
   Options, and click the Controls tab. Click ActiveX controls and select
   Pinnacle-BPS Graph Control.

<P><LI>Create a new local view using the TestData!Employee table.

<P><LI>Add the field Count(*) to the Available fields Expression text box.

<P><LI>Click the Group By tab and add Employee.City

<P><LI>Save the local view as "Group by City."

<P><LI>Create a new form and add the Pinnacle Graph Control from the ActiveX
   controls. Size the Graph to accordingly. The default name of the control
   is OleControl1.

<P><LI>Set the Visible property of the OleControl1 to .F.

<P><LI>Add the local view "Group by City" in the DataEnvironment of the form.

<P><LI>Add a command button. Set the name property to cmdGraph with the caption
   set to Graph.

<P><LI>In the Click event of cmdGraph add the following code:
<P>
<P><PRE>       WITH thisform.Olecontrol1
<PRE></PRE>         .NumPoints = reccount()
         .NumSets = 1
         .Autoinc = 1
         .GraphTitle = "Employees by City"
         .Labels = 1
         .FontUse = 2
         .FontSize = 200
       ENDWITH

       GO TOP
       * Add the Data for each bar
       DO WHILE !EOF()
          ThisForm.OleControl1.GraphData = cnt
          SKIP
       ENDDO

       GO TOP
       * Add the label for each bar
       DO WHILE !EOF()
          ThisForm.OleControl1.LabelText = City
       SKIP
       ENDDO

       WITH ThisForm.OleControl1
          .ThisSet = 1
          .GraphType = 4
          .DrawMode = 2
          .Visible = .T.
       ENDWITH

</PRE><P><LI>Run the form and click the command button.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about registering controls, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q146219.htm">Q146219</A></B>
   TITLE     : How To Register an OLE Custom Control (.ocx file) Manually
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kb3rdparty kbole kbhowto<BR>
KBSubcategory: FxinteropOcx<BR>
Additional reference words: 5.00 VFoxWin kbdse
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
