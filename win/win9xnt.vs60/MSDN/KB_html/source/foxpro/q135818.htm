

<HTML>
<HEAD>
<TITLE>How to List Available Drives from Visual FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135818">
<META NAME="KBModify" CONTENT="1995/09/28">
<META NAME="KBCreate" CONTENT="1995/08/28">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to determine which drive letters and types are available on your computer. The sample code in this article can be used to list the available drives and their types.  MORE INFORMATION  The sample code in this articl...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC9,QBQU,QAH4,QAGX,QAY5,QAUD,QAPF,QAVZ,QA4B,QAFI,QBV8,QAB9,QBXB,QA59,QAYL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to List Available Drives from Visual FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135818</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to determine which drive letters and
types are available on your computer. The sample code in this article can
be used to list the available drives and their types.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The sample code in this article uses two API functions; DRIVETYPE() and
WNetGetConnection():

<UL><LI>DRIVETYPE(): The syntax for DRIVETYPE is:
<P>
   x = DRIVETYPE(&lt;expC&gt;)
<P>
   Here &lt;expC&gt; is the drive letter for which you want to know the drive
   type. DRIVETYPE() returns a numeric value representing the drive type of
   the drive . Possible return values are:
<P>
   0 - Drive does not exist
   1 - Drive has no root directory
   2 - Floppy Disk
   3 - Hard Disk
   4 - Removable or Network drive
   5 - CD-ROM
   6 - RAM Disk
<P>
   The DRIVETYPE function is included in FOXTOOLS.FLL. For more information
   on this function, please see FOXTOOLS.HLP in the VFP directory.

<LI>WNetGetConnection(): When passed a valid network drive letter, the
   WNetGetConnection() function returns the name of the network resource.
   The syntax for WNetGetConnection() is:
<P>
   x = WNetGetConnection(lpszLocalName, lpszRemoteName, lpcchBuffer)
<P>
   Here lpszLocalName points to a buffer containing the local drive letter,
   lpszRemoteName points to a buffer that will receive the network resource
   name and lpcchBuffer points to a variable that contains the size, in
   characters, of the buffer pointed to by lpszRemoteName.
   WNetGetConnection is NOT part of FOXTOOLS.FLL, consequently before using
   this function you must declare it. For more information on this function
   see WIN32API.HLP.
<P>
</UL><h3>Code Sample</h3>
 
<P>
The following code sample echos to the desktop drive letters A through Z,
and displays the drive type of each. To run this example, open a new
program (.prg) file, enter the following code, and run it:
<P>
** BEGIN CODE SAMPLE
SET LIBRARY TO \VFP\FOXTOOLS.FLL &amp; Register the FOXTOOLS Library
DECLARE INTEGER WNetGetConnection IN win32api ;
<PRE>     STRING lpszLocalName,;
     STRING lpszRemoteName,;
     INTEGER @ lpchBuffer &amp;&amp; Declare the external WNetGetConnection ;
     API function
</PRE>slpRemoteName = SPACE(254) &amp;&amp; Initialize variables
slen = LEN(slpRemoteName) &amp;&amp; Initialize variables
FOR I = 1 to 26 &amp;&amp; Loop through drive letters A thru Z
<PRE>     DRIVE = CHR(I + 64)
     DTYPE = DRIVETYPE(drive) &amp;&amp; Determine drive type
     DO CASE
          CASE DTYPE = 0 &amp;&amp; Non existent drives
              ? "Drive " + DRIVE + ": does not exist"
          CASE DTYPE = 1 &amp;&amp; No root directory
              ? "Drive " + DRIVE + ": has no root directory"
          CASE DTYPE = 2 &amp;&amp; Floppy drives
               ? "Drive " + DRIVE + ": is a floppy drive"
          CASE DTYPE = 3 &amp;&amp; Hard drives
               ? "Drive " + DRIVE + ": is a local hard drive"
          CASE dtype = 4 &amp;&amp; Removable or network drives
               iSuccess = WNetGetConnection(drive + ;
               ":",@slpRemoteName,@slen)
               IF iSuccess = 0
                    ? "Drive " + Drive + ": is a network" + ;
                    " drive connected to " + LEFT(slpRemoteName,;
                    ATC(chr(0),slpRemoteName) - 1)
               ENDIF
          CASE DTYPE = 5 &amp;&amp; CD-ROM drives
               ? "Drive " + DRIVE + ": is a CD ROM drive"
          CASE DTYPE = 6 &amp;&amp; RAM drives
               ? "Drive " + DRIVE + ": is a RAM drive"
     ENDCASE
</PRE>ENDFOR
** END CODE SAMPLE
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 28, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
