

<HTML>
<HEAD>
<TITLE>SET DOHISTORY ON Slows Performance of FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87807 ">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1992/08/06">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The SET DOHISTORY ON command affects the performance of Microsoft FoxPro. Use this command only for debugging purposes.  MORE INFORMATION  Some users have reported that, contrary to their expectations, FoxPro takes longer to run an application than...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBCF,QBXS,QAMR,QBV8,QAB9,QAU3,QAPN,QAK6,QABG,QAY5,QAV1,QAV0,QAEF,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SET DOHISTORY ON Slows Performance of FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87807 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 1.0, 1.01, 1.02, 2.0, 2.5,
   and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The SET DOHISTORY ON command affects the performance of Microsoft FoxPro.
Use this command only for debugging purposes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Some users have reported that, contrary to their expectations, FoxPro takes
longer to run an application than Microsoft FoxBASE+. Upon further
investigation, it was determined that the SET DOHISTORY ON command is in
the slow application. Once this command has been removed from the
application, FoxPro runs much faster than FoxBASE+.
<P>
FoxBASE+ implements the SET DOHISTORY feature by dynamically decompiling
the executed code, placing the resulting pseudocode in a fixed-sized
buffer, and discarding the oldest source line(s) when the buffer fills up.
While this process is reasonably efficient, FoxBASE+ programs run several
times slower when DOHISTORY is ON.
<P>
FoxPro object code is very different from FoxBASE+ code; it is almost
impossible to decompile FoxPro code. Therefore, in FoxPro, the original
source code must be present to provide the TRACE, DEBUG, and other
debugging facilities.
<P>
The DOHISTORY capability in FoxPro appends the actual source line to the
code in the Command window. There is no arbitrary limit on the amount of
source code that this method makes available. Because the Command window is
a special instance of the FoxPro editor, DOHISTORY causes the Command
window to construct a disk-based document.
<P>
While this method has certain obvious advantages, it is slower than the
method employed in FoxBASE+. It is also possible to fill up even a large
disk very quickly.
<P>
The SET DOHISTORY ON command should be used only as a temporary debugging
aide to isolate particularly stubborn bugs in application code.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 1.00 2.00 2.50 2.50a 2.x Fox base<BR>
plus<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
