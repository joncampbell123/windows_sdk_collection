

<HTML>
<HEAD>
<TITLE>How to Play Waveform (.WAV) Files in FoxPro for Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102585">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/08/04">
<META NAME="Keywords" CONTENT="kbmm kbsound kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The code example below shows how to play waveform (.WAV) files from within FoxPro for Windows. This code can be placed in several different snippets including SETUP, VALID, WHEN, and MORE.  MORE INFORMATION  The example below uses the FoxTools libr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYS,QAHR,QDL9,QBWO,QBWN,QBWQ,QAY5,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Play Waveform (.WAV) Files in FoxPro for Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102585</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The code example below shows how to play waveform (.WAV) files from
within FoxPro for Windows. This code can be placed in several
different snippets including SETUP, VALID, WHEN, and MORE.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The example below uses the FoxTools library to call a function in
MMSYSTEM.DLL. This dynamic-link library (DLL) is shipped with Windows
3.1 and is located in the Windows SYSTEM subdirectory (usually
C:\WINDOWS\SYSTEM).
<P>
<PRE>   SET LIBRARY TO SYS(2004)+"FOXTOOLS.FLL"
   MREGISTER=REGFN("SndPlaySound","CI","I","mmsystem")
   MWAVE="Chimes.wav"
   MFLAG=1
   MCALL=CALLFN(MREGISTER,MWAVE,MFLAG)

</PRE>The sndPlaySound() function plays a waveform sound specified by a
filename or by an entry in the [Sounds] section of the WIN.INI file.
If the sound can't be found, it plays the default sound specified by
the SystemDefault entry in the [Sounds] section of the WIN.INI file.
If there is a now SystemDefault entry or if the default sound can't be
found, the function makes no sound and returns FALSE.
<P>
MWAVE specifies the name of the sound to play. The function searches
the [Sounds] section of the WIN.INI file for an entry with this name
and plays the associated waveform file. If no entry by this name
exists, it assumes the name is the name of a waveform file. If this
parameter is NULL, any currently playing sound is stopped. (For
example, MWAVE="SystemStart" will play the waveform file associated
with Windows starting, and MWAVE=0 will stop any currently playing
sound.)
<P>
MFLAG specifies options for playing the sound using one or more of the
following flags:
<P>
<PRE>   0 - The sound is played synchronously and the function does not
       return until the sound ends (all programs stop processing until
       the sound is done playing).

   1 - The sound is played asynchronously and the function returns
       immediately after beginning the sound. To terminate an
       asynchronously played sound, call the sndPlaySound() function
       with MWAVE set to NULL. (The program will continue operation
       with the sound playing at the same time.)

   2 - If the sound can't be found, the function returns silently
       without playing the default sound.

   9 - The sound will continue to play repeatedly until sndPlaySound()
       is called again with MWAVE set to NULL.

  16 - If a sound is currently playing, the function will immediately
       return FALSE without playing the requested sound.

   NOTE: To use more than one option, add the numbers together. [For
   example, use 11 to play the sound repeatedly; if the sound cannot
   be found, sndPlaySound() will not play the default sound.]

</PRE>The sound must fit in available physical memory and be playable by an
installed waveform audio device driver. The directories searched for
sound files are, in order: the current directory; the Windows program
directory; the Windows SYSTEM subdirectory; the directories listed in
the PATH environment variable in the AUTOEXEC.BAT file; the list of
directories mapped in a network.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Windows with Multimedia "Programmer's Reference," version
1.0
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxWin 2.50 2.50a wave form WAV<BR>
wave<BR>
KBCategory: kbmm kbsound kbprg kbcode<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
