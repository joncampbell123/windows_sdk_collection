

<HTML>
<HEAD>
<TITLE>PRB: Cannot Open Form That Has =CREATEOBJECT() Property Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148331">
<META NAME="KBModify" CONTENT="1996/03/14">
<META NAME="KBCreate" CONTENT="1996/03/11">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a form property is assigned the value =CREATEOBJECT(           ) with the WriteExpression() method, the form can no longer be opened in the Form Designer. If an attempt is made to open the form, the error message  Data type is invalid for this p...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBWS,QAEF,QAI2,QAB4,QAGB,QDIU,QBVV,QAKD,QAJX,QAH4,QADR,QAB9,QBJZ,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Open Form That Has =CREATEOBJECT() Property Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 14, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a form property is assigned the value =CREATEOBJECT(&lt;classname&gt;) with
the WriteExpression() method, the form can no longer be opened in the Form
Designer. If an attempt is made to open the form, the error message "Data
type is invalid for this property" is displayed and the Form Designer is
not opened.
<P>
<P><h2>CAUSE</h2>
 
<P>
Although WriteExpression allows storing an object reference to a form
property, this is not valid in Visual FoxPro.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a program that contains the following code:
<P>
   IF FILE('myform.scx')
<P><PRE>     ERASE myform.scx
     ERASE myform.sct
</PRE>   ENDIF
   CLEAR TYPEAHEAD
   KEYBOARD '{ALT+M}pmyprop{ENTER}'
   KEYBOARD '{ALT+F}cy'
   CREATE FORM myform
   MODIFY FORM myform NOWAIT
   =ASELOBJ(x,1)
   x(1).WRITEEXPRESSION('myprop',"=CREATEOBJECT('commandbutton')")
   CLEAR TYPEAHEAD
   KEYBOARD 'Y'
   CLOSE ALL

<P><LI>Run the program.

<P><LI>Try to open the Myform form in the Form Designer by choosing Open from
   the File menu. Select Form under Files of Type, and then select Myform.
   The message "Data type is invalid for this property" will be displayed
   and the Form Designer does not open.
<P>
</OL>NOTE: If =CREATEOBJECT(&lt;classname&gt;) is entered through the property sheet,
the error message is displayed and the property is reset to its original
value.
<P>
<P><h3>How to Repair the Form</h3>
 
<P>
If the form cannot be opened (as described in Step 3), you can repair it by
using this procedure:

<OL><P><LI>Make a backup copy of the form's .scx and .sct files:
<P>
   Copy file &lt;formname&gt;.scx to file &lt;formname&gt;.sbx
   Copy file &lt;formname&gt;.sct to file &lt;formname&gt;.sbt

<P><LI>Open the form's .scx file as a table by entering the following commands
   in the Command window:
<P>
   USE &lt;formname&gt;.scx
   BROWSE FIELDS properties FOR UPPER("(crea") $ UPPER(properties)

<P><LI>Double-click the word Memo. Then find and remove the following line
   where PropertyName is the name of the property assigned the
   =CREATEOBJECT() expression:
<P>
<P><PRE>      &lt;PropertyName&gt;=CREATEOBJECT(&lt;classname&gt;)
</PRE><P>
   NOTE: Do not change any other lines. Changing any other lines may render
   the form unusable.

<P><LI>Type a USE command in the Command window to close the .scx file. You
   should now be able to open the form in the Form Designer. If the form
   opens properly, you can delete the backup files created in Step 1.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 14, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
