

<HTML>
<HEAD>
<TITLE>PRB: Scrolling Message "Record not available ... Please Wait" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125576">
<META NAME="KBModify" CONTENT="1997/05/27">
<META NAME="KBCreate" CONTENT="1995/01/31">
<META NAME="Keywords" CONTENT="FoxWin FxnetworkOther kbnetwork vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A FoxPro application running in a multiuser environment occasionally displays a message box containing this scrolling message:     Record not available ... Please Wait  This message may scroll for a few minutes or for as long as an hour or more.  C...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QA5V,QAVZ,QADN,QAEV,QABT,QBVV,QAX6,QAY2,QAXB,QAH4,QAEF,QAYC,QA58,QAU3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Scrolling Message "Record not available ... Please Wait"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125576</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A FoxPro application running in a multiuser environment occasionally
displays a message box containing this scrolling message:
<P>
<PRE>   Record not available ... Please Wait

</PRE>This message may scroll for a few minutes or for as long as an hour or
more.
<P>
<P><h2>CAUSE</h2>
 
<P>
FoxPro is receiving a busy signal when requesting a process from the
server. There are two possible causes for the busy signal:

<UL><LI>Novell's Transaction Tracking Services (TTS) is active.
<P>
   -or-

<LI>There is a contention problem on the network server due to:
<P>
<P><PRE>    - Several users actively adding or updating records to a database where
      the CDX contains a large number of Tags or several very complex Tags.
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - A large number of users are actively adding or updating records in a
      less than optimal network environment.
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - Various combinations of the above.
</PRE><P>
</UL>The scrolling message results from FoxPro requesting a process from the
network server and receiving a busy signal. This is not an error message,
but rather an informational message from FoxPro. It is in essence saying "I
have completed your transactions and handed off the update to the file
sever, but the file server is still working on completing some other
updates to this file. Would you please wait?"
<P>
<P><h2>RESOLUTION</h2>
 
<P>
A workstation that gets this message will eventually be able to complete
the pending process, although this could take a considerable amount of
time.
<P>
If TTS is running, try turning it off. FoxPro does not provide direct
support for Novell TTS. However, Novell provides a library (NWTTS.DLL) that
works with the FoxPro Library Construction Kit (LCK) to accomplish
transactional processing.
<P>
Support for transactions has been implemented in Visual FoxPro. For more
information, search for 'Transactions' in the online Help.
<P>
If TTS is not running, the problem is most likely a contention problem on
the server. This means that the server is receiving more requests for
processing transactions than it can deal with so they're backing up in the
server's process queue. Eventually the server will catch up, the queue will
be emptied out, and things will be back to normal.
<P>
<P><h3>Avoiding This Network Storm</h3>
 
<P>
It's important to note that because there is no error condition, there is
no error to trap. Once this message appears, the network is already
experiencing a network storm and the only resolution is to have all users
stop what they're doing and wait for it to clear. The preferred approach is
to take steps to avoid the storm in the first place.
<P>
Two known approaches involve upgrading to a more powerful network or
moderating the flow of process requests to the network server. While
upgrading the network may be prohibitive, it is often relatively easy to
moderate the flow of process requests to the server.
<P>
<P><h3>Moderating the Flow of Process Requests</h3>
 
<P>
Here are two approaches you can use to moderate the flow of process
requests to the network server:

<UL><LI>Change over to a client/server database system such as SQL Server.
<P>
   This concentrates more of the processing directly on the server and
   not over the network thereby reducing the amount of transaction
   processing handled by the network server.

<LI>Change your record locking/adding scheme to a more efficient one,
   and/or introduce a small delay in the routines to allow the network
   server time to catch up after each process.
<P>
   NOTE: Minimizing the number and complexity of index tags may help
   this situation. However, this problem has been reproduced on a
   network with only four workstations and with as few as four tags in
   the index.
<P>
</UL><h3>Coding Techniques Effective in Dealing with This Problem</h3>
 
<P>
Two coding techniques that have proven effective in dealing with this
problem are: changing from record locking to file locking and introducing a
wait state (delay) after adding to or changing any tables.
<P>
Changing to file locking means that you use FLOCK() rather than RLOCK()
when to add or change a record. It's important that you keep each lock only
long enough to make the addition or change, and then release it.
<P>
Although going to a file locking scheme may seem to be less efficient, it
has the added benefit of spreading out process requests and leaves your
program code in complete control. Because you are requesting a lock on the
file before you process any records, you can provide more appropriate
options when locks are unavailable due to heavy traffic.
<P>
In effect, you are shifting processing control from the server to your
program. You can add a delay by including a WAIT "" TIMEOUT n command
immediately after releasing the file lock. To help spread out process
requests to the server, you can vary the amount of time to wait (specified
by n) depending on the time it takes to obtain the lock. One algorithm to
accomplish this calls for requesting the lock within a loop and counting
the iterations until the lock is obtained. Then use this count in a formula
to arrive at a delay time. The longer it takes to obtain a lock, the longer
the wait state. When you consider this taking place on several (or many)
workstations, the net effect is to flatten out the flow of process requests
to the server. This eliminates the peak conditions that result in the
network storm.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: novel<BR>
Keywords            : FoxWin FxnetworkOther kbnetwork vfoxwin<BR>
Version             : 2.6a 3.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
