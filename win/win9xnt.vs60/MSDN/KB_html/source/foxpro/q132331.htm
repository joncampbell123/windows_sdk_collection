

<HTML>
<HEAD>
<TITLE>PRB: Null Values Disappear When Selected in a Grid or Browse </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132331">
<META NAME="KBModify" CONTENT="1995/07/28">
<META NAME="KBCreate" CONTENT="1995/07/06">
<META NAME="Keywords" CONTENT="kbui kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The text string  .NULL.  for null values disappears when the field is selected. When you move out of the field,  .NULL.  reappears. This is by design.  RESOLUTION  To display a text string  .NULL.  for the currently selected field, create a column ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATX,QA5V,QAMB,QAKD,QACI,QA2Q,QAUJ,QAPN,QABO,QA7O,QA7N,QAW6,QAI4,QAH4,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Null Values Disappear When Selected in a Grid or Browse</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The text string ".NULL." for null values disappears when the field is
selected. When you move out of the field, ".NULL." reappears. This is by
design.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To display a text string ".NULL." for the currently selected field, create
a column class that displays a label with the text string ".NULL." via the
column's DynamicCurrentControl property. Copy the following code into
TESTNULL.PRG, and then run it. You will see a grid with one column and 10
rows. Some of the rows contain numeric values, and some contain ".NULL." as
a text string. Press DOWN ARROW to move through the records, note that the
text string value of ".NULL." is displayed when the pointer is on a record
that contains a null value.
<P>
<PRE>  PUBLIC oForm
  oForm = CREATEOBJECT('myform')
  oForm.SHOW

  DEFINE CLASS mytextbox AS textbox
     SpecialEffect = 1
     BorderStyle = 0
     FontBold = .F.

     PROCEDURE keypress
     LPARAMETERS nKeyCode, nShiftAltCtrl

       IF nKeyCode = 48
         REPLACE testnull.name WITH .NULL.
         This.Value = ".NULL."
         NODEFAULT
       ENDIF
     ENDPROC
  ENDDEFINE

  DEFINE CLASS mytextbox1 AS mytextbox
     ControlSource = "testnull.name"
  ENDDEFINE

  DEFINE CLASS mytextbox2 AS mytextbox
     ControlSource = "This.Value"
     Value = ".NULL."

     PROCEDURE gotfocus
        This.Value = ".NULL."
     ENDPROC

     PROCEDURE lostfocus
        IF This.Value &lt;&gt; ".NULL."
           REPLACE testnull.name WITH This.Value
        ENDIF
     ENDPROC
  ENDDEFINE

  DEFINE CLASS mycolumn AS column
     DynamicCurrentControl = "IIF(ISNULL(testnull.name),'text2', 'text1')"
     Sparse = .f.
     Bound = .f.

     ADD OBJECT text1 AS mytextbox1
     ADD OBJECT text2 AS mytextbox2
  ENDDEFINE

  DEFINE CLASS mygrid AS grid
     RecordSource = ALIAS()
     ADD OBJECT c1 AS mycolumn
  ENDDEFINE

  DEFINE CLASS myform AS form
     ADD OBJECT g1 AS mygrid

     PROCEDURE load
        DELETE FILE testnull.dbf
        CREATE TABLE testnull (name c(10) NULL)

        FOR cnt = 1 to 10
          APPEND BLANK
          REPLACE name WITH IIF(MOD(RAND()*100, 2) &gt;=1, SYS(3), .NULL.)
        ENDFOR
        GO TOP
     ENDPROC

     PROCEDURE unload
        CLOSE DATA ALL
     ENDPROC
  ENDDEFINE

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
To see the behavior described above, run the following code in the Command
window:
<P>
<PRE>   CREATE TABLE test (name C(10) NULL)
   APPEND BLANK
   REPLACE name WITH "Harry"
   APPEND BLANK
   REPLACE name WITH .NULL.
   BROWSE

</PRE>The currently selected field has no text in it. Press the UP ARROW key or
click in record 1. Record 2 now displays the ".NULL." text string.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin  browse<BR>
KBCategory: kbui kbprb<BR>
KBSubcategory: FxotherGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 28, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
