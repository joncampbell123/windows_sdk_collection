

<HTML>
<HEAD>
<TITLE>Description of the SQL Query Wizard </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118449">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/07/19">
<META NAME="Keywords" CONTENT="kbtool kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The information below describes the Structured Query Language (SQL) Query Wizard and how to use it to create an SQL query.  This information is also found in FoxPro online Help in the  SQL Query Wizard  topic.  MORE INFORMATION  The SQL Query Wizar...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA7O,QA7N,QBXS,QBWS,QAB9,QAG2,QA2Q,QACF,QABO,QAY2,QAPF,QAUJ,QASR,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Description of the SQL Query Wizard</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118449</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6
<LI>Microsoft FoxPro for MS-DOS, version 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The information below describes the Structured Query Language (SQL)
Query Wizard and how to use it to create an SQL query.
<P>
This information is also found in FoxPro online Help in the "SQL Query
Wizard" topic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The SQL Query Wizard searches one or more tables for records that match the
criteria you specify. It creates a query file with a .QPR extension, the
same type of query created when you use FoxPro's RQBE.
<P>
FoxPro .QPR queries allow you to use aggregate functions (such as AVG,
COUNT, MAX, MIN, or SUM) in your query. The query results are read-only;
you can browse them or incorporate them into a report, but cannot update
the records.
<P>
<P><h3>SQL QUERY WIZARD STEPS</h3>
 
<P>
The SQL Query Wizard has six main steps:

<OL><P><LI>Selecting and joining tables

<P><LI>Selecting fields and adding expressions

<P><LI>Setting grouping options

<P><LI>Setting the sort order of records (optional)

<P><LI>Limiting or filtering the records retrieved (optional)

<P><LI>Viewing, saving, and browsing the query, or creating an AutoReport
   from it
<P>
</OL>Detailed instructions for each step are provided below.
<P>
<P><h3>Step 1 of 6: Selecting Tables</h3>
 
<P>
First, select the table or tables you want to use from the Available Tables
list.
<P>
NOTE: If you are using the Query Wizard from the Catalog Manager, the
tables on which you want to base your query must reside in the open
catalog. If there are no tables found in the catalog and you click the
Query Wizard button, you will be prompted to name your query and select a
table on which to base the query. Next, RQBE will start from which you can
create a query. If you are not using the Wizard from the Catalog Manager,
you can also choose the Open Table... button to use a table that is not
currently open.
<P>
<P><h3>Step 1a of 6: Joining Tables</h3>
 
<P>
When you select more than one table, the wizard displays this screen so you
can join the tables. Select matching fields from the parent table and the
child table, then choose Add.
<P>
For example, if you are setting a join between the Customer table and the
Invoices table, you could set Customer.cno equal to Invoices.cno.
<P>
If you want to delete the relationship between two tables, select the
relationship and choose the Remove button.
<P>
When you are done joining tables, choose Next to continue to the next step.
<P>
<P><h3>Step 2 of 6: Selecting Fields and Adding Expressions</h3>
 
<P>
Select the fields you want to include in the query. The list of available
fields includes fields from all the tables you have selected.
<P>
To select fields, you can:

<UL><LI>Double-click each field name in the Available Fields list.

<LI>Select each field name and choose the Add button.

<LI>Choose the Add All button to use all the table fields.
<P>
</UL>If you add a field you don't need, select it and choose the Remove button.
<P>
Adding Expressions to Your Query:
<P>
You can also add expressions to your query. An expression is a combination
of operators, functions, and field names that evaluate to a single value.
For example, you might want your query to include the sum of all prices:
<P>
<PRE>   SUM(cost)

</PRE></OL>or include a combination of two fields, such as:
<P>
<PRE>   Cost+Tax

</PRE>When you choose the Expression... button, the wizard displays the
Expression dialog, where you can create the expression to add to your
query.
<P>
To Create an Expression with the Expression Dialog:

<OL><P><LI>Enter a name for your expression in the Name of calculated field box.

<P><LI>Either type the expression directly into the Expression box, or select
   String, Math, or Date expressions and combine them with the Fields
   available.

<P><LI>When you've finished building the expression, choose OK to confirm it.
<P>
</OL>If you need to modify an expression after you have created it, select it in
the Selected Fields list, and choose the Expression... button again.
<P>
Step 3 of 6: Grouping the Query Results
 
<P>
From the Available Fields list, select up to three fields by which to group
the records in your query results.
<P>
For example, if you choose to group by state and zip code, the records will
be sorted into groups by state, then grouped and sorted by zip code within
each state.
<P>
This type of grouping can be useful in conjunction with any expressions you
incorporate into your query. For example, you could include an expression
which does a SUM of all sales, then group the results by State, to find the
total sales by state.
<P>
<P><h3>Step 3a of 6: Setting Additional Grouping Options</h3>
 
<P>
You can add optional modifiers to your grouping criteria to control how
records are grouped in the query results.
<P>
When you group by entire field, each unique field is placed in a separate
group. If you want to make the groupings larger, you can specify that the
fields be grouped by their first character, or their first two or three
characters.
<P>
For example, if you were grouping the names Smith, Samuels, and Snyder by
the entire field, each name would appear in its own group. If you grouped
by first letter, all three names would appear in the same group.
<P>
For numeric fields, by default each unique number constitutes a separate
group. If you choose, for example, to group by 10s, then all the values
from 0 to 9 would be part of the same group.
<P>
<P><h3>Step 4 of 6: Setting the Sort Order for the Records</h3>
 
<P>
In this screen, you determine how the records retrieved by the query will
be sorted.
<P>
Select up to three fields from the Available Fields list to set the sort
order of the records. You can sort on fields from any of the selected
tables.
<P>
For example, if you choose Customer.Name and Invoice.Ino, the records will
be sorted by customer name, from the Customer table, and then by invoice
number from the Invoices table.
<P>
Choose the Ascending option to sort records from the beginning of the
alphabet, the lowest number, or the earliest date; choose the Descending
option to sort records from the end of the alphabet, the highest number, or
the latest date.
<P>
<P><h3>Step 5 of 6: Limiting the Contents of the Query</h3>
 
<P>
In this screen you can add an optional expression to further limit the
records retrieved by the query. The effect is like filtering the results so
that only records meeting certain criteria are included in the query
results. For example, you could limit the search to last names starting
with J by using the expression:
<P>
<PRE>   Customer.lastname BeginsWith J

</PRE></OL>First select a field from the Fields list and an operator from the Operator
list. Then enter a comparison value in the Value field, and choose the Add
button to add the new expression to the expression box.
<P>
Entering Values:
<P>
In the Value field, type the value you want the query to compare the field
against. For example, if you are looking for customer records with a
particular last name, type that name in the Value box, after choosing the
last name field and the equal-sign operator. The resulting query expression
would look like this:
<P>
<PRE>   LAST_NAME = JOHNSON

</PRE>Combining Expressions:
<P>
You can create more complex queries by adding more expressions.
<P>
When you combine expressions, they are combined with an AND operator by
default. For example:
<P>
<PRE>   STATE = WA
   AND ORDER &gt; $100

</PRE>If you want the query to find records that match either expression, but not
both, choose the OR button to add an OR operator between expressions. For
example:
<P>
<PRE>   STATE = WA
   OR
   STATE = CA

</PRE>You can add parentheses around an expression to make sure the expressions
are evaluated as a unit. For example:
<P>
<PRE>   (STATE=WA
   OR
   STATE=CA)
   AND
   ORDER &gt; $100

</PRE>To Create an Expression:

<OL><P><LI>Select a field from the Fields list.

<P><LI>Select an operator from the Operator list.

<P><LI>Enter one or more values for comparison in the Value box.

<P><LI>Choose the Add button to add the resulting expression line to the
   expression box.

<P><LI>To check the results of the filter expression on the query, choose the
   Preview button.
<P>
</OL>To remove an expression

<UL><LI>Select the expression line and choose the Remove button.
<P>
</UL><h3>Step 6 of 6: Previewing, saving, and browsing your query</h3>
 
<P>
Choose the Preview... button to see the results of your query in a Browse
window. If you are satisfied with the results, choose one of the following
options, and choose the Finish button.

<UL><LI>Save Query for Later Use creates a standard Microsoft FoxPro SQL query
   file (.QPR file) you can run later.

<LI>Save and Run Query saves the query and displays the records in a Browse
   window.

<LI>Save and Create an AutoReport saves the query and creates and runs an
   automatic report based on the fields in the query.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.60 foxhelp.hlp foxhelp.dbf<BR>
KBCategory: kbtool kbprg<BR>
KBSubcategory: FxtoolRqbe<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
