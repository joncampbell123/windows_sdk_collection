

<HTML>
<HEAD>
<TITLE>HOWTO: Using OLE Automation to Add Data to Excel Sheet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142193">
<META NAME="KBModify" CONTENT="1997/02/18">
<META NAME="KBCreate" CONTENT="1996/01/07">
<META NAME="Keywords" CONTENT="kbinterop kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  OLE Automation provides a way for Visual FoxPro for Windows to interact with other OLE-compliant applications. Using OLE, the Visual FoxPro program can start a Microsoft Excel session, open a workbook, select a worksheet from the workbook, place da...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAMB,QAUR,QAPN,QBWS,QA9Q,QA56,QA55,QAH4,QBSO,QA6A,QAPF,QDNM,QAYY,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Using OLE Automation to Add Data to Excel Sheet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142193</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
OLE Automation provides a way for Visual FoxPro for Windows to interact
with other OLE-compliant applications. Using OLE, the Visual FoxPro program
can start a Microsoft Excel session, open a workbook, select a worksheet
from the workbook, place data into a cell or range of cells, print a
worksheet, save the updated workbook, and close the Microsoft Excel
session. This article shows by example how to do just that.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Open a new workbook in Microsoft Excel 5.0 or Microsoft Excel 7.0 (part
   of Office 95), so that the program example in this article will work.

<P><LI>Select sheet 3 by clicking the tab at the bottom of the worksheet, and
   enter the following data into the spreadsheet:
<P>
<PRE>      Enter         In Cells
      ----------------------------
      Part #        A1
      Sales YTD     B1
      1             A2 through A4
      2             A5 through A7
      3             B2 through B7

</PRE><P><LI>On the Microsoft Excel Data menu, click Subtotal. The resulting
   dialog box should show that at each change in Part #, the function 'SUM'
   adds the subtotal to 'Sales YTD' and display that summary below the
   data. If so, click OK.

<P><LI>Click the tab at the bottom of the worksheet for Sheet 1 to restore the
   workbook's default page to Sheet 1.

<P><LI>Save the workbook. Then close the workbook, and exit from Microsoft
   Excel. For the following example code, the workbook has been saved as
<P>
<P><PRE>      C:\XLSheets\Testbook.xls.
</PRE>
<P><LI>In Microsoft Visual FoxPro for Windows, create the following program
   named oleExcel.prg:
<P>
<P><PRE>      *** Program oleExcel.prg *****
<PRE></PRE>      MyF12=ON("key",'F12')        &amp;&amp; Save the status of F12
      ON KEY LABEL F12 DO Wrapup   &amp;&amp; Cleanup, closeup procedure
      DIMENSION laDemoData(4)      &amp;&amp; For some Visual FoxPro user's data
      laDemoData(1)= 1024          &amp;&amp; could come from table or view
      laDemoData(2)= 2048
      laDemoData(3)= 5120
      laDemoData(4)= "The Sample Message"

      oleExcel = CREATEOBJECT("Excel.application")  &amp;&amp; The object ;
      *                                &amp;&amp; is 'oleExcel.application'
      oleExcel.application.workbooks.open("C:\XLSheets\testbook.xls")
      oleExcel.application.worksheets("Sheet3").activate  &amp;&amp; Select sheet
      oleExcel.range("b2").value = 14444  &amp;&amp; constants as data
      oleExcel.range("b3").value = 25555
      oleExcel.range("b4").value = 30001
      oleExcel.range("b6").value = laDemoData(1)  &amp;&amp; variables as data
      oleExcel.range("b7").value = laDemoData(2)
      oleExcel.range("b8").value = laDemoData(3)
      oleExcel.range("a12").value = laDemoData(4)
      oleExcel.worksheets("Sheet3").pagesetup.orientation = 2
      &amp;&amp; = 'xlLandscape'
      oleExcel.activesheet.printout  &amp;&amp; Example of printing the worksheet
      oleExcel.visible = .t. &amp;&amp; See the results
      READ EVENTS  &amp;&amp; Keep the program running, so Excel isn't stranded

      * To do the following, press ALT+TAB to select Visual FoxPro from the
      * operating system's task list. Once you're back in the Visual FoxPro
      * desktop, press F12

      PROCEDURE Wrapup
        CLEAR EVENTS
        oleExcel.application.Activeworkbook.save &amp;&amp; saves new subtotals,
      .
        oleExcel.quit
        &amp;&amp; Closes Microsoft Excel and releases the oleExcel object
      .
         ON KEY Label F12 &amp;MyF12

      ****** End of program ********

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Eamine the Microsoft Excel Help topic "Application Object" and the many
topics that are introduced in the Properties and Methods lists of that
topic.
<P>
For more information about many of the concepts in the example program,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q139051.htm">Q139051</A></B>
   TITLE     : How to Select Cells in Microsoft Excel by Using OLE
               Automation

   ARTICLE-ID: <B><A href="../foxpro/q132535.htm">Q132535</A></B>
   TITLE     : Releasing Object Variable does not close Microsoft Excel

   ARTICLE-ID: <B><A href="../foxpro/q128994.htm">Q128994</A></B>
   TITLE     : Behavior of GETOBJECT() with Excel and Word for Windows

   ARTICLE-ID: <B><A href="../foxpro/q138398.htm">Q138398</A></B>
   TITLE     : Release may not Remove OLE Objects from Memory

   ARTICLE-ID: <B><A href="../foxpro/q130809.htm">Q130809</A></B>
   TITLE     : KB List: OCX, OLE, ODBC, &amp; Third-party Interoperability
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbhowto kbcode<BR>
KBSubcategory: FxinteropExcel VFoxWin<BR>
Additional reference words: 3.00 3.00b 5.00 Interoperability printing<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
