

<HTML>
<HEAD>
<TITLE>FIX: Reprint Group Header Problem with Two Data Groupings </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147574">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1996/02/26">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxtoolRwriter vfoxwin vfpfix5.0a kbtool kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you create a report with two or more data groupings with the  Reprint Group Header on Each Page  check box selected for all data groupings, the groupings will print in incorrect order on the first page and on subsequent pages when a new outer gr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QABH,QAOX,QABI,QBWA,QBT6,QAMB,QAYY,QBV4,QA2Q,QAIJ,QBWS,QAG2,QA9N,QAWM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Reprint Group Header Problem with Two Data Groupings</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147574</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you create a report with two or more data groupings with the "Reprint
Group Header on Each Page" check box selected for all data groupings, the
groupings will print in incorrect order on the first page and on subsequent
pages when a new outer grouping starts on a new page.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
NOTE: For this workaround to work, each new outer grouping must start on a
new page.
<P>
Follow the steps in the "Steps to Reproduce Problem" section of this
article, and then make the following changes to the report:

<OL><P><LI>In the Data Grouping dialog box, select the shipper_id group, and select
   the "Start Each Group on a New Page" check box.

<P><LI>Move all fields from Group Header 1 to the Page Header (you may need to
   enlarge the Page Header band), and shrink the Group Header 1 band height
   to 0.

<P><LI>Create a report Variable, and give it the following settings:
<P>
   Name - grpcount
   Value to Store - grpcount + 1
   Initial Value - 0
   Calculate  - Sum
   Reset - shipper_id

<P><LI>Select all the fields in Group Header 2. Copy them, and then paste them
   into the Page Header. On each of these new fields in the Page Header,
   choose Print When, and in the "Print Only When Expression Is True" text
   box, enter this expression:
<P>
   grpcount = 0
<P>
   Select the "Remove Line If Blank" check box.

<P><LI>On all the fields in Group Header 2 choose Print When, and in the "Print
   Only When Expression is True" text box, enter this expression
<P>
   grpcount  &gt;  0
<P>
   Select the "Remove Line If Blank" check box.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open Orders.dbf from the Tastrade database located in the
   Samples\Mainsamp\Data subdirectory.

<P><LI>Create a new index tag named ShipCust on this expression:
<P>
   shipper_id + customer_id

<P><LI>Create a new report, and add the Orders table to the Data Environment.

<P><LI>In the properties sheet of the Data Environment, in the Data tab of the
   Cursor object, set the Order property to ShipCust.

<P><LI>Add two Data Groupings to the report, the first (outer) being
   shipper_id and the scond (inner) being customer_id. In both cases,
   select the "Reprint Group Header on Each Page" check box.

<P><LI>Add a label named Outer Group to the Group Header 1, and add a label
   named Inner Group to the Group Header 2.

<P><LI>Preview the report. Note that Inner Group prints above Outer Group on
   the first page. It is also possible to arrange the report so that the
   shipper_id changes between pages, in which case the problem repeats
   itself on the first page that displays the new shipper_id.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the technique used in this article, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q94343.htm">Q94343</A></B>
   TITLE     : Obtaining Number of Data Groups in .FRX Without Using UDF
</PRE></OL> 
<PRE>Keywords          : buglist3.00 buglist3.00b buglist5.00 FxtoolRwriter vfoxwin vfpfix5.0a kbtool kbbuglist kbfixlist
Version           : 3.0 3.0b 5.0
Platform          : MACINTOSH WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
