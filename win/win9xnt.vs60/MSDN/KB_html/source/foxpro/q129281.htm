

<HTML>
<HEAD>
<TITLE>How to Implement a RELEASE Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129281">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/24">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes how to implement a RELEASE method in classes that do not include a default RELEASE method.  MORE INFORMATION  When an object is instantiated, a variable, called an instance variable, is created. Executing a form with a DO FOR...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAPN,QAA5,QAB5,QAW6,QAB9,QABO,QBVV,QANS,QBV8,QAI2,QAF0,QABA,QDNL,QAF3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Implement a RELEASE Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129281</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to implement a RELEASE method in classes that do
not include a default RELEASE method.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When an object is instantiated, a variable, called an instance variable, is
created. Executing a form with a DO FORM command creates a Form object and
an instance variable. If the LINKED clause is included with the DO FORM
command, the form is associated with the instance variable, and releasing
the instance variable will also release the form.
<P>
By default, the LINKED clause is not included with the DO FORM. If the form
is not linked, you can release the variable while the form is active. The
RELEASE method is therefore necessary to the FORM or FORMSET classes to
release forms that do not have an associated instance variable.
<P>
Any object based on a class other than Form or FormSet is released when the
instance variable goes out of scope or is released. You can however
implement a custom RELEASE method that includes this command:
<P>
<PRE>   RELEASE this &amp;&amp; This command releases the current object

</PRE><h3>Sample Code</h3>
 
<P>
The following example code defines a toolbar that contains two command
buttons. One of the command buttons is a QUIT button. When the button is
clicked, the RELEASE method is called and the toolbar is released. Note
that in this example, the THISFORM keyword is used to generically reference
the toolbar.
<P>
<PRE>   PUBLIC oToolbar
   oToolbar=CREATEOBJECT('mytoolbar')
   oToolbar.show
   DEFINE CLASS mytoolbar AS TOOLBAR
   ADD OBJECT mycmd AS cmdmessage

   ADD OBJECT mycmdtwo AS cmdquit
   PROCEDURE RELEASE
   RELEASE THIS
   ENDPROC
   ENDDEFINE

   DEFINE CLASS cmdmessage AS COMMANDBUTTON
      Height=35
      Width=35
      Caption="Clients"
      PROCEDURE CLICK
       =MESSAGEBOX('To be implemented')
      ENDPROC
    ENDDEFINE
  *:
  *: Class: mycmdquit  BaseClass: COMMANDBUTTON
  *:

   DEFINE CLASS cmdquit AS COMMANDBUTTON
      Height=35
      Width=35
      CAPTION="Quit"
      PROCEDURE CLICK
         THISFORM.RELEASE
      ENDPROC
   ENDDEFINE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgClassoop<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
