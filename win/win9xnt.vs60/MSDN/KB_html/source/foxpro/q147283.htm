

<HTML>
<HEAD>
<TITLE>How to Use Schedule+ 7.0 OLE Automation in Visual FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147283">
<META NAME="KBModify" CONTENT="1996/02/23">
<META NAME="KBCreate" CONTENT="1996/02/22">
<META NAME="Keywords" CONTENT="kbinterop kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Within Visual FoxPro, you can take advantage of the OLE Automation capabilities of Schedule+ 7.0 to read or modify your appointments, contacts, task list, and projects.  MORE INFORMATION  Schedule+ 7.0 doesn't export an OLE Automation Type library ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAL4,QAH4,QBE7,QBE6,QBDP,QAPN,QAEF,QAG8,QA9Q,QBW2,QA56,QA55,QA5V,QA2K,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use Schedule+ 7.0 OLE Automation in Visual FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147283</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Within Visual FoxPro, you can take advantage of the OLE Automation
capabilities of Schedule+ 7.0 to read or modify your appointments,
contacts, task list, and projects.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Schedule+ 7.0 doesn't export an OLE Automation Type library as you might be
used to. What it does expose is the ability to gain access to table objects
within the Schedule+ object. You can navigate these table objects by using
exposed Schedule+ 7.0 methods.
<P>
The Appointment table is one table you might want to examine from inside a
Visual FoxPro application. You can use the Schedule+ 7.0 Skip method to
maneuver through the table in a manner similar to what you might do with a
Visual FoxPro table. And you can use the Schedule+ 7.0 GetRows() method,
which is quite similar to a SELECT INTO ARRAY. There are also SetRange and
SetRestriction methods that give you filtering capability to specify the
records you want to search.
<P>
The following three code samples show some of the basic functions that
can be performed:

<UL><LI>Create new schedule appointments.
<LI>Remove scheduled appointments.
<LI>Read a given schedule.
<P>
</UL><h3>Code Sample to Create New Schedule Appointments</h3>
 
<P>
The following code shows how to use the NEW method to add 100 appointments
for 1996. It creates a start and end datetime string for each appointment
along with some text that denotes it as a test.
<P>
********************************
<PRE>*     Begininig Of Program     *
</PRE>********************************
<P>
PUBLIC appt,x,count,st,end,what,notes,fAppt
x=CreateObject('scheduleplus.application.7')
IF !x.loggedon()
<PRE>     x.logon
</PRE>ENDIF
appt=x.Schedulelogged.appointments
count=0
appt.reset
count=1
y=96
FOR m=1 to 12
<PRE>   FOR d=1 to 28
      when=alltrim(str(m))+"/"+alltrim(str(d))+"/"+alltrim(str(y))+;
      " "+right(ttoc(datetime()),11)
      when2=alltrim(str(m))+"/"+alltrim(str(d))+"/"+alltrim(str(y))+;
      " "+right(ttoc(datetime()+3600),11)
      IF count&lt;100
        oappt=appt.new
        oappt.start=when
        oappt.end=when2
        myval="test appointment: "+alltrim(str(count))
        oappt.notes=myval
        oappt.text=myval
        oappt.busytype=1
        count=count+1
        oappt=.NULL.
      ELSE
        EXIT
      ENDIF
   ENDFOR
   IF count&gt;100
     EXIT
   ENDIF
</PRE>ENDFOR
<P>
********************************
<PRE>*     End Of Program           *
</PRE>********************************
<P>
<P><h3>Code Sample to Remove Scheduled Appointments</h3>
 
<P>
The following code shows how to use OLE Automation to automate Schedule+
7.0 to remove all tentative appointments, which are denoted by a
BUSYTYPE!=1. It also shows how to use the SKIP and DELETEITEM methods.
<P>
********************************
<PRE>*     Begininig Of Program      *
</PRE>********************************
<P>
CLEAR ALL
PUBLIC appt,x,count,st,end,what,notes,fAppt
x=CreateObject('scheduleplus.application.7')
IF !x.loggedon()
<PRE>     x.logon
</PRE>ENDIF
appt=x.Schedulelogged.appointments
appt.reset
DO WHILE !(appt.isendoftable)
<PRE>   IF (TYPE('appt.item.busytype.value')!='N' OR appt.item.busytype.value=0)
     whichone=appt.item.itemid.value
     appt.deleteitem(whichone)
   ENDIF
   appt.skip
</PRE>ENDDO
CLEAR ALL
<P>
********************************
<PRE>*     End Of Program           *
</PRE>********************************
<P>
<P><h3>Code Sample to Read Scheduled Appointments and Populate a Grid</h3>
 
<P>
The following code shows how to use the GetRows() method to pass through
the OLE layer once for each 100 records. This is a large performance
increase over using the Skip method to move to each records and grab its
attributes. Specifically, the code shows how to use OLE Automation to
automate Schedule+ and populate a grid with the appointments.
<P>
********************************
<PRE>*     Begininig Of Program      *
</PRE>********************************
<P>
PUBLIC x,count,st,end,what,notes,fAppt
x=CreateObject('scheduleplus.application.7')
IF !x.loggedon()
<PRE>     x.logon
</PRE>ENDIF
appt=x.Schedulelogged.appointments
appt.reset
count=0
dime myarr(100,3)
oldval=set('safety')
SET SAFETY OFF
CREATE TABLE apptlist (Text c(40), Start T(10),End T(10))
SET SAFETY &amp;oldval
DO WHILE NOT(appt.isendoftable)
<PRE>   myarr=appt.getrows(100, "Text","Start","End")
   append from array myarr
</PRE>ENDDO
fAppt=CreateObject('form')
fAppt.Addobject('Grid1','Grid')
fAppt.width=800
WITH fAppt.Grid1
<PRE>     .visible=.t.
     .left=50
     .top=20
     .width=650
</PRE>ENDWITH
GO TOP
fAppt.show
<P>
********************************
<PRE>*     End Of Program           *
</PRE>********************************
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on this, please consult the Schedule+ help file
provided with the Exchange Developers Kit or contact the Exchange/Schedule+
product support team.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin splus<BR>
KBCategory: kbinterop kbhowto kbcode<BR>
KBSubcategory: FxinteropOle<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
