

<HTML>
<HEAD>
<TITLE>PRB: Error Performing DODEFAULT Function on Base Class Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169111">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1997/05/28">
<META NAME="Keywords" CONTENT="FxprgClassoop vfoxwin kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  An error occurs when performing a DODEFAULT function on a Visual FoxPro base class KeyPress method.  STATUS ======  Microsoft is researching this behavior and will post new information here in the Microsoft Knowledge Base as it becomes available.  ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAMB,QAH4,QA2O,QABA,QAW6,QAB9,QBV4,QBXT,QA5V,QAY5,QAO4,QAIB,QAB4,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error Performing DODEFAULT Function on Base Class Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169111</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An error occurs when performing a DODEFAULT function on a Visual FoxPro
base class KeyPress method.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
An error occurs when performing a DODEFAULT function to a Visual FoxPro
base class method. The DODEFAULT function appears to be referencing an
object other than the one in which it is running.
<P>
In the code below, the DODEFAULT code is located in the KEYPRESS method of
a Form. Pressing the TAB key when the cursor is in the first TextBox of the
sample below causes the VALID method of the TextBox to execute but the
VALID method of Form appears to be running in addition to the TextBox VALID
and a "Property VALUE is not found" error occurs. The Form object does not
have a VALUE property. Suspending the program after the error occurs and
checking the value of "THIS" verifies that the object reference is the Form
rather than the TextBox.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Run the sample code below and press the TAB key to move to the next
   object.
<P>
<P><PRE>      ****Start of Code
</PRE><P>
<P><PRE>      frmTestForm = CREATEOBJECT("MyForm")
      frmTestForm.SHOW
      READ EVENTS
</PRE><P>
<P><PRE>      **************************************************
      *-- ParentClass:  basform
<PRE></PRE>      *-- BaseClass:    form
      DEFINE CLASS MyForm AS BASFORM
        PROCEDURE KEYPRESS
        LPARAMETERS NKEYCODE, NSHIFTALTCTRL

        &amp;&amp; Do not comment the PROCEDURE, ENDPROC or LPARAMETERS lines
        &amp;&amp; Comment the following two lines only

        WAIT WINDOW "Form Key Press - Child Class"
        DODEFAULT(NKEYCODE, NSHIFTALTCTRL)

        ENDPROC
      ENDDEFINE
      *
      *-- EndDefine: MyForm
      **************************************************
      *-- ParentClass:  form
      *-- BaseClass:    form
      DEFINE CLASS BasForm AS FORM
        TOP = 10
        LEFT = 23
        DOCREATE = .T.
        CAPTION = "Test Form"
        KEYPREVIEW = .T.
        NAME = "frmForm1"

        ADD OBJECT txtTEXT1 AS TEXTBOX WITH ;
          HEIGHT = 23, ;
          LEFT = 84, ;
          TOP = 24, ;
          WIDTH = 100, ;
          NAME = "txtText1"

        ADD OBJECT txtTEXT2 AS TEXTBOX WITH ;
          HEIGHT = 23, ;
          LEFT = 84, ;
          TOP = 84, ;
          WIDTH = 100, ;
          NAME = "txtText2"

        ADD OBJECT cmdCOMMAND1 AS COMMANDBUTTON WITH ;
          TOP = 216, ;
          LEFT = 276, ;
          HEIGHT = 27, ;
          WIDTH = 84, ;
          CAPTION = "Close", ;
          NAME = "cmdCommand1"

        ADD OBJECT lblLabel1 as LABEL with;
           TOP = 20, ;
        LEFT = 200,;
           CAPTION = "Press the TAB key"

          *!* PROCEDURE KEYPRESS
          *!* LPARAMETERS NKEYCODE, NSHIFTALTCTRL

          *!* WAIT WINDOW "Form Key Press - Parent Class"
          *!* DODEFAULT(nkeycode, nshiftaltctrl)
          *!* ENDPROC

          * Uncomment the above code and comment the contents of
          * the Keypress procedure (Comment the 2 lines of code that
          * are identified to be commented out within the Keypress
          * procedure, which are the lines that start with "WAIT WINDOW"
          * and "DODEFAULT". Do not comment out the PROCEDURE line nor the
          * LPARAMETERS line nor the ENDPROC line) in the BasForm
          * Class definition and the error will not occur.

          PROCEDURE txtTEXT1.VALID
            IF EMPTY(THIS.VALUE)
              WAIT WINDOW "Text1 Valid"
            ENDIF
          ENDPROC

          PROCEDURE cmdCOMMAND1.CLICK
            THISFORM.RELEASE()
            CLEAR EVENTS
          ENDPROC

      ENDDEFINE
      *
      *-- EndDefine: basform
      **************************************************
</PRE></OL> 
<PRE>Keywords          : FxprgClassoop vfoxwin kbcode
Version           : 5.0 5.0a
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
