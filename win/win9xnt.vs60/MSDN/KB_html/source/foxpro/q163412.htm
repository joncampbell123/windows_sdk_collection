

<HTML>
<HEAD>
<TITLE>BUG: Web Browser Position is Wrong on Pageframe Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163412">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1997/02/10">
<META NAME="Keywords" CONTENT="buglist5.00 FxinteropOcx FxinteropOle FxtoolFormdes kbinterop vfoxwin vfpbug5.0a kbbugl">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a Visual FoxPro for Windows version 5.0 form contains a pageframe, and one of the pages (other than page 1) of the pageframe has an OLE container control that houses the Microsoft Web Browser control, that container control will appear on the ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAVZ,QBWA,QACI,QAHV,QAAP,QAY2,QAH4,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Web Browser Position is Wrong on Pageframe Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163412</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a Visual FoxPro for Windows version 5.0 form contains a pageframe, and
one of the pages (other than page 1) of the pageframe has an OLE container
control that houses the Microsoft Web Browser control, that container
control will appear on the page in the wrong location at runtime.
<P>
It will be positioned to the upper left of where it was positioned at
design time. Because it is still located on the pageframe, its dimensions
will be shrunken so that it fits on the page.
<P>
If the Web Browser is located on the first page of the pageframe, its
loading will throw the error:
<P>
<PRE>   "OLE error code 0x80004005. Unspecified error."

</PRE>There is no known workaround for this error. The control will be drawn on
page 1 but will be larger than intended, obscuring the tabs for the
remaining pages in the pageframe.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following workaround applies only to placement of the Web Browser of
pages other than page 1 of the pageframe control.
<P>
The location of the OLEContainer control can be reset in the Activate event
method of the page of the pageframe containing the control. An example of
the code to do this follows:
<P>
<PRE>      This.Olecontrol1.Left = 0

</PRE>This workaround will fail if the active page from which you move contains
any of the OCX (ActiveX) controls that install with Visual FoxPro. If you
switch from a page with an ActiveX control to the page with the Web
Browser, the error will cause the Web Browser to locate at the upper left
of where it should be.
<P>
To position the Web Browser correctly, you must first switch from a page
with an ActiveX control to a page without one, and then to the page with
the Web Browser control.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft product listed at
the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form.

<P><LI>Add a pageframe to the form.

<P><LI>Add a web browser (Microsoft Web Browser) control to page 2 of the
   pageframe. Size it so it takes up most of the page.
<P>
   The steps to add this are as follows:
<P>
<P><PRE>      a. Right-click on the pageframe, and select "Edit" on the context
<PRE></PRE>         menu.

      b. Click the tab for page 2.

      c. Click the OLEContainer control tool on the toolbar.

      d. Position the mouse at the upper left of page 2.

      e. Drag the mouse to the lower-right corner of page 2.

      f. From the Insert Object dialog box, click the "Insert Control"
         option button, and then select "Microsoft Web Browser Control"
         from the list. If you do not see that option, install Microsoft
         Internet Explorer 3.01 by downloading it from the Internet. It
         will install the Web Browser in your Windows\System (on Windows
         95) or Windows\System32 (for Windows NT) directory. The file name
         of the control is shdocvw.dll.

</PRE><P><LI>Add the following code to the init event method of the OLEContainer
   control (OLEContainer1):
<P>
<P><PRE>      This.navigate("<B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>")
</PRE>
<P><LI>Run the form and click the tab for page 2.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist5.00 FxinteropOcx FxinteropOle FxtoolFormdes kbinterop vfoxwin vfpbug5.0a kbbuglist<BR>
Technology          : kbole<BR>
Version             : 5.0a 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
