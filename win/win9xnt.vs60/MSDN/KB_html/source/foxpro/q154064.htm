

<HTML>
<HEAD>
<TITLE>How To Direct Output to Installed GX Printers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154064">
<META NAME="KBModify" CONTENT="1997/11/13">
<META NAME="KBCreate" CONTENT="1996/07/26">
<META NAME="Keywords" CONTENT="FxprgGeneral kb3rdparty kbhowto kbprg kbprint">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Controlling what printer a program prints to can be accomplished through code with the enhancements to the SET PRINTER TO command in Visual FoxPro run with QuickDraw GX and some other new functions. This article provides a sample program combining ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QACT,QBXS,QAA1,QBXT,QA5V,QAY5,QAIB,QAH4,QDI2,QAUJ,QA0J,QA56,QA55,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Direct Output to Installed GX Printers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154064</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
3.00b
MACINTOSH
kbprg kbprint kb3rdparty kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Controlling what printer a program prints to can be accomplished through
code with the enhancements to the SET PRINTER TO command in Visual FoxPro
run with QuickDraw GX and some other new functions. This article provides a
sample program combining the SYS(1038), the JustCSName() and the SET
PRINTER TO NAME enhancements to illustrate how to control which printer a
report is printed to.
<P>
NOTE: QuickDraw GX is manufactured by a vendor independent of Microsoft; we
make no warranty, implied or otherwise, regarding the performance or
reliability of QuickDraw GX.
<P>
QuickDraw GX is not supported in Macintosh OS 8 and this sample program
will not work with Visual FoxPro running under OS 8.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Program</h3>
 
<P>
The following sample program assumes that QuickDraw GX is installed,
that at least two printers are set up, and that their icons are on the
desktop:
<P>
<PRE>   *** Beginning of sample program
   IF SYS(1038)
   desktop=SUBSTR(SYS(2033),1,AT(':',SYS(2033)))+"\Desktop Folder\"
   numPrinters=ADIR(prtList, desktop+"*.*",'','dvcf')
   SET LIBRARY TO HOME()+"FoxTools.cfm" ADDITIVE
   FOR x=1 TO numPrinters
      SET PRINTER TO NAME JustCSName(desktop+prtList[(x),1])
      REPORT FORM "somereport.frx" NOEJECT NOCONSOLE TO PRINTER
      ? SET("Printer",2)
   ENDFOR
   SET LIBRARY TO
   ENDIF
   *** End of sample program

</PRE><h3>Program Commentary</h3>
 
<P>
The first line in the program checks to see if QuickDraw GX is installed by
using the SYS(1038) function.
<P>
The second line determines the name of the Macintosh's hard drive by using
the SYS(2033) function, and appends "Desktop Folder" to it.
<P>
The third line checks to see how many QuickDraw GX printer icons are on the
desktop and stores their names in an array named "prtList". The 'dvcf' in
the fourth argument of the ADIR() function is the creator type of the
QuickDraw GX printer icons.
<P>
The fourth line loads the FoxTools.cfm library, which is necessary for the
use of the JustCSName function.
<P>
The fifth line is the beginning of a FOR loop that executes once for each
QuickDraw GX printer icon found on the desktop.
<P>
The sixth line (the first one in the FOR loop) sets the printer to one of
the QuickDraw GX printers found on the desktop.
<P>
The seventh line prints a predefined report.
<P>
The eighth line reports the name of the current QuickDraw GX printer to the
current output device (the Visual FoxPro screen).
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q152396.htm">Q152396</A></B>
   TITLE     : How To Determine if QuickDraw GX Is Loaded Using SYS
               Function

   ARTICLE-ID: <B><A href="../foxpro/q153155.htm">Q153155</A></B>
   TITLE     : How To Use New Undocumented Foxtools Function JustCSName()

   ARTICLE-ID: <B><A href="../foxpro/q153528.htm">Q153528</A></B>
   TITLE     : SET PRINTER TO Enhancements in Visual FoxPro for Macintosh
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00b VFoxMac<BR>
KBCategory: kbprg kbprint kb3rdparty kbhowto<BR>
KBSubcategory: FxprgGeneral<BR>
Keywords          : FxprgGeneral kb3rdparty kbhowto kbprg kbprint<BR>
Version           : 3.00b<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
