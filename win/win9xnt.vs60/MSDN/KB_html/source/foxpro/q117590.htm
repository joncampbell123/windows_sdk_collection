

<HTML>
<HEAD>
<TITLE>FIX: FoxPro Crashes in FOXHELP.DBF "Error Messages" Topic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117590">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/06/30">
<META NAME="Keywords" CONTENT="kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro for Macintosh crashes with a  Type 1  error when you are scrolling down the  Error Messages  Help topic in the .DBF-style Help file (FOXHELP.DBF).  CAUSE =====  The memo field in the FOXHELP.DBF file for the  Error Messages  record is corrup...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QDI1,QBVV,QAZZ,QART,QBWS,QDO9,QADF,QAA1,QA7O,QA7N,QA6A,QAAP,QAJ6,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: FoxPro Crashes in FOXHELP.DBF "Error Messages" Topic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117590</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50b 2.50c
MACINTOSH
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
FoxPro for Macintosh crashes with a "Type 1" error when you are scrolling
down the "Error Messages" Help topic in the .DBF-style Help file
(FOXHELP.DBF).
<P>
<P><h2>CAUSE</h2>
 
<P>
The memo field in the FOXHELP.DBF file for the "Error Messages" record is
corrupted.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid this problem, use FoxPro's graphical Help file, FOXHELP.HLP. If
the Macintosh does not have enough memory to run the graphical Help file
while FoxPro is running, see "Additional Alternatives" in the "More
Information" section below.
<P>
A listing of error messages can also be found in Appendix B (pages 441-483)
of the "Developer's Guide."
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0b for Macintosh.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Additional Alternatives</h3>
 
<P>
Systems that only have 8 megabytes (MB) of memory or less may not be able
to display the FoxPro graphical Help file while FoxPro is running. This is
documented in the FoxPro Readme file that can be found in the FoxPro
folder. In these cases, there are three possible alternatives.

<UL><LI>Delete the corruption from the FOXHELP.DBF Help file. This will keep
   FoxPro from crashing when the "Error Messages" topic is chosen and
   scrolled through. However, there will not be complete help information
   on error messages. The procedure to do this is below.
<P>
   1. In the Command window, type the following commands:
<P>
<PRE>      SET HELP OFF   &amp;&amp; Just in case foxhelp.dbf is the current help file
      USE SYS(2004)+"FOXHELP.DBF"
      GO 24          &amp;&amp; The Error Messages topic should be record # 24
      MODIFY MEMO details

      There should be information on error messages in the memo field. If
      not, browse the database and find the record that has "Error
      Messages" in the topic field. Double-click the details memo field.

   2. Scroll down the details memo field. After the "Area cannot contain
      handle. (1011)" error, there will be rows and columns of "hollow box
      characters" if the font is set to Geneva. If the memo field is
      displayed in FoxFont, FoxPro will crash when you are scrolling down
      to the point indicated above. The font can be changed with the Font
      command on the Text menu. Delete from the beginning of these
      characters to the end of the memo field.

   3. Press CTRL+W to close and save the memo field changes.

   4. Close the FOXHELP.DBF file and issue the following command:

         SET HELP TO SYS(2004)+"foxhelp.dbf"

   -or-

</PRE><LI>You can run the graphical Help file when FoxPro is not running. The
   obvious disadvantage here is that you will have to close FoxPro before
   looking in Help for error messages. The procedure for running graphical
   Help while not in FoxPro is below.
<P>
   1. Double-click the FoxPro Help application found in the System
<P><PRE>      Folder:Extensions:Microsoft:Help folder.
</PRE><P>
   2. From the File menu, choose Open. Note that there should only be
<P><PRE>      Apple, File, and Edit menus when you are in FoxPro Help.
</PRE><P>
   3. Open the FOXHELP.HLP file found in the FoxPro folder. For ease of
<P><PRE>      use, you can place a copy of the FOXHELP.HLP file in the Help folder
      along with the FoxPro Help application.
</PRE><P>
   -or-

<LI>Remove FoxFont from the fonts installed in the System Folder. The
   disadvantage of this option is that .DBF-style Help will not display
   properly and FoxPro for MS-DOS applications will not be able to be run
   on the Macintosh unless they are transported. For more information, see
   "Part 4: Installing Fonts" in the FoxPro Readme file.
<P>
</UL><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Make sure that all information and files are saved because this
   procedure will crash FoxPro. It will normally not crash the Macintosh,
   but to be safe, save any unsaved files in other programs that may be
   running.

<P><LI>Make sure the FoxFont font from the FoxPro Fonts installation disk is
   installed. Your Macintosh may not crash if this font is not installed.
   "Part 4: Installing Fonts" in the FoxPro Readme file, found in the
   FoxPro folder, states that FoxFont is required in order to run .DBF-
   style Help. .DBF-style Help will start up without FoxFont; however, it
   will not be formatted correctly and extended (special) characters will
   probably be displayed, depending on which font the Macintosh uses in
   place of FoxFont.

<P><LI>Type the following commands in the FoxPro Command window. Press ENTER
   or RETURN after each command:
<P>
<P><PRE>      SET HELP TO SYS(2004)+"FOXHELP.DBF"
      SET HELP ON
      HELP
</PRE>
<P><LI>Double-click the "Error Messages" topic (located in the listing of
   General Topics).

<P><LI>Use the scroll bar on the right side of the help screen to scroll down
   through the error message information. Eventually FoxPro will quit with
   the following error message:
<P>
<P><PRE>      The application 'unknown' has unexpectedly quit, because an error
      of type 1 occurred.
</PRE><P>
   The Macintosh may lock up without an error message. This behavior has
   been observed on a Centris 610. Some Macintoshes may not quit or lock
   up.
<P>
   In any case, the memo field will not contain usable information after
   a point.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Language Reference," version 2.5, pages 737-739
"Developer's Guide," version 2.5, page 441-483
"User's Guide," version 2.5, pages 151-155
FoxPro Readme file, found in the FoxPro folder or on Disk - 1 Setup of the
FoxPro installation disks
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac 2.50b 2.50c fixlist3.00b buglist2.50b<BR>
buglist2.50c lock up freeze halt hang hung<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory:<BR>
Keywords          : kbbuglist kbfixlist kbprg<BR>
Version           : 2.50b 2.50c<BR>
Platform          : MACINTOSH<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
