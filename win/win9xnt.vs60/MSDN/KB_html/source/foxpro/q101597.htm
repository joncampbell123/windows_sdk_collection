

<HTML>
<HEAD>
<TITLE>Using UPDATEGRPH in GENGRAPH.APP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101597">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/07/19">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The GraphWizard is a FoxPro application named GENGRAPH.APP. The UPDATEGRPH procedure updates a graph that was created and saved with the GraphWizard using the data in the currently selected DBF/cursor. The updated graph can then be displayed using ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZZ,QDI1,QA7O,QA7N,QA5W,QAMB,QAUJ,QAXB,QAO2,QAYY,QAUR,QAU7,QAC1,QA5V,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using UPDATEGRPH in GENGRAPH.APP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101597</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The GraphWizard is a FoxPro application named GENGRAPH.APP. The UPDATEGRPH
procedure updates a graph that was created and saved with the GraphWizard
using the data in the currently selected DBF/cursor. The updated graph can
then be displayed using the SHOWGRPH procedure.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In version 2.5, the correct syntax for calling UPDATEGRPH is:
<P>
<PRE>   DO UPDATEGRPH IN GENGRAPH.APP WITH &lt;expC1&gt;, &lt;expN1&gt; ;
      [, &lt;expN2&gt;[, &lt;expC2&gt;]]

</PRE>The clauses that are used with the UPDATEGRPH procedure in version 2.5 are
&lt;expC1&gt; and &lt;expN1&gt; and two optional clauses: &lt;expN2&gt; and &lt;expC2&gt;.

<UL><LI>&lt;expC1&gt; is the name of the table containing the previously saved
   graph. The GraphWizard names this table QRYGRAPH.DBF by default.

<LI>&lt;expN1&gt; is the record number containing the graph to be displayed.

<LI>&lt;expN2&gt; is a mode number (0 or 1) that determines how the data in
   the current work area will be inserted in the saved graph. The  default
</UL>mode is 1.

<UL><LI>&lt;expC2&gt; is the graph title.
<P>
</UL>In versions 2.5a and 2.5b, the correct syntax for calling UPDATEGRPH is:
<P>
<PRE>   DO UPDATEGRPH IN GENGRAPH.APP WITH &lt;expC1&gt;, &lt;expN1&gt;[, &lt;expN2&gt; ;
      [, &lt;expC2&gt;[, &lt;array&gt;, &lt;expC3&gt;]]]

</PRE>The clauses that are used with the UPDATEGRPH procedure in versions 2.5a
and 2.5b are &lt;expC1&gt; and &lt;expN1&gt; and four optional clauses: &lt;expN2&gt;,
&lt;expC2&gt;, &lt;array&gt;, and &lt;expC3&gt;.

<UL><LI>&lt;expC1&gt; is the name of the table containing the previously saved
   graph. The GraphWizard names this table QRYGRAPH.DBF by default.

<LI>&lt;expN1&gt; is the record number containing the graph to be displayed.

<LI>&lt;expN2&gt; is a mode number (0, 1, or 2) that determines how the data
   in the current work area will be inserted in the saved graph. The
   default mode is 1.

<LI>&lt;expC2&gt; is the graph title.

<LI>&lt;array&gt; is an array of &lt;expC&gt; containing the names of the fields in
   the order in which they are to appear in the graph data rectangle.
   This clause is used in mode 2 only.

<LI>&lt;expC3&gt; is the name of the field to use for x-axis (horizontal
   axis) labels (the clause may be blank). This clause is used in mode
   2 only.
<P>
</UL>When mode = 0, UPDATEGRPH converts the currently selected DBF/cursor
into the format that Microsoft Graph requires and inserts the data in
the previously saved graph (the new data replaces the previous data). The
graph data will match the DBF/table structure. For example, if a MODIFY
GENERAL window is double-clicked to bring up MS Graph itself, a spreadsheet-
like array of data will appear. If UPDATEGRPH is called with mode = 0, this
spreadsheet mirrors the structure of the DBF/cursor that is open in the
current work area.
<P>
The first field in the DBF/cursor is used for the x-axis labels, and the
other fields are stored as numeric values in the appropriate cells of the
spreadsheet. It is your responsibility to ensure that the DBF/cursor fields
are in the proper order and that they contain data that can be graphed.
Compared with mode 1 and mode 2, mode 0 provides an intermediate level of
flexibility, but makes you do more work. For example:
<P>
<PRE>   DO UPDATEGRPH IN GENGRAPH.APP WITH ;
     "c:\foxprow\qrygraph.dbf",4,0,"Graph Title"

</PRE>When mode = 1 (the default if no mode is specified), UPDATEGRPH updates the
previously saved graph with data from the currently selected DBF/table. In
this mode, UPDATEGRPH and REFRESHGRPH do essentially the same thing. The
previously saved field names, order of data, x-axis field, and graph title
are used to format the new data in the saved graph.
<P>
If you attempt to update a graph with data from a DBF/cursor that does
not contain all the fields found in the DBF/cursor originally used for
the graph, the message "Cannot update that graph with this data" will
appear. Although the new DBF/cursor can contain the fields in a different
order or contain additional fields, all the original fields must be present
in order to update the graph. For example:
<P>
<PRE>   DO UPDATEGRPH IN GENGRAPH.APP WITH "c:\foxprow\qrygraph.dbf",4

</PRE>In versions 2.5a and 2.5b, when mode = 2, you must supply &lt;array&gt; and
&lt;expC3&gt; to
UPDATEGRPH, which will use them to format the data found in the
currently selected DBF/cursor. Mode 2 provides the most flexibility
but requires the most work to set up. You would use this mode if the
DBF/cursor fields were not already ordered in the sequence that the graph
requires, or if only a few of the fields found in the DBF/cursor are to be
included in the graph.
<P>
In versions 2.5a and 2.5b, the syntax is as follows:
<P>
<PRE>   DIMENSION g_flist[4]
   g_flist[1] = "field1"     &amp;&amp; name of first data field
   g_flist[2] = "field2"     &amp;&amp; name of next data field
   g_flist[3] = "field3"     &amp;&amp; ... and so forth
   g_flist[4] = "field4"
   g_xaxis = "field5"     &amp;&amp; name of field whose values go on x-axis
   DO UPDATEGRPH IN GENGRAPH.APP WITH;
    "c:\foxprow\qrygraph.dbf",4,2,"Graph title",;
    g_flist, g_xaxis

</PRE>For example, suppose you used the GraphWizard to create a line chart, then
customized the chart from within MS Graph (changing fonts, repositioning
the legend, modifying colors, and so forth). Furthermore, suppose that the
graph contains sales data from a field named "Sales". The x-axis labels are
month names from a "Months" field. You save the customized graph in a
DBF/table called QRYGRAPH.DBF. QRYGRAPH.DBF already has other seven other
graphs in it--the new graph is saved in record number 8. Later, you want to
reuse the same carefully customized graph to display data from completely
different fields, perhaps "Expenses" and "Years" instead of "Sales" and
"Months". You can use the UPDATEGRPH procedure to make such changes to the
original graph. For example:
<P>
* The DBF with the expenses and years data is in the current work area:
<PRE>   DIMENSION g_flist[1]
   g_flist[1] = "Expenses"
   g_xaxis = "Years"
   DO updategrph IN gengraph.app WITH "qrygraph.dbf", 8, 2, ;
     "Expenses by Year", g_flist, g_xaxis

</PRE>This command updates the stored graph in record 8 of QRYGRAPH.DBF. The new
graph title is "Expenses by Year". The first column of data -- the data
shown in the MS Graph spreadsheet if a graph was double-clicked -- comes
from the DBF/cursor field "Expenses". The x-axis labels are drawn from the
values stored in the DBF/cursor field named "Years".
<P>
NOTE: In FoxPro for Macintosh only, executing UPDATEGRPH changes the font
of window "screen" to Geneva, 10.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxWin 2.50 2.50a msgraph 2.50b<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxinteropSpread<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
