

<HTML>
<HEAD>
<TITLE>How to Trouble-Shoot Sybase Server Connections in FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128557">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/03">
<META NAME="Keywords" CONTENT="kbinterop kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  On occasion, you may have difficulty in connecting to a Sybase server. The information in this article should help you troubleshoot connection problems when attaching to a Sybase server.  MORE INFORMATION  The Sybase Server database product is one ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAJW,QAI5,QAU9,QBVV,QA9E,QAVZ,QBWD,QAB4,QAAP,QBG2,QBBI,QBSO,QBWS,QBHQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Trouble-Shoot Sybase Server Connections in FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128557</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
On occasion, you may have difficulty in connecting to a Sybase server.
The information in this article should help you troubleshoot connection
problems when attaching to a Sybase server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Sybase Server database product is one of several back-end server data
sources that FoxPro can connect to via ODBC. Microsoft does not include a
driver specific to Sybase in the Connectivity Kit.  Sybase drivers can be
obtained from either Sybase or 3rd party ODBC driver vendors. The Microsoft
SQL Server ODBC driver included in the Connectivity Kit was certified for
connecting to 4.9.2 or earlier Sybase SQL Servers.  This driver will not
connect to Sybase System/10 servers, however, and the newer ODBC SQL Server
drivers from Microsoft (starting with version 2.00.1912) are not certified
to connect to any Sybase SQL Server versions.
<P>
If you attempt to connect to a pre-System/10 Sybase server with the older
Microsoft drivers, you may get a -2 error return code, which indicates an
environment-level error. Using DEBTOR() to find the specific error message
may yield something like this:
<P>
<PRE>   3-1 ODBC error 08001 (-1) [microsoft ODBC sql server driver] unable
   to connect to data source

</PRE>Or you may get this version of the message:
<P>
<PRE>   IM002 - Datasource not found - No default driver specified.

</PRE>The most common error that occurs when connecting to a Sybase server is
caused by the fact that the INSTCAT.SQL file has not been run. INSTCAT.SQL
is a configuration file distributed with the FoxPro ODBC installation disk.
This program must be run against versions of SQL Server or Sybase that are
earlier than 4.2a.
<P>
NOTE: If INSTCAT.SQL is transferred from one location to another, it should
not be sent using FTP with binary mode. It must be transported using text
mode. When INSTCAT is run, if it comes back within a few seconds, INSTCAT
has not run successfully; however, there will be no indication of this. You
still will not be able to connect. Instead, when INSTCAT runs, it will take
approximately one to two minutes. When it has completed, you should attempt
to connect again. INSTCAT.SQL will NOT run successfully if the master
database is full. If this is the case, the master database will need to be
rebuilt to provide the necessary room for INSTCAT.
<P>
If these steps do not solve the problem, try the following:

<UL><LI>Does the utility "Ping" see the server? If not, FoxPro will not connect.
   Ping is a third-party utility provided by Sybase and is warranted by
   Sybase, not Microsoft. Note that although Ping may be able to see the
   server, it does not go through ODBC to do so. It is a useful utility to
   establish that the network connections are working correctly.

<LI>Is the ODBC driver configured properly? The ODBC driver is typically
   configured from the Windows Control Panel. You should see either a
   Sybase or, if using the Microsoft SQL Server driver, the SQL Server
   driver listed as one of the data source drivers.

<LI>When issuing the DBCONNECT(), are you referencing the right name in the
   data_source portion of the DBCONNECT() string? In the ODBC SQL Server
   Setup, the name that is entered in the Data Source Name field is what
   will be used in the DBCONNECT() string.

<LI>Have you entered the correct server name? The server name is the name
   that identifies SQL Server on your network. If you are running on top of
   TCP/IP, you should enter an alias and you must also add values in the
   Network Library and Network Address text boxes.

<LI>Have you specified the correct network address? The network address
   specifies the location of the SQL Server system from which the driver
   will retrieve data. Under TCP/IP, this will take the form
   IP-Address.Socket-Address (e.g. 1.1.8.1.166.2025). For Microsoft SQL
   Server, this should be left to the value of (default).

<LI>Do you have the right network library? This is the name of the SQL
   Server Net-library DLL that the SQL Server driver uses to communicate
   with the network software. If this value is left to (default), the
   server driver will use the library for the default network specified in
   the SQL Server Client Configuration Utility.

<LI>Do you have a current version of the Sybase DLL Network Libraries?

<LI>Have you tried connecting using Excel and ODBC? Another package and
   ODBC?

<LI>Have you contacted Sybase to ensure that you have the right drivers
   installed on your local machine?

<LI>Have the stored procedures for Sybase been installed?

<LI>Are you putting a "" in the fourth parameter of the DBCONNECT string and
   not  a " " (quotation mark, space, quotation mark)? SQL Server and
   Sybase do not use the fourth parameter.

<LI>Is the Network Support Library for SQL Server located in a path where it
   can be found?
<P>
</UL>If you are using CKSAMPLE.APP to log on and it isn't working or it errors
out, then try to log on directly by setting the library to FPSQL and
issuing a manual DBCONNECT. For more information on how to do this, please
see page 5 of the FoxPro Connectivity Kit manual.
<P>
This information should resolve the majority of problems when connecting to
a Sybase server. If none of these solutions work, please contact Microsoft
Product Support for further assistance.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.60a ODBC SYBASE SQL SERVER TSHOOT<BR>
KBCategory: kbinterop<BR>
KBSubcategory: FxinteropOdbc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
