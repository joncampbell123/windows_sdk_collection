

<HTML>
<HEAD>
<TITLE>PRB: TRANSFORM() Does not Format a Calculated Field Properly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172849">
<META NAME="KBModify" CONTENT="1997/08/19">
<META NAME="KBCreate" CONTENT="1997/08/18">
<META NAME="Keywords" CONTENT="FoxWin FxtoolRwriter vfoxwin kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The TRANSFORM() function does not properly format a calculated field in the report writer. However, this function properly formats a non-calculated field in a report. In FoxPro 2.6 for Windows, the calculated field appears, but the format is incorr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAYL,QAE5,QABO,QDNG,QABH,QDL9,QBXS,QBWQ,QBWO,QBWN,QAWI,QAEN,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: TRANSFORM() Does not Format a Calculated Field Properly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172849</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0b, 5.0, 5.0a
<LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The TRANSFORM() function does not properly format a calculated field in the
report writer. However, this function properly formats a non-calculated
field in a report. In FoxPro 2.6 for Windows, the calculated field appears,
but the format is incorrect. In Visual FoxPro for Windows versions 3.x and
5.x, the calculated field appears as asterisks.
<P>
<P><h2>CAUSE</h2>
 
<P>
The TRANSFORM() function returns a character value. Because numeric
functions are applied to a calculated field, changing the field to a
character value causes erroneous results.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In FoxPro 2.6 for Windows, create a report variable to perform the desired
calculations and then format the report variable.
<P>
In Visual FoxPro for Windows versions 3.x and 5.x, just Sum the field and
check the Currency check box in the Format dialog of the field (it appears
under the Numeric category.) In the Format text box in the Report
Expression dialog of the calculated field, use the following to format the
output:
<P>
<PRE>   999,999.99

</PRE>Of course, a report variable could also be used in Visual FoxPro.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Perform the following steps in FoxPro 2.6 for Windows:

<OL><P><LI>Open the Detail table located in the \tutorial directory.

<P><LI>Set the order to the Ino tag.

<P><LI>Create a new report and add the Price field to the Detail line.

<P><LI>Add a Data Grouping to the report based on the Ino field.

<P><LI>Add the Ino field to the Group Header and add a second field
   referencing Price in the Group Footer band.

<P><LI>In the Price field in the Group Footer, click the Calculate
   check box, choose Sum and Reset on Detail.ino.

<P><LI>In the Price field in the Detail and Group Footer bands, add the
   following code to the Expression box:
<P>
<P><PRE>      TRANSFORM(Price,"$$$$,$$$.99")
</PRE>
<P><LI>Add a Report Variable to the report, xtotal, and set the Value to Store
   to Detail.price, Reset to Detail.ino, and Calculate to Sum.

<P><LI>Add a new field to the Group Footer and use the Report Variable, xtotal,
   as the expression. Format as Currency if desired.

<P><LI>Preview the report and notice that the calculated field is not preceded
<P><PRE>    with a dollar sign and it carries the number out to five decimal
    places. However, the report variable field has the correct format.
</PRE><P>
</OL>Perform the following steps in Visual FoxPro versions 3.0b or 5.0x:

<OL><P><LI>Open the Orders table located in the \Samples\Data folder.

<P><LI>Create a report and add the orders table to the data environment.

<P><LI>Set the order of the table to the Cust_id field using the Order
   property of the cursor in the data environment.

<P><LI>Add a data grouping to the report based on the Cust_id field.

<P><LI>Place the Cust_id field in the Group Header band and place the
   order_amt field in the Detail band. Double-click the field to bring up
   the Report Expression dialog box and in the Expression box, add the
   following code:
<P>
<P><PRE>      TRANSFORM(orders_amt,"$$$,$$$,$$$.99")
</PRE><P>
   Click OK to close the Report Expression dialog box.

<P><LI>Copy this field into the Group Footer band. Double-click the field,
   choose the Calculations button, and select the button for Sum. Click
   OK to close the Report Expression dialog box.

<P><LI>Preview the report. Note the non-calculated fields appear formatted
   correctly. However, the calculated fields appear as a row of asterisks.
<P>
</OL>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q102704.htm">Q102704</A></B>
   TITLE     : FIX: Can't Give Numeric the Currency Format in Report Writer
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: FoxWin VFoxwin<BR>
Keywords          : FoxWin FxtoolRwriter vfoxwin kbprb<BR>
Version           : WINDOWS:2.6a,3.0b,5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
