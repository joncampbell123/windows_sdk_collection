

<HTML>
<HEAD>
<TITLE>SAMPLE: Disable.exe Example Enables/Disables Menu Pads and Bars </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171570">
<META NAME="KBModify" CONTENT="1998/02/20">
<META NAME="KBCreate" CONTENT="1997/07/17">
<META NAME="Keywords" CONTENT="FxprgGeneral FxtoolFormdes FxtoolMBuilder vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Disable.exe is a sample that shows how to enable and disable menus, menu pads and menu bars in a Top-Level form in Visual FoxPro 5.x.  MORE INFORMATION  The following file is available for download from the Microsoft Software Library:   ~ Disable.e...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QAF0,QA4P,QANE,QAH4,QANS,QAG9,QBTB,QBWS,QACI,QBV8,QACF,QBWR,QBVV,QAEB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Disable.exe Example Enables/Disables Menu Pads and Bars</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171570</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Disable.exe is a sample that shows how to enable and disable menus, menu
pads and menu bars in a Top-Level form in Visual FoxPro 5.x.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/disable.exe">Disable.exe</A> <I>(size: 25263 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services


</PRE>To use the files included, follow these steps:

<OL><P><LI>Download the Disable.exe file and place it in a new folder.

<P><LI>Double-click Disable.exe to extract the files.

<P><LI>Once the files are extracted, start Visual FoxPro 5.x.

<P><LI>In Visual FoxPro, set the default directory to the location of the files
   through the Tools, Options dialog box, File Locations tab or with the
   SET DEFAULT TO command.

<P><LI>Start the program by issuing DO Disable.prg in the Visual FoxPro Command
   window or by choosing Do from the Program menu and choosing Disable.prg.

<P><LI>Click the buttons to disable and enable menu items as desired.

<P><LI>Quit and examine the Disable.mnx, Disable.scx and Disable.prg files as
   desired.
<P>
<P>
</OL><h3>Symptoms</h3>
 
<P>
Menu pads and the menu bars on those menu pads do not disable properly and
then do not re-enable when changing the SKIP FOR setting when the menu is
placed in an SDI form. In the case of menu pad bars, when the SKIP FOR
setting is changed to true, the bar will not disable (turn gray) until the
second time it is chosen. However, the command or procedure assigned to
that bar will not run. In the case of the menu pad, it also does not
disable until the second time it is chosen. However, even though the menu
will drop down, the options on it will not function.
<P>
Changing the SKIP FOR setting means that a logical memory variable is setup
in the Prompt Options dialog box for a menu prompt in the Skip For: box.
Normally changing that memory variable to True or False will enable or
disable the prompt if the menu is not in a Top-Level(SDI) form.
<P>
<P><h3>Resolution</h3>
 
<P>
The best resolution to this is to issue the full SET SKIP OF command to
enable or disable the menu components. To get the example in the Steps To
Reproduce Behavior to work properly, add the following code in the places
indicated.
<P>
In the Toggle Disable Menu button click method, make this the second line
of code:
<P>
<PRE>   SET SKIP OF PAD colors OF (Thisform.Name) lMenu

</PRE></OL>In the Toggle Disable Menu Bar button click method, make this the second
line of code:
<P>
<PRE>   SET SKIP OF BAR 1 OF colors lRed

</PRE>See the attached sample files for a better example of disabling and re-
enabling menus in a Top-Level form.
<P>
<P><h3>Status</h3>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h3>Additional Information</h3>
 
<P>
When designing a menu in the Menu Designer, a logical memory variable can
be placed in the SKIP FOR expression in the Prompt Options dialog box. The
logical values .T. or .F. can also be used for this expression but they
cannot be changed at runtime and this problem still occurs.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following steps to reproduce the behavior assume a working knowledge of
the Menu Designer and Form Designer in Visual FoxPro:

<OL><P><LI>Create a new program file and save it as NoDisabl.prg. Place the
   following code in the program file, and then save and close it:
<P>
<P><PRE>      lMenu=.F.
      lRed=.F.
      DO FORM NoDisabl
      READ EVENTS
</PRE>
<P><LI>Create a new menu in the Menu Designer called NoDisabl.

<P><LI>At the prompt for the first menu pad, type "Colors." Make the result a
   Submenu. Click the Options button and place "lMenu" in the Skip For
   text box (in the Prompt Options dialog box). Type in "colors" in the
   Pad Name box. Click OK to exit the Prompt Options dialog box.
<P>
   NOTE: The Pad Name is not necessary to reproduce the problem. The pad
<PRE>         name will be used later to illustrate a workaround to the problem.

</PRE><P><LI>Choose the Create button to create the Submenu.

<P><LI>To create two menu bar prompts, type "Red" and "Blue." Make the result
   of each a command. For the commands, enter:
<P>
<P><PRE>      WAIT WINDOW "Red"
</PRE><P>
<P><PRE>      -and-
</PRE><P>
<P><PRE>      WAIT WINDOW "Blue"
</PRE>
<P><LI>Click the Options button for the Red bar. In the Prompt Options dialog
   box, place "lRed" in the Skip For box. Click OK to exit the Prompt
   Options dialog box.

<P><LI>From the View menu, select General Options. Check the Top-Level Form
   check box in the General Options dialog box. Click OK.

<P><LI>Select the Generate command from the Menu, and then save and generate
   the menu. Name the menu files "NoDisabl.mnx" and "NoDisabl.mpr."

<P><LI>Create a new form named NoDisabl.

<P><LI>In the Init method of the form, place the following code:
<P>
<P><PRE>      DO NoDisabl.mpr WITH THIS, .T.
</PRE>
<P><LI>In the Destroy method of the form, place the following code:
<P>
<P><PRE>      RELEASE MENU (THIS.Name) EXTENDED
      CLEAR EVENTS
</PRE>
<P><LI>Place three CommandButtons on the form. Change the caption properties
   on the buttons to Quit, Toggle Disable Menu, and Toggle Disable Menu
   Bar.

<P><LI>In the Click method of the Quit button, place the following code:
<P>
<P><PRE>      Thisform.release
</PRE>
<P><LI>In the Click method of the Toggle Disable Menu, place the following
   code:
<P>
<P><PRE>      lMenu=!lMenu
      IF lMenu
<PRE></PRE>         WAIT WINDOW "lMenu is True, the pad should be disabled"
      ELSE
         WAIT WINDOW "lMenu is False, the pad should be reenabled"
      ENDIF
      Thisform.refresh

</PRE><P><LI>In the Click method of the Toggle Disable Menu Bar, place the following
   code:
<P>
<P><PRE>      lRed=!lRed
      IF lRed
<PRE></PRE>         WAIT WINDOW "lRed is True, menu bar Red should be disabled"
      ELSE
         WAIT WINDOW "lRed is False, menu bar Red should be reenabled"
      ENDIF
      Thisform.refresh

</PRE><P><LI>Set the ShowWindow property of the form to be 2 - As Top-Level Form.

<P><LI>Save the form as NoDisabl.scx and close it.

<P><LI>Issue the following command in the Visual FoxPro Command window:
<P>
<P><PRE>      DO NoDisabl.prg
</PRE>
<P><LI>Pull down the menu (use the mouse for this and the following steps) and
   ensure the Color options work.

<P><LI>Click the Toggle Disable Menu Bar button, note the WAIT WINDOW that
   appears. Pull down the menu and choose Red. Note that it is not
   disabled (gray) but the WAIT WINDOW does not appear. Pull down the menu
   again. The Red option should now be disabled (gray). Click the Toggle
   Disable Menu Bar button again and pull down the menu. Note that Red
   is still disabled.

<P><LI>Click on the Toggle Disable Menu button. Note the WAIT WINDOW and pull
   down the menu. Notice that it is not disabled but the Blue option
   doesn't bring up its WAIT WINDOW. Click on the menu pad again. It
   should immediately disable, if it is not already disabled. Click the
   Toggle Disable Menu button again. Note that the menu pad does not
   re-enable.

<P><LI>The menu pad should now be re-enabled but the mouse cannot get it to
   work. Press the ALT key and click the menu pad. It should now be
   re-enabled and the Blue option should work.

<P><LI>To see the menu work as expected outside the form, undo the following
   or re-create the example without the following:
<P>
<P><PRE>    - Step #7 - uncheck the Top-Level form and be sure to regenerate
      the menu.
    - Steps #10, 11 - remark out these lines of code.
    - Step #16 - set the ShowWindow property of the form to 0 - In Screen.
    - Add the following line of code to the NoDisabl.prg file just before
      the DO FORM NoDisabl line:
</PRE><P>
<PRE>         DO NoDisabl.mpr

    - In the NoDisabl.prg file, place SET SYSMENU TO DEFAULT after the
      CLEAR EVENTS command.

   When you run the NoDisabl program, the menu should work as expected.
   The Pad will not show as enabled or disabled until you click on it
   once or press the ALT key.

</PRE></OL> 
<PRE>Keywords          : FxprgGeneral FxtoolFormdes FxtoolMBuilder vfoxwin
Version           : WINDOWS:5.0,5.0a
Platform          : WINDOWS
Issue type        : kbfile
Solution Type     : kbsample</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
