

<HTML>
<HEAD>
<TITLE>How to Undo ON KEY LABEL ENTER Command After Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113922">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/04/20">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Under certain circumstances, you may want to redefine the ENTER key so that it performs an action, such as executing a procedure. However, if an error occurs during development before the ENTER key is returned to its original state, no commands can...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAC2,QAMB,QAH4,QAB9,QBXS,QAPN,QBV8,QAVS,QABA,QAY2,QAB4,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Undo ON KEY LABEL ENTER Command After Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113922</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, and 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, and 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Under certain circumstances, you may want to redefine the ENTER key so that
it performs an action, such as executing a procedure. However, if an error
occurs during development before the ENTER key is returned to its original
state, no commands can be entered in the Command window, and the statement
following the ON KEY LABEL ENTER command will attempt to execute instead.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Issuing the command "ON KEY LABEL ENTER &lt;function or command&gt;" prior to the
point at which that action is desired will cause that statement to be
executed when the ENTER key is pressed. To return the ENTER key to its
normal functionality, the command "ON KEY LABEL ENTER" (with nothing
following it) should be the first line of code in the procedure or function
(or the second line if there is a PARAMETER statement).
<P>
However, errors may occur before the line returning the ENTER key to the
default is executed, preventing the ENTER key from terminating commands in
the Command window. The following methods will allow you to restore the
normal functionality of the ENTER key.
<P>
After returning to the Command window from the error condition, do the
following:
<P>
<P><h3>Method 1</h3>
 

<OL><P><LI>In FoxPro for MS-DOS, choose Macros from the System menu. In FoxPro for
   Windows, choose Macros from the Program menu.

<P><LI>Select an unused default macro, such as F3.

<P><LI>Choose the Edit button.

<P><LI>Type the following:
<P>
<P><PRE>      ON KEY LABEL enter{LITERAL+ENTER}
</PRE>
<P><LI>Choose OK twice to close the Edit and Macros windows.

<P><LI>Press the macro key you just assigned.
<P>
</OL>NOTE: The above method will not work if the macro key you chose is already
assigned an action by an ON KEY LABEL command. For example, if the command
ON KEY LABEL F3 WAIT WIND TIME() is issued at the beginning of a FoxPro
session and is never released, the macro editor will still show the default
of "LIST{ENTER}" for F3. Even though the macro is redefined, the ON KEY
LABEL trap will have precedence, and the current time will be displayed
instead.
<P>
<P><h3>Method 2</h3>
 

<OL><P><LI>From the File menu, choose New. In the New File dialog box, choose
   Program and then choose New.

<P><LI>In the UNTITLED.PRG window, type the following command:
<P>
<P><PRE>      ON KEY LABEL ENTER
</PRE>
<P><LI>Press CTRL+O to execute the program and choose Yes to save changes.
   Type a name for the program and then choose Save.
<P>
</OL>The ENTER key is now reset.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.50 2.50a 2.50b 2.60 hung hang<BR>
return<BR>
ignored<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
