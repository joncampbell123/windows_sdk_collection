

<HTML>
<HEAD>
<TITLE>PRB: Receiving Error when Selecting 254th Item in List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164252">
<META NAME="KBModify" CONTENT="1997/08/08">
<META NAME="KBCreate" CONTENT="1997/02/26">
<META NAME="Keywords" CONTENT="FxtoolFormdes vfoxwin kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When selecting an item in a list box or combo box, one or more of the following errors can occur:   - Alias 'DYNAMICFONTUNDERLINE' is not found.   - Alias DYNAMICFONTSTRIKETHRU is not found.   - VFP caused an invalid page fault in module Vfp.exe.  ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAAP,QAPN,QAB4,QAO4,QA2Q,QAH4,QAE1,QARM,QBVV,QA7O,QA7N,QA2P,QAY2,QADX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Receiving Error when Selecting 254th Item in List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164252</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When selecting an item in a list box or combo box, one or more of the
following errors can occur:

<UL><LI>Alias 'DYNAMICFONTUNDERLINE' is not found.

<LI>Alias DYNAMICFONTSTRIKETHRU is not found.

<LI>VFP caused an invalid page fault in module Vfp.exe.

<LI>Syntax error.

<LI>Variable '' is not found.

<LI>Alias '' is not found.
<P>
</UL>These errors occur when selecting the 253rd item from the list box or combo
box and then selecting the 254th item. The RowSource property has to be set
to a field in a table or query and RowSourceType can be set to either
Alias, Fields, Query, or SQL statement.
<P>
When selecting the 253rd item in the list box, it may be necessary to move
the focus to another object and then back to the 254th item in the list box
to get one of the errors to occur.
<P>
In the Combo box, just selecting the 253rd item and trying to click to
display the combo list again triggers an error. These errors occur on any
table as long as the table has 254 or more records.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two ways to prevent these errors from occurring. One is to create
an array and change the RowSourceType property of the List or Combo box to
Array and the RowSource property to that array name. The second is to use
the Additem method to populate the list box or combo box. Below is a code
example that could be added to the Init event of a list box or combo box to
populate it. This code assumes that the table is already open.
<P>
<PRE>   GO TOP
   FOR x = 1 TO RECCOUNT()
     THIS.ADDITEM(&lt;field name&gt;)  &amp;&amp; Insert field from the table into list
     SKIP
   NEXT

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form and add the Orders table from the Visual FoxPro
   Samples\Data folder to the DataEnvironment.

<P><LI>Add a list box and command button to the form.

<P><LI>Set the RowSourceType property of the list box RowSourceType to Alias
   and the RowSource property to the field Order_id.

<P><LI>In the Click event of the command button, add the following code:
<P>
<P><PRE>      WAIT WINDOW STR(RECNO())
</PRE>
<P><LI>Run the form and move through the list box until the item 10252 appears.

<P><LI>Click on the command button, and then click back to the item 10253 in
   the list box. Note that one of the errors listed above occurs.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: listbox combobox<BR>
Keywords          : FxtoolFormdes vfoxwin kbtool<BR>
Version           : 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
