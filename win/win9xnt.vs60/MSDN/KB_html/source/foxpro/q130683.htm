

<HTML>
<HEAD>
<TITLE>How to Create a General Purpose Reusable Navigation Toolbar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130683">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/05/24">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes how to create and use a general-purpose navigational Toolbar that has VCR-like icons on its buttons.  MORE INFORMATION  Use the Visual Class Designer tool to create a general-purpose navigational Toolbar by creating a visual ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANS,QAF0,QAH4,QA5V,QBWS,QABO,QBTL,QA56,QA55,QA2O,QAPN,QACI,QABA,QBXS,QAUR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a General Purpose Reusable Navigation Toolbar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130683</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to create and use a general-purpose navigational
Toolbar that has VCR-like icons on its buttons.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the Visual Class Designer tool to create a general-purpose navigational
Toolbar by creating a visual class based on the Toolbar base class. Then
you need only add code to the individual buttons of this class, drop the
class on a formset, and then run the formset upon starting Visual FoxPro to
make the Toolbar accessible.
<P>
<P><h3>Steps to Create Custom Toolbar</h3>
 

<OL><P><LI>Choose New from the File menu, and select Visual Class as the file type.

<P><LI>Use the Visual Class Designer to create a new class based on the Toolbar
   base class. To this class, add four command buttons. Change the caption
   property for each button to &lt;&lt;, &lt;, &gt;, and &gt;&gt;.

<P><LI>Add the following code to the click method of each command button as
   indicated:
<P>
   Command1.Click (&lt;&lt;):
<P>
<P><PRE>      GO TOP
</PRE><P>
   Command2.Click (&lt;):
<P>
<P><PRE>      SKIP -1
      IF BOF()
<PRE></PRE>         GO TOP
      ENDIF

   Command3.Click (&gt;):

      SKIP +1
      IF EOF()
         GO TOP
      ENDIF

   Command4.Click (&gt;&gt;):

      GO BOTTOM

</PRE><P><LI>Save this new class.

<P><LI>Create a new form, and set the Visible property of the form to false
   (.F.). If the visible property on the form is set to true (.T.), meaning
   that the toolbar will be used as a navigation toolbar to move through
   records in a form, add the command _SCREEN.ACTIVEFORM.REFRESH to the
   code of each one of the command button's click events as the last line
   of code. Add the Toolbar class you just created and save the form.
   Choose Yes when prompted to create a formset. Confirm that the Visible
   property of the toolbar is set to true (.T.).

<P><LI>In the destroy procedure for the toolbar, place the following code to
   release the Toolbar and Formset memory when the Toolbar is closed:
<P>
   RELEASE THISFORMSET

<P><LI>Run the form.
<P>
</OL>The Toolbar should come up. Open a table, and note the record number in the
status bar. Click the various buttons, and note where the record pointer
moves by the watching the indicator on the status bar. The Toolbar can also
be moved and docked.
<P>
To open this Toolbar automaticaly when FoxPro starts, place the following
line in the CONFIG.FPW file:
<P>
<PRE>   command= DO FORM &lt;PATH\FORM NAME&gt;

</PRE></OL>Where PATH is the path to the location of this form and FORM NAME is the
name of the form when saved. This will allow the Toolbar to be used with
any open table.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbtool<BR>
KBSubcategory: FxtoolGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
