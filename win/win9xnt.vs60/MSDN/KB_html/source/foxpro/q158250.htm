

<HTML>
<HEAD>
<TITLE>FIX: Inherited Code Fires Twice with DODEFAULT() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158250">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1996/10/25">
<META NAME="Keywords" CONTENT="FxprgClassoop vfoxwin vfpfix5.0a kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When the DODEFAULT() function is used in a subclass method, it executes a method in the parent with the same name. When the parent has no method with that name, it then looks to the grandparent for that method. If it exists, it is executed. If the ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QAY5,QABO,QAJQ,QAB9,QA33,QAVX,QAVW,QAR4,QDKW,QABG,QAUJ,QBV8,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Inherited Code Fires Twice with DODEFAULT()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158250</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the DODEFAULT() function is used in a subclass method, it executes a
method in the parent with the same name. When the parent has no method with
that name, it then looks to the grandparent for that method. If it exists,
it is executed. If the grandparent has a NODEFAULT() function, the code
gets executed twice.
<P>
<P><h2>CAUSE</h2>
 
<P>
The parent in the above situation executes the code of the grandparent as
its own. Because the grandparent has a NODEFAULT() function, the parent
calls the method of the grandparent again.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, place a method that has the same name in the
parent. Place a DODEFAULT() command in the parent method.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design in the products listed at the beginning of this
article. This behavior does not occur in Visual FoxPro 5.0a
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a program with the following code:
<P>
<P><PRE>      ACTIVATE SCREEN
      CLEAR
      CREATEOBJECT("Test3")
      RETURN
</PRE><P>
<P><PRE>      DEFINE CLASS Test AS Form
      ENDDEFINE
</PRE><P>
<P><PRE>      DEFINE CLASS test1 AS Test
<PRE></PRE>         PROCEDURE Load
            ACTIVATE SCREEN
            ? "Class Test1, this.Class="+this.Class+ ;
              ", this.ParentClass="+this.ParentClass
               DODEFAULT()
         ENDPROC
      ENDDEFINE

      DEFINE CLASS test2 AS test1
      ENDDEFINE

      DEFINE CLASS test3 AS test2
         PROCEDURE Load
            ACTIVATE SCREEN
            ? "Class Test3, this.Class="+this.Class+ ;
              ", this.ParentClass="+this.ParentClass
            DODEFAULT()
         ENDPROC
      ENDDEFINE

</PRE><P><LI>Run the code. The Load method of test1 prints twice.
<P>
</OL>Change Class test2 in the following way if you wish the code in test1 to
execute only once:
<P>
<PRE>      DEFINE CLASS test2 AS test1
        PROCEDURE Load
           DODEFAULT()
        ENDPROC
      ENDDEFINE

</PRE></OL>The above code prevents Class test2 from running class test1's code as its
own.
 
<PRE>Keywords          : FxprgClassoop vfoxwin vfpfix5.0a kbprg kbbuglist kbfixlist
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
