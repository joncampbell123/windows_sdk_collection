

<HTML>
<HEAD>
<TITLE>HOWTO: Create an ASCII Text Output File with Headers &amp; Footers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172853">
<META NAME="KBModify" CONTENT="1997/08/19">
<META NAME="KBCreate" CONTENT="1997/08/18">
<META NAME="Keywords" CONTENT="FoxMac FoxWin FxprgGeneral FxprintGeneral kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Attempting to route a report to an ASCII text file from FoxPro 2.x for MS- DOS using the command REPORT FORM               TO FILE            , creates an ASCII text file without printer control codes. However, attempting to route a report to an AS...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA5V,QAUD,QBXT,QAIB,QAVK,QAH4,QAMB,QA5A,QAOX,QACI,QATX,QASR,QAG8,QBCI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Create an ASCII Text Output File with Headers &amp; Footers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172853</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Attempting to route a report to an ASCII text file from FoxPro 2.x for MS-
DOS using the command REPORT FORM &lt;report name&gt; TO FILE &lt;file name&gt;,
creates an ASCII text file without printer control codes. However,
attempting to route a report to an ASCII text file from FoxPro for
Macintosh using the command REPORT FORM &lt;report name&gt; TO FILE &lt;file name&gt;,
creates an ASCII text file with embedded printer control codes.
<P>
In FoxPro 2.x for Windows, the simplest way to create an ASCII text file
from a report is to use the Generic/Text only printer driver within
Windows. However, if for some reason you cannot install this printer
driver, you can use the following sample code as a workaround. The sample
code below creates a report programmatically and sends it to an ASCII text
file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If printer control codes are present in an ASCII text file, they can cause
significant difficulties when you try to share the file with another
application or user. The sample code below illustrates hot to use low-level
file input and output (I/O) functions to create an ASCII text output file
with headers and footers.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   *begin program
   m.usefile=sys(2004)              &amp;&amp; get the start up directory
   * add a path to the clients file
   m.usefile=m.usefile+"sample\organize\dbfs\clients.dbf"
   USE (m.usefile)                  &amp;&amp; use the clients table
   gnhandle=FCREATE('output.txt',0) &amp;&amp; create an output file
   * set up some variables to track pagination
   gnpage=1                         &amp;&amp; page count variable
   gnlines=0                        &amp;&amp; line count variable
   GO TOP                           &amp;&amp; go to the first record
   * Now loop  through the table
   DO WHILE !EOF()
      * If the number of lines is 0, put in a page header
      IF gnlines&gt;=65
         gnlines=0                  &amp;&amp; reset the line count to 0
         gnpage=gnpage+1            &amp;&amp; increment the page count
      ENDIF
      DO CASE
      CASE gnlines=0
         =pagehead()                &amp;&amp; procedure to write page header
         LOOP
      CASE gnlines=56
         =pagefoot()                &amp;&amp; procedure to write page footer
         LOOP
      OTHERWISE
         gnlines=gnlines+1          &amp;&amp; increment the line count
         * concatenate four character fields
         out_line=client_id+SPACE(3)+company+SPACE(3)+city+SPACE(3)+state
         =FPUTS(gnhandle,out_line)  &amp;&amp; output the string to the ASCII file
         * FPUTS() automatically adds a carriage return &amp; line feed
         * change fputs to fwrite if you want to control insertion of
         * the carriage return &amp; line feed characters
         SKIP                       &amp;&amp; skip to the next record
      ENDCASE
   ENDDO
   * If not at the end of the page, pad blank lines
   IF gnlines&lt;56
      out_line=""
      FOR i=gnlines TO 56
         =FPUTS(gnhandle,out_line)
         gnlines=gnlines+1
      NEXT
      =pagefoot()                   &amp;&amp; write the page footer
   ENDIF
   =FCLOSE(gnhandle)                &amp;&amp; close the open output file
   RETURN

   PROCEDURE pagehead
   =spacer()                        &amp;&amp; insert blank lines
   * Place  the title into the file
   out_line="This is Sample ASCII Text Output"
   gnlines=gnlines+1                &amp;&amp; increment the line count
   =FPUTS(gnhandle,out_line)        &amp;&amp; write the page header
   =spacer()                        &amp;&amp; insert blank lines
   RETURN

   PROCEDURE pagefoot
   =spacer()                        &amp;&amp; insert blank lines
   * Place the date and page number in the footer of the file
   out_line=DTOC(DATE())+SPACE(50)+"Page "+LTRIM(STR(gnpage))
   =FPUTS(gnhandle,out_line)        &amp;&amp; write the page footer
   =spacer()                        &amp;&amp; insert blank lines
   gnlines=0                        &amp;&amp; reset the line count to 0
   gnpage=gnpage+1                  &amp;&amp; increment the page count
   RETURN

   PROCEDURE spacer
   * Padding four lines in this loop
   out_line=""
   FOR i=1 TO 4
      gnlines=gnlines+1
      =FPUTS(gnhandle,out_line)
   NEXT
   RETURN
   *end of program file

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information on creating ASCII output files, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q139144.htm">Q139144</A></B>
   TITLE     : PRB: Can't Print a Plain, Unformatted Report to a File

   ARTICLE-ID: <B><A href="../foxpro/q121631.htm">Q121631</A></B>
   TITLE     : HOWTO: Print a Report to a File in FoxPro for Windows
</PRE> 
<PRE>Keywords          : FoxMac FoxWin FxprgGeneral FxprintGeneral kbcode
Version           : MACINTOSH:2.5b,2.5c,2.6a; WINDOWS:2.5,2.5a,2.5b,2.6,2.6a
Platform          : MACINTOSH WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
