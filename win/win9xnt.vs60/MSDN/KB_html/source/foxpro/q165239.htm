

<HTML>
<HEAD>
<TITLE>FIX: Removing Views from DBC in Project Causes Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165239">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1997/03/14">
<META NAME="Keywords" CONTENT="buglist5.00 FxtoolDbtabledes FxtoolProjman vfoxwin vfpfix5.0a kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The following error may be returned when trying to edit a table or a view from the project manager.     DBC Internal Consistency Error    Fatal Error 550 while attempting to report error 550.    Program has performed an illegal operation.  The erro...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QADK,QAEF,QA9N,QACI,QAB4,QAY2,QAAP,QA2Q,QAY4,QAKD,QAGB,QBWS,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Removing Views from DBC in Project Causes Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165239</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error may be returned when trying to edit a table or a view
from the project manager.
<P>
<PRE>   DBC Internal Consistency Error
   Fatal Error 550 while attempting to report error 550.
   Program has performed an illegal operation.

</PRE>The errors may vary but the illegal operation message will occur and FoxPro
will be shut down. Another error message that might be returned is "DBC is
corrupted."
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In Visual FoxPro 5.0, close any open projects, open the database designer
and remove the views.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been corrected in
Visual FoxPro 5.0a for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a program with the following code.
<P>
<P><PRE>      CLEAR
      CLOSE DATA ALL
      CLOSE ALL
      SET EXCLUSIVE ON
      SET SAFETY OFF
</PRE><P>
<P><PRE>      ERASE test.pjx
      ERASE t1.dbf
      ERASE t2.dbf
</PRE><P>
<P><PRE>      CREATE DATA test
</PRE><P>
<P><PRE>      CREATE TABLE t1 (name c(10))
      INSERT INTO t1 (name) VALUES ("test")
      INSERT INTO t1 (name) VALUES ("TEST")
      INSERT INTO t1 (name) VALUES ("test")
      INSERT INTO t1 (name) VALUES ("test")
</PRE><P>
<P><PRE>      CREATE TABLE T2 (addr c(10))
      INSERT INTO t2 (addr) VALUES ("addr")
      INSERT INTO t2 (addr) VALUES ("addr")
      INSERT INTO t2 (addr) VALUES ("addr")
      INSERT INTO t2 (addr) VALUES ("addr")
</PRE><P>
<P><PRE>      CREATE SQL VIEW xx as SELECT * FROM t1
      CREATE SQL VIEW x2 AS SELECT * FROM t1
      CREATE SQL VIEW x3 AS SELECT * FROM t1
      CREATE SQL VIEW x4 AS SELECT * FROM t1
      CREATE SQL VIEW x5 AS SELECT * FROM t1
      CREATE SQL VIEW x6 AS SELECT * FROM t1
</PRE><P>
<P><PRE>      CLOSE TABLES
      MODI PROJ TEST NOWAIT
</PRE>
<P><LI>After running the code, add the test database to the project.

<P><LI>While in the project manager, remove two or three views by selecting the
   view and choosing Remove.

<P><LI>From the project manager, modify the database and select "Clean Up
   Database" from the Database menu. This will pack the .dbc file.

<P><LI>Close the Database Designer window, and return to the project. Click on
   a view.
<P>
</OL>The error may not be returned on the first view. Click on a few views and
the error eventually occurs.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: data base<BR>
Keywords          : buglist5.00 FxtoolDbtabledes FxtoolProjman vfoxwin vfpfix5.0a kbbuglist kbfixlist<BR>
Version           : 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
