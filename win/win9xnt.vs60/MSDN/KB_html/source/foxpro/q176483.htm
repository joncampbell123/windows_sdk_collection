

<HTML>
<HEAD>
<TITLE>PRB: Large Amounts of RAM Seem to Process Data Slowly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176483">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1997/11/07">
<META NAME="Keywords" CONTENT="FxenvMemory FxenvOptimize FxenvOs FxotherHw vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Sometimes when you manipulate a table with certain FoxPro commands, the record counter on the status bar pauses or stops for long periods of time. The hard drive continues to process information. This problem is more noticeable on faster computers ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBW6,QBTL,QALX,QAM9,QADN,QA56,QA55,QAX3,QABE,QBXS,QA9N,QAY5,QAYY,QAX6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Large Amounts of RAM Seem to Process Data Slowly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176483</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Sometimes when you manipulate a table with certain FoxPro commands, the
record counter on the status bar pauses or stops for long periods of time.
The hard drive continues to process information. This problem is more
noticeable on faster computers that have large amounts of RAM installed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Set the foreground buffer of SYS(3050) to a smaller number. Here's an
example:
<P>
<PRE>     =SYS(3050,1,10000000) &amp;&amp; Sets the foreground buffer to 10 million
                           &amp;&amp; bytes.

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Using the commands COPY, APPEND, DELETE, INDEX, PACK or SQL-SELECT on a
large table in Visual FoxPro causes long pauses while the data is being
manipulated. The hard drive continues processing the data, but Visual
FoxPro seems to be inactive. This happens because computers that have large
amounts of RAM and are running Windows 95 or Windows NT give Visual FoxPro
a large amount of buffered memory to use. This memory is composed of RAM
and physical hard drive space. When FoxPro writes data into memory, large
temporary files are created. When they are written to the virtual memory
(the hard drive), that memory is always slower. Using a smaller amount of
foreground buffer memory with SYS(3050) makes Visual FoxPro use only the
RAM memory, which is faster. Reducing the foreground buffer size has
eliminated the long delay in most situations.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Use a computer with 64 MG of RAM or more, Visual FoxPro, and a table
   that contains 2 million or more records.

<P><LI>Open the table, issue a SET STATUS BAR ON, and a COPY TO test in the
   FoxPro Command window.

<P><LI>Watch the record counter on the status bar as it starts counting the
   copied records. After a while, the counter stops but the hard drive
   continues to process data. Later, the record counter starts counting
   again and then pauses after doubling the last record count.

<P><LI>Press the ESC key after watching this behavior, and type the following
   in the FoxPro Command window:
<P>
<PRE>        =SYS(3050,1,10000000)  &amp;&amp; The 10 million number can be changed to
                               &amp;&amp; suit individual situations.

</PRE><P><LI>Issue a COPY TO test command again and note that the counter does not
   pause as long this time.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual FoxPro Help File: SYS(3050)
<P>
"Foxtalk," February 1997, "Set Turbo On: How Visual FoxPro Memory Usage
Affects Performance," page 1, Flavio Almeida and Walter Loughney
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: slow freeze VFoxWin<BR>
Keywords          : FxenvMemory FxenvOptimize FxenvOs FxotherHw vfoxwin<BR>
Version           : WINDOWS:3.0,3.0b,5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
