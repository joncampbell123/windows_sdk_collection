

<HTML>
<HEAD>
<TITLE>FIX: RETURN TO Procedurename Command Doesn’t Work in Forms </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156322">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1996/09/20">
<META NAME="Keywords" CONTENT="FxprgClassoop FxprgGeneral FxtoolFormdes vfoxwin VS97FixlistSP3 VS97FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article pertains to the use of the Error event of a control and the RETURN TO command when trying to return to a method or event of a form or class that is different from where the Error event was generated. When using the RETURN TO command in...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAUD,QAPN,QAB4,QAO4,QAAP,QBV8,QAB9,QALW,QAGI,QAVI,QAKP,QABG,QDO3,QA5D V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: RETURN TO Procedurename Command Doesn’t Work in Forms</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156322</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article pertains to the use of the Error event of a control and the
RETURN TO command when trying to return to a method or event of a form or
class that is different from where the Error event was generated. When
using the RETURN TO command in a form or class, it will only return to the
method or event on some of FoxPro's error messages.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The RETURN TO command is useful when the execution of code needs to be
redirected to a method or event further up in the call stack. One reason
for wanting to return to some method or event different from the calling
method or event would be when trying to bypass the remainder of code in the
event or method that is after the line of code that caused the error. For
example, a Click event of the command button might call a method that
executes some code. If this code causes an error, the Error event of the
command button could handle the error and then a RETURN TO command could be
used to return to the Click event of the command button without executing
the rest of the code in the method that it called.
<P>
The problem is that this works with only some of the FoxPro commands. For
example, if the line of code that causes the error is "SET FILTER TO 10,"
the RETURN TO command does not work correctly. If the line of code is "WAIT
WINDOW 10," the RETURN TO command works correctly. Both are syntax errors,
but one works and the other does not.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form with the form designer and add a command button.

<P><LI>Place the following code in the Click event of the command button.
<P>
<P><PRE>      THISFORM.TriggerError
      ? "After calling the Triggererror method in the command button."
</PRE>
<P><LI>In the Error event of the command button, place the following code:
<P>
<P><PRE>      ? "In the Error event of the command button."
      RETURN TO click
</PRE>
<P><LI>Add a custom method to the form call TriggerError.

<P><LI>Add the following code to the method TriggerError.
<P>
<P><PRE>      USE HOME()+"samples\data\customer"
      SET FILTER TO 10
      *WAIT WINDOW 10
      ? "*** After the error code."
</PRE>
<P><LI>Run the form and click on the command button.
<P>
   Note that the "*** After the error code." message is displayed when
   the SET FILTER TO 10 command triggers an error. Now comment the SET
   FILTER command and uncomment the WAIT WINDOW 10 command. The
   "*** After the error code." message doesn't appear now because
   execution is returned directly to the Click event of the command
   button.
<P>
   Another thing to be aware of is that if there is code in the Error event
   of the form, control will not be returned to the method or event that is
   identified in the RETURN TO command.
</OL> 
<PRE>Keywords          : FxprgClassoop FxprgGeneral FxtoolFormdes vfoxwin VS97FixlistSP3 VS97FixlistSP2
Version           : 3.0 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
