

<HTML>
<HEAD>
<TITLE>How to Perform REPLACE for Two Databases w/ Common Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116037">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/06/09">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To update more than one record in a database from another, similar database, you may need to check for an end-of-file (EOF) marker during each iteration of the REPLACE operation. This is best accomplished with a DO ... WHILE loop, as demonstrated b...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2Q,QA7O,QA7N,QAVW,QAVX,QAG2,QBWS,QAZV,QBE7,QBE6,QAEF,QBV8,QAB9,QACI,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Perform REPLACE for Two Databases w/ Common Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116037</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To update more than one record in a database from another, similar
database, you may need to check for an end-of-file (EOF) marker during
each iteration of the REPLACE operation. This is best accomplished with
a DO ... WHILE loop, as demonstrated below.
<P>
NOTE: In order for this process to work, the two databases must have a
common key field.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To demonstrate this process, we'll use the CUSTOMER database in the FoxPro
TUTORIAL subdirectory. First, we'll copy CUSTOMER to a new database called
NEWCUST, then we'll delete the contents of the COMPANY field, and then
we'll restore the contents of the COMPANY field using the COMPANY field
information in CUSTOMER.
<P>

<OL><P><LI>Set the default directory to the location of CUSTOMER.DBF. For example,
   in FoxPro 2.x, issue the following command in the Command window:
<P>
<P><PRE>      SET DEFAULT TO C:\&lt;FoxPro_directory&gt;\TUTORIAL.
</PRE><P>
<P><PRE>    In Visual FoxPro, Issue the following:
</PRE><P>
<P><PRE>      SET DEFAULT TO C:\&lt;FoxPro_directory&gt;\SAMPLES\DATA
</PRE><P>
<P><PRE>    NOTE: In Visual FoxPro, you will also need to change all references
    below from from CNO to CUST_ID.
</PRE>
<P><LI>In the Command window, issue the following commands:
<P>
<P><PRE>      USE customer
      COPY TO newcust
      SELECT 0
      USE newcust
      ** the following command has no spaces between the quotation marks
      REPLACE ALL company WITH ""
      ** BROWSE the table with the empty COMPANY field contents
      BROWSE
      CLEAR ALL
      CLOSE ALL
      ** open a new program file called TEST
      ** if a program called TEST already exists, choose another name
      MODIFY COMMAND test
</PRE>
<P><LI>In the edit window for the TEST program, type the following commands:
<P>
<P><PRE>      SELECT 0
      USE customer
      SELECT 0
      USE newcust
</PRE><P>
<P><PRE>      SELECT customer
</PRE><P>
<P><PRE>      ** while not at end of file of CUSTOMER, do some actions
      DO WHILE !EOF()
<PRE></PRE>         ** select the destination table
         SELECT newcust
         ** replace the empty COMPANY field with data from CUSTOMER where
         **   the common key field is the same
         REPLACE newcust.company WITH customer.company;
            FOR newcust.cno = customer.cno
         ** select the source table again to go to next record
         SELECT customer
         SKIP
      ENDDO
      SELECT newcust
      ** BROWSE the table with the newly filled COMPANY data
      BROWSE

   NOTE: If the first database (that is, CUSTOMER) is indexed on the common
   key field between the two tables, replace the commands in step 3 with
   the following:

      SELECT 0
      USE customer ORDER TAG cno
      SELECT 0
      USE newcust
      REPLACE ALL newcust.company WITH customer.company FOR ;
         seek(cno,"customer")

</PRE><P><LI>Save TEST.PRG and then run it.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Language Reference," (Windows and MS-DOS) pages L3-312, L3-470, L3-480, L3-
816, L3-861, L3-1040, L3-1108
<P>
"Language Reference," (Macintosh) pages 271, 396, 404, 651, 685, 827, 884
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin VFoxWin 2.50 2.50a 2.50b<BR>
2.50c 2.60 2.60a 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
