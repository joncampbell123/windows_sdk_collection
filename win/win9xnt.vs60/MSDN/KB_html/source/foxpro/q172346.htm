

<HTML>
<HEAD>
<TITLE>FIX: Unable to Disable IME Box in a Grid at Runtime </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172346">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1997/08/04">
<META NAME="Keywords" CONTENT="FxtoolGeneral vfoxwin VS97FixlistSP3">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In Visual FoxPro 5.x, the Input Method Editor (IME) box can be disabled in the development environment but cannot be disabled at runtime in an executable (.exe) file.  CAUSE =====  When a text box is in a grid, the grid code overwrites the text box...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QAPN,QAH4,QABI,QBXS,QANX,QARR,QA7O,QA4P,QAR4,QAO4,QABH,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Unable to Disable IME Box in a Grid at Runtime</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172346</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Visual FoxPro 5.x, the Input Method Editor (IME) box can be disabled in
the development environment but cannot be disabled at runtime in an
executable (.exe) file.
<P>
<P><h2>CAUSE</h2>
 
<P>
When a text box is in a grid, the grid code overwrites the text box
object's IMEMode property and causes this behavior.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Two workarounds exist for this problem. First, place the following code in
the GotFocus event of each individual text box in a grid to reset the
IMEMode property:
<P>
<PRE>   This.IMEMode = 2

</PRE>Second, you can create a text box class that has the above code in the
GotFocus event, and subclass all the text box objects in the grid from the
text box class.
<P>
Setting the IMEMode property in the Properties window for each individual
text box does not work.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 3.
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The IME box allows the user to input Double Byte Character Set (DBCS)
characters into a character field. You can enable and disable the IME box
automatically by selecting Tools and Options from the main menu and then
selecting the "Browse IME Control" check box located on the General tab.
Once the "Browse IME Control" is checked, the IME box is automatically
enabled as you move into a character field in a grid.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Make sure the Browse IME Control check box is selected by selecting
   Options from the Tools menu, and then clicking the General tab.

<P><LI>Create a project named "imeproj."

<P><LI>Create a form named "imeform."

<P><LI>Add a table (for example, customer) to the DataEnvironment of the form,
   and drag the table to the form to create a grid.

<P><LI>Go into each individual text box and set the IMEMode property to "2 -
   Close IME."

<P><LI>Add a command button to the form and put the following code in the
   Click event:
<P>
<P><PRE>      RELEASE Thisform
      CLEAR EVENTS
</PRE>
<P><LI>Create a main program name "imemain," with the following code:
<P>
<P><PRE>      DO FORM imeform
      READ EVENTS
</PRE><P>
   Mark this program file as the main file in the project.

<P><LI>Create and run the executable file.
<P>
</OL>NOTE: The IME box still appears even though the IMEMode property is
<PRE>      already set to "2 - Close IME."

</PRE></OL>NOTE: The IME box only works on operating system platforms that
<PRE>      support DBCS, such as Microsoft Windows 95 Traditional Chinese
      version.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: IME DBCS<BR>
Keywords          : FxtoolGeneral vfoxwin VS97FixlistSP3<BR>
Version           : WINDOWS:5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbservicepack<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
