

<HTML>
<HEAD>
<TITLE>BUG: BROWSE with Child Relationship Gives Incorrect Info </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117409">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/06/27">
<META NAME="Keywords" CONTENT="kbprg kbdisplay kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If two sets of one-to-many relationships are set up and two Browse windows are created using fields from both the parent and the child databases, the second Browse window will show the first parent database as having no children even if children do...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBXS,QBWT,QA7O,QA7N,QA2Q,QAGQ,QAZV,QAY2,QAUR,QAML,QDMH,QAA1,QAG2,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: BROWSE with Child Relationship Gives Incorrect Info</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117409</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If two sets of one-to-many relationships are set up and two Browse windows
are created using fields from both the parent and the child databases, the
second Browse window will show the first parent database as having no
children even if children do exist.
<P>
To illustrate this situation, issue the following commands:
<P>
<PRE>   SET DEFAULT TO &lt;FoxPro_directory&gt;\TUTORIAL

   USE customer IN 1
   USE invoices IN 2
   SET ORDER TO TAG cno OF invoices.cdx IN invoices
   SET RELATION TO cno INTO invoices ADDITIVE
   SET SKIP TO invoices

   USE offices IN 3
   SELECT 3
   USE salesman IN 4
   SET ORDER TO TAG ono OF salesman.cdx IN salesman
   SET RELATION TO ono INTO salesman ADDITIVE
   SET SKIP TO salesman

   SELECT 1
   DEFINE WINDOW custinv FROM 1,1 TO 20,10
   BROWSE WINDOW custinv FIELDS customer.cno, invoices.cno NOWAIT SAVE

   SELECT 3
   DEFINE WINDOW offsale FROM 1,15 TO 20,25
   BROWSE WINDOW offsale FIELDS offices.ono, salesman.ono NOWAIT SAVE

</PRE>The last Browse window shows OFFICES.ONO with no SALESMAN.ONO fields. This
is incorrect, since there are multiple SALESMAN records with a "1" in the
ONO field. If you scroll the window, the child records will appear. If you
click outside the Browse window and then click the Browse window again, the
child records will disappear. However, the child records will appear and
remain visible if some other record, such as OFFICES.ONO 2, is selected in
the Browse window.
<P>
<P><h2>CAUSE</h2>
 
<P>
The record pointer for SALESMAN.ONO is at the end of the file (EOF). Once
another record is selected in the Browse window, the record pointer for
SALESMAN is moved off from the end of the file and the Browse window
functions as expected.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid this problem, include the following KEYBOARD command at the end of
this program:
<P>
<PRE>   KEYBOARD "{PGDN}"

</PRE>This command repositions the record pointer for the parent database,
OFFICES, and the child database, SALESMAN.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxWin 2.50 2.50a 2.50b 2.50c 2.60<BR>
buglist2.50<BR>
buglist2.50a buglist2.50b buglist2.50c buglist2.60<BR>
KBCategory: kbprg kbdisplay kbbuglist<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
