

<HTML>
<HEAD>
<TITLE>How To Return Multiple Results with HTTP ODBC/VFP ODBC Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152245">
<META NAME="KBModify" CONTENT="1996/07/11">
<META NAME="KBCreate" CONTENT="1996/06/08">
<META NAME="Keywords" CONTENT="kbprg kbinterop kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes how to make additions and modifications to Visual FoxPro ODBC driver Registry entries so it is possible to configure the driver not to return row count data from commands such as INSERT, UPDATE, and DELETE, that cause complic...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QA9E,QAXB,QABM,QAB9,QA2Q,QBV8,QALW,QAC1,QBD2,QAU9,QAL3,QAG2,QBWS,QA3N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Return Multiple Results with HTTP ODBC/VFP ODBC Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 11, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152245</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro ODBC Driver, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to make additions and modifications to Visual
FoxPro ODBC driver Registry entries so it is possible to configure the
driver not to return row count data from commands such as INSERT, UPDATE,
and DELETE, that cause complications when executing multiple SQL commands
in an .IDC file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Multiple SQL commands can be placed within an .IDC file for execution and
each command will get executed. However, when using HTTP ODBC, the .IDC
file does not support multiple-result sets. This includes row sets that
return a row count such as SQL commands INSERT, UPDATE, and DELETE.
<P>
By design, HTTP ODBC only allows you to retrieve one result. Therefore, if
the .IDC file contains multiple statements, only the first SQL statement
will return a result. For example, if the SQL Statement was:
<P>
<PRE>   SQLStatement:
   +UPDATE customer SET contact_name="Joe" WHERE customer_id="ALFKI" ;
    SELECT contact_name FROM CUSTOMER

</PRE>the UPDATE command would execute and return a row count and the SQL SELECT
command would never return a result.
<P>
By adding a registry entry, the Visual FoxPro ODBC driver will not ignore
the values returned from commands such as UPDATE, INSERT, and DELETE, and
only return values for the SQL Select command.
<P>
<P><h3>How to Make Registry Entries</h3>
 
<P>
WARNING: Be extremely careful when editing registry information. Mistakes
could cause serious system problems.

<OL><P><LI>Run REGEDT32.EXE, which is in your Windows\System32 directory.

<P><LI>Select:
<P>
   HKEY_LOCAL_MACHINE
<P><PRE>     SOFTWARE
       ODBC
<PRE></PRE>         ODBC.INI
           &lt;&lt;Data Source Name&gt;&gt;

   where &lt;&lt;Data Source Name&gt;&gt; is the name of the data source you have set
   up for HTTP ODBC. Also note that this may be under HKEY_CURRENT_USER
   instead of under HKEY_LOCAL_MACHINE, depending on your configuration. If
   you have multiple users logging onto one machine, then the entry will be
   HKEY_CURRENT_USER.

</PRE><P><LI>From the Edit menu, select Add Value.

<P><LI>Input the following for Key Name and Class:
<P>
   Key Name:  SetNoCountOn
<PRE>   Class:     REG_SZ

</PRE><P><LI>For the String, input "Yes" without the quotation marks.
<P>
</OL>Now you will be able to execute multiple SQL commands as requested. For
example:
<P>
<PRE>   SQLStatement:
   +UPDATE customer SET contact_name="Joe" WHERE customer_id="ALFKI" ;
    SELECT contact_name FROM CUSTOMER

</PRE></OL>will now execute and return the results of the SQL Select command.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 VFoxWin<BR>
KBCategory: kbprg kbinterop kbhowto<BR>
KBSubcategory: FxinteropDbase
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 11, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
