

<HTML>
<HEAD>
<TITLE>PRB: Cannot Generically Set DisabledForeColor on Some Objects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147307">
<META NAME="KBModify" CONTENT="1996/02/23">
<META NAME="KBCreate" CONTENT="1996/02/22">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  It is possible to set the DisabledForeColor of some objects generically, rather than using an explicit value. One way to do so is to set the DisabledForeColor property to =This.ForeColor to make the DisabledForeColor of most objects identical to th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBXS,QABH,QABI,QBV3,QAW6,QAHP,QA4P,QAH4,QACI,QANX,QAJQ,QAYZ,QAE1,QBWC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Generically Set DisabledForeColor on Some Objects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147307</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
It is possible to set the DisabledForeColor of some objects generically,
rather than using an explicit value. One way to do so is to set the
DisabledForeColor property to =This.ForeColor to make the DisabledForeColor
of most objects identical to the current ForeColor. However, this has no
effect on check boxes or on combo boxes that have a Style property of
2-DropDown List.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
<P><h3>Combo Box Objects</h3>
 

<OL><P><LI>Set the Style property of the combo box to 0-Dropdown Combo.

<P><LI>Set the DisabledForeColor property of the ComboBox to:
<P>
   =THIS.FORECOLOR

<P><LI>To make the combo box behave as if its Style property were 2-Dropdown
   List while enabled, place the following code in the KeyPress Event of
   the combo box:
<P>
   NODEFAULT
<P>
</OL>Now the combo box will behave as if its Style property were 2-Dropdown List
with a DisabledForeColor identical to the ForeColor.
<P>
<P><h3>Check Box Objects</h3>
 

<OL><P><LI>When you disable objects on the form, do not disable any check boxes.

<P><LI>Create a Custom property of the form to indicate whether objects are
   enabled or disabled that is called, for example, IsEnabled. Set this
   property to false (.F.) if the objects are to be initially disabled or
   true (.T.) if the objects are to be initially enabled.

<P><LI>In the GotFocus and MouseUp events of the check box(es), place the
   following code:
<P>
   IF !THISFORM.IsEnabled
<PRE>        NODEFAULT
   ENDIF

</PRE></OL>Now the check box always has the same ForeColor but can be disabled by
changing a custom property on the form such as IsEnabled to false.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form, and place a combo box and check box on the form.

<P><LI>Set the combo box Style property to 2-Dropdown List, the RowSourceType
   property to 1-Value, and the RowSource property to "One, Two, Three,
   Four, Five"

<P><LI>Set the DisabledForeColor property of both the combo box and the check
   box to =This.ForeColor.

<P><LI>Place a command button on the form. Give it a caption of Disable, and
   place the following code in its Click event:
<P>
   WITH THISFORM
<PRE>        .combo1.ENABLED =.f.
        .check1.ENABLED =.f.
   ENDWITH
   THISFORM.REFRESH

</PRE><P><LI>Run the form, click the combo box, and choose an item from the list.
   Click the Disable button. Note that the check box and the combo box text
   is not the same as the ForeColor when these objects are enabled.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
