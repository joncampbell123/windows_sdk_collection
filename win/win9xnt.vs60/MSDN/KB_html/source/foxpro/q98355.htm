

<HTML>
<HEAD>
<TITLE>How to Update a Master File from a Transaction File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98355 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/05/04">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The FoxPro UPDATE command allows existing records in a database to be updated from information contained in a second database, based on a common key field between the two databases. The UPDATE command does not allow new records in the second databa...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QA5V,QBD2,QAC1,QA2Q,QAG2,QAY2,QAB9,QAZV,QBWS,QBV8,QAA5,QA7O,QA7N,QDI1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Update a Master File from a Transaction File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98355 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The FoxPro UPDATE command allows existing records in a database to be
updated from information contained in a second database, based on a common
key field between the two databases. The UPDATE command does not allow new
records in the second database to be automatically added to the first
database. The following procedure can be used to update existing records as
well as add new records.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following procedure uses the UPDATE command to first update existing
records. A SELECT SQL command determines which records in the new data file
are not contained in the original data file. An APPEND command appends the
results of the SELECT command into the original database.
<P>
<PRE>   * oldfile = existing .DBF file
   * newfile = .DBF with updated and new records to add to oldfile

   * NOTE: For the UPDATE command to be successful, both databases
   * must have a key field in common and be ordered on that key field.

   SELECT A
      USE oldfile ORDER keyfield
   SELECT B
      USE newfile ORDER keyfield
   SELECT oldfile

   * Note: The following command must be edited to allow for
   * replacing each field in the oldfile DBF with the corresponding
   * field in the newfile DBF.

   UPDATE ON keyfield FROM newfile ;
      REPLACE oldfile.field1 WITH newfile.field1, ;
      oldfile.field2 WITH newfile.field2, ;
      oldfile.field3 WITH newfile.field3

   SELECT *;
      FROM newfile ;
      INTO TABLE myupdate ;
      WHERE newfile.keyfield NOT IN ;
            (SELECT oldfile.keyfield FROM oldfile)
   SELECT oldfile
   APPEND FROM myupdate
   SELECT myupdate
   USE
   SET SAFETY OFF
   DELETE FILE myupdate
   SET SAFETY ON

</PRE>For more information, see the SELECT, SELECT SQL, UPDATE, and APPEND FROM
commands in the FoxPro 2.0 "Commands &amp; Functions" manual or the FoxPro 2.5
"Language Reference."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxDos FoxWin 2.00, 2.50 2.50a<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgSql<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
