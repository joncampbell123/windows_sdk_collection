

<HTML>
<HEAD>
<TITLE>DOCERR: Missing Visual C/C++ "Multithreaded Using DLL" Setting </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137059">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="FxtoolLck kbdocerr kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In the Microsoft Visual FoxPro  Professional Features Guide,  Chapter 11, pages 188-189, instructions for compiling and linking a C library written with the Library Construction Kit are given for Microsoft Visual C++, 32-bit Edition, version 2.0. T...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBHQ,QBFY,QABA,QBWS,QBXS,QBAO,QASR,QA56,QA55,QAB4,QBVR,QA5B,QA6A,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: Missing Visual C/C++ "Multithreaded Using DLL" Setting</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137059</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbtool kbdocerr
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the Microsoft Visual FoxPro "Professional Features Guide," Chapter 11,
pages 188-189, instructions for compiling and linking a C library written
with the Library Construction Kit are given for Microsoft Visual C++,
32-bit Edition, version 2.0. These instructions omit an important setting
for the project - what library the linker should use to resolve external
references and what run-time library the DLL (FLL) to look for when it
is run.
<P>
The missing setting is the Use Run-Time Library setting under the Code
Generation category and it should be set to "Multithreaded using DLL."
<P>
NOTE: This was corrected in the Visual FoxPro 3.0b for Windows
documentation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Help File Documentation</h3>
 
<P>
This missing setting is also documented the Visual FoxPro Help file. To
find this topic quickly, do the following:

<OL><P><LI>Type HELP CHANGES in the Command window.

<P><LI>The Help Topics search dialog appears, with Changes to Printed
   Documentation selected. Click the Display button.

<P><LI>Click Professional Features Guide, then select the following:
<P>
<P><PRE>      Chapter 11: Creating a Library Heading.
</PRE><P>
</OL><h3>Correction to to Printed Documentation</h3>
 
<P>
To establish the "Multithreaded using DLL" setting, follow the steps shown
at the bottom of page 188 of the "Professional Features Guide." Between
steps 4 and 5 under the "To establish project settings" heading, change the
Use Run-Time Library drop-down list box to "Multithreaded using DLL." These
steps are reproduced below with the additional step shown as step 4a:
<P>
To establish project settings:

<OL><P><LI>From the Project menu, choose Settings.

<P><LI>In the Settings dialog box, click the C/C++ tab.

<P><LI>In the Category drop-down list box, choose Code Generator.

<P><LI>In the Calling convention drop-down list box, choose _fastcall.
<P>
</OL>4a. In the Use Run-Time Library drop-down list box, choose Multithreaded
<PRE>    using DLL.

</PRE><P><LI>Click the Link tab.

<P><LI>In the Object/Library Modules text box, add the following library:
<P>
   winapims.lib

<P><LI>Choose OK.
<P>
</OL>The following error is known to occur when linking the DLL or FLL in
Microsoft Visual C++ version 2.0:
<P>
<PRE>   error LNK2005: _memmove already defined in LIBCMT.lib(memove.obj)

</PRE></OL>See the "Steps to Reproduce Error Message" section of this article for the
steps that generate this error message, if you haven't .
<P>
The following information on the Use Run-Time Library setting is from the
Microsoft Visual C++ Help file on CD-ROM (Books Online):
<P>
When you use the Run-Time Library, the following options enable you to:

<UL><LI>Select either single-threaded or multi-threaded run-time routines.
<LI>Indicate that a multi-threaded module is a DLL.
<P>
</UL><h3>Single-threaded (Libc.lib)</h3>
 
<P>
Causes the compiler to place the library name Libc.lib into the object file
so that the linker will use Libc.lib to resolve external symbols. This is
the compiler's default action. Libc.lib does not provide multi-thread
support. Command-line equivalent: /ML
<P>
<P><h3>Multi-threaded (Libcmt.lib)</h3>
 
<P>
Defines _MT so that multi-thread-specific versions of the run-time routines
are selected from the standard header files. It also causes the compiler to
place the library name Libcmt.lib into the object file so that the linker
will use Libcmt.lib to resolve external symbols. Either /MT or /MD is
required to create multi-threaded programs. Command-line equivalent: /MT
<P>
<P><h3>Multi-threaded Using DLL (Msvcrt.lib)</h3>
 
<P>
Defines _MT and _DLL so that both multi-thread- and DLL-specific versions
of the run-time routines are selected from the standard header files. It
also causes the compiler to place the library name Msvcrt.lib into the
object file. Command-line equivalent: /MD
<P>
Applications compiled with this option are statically linked to Msvcrt.lib.
This library provides a layer of code that allows the linker to resolve
external references. The actual working code is contained in Msvcrt20.dll,
which must be available at run time to applications linked with Msvcrt.lib
<P>
You can substantiate this information by following these steps:

<OL><P><LI>In Microsoft Visual C++ version 2.0, click Books Online on the Help
   menu. (this may take a while to come up, especially if it is on the
   CD-ROM compact disc)

<P><LI>Click the User's Guides book icon.

<P><LI>Click the Search Plus button. The Search dialog box should appear with
   the Find tab active.

<P><LI>In the "Type the word(s) you want to find" box, type Code Generation.

<P><LI>In the "Click a topic, then click Display" box, click Code
   Generation Category, and then click Display.

<P><LI>Click Use Run-Time Library. The information should be displayed.
<P>
</OL><h3>Steps to Reproduce Error Message</h3>
 

<OL><P><LI>Open the \VFP\API\Samples\Examples.dbf database.

<P><LI>Find the record that has MEMMOVE in the Xname field. It should be
   record 98.

<P><LI>Copy the contents of the C_Code memo field for this record.

<P><LI>Start Visual C++ 2.0, and create a new code text file. Paste in the
   contents of the memo field copied in the previous step.

<P><LI>Save the .c file. Called it Lnk2005.c for now.

<P><LI>Create a new project in Visual C++ following all the steps shown on
   pages 188-189 of the "Professional Features Guide."

<P><LI>On the Project menu, click Settings. Then click the C/C++ tab, click
   Code Generation Category, and change the Use Run-Time Library to just
   Multi-threaded. The fix is to set this to Multi-threaded using DLL.
   Click OK to close the Settings dialog box.

<P><LI>On the Project menu, click Build &lt;name of project.DLL&gt;.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin lck api<BR>
KBCategory: kbtool kbdocerr<BR>
KBSubcategory: FxtoolLck<BR>
Keywords          : FxtoolLck kbdocerr kbtool<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
