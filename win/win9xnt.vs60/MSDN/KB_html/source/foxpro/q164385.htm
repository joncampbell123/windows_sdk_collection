

<HTML>
<HEAD>
<TITLE>BUG: Large Result Sets May Become Corrupted in VFP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164385">
<META NAME="KBModify" CONTENT="1997/04/01">
<META NAME="KBCreate" CONTENT="1997/02/28">
<META NAME="Keywords" CONTENT="FxprgClientsvr vfoxwin kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using a cursor or view against an external table like those in SQL Server or any other server, the local representation of the records at the end of the result set may become corrupted. Data on the server itself is not affected. Occurrence of ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBLX,QBXS,QAL3,QAO2,QABA,QAKP,QA7O,QA7N,QA5V,QAKC,QDL9,QBWQ,QBWO,QBWN,QBC6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Large Result Sets May Become Corrupted in VFP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164385</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using a cursor or view against an external table like those in SQL
Server or any other server, the local representation of the records at the
end of the result set may become corrupted. Data on the server itself is
not affected. Occurrence of the corruption varies with the size of the
result set and the settings of SYS(3050). Corruption may also occur with
the default settings for SYS(3050). Corruption occurs after switching to
another program or bringing up a new window like the Class Browser.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Below are some suggestions to avoid this problem:

<OL><P><LI>Maximize the buffer size by setting both SYS(3050,1) and SYS(3050,2) to
   the value of SYS(1001).

<P><LI>Do not use Class Browser concurrently or have projects or designers open
   when using these queries or views, and, where possible, avoid moving
   other application windows in front of Visual FoxPro during use of these
   cursors.

<P><LI>Test cursor or view for the presence of corruption with the following
   command:
<P>
<P><PRE>      LOCATE FOR AT(CHR(0))
</PRE>
<P><LI>Install more memory.

<P><LI>Work with smaller cursors, bringing down a smaller subset of the data.

<P><LI>Limit the number of cursor open at any given time.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
NOTE: This problem is rare and isolated to the specific conditions
described in this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Corruption depends upon available memory, the setting--if any--of
SYS(3050), the number of records, number of fields and size of the fields.
It seems that only very specific combinations cause the error. Changing a
field size or adding or deleting a field may resolve the problem.
 
<PRE>Keywords          : FxprgClientsvr vfoxwin kbprg kbbuglist
Version           : 3.0b 5.0 5.0a
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
