

<HTML>
<HEAD>
<TITLE>HOWTO: Applying, Removing a Filter from Form's DataEnvironment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164870">
<META NAME="KBModify" CONTENT="1997/03/07">
<META NAME="KBCreate" CONTENT="1997/03/07">
<META NAME="Keywords" CONTENT="FxotherGeneral FxprgSet kbother kbprg vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The following article demonstrates how to filter records in the DataEnvironment of a form and how to remove the filter.  MORE INFORMATION  1. Create a new form and add the Customer.dbf table from the directory           :\VFP\samples\mainsamp\data ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACI,QAH4,QAEF,QBWS,QA5V,QA9N,QAY2,QAJP,QDH6,QA2Q,QAPN,QANJ,QBJZ,QAG2,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Applying, Removing a Filter from Form's DataEnvironment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164870</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following article demonstrates how to filter records in the
DataEnvironment of a form and how to remove the filter.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Create a new form and add the Customer.dbf table from the directory
   &lt;drive&gt;:\VFP\samples\mainsamp\data to the DataEnvironment (from the
   view menu, select Data Environment.

<P><LI>From the DataEnvironment menu, select Add and then select the customer
   table.

<P><LI>Drag the customer_id field, the company_name field, and the country
   field to the form and add three command buttons to the form.

<P><LI>In the click event of the first command button, place the following
   code:
<P>
<P><PRE>      ThisForm.DataEnvironment.cursor1.filter = "country = 'Germany'"
      ThisForm.Refresh
</PRE>
<P><LI>In the click event of the second button place the following code:
<P>
<P><PRE>      ThisForm.DataEnvironment.cursor1.filter = ".T."
      ThisForm.Refresh  &amp;&amp; Note: Record position is lost with this code.
</PRE><P>
   - or -
<P>
<P><PRE>      STORE ThisForm.DataEnvironment.cursor1.alias to xVar
      SELECT &amp;xVar
      SET FILTER to
      ThisForm.Refresh  &amp;&amp; Note: record position is not lost.
</PRE>
<P><LI>In the click event of the third button place the following code:
<P>
<P><PRE>      SKIP
      IF EOF()
<PRE></PRE>         GO BOTTOM
      ENDIF
      Thisform.Refresh

</PRE><P><LI>Save the form and run it. Click the button Command1 to apply the
   filter, and then click the button Command2 to remove the filter.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
See the Visual Foxpro Help for reference to the Filter property and the
SET FILTER TO command.
<P>
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxotherGeneral FxprgSet kbother kbprg vfoxwin<BR>
Version             : 3.0 3.0b 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
