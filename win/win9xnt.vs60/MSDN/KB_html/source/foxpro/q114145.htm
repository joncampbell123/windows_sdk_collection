

<HTML>
<HEAD>
<TITLE>FIX: Index Doesn't Match Table When Opening dBASE Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114145">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/04/25">
<META NAME="Keywords" CONTENT="FxinteropDbase kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you attempt to use a dBASE IV (version 2.0) database, the following message is displayed:     Index does not match table. Re-create index.  CAUSE =====  The index blocksize in dBASE was set to a size other than 1 or 2 (or 512 bytes) with the S...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QBXS,QAB4,QDI1,QAHH,QABM,QBVV,QAR4,QAZV,QBV8,QAB9,QBWS,QBXN,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Index Doesn't Match Table When Opening dBASE Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114145</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>2.60    | 2.60
</PRE>WINDOWS | MS-DOS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6
<LI>Microsoft FoxPro for MS-DOS, version 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to use a dBASE IV (version 2.0) database, the following
message is displayed:
<P>
<PRE>   Index does not match table. Re-create index.

</PRE><h2>CAUSE</h2>
 
<P>
The index blocksize in dBASE was set to a size other than 1 or 2 (or 512
bytes) with the SET IBLOCK command. The index blocksize can also be set
with the SET BLOCKSIZE command, which sets the blocksize for both memo
files and index files.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
IMPORTANT: Neither of the two methods (described below) to correct this
problem will work if the database has one or more memo fields that were
converted to FoxPro memo fields before the "Index does not match table"
error message was displayed.
<P>
<P><h3>Method 1</h3>
 
<P>
To make the dBASE .MDX file readable by FoxPro, issue the following
commands from the dot prompt in dBASE IV:
<P>
<PRE>   USE &lt;filename&gt;
   SET IBLOCK TO 1
   COPY TO &lt;newfilename&gt; WITH PRODUCTION

</PRE>This will make a new copy of the database and the index file with the
correct index blocksize of 1 (512 bytes).
<P>
<P><h3>Method 2</h3>
 
<P>
If dBASE IV is not available, re-create the indexes as follows:

<OL><P><LI>Delete the .MDX file.

<P><LI>Issue the following command:
<P>
<P><PRE>      USE &lt;filename&gt;
</PRE>
<P><LI>Choose Ignore when you are warned "Structural CDX file not found."

<P><LI>Re-create the index tag(s) in FoxPro either by choosing Setup from the
   Database menu or by using the INDEX ON command (see page L3-571 in the
   "Language Reference").
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft FoxPro for
Windows and MS-DOS, version 2.6. This problem was corrected in Microsoft
FoxPro for Windows and MS-DOS, version 2.6a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The SET IBLOCK command sets the blocksize for new index files in blocks of
512 bytes. Valid values range from 1 to 63. Any value greater than 2 will
cause the problem described above.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In dBASE IV (version 2.0), issue the following commands:
<P>
<P><PRE>      SET IBLOCK TO 3 &amp;&amp; or SET BLOCKSIZE TO 3
      CREATE test
      * Add a field called 'ONE' that is Numeric, Width 5,
      * Decimals 0, Index 'Y'.
      USE
</PRE>
<P><LI>In FoxPro (version 2.6), try to open the database with this command:
<P>
<P><PRE>      USE test
</PRE><P>
   You will receive the error message:
<P>
<P><PRE>      Index does not match table. Recreate index.
</PRE>
<P><LI>In dBASE IV, issue the following commands:
<P>
<P><PRE>      SET IBLOCK TO 23 &amp;&amp; or SET BLOCKSIZE TO 23
      CREATE test2
      * Add a field called 'ONE' that is Numeric, Width 5,
      * Decimals 0, Index 'Y'.
      * Add a second field called 'TWO' that is type 'Memo'.
</PRE>
<P><LI>In FoxPro, try to open the database with this command:
<P>
<P><PRE>      USE test2
</PRE><P>
   You will be asked the following:
<P>
<P><PRE>      Convert MEMO file to FoxPro Format?
<PRE></PRE>        This can later be reversed with
            COPY ... TYPE FOXPLUS

   Choose Yes. (If you choose No, the error message "Not a table/.dbf" will
   be displayed and the table will not be opened.)

   You will next be prompted with:

      Remove dBASE 'soft' carriage returns from memos?
         Choose Yes if all memos are normal text
         Choose No if any memos have binary data

   Choose Yes or No; it does not make a difference in the results.

   You will receive this error message:

      Index does not match table. Recreate index.

</PRE></OL>At this point, you must use Method 2 (described above) to re-create the
indexes because the memo file can no longer be read by dBASE IV. (The COPY
TO ... TYPE FOXPLUS command can only be issued once the database is
opened.)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.60 buglist2.60 mdx cdx re-<BR>
create<BR>
fixlist2.60a<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxinteropDbase<BR>
Keywords          : FxinteropDbase kbbuglist kbfixlist kbprg<BR>
Version           : 2.60 | 2.60<BR>
Platform          : MS-DOS WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
