

<HTML>
<HEAD>
<TITLE>How to Check for Changes Made in a Database Record </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97638 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/04/19">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The UPDATED() function returns .T. if any GET field was changed during a READ command. Since push buttons, radio buttons, lists, invisible buttons, and spinners (spin boxes) are considered GET fields, UPDATED() will also return .T. if any of these ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAUD,QA7O,QAH4,QA7N,QABI,QAJQ,QABH,QBV8,QAB9,QA9V,QA9U,QA9T,QDMH,QAY0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Check for Changes Made in a Database Record</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97638 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The UPDATED() function returns .T. if any GET field was changed during a
READ command. Since push buttons, radio buttons, lists, invisible buttons,
and spinners (spin boxes) are considered GET fields, UPDATED() will also
return .T. if any of these controls are accessed during a READ command.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To write a simple code snippet to verify if any data in the current record
was changed during a READ command, do the following:

<OL><P><LI>When the record pointer is moved to a record, scatter the data to an
   array by issuing the following command:
<P>
<PRE>      SCATTER TO beg_edit MEMO    &amp;&amp; MEMO is required only if memo
                                   &amp;&amp; fields are being verified.

   If the record pointer is pointing to the same record in more than one
   session, move the record pointer off the record and then back in order
   to get current information:

      SKIP     &amp;&amp; provided we are not at EOF()
      SKIP -1  &amp;&amp; to return to the same record
               &amp;&amp; Now the second SCATTER will work correctly.

</PRE><P><LI>After all changes are complete, issue the following commands. Normally
   this code snippet would appear in the VALID clause of a push button or
   other control labeled to save the changes.
<P>
<P><PRE>      * Scatter to a second array for comparison.
      SCATTER TO end_edit MEMO
</PRE><P>
<P><PRE>      * Check each element in the array against the original data.
      FOR i = 1 TO alen(beg_edit)
<PRE></PRE>        IF beg_edit(i) &lt;&gt; end_edit(i)
            * Return .F. if any element has changed.
            RETURN .F.
        ENDIF
      ENDFOR
      RETURN .T.

</PRE></OL>To check for changes during a BROWSE, execute the code in step 1 in a
BROWSE WHEN user-defined function (UDF). Execute the code in step 2 in
a BROWSE VALID UDF.
<P>
<P><h3>Notes</h3>
 

<UL><LI>A set of two arrays is used for simplicity and portability. By using two
   arrays, the same code will work with any database, regardless of field
   names, field types, or number of fields.

<LI>Caution must be used when scattering large memo fields. If there is
   insufficient memory to hold the entire contents of the memo field, the
   memo field will not be scattered.

<LI>SET EXACT should be set to ON in order to eliminate the possibility of
   strings of different length comparing as equal.
<P>
</UL>For more information, see the version 2.0 "Commands &amp; Functions" manual or
the version 2.5 "Language Reference" manual.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 2.50a test testing tell<BR>
determine information data field compare comparison check "field change"<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
