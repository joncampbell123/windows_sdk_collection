

<HTML>
<HEAD>
<TITLE>PRB: Header Files Ignored by Recompile All &amp; Build Process </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147201">
<META NAME="KBModify" CONTENT="1996/02/23">
<META NAME="KBCreate" CONTENT="1996/02/21">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Issuing a Recompile All from the Project Manager does not force a recompile of program (.prg) files if the program has not been altered. As a result, header (.h) files that are referenced in the program file are ignored by the Recompile All and Bui...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKD,QAKJ,QBVV,QAY2,QAH4,QAJN,QAJQ,QA63,QAH5,QABH,QAGU,QABI,QAF8,QBRZ,QBDM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Header Files Ignored by Recompile All &amp; Build Process</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147201</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Issuing a Recompile All from the Project Manager does not force a recompile
of program (.prg) files if the program has not been altered. As a result,
header (.h) files that are referenced in the program file are ignored by
the Recompile All and Build processes. Therefore, if changes are made to a
header file that is referenced in a program file, the new changes are not
automatically redefined.
<P>
NOTE: This behavior applies only to header files that are referenced in
unchanged program files. In other words, header files referenced in forms
and classes are reprocessed by a Recompile All.
<P>
<P><h2>CAUSE</h2>
 
<P>
Each .prg file has an associated .fxp file after the first Build process.
If the .fxp and .prg file datetime stamps are the same, then it is assumed
that the .prg file hasn't changed, so it's left out of any subsequent
recompile processes.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two ways to force a recompile of .prg files:

<UL><LI>Delete all corresponding .fxp files before starting the build process
   from within the Project Manager.
<P>
   -or-

<LI>Issue a COMPILE *.PRG command from the Command window.
<P>
</UL>It is the presence of the .fxp file that prevents the Project Manager from
recompiling all files.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a simple project, and add a .prg file that contains a #INCLUDE
   statement that references a header (.h) file. Also include a WAIT WINDOW
   statement that will display the contents of a constant variable that is
   declared in the header file.

<P><LI>Add the header file to the Text File section of Project Manager.

<P><LI>In the header file, insert a #DEFINE command that places a value into
   the constant referenced by the WAIT WINDOW.

<P><LI>Build the project, and run it noting the value displayed from the
   constant. Then change the value for the constant in the header file.

<P><LI>Rebuild the project with the Recompile All Files check box selected.

<P><LI>Rerun the application, and note that the displayed value does not
   reflect the new value in the header file. The value is the same as the
   previously stored value.

<P><LI>Delete the .fxp file that corresponds to the .prg file.

<P><LI>Rebuild the project with the Recompile All Files check box selected.

<P><LI>Rerun the application, and note that the displayed value now reflects
   the value in the header file.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin re-compile<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolProjman<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
