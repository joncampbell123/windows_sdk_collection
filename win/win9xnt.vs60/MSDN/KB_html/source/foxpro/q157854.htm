

<HTML>
<HEAD>
<TITLE>How To Create a New Form Based on a Template </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157854">
<META NAME="KBModify" CONTENT="1996/10/29">
<META NAME="KBCreate" CONTENT="1996/10/18">
<META NAME="Keywords" CONTENT="kbtool kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The following program creates a new form (SCX) from a template without using the Options dialog box setting (accessed from the Tools menu).  MORE INFORMATION  1. Create a program called Newscx.prg as follows:        LPARAMETERS tcFileName,tcClass,t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBXS,QBTI,QAY2,QALW,QABA,QAGB,QAI2,QABO,QBXT,QBVV,QA5V,QA2O,QAIB,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Create a New Form Based on a Template</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157854</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following program creates a new form (SCX) from a template without
using the Options dialog box setting (accessed from the Tools menu).
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Create a program called Newscx.prg as follows:
<P>
<P><PRE>      LPARAMETERS tcFileName,tcClass,tcClassLibrary
      LOCAL lcFileName,lcLastSetClassLib,oForm
</PRE><P>
<P><PRE>      IF EMPTY(tcFileName)
<PRE></PRE>         CREATE FORM "" NOWAIT
         RETURN
      ENDIF
      lcFileName=ALLTRIM(tcFileName)
      IF NOT "."$lcFileName
         lcFileName=lcFileName+".SCX"
      ENDIF
      lcFileName=FULLPATH(lcFileName)
      IF FILE(lcFileName) AND MESSAGEBOX(LOWER(lcFileName)+;
         [ already exists.]+CHR(13)+;
         [Do you want to replace it?],52+256)#6
         RETURN .F.
      ENDIF
      IF EMPTY(tcClass)
         CREATE FORM (lcFileName) NOWAIT
         RETURN
      ENDIF
      IF EMPTY(tcClassLibrary)
         oForm=CREATEOBJECT(tcClass)
         IF TYPE("oForm")#"O"
            RETURN .F.
         ENDIF
         SET SAFETY OFF  &amp;&amp; Stop Save As dialog from appearing on next line
         oForm.SaveAs(lcFileName)
         SET SAFETY ON
         IF NOT FILE(lcFileName)
            RETURN .F.
         ENDIF
         MODIFY FORM (lcFileName) NOWAIT
         RETURN
      ENDIF
      lcLastSetClassLib=SET("CLASSLIB")
      SET CLASSLIB TO (tcClassLibrary) ADDITIVE
      oForm=CREATEOBJECT(tcClass)
      IF NOT lcLastSetClassLib==SET("CLASSLIB")
         RELEASE CLASSLIB (tcClassLibrary)
      ENDIF
      IF TYPE("oForm")#"O"
         RETURN .F.
      ENDIF
      SET SAFETY OFF    &amp;&amp; Stop Save As dialog from appearing on next line
      oForm.SaveAs(lcFileName)
      SET SAFETY ON
      IF NOT FILE(lcFileName)
         RETURN .F.
      ENDIF
      MODIFY FORM (lcFileName) NOWAIT
      RETURN

</PRE><P><LI>Run the program from the command line, passing it parameters for the
   name of the new form, the name of the form class on which the new form
   is based, and the name of the class library where the form class is
   stored. This assumes a class library containing at least one custom form
   class has already been created in the current directory. For example, to
   create a new form based on the "myform" class stored in a visual class
   library (VCX) called "myvcx," issue the following command from the
   command line:
<P>
<P><PRE>      =NewSCX("newform","myform","myvcx")
</PRE>
<P><LI>The preceding step opens the "newform" in the Form Designer. Edit the
   form in the Form Designer as usual.
<P>
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbhowto<BR>
KBSubcategory: FxtoolAccessory<BR>
Additional reference words: 3.00 3.00b 5.00 kbdsd VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
