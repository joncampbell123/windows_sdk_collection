

<HTML>
<HEAD>
<TITLE>PRB: _Tally System Variable Reports Incorrect Record Count </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161146">
<META NAME="KBModify" CONTENT="1996/12/18">
<META NAME="KBCreate" CONTENT="1996/12/17">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using a SEEK command in the FOR clause of the APPEND FROM command, the _TALLY system variable does not reflect the additional records added to a table.  CAUSE =====  The SEEK command is moving the record pointer in the table while the APPEND F...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QACI,QAG8,QA9N,QAY2,QBV8,QAYL,QAB9,QAUD,QAKD,QAH4,QDMH,QA28,QAY4,QATJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: _Tally System Variable Reports Incorrect Record Count</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161146</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using a SEEK command in the FOR clause of the APPEND FROM command, the
_TALLY system variable does not reflect the additional records added to a
table.
<P>
<P><h2>CAUSE</h2>
 
<P>
The SEEK command is moving the record pointer in the table while the APPEND
FROM command is adding records. This prevents the _TALLY from returning the
proper count.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Place the SEEK command, or any other command that may move the record
pointer, outside of the APPEND FROM command. Use a FOR...NEXT or an
IF...ENDIF loop structure to process and limit the records.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code example below creates two tables and populates them with one and
three records, respectively. After creating an index on the second table,
the APPEND FROM command adds records based on the results of the SEEK
command. The SEEK command, however, moves the record pointer while records
are being added, which causes _TALLY to return an incorrect value.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Create a program with the following code and run it:
<P>
<PRE>   CREATE TABLE test1 (fld1 c(10))
   CREATE TABLE test2 (fld1 c(10))
   INSERT INTO test2 (fld1) VALUES ('AA')
   INSERT INTO test1 (fld1) VALUES ('AA')
   INSERT INTO test1 (fld1) VALUES ('AA')
   INSERT INTO test1 (fld1) VALUES ('BB')
   SELECT test2
   INDEX ON fld1 TAG fld1
   APPEND FROM test1 FOR NOT SEEK(fld1,'test2')
   ? _TALLY

</PRE>_TALLY returns zero (0) instead of 2.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about updating master and transaction tables, please
see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q98355.htm">Q98355</A></B>
   TITLE     : How to Update a Master File from a Transaction File
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>
Additional reference words: 3.00 3.00b 5.00 VFoxWin KBDSD
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
