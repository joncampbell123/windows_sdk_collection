

<HTML>
<HEAD>
<TITLE>FIX: Reprint Group Header on Each Page Malfunctions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149068">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1996/03/27">
<META NAME="Keywords" CONTENT="kbtool kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you create a report with two or more data groupings with  Reprint Group Header on Each Page  selected for all data groupings, the groupings will print in incorrect order on the first page and on subsequent pages when a new outer grouping starts ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QAOX,QABH,QBWA,QAB9,QAR4,QAPN,QABI,QBWS,QAYY,QAM1,QAF8,QADZ,QBXT,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Reprint Group Header on Each Page Malfunctions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149068</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you create a report with two or more data groupings with "Reprint Group
Header on Each Page" selected for all data groupings, the groupings will
print in incorrect order on the first page and on subsequent pages when a
new outer grouping starts on a new page.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Follow steps 1-7 in the "Steps to Reproduce Problem" section of this
article. Then create and run the following program:
<P>
<PRE>   STORE .T. TO lFlag1
   REPORT FORM myreport TO PRINT &amp;&amp; or PREVIEW

   PROCEDURE PgHead
   lFlag1 = .T.

   PROCEDURE Grp1
   lFlag1 = .F.

</PRE>Now make the following changes to the report:

<OL><P><LI>Double-click the Page Header bar, and in the Page Header dialog box,
   type the following as the On Entry expression:
<P>
   PgHead()

<P><LI>Double-click the Group Header 1 bar, and in the Group Header dialog box,
   type the following as the On Exit expression:
<P>
   Grp1()

<P><LI>For every object in Group Header 2, add the following expression in the
   Print When dialog box:
<P>
   lFlag1 = .F.

<P><LI>Select the "Remove Line If Blank" check box.
<P>
</OL>It is possible to expand on this technique. For example if you have three
data groupings and you want to reprint the group header on each page, make
the following changes to the program:

<OL><P><LI>Modify the first line of the program to:
<P>
   STORE .T. TO lFlag1, lFlag2

<P><LI>Add the following line to the PgHead procedure:
<P>
   lFlag2 = .T.

<P><LI>Add a procedure:
<P>
   PROCEDURE Grp2
   lFlag2 = .F.

<P><LI>Modify the report, adding Grp2() as the On Exit expression for Group
   Header 2. Then for every object in the third group, add the following
   as the "Print Only When Expression Is True" condition:
<P>
   lFlag1 = .F. AND lFlag2 = .F.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open  Orders.dbf  from the Testdata database located in the Samples\Data
   subdirectory.

<P><LI>Create a new index tag named cust_emp on the expression:
<P>
   cust_id + emp_id

<P><LI>Create a new report, and add the Orders table to the Data Environment.

<P><LI>In the properties sheet of the Data Environment, in the Data tab of the
   Cursor object, set the Order property to cust_emp.

<P><LI>Add two Data Groupings to the report, the first (outer) being cust_id
   and the second (inner) being emp_id. In both cases, select the "Reprint
   Group Header on Each Page" check box.

<P><LI>Add a label "outer group" to Group Header 1 and "inner group" to Group
   Header 2.

<P><LI>Save the report as myreport.

<P><LI>Preview the report.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbbuglist kbfixlist<BR>
KBSubcategory: FxtoolRwriter VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
