

<HTML>
<HEAD>
<TITLE>FIX: Windows 95 GDI Leak with Show Window Contents Setting </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136338">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/09/06">
<META NAME="Keywords" CONTENT="FxenvOs kbbuglist kbenv kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  With the Project Manager open, GDI resources dwindle when dragging windows within Visual FoxPro under Windows 95 if the Microsoft Plus feature  Show window contents while dragging  is enabled.  WORKAROUND  The loss of GDI resources can be prevented...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QDL9,QAIM,QBWQ,QBWO,QBWN,QA56,QA55,QAA1,QBVV,QDI2,QA9N,QAIJ,QAO2,QA6A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Windows 95 GDI Leak with Show Window Contents Setting</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136338</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbenv kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
With the Project Manager open, GDI resources dwindle when dragging windows
within Visual FoxPro under Windows 95 if the Microsoft Plus feature "Show
window contents while dragging" is enabled.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The loss of GDI resources can be prevented by disabling the Microsoft Plus
"Show window contents while dragging" feature. If the GDI resources become
very low, most may be recovered by exiting and then restarting Visual
FoxPro.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0b for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Plus is a set of companion enhancements for Windows 95 which can
be installed to add functionality to the base feature set of Windows 95.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Install Microsoft Plus, and select the "Visual Enhancements" option when
   installing.

<P><LI>Using the right mouse button, click the Windows 95 desktop, and select
   Properties.

<P><LI>Click the Plus! tab, and select the "Show window contents while
   dragging" check box. The Plus! tab will not be available if Microsoft
   Plus is not installed.

<P><LI>Start the Windows 95 System Resource Meter from the Start Menu. Click
   the Start button. Then click Programs, click Accessories, click System
   Tools, and click Resource Meter. A green icon will appear in the Taskbar
   to the left of the clock.
<P>
   If the Resource Meter does not appear in the Start menu, it has not
   been installed. Install it by opening the Control Panel under My
   Computer. Click the Add/Remove Programs icon. Then click the Windows
   Setup tab, and select Accessories in the Components list. Click Details,
   and select the System Resource Meter check box in the Components list.
   Click the OK button twice. Windows 95 will prompt for the CD-ROM disc or
   floppy disk to complete the installation.

<P><LI>Start Visual FoxPro, and create a new project by clicking New on the
   File menu. Click Project, and then click New File. Type testproj in the
   Enter box of the Save As dialog box, and click Save.

<P><LI>Add a new form to the project by clicking the Documents tab of the
   Project Manager. Then select Forms, and click New. Click New Form to
   create the form.

<P><LI>Check the current System Resources by placing the mouse pointer over the
   green System Resource Meter icon in the taskbar. The percentage of
   available System, User, and GDI resources appears. Note the GDI
   percentage.

<P><LI>Click the Form Designer title bar in the center, hold down the mouse
   button and drag the mouse pointer around the Visual FoxPro desktop as
   follows: top right, top left, bottom left, bottom right. Repeat this
   about 20 times.

<P><LI>Repeat step 7, and read the GDI percentage. Observe that it falls by
   from 1% to 5% for each set of 20 drags of the form designer around the
   Visual FoxPro desktop.
<P>
</OL><h3>Additional Notes</h3>
 

<UL><LI>The GDI does not leak memory if the Project Manager is not open or if
   "Show window contents while dragging" is not enabled.

<LI>Closing all windows in Visual FoxPro will not fully recover the GDI
   resources lost. Closing Visual FoxPro itself will cause most or all of
   the GDI resources to be recovered.

<LI>During a long programming session, the GDI resources will eventually
   become depleted. At this point, you need to exit Visual FoxPro and
   restart to recover the resources.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin fixlist3.00b buglist3.00 sysmeter<BR>
insufficient<BR>
plus pack memory<BR>
KBCategory: kbenv kbfixlist kbbuglist<BR>
KBSubcategory: FxenvOs<BR>
Keywords          : FxenvOs kbbuglist kbenv kbfixlist<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
