

<HTML>
<HEAD>
<TITLE>How To Skip the Validation of a Control and Exit the Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150752">
<META NAME="KBModify" CONTENT="1996/10/17">
<META NAME="KBCreate" CONTENT="1996/05/08">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbwebcontent">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In some cases, it is necessary to exit a form even if the data in a given control does not meet the validation rules in the Valid method. To make this behavior possible, testing is done for some specific condition by stopping the code in the Valid ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAH4,QAPN,QAGB,QAKR,QA7O,QAVX,QAVW,QAPF,QBFM,QAOE,QAMN,QAB5,QAL2,QADO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Skip the Validation of a Control and Exit the Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150752</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In some cases, it is necessary to exit a form even if the data in a given
control does not meet the validation rules in the Valid method. To make
this behavior possible, testing is done for some specific condition by
stopping the code in the Valid Method from being evaluated. This article
describes how to release a form by clicking a command button even if the
data in the Textbox control is not valid.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example shows that by testing for the mouse position relative
to the Exit Command button, the Tab key, and the Enter key, the code skips
around the validation. Text1 Valid method contains an IF ELSE statement
where the IF portion tests a special condition, and the ELSE portion does
the validation.
<P>
When the ELSE portion is skipped, other controls get focus and the form is
terminated.
<P>
The special condition is an attempt by the user to exit the Text1 field
while the mouse is positioned on top of the exit button. The TAB and ENTER
keys are also part of that special condition because, by default, they also
cause the focus to move to another object.
<P>
NOTE: For this behavior to work, the ScaleMode of the form is set to 0-
Foxels.
<P>
<P><h3>Steps to Create Example</h3>
 

<OL><P><LI>Create a Form.

<P><LI>Set the ScaleMode property of the Form to 0-Foxels.

<P><LI>Add two textboxes named Text1 and Text2.

<P><LI>Add a Command button (Command1), and set the Caption property to Exit.

<P><LI>Add the following code to the Valid method of the Text1 object:
<P>
<P><PRE>      IF MCOL(THISFORM.name)&gt;=THISFORM.command1.left AND ;
<PRE></PRE>         MCOL(THISFORM.name)&lt;=THISFORM.command1.left + ;
         THISFORM.command1.width AND ;
         MROW(THISFORM.name)&gt;=THISFORM.command1.top AND ;
         MROW(THISFORM.name)&lt;=THISFORM.command1.top +  ;
         THISFORM.command1.height AND ;
         LASTKEY()&lt;&gt;9 AND LASTKEY()&lt;&gt;13
         RETURN .t.
      ELSE &amp;&amp; The next IF changes the Lastkey value to something
           * other than Tab or Enter, which is part of the workaround.
         IF LASTKEY()=9 OR LASTKEY()=13
            KEYBOARD "{RIGHTARROW}"
                  KEYBOARD "{LEFTARROW}"
            ENDIF
            * The next IF is an example of a validation code.
            * You can replace this example with your own validation code.
            IF EMPTY(THIS.value)
            RETURN .f.
            ENDIF   &amp;&amp; End of validation example.
      ENDIF

</PRE><P><LI>In the Click method of Command1, type "THISFORM.RELEASE", without the
   quotation marks.

<P><LI>Run the form and test it.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbwebcontent<BR>
KBSubcategory: FxprgBrowse
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 17, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
