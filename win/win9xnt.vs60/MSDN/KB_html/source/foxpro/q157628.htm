

<HTML>
<HEAD>
<TITLE>PRB:Double Quotes in Remote View Filter Expression Cause Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157628">
<META NAME="KBModify" CONTENT="1996/10/29">
<META NAME="KBCreate" CONTENT="1996/10/15">
<META NAME="Keywords" CONTENT="kbprg kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If the Filter expression of a remote view uses double quotes, then running or modifying the view causes the following error message:     Connectivity Error........invalid column name....  CAUSE =====  Microsoft SQL Server version 6.0 and up uses si...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAN0,QDOQ,QA50,QABM,QDOR,QADK,QANN,QAB4,QBWS,QAHH,QAAP,QA2Q,QAY5,QAPF,QBWT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB:Double Quotes in Remote View Filter Expression Cause Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157628</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If the Filter expression of a remote view uses double quotes, then running
or modifying the view causes the following error message:
<P>
<PRE>   Connectivity Error........invalid column name....

</PRE><h2>CAUSE</h2>
 
<P>
Microsoft SQL Server version 6.0 and up uses single quotes (') for string
constants and double quotes (") for identifiers with spaces like "my
table," "my column," and so forth. You must convert double quotes to single
quotes in the View Designer, before the example constant is included in the
SQL string.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
<PRE>Use Single Quotes ('   ') instead of Double Quotes ("  ").

</PRE>To make the example under "Steps To Reproduce Behavior" section work,
change the Example Expression in the Filter tab to use Single Quotes ('B')
instead of Double Quotes ("B"). If you are creating the Remote View
programmatically then change the WHERE clause to use single quotes as
follows:
<P>
<PRE>   CREATE SQL VIEW test;
     REMOTE CONNECTION "myConn";
     AS SELECT Authors.au_id, Authors.au_lname, Authors.au_fname;
       FROM dbo.authors Authors;
       WHERE Authors.au_lname = 'B'

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Use the 32-Bit ODBC Manager to create a DataSource to the PUBS database
   on a Microsoft SQL Server.

<P><LI>Open a Database or create a new one.

<P><LI>Create a Remote View based on the DataSource created in step 1.

<P><LI>Add the Authors Table to the View

<P><LI>Select three to four fields from the table

<P><LI>Click the Filter tab, create and select a character type field such as
   "Authors.au_lname," and select any criteria, for example, "=".

<P><LI>Add "A," with the double quotes (" ") as the expression.

<P><LI>Right-click the Query Designer and click Run Query from the shortcut
   menu.
<P>
</OL>The following error appears:
<P>
<PRE>   Connectivity Error [Microsoft][ODBC SQL SERVER DRIVER]
   [SQL SERVER]invalid column name 'B'

</PRE></OL>The same behavior occurs if you create a remote view programmatically. So,
instead of the above steps, you can issue the following commands to
reproduce this behavior:
<P>
<PRE>   CREATE SQL VIEW test;
     REMOTE CONNECTION "myConn";
     AS SELECT Authors.au_id, Authors.au_lname, Authors.au_fname;
       FROM dbo.authors Authors;
       WHERE Authors.au_lname = "B"
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbinterop kbprb<BR>
KBSubcategory: FxtoolQueryvwdes<BR>
Additional reference words: 5.00 kbdse VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
