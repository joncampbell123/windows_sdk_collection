

<HTML>
<HEAD>
<TITLE>How to Copy to and Paste from the Calculator Within a Screen </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124716">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/01/10">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If the calculator is activated while the READ generated by the Screen Builder is in effect, it will not become the window on top and may not be visible if the screen covers the area where the calculator was activated.  This article shows by example...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDMT,QAE5,QA9N,QA7O,QA7N,QAMB,QAC2,QAGB,QAKD,QBXS,QAUD,QBTL,QA7R,QAA8,QBLX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Copy to and Paste from the Calculator Within a Screen</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124716</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
<LI>Microsoft FoxPro for MS-DOS, version 2.6a
<LI>Microsoft FoxPro for Macintosh, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If the calculator is activated while the READ generated by the Screen
Builder is in effect, it will not become the window on top and may not be
visible if the screen covers the area where the calculator was activated.
<P>
This article shows by example how to bring up the calculator on top of the
READ window, as well as how to place the value of the current GET field in
the calculator, and return the result of the calculation to the GET.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following steps lead you through the process of incorporating this
functionality in the context of a screen set. Also shown in this example is
the ability to transfer values between the screen and the calculator.
<P>
Assumptions:

<UL><LI>A screen exists that contains at least one numeric field formatted with
   two decimal places.

<LI>A push button has been added to call the calculator.

<LI>The Cycle option under the Window pad of the System menu bar is
   available.

<LI>The GET fields on the screen are referencing the database fields
   directly rather than through memory variables.

</UL><OL><P><LI>Modify the screen that will access the calculator.

<P><LI>Bring up the Setup Code window, and enter the following:
<P>
   * set up variable to hold name of selected field
<PRE>   curfld = ""      &amp;&amp; current field to copy from and paste to
   * in FoxPro for Macintosh add the following line to keep the READ
   * window visible in front of the FoxPro screen
   #WCLAUSES IN SCREEN      &amp;&amp; FoxPro for Macintosh only

</PRE><P><LI>Open the Cleanup and Procedures window, and enter the following:
<P>
<PRE>   IF WVISIBLE("CALCULATOR")         &amp;&amp; exiting program, so
       DEACTIVATE WINDOW CALCULATOR  &amp;&amp;   close the calculator
   ENDIF

   PROCEDURE paste
   * Called when the calculation is completed
   REPLACE (curfld) WITH VAL(ALLTRIM(STR(_CALCVALUE,10,2)))
   SHOW GETS             &amp;&amp; update the display with the new value
   DO waste              &amp;&amp; close the calculator and clean up

   PROCEDURE waste
   * Called to close calculator and clean up status bar
   KEYBOARD CHR(23)      &amp;&amp; close window
   POP KEY               &amp;&amp; restore previously saved ON KEY LABEL set
   SET MESSAGE TO ""     &amp;&amp; erase message on status bar
   SET MESSAGE TO        &amp;&amp; reset to default messages

</PRE><P><LI>In VALID clause of each participating numeric field, enter:
<P>
<PRE>   curfld=VARREAD()      &amp;&amp; store the current field name

</PRE><P><LI>Within the VALID clause of the Calculator push button, enter:
<P>
   _CLIPTEXT=ALLTRIM( STR( EVALUATE( curfld ), 10, 2) ) &amp;&amp;store val
   KEYBOARD "{CTRL+F1}"  &amp;&amp; cycle focus to the calculator
<PRE>   PUSH KEY CLEAR        &amp;&amp; store any ON KEY LABEL definitions
   ON KEY LABEL F4 KEYBOARD "{CTRL+V}"   &amp;&amp; Copy GET to calc
   ON KEY LABEL F5 DO paste              &amp;&amp; Paste calc to GET, exit
   ON KEY LABEL F8 DO waste              &amp;&amp; Exit calculator, no paste
   ON KEY LABEL ESCAPE DO waste          &amp;&amp; (same as above)
   SET MESSAGE TO "    F4 = Copy GET    F5 = Paste, exit    F8 = Exit"
   ACTIVATE WINDOW CALCULATOR

</PRE><P><LI>Generate the .SPR and use the DO command to execute the screen.

<P><LI>To demonstrate the functionality, assume that a six percent increase
   must be added to a particular field. Press the TAB key to move to one of
   the numeric fields that has a Currency format [ @$ 9,999.99 ]. Enter the
   value of 123. Select the Calculator button, and press the F4 key.
<P>
   The field value will be inserted into the calculator. Multiply the value
   by .06 (asterisk-period-zero-six-enter), which should be 7.3800. Add
   this result to the original value (plus_sign-F4-enter), which should
   equal 130.3800. At this point, press the F5 key to exit the calculator.
   The value of $130.38 will be inserted into the field.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos FoxMac 2.60a SBuilder<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgRead<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
