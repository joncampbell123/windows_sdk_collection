

<HTML>
<HEAD>
<TITLE>SAMPLE: Fp0779.exe ISDISKIN Utility </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96480 ">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1993/03/18">
<META NAME="Keywords" CONTENT="FxtoolGeneral kbappnote kbcode kbfile kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Fp0779.exe is a sample that contains the ISDISKIN utility that provides an alternative method of dealing with the  Not Ready Reading Drive A  error message.  MORE INFORMATION  The following file is available for download from the Microsoft Software...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC9,QAV1,QAV0,QAUD,QAGI,QAH6,QBDM,QAJH,QA9N,QAYL,QBCU,QBXS,QBXB,QBVV,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Fp0779.exe ISDISKIN Utility</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96480 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.02 2.00 2.50 2.50a 2.50b 2.60
MS-DOS
kbprg kbappnote kbfile kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 1.02, 2.0, 2.5, 2.5a, 2.5b, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Fp0779.exe is a sample that contains the ISDISKIN utility that provides an
alternative method of dealing with the "Not Ready Reading Drive A" error
message.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
~ Fp0779.exe
<P>
For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>When a FoxPro program attempts to load a file from a floppy disk and no
disk is present in the drive or the drive door is open, MS-DOS returns a
"Not ready reading drive &lt;letter&gt;" message and provides the option to
"Abort, Retry, Ignore" the error.
<P>
To provide an alternative method of dealing with this error, the ISDISKIN
utility is included in the multiuser version of Microsoft FoxPro versions
1.02 and 2.0 for MS-DOS. A FoxPro application can call ISDISKIN to
determine the status of the drive and, if necessary, provide a more
appropriate message for the user.
<P>
<P><h2>THE TEXT OF FP0779</h2>
 
<P>
 
<PRE>       Microsoft(R) Technical Support Application Note (Text File)
                       FP0779: ISDISKIN UTILITY
</PRE> 
<PRE>                                                   Revision Date: 2/94
                                                       1 Disk Included

</PRE>The following information applies to Microsoft FoxPro(R) versions 1.02,
2.0, 2.5, 2.5a, and 2.5b for MS-DOS(R).
<P>
 
<PRE>| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY     |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an Application |
| Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER      |
| EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED      |
| WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR       |
| PURPOSE. The user assumes the entire risk as to the accuracy and    |
| the use of this Application Note. This Application Note may be      |
| copied and distributed subject to the following conditions:  1) All |
| text must be copied without modification and all pages must be      |
| included;  2) If software is included, all files on the disk(s)     |
| must be copied without modification (the MS-DOS utility diskcopy is |
| appropriate for this purpose);  3) All components of this           |
| Application Note must be distributed together;  and  4) This        |
| Application Note may not be distributed for profit.                 |
|                                                                     |
| Copyright (C) 1993-1994 Microsoft Corporation. All Rights Reserved. |
| Microsoft, FoxPro, and MS-DOS are registered trademarks and Windows |
| is a trademark of Microsoft Corporation.                            |
|---------------------------------------------------------------------|

</PRE><h2>INTRODUCTION</h2>
 
<P>
When a FoxPro program attempts to load a file from a floppy disk and no
disk is present in the drive or the drive door is open, MS-DOS returns a
"Not ready reading drive &lt;letter&gt;" message and provides the option to
"Abort, Retry, Ignore" the error. The ISDISKIN utility on the disk enclosed
with this Application Note is a binary file that provides an alternative
method of dealing with this situation. A FoxPro application can call
ISDISKIN to determine the status of the drive and, if necessary, provide a
more appropriate message for the user.
<P>
NOTE: .BIN routines cannot be used in the Windows environment.
<P>
<P><h3>To install ISDISKIN</h3>
 
<P>
NOTE: If you are using the multiuser version of FoxPro 1.02 or 2.0,
ISDISKIN.BIN is already installed in the FOXPRO2\GOODIES\ADDUSER directory
by default.

<OL><P><LI>Insert the enclosed FP0779 disk in your floppy disk drive.

<P><LI>Copy Isdiskin.bin to your main FoxPro directory. To do this, type
   the following at the MS-DOS command prompt and press ENTER
<P>
<P><PRE>      copy &lt;drive&gt;:\isdiskin.bin &lt;destination&gt;
</PRE><P>
   where &lt;drive&gt; is the floppy disk drive containing the FP0779 disk
   and &lt;destination&gt; is the drive and directory where your FoxPro
   files are located.
<P>
   For example, if the FP0779 disk is in drive A, and your FoxPro
   directory is named FOXPRO25 and is on drive C, type the following
   command:
<P>
<P><PRE>      copy a:\isdiskin.bin c:\foxpro25
</PRE><P>
</OL><h3>To use ISDISKIN in a FoxPro program</h3>
 

<OL><P><LI>If you are using FoxPro version 2.5 or later or the single-user version
   of FoxPro version 1.02 or 2.0, issue this command:
<P>
<P><PRE>      SET DEFAULT TO &lt;FoxPro directory&gt;
</PRE><P>
   If you are using the multiuser version of FoxPro version 1.02 or 2.0,
   issue this command:
<P>
<P><PRE>      SET DEFAULT TO C:\FOXPRO2\GOODIES\ADDUSER
</PRE>
<P><LI>Use the LOAD command to load the Isdiskin.bin file.

<P><LI>Create a character memory variable. Set the variable to the drive
   letter for the disk drive to test. For example, create a memory
   variable called &lt;pvalue&gt; and set it equal to "A:".

<P><LI>Use the CALL command to invoke the Isdiskin.bin file with the
   character memory variable as a parameter.
<P>
</OL>ISDISKIN returns one of the following values to indicate the status of
the disk drive:
<P>
<PRE>   Return value     Meaning
   ----------------------------------------------------------------------

   A:               Drive A tested and a disk is present in drive A.
   B:               Drive B tested and a disk is present in drive B.
   0: (zero)        No disk is present in the tested drive.

</PRE></OL>NOTE: Isdiskin.bin must be loaded each time the drive requires testing. If
multiple calls are made without reloading and the return value has changed
from A: to 0:, reinserting a disk will not cause A: to be returned; the
return value will remain 0:. To use the function reliably, reload it before
every call.
<P>
<P><h2>SAMPLE PROGRAM</h2>
 
<P>
<PRE>   * If you are using the multiuser version of FoxPro 1.02 or 2.0, use
   * SET DEFAULT TO C:\FOXPRO2\GOODIES\ADDUSER instead of the
   * following line.
   SET DEFAULT TO &lt;FoxPro directory&gt;
   LOAD isdiskin.bin
   pvalue = "A:"
   CALL isdiskin.bin WITH pvalue
   DO CASE
   CASE pvalue = "A:"
      RUN DIR A:
   CASE pvalue = "0:"
      WAIT WINDOW "Please put a disk into drive A:"
   ENDCASE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 1.02 2.00 2.50 2.50a 2.50b 2.60 AppNote<BR>
FP0779<BR>
softlib<BR>
KBCategory: kbprg kbappnote kbfile kbcode<BR>
KBSubcategory:<BR>
Keywords          : FxtoolGeneral kbappnote kbcode kbfile kbprg<BR>
Version           : MS-DOS:1.02,2.0,2.5,2.5a,2.5b,2.6<BR>
Platform          : MS-DOS<BR>
Issue type        : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
