

<HTML>
<HEAD>
<TITLE>RESTORE SCREEN FROM Mvar Produces "Variable 'Mvar' Not Found" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113539">
<META NAME="KBModify" CONTENT="1995/06/28">
<META NAME="KBCreate" CONTENT="1994/04/06">
<META NAME="Keywords" CONTENT="kb3rdparty kbprg kberrmsg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The RESTORE SCREEN FROM                   command produces a  Variable 'memory_variable' not found  error message. These symptoms may occur when you convert a dBASE IV application that exploits the global nature of a variable that contains a screen...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAUD,QAB4,QAB9,QAUR,QAH4,QALW,QDI1,QAA8,QABM,QAY2,QBVV,QAU7,QAPN,QAJX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>RESTORE SCREEN FROM Mvar Produces "Variable 'Mvar' Not Found"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113539</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, and 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, 2.5b, and 2.6
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The RESTORE SCREEN FROM &lt;memory_variable&gt; command produces a "Variable
<PRE>'memory_variable' not found" error message. These symptoms may occur when
</PRE>you convert a dBASE IV application that exploits the global nature of a
variable that contains a screen image.
<P>
<P><h2>CAUSE</h2>
 
<P>
In FoxPro, the scope of the variable created by SAVE SCREEN TO
&lt;memory_variable&gt; is private. The variable therefore ceases to exist when
execution of the function or procedure in which it was created terminates
due to a RETURN statement.
<P>
In dBASE IV, the scope of the variable created by SAVE SCREEN TO
&lt;memory_variable&gt; is global. The variable therefore continues to exist when
execution of the function or procedure in which it was created terminates
due to a RETURN statement.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid this problem and emulate the behavior of dBASE IV, modify the
dBASE IV program by creating a PUBLIC variable to hold the screen image.
<P>
For an example of this modification, see "Workaround" in the "More
Information" section below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
When executed in dBASE IV 2.0, the following code will not produce an error
message. When executed in FoxPro, however, this code will produce an error
message.
<P>
<PRE>   PROCEDURE ScreScop

        @ 10,10 SAY "Hello World"

        DO ScrnSave

        RESTORE SCREEN FROM myscreen

   RETURN

   PROCEDURE ScrnSave

        * In dBASE, this command creates a variable
        * called myscreen.  The variable has a global
        * scope, so it continues to exist when execution
        * of PROCEDURE ScrnSave is terminated by the
        * RETURN statement.

        SAVE SCREEN TO myscreen

        CLEAR

   RETURN

</PRE><h3>Workaround</h3>
 
<P>
The following code sample has been modified so that it can be executed in
FoxPro without producing an error message.
<P>
<PRE>   PROCEDURE ScreScop

        @ 10,10 SAY "Hello World"

        DO ScrnSave

        RESTORE SCREEN FROM myscreen

   RETURN

   PROCEDURE ScrnSave

        * In this example, a public variable is created
        * to hold the screen image.  This variable will
        * continue to exist when the RETURN statement
        * is executed.  The program will now behave
        * as expected.

        PUBLIC myscreen

        SAVE SCREEN TO myscreen

        CLEAR

   RETURN
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.00 2.50 2.50a 2.50b 2.60<BR>
errmsg err msg<BR>
KBCategory: kb3rdparty kbprg kberrmsg kbcode<BR>
KBSubcategory: FxinteropDbase<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 28, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
