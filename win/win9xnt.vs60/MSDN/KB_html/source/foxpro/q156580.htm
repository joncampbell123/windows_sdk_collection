

<HTML>
<HEAD>
<TITLE>SetAll('Value') Works for Text Boxes in Grids in VFP 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156580">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/26">
<META NAME="Keywords" CONTENT="kbsetup kbprint">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In Visual FoxPro 3.0 or 3.0b, issuing the following sets the value for any text box on a form, but not text boxes contained in grids on that form:           .Setall('value', '', 'textbox')  However, issuing the following sets properties for all tex...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QA56,QA55,QAPN,QAKD,QBXS,QAH4,QARR,QAL2,QAEB,QAMB,QAW6,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SetAll('Value') Works for Text Boxes in Grids in VFP 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156580</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro 5.0 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Visual FoxPro 3.0 or 3.0b, issuing the following sets the value for any
text box on a form, but not text boxes contained in grids on that form:
<P>
<PRE>   &lt;form&gt;.Setall('value', '', 'textbox')

</PRE>However, issuing the following sets properties for all text boxes, even
those contained in grids:
<P>
<PRE>   &lt;form&gt;.Setall(&lt;other property besides value&gt;, ;
      &lt;property value&gt;, 'textbox')

</PRE>In Visual FoxPro 5, the following works for all text boxes, even those
contained in grids within &lt;form&gt;:
<P>
<PRE>   &lt;form&gt;.Setall('value', '', 'textbox')

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This change was made because the behavior of SetAll() is not consistent
across all properties in Visual FoxPro 3.0.
<P>
Use the following steps to reproduce this behavior.

<OL><P><LI>Run the following code from a program (.prg) file:
<P>
   * Start of code example
   *
   PUBLIC oform
   LOCAL lnI
   CREATE TABLE table_1 (field1 C(10), field2 C(10))
   FOR lnI=1 TO 3
<P><PRE>      INSERT INTO table_1 VALUES ('xx','yy')
</PRE>   ENDFOR
   GO TOP
<P>
   oform=CREATEOBJECT("grid_form")
   oform.SHOW()
<P>
   DEFINE CLASS grid_form AS FORM
<P>
<P><PRE>      AUTOCENTER = .T.
</PRE><P>
<P><PRE>      ADD OBJECT grid1 AS GRID WITH ;
<PRE></PRE>         Top = 10, ;
         Left = 30, ;
         RecordSource = 'Table_1', ;
         ColumnCount = 2, ;
         Name = "Grid1", ;
         Column1.Sparse=.F., ;
         Column2.Sparse=.F.

      ADD OBJECT Text1 AS TEXTBOX WITH ;
         Top = 220, ;
         Left = 45, ;
         Height = 23, ;
         Width = 95, ;
         Value = "zz", ;
         Name = "Text1"

      ADD OBJECT command1 AS COMMANDBUTTON WITH ;
         Top = 218, ;
         Left = 145, ;
         Height = 27, ;
         Width = 95, ;
         Caption = "Set Values", ;
         Name = "Command1"

      ADD OBJECT command2 AS COMMANDBUTTON WITH ;
         Top = 218, ;
         Left = 245, ;
         Height = 27, ;
         Width = 95, ;
         Caption = "Set FontSize", ;
         Name = "Command2"

      PROCEDURE DESTROY
         USE
      ENDPROC

      PROCEDURE Command1.Click
         THISFORM.SetAll('Value', '', 'TextBox')
         * The above works for text boxes in grid columns
         * under Visual FoxPro 5.0 only
         THISFORM.Grid1.SetFocus()
      ENDPROC

      PROCEDURE Command2.Click
         THISFORM.SetAll('FontSize', 12, 'textbox')
         * The above works for text boxes in grid columns
         * under Visual FoxPro 3.x and 5.0.
         THISFORM.Grid1.SetFocus()
      ENDPROC

   ENDDEFINE
   *
   * End of code example

</PRE><P><LI>Click on the Set FontSize command button. In both Visual FoxPro 3.0 and
   5.0, the FontSize changes for all text boxes, even those within the
   grid. Because the Sparse property is set to .F., the FontSize appears
   for all cells within the grid, rather than the selected cell.

<P><LI>Click on the Set Value command button. In both Visual FoxPro 3.0 and
   5.0, the Value changes for the text box on the form. In Visual FoxPro
   5.0 only, the FontSize also changes for all text boxes within the
   current record in the grid.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual FoxPro 5.0 Help
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbprint<BR>
KBSubcategory: FxprgGrid FxsetupGeneral FxprintFont<BR>
Additional reference words: 5.00 kbdse VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
