

<HTML>
<HEAD>
<TITLE>HOWTO: Causing a Form or Formset to Time Out </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133451">
<META NAME="KBModify" CONTENT="1997/04/18">
<META NAME="KBCreate" CONTENT="1995/07/31">
<META NAME="Keywords" CONTENT="FxtoolFormdes kbtool vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro version 2.x provided a TIMEOUT clause on the READ command. If no user input activity occurred during the specified interval, the read operation would stop. You can duplicate this functionality with a timer control on a form in Visual FoxPro....">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBBI,QAH4,QATK,QAU3,QAPF,QAO4,QAMR,QAML,QACE,QAFH,QAI2,QA7O,QAOE,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Causing a Form or Formset to Time Out</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133451</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
FoxPro version 2.x provided a TIMEOUT clause on the READ command. If no
user input activity occurred during the specified interval, the read
operation would stop. You can duplicate this functionality with a timer
control on a form in Visual FoxPro. The enhanced event model in Visual
FoxPro allows greater control over exactly which events cause a form to
time out. For example, you can cause the form to close if the mouse is
clicked even though no key was pressed. This article shows you how.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following process sets two form level properties (dtKeyPress and
dtMouseMove) to store the time of the last keystroke or mouse movement. The
timer control verifies the elapsed time since the last occurrence of these
two events. If more than the specified interval has elapsed, the form is
released.

<OL><P><LI>Create a new form. Add the following properties to the form:
<P>
   dtCurrTime
   dtKeyPress
   dtMousemove

<P><LI>In the Init method of the form, add the following code:
<P>
   ThisForm.DtKeyPress = DATETIME()
   ThisForm.dtMouseMove = DATETIME()

<P><LI>In the KeyPress method of the form, add the following code:
<P>
   ThisForm.dtKeyPress = DATETIME()

<P><LI>In the MouseMove method of the form, add the following code:
<P>
   ThisForm.dtMouseMove = DATETIME()

<P><LI>Add a timer control to the form. Set the Interval property of the timer
   to the desired number of seconds * 1000. Add the following code to the
   TimerEvent method of the timer:
<P>
   lnIntervalInSeconds = This.Interval / 1000
   ThisForm.dtCurrTime = DATETIME()
   IF ThisForm.dtCurrTime - ThisForm.dtMousemove &gt;= lnIntervalInSeconds ;
<P><PRE>      AND ;
      ThisForm.dtCurrTime - ThisForm.dtKeypress &gt; = lnIntervalInSeconds
<PRE></PRE>         ThisForm.Release
   ENDIF

</PRE><P><LI>Add a text box to the form for testing purposes. Save and run the form.

<P><LI>The form should time out and release after the specified number of
   milliseconds.
<P>
</OL><h3>Incorporating a Timeout into a Formset</h3>
 
<P>
To adapt this example to close an entire formset, follow these steps:

<OL><P><LI>Create the three properties specified in step 1 of the example so that
   they are created at the formset level.

<P><LI>Place the Init code specified in step 2 in the Init method of the
   formset. Change the reference of ThisForm to ThisFormSet.

<P><LI>Create the timer control on each individual form in the formset. This is
   required because the formset itself does not contain KeyPress and
   MouseMove events. Each form in the formset must maintain its own
   unique timer, but the formset itself must maintain the information as
   to whether the user has interacted with any form within the formset.
   Change all ThisForm references to ThisFormSet within this method.

<P><LI>Change the reference of ThisForm in steps 3 and 4 of the example to
   ThisFormSet.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: idle delay<BR>
Keywords            : FxtoolFormdes kbtool vfoxwin<BR>
Version             : 3.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
