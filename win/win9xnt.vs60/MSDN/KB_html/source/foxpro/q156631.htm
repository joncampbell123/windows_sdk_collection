

<HTML>
<HEAD>
<TITLE>PRB: Parameterized View Discrepancy Using IN() Filter Criteria </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156631">
<META NAME="KBModify" CONTENT="1997/01/20">
<META NAME="KBCreate" CONTENT="1996/09/27">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A Parameterized View returns incorrect results when assigning multiple string values to a parameter of the IN() Filter criteria.  CAUSE =====  The View Designer is not designed to handle queries where multiple values are assigned to a parameter in ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADK,QAPF,QAUD,QBWT,QA5V,QAHE,QA2Q,QBV8,QAB9,QAG2,QA4H,QASR,QAR4,QANE,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Parameterized View Discrepancy Using IN() Filter Criteria</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156631</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A Parameterized View returns incorrect results when assigning multiple
string values to a parameter of the IN() Filter criteria.
<P>
<P><h2>CAUSE</h2>
 
<P>
The View Designer is not designed to handle queries where multiple values
are assigned to a parameter in the IN() clause.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To use View Designer to create a parameterized View that returns the
correct values when using the IN() filter criteria, you need to specify
multiple parameters instead of a single one. For example, you would specify
the following in the Filter tab of the View:
<P>
<PRE>   Field Name = "customer.customer_id"
   Criteria = IN
   Example = ?a, ?b, ?c

</PRE>This will produce the following SQL statement:
<P>
<PRE>   SELECT *;
     FROM tastrade!customer;
     WHERE Customer.customer_id IN (?a, ?b, ?c)

</PRE>When you browse the View, it will prompt you to enter three parameters. If,
for example, you enter "ALFKI," "ANATR," and "ANTON" for the parameters,
then three records will be displayed correctly. Alternately, you can assign
the strings, for example "ALFKI," "ANATR," and "ANTON" respectively, to
each of the variables a, b, and c before browsing the View.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI> Issue the following command in the Command window:
<P>
<P><PRE>    MODIFY DATABASE HOME()+"samples\tastrade\data\tastrade.dbc"
</PRE>
<P><LI> Create a new View using the View Designer.

<P><LI> Add the table  Customer  to the View.

<P><LI> Select all fields for output.

<P><LI> In the filter section, enter  customer.customer_id" as the "Field
<P><PRE>    Name," select "IN" as the Criteria, and enter "?lcKeyList" as the
    Example.
</PRE>
<P><LI> When you click the View SQL option, you should see the following:
<P>
<P><PRE>    SELECT *;
       FROM tastrade!customer;
       WHERE Customer.customer_id IN (?lcKeyList)
</PRE>
<P><LI> Save the View.

<P><LI> In the Command window, execute:
<P>
<P><PRE>    lcKeyList=' "ALFKI,""ANATR,""ANTON" '
</PRE>
<P><LI> Browse the View.

<P><LI>Note that you get an empty cursor. Close the Browse window.

<P><LI>Again in the Command window, release lcKeyList by executing:
<P>
<P><PRE>    CLEAR ALL
</PRE>
<P><LI>Browse the View.

<P><LI>When asked for the value for lcKeyList, enter "ALFKI," "ANATR,"
<P><PRE>    "ANTON."
</PRE>
<P><LI>Note that you get a single record. Close the Browse window.

<P><LI>In the Command window, execute:
<P>
<P><PRE>    lcKeyList=' "ALFKI","ANATR","ANTON" '
</PRE>
<P><LI>In the Command window, execute:
<P>
<P><PRE>    SELECT * FROM tastrade!customer
       WHERE customer_id IN (&amp;lcKeyList)
</PRE>
<P><LI>Note that a cursor with three records is returned.
<P>
</OL>The result in step 17 is correct and this is what is expected to be
returned by the View created with the View Designer and displayed using
steps 8-10 and then steps 11-14.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxtoolQueryvwdes<BR>
Additional reference words: 5.00 kbdse VFoxWin PARAMETER MULTIPLE
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
