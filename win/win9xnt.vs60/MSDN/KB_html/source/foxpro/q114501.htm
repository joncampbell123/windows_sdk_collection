

<HTML>
<HEAD>
<TITLE>BUG: System Hang with BROWSE and SET REPROCESS TO 0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114501">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/05/04">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The computer may hang if a BROWSE command is executed with an ON ERROR routine that performs only the RETRY command while SET REPROCESS has been set to 0.  RESOLUTION  In the error handler routine, give the user a chance either to stop the RETRY co...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QAMB,QBXS,QAVX,QAVW,QAMN,QAB9,QAKP,QBWT,QBV8,QDJO,QBWS,QA5V,QAAP,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: System Hang with BROWSE and SET REPROCESS TO 0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114501</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The computer may hang if a BROWSE command is executed with an ON ERROR
routine that performs only the RETRY command while SET REPROCESS has been
set to 0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In the error handler routine, give the user a chance either to stop the
RETRY command or to try to resolve the problem before the RETRY command is
executed.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro version 2.6 for
Windows. We are researching this problem and will post new information here
in the Microsoft Knowledge Base when it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Run FoxPro.

<P><LI>Type the following commands in the Command window:
<P>
<P><PRE>      SET EXCLUSIVE OFF
      USE SYS(2004)+"TUTORIAL\CUSTOMER"
      BROWSE
</PRE>
<P><LI>Modify the first record to obtain a record lock.

<P><LI>Minimize FoxPro.

<P><LI>Run another instance of FoxPro.

<P><LI>Open the same copy of CUSTOMER.DBF that is open in the other instance
   of FoxPro.

<P><LI>Run the following program:
<P>
<P><PRE>      DEFINE WINDOW test AT 0.00, 0.00 SIZE 22.000,98.400 ;
<PRE></PRE>         FONT "MS SANS SERIF", 8 FLOAT NOCLOSE MINIMIZE SYSTEM
      SET REPROCESS TO 0
      ON KEY LABEL ESCAPE DO eschand
      ON ERROR DO errhand
      m.wzlquitting=.F.
      ACTIVATE WINDOW test

      @ 7.385, 21.600 GET m.qziBrowse PICTURE "@*HN Browse" ;
         SIZE 1.769,9.000, 0.667 DEFAULT 1 ;
         FONT "MS SANS SERIF", 8 STYLE "B" VALID button1()

      READ CYCLE NOLOCK VALID m.wzlquitting

      RELEASE WINDOW test
      ON ERROR
      ON KEY LABEL ESCAPE

      PROCEDURE errhand
      RETRY

      PROCEDURE dobrow
      ON KEY LABEL SHIFT+F5
      BROWSE NORMAL IN SCREEN NOWAIT

      FUNCTION button1
      ON KEY LABEL SHIFT+F5 DO dobrow
      KEYBOARD "{SHIFT+F5}"

</PRE><P><LI>Choose the Browse push button. The system will hang.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.60 stop responding lock up halt freeze<BR>
buglist2.60<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
