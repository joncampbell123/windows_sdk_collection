

<HTML>
<HEAD>
<TITLE>FIX: Access Violation Error on 16 MB Windows NT System </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145721">
<META NAME="KBModify" CONTENT="1996/02/08">
<META NAME="KBCreate" CONTENT="1996/02/06">
<META NAME="Keywords" CONTENT="kbenv kbfixlist kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The  Access violation  error may occur when you use table buffering, transactions, and large amounts of data on a computer system that has 16 megabytes of memory and that is running Windows NT version 3.51. The error does not occur on sytems runnin...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBWO,QBXS,QA1S,QAH4,QBI8,QAXB,QAR4,QAAP,QAGB,QDL9,QBWQ,QBWN,QAKP,QDN9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Access Violation Error on 16 MB Windows NT System</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 8, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145721</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The "Access violation" error may occur when you use table buffering,
transactions, and large amounts of data on a computer system that has 16
megabytes of memory and that is running Windows NT version 3.51. The error
does not occur on sytems running Windows NT with 24 or 32 megabytes of RAM.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use TABLEUPDATE() with smaller data sets. The Sample Code listed in this
article fails when updating 4000 records at one time. However, reducing the
number to 2000 cures the problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0b for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code to Reproduce Problem</h3>
 
<P>
*-- Begin Code Example
SET ESCAPE OFF
SET TALK OFF
SET FULL ON
SET DELETED ON
SET EXCLUSIVE OFF
SET EXACT ON
SET MULTILOCKS ON
<P>
CLOSE DATA ALL
<P>
IF !FILE( 'mydbc.dbc' )
<PRE>    CREATE DATABASE mydbc
    OPEN DATA mydbc EXCLUSIVE
    CREATE TABLE mytable (keyfld n(10) PRIMARY KEY)
    CLOSE DATA ALL
</PRE>ENDIF
<P>
USE mytable
CALC MAX(keyfld) TO m.keyfld
<P>
IF CURSORSETPROP('buffering', 5 )
<PRE>    ? 'table buffering enabled'

    FOR i = 1 TO 4000
        m.keyfld = m.keyfld + 1
            IF i % 100 = 0
                ? i, ' records added'
            ENDIF
            INSERT INTO mytable (keyfld) VALUES (m.keyfld)
    ENDFOR

    ? 'beginning transaction'
    BEGIN TRANSACTION
    ? 'transaction begun'

    IF TABLEUPDATE( .t. )
            ? 'table update succeeded'
    ELSE
            ? 'table update failed'
            =TABLEREVERT(.t.)
    ENDIF

    ? 'ending transaction'
    END TRANSACTION
    ? 'transaction ended'

</PRE>ENDIF
WAIT WINDOW
CLOSE DATA ALL
*-- End Code Example
<P>
NOTE: This has not been tested on computers that are running Windows for
Workgroups or Windows 95 with 16 megabytes of RAM.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin buglist3.00 fixlist3.00b Crash<BR>
tableupdate<BR>
KBCategory: kbenv kbfixlist kbbuglist<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 8, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
