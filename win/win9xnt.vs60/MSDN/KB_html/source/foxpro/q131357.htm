

<HTML>
<HEAD>
<TITLE>How to Reference Objects in the Container Hierarchy </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131357">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/06/08">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes how to reference objects and manipulate them in the container hierarchy. It shows how to use the generic object references (THIS, THISFORM, THISFORMSET, and Parent) in Visual FoxPro.  MORE INFORMATION  To manipulate an object...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAW6,QAPN,QAH4,QAUJ,QAG9,QAEY,QAB3,QAJQ,QA5D,QAMB,QACI,QAA2,QARM,QBWS,QAR7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Reference Objects in the Container Hierarchy</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131357</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to reference objects and manipulate them in the
container hierarchy. It shows how to use the generic object references
(THIS, THISFORM, THISFORMSET, and Parent) in Visual FoxPro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To manipulate an object, you must identify it in relation to the container
hierarchy. When referencing objects, you can use the names of the objects
to move through the container hierarchy. However, hard coding the names
does not allow the code to be reusable.
<P>
There are four keywords that make it easier to reference an object from
within the container hierarchy: THIS, THISFORM, THISFORMSET, and Parent.
Visual FoxPro compiles THIS, THISFORM, and THISFORMSET into tokens that
resolve to their actual object names at run time. By using these four
generic keywords, you ensure that the code is reusable.
<P>
<P><h3>THIS Keyword</h3>
 
<P>
The keyword THIS allows you to reference a class's property or method. If
there are multiple instances of an object, THIS always refers to the
instance in which the code is executing. THIS is a generic reference and
always refers to the correct object, thus making the code reusable.
<P>
For example, if you want the caption of a command button when clicked to
change to "OK," place the following code in the Click event of the command
button:
<P>
<PRE>   THIS.Caption="OK"

</PRE><h3>Sending Messages Without Naming the Container</h3>
 
<P>
In a method within a container, you can send a message to another object
without using the name of the container. In fact, it's better (more
generic) not to name it explicitly. There are two techniques for referring
to a contained object indirectly:

<UL><LI>Use the token THISFORM or THISFORMSET keyword.
<P>
   -or-

<LI>Use the Parent keyword.
<P>
</UL><h3>THISFORM Keyword</h3>
 
<P>
THISFORM is a generic object reference to the form in which the code is
executing. You can manipulate the form or any object on the form container
by using THISFORM.
<P>
For example, say you have a form named myform with two command buttons
named cmdBtn1 and cmdBtn2. You can manipulate the form and the cmdBtn2
button by clicking the cmdBtn1 button. In this example, to change the
background color of the form to red and the caption of cmdBtn2 to "Hello,"
place the following code in the Click event of the cmdBtn1 button:
<P>
<PRE>   THISFORM.BackColor = RGB(255,0,0)
   THISFORM.cmdBtn2.Caption = "Hello"

</PRE><h3>THISFORMSET Keyword</h3>
 
<P>
THISFORMSET is a generic object reference to the form set in which the code
is executing. You can manipulate the form set or any object in the form set
container by using THISFORMSET.
<P>
For example, say you have a form set named frsMyfrs with two forms named
frmMyfrm1 and frmMyfrm2. The frmMyfrm1 form contains a command button named
cmdBtn1, and the frmMyfrm2 form contains a label named lblMylb1. You can
change the background color of the label on frmMyfrm2 to blue when you
click cmdBtn1 in frmMyfrm1 by placing the following code in the Click event
of the cmdBtn1 button.
<P>
<PRE>   THISFORMSET.frmMyfrm2.lblMylb1.BackColor = RGB(0,0,255)

</PRE><h3>Parent Keyword</h3>
 
<P>
Parent is a generic keyword that refers to the immediate container of the
object. It is another way to reference objects without hard-coding their
names. By evaluating the expression THIS.PARENT, you get the name of the
container. These can be chained together, as in THIS.PARENT.PARENT. The
only disadvantage of PARENT is that you need to know how many levels of
containers to point through to get the name of the one that contains your
target object.
<P>
For example, say you have a form with a page frame named pgfPgframe1 that
has two pages named pagPage1 and pagPage2 on it. The pagPage1 page has a
grid named grdMygrid1 and a command button named cmdCommand1 on it. To
change the background color of the grid to blue when you click the
cmdCommand1 button, you could place the following code in the cmdCommand1
button's Click event:
<P>
<PRE>   THISFORMSET.pgfPgframe1.pagPage1.grdMygrid1.BackColor = RGB(0,0,255)

</PRE>But this hard-codes the names of many objects, so the code is less
reusable. You can use the Parent keyword to refer to the container of an
object. Because cmdCommand1 and grdMygrid1 are both in the same container,
OR have the same Parent (pagPage1), you can use the Parent keyword.
Therefore, you can accomplish the same result by placing the following code
in the cmdCommand1 button's Click event:
<P>
<PRE>   THIS.Parent.grdMygrid1.BackColor = RGB(0,0,255)

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft Visual FoxPro Developer's Guide, Chapter 3.
<P>
FoxPro Advisor June 1995 issue, "I hear a Symphony," by Alan Schwartz.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgClassoop<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
