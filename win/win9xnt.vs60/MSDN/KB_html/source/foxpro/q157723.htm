

<HTML>
<HEAD>
<TITLE>How To Extend the Visual FoxPro Solutions Sample </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157723">
<META NAME="KBModify" CONTENT="1998/02/19">
<META NAME="KBCreate" CONTENT="1996/10/17">
<META NAME="Keywords" CONTENT="FxprintFont kbhowto kbprg kbprint kbusage">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Visual FoxPro Solutions sample can easily be extended by adding new components. This article describes the steps required to add a new form, query, view, or report to the Solutions sample.  MORE INFORMATION  Adding a New Component to Solution.d...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBB1,QA7O,QAPF,QA7N,QAJG,QDI1,QAZZ,QAPN,QBCF,QA5V,QBXS,QABI,QADZ,QAE1,QBXN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Extend the Visual FoxPro Solutions Sample</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157723</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00
WINDOWS
kbusage kbprg kbprint kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Visual FoxPro Solutions sample can easily be extended by adding new
components. This article describes the steps required to add a new form,
query, view, or report to the Solutions sample.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Adding a New Component to Solution.dbf</h3>
 
<P>
To add a new component to the Solutions sample, add a new record to
Solution.dbf and fill in the following fields.
<P>
The Key Field:
<P>
The Key field must be unique, and it must be a number followed by an
underscore, 205_ for example. The Key field is used to populate the
treeview control (oleTree) in Solution.scx.
<P>
The Parent Field:
<P>
The Parent field must match the Key value of the record for the parent node
of the sample in the treeview. For example, if you want to add a new
component to be displayed under "ActiveX\ActiveX Controls" in the
Solution.scx treeview, replace the Parent field with 101_. A Parent of 0_
indicates that the item is added to the root level of the treeview control.
<P>
The Text Field:
<P>
The text you enter in the Text field is displayed in the treeview control
and the filtered list view in Solution.scx.
<P>
The Image Field:
<P>
The Image field specifies the picture to be displayed beside the component
in the treeview. If you are adding a component to be run, set the picture
to "dot."
<P>
To see all the images, right-click oleImages in Solution.scx and choose
ImageList Control Properties.
<P>
The File Field:
<P>
The File field contains the name of the new sample file.
<P>
The Type Field:
<P>
Fill in the Type field as follows:
<P>
<PRE>   N -- Not a sample
   F -- Form
   V -- View
   Q -- Query
   R -- Report

</PRE>The Path Field:
<P>
The path of the new sample file, relative to the directory that
Solution.scx is located in.
<P>
The Descript Field:
<P>
The Descript field contains the description that is displayed in
Solution.scx when the sample is selected in the treeview or in the list
box.
<P>
The Method Field (for forms only):
<P>
If you want a form to be opened in design mode with a particular method
opened by default, specify the method in the Method field.
<P>
<P><h3>Customizing a Form for the Solutions Sample</h3>
 
<P>
Queries, reports, and views don't need any special coding to be good
Solution application citizens, but forms do need a little customization.

<OL><P><LI>Add the c_solutions class from VFP\SAMPLES\SOLUTION\SOLUTION.VCX to
   your form. Keep the default name of c_solutions1.

<P><LI>Add the following lines to the Activate event of the form:
<P>
<PRE>        IF TYPE('THIS.c_solutions1') = "O"
      THISFORM.c_solutions1.SaveHelp
        ENDIF

</PRE><P><LI>Add the following lines to the Deactivate event of the form:
<P>
<PRE>        IF TYPE('THIS.c_solutions1') = "O"
      THIS.c_solutions1.RestoreHelp
        ENDIF

</PRE><P><LI>Add the behindscenes class from Vfp\Samples\Solution\Solution.vcx to
   your form, and make sure the HelpContextID of the form is set to 0,
   the default. This opens the solutions overview topic when a user
   chooses the Behind the Scenes button or presses F1.
<P>
</OL>If you want to provide a Help topic for your component, you need to make a
change to c_solution and make sure that the user gets the updated copy. The
cHelpFile property of c_solution is protected, but it should not be. When
you create a help file for your new component, set the cHelpFile property
of c_solutions1 to the name of your help file.
<P>
<P><h3>Adding a New Component to the Filtered List View</h3>
 
<P>
The filtered list isn't a filtered list at all: the list displays one side
of a many-to-many relationship. Each Solutions component can be listed
under multiple "filters" and each "filter" can contain many components. The
tables involved in the relationship are as follows:
<P>
<PRE>   Solution.dbf--The list of components
   Reftext.dbf--The list of "filters" and an ID
   Xref.dbf--A juncture table between Solution and Reftext

</PRE></OL>If your new component belongs under one or more of the existing filters,
add records to Xref.dbf with the ID of the filter in Reftext.dbf and the
Key value for your component from Solution.dbf. If you want to add another
filter, add the new filter to Reftext.dbf.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For a sample form that can be used to facilitate the adding of new
components and filters to the sample, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q158051.htm">Q158051</A></B>
   TITLE     : SAMPLE: Solution.exe Extends the Visual FoxPro Solutions
               Sample


</PRE>Extract the form Filtrlst.scx from Solution.exe. For best results, these
files Filtrlst.scx and Filtrlst.sct should be placed in the
Vfp\Samples\Solution directory. The form itself contains instructions about
its use.
<P>
All components in Solution.dbf are listed when the filter is set to "All,"
whether you have added your component to other filters or not.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbprg kbprint kbhowto<BR>
KBSubcategory: FxprintFont<BR>
Additional reference words: kbdse 5.00 vFoxWin example sample<BR>
Keywords          : FxprintFont kbhowto kbprg kbprint kbusage<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
