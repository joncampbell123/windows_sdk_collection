

<HTML>
<HEAD>
<TITLE>FIX: Unhandled Exception Win32S Error on Visual FoxPro Startup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134394">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/08/07">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b fixlist5.00 FxenvGeneral vfoxwin kbbuglist kbenv kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  On startup, Visual FoxPro returns the following error message and crashes:     Win32s Error. VFP.EXE Unhandled Exception Detected.    (Code: 0xC0000005 w32scomb.dll:10660)    Application Will Be Terminated.  CAUSE =====  The ANSICP setting in the W...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWP,QAAQ,QDL9,QBWQ,QBWO,QBWN,QA56,QA55,QAB4,QAH4,QAR4,QDO9,QDIV,QAM1,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Unhandled Exception Win32S Error on Visual FoxPro Startup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134394</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbenv kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
On startup, Visual FoxPro returns the following error message and crashes:
<P>
<PRE>   Win32s Error. VFP.EXE Unhandled Exception Detected.
   (Code: 0xC0000005 w32scomb.dll:10660)
   Application Will Be Terminated.

</PRE><h2>CAUSE</h2>
 
<P>
The ANSICP setting in the WIN32S.INI file is not a supported code page.
<P>
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Change the ANSICP in the WIN32S.INI file to a supported code page.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following are valid code pages for Visual FoxPro version 3.0:
<P>
<PRE>Code page   identifier   Platform
</PRE> 
<PRE>437         x01          U.S. MS-DOS
620  (1)    x69          Mazovia (Polish) MS-DOS
737  (1)    x6A          Greek MS-DOS (437G)
850         x02          International MS-DOS
852         x64          Eastern European MS-DOS
861         x67          Icelandic MS-DOS
865         x66          Nordic MS-DOS
866         x65          Russian MS-DOS
895   (1)   x68          Kamenicky (Czech) MS-DOS
857         x6B          Turkish MS-DOS
1250        xC8          Eastern European Windows
1251        xC9          Russian Windows
1252        x03          Windows ANSI
1253        xCB          Greek Windows
1254        xCA          Turkish Windows
10000       x04          Standard Macintosh
10006       x98          Greek Macintosh
10007 (1)   x96          Russian Macintosh
10029       x97          Macintosh EE

</PRE><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Edit the WIN32S.INI file, changing the AnsiCP setting to an invalid code
   page. For example, change the line:
<P>
<P><PRE>      AnsiCP=1252
</PRE><P>
   to this line:
<P>
<P><PRE>      AnsiCP=544
</PRE>
<P><LI>Save the file

<P><LI>Quit and restart Windows version 3.11.

<P><LI>Start Visual FoxPro.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv kbbuglist kbfixlist<BR>
KBSubcategory: FxenvGeneral buglist3.00 buglist3.00b VFoxWin fixlist5.00<BR>
Additional reference words: 3.00 3.00b<BR>
Keywords          : buglist3.00 buglist3.00b fixlist5.00 FxenvGeneral vfoxwin kbbuglist kbenv kbfixlist<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
