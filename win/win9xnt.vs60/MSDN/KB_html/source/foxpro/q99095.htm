

<HTML>
<HEAD>
<TITLE>How to Reset a Database Field to a Null Value in FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99095 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/05/23">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a new database record is created in FoxPro, all database fields are set to a null value. You can test this by using the EMPTY() function on each field in a newly created record:     USE customer    APPEND BLANK    ? EMPTY(cno)     * Returns .T...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAI4,QAKD,QAEF,QAUD,QAGB,QBXS,QDIJ,QAMV,QBV8,QAB9,QAY5,QA5V,QAZV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Reset a Database Field to a Null Value in FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99095 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, 2.5b, and 2.6
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, and 2.6
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a new database record is created in FoxPro, all database fields are
set to a null value. You can test this by using the EMPTY() function on
each field in a newly created record:
<P>
<PRE>   USE customer
   APPEND BLANK
   ? EMPTY(cno)     &amp; Returns .T.
   ? EMPTY(zip)     &amp; Returns .T.

</PRE>The EMPTY() function is available in FoxPro versions 2.0 and later. The
ISBLANK() function is available in FoxPro version 2.6. There is an
important difference between the EMPTY() and ISBLANK() functions on logical
and numeric fields. EMPTY() will return .T. if the field is blank, or if it
contains the default values of zero for a numeric field or .F. for a
logical field. ISBLANK() will return .T. if the numeric or logical field
contains a null value and .F. if the field contains the default value.
<P>
Sometimes you may want to reset a field to a null value after data has been
entered in the field. For example, in a statistical program, you may want
to edit a numeric score field so that it contains a null value for no
answer and an answer of zero where the score was zero. See below for
information on how to reset the various field types to null.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>FoxPro Versions 2.0 and 2.5x</h3>
 
<P>
Character or Memo Fields:
<P>
To reset a character or memo field to a null value, replace the field with
the null text string "":
<P>
<PRE>   REPLACE fieldname WITH ""

</PRE>Date Fields:
<P>
To reset a date field to a null value, replace the date field with the null
date string { / / }:
<P>
<PRE>   REPLACE fieldname WITH {  /  /  }

</PRE>Numeric Fields:
<P>
A numeric field cannot be reset to a null value because the EMPTY()
function returns .T. if a numeric field is blank or zero. To illustrate
this behavior, issue the following command on an existing record when you
are using a database that has date, numeric, and character fields:
<P>
<PRE>   SCATTER MEMVAR BLANK
   GATHER MEMVAR FIELDS
   ? EMPTY(numericfield)
   BROWSE

</PRE>Note that the date and character fields have been blanked out. The numeric
field contains a zero (0).
<P>
To work around this limitation, do the following for numeric fields:

<OL><P><LI>For each numeric field in the database, create a corresponding logical
   field.

<P><LI>Code the following logic into data entry/editing routines:
<P>
   If the numeric field contains 0 as data, set the logical field to
   .T. If the numeric field is to contain no value, set the logical
   field to .F.

<P><LI>Use the logical field as a flag in FOR clauses for subsequent
   operations, as follows
<P>
<P><PRE>      AVERAGE response TO memvar FOR notempty
</PRE><P>
   where "response" is the numeric field and "notempty" is the
   corresponding logical field.
<P>
</OL>Logical Fields:
<P>
Logical fields also cannot be reset to null, since both a blank and a .F.
logical field will result in EMPTY(&lt;logicalfield&gt;) returning a value of .T.
<P>
The technique used above for numeric fields can also be used for logical
fields. When using this technique for logical fields, create a character
field with a length of 1. This character field should contain T for true, F
for False, or a space for empty.
<P>
NOTE: A character field containing only spaces will always return .T. for
the EMPTY() function.
<P>
General Fields:
<P>
The contents of a general field can be deleted by issuing the command:
<P>
<PRE>   APPEND GENERAL &lt;generalfield&gt;

</PRE></OL><h3>FoxPro Version 2.6</h3>
 
<P>
A new command, BLANK, has been added in version 2.6. The BLANK command
allows a field or fields to be reset to a true null or empty value.

<OL><P><LI>To blank an entire record, issue the following command:
<P>
<P><PRE>      BLANK
</PRE>
<P><LI>To blank selected fields, issue the following command:
<P>
<P><PRE>      BLANK FIELDS &lt;field1&gt;, &lt;field2&gt;
</PRE><P>
</OL>If you want, you can add a SCOPE clause to the BLANK command. The BLANK
command will reset any field type to a true empty value. The BLANK command
will automatically lock the current record if no SCOPE clause is issued or
the entire database if a SCOPE clause is used.
<P>
<P><h3>Visual FoxPro 3.0</h3>
 
<P>
A .NULL value is available in Visual FoxPro. To set fields to null, replace
the fields with .NULL.. To search for null values in fields use the
ISNULL() function.
<P>
For more information, see the FoxPro 2.0 "Commands &amp; Functions" manual or
the FoxPro 2.5 "Language Reference" manual. For information about the
ISBLANK() function and the BLANK command, refer to the FoxPro version 2.6
Help file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxMac FoxDos FoxWin 2.00 2.50<BR>
2.50a 2.50b 2.60<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
