

<HTML>
<HEAD>
<TITLE>PRB: CLEAR RESOURCE Does Not Appear to Work </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155388">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/08/28">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The CLEAR RESOURCES command--a new command for Visual FoxPro 5.0--does not appear to work. When Visual FoxPro displays a bitmap, picture, cursor, icon, or font resource, Visual FoxPro caches the resource to optimize performance. If you use a resour...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QAJX,QADR,QAIM,QAXB,QAUJ,QAJQ,QBVV,QA56,QA55,QAC1,QBD2,QAPN,QAH4,QAB2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: CLEAR RESOURCE Does Not Appear to Work</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155388</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The CLEAR RESOURCES command--a new command for Visual FoxPro 5.0--does not
appear to work. When Visual FoxPro displays a bitmap, picture, cursor,
icon, or font resource, Visual FoxPro caches the resource to optimize
performance. If you use a resource of the same name (for example, a
different bitmap with the same name as the one already cached), Visual
FoxPro does not reload the resource.
<P>
Therefore, clearing a resource file is useful for removing a graphic image
from memory and forcing Visual FoxPro to reload an image of the same name
from disk. For example, a report might display graphic images from a
database, all of which are named TEMP; however, because they all have the
same name, Visual FoxPro does not reload each new graphic unless the
existing one has been cleared from memory using the CLEAR RESOURCES
command.
<P>
<P><h2>CAUSE</h2>
 
<P>
This scenario occurs when a resource is in use when you issue the CLEAR
RESOURCES command.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The CLEAR RESOURCES command acts only on resources that are not currently
in
use. In the following example, the "Toggle bitmap" button attempts to clear
a resource that is in use. The click code for the "Update form" button
saves the current value of the picture property, sets the picture property
to "", clears the resource (which is no longer in use), and resets the
picture property back to its original value. Note that the specific
resource is cleared by name. Any remaining resources are not cleared. The
resources must be cleared because of caching for performance reasons. You
want to clear only the resource you want to update so that any others will
still be in the cache.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. CLEAR RESOURCES acts only on resources not
currently in use.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Run the following code from a .prg:
<P>
<P><PRE>      PUBLIC oform
      oform=CREATEOBJECT('form1')
      oform.Show
</PRE><P>
<P><PRE>      DEFINE Class form1 AS Form
<PRE></PRE>        Top = 0
        Left = 0
        Height = 234
        Width = 207
        DoCreate = .T.
        Caption = "Clear Resource Demo"
        Name = "form1"
        changedbmp = .F.
        ADD OBJECT image1 AS Image WITH ;
          Stretch = 2, ;
          Height = 120, ;
          Left = 36, ;
          Top = 12, ;
          Width = 144, ;
          Name = "Image1"
        ADD OBJECT command1 AS CommandButton WITH ;
          Top = 156, ;
          Left = 60, ;
          Height = 27, ;
          Width = 96, ;
          Caption = "\&lt;Toggle bitmap", ;
          Default = .T., ;
          Name = "Command1"
       ADD OBJECT command2 AS CommandButton WITH ;
          Top = 192, ;
          Left = 67, ;
          Height = 27, ;
          Width = 84, ;
          Caption = "\&lt;Update form", ;
          Name = "Command2"

        PROCEDURE image1.Init
          Clear RESOURCES
          COPY FILE home()+'wizards\wizbmps\wzclose.bmp' TO 'bmptemp.bmp'
          THIS.Picture='bmptemp.bmp'
        ENDPROC

        PROCEDURE command1.Click
          IF THISFORM.changedbmp=.F.
            THISFORM.changedbmp=.T.
            COPY FILE home()+'wizards\wizbmps\wzedit.bmp' TO 'bmptemp.bmp'
          ELSE
            THISFORM.changedbmp=.F.
            COPY FILE home()+'wizards\wizbmps\wzclose.bmp' TO 'bmptemp.bmp'
          ENDIF
          CLEAR RESOURCES
          THISFORM.REFRESH
        ENDPROC

        PROCEDURE command2.Click
          LOCAL lcPictemp
          lcPictemp=thisform.image1.Picture
          THISFORM.image1.Picture=''
          CLEAR RESOURCES (lcPictemp)
          THISFORM.image1.Picture=lcPictemp
        ENDPROC
</PRE></OL>ENDDEFINE

<OL><P><LI>Press the "Toggle bitmap" button. Note how the button does not update
   the image even though it contains a CLEAR RESOURCES command in its click
   code.

<P><LI>Press the "Update form" button. Now the image is updated.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual FoxPro Help file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory: FxprgGeneral<BR>
Additional reference words: 5.00 kbdse Vfoxwin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
