

<HTML>
<HEAD>
<TITLE>How to Use DBC Field Captions on Visual FoxPro Forms &amp; Reports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137626">
<META NAME="KBModify" CONTENT="1995/10/05">
<META NAME="KBCreate" CONTENT="1995/10/02">
<META NAME="Keywords" CONTENT="kbprg kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Database Container allows you to enter captions for the fields of a table. However, there is no FieldCaption control that you can place on a form to display a field's caption or to automatically update a field's label on the form should you cho...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QA7O,QA7N,QAC2,QBT6,QBV4,QAPN,QAHP,QAH4,QBXS,QARR,QAZV,QACI,QAVS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use DBC Field Captions on Visual FoxPro Forms &amp; Reports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137626</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Database Container allows you to enter captions for the fields of a
table. However, there is no FieldCaption control that you can place on a
form to display a field's caption or to automatically update a field's
label on the form should you choose to change the field's caption in the
database header. The examples in this article show you how to use DBGETPROP
to create a link between field labels on a form and the field captions in
the database so that changes propagate.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example One: Setting the Label for a Standard Text Box Field</h3>
 

<OL><P><LI>Create a database that contains a table.

<P><LI>Add a caption to one or more of the table's fields.

<P><LI>Create a new form. Place a label and a text box on it.

<P><LI>Add the table to the data environment of the form, and set the
   ControlSource property of the text box to a field that has a caption.

<P><LI>Add the following code to the Load event of the form:
<P>
   OPEN DATABASE &lt;&lt;insert databasename here&gt;&gt;

<P><LI>Add the following code to the Init event of the Label object:
<P>
   WITH This
<P><PRE>      .Caption = ;
<PRE></PRE>          DBGETPROP( .Parent.Text1.ControlSource, ;
          "FIELD", "CAPTION" )
   ENDWITH

</PRE><P><LI>Save and run the form. Note that the caption you assigned to the field
   is displayed by the label control.
<P>
</OL><h3>Example Two: Setting Headings of a Grid</h3>
 
<P>
Normally, a grid with a ColumnCount of -1 will use the Caption property to
detrmine the headings used for columns. However, if you specify the number
of columns, the headings are determined by the Caption of the header
object, not by the Caption property of the ControlSource field. The
following code placed in a grid's Init event will set the grid headings
when an instance of the grid is created:
<P>
<PRE>   LOCAL iLoop, iMax, cSource

   SET DATABASE TO &lt;&lt;insert databasename here&gt;&gt;

   WITH This
      &amp;&amp; Determine Number of Columns in Grid
      iMax = .ColumnCount

      &amp;&amp; Get the Table Name used by the Grid
      &amp;&amp; This is necessary because unlike a text box control,
      &amp;&amp; the ControlSource property of a column does not preface
      &amp;&amp; the field name with the table name, so the code must
      &amp;&amp; do this manually. Note that "." is included.
      cSource = .RecordSource + "."

      &amp;&amp; Loop through each column
      FOR iLoop = 1 TO iMax
         WITH .Columns(iLoop)

            &amp;&amp; Set Header Caption
            .Header1.Caption = ;
               DBGETPROP( cSource + .ControlSource, ;
               "FIELD", "CAPTION" )
         ENDWITH
      NEXT iLoop
   ENDWITH

</PRE></OL><h3>Example Three: Using Captions in Report Headers</h3>
 
<P>
To use field captions in reports, create a field (not a text label) whose
expression is DBGETPROP("tablename.fieldname","FIELD","CAPTION").
<P>
NOTE: Here tablename.fieldname is the actual name of the table and field.
<P>
When the report runs, the expression will evaluate to the proper caption.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the Visual FoxPro Help file, the
Developer's Guide, and the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q130997.htm">Q130997</A></B>
   TITLE     : How to Use the Caption Fields of a Table in a Form
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbcode kbhowto<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 5, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
