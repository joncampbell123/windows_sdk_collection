

<HTML>
<HEAD>
<TITLE>How to Add a New Value to a List of Values in a Combo Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139769">
<META NAME="KBModify" CONTENT="1995/11/17">
<META NAME="KBCreate" CONTENT="1995/11/15">
<META NAME="Keywords" CONTENT="kbpg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The RowSourceType property of a combo box can be set to Value, and a list of values can be specified for the row source. This article illustrates how you can input a value that is not in the list.  MORE INFORMATION  If the ControlSource property fo...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QAKD,QAH4,QACI,QAPN,QA7O,QA7N,QA5V,QAE1,QAKC,QBVV,QA9N,QAY4,QABL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Add a New Value to a List of Values in a Combo Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139769</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The RowSourceType property of a combo box can be set to Value, and a list
of values can be specified for the row source. This article illustrates how
you can input a value that is not in the list.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the ControlSource property for the combo box is set to a field in the
underlying table, the value chosen from the combo box will be written to
that field when the record is saved. But if the value to be stored is not
in the list assigned to the row source, the value is not written to the
field.
<P>
To store that non-list value to the field, you need a way to:

<OL><P><LI>Store the value, which by default is not stored.

<P><LI>Update or refresh the list in the combo box so that if a non-list value
   is stored to the table, that value reappears in the list for that record
   and only that record.
<P>
</OL><h3>Step-by-Step Example</h3>
 
<P>
The following steps illustrate how to input a value that is not in the list
of values for a combo box:

<OL><P><LI>Create a table called Test that has a single character field that is
   also called Test by entering the following code in a program file and
   then running the program. (Make sure you don't already have a table
   named Test in your current directory:
<P>
   CREATE TABLE test (test c(10))
   INSERT INTO test (test) VALUES("pigs")
   INSERT INTO test (test) VALUES("sheep")
   INSERT INTO test (test) VALUES("hippos")
   INSERT INTO test (test) VALUES("pigs")
   INSERT INTO test (test) VALUES("sheep")
   INSERT INTO test (test) VALUES("hippos")

<P><LI>Create a new form (Form1), and add a combo box (Combo1) to it.

<P><LI>Add the Test table to the form's data environment.

<P><LI>Set the RowSourceType property of the combo box to 1-Value.

<P><LI>Enter the following for the RowSource property of the combo box:
<P>
   pigs,sheep,hippos

<P><LI>Set the ControlSource property of the combo box to a field in your
   table. This example assumes that the field is called Test, so the entry
   would be:
<P>
   Test.Test

<P><LI>Add a property to the form and name it cdspval. This property will be
   used to keep track of the current DisplayValue of the Combo Box.

<P><LI>Place the following code in the Combo1 Valid event:
<P>
   * This code writes the user's value to the test.test field
   * if the value does not appear in the list:
   if !empty(this.displayvalue)
<P><PRE>      if upper(this.displayvalue. != 'PIGS' and;
<PRE></PRE>         upper(this.displayvalue. != 'SHEEP' and;
         upper(this.displayvalue. != 'HIPPOS'
            replace test.test with this.displayvalue
            thisform.combo1.additem(alltrim(test.test))
      endif
   else
      replace test.test with thisform.cdspval
   endif
   thisform.cdspval=""
   thisform.refresh

</PRE><P><LI>Place the following code in the Combo1 GotFocus event:
<P>
   thisform.cdspval=this.displayvalue
   thisform.combo1.rowsource = 'pigs,sheep,hippos'
   if alltrim(upper(test.test))!="PIGS" and;
<P><PRE>      alltrim(upper(test.test))!="SHEEP" and;
      alltrim(upper(test.test))!="HIPPOS"
<PRE></PRE>         if !empty(test.test)
            thisform.combo1.additem(alltrim(test.test))
         endif
   endif

</PRE><P><LI>Place the following code in the Combo1 LostFocus event:
<P>
   * This code returns the combo1.rowsource list to its original value
   * before another object gains the focus
   this.rowsource = 'pigs,sheep,hippos'

<P><LI>Place the following code in the Combo1 Refresh event:
<P>
   Form1.Refresh
   thisform.combo1.gotfocus()
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbcode kbhowto<BR>
KBSubcategory: FxotherGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
