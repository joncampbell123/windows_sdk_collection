

<HTML>
<HEAD>
<TITLE>FIX: Click Event of a List Box Fires Twice </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156549">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1996/09/25">
<META NAME="Keywords" CONTENT="kbprg kbfixlist kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In Visual FoxPro 3.0 and 3.0b for Windows, when you click on an item in a list box, the Click event fires and runs the code in the Click event. If the item in the List box is already highlighted and the item is clicked again, the code in the Click ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAPN,QAO4,QBWS,QAH4,QAR4,QA33,QAE1,QDL9,QBWQ,QBWO,QBWN,QBER,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Click Event of a List Box Fires Twice</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156549</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Visual FoxPro 3.0 and 3.0b for Windows, when you click on an item in a
list box, the Click event fires and runs the code in the Click event. If
the item in the List box is already highlighted and the item is clicked
again, the code in the Click event runs twice.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If the desired effect is to click on an item and have the Click event fire
once and not fire again until another item is chosen, create a form as
follows:

<OL><P><LI>Create a form and place a list box on it.

<P><LI>While the list box is highlighted, set the RowSourceType property to
   Value in the Properties box.

<P><LI>In the RowSource property, type the following values:
<P>
<P><PRE>      AAA, BBB, CCC, DDD
</PRE>
<P><LI>In the Click event of the list box, type the following code:
<P>
<P><PRE>      WAIT WINDOW "List box, Click event"
</PRE><P>
   NOTE: If you run the form at this point, the problem described above
   occurs.

<P><LI>Modify the form and create a custom property for the form by clicking
   New Property on the Form menu. In the New Property  box type "OneClick"
   (without the quotes).

<P><LI>In the Init event of the form, type "ThisForm.OneClick = "X" (without
<P><PRE>    the quotes).
</PRE>
<P><LI>In the Click event of the list box change the current code with the
   following:
<P>
<P><PRE>      IF This.DisplayValue != ThisForm.OneClick
<PRE></PRE>         WAIT WINDOW "List box, Click event"
         ThisForm.OneClick = This.DisplayValue
      ENDIF

   If an item is selected and the Click event needs to be fired regardless
   of it being previously highlighted, then the code is going to be fired
   twice. There is no workaround for this case.

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro version 5.0 for Windows.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbfixlist kberrmsg<BR>
KBSubcategory: FxtoolFormdes VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b 5.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
