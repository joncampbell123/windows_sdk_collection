

<HTML>
<HEAD>
<TITLE>How to Remove Blank Lines in FoxPro Labels and Reports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87851 ">
<META NAME="KBModify" CONTENT="1995/04/17">
<META NAME="KBCreate" CONTENT="1992/08/09">
<META NAME="Keywords" CONTENT="kbprint kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Blank lines can appear in your labels and reports if an expression in the definition evaluates to null. Below is an example that demonstrates how to remove these blank lines.  MORE INFORMATION  A common example is the presence in a database of two ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QBXT,QA5V,QAIB,QAC2,QAMB,QA7O,QA7N,QAB9,QAWI,QAI4,QA9N,QANJ,QACI,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Remove Blank Lines in FoxPro Labels and Reports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87851 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Blank lines can appear in your labels and reports if an expression in
the definition evaluates to null. Below is an example that
demonstrates how to remove these blank lines.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A common example is the presence in a database of two address fields,
ADDRESS1 and ADDRESS2, where ADDRESS2 is sometimes empty.
<P>
Sample label definition:
<P>
<PRE>   COMPANY
   ADDRESS1
   ADDRESS2;
   TRIM(CITY) + ", " + STATE + " " + LTRIM(ZIP)

</PRE>To prevent blank lines from printing in your labels if certain
customers don't have ADDRESS2 fields, place a semicolon after ADDRESS2
in the label definition. If ADDRESS2 (or any other expression followed
by a semicolon) evaluates to null, that line is removed from the label
and the remaining lines are moved up.
<P>
NOTE: Placing a comma between fields in a label expression
automatically trims the preceding field and places a single space
between it and the following field.
<P>
<P><h3>Removing Blank Lines and Empty Fields in Reports</h3>
 
<P>
Blank lines can appear in your reports if an expression in the
definition evaluates to null.
<P>
A common example is the presence in a database of two address fields,
ADDRESS1 and ADDRESS2, where ADDRESS1 always contains data and
ADDRESS2 is sometimes empty.
<P>
Sample report definition to remove blanks if ADDRESS2 is empty (detail
bands):
<P>
<PRE>   Detail |  COMPANY
   Detail |  ADDRESS1 + ";" + ALLTRIM(ADDRESS2)
   Detail |  TRIM(CITY) + ", " + STATE + " " + LTRIM(ZIP)
   Detail |  MDY(DATE())
   Detail |

</PRE>To prevent blank lines from printing in your report if certain
customers don't have ADDRESS2 fields:

<OL><P><LI>Create the following expression:
<P>
<P><PRE>      ADDRESS1 + ";" + ALLTRIM(ADDRESS2)
</PRE><P>
   a. Type "@;" (without the quotation marks) in the Format box in the
<P><PRE>      Report Expression dialog box to interpret the semicolon (;) and
      force a linefeed between ADDRESS1 and ADDRESS2.
</PRE><P>
   b. Use the ALLTRIM() function on ADDRESS2 to prevent blanks from
<P><PRE>      appearing if ADDRESS2 contains only spaces.
</PRE>
<P><LI>If you want any expressions on following lines (for example, CITY
   and DATE) to move up if ADDRESS2 is null, select the Float As Band
   Stretches check box in the Report Expression dialog box for these
   expressions. If ADDRESS2 evaluates to null, that line is removed
   from the report and the following lines are moved up.
<P>
   NOTE: If you want the full year to display for the MDY(DATE())
   expression, be sure to use SET CENTURY ON.
<P>
<P>
</OL>Occasionally, you may have a situation where ADDRESS1 or ADDRESS2 may
be empty. In a case like this, you must set up your report definition
as follows.
<P>
Listed below is a sample report definition to remove blanks if
ADDRESS1 or ADDRESS2 is empty (detail bands):
<P>
<PRE>   Detail |  COMPANY + ALLTRIM(ADDRESS1) + ";" + ALLTRIM(ADDRESS2)
   Detail |  TRIM(CITY) + ", " + STATE + " " + LTRIM(ZIP)
   Detail |  MDY(DATE())
   Detail |

</PRE></OL>To prevent a blank line from printing in your report if certain
customers don't have an ADDRESS1 or an ADDRESS2 field:

<OL><P><LI>Create an expression like the following:
<P>
<P><PRE>      COMPANY + ALLTRIM(ADDRESS1) + ";" + ALLTRIM(ADDRESS2).
</PRE><P>
   a. In the Width box of the Report Expression dialog box, type the
<P><PRE>      width of the COMPANY field. This is used instead of a semicolon
      (;) for the following reasons: If there IS an ADDRESS1 field, it
      appears on the next line because you allowed room only for
      COMPANY on the first line. If there is NOT an ADDRESS1 field, no
      blank line appears because you did not force a linefeed with the
      semicolon.
</PRE><P>
<P><PRE>      NOTE: The ALLTRIM() function is used on each address to
      prevent blanks when the address fields contain only spaces.
</PRE><P>
   b. Type "@;" (without the quotation marks) in the Format box in the
<P><PRE>      Report Expression dialog box to interpret the semicolon (;) and
      force a linefeed between ADDRESS1 and ADDRESS2.
</PRE>
<P><LI>If you want any expressions on following lines (for example, CITY
   and DATE) to move up if ADDRESS2 is null, select the Float As Band
   Stretches check box in the Report Expression dialog box for these
   expressions. If ADDRESS2 evaluates to null, that line is removed
   from the report and the following lines are moved up.
<P>
   NOTE: If you want the full year to display for the MDY(DATE())
   expression, be sure to use SET CENTURY ON.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 2.50a suppress<BR>
KBCategory: kbprint kbprg<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
