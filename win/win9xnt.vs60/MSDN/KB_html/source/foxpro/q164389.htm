

<HTML>
<HEAD>
<TITLE>FIX: ODBC Files Get Copied to Distribution Disks in VFP 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164389">
<META NAME="KBModify" CONTENT="1997/02/28">
<META NAME="KBCreate" CONTENT="1997/02/28">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b FxsetupGeneral FxtoolWizother kbbuglist kbfixlist kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When leaving the ODBC Drivers check box blank in step 2 of the Setup Wizard in Visual FoxPro 3.0, the desired effect is to avoid having the ODBC files copied to the disk images. The problem is that some of the ODBC files get copied to the disk imag...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QATJ,QBXB,QA9E,QAEF,QAFI,QABI,QABH,QA9N,QA56,QA55,QA5V,QASB,QAGB,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: ODBC Files Get Copied to Distribution Disks in VFP 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164389</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbtool kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When leaving the ODBC Drivers check box blank in step 2 of the Setup Wizard
in Visual FoxPro 3.0, the desired effect is to avoid having the ODBC files
copied to the disk images. The problem is that some of the ODBC files get
copied to the disk images even if the ODBC check box is clear.
<P>
There are at least seven files that get copied onto the disk images. They
are listed below:

<UL><LI>Odbccp32.dl_
<LI>Odbcinst.dl_
<LI>Odbcint.dl_
<LI>Odbckey.dl_
<LI>Odbcstf.dl_
<LI>Odbcstp.dl_
<LI>Odbcexec.ex_
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To ensure that these files do not get copied onto the disk images, complete
the following steps:

<OL><P><LI>Delete the Visual FoxPro \Distrib directory.

<P><LI>Open the Compress.dbf table in the Visual FoxPro \Distrib.src directory
   and make a backup of it.

<P><LI>Create an index on the DEST field. Locate Odbc.dl_ in the DEST field.
   Move the record pointer to that record.

<P><LI>Issue the following command in the Command window:
<P>
<P><PRE>      DELETE NEXT 52
</PRE><P>
   Browse the table to make sure that only names that start with OD in the
   DEST field are marked for deletion. There might be more than 52 records
   that start with OD. If so, mark them for deletion also.

<P><LI>Now that the ODBC files are marked for deletion in the Compress table,
   pack the table and close it.

<P><LI>Delete the Compress and Disk images directories under the destination
   directory if they have been created from an earlier session of the Setup
   Wizard. Also delete the Dkcontrl.dbf, Dkcontrl.cdx, and Wzsetup.ini
   files located in the directory where the source files are.

<P><LI>Run the Setup Wizard to rebuild the Visual FoxPro \Distrib directory and
   the Disk images directories. Note that opening up each of the disk
   images shows that there are no ODBC files now.

<P><LI>Open the Setup.st1 file in the DISK1 directory with Notepad and place a
   semicolon at the beginning of any line that represents an ODBC file. The
   semicolon acts as a remark statement allowing the setup routine to
   bypass that line. This step has to be repeated every time the Disk
   images are re-created.
<P>
</OL>To be able to change back to checking the ODBC drivers check box in the
Setup Wizard and loading the ODBC files into the Disk images directories,
replace the Compress.dbf file in the Visual FoxPro \Distrib.src directory
with the backup that was created and delete the Visual FoxPro \Distrib
directory. Running the Setup wizard re-creates the Distrib directory and
add the ODBC files to the Disk images.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was fixed in Visual
FoxPro 5.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create an .exe file and place it in a directory by itself.

<P><LI>Run the Setup Wizard on that directory and leave the ODBC drivers check
   box clear.

<P><LI>Open each of the Disk images directories and note that the ODBC files
   listed above are in the directories.

<P><LI>Perform the steps in the WORKAROUND section to remove the ODBC files
   from the disk images directories.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbbuglist kbfixlist<BR>
KBSubcategory: FxtoolWizother FxsetupGeneral buglist3.00 buglist3.00b<BR>
fixlist5.00 vfoxwin<BR>
Additional reference words: 3.00 3.00b<BR>
Keywords            : buglist3.00 buglist3.00b FxsetupGeneral FxtoolWizother kbbuglist kbfixlist kbtool<BR>
Version             : 3.00 3.00b<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
