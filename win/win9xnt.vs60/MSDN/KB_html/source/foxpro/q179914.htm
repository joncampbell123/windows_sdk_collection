

<HTML>
<HEAD>
<TITLE>BUG: Terminal Font at 6 Point Size in List Box Grows in Size </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179914">
<META NAME="KBModify" CONTENT="1998/01/27">
<META NAME="KBCreate" CONTENT="1998/01/26">
<META NAME="Keywords" CONTENT="FoxWin FxenvOs FxotherDisplay FxprgGeneral vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When an OEM Terminal font 6 point size is used as the screen font, large amounts of text displayed in a list box change to a larger font size when a system window such as Control Panel is opened on top of the FoxPro application window. The 6 point ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QADF,QBTX,QDL9,QBWQ,QBWO,QBWN,QDIR,QBWS,QBC9,QBC8,QANO,QAGQ,QAE1,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Terminal Font at 6 Point Size in List Box Grows in Size</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179914</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.6, 2.6a
<LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When an OEM Terminal font 6 point size is used as the screen font, large
amounts of text displayed in a list box change to a larger font size when a
system window such as Control Panel is opened on top of the FoxPro
application window. The 6 point font size returns when the system is
shutdown and restarted but the font size changes again as soon as a system
window is opened.
<P>
This behavior occurs when you are running FoxPro for Windows on a computer
with Windows 95. The problem does not occur in FoxPro under the Windows NT
operating system.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not use the Terminal font or any other screen font for text in a list
box. Either use a TrueType font or upgrade the operating system to Windows
NT.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
<P><h3>FoxPro for Windows versions 2.6, 2.6a</h3>
 

<OL><P><LI>Start FoxPro for Windows 2.6(a) under the Windows 95 operating system.

<P><LI>Use the Customer.dbf table in the FoxPro for Windows TUTORIAL
   subdirectory. The following command opens the table:
<P>
<P><PRE>      USE HOME()+"Tutorial\Customer"
</PRE>
<P><LI>Create a new screen.

<P><LI>Add a list box that covers the entire width and height of the new
   screen. In the List dialog box, set the List Items to be From Field.
   Click the field button to open the expression builder. Enter the
   following expression (or similar string to display a large amount of
   text):
<P>
<P><PRE>      company+contact+address+city+state+zip+phone+ono+cno
</PRE><P>
   For the variable for the list, type an x. Click OK to close the List
   dialog box.

<P><LI>With the list box selected, click the Font command from the Object menu.
   Select Terminal, regular 6, as the font for the list box.

<P><LI>Save the screen and name it Test.spr.

<P><LI>In the FoxPro Command window, type the following command:
<P>
<P><PRE>      DO Test.spr
</PRE><P>
   The list box should be displaying properly with the Terminal 6
   point font.

<P><LI>From the Windows 95 Start menu, select Settings and then click Control
   Panel.

<P><LI>Close Control Panel and activate FoxPro.

<P><LI>Click an item in the list box. The text changes to a larger, bold font.
   Click an item in the list box and drag the selection up and down the
   list box while the left mouse button is pressed. All the list box items
   change to a larger, bold font.
<P>
</OL>Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
 

<OL><P><LI>Start Visual FoxPro under the Windows 95 operating system.

<P><LI>Type the following code in the FoxPro Command window:
<P>
<P><PRE>      SET DEFAULT TO HOME()+"SAMPLES\DATA"
</PRE>
<P><LI>Create a new program with the following code:
<P>
<P><PRE>      USE customer SHARED
      DEFINE POPUP getpop ;
<PRE></PRE>         PROMPT FIELD cust_id+company ;
            + contact + address ;
            + city + region ;
            + postalcode + phone ;
            + country + cust_id ;
            SCROLL
      DEFINE WINDOW XXX FROM 1,1 TO 50,100
      ACTIVATE WINDOW XXX

      @ 11,10 GET popit PICTURE "@&amp;N" ;
         POPUP getpop SIZE 30.000,90.667 ;
         DEFAULT " " FONT "Terminal", 6 STYLE ""

      READ CYCLE
      CLEAR ALL
      *** end of program

</PRE><P><LI>Run the program. The items in the list box display with the correct font
   size.

<P><LI>From the Windows 95 Start menu, choose Settings, and then click Control
   Panel.

<P><LI>Close Control Panel and activate FoxPro.

<P><LI>Click an item in the list box. The text changes to a larger, bold font.
   Click an item in the list box and drag the selection up and down in the
   list box while the left mouse button is pressed. All the list items
   change to a larger, bold font.
<P>
</OL>NOTE: Duplication of any or all of the behavior described above is
unreliable and random. Since the OEM Terminal screen font does not reside
in the Windows 95 operating system but is a font that is subject to Windows
95 font substitution, the font may be rendered differently on different
computer hardware. Testing by Microsoft has produced three different
scenarios on three different computers without the identification of a
factor that would allow control of the scenario.
<P>
The three scenarios are:

<UL><LI>Cannot make the font size change occur under any circumstances.

<LI>The font size change happens before displaying the system window and
   never correctly displays the chosen font.

<LI>The font size change does or does not occur depending upon whether the
   system window is closed or minimized.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
Microsoft FoxPro for Windows Help, 2.6x Help; search on: "Fonts"; Topic:
"Interface Tips"
<P>
Microsoft Visual FoxPro for Windows Help; search on: "Fonts"; Topic:
"Overview"
<P>
(c) Microsoft Corporation 1998, All Rights Reserved. Contributions by Perry
Newton, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: raster<BR>
Keywords          : FoxWin FxenvOs FxotherDisplay FxprgGeneral vfoxwin<BR>
Version           : WINDOWS:2.6,2.6a,3.0,3.0b,5.0,5.0a<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
