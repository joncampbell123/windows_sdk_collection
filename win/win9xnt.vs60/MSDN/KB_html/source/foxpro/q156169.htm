

<HTML>
<HEAD>
<TITLE>How To Ignore Parameters in View or Query If Blank </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156169">
<META NAME="KBModify" CONTENT="1997/01/20">
<META NAME="KBCreate" CONTENT="1996/09/18">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes two examples on how to return records that meet a specific criteria and how to ignore the criteria if a parameter is empty or null.  MORE INFORMATION  Example 1: Parameter View with Values Passed from Controls on a Form ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGU,QAH4,QA5V,QAPF,QAUD,QAEF,QDMF,QBWS,QAUR,QBT6,QBV4,QAUJ,QAPN,QAJX,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Ignore Parameters in View or Query If Blank</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156169</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes two examples on how to return records that meet a
specific criteria and how to ignore the criteria if a parameter is empty or
null.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example 1: Parameter View with Values Passed from Controls on a Form</h3>
 

<OL><P><LI>Open the Tastrade project in the Visual FoxPro 3.0 Samples\Mainsamp
   folder or in the Visual FoxPro 5.0 Samples\Tastrade folder.

<P><LI>Create a new program, click the Code tab, and add the following lines of
   code:
<P>
<P><PRE>      IF "5.00" $ VERSION()
<PRE></PRE>         cDir = HOME()+"SAMPLES\TASTRADE"
      ELSE
         cDir = HOME()+"SAMPLES\MAINSAMP"
      ENDIF
      OPEN DATABASE cDir+"\DATA\TASTRADE.DBC" EXCLUSIVE
      CREATE SQL VIEW MyView as SELECT *;
         FROM tastrade!Employee;
         WHERE ((ALLTRIM(Employee.employee_id)==?vEmpid);
         OR (EMPTY(?vEmpid)=.T.));
         AND ((Employee.title == ?vTitle;
         OR (EMPTY(?vTitle)=.T.)))

   Save it as MyViewCode.prg and then Run the program.

</PRE><P><LI>Create a new form and save it as frmMyParam.

<P><LI>Add MyView to the DataEnviroment object of the frmMyParam form. View the
   properties of cursor1 and set the NoDataOnLoad property to .T. - True.

<P><LI>Add the following controls to the form and set the properties as
   indicated:
<P>
<P><PRE>      Text Box
      Name: Text1
</PRE><P>
<P><PRE>      Text Box
      Name: Text2
</PRE><P>
<P><PRE>      Grid
      Name: Grid1
      RecordSource: MyView
</PRE><P>
<P><PRE>      Command Button
      Name: Command1
      Caption: Requery
</PRE><P>
<P><PRE>      Command Button
      Name: Command2
      Caption: Clear
</PRE>
<P><LI>Add the following code to the Click event of the Command1 button:
<P>
<P><PRE>      vEmpid=Thisform.Text1.Value
      vTitle=Thisform.Text2.Value
      =REQUERY('MyView')
      ThisForm.Refresh
</PRE>
<P><LI>Add the following code to the Click event of the Command2 button:
<P>
<P><PRE>      Thisform.Text1.Value=""
      Thisform.Text2.Value=""
      Thisform.Refresh
</PRE>
<P><LI>Save and Run the form with following combination of values in the table
   below, and then click the Command1(Requery) button. Before you test the
   next combination of values, click the Command2(Clear) button.
<P>
<PRE>   Text1      Text2       Results
   --------------------------------------------------------

   &lt;blank&gt;    &lt;blank&gt;     All records are return

   1          &lt;blank&gt;     One record with Employee ID is 1

   1       Sales Manager  One record with Employee Id is 1
                          and Title is Sales Manager

   &lt;blank&gt; Sales Manager  Two records return with Title being Sales Manager

   2       Sales Manager  No records are returned

</PRE></OL><h3>Example 2: Parameter Query</h3>
 

<OL><P><LI>Open the project called Tastrade.

<P><LI>Create a new program under the Code tab with the following lines of
   code, save it as MyQueryCode and then Run the program:
<P>
<P><PRE>      CLOSE DATABASE
      IF "5.00" $ VERSION()
<PRE></PRE>        cDir = HOME()+"SAMPLES\TASTRADE"
      ELSE
        cDir = HOME()+"SAMPLES\MAINSAMP"
      ENDIF
      USE cDir+"\DATA\employee.dbf"
      CLEAR
      ACCEPT "Enter an Employee ID: " to vEmpid
      ACCEPT "Enter an Employee Last Name: " to vTitle
      SELECT *;
         FROM tastrade!Employee;
         WHERE ((ALLTRIM(Employee.employee_id)==?vEmpid);
         OR (EMPTY(?vEmpid)=.T.));
         AND ((Employee.title == ?vTitle;
         OR (EMPTY(?vTitle)=.T.)))

</PRE><P><LI>Use the same data as stated in the previous example for a test.
   For &lt;blank&gt; (in the table) press Enter at the prompt and the results
   returned should be the same as in Example 1.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbhowto<BR>
KBSubcategory: FxprgSql<BR>
Additional reference words: 3.00 3.00b 5.00 kbstream VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
