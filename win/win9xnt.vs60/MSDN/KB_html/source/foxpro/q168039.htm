

<HTML>
<HEAD>
<TITLE>PRB: Lockscreen with Assert Dialog Causes Problems with Controls </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168039">
<META NAME="KBModify" CONTENT="1997/12/02">
<META NAME="KBCreate" CONTENT="1997/05/05">
<META NAME="Keywords" CONTENT="FxprgGeneral FxtoolFormdes vfoxwin kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you run a form, clicking on a checkbox does not change its state. If there are option buttons on the form, clicking the checkbox may change the state of the option buttons. Clicking the checkbox may even select more than one option button in t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHP,QA01,QBV8,QAB9,QBWS,QAPN,QAH4,QBXS,QABH,QAY5,QAVX,QAVW,QAJX,QAEF,QADR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Lockscreen with Assert Dialog Causes Problems with Controls</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168039</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a form, clicking on a checkbox does not change its state. If
there are option buttons on the form, clicking the checkbox may change the
state of the option buttons. Clicking the checkbox may even select more
than one option button in the same option group. Clicking one of the option
buttons may change the state of the checkbox. In other words, the
checkboxes and option buttons are malfunctioning.
<P>
<P><h2>CAUSE</h2>
 
<P>
Several factors lead to this behavior. First, ASSERTS must be set ON and
the LockScreen property of the form changed to true (.T.) before an
expression that is ASSERTed evaluates to false (.F.). Next, Ignore or
Ignore All must be chosen in the message box displayed by the ASSERT
command. Finally, LockScreen must be changed back to false (.F.).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not use LockScreen when using the ASSERT command.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When SET ASSERTS is ON, the ASSERT command will display a message box if a
logical expression evaluates to false (.F.).
<P>
The following commands issued from within a program file will illustrate:
<P>
<PRE>   SET ASSERTS ON
   ASSERT 1=2       &amp;&amp; will cause a message box.

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Place the following code in a program file and run the program:
<P>
<P><PRE>      SET ASSERTS ON
      oForm1 = CREATEOBJECT("test")
      oForm1.Visible = .t.
      READ EVENTS
</PRE><P>
<P><PRE>      DEFINE CLASS test AS form
      ADD OBJECT cmdNewForm AS ccmdNewForm
      ADD OBJECT chkBox AS CheckBox WITH ;
<PRE></PRE>             left = 10, ;
             top = 30
      ADD OBJECT opgBox AS OptionGroup WITH ;
             Width = 80, ;
             Height = 50, ;
             ButtonCount = 2, ;
             option1.Caption = "Option1", ;
             option1.Autosize = .T., ;
             option2.Caption = "Option2", ;
             option2.Autosize = .T., ;
             left = 10, ;
             top = 50

         FUNCTION Destroy
             CLEAR EVENTS
         ENDFUNC
      ENDDEFINE

      DEFINE CLASS ccmdNewForm AS CommandButton
         Caption = "Dialog"

         FUNCTION Click
              Thisform.LockScreen = .T.
              ASSERT 1=2
              Thisform.LockScreen = .F.
              ?Thisform.LockScreen
              CLEAR
         ENDFUNC
      ENDDEFINE

</PRE><P><LI>When the program is run, a form with a command button, a checkbox and an
   option group is displayed. Click on the checkbox and option buttons to
   verify that they work normally.

<P><LI>Now click on the command button. This should bring up the message box
   from the ASSERT command. It should have the message:
<P>
   "Assertion failed on line 2 of procedure test1.cmdnewform.click"
<P>
   Choose the Ignore button.

<P><LI>Back on the form, click on the Chkbox and note that it does not become
   checked. Then click on Option2 and note that Chkbox checks. Then click
   on the Chkbox and note that both option buttons are selected.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual FoxPro Online Help
 
<PRE>Keywords          : FxprgGeneral FxtoolFormdes vfoxwin kbprb
Version           : 5.00 5.00a
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
