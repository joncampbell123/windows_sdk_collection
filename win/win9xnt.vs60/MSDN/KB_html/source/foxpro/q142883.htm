

<HTML>
<HEAD>
<TITLE>HOWTO: Troubleshooting Btrieve Connections in Visual FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142883">
<META NAME="KBModify" CONTENT="1997/05/27">
<META NAME="KBCreate" CONTENT="1996/01/21">
<META NAME="Keywords" CONTENT="FxinteropDatabase vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article lists troubleshooting techniques you can use if you receive connectivity errors attempting to connect to a Btrieve data source.  NOTE: Some products mentioned in this article are manufactured by vendors independent of Microsoft; we mak...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFS,QABI,QAU9,QA9E,QBTX,QAI5,QAB4,QABH,QA01,QAAP,QAUJ,QAK6,QAYY,QAA1,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Troubleshooting Btrieve Connections in Visual FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142883</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article lists troubleshooting techniques you can use if you receive
connectivity errors attempting to connect to a Btrieve data source.
<P>
NOTE: Some products mentioned in this article are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the steps given in this article to resolve the following error message
and other similar messages:
<P>
<PRE>   "Connectivity error: [Microsoft][ODBC Btrieve Driver] Errors
   encountered while using the Btrieve DLL"

</PRE><h3>Steps to Troubleshoot Error Message</h3>
 

<OL><P><LI>Check the current Btrieve driver version being used in the ODBC Icon.
   In the Main group in Program Manager, double-click the Control Panel
   icon:
<P>
   a. In the Control Panel window, double-click the ODBC icon. The Data
<P><PRE>      Sources dialog box appears.
</PRE><P>
   b. In the Data Sources dialog box, choose the Drivers button. The
<P><PRE>      Drivers dialog box appears.
</PRE><P>
   c. In the Drivers dialog box, highlight the Btrieve driver and choose
<P><PRE>      the About button. The following driver information is displayed:
</PRE><P>
<P><PRE>      driver, file name, description, company, version,
      language, creation date, and size.
</PRE>
<P><LI>Make sure the Wbtrcall.dll file is in the Windows\System directory. If
   the .dll file is missing, you can obtain it from Btrieve. This file is
   part of the Btrieve for Windows product. The Wbtrcall.dll must be
   installed and accessible on the system.

<P><LI>Check the size of the Wbtrcall.dll file. There are two versions; one is
   13K and the other is 51K. The 13K Wbtrcall.dll lacks full functionality
   and will cause an error. Be sure the 51K version is being used.

<P><LI>Check the version of the Btrieve data file being used. When you use a
   Btrieve 5.1 data file, the 51K Wbtrcall.dll file is needed. However,
   use the Btrieve client software when connecting to a Btrieve 6x file.

<P><LI>Check the Operating System. Presently, Microsoft ships the 16-Bit
   Btrieve driver. If the operating system is Windows NT or Windows 95, you
   must get the 32-bit ODBC driver. To do this, contact Btrieve directly at
   1-800-287-4383 and choosing option 3.

<P><LI>Be sure the File.ddf and Field.ddf files are located in the same
   directory as the .dat files. The paths to the Btrieve data files are
   hard-coded in the .ddf files. The Btrieve driver uses the .ddf files
   when connecting to a Btrieve datasource. If the .ddf files are missing,
   then the Btrieve driver will not be able to connect. The .ddf files can
   be created using a third party .ddf builder such as Xtrieve, DDF
   Builder, or Btrieve Scalable SQL. Xtrieve and Btreive Scalable SQL are
   sold by Btrieve technologies, a vendor independent of Microsoft.

<P><LI>Make sure that you have the Btrieve 2.0 ODBC driver (this comes with
   Visual FoxPro Professional). You need this driver to connect to a
   Btrieve 6x file. The Microsoft ODBC Desktop Driver Kit 1.0 comes with a
   Btrieve ODBC driver that can connect to Btrieve 5.1 (16-bit driver). The
   Microsoft ODBC desktop Driver Kit 2.0 comes with Btrieve ODBC driver,
   which can be used to connect to Btrieve 5.1 or Btrieve 6x.

<P><LI>Make sure there are no non-alphanumeric characters in the table name.
   This will usually cause "Syntax Errors" when retrieving data. File
   naming conventions call for standard alphanumeric characters in table
   names.

<P><LI>Make sure Btrieve data sources are added correctly, by following the
   instructions outlined here. In the Main group in the Program Manager
   window, double-click the Control Panel icon. In the Control Panel
   window, double-click the ODBC icon.
<P>
   a. In the Data Sources dialog box, choose the Add button. The Add Data
<P><PRE>      Source dialog box appears.
</PRE><P>
   b. In the Installed ODBC Drivers list, select the Btrieve driver and
<P><PRE>      choose the OK button. The ODBC Driver dialog box appears.
</PRE><P>
   c. In the Btrieve ODBC Driver dialog box, enter the Data Source Name and
<P><PRE>      the Connect String information, which should be made available by the
      Network Administrator. The Description can be set to whatever you
      want. For more information about these options, press the Help button
      in the dialog box.
</PRE>
<P><LI>Make sure the correct data source name is used in the ODBC Btrieve
<P><PRE>    Setup dialog box. It should be a directory name or the current
    directory as indicated in the Setup dialog box.
</PRE>
<P><LI>Make sure the Btrieve table names don't begin with SQL keywords such as
<P><PRE>    Update, In, Select, Create, Drop, Alter, or any other keyword.
</PRE>
<P><LI>Make sure the Btrieve.trn file exists and has not been renamed.

<P><LI>Check the Win.ini file for a [Btrieve] initialization option section.
<P><PRE>    The Btrieve 5.x format should contain an Options statement similar to
    the one in the following example:
</PRE><P>
<P><PRE>    [BTRIEVE]
    Options=/M:64/P:4096 /b:16 /f:20/l:40/n:12/t:Btrieve.Trn
</PRE>
<P><LI>If the Btrieve version is Btrieve.nlm (server-based version), check the
<P><PRE>    Win.ini file (for Btrieve version 5.1x) or the Novdb.ini file (for
    Btrieve version 6.x), and include the following command example:
</PRE><P>
<P><PRE>    [BREQUESTDPMI]
    datalength=4096
    tasks=10
    local=no
    Chkparms=no
</PRE><P>
</OL>These troubleshooting steps should resolve the majority of connection
errors, in the event none of these solutions correct the problem, please
contact Microsoft Product Support for further assistance.
<P>
<P><h2>REFERENCES</h2>
 
<P>
These sample configurations will depend on your installation requirements
and setup. For additional details, parameters, and options, please see your
Btrieve documentation.
<P>
For more information about accessing a Btrieve database, please see the
following article in the Microsoft Knowledge Base.
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q115837.htm">Q115837</A></B>
   TITLE     : Using the Connectivity Kit to Access a Btrieve Database

</PRE></OL>Additional 3words: ODBC Btrieve SQL Server Tshoot
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxinteropDatabase vfoxwin<BR>
Version             : 3.0b<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
