

<HTML>
<HEAD>
<TITLE>PRB: Using the SelPrint Method of the Rich Text Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170126">
<META NAME="KBModify" CONTENT="1997/06/18">
<META NAME="KBCreate" CONTENT="1997/06/16">
<META NAME="Keywords" CONTENT="FxinteropOcx FxprintGeneral kbcode vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The example code from Help for the SelPrint method of the Microsoft Rich Text Control causes syntax errors when saving after it is pasted into the Click method of a command button as directed by Help. Additionally, once the syntax errors are fixed,...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QAB5,QA7O,QAOE,QAMN,QAH4,QAPN,QA56,QA55,QAHV,QA6A,QBS0,QA01,QAA1,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Using the SelPrint Method of the Rich Text Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170126</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
   on the following platforms: NT, Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The example code from Help for the SelPrint method of the Microsoft Rich
Text Control causes syntax errors when saving after it is pasted into the
Click method of a command button as directed by Help. Additionally, once
the syntax errors are fixed, the contents of the Rich Text control do not
print on the Windows 95 platform but no error messages are received.
<P>
<P><h2>CAUSE</h2>
 
<P>
The example code in Help for the SelPrint method of the Microsoft Rich Text
control is Visual Basic code.
<P>
Even after converting this code to Visual FoxPro code, the contents of the
Rich Text Control cannot be printed on the Windows 95 platform. The
specific cause of this behavior is under investigation.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The example code for the SelPrint method can be changed into the following
Visual FoxPro code to eliminate the syntax errors and get the contents of
the Rich Text control to print when Visual FoxPro is running on the Windows
NT 4.0 platform.
<P>
As stated in Help, the following code should be placed in the Click method
of a command button. A CommonDialog control should also be placed on the
form with a command button and a Rich Text control:
<P>
<PRE>   cdlPDReturnDC=256
   cdlPDNoPageNums=8
   cdlPDSelection=1
   cdlPDAllPages=0

   Thisform.CommDlg1.Flags = cdlPDReturnDC + cdlPDNoPageNums
   If Thisform.RTF1.SelLength = 0
   Thisform.CommDlg1.Flags = Thisform.CommDlg1.Flags ;
   + cdlPDAllPages
   Else
   Thisform.CommDlg1.Flags = Thisform.CommDlg1.Flags ;
   + cdlPDSelection
   EndIf
   Thisform.CommDlg1.ShowPrinter
   Thisform.RTF1.SelPrint(Thisform.CommDlg1.hDC)

</PRE>Note that the above code refers to CommDlg1 and RTF1 as the names of the
ActiveX controls. When these controls are placed on a form, the names
default to "OLEControl1" and "OLEControl2." Therefore, the name property
for these two controls needs to be changed to "CommDlg2" and "RTF1,"
respectively, for the above code to work properly in Visual FoxPro.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The name and version of the Rich Text control varies depending on which
version of Visual FoxPro or Visual Basic has been installed on the
computer.
<P>
Look in the Tools, Options dialog box, Controls tab in Visual FoxPro to
check which version of a control is installed. Unfortunately the dialog box
displaying the controls is not wide enough to show the version number of
the Rich Text control. The actual file version can be obtained by viewing
the properties of the .ocx file in Windows Explorer.
<P>
The Microsoft Rich Textbox Control, version 1.0.2922, is installed by
Visual FoxPro 5.0. The file name is Richtx32.ocx and is found in either the
Win95\System or the WinNT\System32 folder depending on the operating
system.
<P>
The Microsoft RichText Control, version 5, version 5.00.3714, is installed
by Visual FoxPro 5.0a. It is also named Richtx32.ocx and is found in the
same locations as the version installed by Visual FoxPro 5.0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Help for the Microsoft Rich Text Control: Access this by right-clicking on
the control on the form and selecting Help from the shortcut menu. Click
the Methods jump at the top of the page and select the SelPrint Method to
Display from the Topics Found dialog box. The sample code is in the Example
jump at the top of the page.
<P>
ActiveX Controls Overview Help topic. Type "HELP ActiveX Controls Overview"
in the Visual FoxPro Command window to go directly to this topic.
<P>
For additional information about adding ActiveX controls to your
applications, see Chapter 16, "Adding OLE," in the Developer's Guide.
<P>
The values for the constants, cdlPDReturnDC, cdlPDNoPageNums,
cdlPDSelection, and cdlPDAllPages, used in the Resolution section above are
from the Help file for the Common Dialog control, Flags Property(Print
Dialog) topic. Right-click the Common Dialog control and select Help from
the shortcut menu.
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxinteropOcx FxprintGeneral kbcode vfoxwin<BR>
Version             : WINDOWS:5.0,5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
