

<HTML>
<HEAD>
<TITLE>DDE Macro with Microsoft Excel as Client &amp; FoxPro as Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121957">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/10/24">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbmacro kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro for Windows can be used as a dynamic data exchange (DDE) server if DDEDATA.APP is run before the DDE link is established from Microsoft Excel. DDEDATA.APP, which is included with FoxPro for Windows, sets up FoxPro as a DDE server.  Connectin...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QAH4,QAA1,QAZ2,QDI2,QBUG,QBUF,QAY2,QAJH,QBWS,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DDE Macro with Microsoft Excel as Client &amp; FoxPro as Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121957</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
FoxPro for Windows can be used as a dynamic data exchange (DDE) server if
DDEDATA.APP is run before the DDE link is established from Microsoft Excel.
DDEDATA.APP, which is included with FoxPro for Windows, sets up FoxPro as a
DDE server.
<P>
Connecting to FoxPro as a DDE server is a little different than connecting
to other DDE servers from Microsoft Excel. See below for an example of
Microsoft Excel Visual Basic for Applications macro code used to make
the connection to FoxPro.
<P>
MORE INFORMATION
 
<P>
<P><h3>Set Up FoxPro as a DDE Server</h3>
 
<P>
To set up FoxPro as a server, perform the following:

<OL><P><LI>Using Project Manager, open the DDEDATA.PJX file located in the
   &lt;FoxPro_directory&gt;\SAMPLE\DDE subdirectory.

<P><LI>Build the application, using the default name DDEDATA.APP.

<P><LI>Run DDEDATA.APP.
<P>
</OL><h3>Connect to FoxPro from Microsoft Excel Using Visual Basic for Applications</h3>
 
<P>
In Microsoft Excel, type the following lines of code in a Visual Basic for
Applications module sheet in a workbook:
<P>
<PRE>   Sub foxddetest()

     ChannelNumber = Application.DDEInitiate _
   ("ddedata","c:\fpw26\tutorial\;table invoices")

     returnList = Application.DDERequest(ChannelNumber, "firstrow")

     For i = LBound(returnList) To UBound(returnList)
       Cells(2, i).Formula = returnList(i)
     Next i

     Application.DDETerminate ChannelNumber

   End Sub

</PRE></OL>The DDEInitiate() command opens a channel to FoxPro. The first argument,
the application or service name, is "ddedata" because DDEDATA.APP is
running in FoxPro. The second argument, the topic, is the path to the
database table, followed by a semicolon, and then the table name. The
variable ChannelNumber contains a numeric value that represents the DDE
channel link.
<P>
The DDERequest() command's first argument is the channel number (or its
variable). The second argument is the requested item. Items that can be
requested include: ALL, DATA, FIELDCOUNT, FIELDNAMES, FIRSTROW, LASTROW,
NEXTROW, and PREVROW. Other topics can be programmed within FoxPro
beforehand. This example requests the information from the first row of the
database, which is returned to Microsoft Excel in an array.
<P>
The For ... Next loop retrieves the information and places it in the active
sheet of the workbook. This macro should be run from a worksheet, not the
module sheet, through the Tools and Macros menu options.
<P>
<P><h2>REFERENCES</h2>
 
<P>
FoxPro for Windows "Developer's Guide," version 2.5, pages D12-12 to D12-20
<P>
Microsoft Excel "Visual Basic User's Guide," version 5.0, pages 209-217
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbinterop kbprg kbmacro kbcode<BR>
KBSubcategory: FxinteropDde<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
