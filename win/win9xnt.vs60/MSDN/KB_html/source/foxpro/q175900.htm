

<HTML>
<HEAD>
<TITLE>FIX: Code Pages Not Supported in All OS Languages at Run Time </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175900">
<META NAME="KBModify" CONTENT="1997/11/11">
<META NAME="KBCreate" CONTENT="1997/10/29">
<META NAME="Keywords" CONTENT="FoxWin FxenvOs FxsetupGeneral">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In development mode, CPCURRENT() returns the correct value for a code page setting in the Config.fpw file. At run time, however, CPCURRENT() returns a value of zero (0) when the code page setting in the Config.fpw file is set to a value other than ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWP,QAH4,QABA,QBXS,QBAO,QDL9,QBWO,QBWN,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Code Pages Not Supported in All OS Languages at Run Time</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175900</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In development mode, CPCURRENT() returns the correct value for a code page
setting in the Config.fpw file. At run time, however, CPCURRENT() returns a
value of zero (0) when the code page setting in the Config.fpw file is set
to a value other than 437, 850, or 1252. This behavior also occurs when a
run time application is executed on a non-English operating system and the
code page is set to auto in the Config.fpw file.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Visual
FoxPro 3.x and Visual FoxPro 5.x.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When Windows starts, the international settings are determined by the
values in the [intl] section of the Win.ini file. FoxPro for Windows uses
the Microsoft Windows international settings on start up and overrides
FoxPro's default settings.
<P>
A code page is a character set specific to an operating system or hardware
platform. FoxPro uses code page information to translate between code pages
so data is properly displayed and ordered. The manner in which data is
ordered is determined by the collation sequence invoked with the SET
COLLATE TO command. Use of data containing accented characters for any of
the supported languages in an index necessitates setting the collation
sequence to one of the alternate settings found in the topic SET COLLATE of
the FoxPro Help file. Setting the collation sequence to a value other than
"MACHINE" requires that "codepage=auto" be included in the Config.fpw file.
FoxPro's default collation sequence is "MACHINE" and does not require a
code page setting in the Config.fpw file.
<P>
For additional information regarding code pages, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q103833.htm">Q103833</A></B>
   TITLE     : Using Alternate Character Sets Provided by Code Pages

   ARTICLE-ID: <B><A href="../foxpro/q129631.htm">Q129631</A></B>
   TITLE     : Understanding Code Pages in Visual FoxPro

   ARTICLE-ID: <B><A href="../foxpro/q136943.htm">Q136943</A></B>
   TITLE     : Multiple-Language Implications in Visual FoxPro

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In a clean directory, create a project named CPTEST.

<P><LI>Add a new program file named Cptest.prg.

<P><LI>Add the following code to the Cptest.prg file:
<P>
<P><PRE>      *Begin Code
      testval=CPCURRENT()
      WAIT WINDOW STR(testval)
      RETURN
      *End Code
</PRE>
<P><LI>Save the program file and build an executable. In FoxPro 2.x for
   Windows, copy the support library file (.esl) file to the directory
   containing the Foxpro executable file.

<P><LI>Create a Config.fpw file in the same directory with the executable,
   containing one of the following lines:
<P>
<P><PRE>      codepage=620
      codepage=737
      codepage=852
      codepage=861
      codepage=865
      codepage=866
      codepage=895
      codepage=857
      codepage=1250
      codepage=1253
      codepage=1254
      codepage=10000
      codepage=10006
      codepage=10007
      codepage=10029
</PRE>
<P><LI>Exit FoxPro and run the executable using the Windows Run command.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
FoxPro Help file; search on topic: "code pages"
FoxPro Help file; search on topic: "SET COLLATE"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : FoxWin FxenvOs FxsetupGeneral<BR>
Version           : WINDOWS:2.5a,2.5b,2.6,2.6a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
