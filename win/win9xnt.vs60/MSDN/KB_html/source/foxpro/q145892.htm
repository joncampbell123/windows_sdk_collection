

<HTML>
<HEAD>
<TITLE>PRB: OCX Visible on All Pageframe Pages After Modal Form Runs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145892">
<META NAME="KBModify" CONTENT="1996/02/12">
<META NAME="KBCreate" CONTENT="1996/02/11">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a modal form is brought up over a form that contains an OLE Container Control on a page of a pageframe, when the modal form is closed, the OLE Container Control will be visible even when the page that contains it is not active.  WORKAROUND  For ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAW6,QA7O,QAB5,QAOE,QAMN,QA9Q,QAH4,QBWA,QACI,QBE5,QAPN,QBXS,QAHV,QAI2,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: OCX Visible on All Pageframe Pages After Modal Form Runs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145892</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a modal form is brought up over a form that contains an OLE Container
Control on a page of a pageframe, when the modal form is closed, the OLE
Container Control will be visible even when the page that contains it is
not active.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
For the form that runs atop the form with the OLE Container Control, set
the WindowType property to 0 - Modeless.
<P>
-or-
<P>
In the Deactivate code for the pages that contain OLE Container Controls,
move the OLE Container Control object off the page by setting its Left
property to a high value. Move the object back to its proper position in
the Activate code of the page.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form called Mainform.

<P><LI>Add a command button and place the following code in its Click event:
<P>
   DO FORM Modalfrm.

<P><LI>Add a Pageframe.

<P><LI>Add an OLE Container Control (such as Outline.ocx) to each of the two
   pages of the Pageframe.

<P><LI>Save the form.

<P><LI>Create a form called Modalfrm, and set its WindowType property to 1 -
   Modal. Save the form.

<P><LI>Run Mainform, and press the command button to bring up Modalfrm over
   Mainform.

<P><LI>Exit the modal form.

<P><LI>Both of the Outline controls will be visible on the active page of the
   pageframe.
<P>
</OL><h3>Notes</h3>
 

<OL><P><LI>If each of the pages are activated, the OLE Container Controls will
   again be visible only when the page that contains them is active.

<P><LI>This does not occur if the form brought on top is not modal.
<P>
</OL><h3>Workaround One</h3>
 
<P>
Set the WindowType to 0 - Modeless for any forms brought up over forms that
have OLE Container Controls on inactive pages.
<P>
<P><h3>Workaround Two</h3>
 
<P>
The following workaround moves the OLE Container Controls that are on
inactive pages to a place outside the form boundaries, so modal forms can
be used.
<P>
For the form that holds the pageframe with pages containing OLE Container
Control objects, perform these steps:

<OL><P><LI>In the Init code of each of the OLE Container Controls, place:
<P>
<PRE>   THIS.Left=3500             &amp;&amp; Some artificially high value

</PRE><P><LI>In the Activate code of each page, place:
<P>
<PRE>   THIS.Olecontrol1.Left=35   &amp;&amp; desired placement when on active page

</PRE><P><LI>In the Deactivate code of each page, place:
<P>
<PRE>   THIS.Olecontrol1.Left=3500   &amp;&amp; artificially high value

</PRE></OL>Each OLE Container Control will now be visible only when it is on the
active page.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
