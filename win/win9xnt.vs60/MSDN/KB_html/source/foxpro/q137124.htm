

<HTML>
<HEAD>
<TITLE>PageFrame Parameterized View Example </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137124">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1995/09/20">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article provides a complete example showing how to create a PageFrame that has Pages and ListBoxes to display the results of a parameterized view from a single table. The views created may be modified to suit a specific situation.  MORE INFORM...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADK,QAPN,QA2Q,QBWT,QAY2,QAPF,QAG2,QBWA,QA7O,QA7N,QAO4,QAE1,QBWS,QBVR,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PageFrame Parameterized View Example</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137124</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides a complete example showing how to create a PageFrame
that has Pages and ListBoxes to display the results of a parameterized view
from a single table. The views created may be modified to suit a specific
situation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It is assumed that you are familiar with the View Designer.

<OL><P><LI>Create the following Views in Vpf\Samples\Mainsamp\Data\Tastrade.dbc
   database:
<P>
   NOTE: When you create the local view in the View Designer, set the
   parameter in the SELECT statement to the List Value property,
   as in the following SELECT statements. For example in the View Designer
   for List2, place "city" in the Selected Output field, "country" in the
   Field Name field, and ?ThisForm.PageFrame1.Page1.List1.Value in the
   Example field.
<P>
   View List2:
<P>
<P><PRE>      SELECT customer.city FROM tastrade!customer ;
<PRE></PRE>         WHERE customer.country = ?ThisForm.PageFrame1.Page1.List1.Value

   View List3:

      SELECT customer.company_name FROM tastrade!customer ;
         WHERE customer.city = ?ThisForm.PageFrame1.Page2.List1.Value

   View List4:

      SELECT customer.customer_id FROM tastrade!customer WHERE ;
         customer.company_name = ?ThisForm.PageFrame1.Page3.List1.Value

</PRE><P><LI>On a Form, place a PageFrame with 4 Pages and a ListBox on each Page.
   Establish the following methods and properties for the Form and
   PageFrame Pages:
<P>
   a. In the Init event of the form:
<P>
<P><PRE>      This.DataEnvironment.OpenTables
</PRE><P>
<P><PRE>      This.PageFrame1.Page2.List1.RowSource='List2'
      This.PageFrame1.Page2.List1.RowSourceType=2
</PRE><P>
<P><PRE>      This.PageFrame1.Page3.List1.RowSource='List3'
      This.PageFrame1.Page3.List1.RowSourceType=2
</PRE><P>
<P><PRE>      This.PageFrame1.Page4.List1.RowSource='List4'
      This.PageFrame1.Page4.List1.RowSourceType=2
</PRE><P>
   b. On the Property Sheet for Page1.List1:
<P>
<P><PRE>      Page1.List1.RowSource
</PRE><P>
<PRE>         SELECT distinct Country from Customer into Cursor abc

      Page1.List1.RowSourceType

         3 - SQL Statement

   c. In the InterActiveChange event for Page 1.List1:

      *This is for the List on Page 1

      = REQUERY("List2")

      ThisForm.PageFrame1.Page2.List1.RowSource='List2'
      ThisForm.PageFrame1.Page2.List1.RowSourceType=2
      ThisForm.PageFrame1.Page2.List1.requery( )

   d. In the Page2.List1.LostFocus event:

      NOTE: The Help file recommends that the following code be placed in
      the InterActiveChange method but testing has shown that if there is
      only one selection available beyond Page1, the subsequent Lists are
      not updated.

      *This is for the ListBox on Page 2
      = REQUERY("List3")

      ThisForm.PageFrame1.Page3.List1.RowSource='List3'
      ThisForm.PageFrame1.Page3.List1.RowSourceType=2
      ThisForm.PageFrame1.Page3.List1.requery( )

   e. In the Page3.List1.LostFocus event:

      *This is for the ListBox on Page 3

      = REQUERY("List4")

      ThisForm.PageFrame1.Page4.List1.RowSource='List4'
      ThisForm.PageFrame1.Page4.List1.RowSourceType=2
      ThisForm.PageFrame1.Page4.List1.Requery( )

</PRE><P><LI>Create a DataEnvironment for the form.
<P>
   a. Include the following table and views from the TASTRADE.DBC:
<P>
<P><PRE>      1. Customer table
      2. View List2
      3. View List 3
      4. View List 4
</PRE><P>
   b. Set the DataEnvironment.AutoOpenTables property to false (.F.).
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 VFoxMac 3.00b 3.00 VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
