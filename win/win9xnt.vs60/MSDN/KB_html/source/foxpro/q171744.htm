

<HTML>
<HEAD>
<TITLE>BUG: DragIcon Property with Cursor Files Does Not Work in an EXE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171744">
<META NAME="KBModify" CONTENT="1997/07/24">
<META NAME="KBCreate" CONTENT="1997/07/23">
<META NAME="Keywords" CONTENT="FxtoolFormdes vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Including certain cursor files (.cur) in a project causes the DragIcon property to malfunction in a Visual FoxPro for Windows 5.0a executable. The cursor files work properly, however, in the form or the application when run under the development en...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QAPN,QA56,QA55,QAVX,QAVW,QBVV,QAH4,QAG0,QAR8,QAJN,QAO4,QALZ,QBWC,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: DragIcon Property with Cursor Files Does Not Work in an EXE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171744</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Including certain cursor files (.cur) in a project causes the DragIcon
property to malfunction in a Visual FoxPro for Windows 5.0a executable. The
cursor files work properly, however, in the form or the application when
run under the development environment of Visual FoxPro 5.0a.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not include the cursor files in the project. Using the Project Manager,
mark the cursor files as Excluded. If the cursor files are excluded from
the project, the cursor files need to be supplied with the executable by
another means.
<P>
A second option is to assign the DragIcon property at runtime.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When using certain cursor files that shipped with Visual Studio 97, the
executable version of an application ignores the DragIcon property. The
cursor files that do not work with the DragIcon property in an executable
file follow:

<UL><LI>4way01.cur
<LI>4way02.cur
<LI>4way03.cur
<LI>4way06.cur
<LI>4way07.cur
<LI>4way08.cur
<LI>4way09.cur
<LI>C_wait02.cur
<LI>Ew_06.cur
<LI>Normal02.cur
<P>
</UL>Cursor files 4way04.cur, 4way05.cur, and Cross04.cur do function properly.
<P>
NOTE: This is not intended as a comprehensive list of cursor files and
<PRE>      their suitability for usage with the DragIcon property.

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a project called Test.

<P><LI>Add a main program file to the project that contains the following code:
<P>
<P><PRE>      DO FORM Test
      READ EVENTS
</PRE>
<P><LI>Create a form called Test and add a shape to the form. Set the
   following properties of the shape object:
<P>
<P><PRE>      BackColor=255,0,0
      DragMode=1
      DragIcon=devstudio\Samples\graphics\cursor\4way01.cur
</PRE><P>
<P><PRE>      ** NOTE: The above path to 4way01.cur may need to be changed.
</PRE>
<P><LI>Add a command button containing the following code in the Click event:
<P>
<P><PRE>      ThisForm.Release
      CLEAR EVENTS
</PRE>
<P><LI>Build an application file and execute under it Visual FoxPro development
   environment.

<P><LI>Drag the shape object and notice the DragIcon is the specified cursor.

<P><LI>Now build an executable file and run it outside of Visual FoxPro.

<P><LI>Drag the shape and notice that no icon appears.
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxtoolFormdes vfoxwin<BR>
Version             : WINDOWS:5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
