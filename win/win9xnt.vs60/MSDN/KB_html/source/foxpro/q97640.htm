

<HTML>
<HEAD>
<TITLE>Combining GET Fields and a Browse in a Single Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97640 ">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1993/10/27">
<META NAME="Keywords" CONTENT="FxtoolSbuilder kbappnote kbcode kbprg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Although the FoxPro Screen Builder allows a data input screen to be combined with a separate Browse window, the GET fields of the data input screen and the information in the Browse window cannot be combined in a single window. However, the screen ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QA5V,QAH4,QBWS,QDL9,QBWQ,QBWO,QBWN,QAA8,QAGQ,QAG2,QA7O,QAEF,QA50,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Combining GET Fields and a Browse in a Single Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97640 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.60 2.60a | 2.00 2.5x 2.60 2.60a | 2.5x 2.60a
<PRE>WINDOWS         | MS-DOS               | MACINTOSH
</PRE>kbprg kbusage kbcode kbappnote
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Although the FoxPro Screen Builder allows a data input screen to be
combined with a separate Browse window, the GET fields of the data input
screen and the information in the Browse window cannot be combined in a
single window. However, the screen can be programmed so that the GET fields
and the browse information appear to be in a single window, as explained
below.
<P>
NOTE: For a more complete description of combining a Browse window with GET
fields, please refer to Application Note FW1125.
<P>
For a description of Application Note FW1125 and how to obtain it, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q124606.htm">Q124606</A></B>
   TITLE     : SAMPLE: Fw1125.exe Combines a Browse Window with Get Fields

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This example uses GET fields from the CUSTOMER.DBF table in conjunction
with a browse of related records in the INVOICES.DBF table. It is assumed
that the CUSTOMER.DBF and INVOICES.DBF tables have been installed in the
TUTORIAL subdirectory in the main FoxPro directory.
<P>
The steps below create three windows:

<UL><LI>Window #1, called WBIG, is a large window with a border that acts as a
   visual frame around the GET screen and the Browse window.

<LI>Window #2, called WGETS, contains GET fields and push buttons. It does
   not have a border.

<LI>Window #3, called WBROWSE, contains the browse information of the
   invoices records found in the INVOICES table.
<P>
</UL>NOTE: The actual screen coordinates of the windows matter only insofar as
WGETS and WBROWSE are contained within WBIG.
<P>
<P><h3>Create the Screens</h3>
 
<P>
To create these windows using the Screen Builder power tool, do the
following:

<OL><P><LI>In the Command window, type "CREATE SCREEN getbrow" (without the
    quotation marks) to create a screen using the Screen Builder.

<P><LI>From the Screen menu, choose Quick Screen. When prompted, select
    CUSTOMER.DBF from the &lt;FoxPro_directory&gt;\TUTORIAL subdirectory, then
    choose Open.

<P><LI>In the Quick Screen dialog box, select the Fields check box.

<P><LI>Move CNO and COMPANY to the Selected Fields list box. Choose OK twice
    to return to the Screen Design window.
<P>
    NOTE: Because the WGETS window will be defined as eight lines high,
    these fields should be located in the first eight rows of the screen.
    If fields are defined beyond this point, a "Position off screen" error
    will be generated when the .SPR file is run.

<P><LI>FOXPRO FOR WINDOWS &amp; FOXPRO FOR MACINTOSH: From the Screen menu,
    choose Layout. In the Name text box, type "WGETS" (without the
    quotation marks) for the screen name. Do NOT choose OK yet.
<P>
    FOXPRO FOR MS-DOS: From the Screen menu, choose Screen Layout. Select
    the Window option button at the top of the dialog box. In the Name text
    box, type "WGETS" (without the quotation marks) for the screen name. Do
    NOT choose OK yet.

<P><LI>FOXPRO FOR WINDOWS &amp; FOXPRO FOR MACINTOSH: Under Options, choose the
    Code button.
<P>
    FOXPRO FOR MS-DOS: Skip to step 7.

<P><LI>FOXPRO FOR WINDOWS &amp; FOXPRO FOR MACINTOSH: Choose both the Screen Setup
    Code and Cleanup And Procedures buttons. Choose OK twice.
<P>
    FOXPRO FOR MS-DOS: Under Screen Code, choose both the Setup and
    Cleanup &amp; Procs check boxes. Choose OK once.

<P><LI>Locate the "getbrow - Setup" editing window and type the following code
    in it:
<P>
       CLOSE DATABASES
       SELECT 1
       USE SYS(2004)+"\TUTORIAL\customer.dbf"
       * SYS(2004) Returns the name of the directory that
       * FoxPro was started from.
       SELECT 2
       USE SYS(2004)+"\TUTORIAL\invoices.dbf"
<P>
       SET SAFETY OFF  &amp;&amp; Prevents error message if tag already exists.
       INDEX ON cno TAG cno ADDITIVE
       SET SAFETY ON
<P>
       SELECT 1
       SET RELATION TO cno INTO invoices ADDITIVE
       SET SKIP TO invoices  &amp;&amp; Establishes one-to-many relationship.
<P>
       DEFINE WINDOW wbig FROM 1,1 TO 22,80 DOUBLE
       DEFINE WINDOW wgets FROM 0,5 TO 8,75;
<PRE>          IN WINDOW wbig NONE
       DEFINE WINDOW wbrowse FROM 9,0 TO 20,80;
          IN WINDOW wbig NONE

       ACTIVATE WINDOW wbig
       SELECT invoices
       ACTIVATE WINDOW wbrowse
       BROWSE WINDOW wbrowse IN WINDOW wbig SAVE NOWAIT
       SELECT customer
       ACTIVATE WINDOW wgets

</PRE><P><LI>Type the following code in the "getbrow - Cleanup" editing window:
<P>
       RELEASE WINDOW wbig, wbrowse

<P><LI>From the Program menu, choose Generate.

<P><LI>When prompted to save changes to the file, choose Yes.

<P><LI>When prompted to save environment information, choose No.
<P>
    NOTE: The environment is controlled by the code in "getbrow - Setup" in
    Step 8.

<P><LI>FOXPRO FOR WINDOWS &amp; FOXPRO FOR MACINTOSH: In the Generate Screen
    dialog box, choose the More button.
<P>
    FOXPRO FOR MS-DOS: Skip to step 14.

<P><LI>Clear the Define Windows check box, then choose Generate.
<P>
</OL>To run the program, type "DO getbrow.spr" (without the quotation marks) in
the Command window.
<P>
NOTE: No records are displayed in the Browse window of this example because
the first record in the CUSTOMER table doesn't have any related INVOICES
records. To move through the tables so that you can see other records, add
the control buttons described in the next section.
<P>
<P><h3>Control Buttons</h3>
 
<P>
To create push buttons to move forward or backward through the tables, or
to close the screen, perform the following steps:

<OL><P><LI>Type "MODIFY SCREEN getbrow" (without the quotation marks) to open the
   screen.

<P><LI>To place a push button object on the screen immediately below the
   COMPANY GET field, do one of the following:
<P>
   FOXPRO FOR WINDOWS &amp; FOXPRO FOR MACINTOSH: From the toolbox, choose the
   push button tool. Click the area directly below the COMPANY GET field to
   place the push button object.
<P>
   FOXPRO FOR MS-DOS: From the Screen menu, choose Push Button.
<P>
   NOTE: The push button object must not overlap the areas used by the
   WGETS or WBROWSE windows.

<P><LI>Under Push Button Prompts, type "Next", "Prior", and "Quit" (without
   the quotation marks) on separate lines. In the Variable text box, type
   "BUTVAL" (without the quotation marks). Do NOT choose OK yet.

<P><LI>FOXPRO FOR WINDOWS &amp; FOXPRO FOR MACINTOSH: Under Clauses, choose the
   Valid button.
<P>
   FOXPRO FOR MS-DOS: Under Options, select the Valid check box.

<P><LI>Verify that the Procedure option button is selected, then type the
   following code in the text box:
<P>
<P><PRE>      SELECT customer
      SET SKIP TO  &amp;&amp; Removes one-to-many relationship so that the SKIP
<PRE></PRE>                   *  statement below doesn't move through the INVOICES
                   *  records.
      DO CASE
        CASE butval =  1
          IF (!EOF())
            SKIP 1
          ENDIF
        CASE butval = 2
          IF (!BOF())
            SKIP - 1
          ENDIF
        CASE butval = 3
          CLEAR READ
      ENDCASE

      SET SKIP TO invoices  &amp;&amp; Reestablishes one-to-many relationship.
      SHOW GETS

</PRE><P><LI>Choose OK twice to return to the Screen Design window.

<P><LI>FOXPRO FOR WINDOWS &amp; FOXPRO FOR MACINTOSH: Skip to step 8.
<P>
   FOXPRO FOR MS-DOS: Drag the push button to a location immediately below
   the COMPANY GET field.

<P><LI>Generate the code for the screen again. Be sure to clear the Define
   Windows check box.
<P>
</OL>NOTE: Not all CUSTOMER records have corresponding INVOICES records. Also,
note that "Atec Data Service" is the first CUSTOMER record that has
multiple related INVOICE records.
<P>
<P><h3>Switching Between the Screens</h3>
 
<P>
Two keyboard methods can be used to switch between the Browse window and
the GET screen:

<UL><LI>CTRL+F1 can be used to cycle through any open windows. To use this
   keyboard shortcut, the FoxPro system menu, or a menu using the system
   menu bar _MWI_ROTAT with a shortcut key of CTRL+F1, must be currently
   defined in memory. The menu must be accessible by setting SYSMENU to ON
   or AUTOMATIC. If other windows are currently open, pressing CTRL+F1 may
   cycle through these unrelated windows.
<P>
<P><PRE>    -or-
</PRE>
<LI>An ON KEY LABEL command can be defined to switch between the two
   windows. To define this command, do the following:
<P>
   a. Type "MODIFY SCREEN getbrow" (without the quotation marks) to
<P><PRE>      open the screen.
</PRE><P>
   b. From the Screen menu, choose Open All Snippets.
<P>
   c. Locate the "getbrow - Setup" editing window, then add the following
<P><PRE>      as the first two lines of code:
</PRE><P>
<PRE>         SET SYSMENU ON               &amp;&amp; Enables CTRL+F1 to switch.
         ON KEY LABEL F2 DO switchwin &amp;&amp; Enables F2 to switch.

   d. In the "getbrow - Cleanup" editing window, add the following as the
      last lines of code:

         ON KEY LABEL F2  &amp;&amp; Clear the F2 key when done.

         PROCEDURE switchwin
         IF WONTOP('WGETS')
            SELECT customer
            ACTIVATE WINDOW wbrowse
            BROWSE WINDOW wbrowse IN WINDOW wbig SAVE NOWAIT
         ELSE
            SELECT invoices
            ACTIVATE WINDOW wgets
         ENDIF

   e. Generate the code for the screen again. Be sure to clear the Define
      Windows check box.

   In this example, the F2 key is used to switch between windows using the
   procedure SWITCHWIN. This procedure determines which window is currently
   the active output window and activates the other window. This method
   does not require access to the menu bar, and will cycle only between the
   GET screen and the Browse window.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.00 2.50 2.50a 2.50b<BR>
2.50c 2.60<BR>
2.60a<BR>
one read genscrn.prg<BR>
KBCategory: kbprg kbusage kbcode kbappnote<BR>
KBSubcategory: FxtoolSbuilder<BR>
Keywords          : FxtoolSbuilder kbappnote kbcode kbprg kbusage<BR>
Version           : 2.5x 2.60 2.60a | 2.00 2.5x 2.60<BR>
Platform          : MACINTOSH MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
