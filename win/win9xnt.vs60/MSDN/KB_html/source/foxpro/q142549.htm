

<HTML>
<HEAD>
<TITLE>How to Troubleshoot VFP OLE Memory Errors in 16-bit Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142549">
<META NAME="KBModify" CONTENT="1996/05/31">
<META NAME="KBCreate" CONTENT="1996/01/15">
<META NAME="Keywords" CONTENT="kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Because of limitations in the operating system and the memory requirements of Object Linking and Embedding operations (OLE), Visual FoxPro running under Windows 3.1 or Windows for Workgroups may produce any one of several different error messages. ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAB4,QA9Q,QBW6,QDL9,QBWQ,QBWN,QAAP,QA6A,QAH4,QDIR,QA56,QA55,QAMB,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Troubleshoot VFP OLE Memory Errors in 16-bit Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 31, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142549</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Because of limitations in the operating system and the memory requirements
of Object Linking and Embedding operations (OLE), Visual FoxPro running
under Windows 3.1 or Windows for Workgroups may produce any one of several
different error messages. These errors may occur randomly or after repeated
OLE operations. This article describes how to troubleshoot OLE error
messages by delving into the causes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If Visual FoxPro or the operating system encounters a low-memory situation
or a memory conflict on a computer, various error messages may appear. For
example, Visual FoxPro could cause a general protection (GP) fault, Win32s
unhandled exception error, segment load failure, or it may cause the
computer to hang. While this list is not complete but does include the most
common problems.
<P>
When OLE operations fail, it is usually because you have low or improperly
configured memory, low Graphics Device Interface (GDI) resources, conflicts
in memory, or corrupt Win32s subsystem files.
<P>
<P><h3>Low or Improperly Configured Memory</h3>
 
<P>
Because OLE operations need considerable memory to function, the
configuration of memory is important. First, eliminate any expanded memory
on the machine. Visual FoxPro cannot use expanded memory, so it takes away
from the total pool of extended memory. Second, make sure that Windows is
configured to use a permanent swap file. The permanent swap file allows
Windows to swap code out of physical RAM and onto the hard drive. The
permanent swap file must be at least 12-14 megabytes in size. However, for
intense OLE operations, a larger swap file is frequently necessary.
<P>
<P><h3>Low Graphics Device Interface (GDI) Resources</h3>
 
<P>
Because Window 3.1 and Windows for Workgroups are both 16-bit operating
systems, there is a limit to the GDI resources available for programs.
Often, if Visual FoxPro cannot acquire the needed GDI resources to complete
an operation, Windows will report an "Insufficient Memory" message.
Switching to Program Manager and choosing Help About Program Manager offers
a rough estimate of the available system resources. If this number is below
50 percent, problems may develop. Strategies for freeing system resources
are provided in one of the articles listed in the "References" section of
this article.
<P>
<P><h3>Conflicts in Memory</h3>
 
<P>
Various memory conflicts may cause OLE errors. The two quickest way to
troubleshoot memory conflicts are to change the video driver to standard
VGA and perform a 'clean boot' of the computer. The Windows User's Guide
provides steps to changing video drivers. Instructions for a 'clean boot'
configuration are in one of the articles listed in the "References" section
of this article.
<P>
<P><h3>Corrupt Win32s Subsystem Files</h3>
 
<P>
An improperly installed Win32s subsystem may generate OLE errors. The
Win32s files allow the 32-bit code of Visual FoxPro to communicate with the
16-bit code of Windows 3.1 or Windows for Workgroups. This process is
called thunking. Steps for reinstalling Win32s are outlined in an article
listed in the "References" section of this article.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about topics discussed in this article, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win3x/q112676.htm">Q112676</A></B>
   TITLE     : Troubleshooting Insufficient Memory Errors

   ARTICLE-ID: <B><A href="../win3x/q87290.htm">Q87290</A></B>
   TITLE     : What is a Clean Boot for Windows 3.1?

   ARTICLE-ID: <B><A href="../win3x/q90511.htm">Q90511</A></B>
   TITLE     : What is a Clean Boot for Windows for Workgroups?

   ARTICLE-ID: <B><A href="../win3x/q111428.htm">Q111428</A></B>
   TITLE     : What is a Clean Boot for WFWG 3.11 with Netware?

   ARTICLE-ID: <B><A href="../win3x/q92603.htm">Q92603</A></B>
   TITLE     : What is a Clean Boot for WFWG with Novell Connectivity

   ARTICLE-ID: <B><A href="../win3x/q90762.htm">Q90762</A></B>
   TITLE     : Information on System Resources in Windows

   ARTICLE-ID: <B><A href="../foxpro/q129979.htm">Q129979</A></B>
   TITLE     : How to Reinstall Win32s with Visual FoxPro

   ARTICLE-ID: <B><A href="../foxpro/q101808.htm">Q101808</A></B>
   TITLE     : Insufficient Memory or Not Enough Memory for Application
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin kblist<BR>
KBCategory: kbinterop<BR>
KBSubcategory: FxinteropOle<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 31, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
