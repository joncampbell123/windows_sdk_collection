

<HTML>
<HEAD>
<TITLE>How to Highlight a Menu Option or Menu Item Programmatically </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143074">
<META NAME="KBModify" CONTENT="1996/01/30">
<META NAME="KBCreate" CONTENT="1996/01/25">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Upon startup of an application, you may want to have a specific menu or menu option highlighted by default so that the user need only press the ENTER key to carry out the associated command. This article presents a simple way to do it.  MORE INFORM...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QAH4,QAVI,QBDT,QAF0,QBWS,QBV8,QBSO,QAPN,QAUD,QACF,QAG2,QBER,QAB9,QAFX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Highlight a Menu Option or Menu Item Programmatically</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143074</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Upon startup of an application, you may want to have a specific menu or
menu option highlighted by default so that the user need only press the
ENTER key to carry out the associated command. This article presents a
simple way to do it.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This method, which depends on the KEYBOARD command, can be used with either
FoxPro for Windows or Visual FoxPro.

<OL><P><LI>Create a program, name it MAINMENU, and put the following code in it:
<P>
   SET SYSMENU OFF
   DO testmenu.mpr
   READ EVENTS
   SET SYSMENU TO DEFAULT

<P><LI>Create another program, name it CALLMENU, and put the following code in
   it:
<P>
   Keyboard "{F10}"
   Keyboard "{Rightarrow}"
   Keyboard "{Enter}"
   Keyboard "{dnarrow}"
   Keyboard "{dnarrow}"
   Keyboard "{dnarrow}"

<P><LI>Create a new menu named testmenu, and give it the following structure
   and prompts:
<P>
<PRE>   Prompt         Command
   -----------------------------------
   QUIT           CLEAR EVENTS
   FORMS          Submenu
     |
     +---Form 1   Wait Window "Form 1"
     +---Form 2   DO FORM FORM2

</PRE><P><LI>In Visual FoxPro, on the View menu, choose General Options, and select
   Cleanup. In FoxPro for Windows, on the Menu menu, choose General
   options, and select Cleanup.

<P><LI>In the Cleanup code, type:
<P>
   DO CALLMENU

<P><LI>Save and generate the menu.

<P><LI>Create a new form, name it FORM2, and place a command button on it. Put
   the following code in the command button's Click event:
<P>
   THISFORM.RELEASE
   DO CALLMENU

<P><LI>Run the MAINMENU program.
<P>
</OL>This should cause the menu prompt 'Form 2' to be highlighted. Pressing the
ENTER runs the form, and clicking the command button closes the form and
cycles the menu back to the 'Form 2' prompt.
<P>
This method can be called an unlimited number of times without running into
the 'Do nesting too deep' error message you may encounter if you use the
ACTIVATE MENU command. The other significant advantage is that the use of
the KEYBOARD command allows you to drill down to a specific menu option (in
this case, Form 2). The disadvantage to this method is that there is a
flicker as the keyboard commands are executed.
<P>
<P>
For information about how to do this with FoxPro 2.x, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q110909.htm">Q110909</A></B>
   TITLE     : How to Highlight a Menu Bar and Popup Programmatically
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin bar<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
