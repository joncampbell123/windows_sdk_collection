

<HTML>
<HEAD>
<TITLE>How to Add Information to Existing Data in a Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111312">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/02/09">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In order to use the REPLACE command to replace a field with the existing field contents plus more information, you must use the TRIM() function as part of the REPLACE statement. If the TRIM() function is not used, FoxPro seems to execute the replac...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QDO0,QAB9,QA5V,QAYY,QAHD,QAFI,QBV8,QA6A,QAK9,QABC,QAZV,QAZQ,QAXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Add Information to Existing Data in a Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111312</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, and 2.5b
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In order to use the REPLACE command to replace a field with the existing
field contents plus more information, you must use the TRIM() function as
part of the REPLACE statement. If the TRIM() function is not used, FoxPro
seems to execute the replacements; however, the table is not updated.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The contents of a field include any trailing blank spaces. When you attempt
to replace a field with its existing contents plus additional data, the
additional data will be concatenated to the end of the entire field
including the trailing blanks. Since this is longer than the defined length
of the field, the additional data will not be included when the field is
updated. In order to add data to the existing contents of a field, you must
remove the trailing blank spaces prior to adding the new data. You can
accomplish this with the TRIM() function.
<P>
The following program example is based on the assumption that C:\FOXPRO25
is the main FoxPro directory and that the TUTORIAL subdirectory and its
contents are installed as one of the subdirectories under FOXPRO25. In this
example, we will use CUSTOMER.DBF in the C:\FOXPRO25\TUTORIAL subdirectory
and will update all records that have "1st" in the COMPANY field to add
"Inc." to the end of this field.
<P>
NOTE: Before making any changes to the original database, use the COPY TO
command to make a backup copy of the existing database. Also, to find the
CUSTOMER database for this example, make sure that the default directory is
the main FoxPro directory.
<P>
<P><h3>Example</h3>
 

<OL><P><LI>Type the following in the Command window:
<P>
<P><PRE>      USE C:\FOXPRO25\TUTORIAL\customer
      COPY TO cust2.dbf
</PRE>
<P><LI>Type the following commands in the Command window:
<P>
<P><PRE>      SELECT CUSTOMER
      BROWSE
</PRE><P>
   Note that the first four records have COMPANY fields with "1st" in them.
<P>
   The COMPANY fields should be:
<P>
<P><PRE>      1st Computers
      1st Data Reductions
      1st Software Systems Ltd.
      1st Survey
</PRE>
<P><LI>Press ESC to close the Browse window on the CUSTOMER database.

<P><LI>Type the following REPLACE command in the Command window:
<P>
<P><PRE>     REPLACE company with TRIM(company)+" Inc." for "1st" $ company
</PRE><P>
   FoxPro will display the "4 replacements" message to indicate that the
   replacements were successful.

<P><LI>In the Command window, type the following:
<P>
<P><PRE>      GO TOP
      BROWSE
</PRE><P>
</OL>Note that the four records have changed.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.0 2.50 2.50a 2.50b<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
