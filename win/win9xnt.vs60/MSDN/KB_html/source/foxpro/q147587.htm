

<HTML>
<HEAD>
<TITLE>PRB: Trouble Browsing Table That Has Indexed DateTime Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147587">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1996/02/26">
<META NAME="Keywords" CONTENT="FxotherGeneral kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you add the date and time to Datetime fields in a table and then set an index on that datetime field, the records of table cannot be accessed properly because of the index. After issuing a SET ORDER TO command to turn the index off, the table ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QA7O,QA7N,QAU3,QAMR,QACI,QACE,QAFH,QA9N,QA5V,QAH4,QAJZ,QDO0,QBI8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Trouble Browsing Table That Has Indexed DateTime Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147587</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you add the date and time to Datetime fields in a table and then
set an index on that datetime field, the records of table cannot be
accessed properly because of the index. After issuing a SET ORDER TO
command to turn the index off, the table behaves correctly.
<P>
<P><h2>CAUSE</h2>
 
<P>
This seems to be a problem when the time of several fields is the same.
When the datetime field has different times every so often, the index works
correctly.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If the index is created on the Datetime field before replacing or inserting
the date and time, there seems to be no problem. If there is a pause
between replacing or inserting to the Datetime field, the index also works
correctly. For example, if a FOR loop is placed in the code below so that
there is a small delay in time between replacing or inserting, the
index works correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There can be a problem if the REPLACE command is issued to place dates and
times in the datetime field of several records at the same time. When the
REPLACE command is issued, the time of the datetime fields can all be the
same time depending on the speed of the computer. If an index is issued on
the datetime field, then the table cannot be browsed or sent to a certain
record until the index is turned off. There are no errors when trying to
move through the table; any action is just ignored. If you use the DATE()
function to populate the Datetime field, nothing seems to go wrong even
though the time of all Datetime fields will 12:00:00 AM, which is the
default if no time is specified. This can also happen with the INSERT
command when inserting several records at one time. Creating the index on
the Datetime field before replacing or inserting the date and time will
correct the problem.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Create a program and add the following code:
<P>
<PRE>   CREATE TABLE datetime  (fld1 T)
   FOR x = 1 to 200
      INSERT INTO datetime VALUES (DATETIME())
   ENDFOR
   INDEX on fld1 TAG fld1
   BROWSE

</PRE>Try paging down through the Browse window. After one or more pages scroll
down, the browse stops; then paging up and down can only be done on that
current page.
<P>
Move the line of code that indexes the table above the FOR loop. Now the
browse will work correctly.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxotherGeneral<BR>
Keywords          : FxotherGeneral kbprb kbprg<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
