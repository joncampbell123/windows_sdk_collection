

<HTML>
<HEAD>
<TITLE>How To Set Up OLE Automation in Visual FoxPro 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156014">
<META NAME="KBModify" CONTENT="1997/01/20">
<META NAME="KBCreate" CONTENT="1996/09/13">
<META NAME="Keywords" CONTENT="kbusage kbprg kbole kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article discusses the registry settings required for OLE Automation and how to set them if you do not use the Setup Wizard.  MORE INFORMATION  OLE Automation works if you install a product correctly or you use the Setup Wizard (assuming you ch...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QA2K,QDI2,QA9Q,QANN,QAJG,QDNN,QBVX,QBVV,QA56,QA55,QAXB,QALM,QAH5,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Set Up OLE Automation in Visual FoxPro 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156014</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses the registry settings required for OLE Automation
and how to set them if you do not use the Setup Wizard.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
OLE Automation works if you install a product correctly or you use the
Setup Wizard (assuming you choose an OLE Server).
<P>
The Setupwiz.xls file lists the files installed for certain options. This
is the best way to view which files you need.
<P>
There are circumstances that may affect the proper functioning of
automation servers. You can usually remedy these circumstances with the
following.
<P>
<P><h3>Local Automation</h3>
 
<P>
You do not need extra files for remote automation except for the servers
themselves. Primarily, you need the Oleaut32.dll file, which is installed
by Visual FoxPro, the Setup Wizard, and Windows.
<P>
<P><h3>Registering OLE Servers Locally</h3>
 
<P>
Simply building an OLE server (.exe or .dll file) via the Project Manager
or BUILD command automatically registers the server on that machine. If you
want to copy the OLE server to another machine (not via the Setup Wizard)
and register it, you should do the following:

<OL><P><LI>Copy the server (.exe or .dll file) and its .tlb and .vbr files to the
   new machine.
<P>
   NOTE: The .tlb and .vbr files are not required, but you should copy them
   in case they are needed later by certain components.
<P>
   The .tlb file is the Type Library that certain OLE clients can read. The
   .vbr file allows you to do a remote registration using the Microsoft
   Client Remote Server Registration component (Clireg32).

<P><LI>Register the server on the new machine with the following code:
<P>
<P><PRE>      For EXEs, use the /RegServer switch
<PRE></PRE>        ex. myexesvr.exe /RegServer

      For DLLs, use RegSvr32
        ex. RegSvr32 mydllsvr.dll

</PRE></OL><h3>Remote Automation</h3>
 
<P>
Remote automation requires several components in addition to the server
files to work correctly, including the following Automation Proxy and
Automation Manager files:
<P>
<PRE>   Autprx32.dll
   Autmgr32.exe

</PRE><h3>Registering OLE Servers Locally</h3>
 
<P>
There are several ways to register a remote automation server. The easiest
is to use the Remote Automation Connection Manager (RacMan). You must first
have the server registered locally. RacMan uses the following files:
<P>
<PRE>   Racmgr32.exe
   Racreg32.dll
   Vb40032.dll
   Odkob32.dll
   Comctl32.dll

</PRE>You can also use the Clireg32.exe component to register a server remotely.
All that is required to use the Clireg32.exe component is the .vbr file.
<P>
<P><h3>Updating a Server</h3>
 
<P>
It is always a good idea to reregister a server when you update it. If you
are using the Project Manager, the BUILD EXE command, or the BUILD DLL
command, the server is automatically updated on that machine.
<P>
NOTE: You can choose the Generate New Registry IDs option to re-create new
GUIDs for the server settings.
<P>
You can reregister servers on other remote machines using the techniques
described above. These techniques include the Setup Wizard, the RacMan
component, the RegSvr32 component, and the CliReg32 component.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbprg kbole kbhowto<BR>
KBSubcategory: FxinteropOle<BR>
Additional reference words: 5.00 kbdse vFoxWin register CLIREG32 Remote<BR>
Local
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
