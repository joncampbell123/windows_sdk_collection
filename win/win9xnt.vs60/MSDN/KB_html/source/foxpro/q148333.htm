

<HTML>
<HEAD>
<TITLE>How to Create a Multiple-Select Mover List Box Using Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148333">
<META NAME="KBModify" CONTENT="1996/03/14">
<META NAME="KBCreate" CONTENT="1996/03/11">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In many examples and documentation showing the List Control in Visual FoxPro, you may see a mover list or multiple-select mover list shown. To see the code for a mover list box, type the following command in the Command window, and select Sample.vc...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBVR,QACI,QAPN,QAO4,QBWS,QA7O,QAPF,QABG,QAJP,QAE1,QA9N,QA7N,QAY2,QANJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a Multiple-Select Mover List Box Using Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 14, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148333</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In many examples and documentation showing the List Control in Visual
FoxPro, you may see a mover list or multiple-select mover list shown. To
see the code for a mover list box, type the following command in the
Command window, and select Sample.vcx in the open dialog window:
<P>
<PRE>   MODIFY CLASS ? OF C:\Vfp\Samples\Controls\Samples.vcx

</PRE>Then select Moverlist under Classname. Code can be used from the
Samples.VCX to create your own mover list box. The code in this article
illustrates this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code creates a mover list box that stores the field names of
a table in a list box. The values can then be moved into a second list box.
A BROWSE FIELDS statement is then issued based on the contents of the
second list box.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a new form, and add a table to the Data Environment.

<P><LI>Set the AutoOpenTables and the AutoCloseTables properties values in the
   Data Environment to false (.F.).

<P><LI>Place the following code in the Init event of the form:
<P>
<PRE>   PUBLIC blist        &amp;&amp; variable used in the Browse Button
   blist=''
   USE &lt;tablename&gt;
   FOR gnCount = 1 TO FCOUNT( )   &amp;&amp; Loop for number of fields
      THISform.list1.ADDITEM(Field(gnCount))
   NEXT

</PRE><P><LI>Place the following code in the Doubleclick event of the List1 box:
<P>
   Thisform.Lockscreen=.T.
   nCnt = 1
   DO WHILE nCnt &lt;= Thisform.List1.ListCount
<P><PRE>      IF Thisform.List1.Selected(nCnt)
<PRE></PRE>         Thisform.List2.AddItem(Thisform.List1.List(nCnt))
         Thisform.List1.RemoveItem(nCnt)
      ELSE
         nCnt = nCnt + 1
      ENDIF
   ENDDO
   Thisform.Lockscreen=.F.

</PRE><P><LI>Place the following code in the Doubleclick event of the List2 box:
<P>
   Thisform.Lockscreen=.T.
   nCnt = 1
   DO WHILE nCnt &lt;= thisform.list2.ListCount
<P><PRE>      IF Thisform.List2.Selected(nCnt)
<PRE></PRE>         Thisform.List1.AddItem(Thisform.List2.List(nCnt))
         Thisform.List2.RemoveItem(nCnt)
      ELSE
         nCnt = nCnt + 1
      ENDIF
   ENDDO
   Thisform.Lockscreen=.F.

</PRE><P><LI>Place the following code in the Click event of a command button to
   move a selection from List1 to List2 ( &gt; ):
<P>
   Thisform.Lockscreen=.T.
   cnt=Thisform.List1.Listindex
   IF Thisform.List1.Selected(cnt) = .T.
<P><PRE>     nCnt = 1
     DO WHILE nCnt &lt;= Thisform.List1.ListCount
      IF Thisform.List1.Selected(nCnt)
<PRE></PRE>        Thisform.List2.AddItem(Thisform.List1.List(nCnt))
        Thisform.List1.RemoveItem(nCnt)
      ELSE
        nCnt = nCnt + 1
      ENDIF
     ENDDO
   ELSE
     =MESSAGEBOX('Please Highlight Your Choice')
   ENDIF

   Thisform.Lockscreen=.F.

</PRE><P><LI>Place the following code in the Click event of a command button to move
   all the values from the List1 to List2 ( &gt;&gt; ):
<P>
   Thisform.LockScreen = .T.
   FOR i = 1 to Thisform.List1.ListCount
<P><PRE>      Thisform.List2.AddItem(Thisform.List1.List(i))
</PRE>   ENDFOR
   Thisform.list1.Clear
   Thisform.LockScreen = .F.

<P><LI>Place the following code in the Click event of a command button to move
   a selection from List2 to List1 ( &lt; ):
<P>
   Thisform.Lockscreen=.T.
   cnt=Thisform.List2.Listindex
   IF Thisform.List2.Selected(cnt) = .T.
<P><PRE>      nCnt = 1
</PRE>   DO WHILE nCnt &lt;= Thisform.List2.ListCount
<P><PRE>    IF Thisform.List2.Selected(nCnt)
     Thisform.List1.AddItem(Thisform.List2.List(nCnt))
     Thisform.List2.RemoveItem(nCnt)
    ELSE
     nCnt = nCnt + 1
    ENDIF
</PRE>   ENDDO
   ELSE
   =MESSAGEBOX('Please Highlight Your Choice')
   ENDIF
   Thisform.Lockscreen=.F.

<P><LI>Place the following code in the Click event of a command button to move
   all the values from List2 to List1 ( &lt;&lt; ):
<P>
   Thisform.LockScreen = .T.
   FOR i = 1 to thisform.list2.ListCount
<P><PRE>     Thisform.List1.AddItem(Thisform.List2.List(i))
</PRE>   ENDFOR
   Thisform.List2.Clear
   Thisform.LockScreen = .F.

<P><LI>Place The Following Code In The Click event of a Browse button:
<P>
<P><PRE>    blist=''
    bval=''
    Thisform.LockScreen = .T.
    FOR x = 1 to Thisform.List2.Listcount
      IF x=1
<PRE></PRE>         blist=Thisform.List2.List(x)
      ELSE
         blist=','+Thisform.List2.List(x)
      ENDIF
         bval=bval+blist
    ENDFOR
    Thisform.LockScreen = .F.
    BROWSE FIELDS &amp;bval

</PRE><P><LI>Place the following code in the click event of an Exit button:
<P>
<P><PRE>    USE
    Thisform.Release
</PRE>
<P><LI>Run the form.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about mover list boxes, please see the following
article in theMicrosoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q142190.htm">Q142190</A></B>
   TITLE     : How to Create Mover List Boxes in Visual FoxPro
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 14, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
