

<HTML>
<HEAD>
<TITLE>BUG: OBJVAR() Returns Incorrect Values When Used in Screen </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123005">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/11/17">
<META NAME="Keywords" CONTENT="kbtool kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When used in a screen, OBJVAR() returns incorrect values for a current or specified Screen object that has a preceding Push/Radio button object with more than one prompt as following:  1. A NULL value is returned if the current or specified Screen ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBUN,QAPN,QAW6,QANE,QAUD,QA7R,QAH4,QAA8,QBNK,QAYL,QBBI,QACF,QBII,QADX,QADN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: OBJVAR() Returns Incorrect Values When Used in Screen</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123005</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6
<LI>Microsoft FoxPro for MS-DOS, version 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When used in a screen, OBJVAR() returns incorrect values for a current or
specified Screen object that has a preceding Push/Radio button object with
more than one prompt as following:

<OL><P><LI>A NULL value is returned if the current or specified Screen Object is
   immediately preceeded by a Push/Radio button that has more than one
   Prompt.

<P><LI>The name of the memory variable, array element, or field associated with
   the object Preceeding the current or specified object, if the
   Current/Specified object and the Preceding Push/Radio button object have
   one or more screen objects between them.

<P><LI>If two radio buttons exist on a screen, a NULL value is returned by the
   OBJVAR() function for objects past the 2nd radio button.

<P><LI>The OBJVAR() function inconsistently returns a NULL for objects past
   approximately 20 objects (other than radio buttons).
<P>
</OL><h2>RESOLUTION</h2>
 
<P>
You can use one of the following methods to work around this situation:

<OL><P><LI>Do not use Radio or Push button objects with multiple prompts before or
   after the object for which you do not want OBJVAR() to return a NULL.
   Instead, create a separate Radio or Push Button object for each of the
   prompt that needs to be defined.

<P><LI>Use VARREAD() or SYS(18) functions instead of OBJVAR().
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new screen by using this command:
<P>
<P><PRE>      MODIFY SCREEN TEST.SCR
</PRE>
<P><LI>Create a Push Button or a Radio Button object by using this program:
<P>
<P><PRE>      Type = Normal
      Push/Radio Button Prompts = ONE; TWO
      Variable = MOBJ1
      Options = Horizontal/Vertical
      Place the following code in the Valid clause:
<PRE></PRE>           DO CASE
               CASE MOBJ1=1
                  WAIT WINDOW "ONE"
               CASE MOBJ1=2
                  WAIT WINDOW "TWO"
           ENDCASE

</PRE><P><LI>Create a Field Object by using this code:
<P>
<P><PRE>      Input Field = GET
      Input = MOBJ2
      OPTIONS = Select Field on Entry
</PRE>
<P><LI>Create another Push/Radio button similar to the one described in Step 2,
   except use MOBJ3 as the variable name.

<P><LI>Place the following code in the "Screen Setup Code" clause:
<P>
<P><PRE>      ON KEY LABEL ALT+O WAIT WINDOW "OBJVAR() = "+OBJVAR()
</PRE>
<P><LI>Place "ON KEY" command in the "On Screen Exit (Valid)" clause.

<P><LI>Generate the Screen, and run it using the RUN command.

<P><LI>Select the First Push/Radio Button (1st Screen Object), and press ALT+O.
   "OBJVAR() = MOBJ1" will be displayed in the wait window. So far OBJVAR()
   is working correctly.

<P><LI>Select The Get Field (2nd Screen Object). Then press ALT+O. Only
   "OBJVAR() =" is displayed in the wait window. This means OBJVAR()
   returned a NULL value. This step produces the first symptom.

<P><LI>Select the second Push/Radio Button (3rd Screen Object), and press
<P><PRE>    ALT+O. This time "OBJVAR()= MOBJ2" will be displayed in the Wait Window
    instead of "OBJVAR()= MOBJ3." This goes to prove that OBJVAR() is
    returning the variable name for the previous object (2nd Screen Object)
    instead of the current screen object (3rd Screen Object). This step
    produces the second symptom.
</PRE>
<P><LI>Exit the Screen. Then open it by using the "MODIFY SCREEN" command.

<P><LI>Change the first Push/Radio Buton (1st Screen Object) by using this
<P><PRE>    code:
</PRE><P>
<P><PRE>       Type = Normal
       Push/Radio Button Prompts = ONE
       Variable = MOBJ1
       Options = Horizontal/Vertical
       Valid = WAIT WINDOW "ONE"
</PRE>
<P><LI>Generate and run the Screen.

<P><LI>Repeat steps 8 thru 10. Notice that OBJVAR() now returns correct'
<P><PRE>    information because none of the Screen objects are preceeded by a
    Push/Radio Button with more than two prompts.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos 2.60 buglist2.60 SBuilder<BR>
KBCategory: kbtool kbprg kbbuglist<BR>
KBSubcategory: FxtoolSbuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
