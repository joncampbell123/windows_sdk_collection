

<HTML>
<HEAD>
<TITLE>PRB: ActiveX MAPI Control 5.0 Causes Memory Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175768">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1997/10/28">
<META NAME="Keywords" CONTENT="FxinteropOcx vfoxwin AXSDKControls">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you add a MAPISession control version 5.0 or a MAPIMessages control version 5.0 to a form and then edit the (Messaging Application Programming Interface) MAPI control properties, a memory corruption error appears.  RESOLUTION  One possible res...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAPN,QBWS,QAB4,QAHV,QAAP,QAL7,QAD7,QA3J,QA3I,QAEV,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ActiveX MAPI Control 5.0 Causes Memory Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175768</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you add a MAPISession control version 5.0 or a MAPIMessages control
version 5.0 to a form and then edit the (Messaging Application Programming
Interface) MAPI control properties, a memory corruption error appears.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
One possible resolution is to copy the older Msmapi32.ocx version 1.0.2815
from another computer that is currently running Visual FoxPro version 5.0
or extract the file from the Visual FoxPro 5.0 install disks.
<P>
For additional information on using the extract utility, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q135518.htm">Q135518</A></B>
   TITLE     : HOWTO: Copy Files from Cabinets on DMF-Formatted Disks

</PRE>NOTE: This resolution will only work as long as another application does
not install version 5.0 of the Msmapi32.ocx over version 1.0.2815. These
applications may include Visual Basic version 5.0, Visual FoxPro for
Windows version 5.0a or an executable file created by one of these
applications.
<P>
NOTE: This error has not been corrected in Service Pack 1 or Service Pack
2.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Once you try to edit or make changes to any of the MAPISession control or
MAPIMessages control specific properties, the following error is displayed:
<P>
<PRE>   OLE Idispatch exception code 0 from MAPISession: Property is write-only.

</PRE>-or-
<P>
<PRE>   OLE Idispatch exception code 0 from MAPIMessages: Property is
   write-only.

</PRE>This will not prevent the control from being edited. Click OK and then
right-click the control to display the short-cut menu. Choose MAPISession
or MAPIMessage Properties to open the Property Pages dialog box. Change one
of the properties then click Apply or OK. In Windows 95, the following
error message appears:
<P>
<PRE>   This program performed an illegal operation and will be shut down.

</PRE>After clicking the Details push button, the following message appears:
<P>
<PRE>   VFP caused and invalid pagefault in module KERNEL32.DLL at &lt;register
   address&gt;.

</PRE>In Windows NT 4.0, the following error appears:
<P>
<PRE>   An application error had occurred and an application error log is
   being generated.
   VFP.EXE
   Exception: access violation.

</PRE>NOTE: If you get this error multiple times, the error log file may get
larger. You may delete the User.dmp file to free up the space used by this
log file.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following two methods reproduce the application error.
<P>
Method 1:

<OL><P><LI>Create a new form.

<P><LI>In the Tools Options menu, click the Controls tab. Click ActiveX
   controls, then scroll down the list and select both Microsoft MAPI
   Messages Control, version 5 and Microsoft MAPI Session Control, version
   5. Click OK.

<P><LI>On the Form Controls toolbar, click the View Classes button and select
   ActiveX Controls.

<P><LI>Click one of the MAPI controls and add it to the form.

<P><LI>Save and run the form.

<P><LI>Modify the form. Right-click on the control. The write-only message
   described appears. Click OK. Right-click the control again and
   select Microsoft MAPI Message (or Session) Control Properties.

<P><LI>Change any of the properties and choose OK or Apply.
<P>
</OL>Method 2:

<OL><P><LI>Follow steps 1-3 in Method 1 above.

<P><LI>Before you add one of the MAPI ActiveX controls to the form, close the
   Properties sheet of the form if it is open.

<P><LI>Click one of the MAPI controls and add it to the form.

<P><LI>Right-click on the control and select Microsoft MAPI Message (or
   Session) Control Properties.

<P><LI>Make a change to any of the properties and click OK.

<P><LI>Click on the form to re-gain focus. Right-click on the form and choose
</OL>Properties to open the Properties sheet.

<OL><P><LI>Right-click on the MAPI control again. The write-only message described
   above appears. Click OK. Right-click the control again and select
   Properties.

<P><LI>Change any of the properties and click OK or Apply.
<P>
</OL>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by Dean
Christopher,
Microsoft Corporation
 
<PRE>Keywords          : FxinteropOcx vfoxwin AXSDKControls
Version           : WINNT:97
Platform          : winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
