

<HTML>
<HEAD>
<TITLE>PRB: WordBasic's CHR$ Function Produces Error in Visual FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156939">
<META NAME="KBModify" CONTENT="1996/10/29">
<META NAME="KBCreate" CONTENT="1996/10/03">
<META NAME="Keywords" CONTENT="kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Visual FoxPro produces one of the following three errors when using the CHR$(11) function to place a newline character in a Microsoft Word 7.0a for Windows 95 document:     OLE IDispatch exception code 5004 from Microsoft Word. Too    many or too f...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QAIH,QAY5,QAH4,QA56,QA55,QAAP,QAB4,QBXT,QA5V,QAIB,QBV8,QAB9,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: WordBasic's CHR$ Function Produces Error in Visual FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156939</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Visual FoxPro produces one of the following three errors when using the
CHR$(11) function to place a newline character in a Microsoft Word 7.0a for
Windows 95 document:
<P>
<PRE>   OLE IDispatch exception code 5004 from Microsoft Word. Too
   many or too few arguments.

   -or-

   OLE error code 0x80002006 Unknown name.

   -or-

   Syntax Error.

</PRE>The error varies depending upon the version of Visual FoxPro being run.
However, these commands function properly in Visual Basic 4.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
The dollar sign ($) character is an operator in Visual FoxPro. Therefore,
FoxPro expects the dollar sign character to carry out Xbase functionality
and not a WordBasic function.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use FoxPro's CHR() function to insert the value into WordBasic. For
example, replace one of the following lines:
<P>
<PRE>   X.Insert(X.CHR$(11))

   -or-

   X.Insert(X.Object.CHR$(11))

</PRE>with the following line:
<P>
<PRE>   X.Insert(CHR(11))

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The WordBasic function Chr$(11) should place a newline character in a Word
95 document. However, when FoxPro sees the dollar sign character, it looks
for the two arguments normally required for this function. Usually, Visual
FoxPro interprets a dollar sign character to mean search for a value within
a string or field. Visual FoxPro does not recognize the Word 95 usage of
this character.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a program containing the following code:
<P>
<P><PRE>      PUBLIC x
      X=CreateObject("Word.Basic")
      X.FileNew
      X.AppShow
      X.Insert("This is line 1")
<PRE></PRE>      X.Insert(X.CHR$(11))   &amp;&amp; &lt;---Or X.Insert(X.Object.CHR$(11))
      X.Insert("This is line 2")

</PRE><P><LI>Run the program. The error appears.

<P><LI>Replace the X.Insert(X.CHR$(11)) or X.Insert(X.Object.CHR$(11)) line
   with X.Insert(CHR(11)). The code now creates a Word document containing
   two lines of text.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbprb<BR>
KBSubcategory: FxinteropOle FxinteropWinword<BR>
Additional reference words: 3.00 3.00b 5.00 kbdsd VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
