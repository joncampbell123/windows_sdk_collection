

<HTML>
<HEAD>
<TITLE>PRB: Menus Behave Differently in OS 8 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176729">
<META NAME="KBModify" CONTENT="1997/11/26">
<META NAME="KBCreate" CONTENT="1997/11/13">
<META NAME="Keywords" CONTENT="FoxMac FxenvOs FxprgGeneral VFoxMac">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Menu pads, also known as Menu titles, that do not have a submenu associated with them, will not work with a single mouse click when used in FoxPro with Macintosh OS 8. These menu pads require a double-click.  CAUSE =====  This behavior is caused by...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QAF0,QAEB,QAO2,QALW,QAGC,QBWR,QAMB,QAH4,QACF,QDIR,QBWS,QAFX,QAG9,QDO9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Menus Behave Differently in OS 8</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176729</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft FoxPro for Macintosh, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Menu pads, also known as Menu titles, that do not have a submenu associated
with them, will not work with a single mouse click when used in FoxPro with
Macintosh OS 8. These menu pads require a double-click.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is caused by a change to the Macintosh operating system with
OS 8. The system now has sticky menus that stay down when a menu title is
clicked. Previously, the menu would not stay down when the title was
clicked.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use submenus with all menu titles (menu pads).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DEFINE PAD command is used to create menu titles on menu bars. If there
is not a menu associated with the menu title, the ON SELECTION PAD command
is used to specify a command that executes when the menu title is selected.
Alternatively, if a menu title has a menu associated with it, the ON PAD
command is used to activate the popup and its bars that make up the menu.
Both menu scenarios are illustrated in the sample program below in the
Steps to Reproduce Behavior section.
<P>
Generating a menu created in the Menu Designer produced the code used in
the sample program. The code was copied from the .mpr file created when the
menu was generated. The randomly generated names for the menu titles were
changed to p1 and p2. The menu title that uses the ON SELECTION PAD command
requires the double-click for its command to execute, which has Hello as
the prompt.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Type the following code into a new program file and then run the program
   file:
<P>
<P><PRE>      SET SYSMENU TO
      SET SYSMENU AUTOMATIC
</PRE><P>
<P><PRE>      DEFINE PAD p1 OF _MSYSMENU PROMPT "Hello" COLOR SCHEME 3 ;
<PRE></PRE>              KEY ALT+H, ""
      DEFINE PAD p2 OF _MSYSMENU PROMPT "Get Back To Normal" ;
              COLOR SCHEME 3 KEY ALT+G, ""
      ON SELECTION PAD p1 OF _MSYSMENU WAIT WINDOW "Hello"
      ON PAD p2 OF _MSYSMENU ACTIVATE POPUP getbackton

      DEFINE POPUP getbackton MARGIN RELATIVE SHADOW COLOR SCHEME 4
      DEFINE BAR 1 OF getbackton PROMPT "Red"
      DEFINE BAR 2 OF getbackton PROMPT "Blue"
      DEFINE BAR 3 OF getbackton PROMPT "Quit"
      ON SELECTION BAR 1 OF getbackton WAIT WINDOW "Red"
      ON SELECTION BAR 2 OF getbackton WAIT WINDOW "Blue"
      ON SELECTION BAR 3 OF getbackton SET SYSMENU TO DEFAULT

   The program should display a menu with a Hello pad and a "Get Back To
   Normal" pad.

</PRE><P><LI>Click the Hello pad and release the mouse button. If you are running
   FoxPro under OS 8, the menu pad will highlight. If you click the menu
   pad again, a WAIT WINDOW with "Hello" appears. With the Macintosh
   operating systems earlier than OS 8, the WAIT WINDOW "Hello" appears
   with the first click of the menu pad.

<P><LI>Try the "Get Back To Normal" menu pad. When the menu pad is clicked, the
   drop-down menu appears. Once the menu is down, the commands on the menu
   can be selected. With the Macintosh operating systems earlier than OS 8,
   the menu does not stay down when the mouse button is released. Select
   the Quit command to get the FoxPro menu back.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual FoxPro Help, version 3.0b; topics: Define Pad, On Selection Pad, On
Pad, Define Popup
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : FoxMac FxenvOs FxprgGeneral VFoxMac<BR>
Version           : MACINTOSH:2.6a,3.0b<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
