

<HTML>
<HEAD>
<TITLE>FIX: Error Occurs When Remove Object That Has Pending Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134977">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/08/14">
<META NAME="Keywords" CONTENT="FxprgGeneral kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a new form or a form that has been recently modified is instantiated for the first time by using the DO FORM            command or by any other means, the user sees an error message and Visual FoxPro closes.   - In Windows for Workgroups versi...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QAB4,QBWO,QAAP,QAW6,QAGI,QAEF,QACI,QA56,QA55,QAVX,QAVW,QAO4,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Error Occurs When Remove Object That Has Pending Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134977</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a new form or a form that has been recently modified is instantiated
for the first time by using the DO FORM &lt;formname&gt; command or by any other
means, the user sees an error message and Visual FoxPro closes.

<UL><LI>In Windows for Workgroups version 3.11, the error is a Win32S error.

<LI>In Windows NT, the error is an Application error.

<LI>In Windows 95, the error is an illegal operation error similar to this
   one:
<P>
<P><PRE>      This program has performed an illegal operation and will be shut
      down. If the problem persists, contact the program vendor.
</PRE><P>
   The details presented in Windows 95 are similar to this:
<P>
<P><PRE>      Visual FoxPro caused an invalid page fault in module VFP.EXE at
      0137:0040dbc5."
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
In one of the methods of one (or more) of the objects, the developer has
placed at least one command in the code call stack. (The code call stack is
a list of pointers to Visual FoxPro commands that will run when a specified
event takes place.) The code placed in the call stack is triggered by a
specific event. In this case, the specific event takes place during the
form load procedure.
<P>
That triggered code, or other code in a method of one of the other objects
on the form, removes the object and its methods from the form. Therefore,
when the pointer in the call stack triggers the code, the problem occurs
because the owning object, along with the code, has been removed.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There may be times when the developer needs to have an object rendered
invisible to the user. Rather than issuing a REMOVEOBJECT, the developer
can set the object's visible property to false (.F.).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0b for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In the Command window of Visual FoxPro, issue this command:
<P>
   MODIFY FORM TEST

<P><LI>In the Form Designer, place a command button on Form1.

<P><LI>In the Refresh method of the command button, enter this line of code:
<P>
   THISFORM.REMOVEOBJECT(This.Name)

<P><LI>Save the form definition as TEST, and close the Form Designer.

<P><LI>In the Command window, issue this command:
<P>
   DO FORM TEST
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin fixlist3.00b buglist3.00<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>
Keywords          : FxprgGeneral kbbuglist kbfixlist kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
