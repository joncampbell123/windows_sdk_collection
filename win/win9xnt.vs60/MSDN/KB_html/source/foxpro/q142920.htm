

<HTML>
<HEAD>
<TITLE>How to Create Unique Values on SQL Server 6.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142920">
<META NAME="KBModify" CONTENT="1996/01/23">
<META NAME="KBCreate" CONTENT="1996/01/22">
<META NAME="Keywords" CONTENT="kbinterop kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  SQL Server 6.0 has a new Identity property that can be used to create a unique value for each row in a table. The identity property allows the user to specify a seed value and an increment value. This article gives example code that shows how to us...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBE7,QBE6,QAKD,QACI,QA9N,QAEN,QALW,QAPN,QAKC,QASR,QABM,QAI4,QBG2,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create Unique Values on SQL Server 6.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142920</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SQL Server 6.0 has a new Identity property that can be used to create a
unique value for each row in a table. The identity property allows the user
to specify a seed value and an increment value. This article gives example
code that shows how to use the new Identity property.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Identity property must be used with an integer datatype. (int,
smallint, or tinyint). Only one identity column is allowed per table.
Identity columns cannot be updated and won't accept NULL values.
<P>
<P><h3>Sample Code</h3>
 
<P>
This example creates an Invoice table that has a starting invoice number of
1000 and increments by 1 for each new invoice record inserted.
<P>
* Establish connection to an existing datasource define to a SQL Server 6.0
* database.
<P>
<PRE>  xhandle = sqlconnect()
  IF xhandle &gt; 0
    WAIT WINDOW "Successfull Connection. Handle = "+str(xhandle)
  ELSE
    WAIT WINDOW "Bad connection."
    =errhand()
    RETURN
  ENDIF

</PRE>* Create a table called Invoice and define the Identity property for the
* Invoice_no column - assuming that a table called invoice does not already
* exist.
<P>
<PRE>  x = SQLExec(xhandle,"Create table invoice (invoice_no INT" + ;
     "identity(1000,1),customer varchar(25),;
     amount money, inv_date datetime)")

  IF x &lt; 0
    =errhand()
    RETURN
  ELSE
    WAIT WINDOW "Table created successfully"
  ENDIF

</PRE>* Insert some new invoices.
<P>
<PRE>  x = SQLExec(xhandle,"Insert invoice (customer,amount,inv_date)" + ;
   " Values('Brown &amp;  Assoc.',$40000,'01/01/96' )")

  IF x &lt; 0
    =errhand()
    RETURN
  ENDIF

  x = SQLExec(xhandle,"Insert invoice (customer,amount,inv_date)" + ;
   "Values('Jones Inc.',$90000,'01/01/96' ) ")

  IF x &lt; 0
    =errhand()
    RETURN
  ENDIF

  x = SQLExec(xhandle,"Insert invoice (customer,amount,inv_date)" + ;
   "Values('Golden Hedge',$25000,'01/01/96' )")

  IF x &lt; 0
    =errhand()
    RETURN
  ENDIF

  x = SQLExec(xhandle,"Insert invoice (customer,amount,inv_date)" + ;
   "Values('CPUs R Us',$50000,'01/01/96' )")

  IF x &lt; 0
    =errhand()
    RETURN
  ENDIF

</PRE>* Check the values inserted.
<P>
<PRE>  x = SQLExec(xhandle,"Select * from invoice","Invoice")

  IF x &lt; 0
    =errhand()
    RETURN
  ENDIF

  SELECT Invoice
  GO TOP
  BROWSE

</PRE>* Disconnect.
<P>
<PRE>  x = SQLDisconnect(xhandle)

  IF x &lt; 0
    =errhand()
    RETURN
  ENDIF

</PRE>* Error Handling Procedure
<P>
<PRE>  PROCEDURE errhand

    =AERROR(myerror)
    CLEAR
    ? 'An error has occurred.'
    FOR n = 1 TO 7
      ? myerror(n)
    ENDFOR
    =SQLDisconnect(xhandle)

  RETURN
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbinterop kbhowto kbcode<BR>
KBSubcategory: FxinteropOdbc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
