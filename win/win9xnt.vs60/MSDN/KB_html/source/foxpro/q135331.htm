

<HTML>
<HEAD>
<TITLE>PRB: ALTER COLUMN Clause Applies Only to First SET After It </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135331">
<META NAME="KBModify" CONTENT="1995/08/22">
<META NAME="KBCreate" CONTENT="1995/08/20">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The command below sets the default value for the maxordamt field to 500 and the row level validation rule to maxordamt &gt;10. It does not set the field validation rule to maxordamt &gt;10 as you would expect:     ALTER TABLE customer ALTER COLUMN maxord...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QAKR,QA7O,QA7N,QAPF,QABH,QABI,QAIB,QAE1,QAPN,QABA,QDMN,QBWS,QBV8,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ALTER COLUMN Clause Applies Only to First SET After It</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 22, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The command below sets the default value for the maxordamt field to 500 and
the row level validation rule to maxordamt &gt;10. It does not set the field
validation rule to maxordamt &gt;10 as you would expect:
<P>
<PRE>   ALTER TABLE customer ALTER COLUMN maxordamt SET DEFAULT 500 ;
      SET CHECK maxordamt &gt;10

</PRE><h2>CAUSE</h2>
 
<P>
The ALTER TABLE command uses SET CHECK to set field and row level
validation. Each SET CHECK that applies to a field must be preceded by
ALTER COLUMN to distinguish it from row level validation.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
For each property of a field you wish to SET, issue a separate ALTER
COLUMN. A separate ALTER COLUMN must also be issued for each DROP.
<P>
To set the default and the field level validation for the maxordamt, use
this command:
<P>
<PRE>   ALTER TABLE customer ALTER COLUMN maxordamt SET DEFAULT 500 ;
      ALTER COLUMN SET CHECK maxordamt &gt;10

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>To see the difference between the two commands, open and modify the
   Testdata database in the Samples\Data directory.

<P><LI>Issue the first command in the Command window (see the Symptoms section
   earlier in this article).

<P><LI>Using the secondary mouse button, click the Customer table in the
   Database Designer window, and select Modify.

<P><LI>Select the maxordamt field. The default value is 500, but no validation
   rule has been set.

<P><LI>Click the table properties button. The validation rule has been set.

<P><LI>Delete both rules and answer Yes to modify structure.

<P><LI>Issue the second command in the Command window (see the Resolution
   section earlier in this article).

<P><LI>Using the secondary mouse button, click the customer table in the
   Database Designer window, and select Modify.

<P><LI>Select the maxordamt field. The default value is 500, and the validation
   rule under field properties now shows maxordamt&gt;0. There should not be a
   validation rule showing under table properties.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 22, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
