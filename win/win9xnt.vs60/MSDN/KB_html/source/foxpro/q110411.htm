

<HTML>
<HEAD>
<TITLE>BUG: "Invalid Excel File Format" with IMPORT Command </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110411">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/01/20">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="   You receive the  Invalid Excel File Format  error message when you are importing a Microsoft Excel version 5.0 file into FoxPro.  NOTE: In FoxPro 2.0 for MS-DOS, you will get the error message  Invalid Excel version 2.0 file  when you are importin...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: "Invalid Excel File Format" with IMPORT Command</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110411</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a and 2.5b
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a and 2.5b
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You receive the "Invalid Excel File Format" error message when you are
importing a Microsoft Excel version 5.0 file into FoxPro.
<P>
NOTE: In FoxPro 2.0 for MS-DOS, you will get the error message "Invalid
Excel version 2.0 file" when you are importing worksheets in Microsoft
Excel 3.0, 4.0, or 5.0 file format.
<P>
<P><h2>CAUSE</h2>
 
<P>
With each release of Microsoft Excel, the file format that Microsoft Excel
uses has changed. FoxPro 2.0 can import only Microsoft Excel 2.0 files.
FoxPro 2.5 for MS-DOS, Windows, and the Macintosh can import files in the
Microsoft Excel 2.0, 3.0, and 4.0 formats.
<P>
Microsoft Excel 5.0 was not released until after FoxPro 2.5 for MS-DOS and
Windows were developed. FoxPro for Macintosh was developed at approximately
the same time as Microsoft Excel 5.0 for Windows. Therefore, support for
importing Microsoft Excel 5.0 format files was not built into FoxPro 2.5
for any platform.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are some workarounds to directly importing a Microsoft Excel 5.0
worksheet, all of which must be performed in Microsoft Excel. Two of these
workarounds are:

<UL><LI>Save the Microsoft Excel 5.0 file as a Microsoft Excel 4.0, 3.0, or 2.0
   format file. (IMPORTANT: Make sure you give the file a new name before
   you save it.) Then import this file with the IMPORT FROM &lt;file&gt; TYPE XLS
   command.
<P>
   -or-

<LI>Save the Microsoft Excel 5.0 file as a DBF format file. (IMPORTANT: Make
   sure you give the file a new name before you save it.) All versions of
   Microsoft Excel can save files in the DBF3 file format; in addition,
   Microsoft Excel 3.0, 4.0, and 5.0 can save files in the DBF4 file
   format. FoxPro can open either of these two file formats.
<P>
   IMPORTANT: In versions of Microsoft Excel prior to 5.0, the database
   range must be defined in Microsoft Excel before the file is saved in one
   of the DBF formats. Data outside the database range will NOT be saved to
   the DBF format file.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
FoxPro for MS-DOS and Windows "Language Reference," version 2.5, pages
L3-569 and L3-570
<P>
FoxPro for Macintosh "Language Reference," version 2.5, pages 468-469
<P>
Microsoft Excel "User's Guide 1," version 4.0, pages 60, 306, and 307
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.00 2.50 2.50a 2.50b<BR>
buglist2.00<BR>
buglist2.50<BR>
buglist2.50a buglist2.50b append errmsg err msg<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
