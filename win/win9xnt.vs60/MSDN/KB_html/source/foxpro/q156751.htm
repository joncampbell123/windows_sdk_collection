

<HTML>
<HEAD>
<TITLE>PRB: Executing Quit Method on OLE Object Quits VFP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156751">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/30">
<META NAME="Keywords" CONTENT="kbinterop kbole kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you reference the Application property to Quit an OLE object, Visual FoxPro terminates. This article illustrates how to remove or hide an OLE Chart object and explains how the Application property behaves with OLE objects.  CAUSE =====  Each V...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QBVP,QAGB,QA56,QA55,QAEF,QAJH,QA9Q,QBMH,QAH4,QBWC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Executing Quit Method on OLE Object Quits VFP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156751</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you reference the Application property to Quit an OLE object, Visual
FoxPro terminates. This article illustrates how to remove or hide an OLE
Chart object and explains how the Application property behaves with OLE
objects.
<P>
<P><h2>CAUSE</h2>
 
<P>
Each Visual FoxPro object has an Application property that refers to the
Visual FoxPro application object. Because that object has a Quit method,
invoking that method terminates the Visual FoxPro session.
<P>
The Application property refers to the Visual FoxPro object, not the object
in the OLE control. The Help file topic concerning the Application Property
states:
<P>
<PRE>   Provides a reference to the Application object containing an object.

</PRE>In this case, the Application object is Visual FoxPro.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Since an Excel chart object does not have a Quit property, you must use
properties available in Visual FoxPro. First, if you want to remove the
object from the form, call the RemoveObject method of the form. For
example:
<P>
<PRE>   frmMyForm.RemoveObject('oletest')

</PRE>This removes the object from the form without quitting Visual FoxPro.
<P>
Second, if you simply need to hide the OLE object, set the Visible property
of the object to false (.F.). For example:
<P>
<PRE>   frmMyForm.oletest.Visible=.T.

</PRE>The method you choose depends on whether you need to access the
OLEContainer again. Toggling the Visible property between True and False is
faster than invoking the AddObject method. However, if you truly want to
remove the object from the form, the RemoveObject method is preferable.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In the example below, you want to remove the Excel chart from the form.
However, the command in step 2 causes the following error:
<P>
<PRE>   OLE IDispatch exception code 1000 from Microsoft Excel: Chart
   does not have Quit property.

</PRE>As the error states, the object referenced, the Excel chart, does not have
a Quit property. By adding the Application property to the command, no
error occurs and Visual FoxPro closes. Since the Application property
refers to Visual FoxPro and not Excel, the program exits Visual FoxPro.
<P>
The Object Browser application in Excel provides information on the
properties available for use with Excel objects.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a program containing the following code and then execute it:
<P>
   PUBLIC frmMyForm
   frmMyForm = CREATEOBJECT("form")
   frmMyForm.AddObject("oleTest","OLEControl","Excel.Chart")
   frmMyForm.oletest.Visible=.t.
   frmMyForm.oletest.Height=115
   frmMyForm.Show

<P><LI>In the Command window, type:
<P>
   frmMyForm.oletest.Quit

<P><LI>Click OK in the error box, and then type:
<P>
   frmMyForm.oletest.Application.Quit
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about properties and methods available to the
Application Object, search for "Application Object" and then "Properties"
or "Methods" in the Visual FoxPro Help file. Also see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q156548.htm">Q156548</A></B>
   TITLE     : How To Use the object Property to Reference
               Methods/Properties

   ARTICLE-ID: <B><A href="../foxpro/q155747.htm">Q155747</A></B>
   TITLE     : How To Use the New Application Property in VFP 5.0

</PRE></OL>For more information about Excel's Object Browser, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q142128.htm">Q142128</A></B>
   TITLE     : XL: How to Find Visual Basic for Application Help
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbole kbprb<BR>
KBSubcategory: FxinteropOle<BR>
Additional reference words: 5.00 kbdsd VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
