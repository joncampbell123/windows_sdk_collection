

<HTML>
<HEAD>
<TITLE>Two Ways to Search &amp; Remove Characters from a Text String </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120098">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/08/31">
<META NAME="Keywords" CONTENT="kbenv kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can delete characters from a text string in a memory variable or database field. You can use the FoxPro SUBSTR(), ATC(), and STRTRAN() functions to search a text string for a particular value and replace it with another.  MORE INFORMATION  Meth...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATX,QAY5,QAYL,QAEF,QAB9,QBV8,QAMB,QAY2,QAUD,QACI,QAH4,QDH6,QBE7,QBE6,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Two Ways to Search &amp; Remove Characters from a Text String</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120098</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, version 2.5b, 2.5c, 2.6a
<LI>Microsoft FoxPro for UNIX, version 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can delete characters from a text string in a memory variable or
database field. You can use the FoxPro SUBSTR(), ATC(), and STRTRAN()
functions to search a text string for a particular value and replace it
with another.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method One: Use SUBSTR() and ATC() Functions</h3>
 
<P>
You can use the ATC() and SUBSTR() functions to eliminate unwanted
characters from database fields and memory variables.
<P>
<P>
For example, look at the following code:
<P>
<PRE>   a="123.45"
   y=SUBSTR(a,1,ATC(".",a)-1)+SUBSTR(a,ATC(".",a)+1)
   b="123 45"
   y=SUBSTR(b,1,ATC(" ",b)-1)+SUBSTR(b,ATC(" ",b)+1)

</PRE>The variables a and b contain the text strings "123.45" and "123 45"
respectively. The code removes the period (.) and the blank space from the
variables.
<P>
The SUBSTR() function parses the variable into separate pieces based on the
value returned by the ATC() function. The ATC() function searches for a
string in a variable or field and returns the numeric position of the first
character in the string if it is found. If the ATC() function can't locate
the string, it returns zero (0).
<P>
By combining the SUBSTR() and ATC() functions, you can construct complex
statements to alter data in numerous ways.
<P>
<P><h3>Method Two: Use STRTRAN() Function</h3>
 
<P>
You can use the STRTRAN() function to search and replace characters within
a text string using a single command. The following example code shows you
how to use STRTRAN() to remove an unwanted period (.) from a text string:
<P>
<PRE>   x="123.4567"
   y=strtran(x,".","")
   ? y  &amp;&amp; The variable y now contains "1234567" as a text string.

</PRE>By default, STRTRAN() looks for all occurrences of the second parameter
listed in the function. By adding a numeric value in the third parameter,
you can force the function to ignore earlier instances of a character. By
adding a fourth numeric parameter, you can control the number of
occurrences the function replaces.
<P>
The following example code shows you how to remove the second period from a
text string while preserving the first occurrence:
<P>
<PRE>   x="123.4567.8910"
   y=strtran(x,".","",2)
   ? y

</PRE>The variable y returns "123.45678910" as a text string.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft FoxPro Commands &amp; Functions 1.02 pp. C4-17; C4-191; C4-189
Microsoft FoxPro Commands &amp; Functions 2.00 pp. C3-156; C3-870; C3-866
Microsoft FoxPro Language Reference 2.5x and 2.60 pp. L3-218; L3-1059;
L3-1055
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxUnix FoxMac FoxDos FoxWin 2.50<BR>
2.50a 2.50b<BR>
2.50c<BR>
2.60 2.60a<BR>
KBCategory: kbenv kbprg kbcode<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
