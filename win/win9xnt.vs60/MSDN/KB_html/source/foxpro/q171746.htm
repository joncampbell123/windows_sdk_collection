

<HTML>
<HEAD>
<TITLE>PRB: ListBox/ComboBox Picture Won't Display If Defined in Class </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171746">
<META NAME="KBModify" CONTENT="1997/07/24">
<META NAME="KBCreate" CONTENT="1997/07/23">
<META NAME="Keywords" CONTENT="FxprgClassoop vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A class based on either a ListBox or ComboBox that sets the Picture property in the class does not display the picture either in the Form Designer when the class is added to a form, or when the form is run.  RESOLUTION  This article includes two wo...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QABO,QAYS,QAH4,QBWS,QAVX,QAVW,QAUR,QA2Q,QBJZ,QAHP,QAAW,QBXF,QBWC,QAI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ListBox/ComboBox Picture Won't Display If Defined in Class</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171746</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A class based on either a ListBox or ComboBox that sets the Picture
property in the class does not display the picture either in the Form
Designer when the class is added to a form, or when the form is run.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This article includes two workarounds. The first adds a new property to the
class that sets the Picture property to the new property. The second sets
the Picture property in the form after the class is added. Both methods
assume that the class has been created following steps 1-3 in the Steps to
Reproduce Behavior section below.
<P>
<P><h3>Method 1</h3>
 

<OL><P><LI>Open the class in the Visual Class Designer. Either by selecting Open
   from the File menu and then clicking Visual Class Library as the file
   type or enter the following command in the Command window:
<P>
<P><PRE>      MODIFY CLASS list OF test.vcx
</PRE>
<P><LI>Create a new property for the class by selecting New Property from the
   Class menu. Enter the property name; cPicture, for example. Click Close.

<P><LI>Locate the Picture property on the Property Sheet. Copy the path to the
   graphic and file name from the Picture property and paste it to the new
   cPicture property.

<P><LI>In the Init of the class, add the following code:
<P>
<P><PRE>      This.Picture = This.cPicture
</PRE>
<P><LI>Close and save the class.

<P><LI>Run the form. The picture should appear next to each row in the list.
<P>
</OL>NOTE: If any code or comments are added to the Init of the List1 class on
<PRE>      the form, add the DODEFAULT() statement to the Init of List1 to
      ensure that the parent class Init code is also executed.

</PRE></OL><h3>Method 2</h3>
 

<OL><P><LI>Create a form. Using the Form Controls Toolbar, click the View Classes
   button and select Add. Add the test class library. Click the list class
<P><PRE>    and drop it onto the form.
</PRE>
<P><LI>In the Init of the form, enter code similar to the following:
<P>
   Thisform.List1.Picture = ;
   "c:\vfp5\samples\graphics\bmps\assorted\bell.bmp"

<P><LI>Save and run the form.
<P>
</OL>This method is similar to explicitly setting the Picture property of List1
of the Property sheet to the graphic.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new class by either selecting New from File menu then selecting
   Class or enter the following code in the Command window:
<P>
<P><PRE>      CREATE CLASS list AS listbox OF test.vcx
</PRE>
<P><LI>Set the Picture property of the ListBox to a graphic:
<P>
<P><PRE>      c:\vfp5\samples\graphics\bmps\assorted\bell.bmp
</PRE><P>
   NOTE: The picture is visible in the Visual Class Designer.

<P><LI>Save and close the class.

<P><LI>Create a form. Using the Form Controls toolbar, click the View Classes
   button and select Add. Add test.vcx. Click the list class and drop it
   onto the form.
<P>
   NOTE: The picture is not visible in the list class on the form.

<P><LI>Right-click on the form to display the short-cut menu, and select Data
   Environment.

<P><LI>Add the customer table from the \VFP5\Samples\Data directory, then
   click Close.

<P><LI>Change the RowSource property of List1 to customer.contact and the
   RowSourceType property to 6 - Fields.

<P><LI>Save and run the form.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual FoxPro Online Help file.
<P>
(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Dean Christopher, Microsoft Corporation
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxprgClassoop vfoxwin<BR>
Version             : WINDOWS:5.0,5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
