

<HTML>
<HEAD>
<TITLE>How to Use OLE Automation with Microsoft Project 4.1 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143297">
<META NAME="KBModify" CONTENT="1996/01/31">
<META NAME="KBCreate" CONTENT="1996/01/30">
<META NAME="Keywords" CONTENT="kbole kbinterop kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to create a new project in Microsoft Project 4.1 by using Visual FoxPro and OLE Automation.  MORE INFORMATION  The following code sets up a Microsoft Project called Saltbox. This project consists of tasks necessary...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QAOX,QAEF,QAIJ,QAH4,QAUD,QAG0,QAPF,QAJX,QAGB,QAAP,QADR,QAB4,QAJN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use OLE Automation with Microsoft Project 4.1</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 31, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143297</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to create a new project in Microsoft
Project 4.1 by using Visual FoxPro and OLE Automation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code sets up a Microsoft Project called Saltbox. This project
consists of tasks necessary to build a house.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a table in Visual FoxPro called k2project that has the following
   structure. This structure follows the task structure of Microsoft
   Project.
<P>
<PRE>   Field#  Name       Type
   1. field1     - Character(10)
   2. task_name  - Character(25)
   3. duration   - Character(5)
   4. start      - date
   5. finish     - date
   6. pred       - Character(10)
   7. resource_n - Character(20)

</PRE><P><LI>Populate the table with data. Each record consists of a task to build a
   house. for example:
<P>
<PRE>   field1    = " "
   task_name = "Build House"
   duration  = "60d"
   start     = 03/01/96
   finish    = " "
   pred      = " "
   resource_n = "Ace Builders"

   NOTE: Assign a start date to the first task only. Assign all tasks a
   duration. For example, 30d = thirty days. Microsoft Project will
   calculate the finish dates based upon the duration of each task.

</PRE><P><LI>Enter the following code in a program file, and then run it to create a
   project, link the tasks, and calculate the length of the project. This
   program will print a Gantt Chart and Pert Chart.
<P>
   CLEAR
   SET SAFETY OFF
   ON ERROR DO OLERROR
   SET DEFAULT TO "C:\VFP Files"
   PUBLIC x
<P>
   IF FILE('Saltbox.mpp')
<P><PRE>     ERASE Saltbox.mpp
     ERASE Saltbox.mpx
</PRE>   ENDIF
<P>
   IF USED('k2project')
<P><PRE>     USE IN k2Project
</PRE>   ENDIF
<P>
   USE k2project IN 0
   * Microsoft Project will only accept FOX2 TYPE FILES
   COPY TO xproj TYPE FOX2
   USE IN k2project
   Myfile = "xproj.dbf"
<P>
   x=CreateObject("MSProject.Project.4_1")
   x.application.Visible=.t.
   x.application.FileNew
   x.application.FileSaveAs("SaltBox")
   * Append Entry table from Myfile
   x.application.FileOpen(Myfile,0,1,1,'Entry')
   x.application.SelectAll
   * Link the tasks together
   x.application.LinkTasks
   x.application.AppMinimize
<P>
   Myans =MessageBox("Print Gantt Chart?",4+32,"Print Report")
   IF Myans = 6
<P><PRE>     x.application.FilePrint(1,4)
</PRE>   ENDIF
<P>
   x.application.AppRestore
   x.application.ViewApply("Pert Chart")
   x.application.AppMinimize
<P>
   Myans =MessageBox("Print Pert Chart?",4+32,"Print Report")
   IF Myans = 6
<P><PRE>     x.application.FilePrint(1,2)
</PRE>   ENDIF
<P>
   x.application.ViewApply("Gantt Chart")
   x.application.FileSave
   x.application.FileQuit
<P>
   RELEASE x
   RETURN
<P>
   PROCEDURE OLERROR
   ON ERROR
   WAIT WINDOW "An error occurred!"
   =AERROR(myerror)
   CLEAR
   ? 'The error provided the following information'  &amp;&amp; Display message
   FOR n = 1 TO 7  &amp;&amp; Display all elements of the array
<P><PRE>    ? myerror(n)
</PRE>   ENDFOR
<P>
   IF TYPE("X") = "O"
<P><PRE>     x.application.Quit
     RELEASE X
     CANCEL
</PRE>   ENDIF
   RETURN
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbole kbinterop kbhowto kbcode<BR>
KBSubcategory: FxinteropOle<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 31, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
