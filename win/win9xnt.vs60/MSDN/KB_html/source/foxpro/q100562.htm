

<HTML>
<HEAD>
<TITLE>DDEInitiate() from a Client May Require a Pause </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100562">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/06/22">
<META NAME="Keywords" CONTENT="kbinterop kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a dynamic data exchange (DDE) client application starts FoxPro for Windows and runs a program that sets up FoxPro as a DDE server application, the client application may need to pause while FoxPro's server program is loading. Not waiting until...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QADN,QAH4,QAJH,QAA1,QAZ2,QAUD,QAB4,QDI2,QAPN,QDL9,QBWS,QBWO,QBWN,QARL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DDEInitiate() from a Client May Require a Pause</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100562</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a dynamic data exchange (DDE) client application starts FoxPro
for Windows and runs a program that sets up FoxPro as a DDE server
application, the client application may need to pause while FoxPro's
server program is loading. Not waiting until FoxPro is properly
configured can result in error messages stating that the DDE server is
unobtainable.
<P>
Having to wait, and the length of the pause while a FoxPro program
sets up FoxPro as a server application, may be influenced by the speed
of the hardware and software being used. The length of the required
pause or wait may vary. For example, some applications and some
machines may require little or no pause to initiate a channel, while
others may need to wait several seconds.
<P>
For example, Microsoft Excel version 4.0 may return the error "Remote
data not accessible. Start application MYSERVER.EXE?" This error may
be generated even if Microsoft Excel had just launched FoxPro and run
a .PRG file to publish MYSERVER as a DDE server application (example
below). Consequently, when FoxPro is being used as a DDE client
application, it may also have to pause before issuing a DDEInitiate()
command to an application it just started. Any program that multitasks
in the Microsoft Windows environment may exhibit these symptoms.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following Microsoft Excel macro requires a pause. ("A1" indicates
cell A1 on a Microsoft Excel macro sheet.).
<P>
<PRE>   A1:   =EXEC("foxprow.exe c:\foxprow\tutorial\ddeserve.prg",3)
   A2:   =APP.ACTIVATE()
   A3:   m.initial.chan=INITIATE("myserver","DO")
   A4:   =EXECUTE(m.initial.chan,"SET DEFAULT TO c:\foxprow\tutorial")
   A5:   =EXECUTE(m.initial.chan,"USE customer")
   A6:   =TERMINATE(m.initial.chan)
   A7:   =RETURN()

</PRE>This Microsoft Excel macro launches FoxPro and runs the DDESERVE.PRG
program (found below), which sets up FoxPro as a server application to
accept commands from a DDE client application (Microsoft Excel in this
case).
<P>
However, on machines that have a fast CPU and hard disk, this macro
results in a "Remote data not accessible. Start application
MYSERVER.EXE?" error message in Microsoft Excel. This error occurs
because Microsoft Excel, as a multitasking program for Windows,
executes its DDEInitiate() command before FoxPro has time to configure
itself as a DDE server application. In other words, Microsoft Excel
and FoxPro are running their respective programs at the same time,
resulting in Microsoft Excel trying to establish a DDE channel to a
server application that is not yet running.
<P>
To correct this problem, add a pause or wait statement in the DDE
client application, letting FoxPro (or any server application) finish
configuring itself.
<P>
In Microsoft Excel, a WAIT() statement will pause a macro long enough
for FoxPro to finish executing its server program. The revised
Microsoft Excel macro would then be:
<P>
<PRE>   A1:   =EXEC("foxprow.exe c:\foxprow\tutorial\ddeserve.prg",3)
   A2:   =APP.ACTIVATE()
   A3:   =WAIT(NOW()+"00:00:03")
   A4:   m.initial.chan=INITIATE("myserver","DO")
   A5:   =EXECUTE(m.initial.chan,"SET DEFAULT TO c:\foxprow\tutorial")
   A6:   =EXECUTE(m.initial.chan,"USE customer")
   A7:   =TERMINATE(m.initial.chan)
   A8:   =RETURN()

</PRE>The above WAIT() statement in cell A3 tells Microsoft Excel to pause
the macro 3 seconds, giving FoxPro a chance to finish loading its
server program before Microsoft Excel tries to open a channel to it.
<P>
<P><h3>The DDESERVE.PRG Program</h3>
 
<P>
<PRE>   *** Save as DDESERVE.PRG in the \FOXPROW\TUTORIAL directory ***

   *** Set FoxPro up as a DDE server ***
   = DDESetService('myserver', 'DEFINE')
   = DDESetService('myserver', 'EXECUTE', .T.)
   = DDESetTopic('myserver', 'DO', 'DOTOPIC')

   PROCEDURE dotopic
   PARAMETERS channel, action, item, data, format, advise
   mresult = .F.

   *** It's necessary to return .T. from an     ***
   *** INITIATE action or no connection is made ***

   IF action = 'INITIATE'
        mresult = .T.
   ENDIF

   IF action = 'EXECUTE'
        &amp;data
        mresult = .T.
   ENDIF

   IF action = 'TERMINATE'
        WAIT WINDOW 'Goodbye ... ' NOWAIT
        mresult = .T.
   ENDIF
   RETURN mresult

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft Excel "Function Reference"
<P>
FoxPro for Windows "Language Reference"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a SetServer SetTopic<BR>
KBCategory: kbinterop kbprg<BR>
KBSubcategory: FxinteropDde<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
