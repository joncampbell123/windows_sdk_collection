

<HTML>
<HEAD>
<TITLE>PRB: Protected Property Cannot be Changed by Objects in a Class </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155261">
<META NAME="KBModify" CONTENT="1997/11/14">
<META NAME="KBCreate" CONTENT="1996/08/26">
<META NAME="Keywords" CONTENT="FxprgClassoop kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  An Object that was added to a class at design time will not be able to modify a protected property or method of the class. If it tries, it will fail with the following error:       Property is not found   WORKAROUND  In order to allow an object in ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QABO,QAK7,QAH4,QAGI,QAVY,QBWC,QBVV,QAL3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Protected Property Cannot be Changed by Objects in a Class</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155261</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b | 3.00b
<PRE>WINDOWS    MACINTOSH
</PRE>kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An Object that was added to a class at design time will not be able to
modify a protected property or method of the class. If it tries, it will
fail with the following error:
<P>
<PRE>    "Property is not found"

</PRE><h2>WORKAROUND</h2>
 
<P>
In order to allow an object in a class to modify protected properties of a
class, you will need to create public methods for your objects to call and
then have the method change the protected properties.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Protected properties added to a container class in Visual FoxPro become
part of your container class. However, objects that are added to the
container in the Class Designer are not considered to be part of the
container class but rather external objects sitting in the container.
Because of this, protected properties are encapsulated in the container
class and can not be seen by objects sitting in the container. This
behavior can be confusing because the class designer gives the appearance
that the container and all the objects in it are part of the container
class.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create the following program:
<P>
   ***** Start Program Code *****
   PUBLIC oForm1
   oForm1 = CREATEOBJECT("myform")
   oForm1.Show
<P>
   DEFINE CLASS myform AS form
<P><PRE>     Name = "myform"
     PROTECTED cString
</PRE><P>
<P><PRE>     ADD OBJECT command1 AS commandbutton WITH ;
       Top = 20, ;
       Left = 20, ;
       Height = 30, ;
       Width = 100, ;
       Caption  = "Change Property"
</PRE><P>
<P><PRE>     ADD OBJECT command2 AS commandbutton WITH ;
       Top = 100, ;
       Left = 20, ;
       Height = 30, ;
       Width = 100, ;
       Caption  = "Call Method"
</PRE><P>
<P><PRE>     PROCEDURE command1.Click
       * This fails because the Command button
       * Cannot change a protected property of the class
       This.Parent.cString = "Change Me"
     ENDPROC
</PRE><P>
<P><PRE>     PROCEDURE command2.Click
       * calling a method to change a protected property will work
       This.Parent.ChangeString()
</PRE><P>
<P><PRE>     ENDPROC
</PRE><P>
<P><PRE>     PROCEDURE ChangeString
       * because the method is part of the class, it
       * can change the cString property
       This.cString = "Change Me"
       WAIT WINDOW "The Property cString now equals "+This.cString
     ENDPROC
</PRE><P>
   ENDDEFINE
<P>
   ***** End Code *****

<P><LI>Run the program and click the Call Method Command button. Note that the
   property changes. Pressing the other button causes the error to appear.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about how inheritance affects protected properties,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q128633.htm">Q128633</A></B>
   TITLE     : How Inheritance Affects PROTECTED Methods and Properties
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory: FxprgClassoop<BR>
Additional reference words: 3.00 3.00b kbdsd vfoxwin<BR>
Keywords          : FxprgClassoop kbprg<BR>
Version           : 3.00 3.00b | 3.00b<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
