

<HTML>
<HEAD>
<TITLE>PRB: Displayed Value Changes If Press TAB to Move into TextBox </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138616">
<META NAME="KBModify" CONTENT="1995/10/27">
<META NAME="KBCreate" CONTENT="1995/10/24">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you press the TAB key to move into a text box the contents of which is selected on entry and that text box displays numeric data in scientific notation, the displayed value may change.  CAUSE =====  The Width property of the text box is not su...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QBT6,QAHP,QBB2,QAH4,QAMB,QA5V,QAPN,QAEF,QACI,QA9N,QANJ,QAKD,QA6A,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Displayed Value Changes If Press TAB to Move into TextBox</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138616</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you press the TAB key to move into a text box the contents of which is
selected on entry and that text box displays numeric data in scientific
notation, the displayed value may change.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Width property of the text box is not sufficient to display the entire
scientific notation expression.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Increase the Width property of the text box to accommodate the maximum
possible scientific notation expression of your data when that data is
selected.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. When the text box contents are selected
(highlighted), the font used to display the highlighted contents occupies
more space than non-selected text. Therefore, the scientific notation
expression displays as expected when the contents are not selected.
Likewise, when you press the TAB key to move into the text box and its
contents are selected, only the portion of the expression that wraps to the
next line is displayed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following sample program demonstrates the behavior.
<P>
*-- Begin Program
*-- Create an array from which to load records in a table.
LOCAL ARRAY aBunchONums[3,1]
*-- Create a table
CREATE TABLE testtube FREE (number n(14,4))
*-- Load three records in the table with random numbers.
=RAND(-1)
FOR i = 1 to 3
<PRE>     aBunchONums[i] = RAND()*SECONDS()*VAL(sys(11, date()))/100
</PRE>ENDFOR
APPEND FROM ARRAY aBunchONums
GO TOP
*-- Instantiate a form based on custom form class, TestForm.
frmMyForm = CREATEOBJECT("TestForm")
*-- Add a text box to the form with format and picture clause.
<PRE>     frmMyForm.addobject("txbFooBox", "TEXTBOX")
          WITH frmMyForm.txbFooBox
               .ControlSource = "testtube.number"
               .Format        = "KZ^"
               .InputMask     = "999999999.9999"
               .Top           = 5
               .Left          = 15
               .Visible       = .T.
               .Width         = 100  &amp;&amp; &lt;== change this value
          ENDWITH
</PRE>*-- Display the form.
frmMyForm.show
<P>
READ EVENTS
<P>
*-- Define a custom class based on the FORM baseclass.
DEFINE CLASS TestForm AS FORM
<PRE>     CAPTION     = "SciNot Test"
     AUTOCENTER  = .T.
     HEIGHT      = 120
     WIDTH       = 140
</PRE>*-- Add command button to move between records.
<PRE>     ADD OBJECT cmdNext AS COMMANDBUTTON ;
          WITH ;
          TOP            = 50, ;
          LEFT           = 20, ;
          HEIGHT         = 24, ;
          CAPTION        = "Next"
</PRE>*-- Add command button to exit the program (form).
<PRE>     ADD OBJECT cmdQuit AS COMMANDBUTTON ;
          WITH ;
          TOP            = 80, ;
          LEFT           = 20, ;
          HEIGHT         = 24, ;
          CAPTION        = "Quit"
</PRE>*-- Add custom code to the Click event of cmdNext.
<PRE>     PROCEDURE cmdNext.click
          SKIP
          IF EOF()
               GO TOP
          ENDIF
          THISFORM.REFRESH
     ENDPROC
</PRE>*-- Add custom code to the Click event of cmdQuit.
<PRE>     PROCEDURE cmdQuit.click
          THISFORM.Release
          CLEAR EVENTS
     ENDPROC

</PRE>ENDDEFINE
*-- End custom class definition.
*-- End program.
<P>
Run this program. Press the TAB key until the text box has focus. Note the
displayed value changes when you move into the text box.
<P>
With the contents of the text box selected, press the HOME key on your
keyboard. Now, you can see the leading characters of the scientific
notation expression in the text box.
<P>
Edit the program. Go to the line that contains the comment, "&lt;== change
this value." Change the line of code to read:
<P>
<PRE>     .Width         = 120

</PRE>Run the changed program. Press the TAB key until the text box has the
focus. Now the displayed value does not change when you move into the text
box.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
