

<HTML>
<HEAD>
<TITLE>FIX: NODEFAULT in Page's Deactivate Event Activates Wrong Tab </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143296">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1996/01/30">
<META NAME="Keywords" CONTENT="kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using NODEFAULT in the Page's Deactivate event stops the current page from changing, but the tab of the page will not be active. Whichever tab is clicked, the tab - 1 is the one that is brought forward. Therefore, if you are located on page one and...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBWA,QBXS,QAH4,QAO4,QBXV,QAFQ,QA62,QAR4,QAM1,QADX,QDNY,QARP,QBTP,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: NODEFAULT in Page's Deactivate Event Activates Wrong Tab</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143296</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using NODEFAULT in the Page's Deactivate event stops the current page from
changing, but the tab of the page will not be active. Whichever tab is
clicked, the tab - 1 is the one that is brought forward. Therefore, if you
are located on page one and click the fourth page, tab 3 will be moved to
the front yet page one's objects continue to show on the pageframe.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Move the NODEFAULT condition to the Activate event of each page. Create one
property in the form, and make it store the current page of the pageframe.
The default value should be 1. In the Activate event for each page,
evaluate the variables to see if the page should come forward. If it
shouldn't come forward based on certain conditions, issue the NODEFAULT and
set the ACTIVEPAGE to the form property. If the page should come forward,
don't use the NODEFAULT clause, and reset the curPage property to the
current page.
<P>
Following is an example of what might be used in the Activate event of the
page. CurPage is a form property that stores the current active page in the
pageframe. Lexpression is the condition that must be met before the page
will activate.
<P>
<PRE>   IF THISFORM.curPage != 1 AND &lt;lexpression&gt;
     THISFORM.curPage = 1
   ELSE &amp;&amp; Resets the active page
     NODEFAULT
     THIS.PARENT.ActivePage = THISFORM.curPage
   ENDIF

</PRE>The value of curPage in this code would change to the page's number of the
current Activate event. For example, if this code was in the fourth page of
the pageframe, the code would be as follows:
<P>
<PRE>   IF THISFORM.curPage != 4 AND &lt;lexpression&gt;
     THISFORM.curPage = 4
   ELSE &amp;&amp; Resets the active page
     NODEFAULT
     THIS.PARENT.ActivePage = THISFORM.curPage
   ENDIF

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new form named zJunk.

<P><LI>Add a pageframe to the form.

<P><LI>Set the PageCount to 4.

<P><LI>Add the following code to the Deactivate event of Page1:
<P>
   NODEFAULT

<P><LI>Add text labels to each of the four pages to identify each page.

<P><LI>Save and run the form.

<P><LI>Click the Page4 tab.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: FxprgClassoop VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
