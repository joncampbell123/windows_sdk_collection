

<HTML>
<HEAD>
<TITLE>How to Use the UNION Clause in a FoxPro SELECT Statement </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119901">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/08/29">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The UNION clause is used to join the results of multiple queries. However, the UNION clause is not supported by the Relational Query By Example (RQBE) tool because the RQBE tool does not support multiple or nested queries. Therefore, to perform que...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA2Q,QAG2,QA7O,QA7N,QAML,QAB9,QBVV,QBWS,QA5V,QAPF,QAHT,QAPP,QAL3,QA1E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use the UNION Clause in a FoxPro SELECT Statement</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119901</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6, 2.6a
<LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
<LI>Microsoft FoxPro for UNIX, version 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The UNION clause is used to join the results of multiple queries. However,
the UNION clause is not supported by the Relational Query By Example (RQBE)
tool because the RQBE tool does not support multiple or nested queries.
Therefore, to perform queries of this type, the SELECT statement must be
coded by hand.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The UNION clause is a very important clause in the SELECT statement because
it allows you to append the results of a query to the results of another
query. The syntax is:
<P>
<PRE>   UNION [ALL] &lt;SELECT statement&gt;

</PRE>The ALL clause prevents UNION from eliminating duplicate rows from the
combined results of the tables.
<P>
NOTE: There is no limit to the number of UNION clauses that can be used,
except that the whole SELECT statement is limited to 2048 characters.
<P>
There are three rules you need to follow when using a UNION clause. They
are as follows:

<OL><P><LI>A UNION clause cannot be used to join nested SELECT statements.

<P><LI>If an ORDER BY or an INTO clause is used, it must be placed in the last
   SELECT statement.

<P><LI>SELECT statements joined with a UNION clause must have identical
   structures for the resulting tables of both statements.
<P>
</OL>The last rule is very important to keep in mind because you may need to
join two tables that have different structures. For example, one of the
tables may contain a memo field while the other does not. In this case, you
have two options. If the information in the field is not needed, do not
include that particular field in the SELECT statement. If the field is
needed, insert a placeholder in the SELECT statement for the other table.
The placeholders for the different data types are as follows:
<P>
<PRE>   Numeric:   0
   Character: " "
   Date:      {}
   Logical:   .F.
   Memo:      Not available. Use workaround described below.

</PRE></OL>To create a placeholder for a memo field:

<OL><P><LI>Create a database called HOLDMEMO with only one field: a memo field
   called PLACEHOLD.

<P><LI>USE the database.

<P><LI>In the Command window, type:
<P>
<P><PRE>      APPEND BLANK
</PRE><P>
</OL>Now that the placeholder has been created, it has to be added to the SELECT
statement. Here is an example of using a memo field placeholder with the
CUSTOMER.DBF file:
<P>
<PRE>   SELECT *,placehold FROM customer, holdmemo INTO CURSOR test

</PRE></OL>The resulting query will have a blank memo field as the last field for each
record. This behavior occurs because there is not a join condition for the
databases, which creates a Cartesian product. In other words, each record
in the first table is matched with each record in the second table.
<P>
For another example of the UNION clause, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q89181.htm">Q89181</A></B>
   TITLE     : Outer Join Syntax Example for SELECT-SQL Statement

</PRE><h2>REFERENCES</h2>
 
<P>
FoxPro "Language Reference," see "SELECT-SQL"
<P>
"Using FoxPro 2.5 for Windows," Que Publishing, pages 266-267
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory: FxtoolRqbe
<P>

Additional reference words: VFoxWin FoxUnix FoxMac FoxDos FoxWin SQL outer<BR>
join combine outerjoin 2.50 2.50a 2.50b 2.50c 2.60 2.60a 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
