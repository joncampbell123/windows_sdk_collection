

<HTML>
<HEAD>
<TITLE>BUG: ComboBox and ListBox Data Moves when Using Slide Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162546">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1997/01/23">
<META NAME="Keywords" CONTENT="buglist5.00 FxprgGeneral vfoxwin vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the Slide control on the scroll bar of a dropped-down combo box or a list box causes the data in the combo box or list box to jump around erratically.  CAUSE =====  Setting the order on the table that is used as the RowSource property for the...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QBV3,QA7O,QAB5,QAPN,QAOE,QAMN,QAYV,QAHP,QA9N,QA63,QAO2,QBXQ,QACI,QAQ7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ComboBox and ListBox Data Moves when Using Slide Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162546</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the Slide control on the scroll bar of a dropped-down combo box or a
list box causes the data in the combo box or list box to jump around
erratically.
<P>
<P><h2>CAUSE</h2>
 
<P>
Setting the order on the table that is used as the RowSource property for
the combo box or list box causes this behavior.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
One workaround is to use an ARRAY as the RowSourceType property of the
combo box or list box.
<P>
Another workaround is to use a SQL - STATEMENT as the RowSourceType.
However, if the ORDER clause is used, it may be necessary to force Visual
FoxPro to create an actual temporary cursor on disk of the query results.
This can be done by adding a non-existing column to the resulting cursor as
in the following example:
<P>
<PRE>   SELECT &lt;desired_field&gt;,.F. FROM &lt;table_name&gt; ;
      ORDER BY &lt;desired_field&gt; INTO CURSOR temp

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Paste the following lines into a program and run it to create the
   necessary table:
<P>
<P><PRE>      CREATE TABLE xpop (cnum c(10))
      FOR i = 1 TO 5000
<PRE></PRE>        APPEND BLANK
        REPLACE cnum WITH STR(i)
      ENDFOR
      INDEX ON cnum TAG cnum

   NOTE: Any table can be used but this makes it easier to see.

</PRE><P><LI>Create a form.

<P><LI>Add the table created above to the DataEnvironment (DE) of the form.

<P><LI>Right-click the table in the DE to bring up the Shortcut menu.
   Click Properties.

<P><LI>Set the Order property of the Cursor to the index tag created above.

<P><LI>Add a ComboBox or ListBox control to the form. Set the following
   properties:
<P>
<P><PRE>      RowsourceType = 6 - Fields
<PRE></PRE>      Rowsource     = "xpop.cnum"

</PRE><P><LI>Run the form.

<P><LI>Drop-down the combo box.

<P><LI>Drag the Slider control to some where in the middle of the scroll bar.

<P><LI>Click the left mouse button on the Slider control and then let up, note
<P><PRE>    the contents of the drop-down jump to another place in the list and
    back.
</PRE>
<P><LI>Click the left mouse button and hold it, drag the Slider control to
<P><PRE>    another location in the list and release. Notice that the data jumps to
    some other location.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about forcing SQL-SELECT to create a temporary file,
please see the following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q109584.htm">Q109584</A></B>
   TITLE     : How To Force SELECT-SQL to Create Temp File for Cursor
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00<BR>
Keywords            : buglist5.00 FxprgGeneral vfoxwin vfpbug5.0a kbbuglist<BR>
Version             : 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
