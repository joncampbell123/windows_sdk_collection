

<HTML>
<HEAD>
<TITLE>HOWTO: Creating a Menu with a Variable Pad </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113812">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1994/04/17">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article demonstrates how to make a menu choice vary with the contents of a database field by using the Menu Builder and very little code.  MORE INFORMATION  Use one of the following examples, depending on your version of FoxPro.  FoxPro 2.x Ex...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QANE,QAVT,QAEB,QA5V,QBXS,QAB9,QAF0,QBV8,QA50,QAGB,QACF,QAP2,QBWR,QAVI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Creating a Menu with a Variable Pad</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113812</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0, 5.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, 2.5b, and 2.6
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, and 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to make a menu choice vary with the contents
of a database field by using the Menu Builder and very little code.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use one of the following examples, depending on your version of FoxPro.
<P>
<P><h3>FoxPro 2.x Example</h3>
 
<P>
The following steps show how to create a menu that contains a pad whose
name equals the CITY field of the current record in SALESMAN.DBF, one of
the sample databases provided with FoxPro.

<OL><P><LI>In the Command window, issue the following commands to set the default
    working directory to the TUTORIAL subdirectory and open the
    SALESMAN.DBF database:
<P>
       SET DEFAULT TO C:\&lt;FoxPro directory&gt;\TUTORIAL
       USE SALESMAN

<P><LI>In the Command window, type the following command to display the
    database's structure:
<P>
       DISPLAY STRUCTURE
<P>
    Note that the database contains a character field called CITY.

<P><LI>In the Command window, type the following command to create a menu
    design called CHGPAD:
<P>
       CREATE MENU CHGPAD

<P><LI>In the Prompt box, type the following text:
<P>
       \&lt;"+alltrim(city)+"
<P>
    Notes
    -----
<P>
    - Lowercase is not required above, but it will make searching for this
      text later in the generated code easier.
<P>
    - "\&lt;" tells FoxPro to highlight the first letter of this menu pad and
      use it as a hot key (this will be the first letter of the city's
      name). ALLTRIM(CITY) removes leading and trailing spaces from the
      contents of the CITY field.
<P>
    - The quotation marks are used in anticipation of the menu code that
      will be generated by the Menu Builder (see the DEFINE PAD statement
      in step 8).

<P><LI>Choose Options, then Pad Name, and enter CityPad for the pad name.
    Choose OK to close the Pad Name dialog box. Choose OK again to close
    the Options dialog box.

<P><LI>To generate the menu-code file CHGPAD.MPR, choose Generate from the
    Program menu. Choose Yes when asked if you want to save the menu
    design CHGPAD.MNX, and then choose Generate in the subsequent dialog
    box.

<P><LI>Press ESC to close the menu-design window.

<P><LI>In the Command window, view the generated menu code by typing:
<P>
       MODIFY COMMAND CHGPAD.MPR
<P>
    Look for the following DEFINE PAD statement in the code:
<P>
       DEFINE PAD CityPad OF _MSYSMENU PROMPT "\&lt;"+alltrim(city)+"" ;
       COLOR SCHEME 3
<P>
    Note that the item entered in the Prompt box during menu design
    (\&lt;"+alltrim(city)+") was inserted in the menu code. The two quotation
    marks you typed in were needed to close off the two quotation marks
    automatically inserted by the Menu Builder. This results in the
    concatenation of CITY as a field, not as the word "CITY".

<P><LI>Select the above line of code, copy it to the Clipboard by pressing
    CTRL+C, and press the ESC key to return to the Command window.

<P><LI>In the Command window, type "MODIFY COMMAND CHGPAD" (without the
   quotation marks), and then type the following program lines (you can
   paste the DEFINE PAD line below from the Clipboard by pressing CTRL+V):
<P>
       SET DEFAULT TO C:\&lt;FoxPro directory&gt;\TUTORIAL
       USE SALESMAN
<PRE>       GO TOP              &amp;&amp; Go to 1st record
       DO CHGPAD.MPR       &amp;&amp; Display CHGPAD menu with 1st record's city
       WAIT WINDOW "The menu pad shows the first record's city...press ;
          the SPACEBAR"

       SKIP                &amp;&amp; Go to 2nd record; redefine pad for its city
       DEFINE PAD CityPad OF _MSYSMENU PROMPT "\&lt;"+alltrim(city)+"" ;
       COLOR SCHEME 3
       WAIT WINDOW "The menu pad shows the next record's city...press ;
          the SPACEBAR"

      SET SYSMENU TO DEFAULT  &amp;&amp; Restore system menu

</PRE><P><LI>Press CTRL+W to exit and save this program as CHGPAD.PRG.

<P><LI>In the Command window, type the following command to execute the
   program:
<P>
       DO CHGPAD
<P>
</OL>You can apply the above technique to a screen by placing the aforementioned
DEFINE PAD statement in the screen's READ-level SHOW clause; this way,
whenever SHOW GETS is used to refresh a screen's GET fields (for example,
when displaying another record), the menu pad will be updated to reflect
the new record's city.
<P>
<P><h3>Visual FoxPro Example</h3>
 

<OL><P><LI>In the Command window, issue the following commands to set the default
    working directory to the TUTORIAL subdirectory and open the
    EMPLOYEE.DBF database:
<P>
       SET DEFAULT TO C:\VFP\SAMPLES\DATA
       USE EMPLOYEE

<P><LI>In the Command window, type the following command to display the
    database's structure:
<P>
       DISPLAY STRUCTURE
<P>
    Note that the database contains a character field called CITY.

<P><LI>In the Command window, type the following command to create a menu
    design called CHGPAD:
<P>
       CREATE MENU CHGPAD

<P><LI>In the Prompt box, type the following text:
<P>
       \&lt;"+alltrim(city)+"
<P>
    Notes
    -----
<P>
    - Lowercase is not required above, but it will make searching for this
      text later in the generated code easier.
<P>
    - "\&lt;" tells FoxPro to highlight the first letter of this menu pad and
      use it as a hot key (this will be the first letter of the city's
      name). ALLTRIM(CITY) removes leading and trailing spaces from the
      contents of the CITY field.
<P>
    - The quotation marks are used in anticipation of the menu code that
      will be generated by the Menu Builder (see the DEFINE PAD statement
      in step 8).

<P><LI>Choose Options, then Pad Name, and enter CityPad for the pad name.
    Choose OK to close the Pad Name dialog box. Choose OK again to close
    the Options dialog box.

<P><LI>To generate the menu-code file CHGPAD.MPR, choose Generate from the
    Menu menu. Choose Yes when asked if you want to save the menu
    design CHGPAD.MNX, and then choose Generate in the subsequent dialog
    box.

<P><LI>Press ESC to close the menu-design window.

<P><LI>In the Command window, view the generated menu code by typing:
<P>
       MODIFY COMMAND CHGPAD.MPR
<P>
    Look for the following DEFINE PAD statement in the code:
<P>
       DEFINE PAD CityPad OF _MSYSMENU PROMPT "\&lt;"+alltrim(city)+"" ;
       COLOR SCHEME 3
<P>
    Note that the item entered in the Prompt box during menu design
    (\&lt;"+alltrim(city)+") was inserted in the menu code. The two quotation
    marks you typed in were needed to close off the two quotation marks
    automatically inserted by the Menu Builder. This results in the
    concatenation of CITY as a field, not as the word "CITY".

<P><LI>Select the above line of code, copy it to the Clipboard by pressing
    CTRL+C, and press the ESC key to return to the Command window.

<P><LI>In the Command window, type "MODIFY COMMAND CHGPAD" (without the
   quotation marks), and then type the following program lines (you can
   paste the DEFINE PAD line below from the Clipboard by pressing CTRL+V):
<P>
       SET DEFAULT TO C:\VFP\SAMPLES\DATA
       USE EMPLOYEE
<PRE>       GO TOP              &amp;&amp; Go to 1st record
       DO CHGPAD.MPR       &amp;&amp; Display CHGPAD menu with 1st record's city
       WAIT WINDOW "The menu pad shows the first record's city...press ;
          the SPACEBAR"

       SKIP                &amp;&amp; Go to 2nd record; redefine pad for its city
       DEFINE PAD CityPad OF _MSYSMENU PROMPT "\&lt;"+alltrim(city)+"" ;
       COLOR SCHEME 3
       WAIT WINDOW "The menu pad shows the next record's city...press ;
          the SPACEBAR"

      SET SYSMENU TO DEFAULT  &amp;&amp; Restore system menu

</PRE><P><LI>Press CTRL+W to exit and save this program as CHGPAD.PRG.

<P><LI>In the Command window, type the following command to execute the
   program:
<P>
       DO CHGPAD
<P>
</OL>You can apply the above technique to a form by placing the aforementioned
DEFINE PAD statement in the form's refresh property; this way, whenever you
move to the next record in the table, the menu pad will be updated to
reflect the new record's city.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 MBuilder 2.00 2.50<BR>
2.50a 2.50b 2.60 variable 5.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxtoolMBuilder VFoxWin FoxWin FoxDos<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
