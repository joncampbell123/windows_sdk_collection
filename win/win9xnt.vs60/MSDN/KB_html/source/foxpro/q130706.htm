

<HTML>
<HEAD>
<TITLE>PRB: MODIFY STRUCTURE Command Doesn't Set Index Order </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130706">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/05/25">
<META NAME="Keywords" CONTENT="kbprg kbtshoot kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you modify an index by using the MODIFY STRUCTURE command in Visual FoxPro version 3.0, no index order is set.  This behavior appears to be different from that of FoxPro versions 2.x. FoxPro versions 2.x have a Setup dialog box that allows you...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QBXS,QA01,QBWS,QAB9,QAGB,QAA1,QBV8,QAIC,QDIZ,QA56,QA55,QDI2,QA5D V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: MODIFY STRUCTURE Command Doesn't Set Index Order</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130706</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you modify an index by using the MODIFY STRUCTURE command in Visual
FoxPro version 3.0, no index order is set.
<P>
This behavior appears to be different from that of FoxPro versions 2.x.
FoxPro versions 2.x have a Setup dialog box that allows you to modify the
table's structure as well as add, modify, delete, or set the index order
for the table.
<P>
<P><h2>CAUSE</h2>
 
<P>
The MODIFY STRUCTURE command in FoxPro versions 2.x and in Visual FoxPro
version 3.0 defines the table itself. In Visual FoxPro, the table itself
includes the indexes associated with the table. When you modify an index,
Visual FoxPro does not assume that this should be the active index. The
controlling index is not determined at the table definition level in any
version of FoxPro.
<P>
When you use the SET command to activate the View window, you are operating
on the active workarea. In both FoxPro versions 2.x and in Visual FoxPro,
you can set the controlling index at the workarea level.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In FoxPro versions 2.x, the MODIFY STRUCTURE command opens a Table
Structure window. This window does not include an option for modifying or
setting an index.
<P>
In Visual FoxPro version 3.0, the MODIFY STRUCTURE command opens the Table
Designer.
<P>
The Table Designer includes a tab that allows you to modify the indexes
associated with the table. It's easy to confuse this dialog window with the
Setup dialog window in FoxPro versions 2.x. However, they are not the same.
<P>
In FoxPro versions 2.x, the SET command opens the View window. The View
window contains a Setup button that opens a Setup dialog box. On the right
side of the Setup dialog box, FoxPro provides a button that allows you to
modify the structure of the table. This option opens the same Table
Structure window as the MODIFY STRUCTURE command does. On the left side of
the Setup dialog box, FoxPro provides an area that allows you to modify
indexes and set the active index. This is appropriate because you are
setting the controlling index for the table active in a specific workarea.
<P>
In Visual FoxPro version 3.0, the SET command also opens the View window.
The View window contains a Properties button that opens the WorkArea
Properties dialog box, which contains an Index Order button. Click the
button to select the controlling index for the table in this workarea.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
To see the behavior in FoxPro versions 2.x, follow these steps:

<OL><P><LI>Start FoxPro version 2.x, and type the following commands in the Command
   window (assuming FoxPro is the main FoxPro directory):
<P>
   USE \FoxPro\language\customer
   MODIFY STRUCTURE
<P>
   The Table Structure window appears. Note that it contains no options for
   creating, modifying, or setting an index for the table. Click the Cancel
   button to close the window.

<P><LI>Type SET in the Command window to see the View window. Click the Setup
   button. The Setup dialog box appear.

<P><LI>In the Structure area of the Setup dialog box, choose the Modify button.
   The Table Structure dialog box appears. This is the same dialog box that
   is activated by the MODIFY STRUCTURE command. Click the Cancel button to
   close the Table Structure dialog box.

<P><LI>In the Index area of the Setup dialog box, choose the Modify button. The
   Index dialog box appears.

<P><LI>Select the contact index in the Index Key: list box.

<P><LI>Choose the Index Key button to activate the Expression Builder.

<P><LI>In the INDEX ON: &lt;expr&gt; text box, add company to contact:
<P>
   contact+company

<P><LI>Choose the OK button to save the change, and close the Expression
   Builder. Choose the OK button to close the Index dialog box. When the
   "contact already exists, overwrite it" message appears, click the Yes
   button. You should see a small icon in the shape of a key next to the
   Customer:Contact index. This indicates that "contact" is the controlling
   index.
<P>
</OL>To see the behavior in Visual FoxPro version 3.0, follow these steps:

<OL><P><LI>Start Visual FoxPro, and type the following in the Command window
   (assuming VFP is the main Visual FoxPro directory):
<P>
   USE \vfp\samples\data\customer
   MODIFY STRUCTURE
<P>
   The Table Designer window appears.

<P><LI>Select the Index tab. Then select the Contact index.

<P><LI>Click the small button to the right of the Expression list to activate
   the Expression Builder.

<P><LI>In the Expression text box, add company to contact:
<P>
   contact+company

<P><LI>Click the OK button to save the change, and close the Expression
   Builder. You should see the modified index key in the list.

<P><LI>Click the OK button to close the Table Designer. When the "Make
   structure changes permanent?" message appears, click the Yes button.

<P><LI>In the Command window, type SET to bring up the View window. Choose the
   Properties button. The WorkArea Properties dialog box appears. You can
   see that no index order is set for this table.

<P><LI>Set the controlling index by selecting one of the indexes in the list.

<P><LI>Click the OK button to close the WorkArea Properties dialog box. You
   should see a small arrow to the left of the Customer alias. This arrow
   indicates that an index order has been set for the table in this
   workarea.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbprg kbtshoot kbprb<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
