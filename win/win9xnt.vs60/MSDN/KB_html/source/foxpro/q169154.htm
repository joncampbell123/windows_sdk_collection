

<HTML>
<HEAD>
<TITLE>PRB: Error 'OLE Object is Invalid or Corrupt' on Empty Gen Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169154">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1997/05/28">
<META NAME="Keywords" CONTENT="FxinteropDbase FxprgSql vfoxwin kbcode kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When upsizing FoxPro data to an SQL server, empty general field records may cause an error when browsing the resulting SQL table.  CAUSE =====  This is caused by an empty general field being upsized as an hex 20 (which is a space character). FoxPro...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QASR,QBWS,QA7O,QA7N,QABM,QAZV,QAVX,QAVW,QA2Q,QA5V,QAEF,QAYY,QAH4,QAG2,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error 'OLE Object is Invalid or Corrupt' on Empty Gen Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169154</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When upsizing FoxPro data to an SQL server, empty general field records may
cause an error when browsing the resulting SQL table.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is caused by an empty general field being upsized as an hex 20 (which
is a space character). FoxPro expects to see binary data in the general
field rather than an ASCII character.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The problem can be avoided by setting the General field to accept NULL
values. This can be done in either of two methods when creating the table:
programmatically or visually.
<P>
To programmatically allow a NULL value, use the NULL keyword when creating
the field in the table.
<P>
<PRE>   * The following line of code creates a table called 'gendata'. The
   * General field in the table, 'gfield' accepts NULL values.

   CREATE TABLE gendata (gfield G NULL)

</PRE>To set the field to accept NULL values using the visual interface, place a
check mark in the NULL column for the field, in the Table Designer dialog
box.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
There are three parts in setting up this example: Part 1 is to create a
small table with empty general records to be used in the Upsize Wizard.
Part 2 is to upsize the data to an SQL server. Part 3 is to create a remote
view of the SQL data to observe the error.
<P>
Part 1 - Create a table with empty general field records:
<P>
Save the following code to a file called Creatabl.prg:
<P>
<PRE>   *** Begin code ***
   CLOSE ALL
   CREATE DATABASE test
   CREATE TABLE gendata (gfield G)
   APPEND BLANK
   APPEND BLANK
   APPEND BLANK
   GO 1
   APPEND GENERAL gfield FROM c:\windows\waves.bmp
   GO 3
   APPEND GENERAL gfield FROM c:\windows\tiles.bmp
   *** End code ***

</PRE>Part 2 - Upsize the data to an SQL server:

<OL><P><LI>From the Visual FoxPro Tools menu, select Wizards and click Upsizing.

<P><LI>In the Wizard Selection dialog box, click SQL Server Upsizing Wizard and
   click OK.

<P><LI>In Step 1, select the Test database, and click Next.

<P><LI>In Step 2, select the SQL data source to upsize to, and click the Next.
   NOTE: At this point, a login screen may come up. Login into the SQL data
   source to continue.

<P><LI>In Step 3, move the Gendata table to the Selected Tables pane, and click
   Next.

<P><LI>In Step 4, select Map Field Data Types, and click Next to continue.

<P><LI>In Step 5, select the target database to upsize the data to (this could
   be an existing or new database). Then, click Next. NOTE: If an existing
   database is chosen, Steps 5 and Steps 6 will be bypassed. Otherwise, if
   this is a new database, the following steps will be performed.
<P>
<P><PRE>    - In Step 6, set the appropriate database properties, and click Next.
    - In Step 7, set the appropriate log properties, and click OK.
</PRE><P>
   These last two steps complete the steps necessary when setting up a new
   database on the SQL server.

<P><LI>In Step 8, set the upsizing options. In this test, all of the check
   boxes can be cleared. Then, click Next.

<P><LI>In Step 9, click Finish to upsize the data to the SQL server.
<P>
</OL>Part 3 - Create a remote view of the upsized-SQL data:

<OL><P><LI>Open the Test database if it's not already open by entering the
   following command in the Visual FoxPro Command window:
<P>
<P><PRE>      OPEN DATABASE test
</PRE>
<P><LI>From the Visual FoxPro File menu, select New and click Remote View.
   Click Wizard to bring up the Remote View Wizard.

<P><LI>In Step 1, select the data source where the upsized data exists, and
   click Next. NOTE: At this point, a login screen may come up. Login into
   the SQL data source to continue.

<P><LI>In Step 2, move "gfield" from the "gendata" table to the Selected Fields
   pane, and click Finish to bypass Steps 3, 4, and 5, which are not
   necessary in this example.

<P><LI>In Step 6, select "Save remote view and browse", and click Finish. NOTE:
   Once the Remote View Browse window appears, open "gfield" for record 2
   and observe the "OLE Object is Invalid or Corrupt" error message.
</OL> 
<PRE>Keywords          : FxinteropDbase FxprgSql vfoxwin kbcode kberrmsg
Version           : 5.0 5.0a
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
