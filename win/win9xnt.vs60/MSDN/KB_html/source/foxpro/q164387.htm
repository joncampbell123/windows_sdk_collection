

<HTML>
<HEAD>
<TITLE>PRB: Send SQL Updates is Checked but Data Not Saved </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164387">
<META NAME="KBModify" CONTENT="1997/02/28">
<META NAME="KBCreate" CONTENT="1997/02/28">
<META NAME="Keywords" CONTENT="FxtoolQueryvwdes vfoxwin kbprb kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When adding a record to a remote view, sometimes the record does not appear in the table after updating. Or the following error may occur when trying to close the view:     Table buffer for alias             contains uncommitted changes  Even thoug...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QA5V,QABI,QBD2,QA7O,QA7N,QABH,QAC1,QAMA,QBVR,QADK,QBVV,QAH6,QBM2,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Send SQL Updates is Checked but Data Not Saved</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164387</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b 5.00
WINDOWS
kbtool kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When adding a record to a remote view, sometimes the record does not appear
in the table after updating. Or the following error may occur when trying
to close the view:
<P>
<PRE>   Table buffer for alias &lt;view name&gt; contains uncommitted changes

</PRE>Even though the "Send SQL Updates" box is checked in the Update Criteria
tab of the view, make sure that the Updateable (marked with a pencil
symbol) column for the primary key is checked also.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Depending on the rules that are applied to a table, many times a rule
requires that the primary key field of a new record must have a value
placed into it before the record is saved.
<P>
It is often assumed that while in the Update Criteria tab of the View
Designer, selecting a primary key field in the Field Name list box and then
clicking the Update All button updates the primary key and all other fields
in the list box. This is not entirely true; while all of the other fields
have the Updatable column (marked with the pencil symbol) checked, the
Updateable column of the primary key is not checked. It has to be checked
manually in order for the primary field to be updated. If the primary key
field is not checked, this causes the record not to be added to the table.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open a database.

<P><LI>From the File menu, click New. Click Remote View and click New.

<P><LI>Select a connection or data source in the list box and supply the
   correct information to connect.

<P><LI>Add a table from the list box.

<P><LI>In the Fields tab, select all records.

<P><LI>In the Update Criteria tab, check the Send SQL Updates box and make sure
   that there is a primary key checked. Click Update All to select all of
   the fields to be updated.

<P><LI>Run the view and click Append New Record from the Table menu.
   Add data to the fields and close the Browse window.

<P><LI>Close the view after naming it; reopen and run it. Note that the record
   that you added is not there. By going into the View Designer and
   checking the Updatable column on the primary key field, a record can now
   be added to the table. Note that if the table that the view is created
   on does not have rules that the primary key field must have a value in
   it. It is then possible to add a record but the primary key field is
   left blank.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolQueryvwdes vfoxwin<BR>
Additional reference words: 3.00 3.00b 5.00<BR>
Keywords            : FxtoolQueryvwdes vfoxwin kbprb kbtool<BR>
Version             : 3.00 3.00b 5.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
