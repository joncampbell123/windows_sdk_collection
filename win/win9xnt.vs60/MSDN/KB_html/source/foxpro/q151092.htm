

<HTML>
<HEAD>
<TITLE>PRB: Mismatched Pushjmp/Popjmp Call Message from Modify Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151092">
<META NAME="KBModify" CONTENT="1996/10/16">
<META NAME="KBCreate" CONTENT="1996/05/16">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you load a Visual FoxPro form for editing, the process stops before the form appears on the Visual FoxPro desktop and an error dialog box appears stating:      Mismatched pushjmp/popjmp call   Clicking the OK button causes the Visual FoxPro se...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA56,QA55,QBWO,QAB9,QA2Q,QAB4,QDL9,QBWQ,QBWN,QAG2,QBWS,QA7O,QDIR,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Mismatched Pushjmp/Popjmp Call Message from Modify Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151092</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft Visual FoxPro for Windows, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you load a Visual FoxPro form for editing, the process stops before
the form appears on the Visual FoxPro desktop and an error dialog box
appears stating:
<P>
<PRE>   "Mismatched pushjmp/popjmp call"

</PRE>Clicking the OK button causes the Visual FoxPro session to terminate. The
subsequent action depends on the operating system.
<P>
In Windows 95, the user is sent back to the Windows desktop. However, the
Visual FoxPro session remains hidden, but does show in the Windows 95 task
list if you press ALT+TAB, and presents a small, modal dialog box when
Visual FoxPro for Windows 3.0b is restarted. This dialog box appears behind
the Visual FoxPro Desktop of the newer session, remaining hidden until the
second Visual FoxPro session is terminated.
<P>
In the Windows NT operating system environment, the same error message
appears, and Visual FoxPro 3.0b is terminated with no residual processes.
<P>
In the Windows for Workgroups and the Windows 3.1x operating systems, the
error message is the same. Visual FoxPro is terminated and Windows is
locked so the user must use a "Cold" boot, pushing the reset button or
power off/on, to resume normal operations.
<P>
In Visual FoxPro for the Macintosh version 3.0b, the error message returned
states
<P>
<PRE>   "Error loading file - Row Source Type - Record &lt;n&gt;.
   Property value is out of bounds"

</PRE>where &lt;n&gt; is the row number of the offending control in the .scx table.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs when the form has been saved with the Row Source
property of a Listbox or ComboBox containing any command or reference which
has more than 254 characters. An example of a command that is too long is
an SQL Select command that has too many characters in the command
expression.
<P>
While the limit for a command length in Visual FoxPro for Windows 3.0 is
8092 characters, the limit is only 254 characters when the command is a
property of a control on a form.
<P>
If the RowSourceType property is "3 - SQL Statement" for either a Listbox
or Combobox control, the actual SQL SELECT command can be keyed into the
RowSource property in the Property Window.
<P>
The Property window of the form limits the number of characters keyed into
the box to 254. However, the acceptable length of the string comprising the
SELECT-SQL statement is 253 bytes.
<P>
When an incorrect SELECT is the RowSource of the control, the form is saved
and then restored to the desktop with a MODIFY FORM or a DO FORM. Visual
FoxPro then presents an information dialog box stating:
<P>
<PRE>   "Mismatched pushjmp/popjmp call"

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, reduce the length of the SQL SELECT
statement. If you have a copy of Visual FoxPro for Windows 3.0, the form
can be modified, the RowSource SELECT statement modified, and the form can
be loaded for editing and/or execution in Visual FoxPro for Windows release
3.0b.
<P>
If the method above is unavailable, the .scx table can be loaded into a
work area with a USE command and then browsed. Each control on the form is
described in a row. The control name is located in a memo field named
"Objname", and the actual SELECT statement is in a memo field named
"Properties." When the incorrect statement is found, it can be edited to
the correct length and then saved.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In the Visual FoxPro Command window, type "MODIFY FORM testerr."

<P><LI>From the Form Control toolbar, select Listbox ,and click the form to
   place a listbox.

<P><LI>Click the right mouse button on the listbox, and select Properties from
   the Context menu. From the Property menu, choose RowSourceType, and
   select "3 - SQL statement."

<P><LI>Click the RowSource property in the row above the RowSourceType.

<P><LI>In the Property window, type "SELECT . . . SQL command."  The program
   limits the statement to 254 bytes, truncating the last word at DESCEND,
   as follows:
<P>
   SELECT ".." + PADR(CDOW(td_end),12) + DTOC(td_end) ;
<P><PRE>      + "-.-" + PADR( ALLTRIM(STR( kl_prt_ct )) ;
      + " LEADS ",10) ;
      +IIF(kl_type="P","..Printed "," UNPRINTED") ;
      AS day, td_end,kl_type ;
</PRE>   FROM trakdate, keylead ;
   WHERE DTOS(td_end)=keylead.kl_code ;
   INTO CURSOR te ;
   ORDER BY td_date DESCENDING

<P><LI>From the File menu, select Save, and then close the form.

<P><LI>In the Command window, enter the command "MODIFY FORM testerr."
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00b VFoxWin error freeze terminate list box<BR>
combo<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgSql
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
