

<HTML>
<HEAD>
<TITLE>PRB: Cannot Modify Table Structure After Using SQL SELECT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133470">
<META NAME="KBModify" CONTENT="1995/08/01">
<META NAME="KBCreate" CONTENT="1995/07/31">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After performing an SQL SELECT statement on a table, the table structure becomes read-only, so you can't modify it.  CAUSE =====  Initially the SELECT statement is processed to see if the result set can be obtained from the original table with the ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QA2Q,QAO2,QAG2,QBWS,QAIC,QARR,QAPN,QAH4,QACF,QBF0,QAY4,QAY2,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Modify Table Structure After Using SQL SELECT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 1, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133470</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After performing an SQL SELECT statement on a table, the table structure
becomes read-only, so you can't modify it.
<P>
<P><h2>CAUSE</h2>
 
<P>
Initially the SELECT statement is processed to see if the result set can be
obtained from the original table with the application of a filter. If it
can, a temporary cursor is not created on disk; instead, a filtered view of
the original table is created. You will see a cursor object in the View
window with the name QUERY, this is an alias of the source table.
<P>
Because you are looking at a filtered view of the original table, the
MODIFY STRUCTURE command won't work; the underlying table structure of the
result set has been temporarily frozen.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To execute an immediate MODIFY STRUCTURE command on the source table, you
must first close the QUERY cursor. Alternatively, you could avoid this by
editing the query to involve complexities that would force a temporary,
physically distinct cursor to be created.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Code to Reproduce Behavior
 
<P>
The following test code demonstrates this principle with a very
simple single-table query:
<P>
<PRE>   CREATE TABLE TEST (Name C(20))         &amp;&amp; Create temporary table
   CLOSE ALL                              &amp;&amp; Close all tables
   USE TEST EXCLUSIVE                     &amp;&amp; Re-use the table
   INSERT INTO TEST VALUES ("Bob")        &amp;&amp; Populate with some data
   SELECT * FROM TEST INTO CURSOR QUERY   &amp;&amp; Execute query
   SELECT TEST                            &amp;&amp; Re-select the table
   MODIFY STRUCTURE                       &amp;&amp; Command fails.

</PRE>The following example shows a more complex query. Consequently, Visual
FoxPro creates a cursor object named QUERY on the hard disk instead of
creating a filtered alias.
<P>
<PRE>   USE SYS(2004)+"\SAMPLES\DATA\CUSTOMER" IN 0
   SELECT * FROM CUSTOMER WHERE REGION="OR" INTO CURSOR QUERY
   SELECT CUSTOMER
   MODIFY STRUCTURE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolRqbe<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 1, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
