

<HTML>
<HEAD>
<TITLE>PRB: "Command line too long" with BROWSE FIELDS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126621">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/02/27">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The error  Command line too long  occurs when a BROWSE FIELDS command has a large number of fields, long field names, field headers, and other options.  CAUSE =====  By adding a large number of fields, long field names, field headers, and other opt...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAB9,QBE7,QBE6,QBV8,QBWT,QBXT,QA5V,QAIB,QAH4,QAUJ,QAKD,QAGX,QAKC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Command line too long" with BROWSE FIELDS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126621</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The error "Command line too long" occurs when a BROWSE FIELDS command has a
large number of fields, long field names, field headers, and other options.
<P>
<P><h2>CAUSE</h2>
 
<P>
By adding a large number of fields, long field names, field headers, and
other options, you may easily reach the maximum command line length, the
maximum compiled line length, or both.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
By using named expressions stored in an array created for this purpose, you
may be able to have 15 to 20 percent more fields listed in the BROWSE
command in the same amount of space.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code automatically creates a program file that stores field
names to an array and references that array in a BROWSE FIELDS command
based on the currently selected database. This may help to create a BROWSE
command that is short enough to compile.
<P>
************BEGIN CODE
* Create a BROWSE command referencing array elements instead of
* actual field names to shorten the BROWSE command line.
* Can be used on databases with parent-&gt;child-&gt;grandchild
* relationships or parent to multiple child with no grandchild.
outfile=FCREATE("big_brow.prg")
IF outfile &gt; 0
<PRE>   fname=""
   new_way=""
   sofar=0
   bigdata=""
   DO recurs
   * Write the command line to dimension the 'MYFIELDS' array
   * to the output file. FPUTS always adds CR/LF.
   a0=FPUTS(outfile,[Dime mf(]+ALLTRIM(STR(sofar))+[,2)])
   * Populate the array. CR/LF already in data.
   a0=a0+FWRITE(outfile,bigdata)
   * The fname variable contains the string you would
   * use if you issued a standard BROWSE FIELDS command
   * with field names, column headings, and so on.
   * It is created solely for the purpose of comparing
   * size.
   a1=LEN([BROWSE FIELDS ]+fname)
   * Write the actual string composing the new BROWSE
   * FIELDS statement. The third parameter to FWRITE is
   * the number of bytes to write; as the last character
   * in the string is a comma, you don't want it at the end
   * of the BROWSE command, so write 1 character less.
   a2=FWRITE(outfile,"BROWSE FIELDS " + new_way, ;
      LEN("BROWSE FIELDS " + new_way)-1)
   * However, you do want a CR/LF at the end:
   a0=a0+FWRITE(outfile,CHR(13)+CHR(10))
   * Done with the file.
   =FCLOSE(outfile)
   * Display the file.
   MODIFY COMM big_brow.prg NOWA
   WAIT WINDOW [New way (]+ALLTRIM(STR(a2))+[ chars) is ] + ;
      ALLTRIM(STR(INT((a2/a1)*100)))  + ;
      [% of the old way (]+ALLTRIM(STR(a1))+[ chars).]+CHR(13) + ;
      [The commands to browse the current table]+CHR(13) + ;
      [and any related tables are stored to BIG_BROW.PRG]+CHR(13) + ;
      [PRESS ANY KEY TO CONTINUE]
</PRE>ENDIF
<P>
PROCEDURE recurs
<PRE>DO myloop   &amp;&amp; process fields in this database
x=1
</PRE>DO WHILE LEN(TARGET(x)) &gt; 0
<PRE>   x=x+1
</PRE>ENDDO
DO WHILE x &gt; 0
<PRE>   IF LEN(TARGET(x)) &gt; 0
      WAIT WINDOW [Now looking in ]+TARGET(x) TIMEOUT 2
      * go to the target
      wasat=SELECT()
      SELECT (TARGET(x))
      IF LEN(TARGET(x)) &gt; 0
         DO recurs
      ELSE
         DO myloop   &amp;&amp; process fields in current database
      ENDIF
      SELECT (wasat)
   ENDIF
   x=x-1
</PRE>ENDDO
<P>
PROCEDURE myloop
FOR fnum=1 TO FCOUNT()
<PRE>   fname = fname + ALIAS()+[.]+FIELD(fnum)+[:H=']+FIELD(fnum)+[':9,]
   my_fld_name = FIELD(fnum)
   my_fld_type = TYPE(my_fld_name)
   DO CASE
   CASE INLIST(my_fld_type,"G","M","L")
      my_fld_contents = " "
      my_fld_len      = 5   &amp;&amp; arbitrary value
   CASE my_fld_type=="D"
      my_fld_contents = DTOC(EVALUATE(my_fld_name))
      my_fld_len      = 8   &amp;&amp; arbitrary value
   CASE my_fld_type=="N"
      my_fld_contents = ALLTRIM(STR(EVALUATE(my_fld_name),12,2))
      my_fld_len      = 7   &amp;&amp; arbitrary value
   CASE my_fld_type=="C"
      *   OTHERWISE
      my_fld_contents = EVALUATE(my_fld_name)
      my_fld_len      = IIF(LEN(my_fld_contents)&lt;10,LEN(my_fld_contents),9)
   ENDCASE
   new_way=new_way+[(mf(]+ALLTRIM(STR(fnum+sofar))+[,1)):H=mf(]+ ;
      ALLTRIM(STR(fnum+sofar))+[,2):]+ ;
      ALLTRIM(STR(my_fld_len)) + [,]
   STORE bigdata+[store "]+ALIAS()+[.]+FIELD(fnum)+[" to mf(]+;
      ALLTRIM(STR(fnum+sofar))+[,1)]+CHR(13)+CHR(10) TO bigdata
   STORE bigdata+[store "]+FIELD(fnum)+[" to mf(]+;
      ALLTRIM(STR(fnum+sofar))+[,2)]+CHR(13)+CHR(10) TO bigdata
</PRE>ENDFOR
sofar=sofar+FCOUNT()
<P>
************END CODE
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos FoxMac 2.50 2.50a<BR>
2.50b 2.50c<BR>
2.60 2.60a errmsg err msg<BR>
KBCategory: kbprg kbcode kbprb kberrmsg<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
