

<HTML>
<HEAD>
<TITLE>BUG: Treeview Control ItemTips Fail on Windows NT 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165768">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1997/03/25">
<META NAME="Keywords" CONTENT="buglist5.00 FxenvOs FxinteropOcx vfpbug5.0a kbinterop kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you install the Treeview control with Microsoft applications or development tools released after January 1, 1997, it does not show ItemTips correctly when the control is on a form running on Windows NT 4.0.  CAUSE =====  The ItemTips feature o...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAB5,QA7O,QAOE,QAMN,QA56,QA55,QAA1,QDL9,QDI2,QBWQ,QBWO,QBWN,QATX,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Treeview Control ItemTips Fail on Windows NT 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165768</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you install the Treeview control with Microsoft applications or
development tools released after January 1, 1997, it does not show ItemTips
correctly when the control is on a form running on Windows NT 4.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
The ItemTips feature of the version of the Treeview control that comes with
the most recent version of Comctl32.ocx is incompatible with Windows NT
version 4.0 Workstation and 4.0 Server.
<P>
The other features of the control operate as expected, and the ItemTips
feature works when the Visual FoxPro form resides on Windows 95.
<P>
NOTE: This behavior does not occur if you use Comctl32.ocx version 1.0.2908
that is shipped with Visual FoxPro 5.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If the Visual FoxPro for Windows application must have ItemTips the
developer can remove the version of the control that is on the system and
replace it with the version that came on the Visual FoxPro version 5.0
CD-ROM.
<P>
This probably will be unsatisfactory if you need to distribute the
application to users running on Windows NT 4.0 who also have installed
other applications that accompanied the newer version of the Comctl32.ocx.
On those systems the Setup program will not replace the later version of
the control with the one distributed with the Visual FoxPro application.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Install Visual FoxPro 5.0 on a system using Windows NT 4.0.

<P><LI>Install Visual Basic 5.0, Visual C++ 5.0, Office 97, or any
   other Microsoft product that installs the most recent version of
   Comctll32.ocx.

<P><LI>Create a new form in Visual FoxPro 5.0.

<P><LI>Place the OLE Container Control on the form.

<P><LI>In the Insert Object dialog box, click Insert Control.

<P><LI>Select the Microsoft Treeview Control from the list.

<P><LI>Add the following to the Init Event method of the form or the Treeview
   control:
<P>
<P><PRE>      Thisform.OLEControl1.Nodes.add(,,,"This is a long string of text")
</PRE>
<P><LI>Run the form and put the mouse cursor over the item in the Treeview.
<P>
</OL>When you perform steps 2 through 7 in a Windows 95 system, the text of the
string appears as an ItemTip. If the string is longer than the space in the
Treeview, the entire string shows even though it is wider than the control.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: winnt tooltip<BR>
Keywords          : buglist5.00 FxenvOs FxinteropOcx vfpbug5.0a kbinterop kbbuglist<BR>
Technology        : kbole<BR>
Version           : 5.0 5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
