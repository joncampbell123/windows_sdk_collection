

<HTML>
<HEAD>
<TITLE>How to Modify a Report Preview Window Property </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151257">
<META NAME="KBModify" CONTENT="1996/05/23">
<META NAME="KBCreate" CONTENT="1996/05/20">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes some windows attributes related to a Report Preview Window. The tasks described in this article are available as commands in Microsoft FoxPro version 2.6 for Windows as well as versions 3.0 and 3.0b. This article describes ho...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QA56,QA55,QAK5,QBXS,QA4P,QAGQ,QDL9,QDIT,QBW1,QBWQ,QBWO,QBWN,QAUD,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Modify a Report Preview Window Property</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151257</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes some windows attributes related to a Report Preview
Window. The tasks described in this article are available as commands in
Microsoft FoxPro version 2.6 for Windows as well as versions 3.0 and 3.0b.
This article describes how to disable the Minimize and Maximize properties
of the Report Preview window using API routines.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It is possible to control whether a Report Preview Window property can be
changed. The minimize/maximize attributes can be controlled by using some
API calls. In this article, the customized API routine was written using
Microsoft Visual C++ 4.0 to change the attribute of Visual FoxPro Preview
Window properties. As a default, the Visual FoxPro Report Preview Window
can be minimized or maximized by pressing the upper right-hand corner of
the preview window. Since the Report Preview Window is a system-generated
window, you need to call API routines to handle the Preview Window
property.
<P>
The following sample program illustrates the contents of the .DLL file
written in Microsoft Visual C++ 4.0. It shows a way to change the attribute
of Visual FoxPro Report Preview Window successfully through the Win32 SDK.
<P>
NOTE: This sample program illustrates many Microsoft Visual C++ commands.
The use of these commands is beyond the scope of Microsoft FoxPro Product
Support. Users with substantial experience using API routines should be
able to write the following sample .DLL file. For this sample .DLL file to
work, you need a .DEF file to export the disable function.
<P>
<P><h3>Sample Program (DLL)</h3>
 
<P>
<PRE>   #include &lt;windows.h&gt;

   #define IDS_MEMVIEWCLASS        11005

   BOOL APIENTRY DllMain(HANDLE hInst, DWORD ul_reason_being_called, LPVOID
   lpReserved)
   {
       return 1;
           UNREFERENCED_PARAMETER(hInst);
           UNREFERENCED_PARAMETER(ul_reason_being_called);
           UNREFERENCED_PARAMETER(lpReserved);
   }

   void APIENTRY disable(char *title, char *header)
   {
         HWND  hWnd,    // a handle for parent window
            hChild;     // a handle for child window

      // attempt to find the parent window of report preview window
        hWnd = FindWindow(NULL, title);

        char title1[75];

        // attempt to look for first child window
        hChild = GetWindow(hWnd,GW_CHILD);
        while (hChild != 0) {
           hWnd = hChild;
         // look for first sibling of child window
         hChild = GetWindow(hWnd,GW_HWNDNEXT);
         while (hChild != 0) {
            hWnd = hChild;
            GetWindowText(hWnd,title1,75);
            if (strcmp(title1,header) == 0) {
               DWORD L;
         // disable minimize and maximize button of preview window
               L = GetWindowLong(hChild, GWL_STYLE);
               L = L &amp; ~(WS_MINIMIZEBOX);
               L = L &amp; ~(WS_MAXIMIZEBOX);
               SetWindowLong(hChild,GWL_STYLE,L);
               // redraw the preview window
               SetWindowPos(hChild,NULL,0,0,0,0,
   SWP_DRAWFRAME|SWP_NOZORDER|SWP_NOMOVE|SWP_NOSIZE);
               return;
            }
            hChild = GetWindow(hWnd,GW_HWNDNEXT);
         }
         hChild = GetWindow(hWnd,GW_CHILD);
        }
      return;
   }

</PRE><h3>Sample Program (FoxPro)</h3>
 
<P>
<PRE>   REPORT FORM student PREVIEW NOWAIT
   DECLARE integer disable IN disable.DLL  string, string
   FoxHWND = disable("Microsoft Visual FoxPro",;
      "Report Designer - student.frx - Page 1")

</PRE><h3>Sample Program (Notes)</h3>
 

<UL><LI>To create a .DLL file in Visual C++, please refer to a Help file in
   Microsoft Visual C++ 4.0.

<LI>Make a note that the Disable.dll should be in the same directory as
   your project, or should be in the path of the Windows Win32 directory.
<P>
   The API function needs two parameters. The first parameter is the main
   project window that is usually a Visual FoxPro window. The caption must
   be identical. The second parameter is the caption of preview window
   where you want to disable the minimize/maximize buttons. If, for any
   reason, the program does not work properly, you need to check the
   captions of those two windows prior to running the program.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: FxprgGeneral
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
