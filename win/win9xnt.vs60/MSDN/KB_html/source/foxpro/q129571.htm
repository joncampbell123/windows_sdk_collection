

<HTML>
<HEAD>
<TITLE>PRB: Formset.LOAD Is Not the First Event to Fire </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129571">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/30">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a form set contains a Data Environment, the BeforeOpenTables event and the OpenTables method of the Data Environment are triggered before the Load event of the form set. This article explains the reason behind this implementation and offers a ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAO4,QBXS,QAGI,QAX1,QAH4,QAI2,QAYY,QBWS,QAPF,QBVV,QAOX,QAIF,QBWT,QAFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Formset.LOAD Is Not the First Event to Fire</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129571</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a form set contains a Data Environment, the BeforeOpenTables event and
the OpenTables method of the Data Environment are triggered before the Load
event of the form set. This article explains the reason behind this
implementation and offers a workaround if you want the Load event to
execute before the tables are opened.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Load event of a form set usually sets the environment of a form. In
particular, it can be used to bind data to controls on a form. Therefore,
in most cases, tables and views must be loaded before the LOAD event of a
form set is executed. Thus, the OpenTables method of the data environment
is, by default, called before the Load event of the form set is executed.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you do not want the tables or views to be opened when the Load event of
a form set is executed, set the AutoOpenTables property of the form to .F..
You can then call the OpenTables method of the data environment to open the
tables automatically. For example, use the following command in any method
of the form:
<P>
<PRE>   THISFORMSET.DataEnvironment.Opentables

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Following is the sequence of events that are executed when a form set
created in Visual FoxPro version 3.0 is loaded or unloaded. The order of
events might differ if the form is converted from a FoxPro version 2.x
screen. In this example, the form set is named FORMSET1 and contains a form
named FORM1 and a data environment called DATAENVIRONMENT. This list was
generated by executing the following code for the following events and
methods:
<P>
<PRE>   ACTIVATE SCREEN
   ?PROGRAM()

   FORMSET1.LOAD
   .DATAENVIRONMENT.OPENTABLES
   .DATAENVIRONMENT.BEFOREOPENTABLES
   FORMSET1.FORM1.LOAD
   FORMSET1.DATAENVIRONMENT.INIT
   FORMSET1.FORM1.INIT
   FORMSET1.INIT
   FORMSET1.SHOW
   FORMSET1.ACTIVATE
   FORMSET1.FORM1.ACTIVATE
   FORMSET1.FORM1.GOTFOCUS
   FORMSET1.FORM1.QUERYUNLOAD
   FORMSET1.DESTROY
   FORMSET1.FORM1.DESTROY
   FORMSET1.FORM1.UNLOAD
   FORMSET1.UNLOAD
   FORMSET1.DATAENVIRONMENT.CLOSETABLES
   FORMSET1.DATAENVIRONMENT.AFTERCLOSETABLES
   FORMSET1.DATAENVIRONMENT.DESTROY

</PRE>NOTE: The OPENTABLES method calls the BEFOREPOPENTABLES event before the
tables are actually opened. However, the code in the event handler is
executed before the tables are opened, and this is the reason why
OPENTABLES prints before BEFOREOPENTABLES prints.
<P>
For more information about the sequence of events that are triggered when a
form runs, execute the sample program called EVENTS.SCX located in the
SAMPLES\CONTROLS\EVENTS directory.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
