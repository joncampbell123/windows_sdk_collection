

<HTML>
<HEAD>
<TITLE>BUG: SHOW GET Does Not Refresh Number of Elements </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134638">
<META NAME="KBModify" CONTENT="1997/07/03">
<META NAME="KBCreate" CONTENT="1995/08/08">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxotherGeneral vfoxwin vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A screen converted from a previous version of FoxPro to a Visual FoxPro form doesn't display added items when both of the following conditions are met:   - The original screen has a list box that is populated from an array.   - The original screen ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBWS,QAUD,QBVR,QAB9,QBV8,QACI,QBJZ,QA9N,QA5D,QAD7,QAA8,QAUR,QAPN,QANE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SHOW GET Does Not Refresh Number of Elements</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134638</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A screen converted from a previous version of FoxPro to a Visual FoxPro
form doesn't display added items when both of the following conditions are
met:

<UL><LI>The original screen has a list box that is populated from an array.

<LI>The original screen has an event procedure (such as a command button
   click procedure) that adds items to the array, and then refreshes the
   contents of the list with a SHOW GETS command.
<P>
</UL><h2>CAUSE</h2>
 
<P>
The converter defines the list box with a "number of elements" property.
That definition is exercised in the LOAD event of the form or formset.
Visual FoxPro's converter does not insert the appropriate command to
refresh the list box's "number of elements" property when the array size
changes.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The VALID code of the converted command button adds an element to the
array, and executes a SHOW GETS command. Immediately before the SHOW GETS
command, insert a command to update the number of elements as in this
example:
<P>
<PRE>   ThisForm.Pageframe1.Page1.&lt;listbox&gt;.NumberOfElements=ALEN(&lt;arrayname&gt;)

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Steps to Reproduce Problem
 
<P>
In FoxPro version 2.6a for Windows, create a screen that has a list box and
two command buttons, as follows, using the Screen Builder:

<OL><P><LI>On the File menu, click New. Then select the Screen option, and click
   the New button.

<P><LI>On the Screen menu of the Screen Builder, click Layout. Enter the name
   as Addu for the screen in the lower-left area of the dialog box.
<P>
   In the lower-right area, click Code. Then click Screen Setup Code, and
   then click OK twice to expose the edit window for the Setup code. In
   the setup code, enter the following three lines, and save the code by
   pressing CTRL+W:
<P>
<P><PRE>      DIMENSION users(2)
      users(1)="One"
      users(2)="Two"
</PRE>
<P><LI>On the Screen Design toolbar, select the Command (push) button tool, and
   place a button on the screen design surface. In the Push Button dialog
   box, enter the prompt "\&lt;Move=&gt;" (without the quotation marks). In the
   bottom-left area, enter the variable name as m.mover.

<P><LI>Click the VALID button. In the Code Snippet dialog box, choose the
   Procedure option button, enter the following procedure in the edit area,
   and click OK twice to return to the Screen Builder:
<P>
<P><PRE>      DIMENSION users(3)
      users(3)="Three"
      SHOW GET m.user
</PRE>
<P><LI>Select the List tool, and place a list box on the screen. In the List
   dialog box, select the List Items From Array option, and enter the word
   "Users" (without the quotation marks) in the edit box to the right. In
   the lower-left area, enter the name of the variable as m.user. In the
   edit region to the right of the First Element button enter the numeral
   1. For the # of Elements, enter ALEN(Users). Click OK to return to the
   Screen Builder.

<P><LI>Place another command button on the screen. In its push button dialog
   box, enter a prompt value of "\!\&lt;OK " (without the quotation marks) and
   a variable name value of xyz. Click the Terminate Read on Selection
   check box. Click OK to return to the Screen Builder.

<P><LI>On the File menu, click Save As, and save the file as Addu.scx.

<P><LI>On the Program menu, click Generate to build a source code program
   named Addu.spr.

<P><LI>In the Command window, enter the following command to run the program:
<P>
<P><PRE>      DO ADDU.SPR
</PRE>
<P><LI>Click the Move=&gt; button, and observe the addition of the word "Three"
<P><PRE>    to the list of words in the list box. Click OK to terminate the
    program.
</PRE><P>
</OL>Close FoxPro for Windows, start Visual FoxPro for Windows, and follow these
steps:

<OL><P><LI>In the Command window, enter the following commands, modifying them to
   reflect the appropriate path information:
<P>
   COPY FILE C:\FPW26\Addu.scx to Addu.scx
   COPY FILE C:\FPW26\Addu.scx to Addu.sct
   MODIFY FORM Addu.scx

<P><LI>In the Converter dialog box, click the Continue button to do a
   Functional Conversion.

<P><LI>Enter the following command in the command window to run the new form:
<P>
<P><PRE>      DO FORM addu
</PRE><P>
   NOTE: The cleanup and procedures of an earlier screen are placed in a
   file with the same name as the form, with the extension .SPR.

<P><LI>Click the Move=&gt; button, and observe that the word "Three" does not
   appear in the list box. Click OK to terminate the program.

<P><LI>Enter the following command in the command window:
<P>
<P><PRE>      MODIFY FORM Addu.scx
</PRE>
<P><LI>Click the body of the form. Then click the right mouse button and
   select Edit from the context menu.

<P><LI>Click the Move button to select it, then click the right mouse button
   and select Properties from the context menu.

<P><LI>In the Property sheet for the command button, locate the Valid method
   entry, double-click it to open the edit window for that method. Enter
   the following command just above the SHOW GET m.user command:
<P>
<P><PRE>      ThisForm.Pageframe1.Page1.lstUser2.NumberOfElements = ALEN(Users)
</PRE><P>
   Save the code by pressing CTRL+W. Then on the File menu, click Close,
   and answer Yes to Save changes.

<P><LI>Enter the following command in the Command window "do form addu," and
   then click the Move=&gt; button to see the word "Three" now appears in the
   list.
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist3.00 buglist3.00b buglist5.00 FxotherGeneral vfoxwin vfpbug5.0a kbbuglist<BR>
Version             : 3.0 3.0b 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
