

<HTML>
<HEAD>
<TITLE>HOWTO: Adding or Removing Pages from a PageFrame </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141529">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1995/12/19">
<META NAME="Keywords" CONTENT="FxprgGeneral kbcode vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  With Visual FoxPro, you can use the PageCount property to add and remove pages from a pageframe easily.  If, however, you use ADDOBJECT or REMOVEOBJECT to control the number of pages in the pageframe, you can take advantage of the methods and event...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWA,QAPN,QAEF,QAH4,QBXV,QDH6,QA9N,QAY2,QANJ,QAFR,QADZ,QACI,QAO4,QAA8,QABO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Adding or Removing Pages from a PageFrame</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141529</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
With Visual FoxPro, you can use the PageCount property to add and remove
pages from a pageframe easily.
<P>
If, however, you use ADDOBJECT or REMOVEOBJECT to control the number of
pages in the pageframe, you can take advantage of the methods and events of
the page.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are advantages to defining a page class and using ADDOBJECT or
REMOVEOBJECT instead of changing the PageCount property. Adding a page by
increasing the page count by 1 won't allow changes to any methods or events
associated with the page. All methods or events are read-only at run time.
Defining a page class allows you to place code inside the methods or events
and arrange a page exactly as needed before a page is added to the
pageframe. The following example demonstrates how this is accomplished.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a new form.

<P><LI>Add a pageframe to the form.

<P><LI>Change the PageCount property of the pageframe to 0.

<P><LI>Add three new properties to the form: Page1, Page2, and Page3.

<P><LI>Type the following inside PAGEFRAME1.REFRESH
<P>
   * The following refresh method will help automate the process
   * of adding and removing pages from the pageframe.
   *
<PRE>   *                         Display Page         Not Display Page

   * THISFORM.Page1                .T.                .F.
   * THISFORM.Page2                .T.                .F.
   * THISFORM.Page3                .T.                .F.

   IF THIS.PAGECOUNT &gt; 0
     DIMENSION lcPage(THIS.PAGECOUNT) &amp;&amp; Array of names for visible pages
     FOR lni=1 to THIS.PAGECOUNT
       lcPage(lni)=UPPER(THIS.PAGES(lni).NAME)    &amp;&amp; Does page exist
     ENDFOR
   ELSE
     DIMENSION lcPage(1)
     lcPage(1) = ""
   ENDIF
   FOR lni = 1 to 3         &amp;&amp; Looping stops at 3 because we only have 3
     lcx = "Page"+ALLTRIM(STR(lni))         &amp;&amp; possible pages to display.
     IF THISFORM.&amp;lcx.                   &amp;&amp; IF true display the page
       lny=ASCAN(lcPage,UPPER(lcx))
       IF lny=0               &amp;&amp; If lny=0, then the page does not exist
         THISFORM.PAGEFRAME1.ADDOBJECT(lcx,lcx)
       ENDIF
     ELSE                &amp;&amp; ELSE (The page should NOT be displayed)
       lny=ASCAN(lcPage,UPPER(lcx))
       IF lny&gt;0          &amp;&amp; If lny&gt;0, remove the page from the page frame

         THISFORM.PAGEFRAME1.REMOVEOBJECT(lcx,lcx)
       ENDIF
     ENDIF
   ENDFOR

</PRE><P><LI>Create a program file that contains the following code:
<P>
   SET PROCEDURE TO &lt;this program&gt;
   DO FORM &lt;form name&gt;
<P>
   * Three classes are defined as Page1, Page2, and Page3
   * respectively. These are the pages that will be added
   * with ADDOBJECT inside the PAGEFRAME1.REFRESH.
<P>
   DEFINE CLASS Page1 AS PAGE
<P><PRE>      ADD OBJECT command1 AS COMMANDBUTTON
      PROCEDURE CLICK
<PRE></PRE>         WAIT WINDOW "click" NOWAIT
      ENDPROC
   ENDDEFINE

   DEFINE CLASS Page2 AS PAGE
      ADD OBJECT command2 AS COMMANDBUTTON
   ENDDEFINE

   DEFINE CLASS Page3 AS PAGE
      ADD OBJECT text1 AS TEXTBOX
   ENDDEFINE

</PRE><P><LI>Run the program. You should see a form with an empty pageframe.

<P><LI>Make page1 and page2 visible by typing the following in the Command
   window:
<P>
   _SCREEN.FORMS(1).PAGE1 = .T.
   _SCREEN.FORMS(1).PAGE2 = .T.
   _SCREEN.FORMS(1).PAGE3 = .F.
   _SCREEN.FORMS(1).REFRESH

<P><LI>Make page1 and page3 visible by typing the following in the Command
   window:
<P>
   _SCREEN.FORMS(1).PAGE1 = .T.
   _SCREEN.FORMS(1).PAGE2 = .F.
   _SCREEN.FORMS(1).PAGE3 = .T.
   _SCREEN.FORMS(1).REFRESH
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxprgGeneral kbcode vfoxwin<BR>
Version             : 3.0 3.0b<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
