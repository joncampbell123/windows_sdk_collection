

<HTML>
<HEAD>
<TITLE>PRB: EXAMPLE6.PRG Does Not Print Embedded Word Document </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116477">
<META NAME="KBModify" CONTENT="1995/06/26">
<META NAME="KBCreate" CONTENT="1994/06/20">
<META NAME="Keywords" CONTENT="kbprg kbprb kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The EXAMPLE6.PRG code in the FoxPro for Windows SAMPLE\OLE subdirectory does not print the embedded Microsoft Word for Windows document as stated.  To print the embedded Word for Windows document, make the following changes to the code:     SELECT ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAOX,QDL9,QBWQ,QBWO,QBWN,QAPN,QAH4,QBVV,QA7O,QA7N,QAW6,QDO7,QAGQ,QDMW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: EXAMPLE6.PRG Does Not Print Embedded Word Document</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 26, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116477</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The EXAMPLE6.PRG code in the FoxPro for Windows SAMPLE\OLE subdirectory
does not print the embedded Microsoft Word for Windows document as stated.
<P>
To print the embedded Word for Windows document, make the following changes
to the code:
<P>
<PRE>   SELECT oletable
   LOCATE FOR oletype = "MSWord"
   @ 0,0 SAY OBJECT VERB 0 NOWAIT   &amp;&amp; NOWAIT clause is undocumented.*
   ichan = DDEInitiate("WinWord","System")
   =DDEExecute(ichan, "[FilePrint]")  &amp;&amp; prints the embedded document **
   =DDEExecute(ichan, "[FileClose]")  &amp;&amp; closes the document
   =DDEExecute(ichan, "[FileExit]")   &amp;&amp; exits Word for Windows
   =DDETerminate(ichan)

</PRE><h3>Notes</h3>
 
<P>
<PRE> * There is a NOWAIT clause on the @ ... SAY-BMPs and OLE Objects command
   that is not documented in the "Language Reference" manual or the Help
   file in FoxPro version 2.5 for Windows. (The NOWAIT clause is documented
   in the Help file in FoxPro 2.5a, 2.5b, and 2.6 for Windows.) The purpose
   of the NOWAIT clause is to prevent FoxPro from waiting for Word to
   finish printing.

</PRE>** The DDEExecute() command can execute only a single command at a time.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To test the incorrect code, create a table called OLETABLE and add two
fields, the first having a field type of character and the second having a
field type of general; that is, OLETYPE c(10) and OBJECT g(10). Add one
record in OLETABLE, store "MSWord" in OLETYPE, and embed a WinWord document
in OBJECT. Then execute EXAMPLE6.PRG. FoxPro seems to hang after running
the code and Word for Windows does not print the embedded document stored
in the general field.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 docerr winword DDE<BR>
KBCategory: kbprg kbprb kbdocerr<BR>
KBSubcategory: FxinteropDde<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 26, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
