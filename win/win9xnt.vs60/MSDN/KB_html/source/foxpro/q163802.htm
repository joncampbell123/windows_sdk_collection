

<HTML>
<HEAD>
<TITLE>HOWTO: Retrieving Contact Names from Schedule+ Tasks </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163802">
<META NAME="KBModify" CONTENT="1997/02/19">
<META NAME="KBCreate" CONTENT="1997/02/18">
<META NAME="Keywords" CONTENT="kbinterop kbole kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When processing Schedule+ Tasks via OLE Automation, the only reference to the Contact information is the ContactItemID property. This article shows how to retrieve the Contact information based on that property.  MORE INFORMATION  The methods below...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAL4,QAIF,QAPN,QAH4,QBXD,QBUP,QAUJ,QAG0,QBV0,QA5V,QABI,QAY2,QAGI,QABN,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Retrieving Contact Names from Schedule+ Tasks</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163802</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When processing Schedule+ Tasks via OLE Automation, the only reference to
the Contact information is the ContactItemID property. This article shows
how to retrieve the Contact information based on that property.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The methods below show different ways of processing Schedule+ Tasks. The
method you use depends on whether you know that all of your tasks have
Contacts associated with them.
<P>
<P><h3>Method 1</h3>
 
<P>
The following works only if every task has a Contact. If you get the error,
"Function argument value, type, or count is invalid," on the GetRows method
call, then you know that not every task has a contact, so you have to
process the tasks row by row instead, as shown in Method 2.
<P>
<PRE>   * BEGIN CODE
   oSched = CREATEOBJECT("SchedulePlus.Application")
   oSched.Logon
   mySched = oSched.ScheduleLogged
   myTasks = mySched.SingleTasks
   IF myTasks.Rows &gt; 0  &amp;&amp; Make sure there are tasks to process
      myContacts = mySched.Contacts
      aTasks = myTasks.getrows(100,"text","contactitemid")
      FOR x = 1 TO ALEN(aTasks,1)  &amp;&amp; process the rows in the array
         * The following line limits the Contacts table to the given
         * criteria:  ItemId = &lt;contactitemid from the task&gt;
         myContacts.SetRestriction("itemid",aTasks(x,2),"==")
         oneContact = myContacts.Item
         ?"Task Description: ", aTasks(x,1)
         ?"Contact First Name: ", oneContact.GetProperty("FirstName")
         ?"Contact Last Name: ", oneContact.GetProperty("LastName")
      ENDFOR
   ENDIF
   oSched.Logoff
   * END CODE

</PRE><h3>Method 2</h3>
 
<P>
The following method processes every task in the Schedule+ Task table. It
verifies that there is a contact associated with the task before attempting
to retrieve the contact information.
<P>
<PRE>   * BEGIN CODE
   oSched = CREATEOBJECT("SchedulePlus.Application")
   oSched.Logon
   mySched = oSched.ScheduleLogged
   myTasks = mySched.SingleTasks
   myContacts = mySched.Contacts
   DO WHILE !myTasks.IsEndofTable
      oneTask = myTasks.Item
      ?"Description: ", oneTask.GetProperty("Text")
      * We must verify that there is a contact for the task; otherwise,
      * the GetProperty call will cause an error.
      IF TYPE('oneTask.GetProperty("ContactItemID")') = "C"
         * The following line limits the Contacts table to the given
         * criteria:  ItemId = &lt;contactitemid from the task&gt;
         myContacts.SetRestriction("itemid",;
            oneTask.GetProperty("contactitemid"),"==")
         oneContact = myContacts.Item
         ?"Contact Name: "
         ??ALLTRIM(oneContact.GetProperty("FirstName")) + " "
         ??ALLTRIM(oneContact.GetProperty("LastName"))
      ELSE
         ?"Contact Name: No Contact For This Task"
      ENDIF
      myTasks.Skip(1)
   ENDDO
   oSched.Logoff
   * END CODE

</PRE><h2>REFERENCES</h2>
 
<P>
The Microsoft Developer Network Library, January 1997.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbole kbhowto<BR>
KBSubcategory: FxinteropOle FxprgClassoop FxprgGeneral vfoxwin<BR>
Additional reference words: 3.00 3.00b 5.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
