

<HTML>
<HEAD>
<TITLE>How To Add a Check Box to a List in Visual FoxPro 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157048">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1996/10/04">
<META NAME="Keywords" CONTENT="FxtoolAccessory kbhowto kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you click Toolbars on the View menu, the Toolbars dialog box appears, which allows you to manipulate check boxes from within a ListBox Control. This article illustrates how you can create this functionality using Visual FoxPro.  MORE INFORMATION...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QABI,QAH4,QBVR,QABH,QAHP,QA7O,QAPF,QAOE,QAMN,QAB5,QANX,QA56,QA55,QAKC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Add a Check Box to a List in Visual FoxPro 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157048</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00
WINDOWS
kbtool kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you click Toolbars on the View menu, the Toolbars dialog box appears,
which allows you to manipulate check boxes from within a ListBox Control.
This article illustrates how you can create this functionality using Visual
FoxPro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following steps to create a ListBox control similar to the one in
the Visual FoxPro Toolbars dialog box:

<OL><P><LI>Create a form using the "CREATE FORM test" command. This example assumes
   that you have installed Visual FoxPro and all its components to the
   C:\Vfp directory, and this is what is returned by the VFP HOME()
   command.

<P><LI>Add two new properties, NumLstItm and ItemSel[1], to the form. The first
   property holds the number of items you would like the ListBox control to
   display, and the second property keeps track of whether specific items
   in the ListBox control are selected(1) or not selected(0).

<P><LI>Right-click the form and click Properties on the Shortcut menu. This
   takes you to the Properties dialog box for the form.

<P><LI>Select the NumLstItm property from the All tab or the Other tab of the
   Property dialog box, and set it to the number of items you want to have
   in the ListBox control--for example, set NumLstItm to 5.

<P><LI>Add the following code to the INIT event of the form:
<P>
<P><PRE>      DIMENSION ThisForm.ItemSel(ThisForm.NumLstItm)
      FOR i= 1 to ThisForm.NumLstItm
<PRE></PRE>         ThisForm.ItemSel(i)=0
      endfor

</PRE><P><LI>Add a ListBox control to the form with the following settings:
<P>
<P><PRE>      MultiSelect = .F. - False
      Name = List1
      RowSourceType = 1 - Value
     RowSource = One,Two,Three,Four,Five
</PRE><P>
   NOTE: Make sure that the NumLstItm property of the form is set to the
   same number as the number of items you have in the RowSource property of
   the ListBox control. For example, if the NumLstItm property of the form
   is set to 5, then the RowSource property of the ListBox control should
   contain 5 items separated by commas.

<P><LI>Add the following code to the INIT event of the ListBox control:
<P>
<P><PRE>      This.Picture=HOME()+"samples\tastrade\bitmaps\box.bmp"
</PRE>
<P><LI>Add the following code to the Click event of the ListBox:
<P>
   LPARAMETERS nButton, nShift, nXCoord, nYCoord
   IF LASTKEY()!= 5 AND LASTKEY() != 24
<P><PRE>    IF ThisForm.ItemSel(This.ListItemID)=0
      This.Picture(This.ListItemID)=HOME()+ ;
      "samples\tastrade\bitmaps\checkbx.bmp"
      ThisForm.ItemSel(This.ListItemID)=1
    ELSE
     IF ThisForm.ItemSel(This.ListItemID)=1
</PRE><P>
   This.Picture(This.ListItemID)=HOME()+"samples\tastrade\bitmaps\box.bmp"
<P><PRE>      ThisForm.ItemSel(This.ListItemID)=0
     ENDIF
    ENDIF
</PRE>   ENDIF
<P>
</OL>When you run the form, the Icons of all the Items in the ListBox display an
empty check box. With the above code, if you left-click an item, then the
icon of the item changes to a Box with an "x" in it.

<OL><P><LI>Add the following code to the KEYPRESS event of the ListBox:
<P>
   LPARAMETERS nKeyCode, nShiftAltCtrl
   IF nKeyCode=32
<P><PRE>    IF ThisForm.ItemSel(This.ListItemID)=0
      This.Picture(This.ListItemID)=HOME()+ ;
      "samples\tastrade\bitmaps\checkbx.bmp"
      ThisForm.ItemSel(This.ListItemID)=1
    ELSE
     IF ThisForm.ItemSel(This.ListItemID)=1
</PRE><P>
   This.Picture(This.ListItemID)=HOME()+"samples\tastrade\bitmaps\box.bmp"
<P><PRE>       ThisForm.ItemSel(This.ListItemID)=0
     ENDIF
    ENDIF
</PRE>   ENDIF
<P>
</OL>With the above code if you press the space bar, the Icon of the highlighted
Item toggles between an empty check box and a check box with an "x" in it.

<OL><P><LI>Create a command button and set its caption to "List of Selected
<P><PRE>    Items." Add the following code to the click event of the button:
</PRE><P>
<P><PRE>    isel=""
    FOR i = 1 TO ThisForm.NumLstItm
       IF ThisForm.ItemSel(i)=1
<PRE></PRE>           if i = 1
              isel = isel + ThisForm.List1.ListItem(i)
           ELSE
              isel = isel + ";  " + ThisForm.List1.ListItem(i)
           endif
       ENDIF
    ENDFOR
    WAIT WINDOW isel
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbhowto<BR>
KBSubcategory: FxtoolAccessory<BR>
Additional reference words: 5.00 kbdse VFoxWin<BR>
Keywords          : FxtoolAccessory kbhowto kbtool<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
