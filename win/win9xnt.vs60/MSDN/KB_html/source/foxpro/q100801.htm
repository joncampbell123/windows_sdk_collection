

<HTML>
<HEAD>
<TITLE>Troubleshooting Connectivity Kit Errors w/ FoxPro for Win </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100801">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/06/29">
<META NAME="Keywords" CONTENT="kbtool kbtshoot kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The FoxPro Connectivity Kit can be used with Microsoft FoxPro version 2.5 for MS-DOS and Windows.  Below are some basic steps to troubleshoot Connectivity Kit errors in FoxPro for Windows.  NOTE: The DBConnect() function will make a connection to t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QABM,QBG2,QAAP,QAI5,QAA1,QA9E,QAVX,QAVW,QAH6,QDI2,QAY5,QAU9,QAK6,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting Connectivity Kit Errors w/ FoxPro for Win</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100801</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro Connectivity Kit for Windows and MS-DOS,
   versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The FoxPro Connectivity Kit can be used with Microsoft FoxPro version
2.5 for MS-DOS and Windows.
<P>
Below are some basic steps to troubleshoot Connectivity Kit errors
in FoxPro for Windows.
<P>
NOTE: The DBConnect() function will make a connection to the default
database.  To connect to another database, you must issue the DBExec()
function and USE the other dDatabase.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Delete ODBC.DLL and reinstall by running the Setup program on Disk
   2 of the Connectivity Kit.
<P>
   NOTE: You may want to restart Windows after completing this step.

<P><LI>Delete and reinstall the source driver (for example, SQL
   Server or Oracle).
<P>
   NOTE: If you are using Microsoft SQL Server earlier than
   the version of the Microsoft SQL Server ODBC Driver, your
   SQL Server system administrator may need to upgrade the
   catalog system stored procedures on the server. Please
   refer to Microsoft Knowledge Base Article <B><A href="../sqlserver/q137635.htm">Q137635</A></B>
   for more information on determining if the upgrade is needed.
   The INSTCAT.SQL file for the Microsoft ODBC driver that
   shipped with the FoxPro Connectivity Kit is located on the
   ODBC Setup disk that ships with the kit.

<P><LI>Create a test driver that contains valid information for a DBMS
   connection. Please contact the system administrator to obtain a
   valid server name, user ID, password, and any necessary setup
   strings.

<P><LI>Make note of the complete error message. This is important for
   accurate troubleshooting of the error. The error message format is
<P>
<P><PRE>      [Vendor][ODBC-Component][Data Source] "&lt;Error Message&gt;"
</PRE><P>
   where:
<P>
<P><PRE>    - Vendor provides the name of the ODBC driver's vendor.
</PRE><P>
<P><PRE>    - ODBC-Component provides name of the ODBC component where
      the error was generated.
</PRE><P>
<P><PRE>    - Data Source provides name of the data source. This may not
      always be present in the error message. If this is specified in
      the error, the connection has been made to the data source, and
      an error has occurred after that connection has been established.
</PRE><P>
<P><PRE>    - Error Message provides the specific error that was generated.
</PRE><P>
   Please include as many of the above components of the error message
   as are available.
<P>
   To obtain the error message:
<P>
   a. Obtain the return value of the Connectivity Kit function:
<P>
<PRE>         handle = DBCONNECT("test","myid","mypasswd","")
         ? handle

   b. Initiate two variables, one numeric and one character:

         errmsg = ""
         errno = 0

   c. Use the DBError() function to find the error:

         If the result is -1:
            errtype = DBError(handle,@errmsg,@errno)
         If the result is -2:
            errtype = DBError(0,@errmsg,@errno)

        IMPORTANT: The variables passed to the DBError() function must
        be passed by reference.

      The following program is an example of how to include an
      error-checking routine:

         errmsg = ""
         errno = 0
         connect = "test"
         id = "&lt;user id&gt;"
         password = "&lt;user password&gt;"
         conn_str = "&lt;connection string&gt;"

         handle = DBConnect(connect,id,password,conn_str)

         DO CASE
             CASE handle = -1
                 = DBError(handle,@errmsg,@errno)
                 ?errmsg
             CASE handle = -2
                 = DBError(0,@errmsg,@errno)
                 ?errmsg
         ENDCASE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos CK 2.50 2.50a ODBC connectivity<BR>
tshoot<BR>
KBCategory: kbtool kbtshoot kbprg<BR>
KBSubcategory: FxtoolCk<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
