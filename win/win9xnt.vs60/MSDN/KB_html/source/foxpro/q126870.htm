

<HTML>
<HEAD>
<TITLE>How Transaction Processing Affects Record Locking </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126870">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/03/06">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Record and file locking behavior is slightly different when transaction processing is used in Visual FoxPro.  MORE INFORMATION  When you issue a BEGIN TRANSACTION command, the index of the currently open table is locked. Only the current user is ab...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBXJ,QBV8,QAB9,QABT,QAY5,QAXB,QAL3,QAA8,QAK7,QAJ6,QBSO,QDLB,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How Transaction Processing Affects Record Locking</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126870</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Record and file locking behavior is slightly different when transaction
processing is used in Visual FoxPro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you issue a BEGIN TRANSACTION command, the index of the currently open
table is locked. Only the current user is able to update, add, or delete
records in the table while the transaction is in progress.
<P>
Any command or function that normally places a lock will continue to do so.
Automatic locks are released automatically when the transaction is
completed. Either a ROLLBACK or END TRANSACTION command must be used to end
the transaction. Manual locks - those placed with LOCK(), RLOCK() or
FLOCK() - must be manually released after the transaction is completed.
<P>
This behavior is by design, and is required to ensure the basic
functionality of transaction processing.
<P>
The following coding techniques can be used to minimize contention for
record locks:

<UL><LI>Open all tables before issuing the BEGIN TRANSACTION command. This
   prevents the entire table from being locked as soon as it is opened.

<LI>Buffering should be enabled and all edits performed before the
   transaction starts. The BEGIN TRANSACTION command should be
   issued immediately before a TABLEUPDATE() or a SQLCOMMIT()
   function. Optimistic row buffering provides the shortest locking
   time of all buffering types. However, table buffering must be
   used if you wish to rollback multiple transactions.

<LI>Avoid the use of commands with a FOR scope within the confines of a
   transaction, since these commands lock the entire database. If you must
   use commands such as REPLACE within a transaction, use a SCAN loop to
   perform individual commands instead.

<LI>Close the transaction as soon as possible after the update has been
   applied to the table.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
For more information on buffering and transaction processing, refer to the
Microsoft Visual FoxPro "Developers Guide," or to the following commands
and functions in the "Language Reference":
<P>
<PRE>   BEGIN TRANSACTION
   END TRANSACTION
   ROLLBACK
   CURSORSETPROP()
   TABLEUPDATE()
   TABLEREVERT()
   SQLSETPROP()
   SQLCOMMIT()
   SQLROLLBACK()
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgMultiuser<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
