

<HTML>
<HEAD>
<TITLE>PRB: OLE Error when Inserting OLE Object in VFP for Macintosh </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163025">
<META NAME="KBModify" CONTENT="1997/01/31">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="kbole kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When inserting an OLE object into a general field, adding an insertable OLE object in a container control on a form, or assigning an object name to the DocumentFile property of an OLE container control in program code, the following error message m...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QA9Q,QAB4,QAMB,QA7O,QDO9,QAFI,QAB9,QBV8,QA9N,QBXS,QAH4,QAGB,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: OLE Error when Inserting OLE Object in VFP for Macintosh</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163025</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When inserting an OLE object into a general field, adding an insertable OLE
object in a container control on a form, or assigning an object name to the
DocumentFile property of an OLE container control in program code, the
following error message may appear:
<P>
<PRE>   OLE error code 0x80000008: Unspecified error.

</PRE><h2>CAUSE</h2>
 
<P>
The object inserted into the general field, or added as an insertable
object in an OLE container on a form, or assigned to the DocumentFile
property, has File and Creator types that are not associated with an
application on the Macintosh.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are several workarounds to this error:

<UL><LI>Open the file/graphic in an existing application on the Macintosh, then
   copy and paste the text/graphic into the general field.

<LI>Use a resource editor such as Apple's ResEdit to change the File and
   Creator type to the types required by the application server.

<LI>Use the Foxtools.cfm function FxSetType() to set the File and Creator
   type of the file to types associated with an application installed on
   the Macintosh.
<P>
</UL>For more information on using the FxSetType() function with an Imager File,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q152370.htm">Q152370</A></B>
   TITLE     : How To Use the APPEND GENERAL Command with an Imager File

   ARTICLE-ID: <B><A href="../foxpro/q109482.htm">Q109482</A></B>
   TITLE     : How To Change the Creator and Type Set by FCREATE()

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
On the Macintosh, all files are associated to an application by either the
File or Creator type. A file's Creator and Type attributes identify the
parent application of a file and its specific kind. The Type attribute is
used by other applications in order to determine whether a file is a valid
document to load. Whereas in Windows, files are generally associated to
applications by their file extension.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
This error message can be produced in the following three methods.
<P>
Method 1:
<P>
Attempt to assign a file to the DocumentFile property in code when creating
an OLE object using the CREATEOBJECT() function.
<P>
NOTE: By default, the "Picts folder" and the graphics do not exist. Visual
FoxPro ships with sample graphics files that are contained in a self-
extracting archive (SEA) file located in the "Microsoft Visual
FoxPro:Samples:Graphics" folder. To follow the steps below, double-click
the Picts.sea to extract the PICT files. Store them in the default folder
specified "Picts Folder." For more information of these SEA files, read the
Graphics Readme in the above folder.
<P>
<PRE>   * The file and creator types used below are specific to Microsoft Imager
   * Uncomment the next three lines of code to prevent OLE error
   * mypict= HOME()+"Samples:Graphics:Picts Folder:Fox:Add.PICT"
   * SET LIBRARY TO HOME() + "Foxtools.cfm" ADDITIVE
   * =FxSetType(SYS(2027,mypict ),"PICT","MIMG")

   frmMyForm = CREATEOBJECT('form')  &amp;&amp; Create a form
   frmMyForm.Closable = .F.  &amp;&amp; Disable the close box
   frmMyForm.AddObject('cmdCommand1','cmdMyCmdBtn')  &amp;&amp; Add Command button
   frmMyForm.AddObject("oleObject","oleImager")      &amp;&amp; Add OLE object
   frmMyForm.cmdCommand1.Visible=.T.   &amp;&amp; Display the "Quit" Command button
   frmMyForm.oleObject.Visible=.T.     &amp;&amp; Display the OLE control
   frmMyForm.oleObject.Height = 50     &amp;&amp; OLE control height
   frmMyForm.oleObject.AutoActivate = 2
   frmMyForm.Show  &amp;&amp; Display the form
   frmMyForm.oleObject.DoVerb(0)       &amp;&amp; 0 for Default, -1 for Edit

   READ EVENTS  &amp;&amp; Start event processing
   CLEAR CLASS oleImager

   DEFINE CLASS oleImager as OLEControl
      OleClass ="MSImager.2"  &amp;&amp; Server name
      * Uncomment next line, comment 2nd DocumentFile to prevent error
      * DocumentFile = mypict
      DocumentFile = HOME()+"Samples:Graphics:Picts Folder:Fox:Add.PICT"
   ENDDEFINE

   DEFINE CLASS cmdMyCmdBtn AS CommandButton  &amp;&amp; Create Command button
      Caption = '\&lt;Quit'  &amp;&amp; Caption on the Command button
      Cancel = .T.  &amp;&amp; Default Cancel Command button (Esc)
      Left = 125    &amp;&amp; Command button column
      Top = 210     &amp;&amp; Command button row
      Height = 25   &amp;&amp; Command button height

      PROCEDURE Click
         CLEAR EVENTS  &amp;&amp; Stop event processing, close form
      ENDPROC
   ENDDEFINE

</PRE>Method 2:
<P>
Attempt to insert an OLE object into an OLE container on a form:

<OL><P><LI>Create a new form.

<P><LI>From the Form Controls toolbar, select the OLE Container Control button
   and click somewhere on the form.

<P><LI>In the Object Type dialog box, choose Microsoft Imager 2.0 Picture. Then
   choose the 'From File' option button under the Create label.

<P><LI>Then select Add.PICT from the following folder:
<P>
<P><PRE>      MACINTOSH HD:VFP:Samples:Graphics:Picts Folder:Fox
</PRE><P>
</OL>Method 3:
<P>
Directly insert the OLE object into the general field of the table.

<OL><P><LI>Create a table with a general field.

<P><LI>Browse the table and double-click on the general field to open the
   general field window.

<P><LI>Choose the Insert Object command on the Edit menu.

<P><LI>In the Object Type dialog box, choose Microsoft Imager 2.0 Picture. Then
   choose the 'From File' option button under the Create label.

<P><LI>Then select Add.PICT from the following folder:
<P>
<P><PRE>      MACINTOSH HD:VFP:Samples:Graphics:Picts Folder:Fox
</PRE><P>
</OL>The task in Method 3 can also be accomplished by using the APPEND GENERAL
command. For more information on using the APPEND GENERAL command with OLE
objects, please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q152370.htm">Q152370</A></B>
   TITLE     : How To Use the APPEND GENERAL Command with an Imager File

   ARTICLE-ID: <B><A href="../foxpro/q137295.htm">Q137295</A></B>
   TITLE     : How To Convert Memo Fields into Embedded Word Documents

</PRE></OL>NOTE: If error messages are received regarding problems with OLE
functionality, please refer to the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q151636.htm">Q151636</A></B>
   TITLE     : Insert Object of an Imager File Causes Error or Hangs Mac

   ARTICLE-ID: <B><A href="../office/q141099.htm">Q141099</A></B>
   TITLE     : MXL5 Err Msg: "Cannot Start the Source Application"

</PRE>(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Dean Christopher, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbole kbprb<BR>
KBSubcategory: FxinteropOle vfoxmac<BR>
Additional reference words: 3.00b
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
