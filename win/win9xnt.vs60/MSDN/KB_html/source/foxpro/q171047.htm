

<HTML>
<HEAD>
<TITLE>PRB: Insufficient Memory in FoxPro for Windows on Fast Computers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171047">
<META NAME="KBModify" CONTENT="1998/01/08">
<META NAME="KBCreate" CONTENT="1997/07/07">
<META NAME="Keywords" CONTENT="FoxWin FxenvGeneral kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Working programs in FoxPro 2.x fail with  Insufficient Memory  when run on newer, faster computers with clock speeds greater than 150 MHz. This problem applies to both screens with list boxes and queries, but this article addresses only the problem...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAH4,QA5V,QBWO,QBE7,QBE6,QDL9,QBWQ,QBWN,QAKP,QAU3,QANE,QAB4,QBWS,QAMR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Insufficient Memory in FoxPro for Windows on Fast Computers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171047</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.6 &amp; 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Working programs in FoxPro 2.x fail with "Insufficient Memory" when run on
newer, faster computers with clock speeds greater than 150 MHz. This
problem applies to both screens with list boxes and queries, but this
article addresses only the problem with FoxPro screens.
<P>
The "Insufficient Memory" error message may also occur while in Filer when
changing to a local(not network) directory which contains a large number of
files.
<P>
The failure also happens on both MMX and non MMX Computers. The
operating system could be Windows 3.x, Windows for Workgroups 3.x,
Windows 95 or Windows NT.  This error does not occur in FoxPro
For MS-Dos.
<P>
<P><h2>CAUSE</h2>
 
<P>
The current fast computers were not available for testing when FoxPro 2.x
for Windows was initially released. Microsoft FoxPro for Windows, 2.x does
not always work with list boxes populated from tables with more than 600
records.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
At this time Microsoft does not have a good workaround; however, the
following are options to consider:

<OL><P><LI>Upgrade the application to Visual FoxPro 3.0 or 5.0.

<P><LI>Turn off either CMOS cache (slow) or CMOS turbo mode (very slow).

<P><LI>Reduce the number of records to be displayed in the ListBox (under 600).

<P><LI>Run the FoxPro applications (app) and executables (exe) on a slower
   computer.

<P><LI>Using an array as the source of the list items in the list box is the
   best resolution for this problem. To change the screen created in the
   Steps to Reproduce Behavior section below, follow these steps.
<P>
<P><PRE>      a. In the Setup Code for the screen, add the following command:
</PRE><P>
<PRE>            COPY TO ARRAY aTableField FIELDS charval

      b. Double click the listbox on the screen while in design mode.
         In the List dialog box that appears, change the List Items to
         From Array and put aTableField in for the array name. Choose Ok.

      c. Save and generate the screen.

      d. Although this shouldn't be necessary, it has been reported that
         the array needs to be released when the screen is closed. To do
         this, add the following command to the Cleanup Code of the screen:

            RELEASE ALL LIKE aTableField

</PRE></OL>Along with the steps listed above, some users have found that adding the
following line to the Config.fpw file helps to solve the problem:
<P>
<PRE>   MEMLIMIT = 60,2048,4098

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base, as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the Microsoft Knowledge Base at <B><A href="http://www.microsoft.com/kb">http://www.microsoft.com/kb</A></B> to
troubleshoot other potential causes of "Insufficient memory" errors. Verify
that the error is due to the processor speed by trying the code on both a
fast and slow computer.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following is a reproducible case where FoxPro for Windows 2.x fails
with "Insufficient memory" with a list box on a screen.

<OL><P><LI>Place the following code in a new program file. Save it as LarTable.prg:
<P>
<P><PRE>      * Sample code to create and populate a large table to test your
      * program.
</PRE><P>
<P><PRE>      * Environment area.
<PRE></PRE>          CLEAR
          CLOSE DATABASES
          CLEAR SCREEN

      * Create a large table
          CREATE TABLE LarTable (CharVal C(20), NumVal N(9))
          USE LarTable.DBF

      * NumRecords = the number of record to be put in the table.
          NumRecords= 2000

      * Note using larger numbers can take a long time.
          NumWide = LEN(ALLTRIM(STR(NumRecords)))

      * FOR LOOP to fill the table.
          FOR x  = 1 TO NumRecords
           CharString="Record "+PADL(ALLTRIM(STR(x,numwide,0)),NumWide,"0")
           INSERT INTO LarTable (CharVal,NumVal) VALUES(CharString, x)
           ? RECNO()
          ENDFOR

          CREATE SCREEN LarTable.scx NOWAIT

</PRE><P><LI>Add a ListBox object from the toolbar on the left of the screen.

<P><LI>Select the "From Field" radio button and type LarTable.Charval in the
   Field dialog box.

<P><LI>Type "MyList" in the Variable text box. Click OK to close the dialog
   box. Resize the ListBox, if necessary.

<P><LI>Add a Push Button. Use "Close" as the prompt, Check the "Terminate READ
   on Selection" check box. Enter "xyz" for the variable.

<P><LI>Generate and run the LarTable.spr screen. It should run without error
   on computers slower than a 166 MHz computer.

<P><LI>It should fail with an "Insufficient Memory" error on most computers
   166 MHZ or faster. Use "mybutton" as the variable prompt.
<P>
</OL>The code generally fails when the screen loads on faster machines. This
problem happens only when the table contains more than about 600 records.
Try deleting all but the first 600 records:
<P>
<PRE>   DELETE ALL FOR RECNO &gt; 600

</PRE></OL>(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Mike Fernald, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: foxwin fpw MMX<BR>
Keywords          : FoxWin FxenvGeneral kbbuglist<BR>
Version           : WINDOWS:2.6a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
