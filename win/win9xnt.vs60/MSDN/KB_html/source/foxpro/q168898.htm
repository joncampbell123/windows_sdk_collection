

<HTML>
<HEAD>
<TITLE>PRB: Wizstyle Add Button Does Not Add Child Record </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168898">
<META NAME="KBModify" CONTENT="1997/05/22">
<META NAME="KBCreate" CONTENT="1997/05/22">
<META NAME="Keywords" CONTENT="FxtoolWizscreen vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Add button, in all of the navigation classes in the WIZSTYLE class library (Wizstyle.vcx), does not work correctly when adding a record to a child table. This problem occurs when the field linking the Parent to the Child table is of type Numeri...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACI,QA5V,QA4H,QA9N,QAY4,QBWS,QA7O,QA7N,QAKD,QASR,QAH4,QAUR,QARR,QBVV,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Wizstyle Add Button Does Not Add Child Record</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168898</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Add button, in all of the navigation classes in the WIZSTYLE class
library (Wizstyle.vcx), does not work correctly when adding a record to a
child table. This problem occurs when the field linking the Parent to the
Child table is of type Numeric.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To workaround this issue, create a character version of the fields in each
table. The character fields can then be used to set the relation between
the two tables.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The WIZSTYLE class library (Wizstyle.vcx) contains many class definitions.
There are three class definitions that are used to navigate in tables:
txtbtns, picbtns, and verttxtbtns. Each of these classes have an Add
button. In a one-to-many table configuration if the field linking the
Parent and Child tables is of type numeric, then the Add button, for any of
the navigation classes, does not work correctly when adding a record to the
child table.
<P>
The following steps illustrate the behavior of using the txtbtns navigation
buttons class on a One-to-Many form.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
There are two parts in setting up this example: Part 1 is to create the two
tables used in the One-to-Many wizard. Part 2 is to create the One-to-Many
form using the wizard.
<P>
Part 1 - Create the two tables used in the One-to-Many wizard:

<OL><P><LI>Save the following code to a file called Creatabs.prg:
<P>
<P><PRE>      *** Begin code ***
      CREATE TABLE parent (Char1 C(2),  Id N(2))
      CREATE TABLE child (Id N(2), Value1 N(3), Value2 N(4))
      SELECT child
      INDEX ON Id TAG Id
      INSERT INTO parent (Char1,Id) VALUES ('11',11)
      INSERT INTO parent (Char1,Id) VALUES ('22',22)
      INSERT INTO parent (Char1,Id) VALUES ('33',33)
      INSERT INTO child  (Id,Value1,Value2) VALUES (11,111,1111)
      INSERT INTO child (Id,Value1,Value2) VALUES (11,123,1234)
      INSERT INTO child (Id,Value1,Value2) VALUES (11,134,1345)
      INSERT INTO child (Id,Value1,Value2) VALUES (22,222,2222)
      INSERT INTO child (Id,Value1,Value2) VALUES (22,234,2345)
      INSERT INTO child (Id,Value1,Value2) VALUES (33,333,3333)
      *** End code ***
</PRE>
<P><LI>Run Creatabs.prg that creates both tables and inserts values into each
   table:
<P>
</OL>Part 2 - Create the 'One-to-Many' Form:

<OL><P><LI>From the Visual FoxPro File menu, select New, and then click Form. Click
   the Wizard button.

<P><LI>On the Wizard Selection dialog box, click the One-to-Many Wizard.
<P>
   a. In Step 1, move all the fields from the Parent table to the
<P><PRE>      Selected fields pane.
</PRE><P>
   b. In Step 2, move all the fields from the child table to the
<P><PRE>      Selected fields pane.
</PRE><P>
   c. In Step 3, click Next, as the parent.id = child.id is relation is
<P><PRE>      correctly set.
</PRE><P>
   d. In Step 4, click Next after choosing a form style.
<P>
   e. In Step 5, move the Char1 field to the Selected fields pane.
<P>
   f. In Step 6, select the Save and Run button, and click
<P><PRE>      Finish.
</PRE><P>
</OL>NOTE: At this point, the Save As dialog box appears. Once a name has been
entered, and the Save button is clicked, the form will run.

<OL><P><LI>Click the Add button.

<P><LI>In the Add Record dialog box, click Add record to child (grid)
   only, and click the Add button.
<P>
</OL>NOTE: The wizard-generated code has not added a new record to the grid, nor
it is not possible to move the cursor into a blank row of the grid.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: disabled<BR>
Keywords            : FxtoolWizscreen vfoxwin<BR>
Version             : 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
