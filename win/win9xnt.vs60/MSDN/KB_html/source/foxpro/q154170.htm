

<HTML>
<HEAD>
<TITLE>BUG: @...SAY Prints Gray Background </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154170">
<META NAME="KBModify" CONTENT="1997/12/15">
<META NAME="KBCreate" CONTENT="1996/07/31">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b FoxWin FxprintRaw vfoxwin vfpbug5.0a kbprint kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  It is possible that @...SAYs prints with a gray or dark-shaded background when printed from Windows 95 or Windows NT 4.0 using either Microsoft Visual FoxPro for Windows or FoxPro for Windows 2.6. This problem can be encountered with all versions o...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAG9,QDL9,QBWQ,QBWO,QBWN,QBWP,QAH4,QAPG,QBXS,QAOX,QAY2,QAGQ,QAB5,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: @...SAY Prints Gray Background</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154170</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Microsoft FoxPro for Windows version, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
It is possible that @...SAYs prints with a gray or dark-shaded background
when printed from Windows 95 or Windows NT 4.0 using either Microsoft
Visual FoxPro for Windows or FoxPro for Windows 2.6. This problem can be
encountered with all versions of Windows. However, it appears more often
under Windows 95 and Windows NT 4.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
There are several reasons why @...SAYS may print a shaded background. It
could be because the window color is set to a color other than white in the
Windows 95 or Windows NT 4.0 Display Properties. In Microsoft Visual FoxPro
and FoxPro for Windows 2.6, the background color of the desktop will
affect the @...SAYs used in programs. Also, if the @...SAY code is executed
from a form in Microsoft Visual FoxPro or a screen in Microsoft FoxPro
for Windows 2.6, the background color of these objects will affect printout
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To change the background color of all windows under Windows 95 or Windows
NT 4.0, the Window color must be changed in the Appearance tab of the
Display Properties. To change this property, alternate-click on the Windows
95 or Windows NT 4.0 desktop and select Properties from the Shortcut menu.
This will bring up the Display Properties window. Click on the Appearance
tab, and then select Window in the drop-down list under Item. From the
color picker, choose white.
<P>
This option may not be desirable because users will have to keep the window
color white anytime they print in @..SAYs from FoxPro under Windows 95 or
Windows NT 4.0. A better way to implement this is to check the background
color of the window or desktop from the code, the form, or the screen prior
to issuing the @...SAY. Below are the steps to implement this with
Microsoft Visual FoxPro 3.0 and Microsoft FoxPro for Windows 2.6.
<P>
If the @...SAY code is executed from a program in Visual FoxPro for
Windows, the window color can be changed with the following code:
<P>
<PRE>   IF _Screen.BackColor != 16777215    &amp;&amp;Is color value white?
      _Screen.LockScreen = .T.         &amp;&amp;Keep screen from flashing
      cOldbackcolor = _Screen.BackColor      &amp;&amp;Save background color
      _Screen.BackColor = RGB(255,255,255)   &amp;&amp;Set BackColor to RGB white,
                           &amp;&amp;Same as color value 16777215
      SET DEVICE TO PRINTER
      @1,1 say 'This is a test.'
      SET DEVICE TO SCREEN
      SET PRINTER TO
      _Screen.BackColor = cOldbackcolor
      _Screen.LockScreen = .F.
   ENDIF

</PRE>If the @...SAY code is executed from a form in Visual FoxPro for Windows,
the form's background color can be modified with the following code:
<P>
<PRE>   IF ThisForm.BackColor != 16777215
      ThisForm.LockScreen = .T.
      SET DEVICE TO PRINTER
      cOldbackcolor = ThisForm.BackColor
      ThisForm.BackColor = RGB(255,255,255)
      @1,1 SAY 'This is a test'
      SET DEVICE TO SCREEN
      SET PRINTER TO
      ThisForm.BackColor = cOldbackcolor
      ThisForm.LockScreen = .F.
   ENDIF

   NOTE: This code may be placed in the Click event of a Command button.

</PRE>In FoxPro for Windows 2.6, use the following code to change the window
color:
<P>
<PRE>   cOldscheme = SET('Color of Scheme 1')        &amp;&amp;Obtain old color
   MODIFY WINDOW SCREEN COLOR RGB(0,0,0,255,255,255)  &amp;&amp;Set color white
   SET DEVICE TO PRINTER
   @1,1 say ' This is a test.'
   SET DEVICE TO SCREEN
   SET PRINTER TO
   MODIFY WINDOW SCREEN COLOR &amp;cOldscheme

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the @...SAY code is executed from Visual FoxPro for Windows with Windows
95 or Windows NT 4.0 as the operating system, all printed pages will be
shaded.
<P>
Using FoxPro for Windows 2.6 and Windows 95 or Windows NT 4.0, only the
first page is shaded. All others print normally.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In Windows 95 or Windows NT 4.0, right-click the desktop. From the
   Shortcut menu, select Properties.

<P><LI>In the Display Properties dialog box, click the Appearance tab. In the
   Item drop-down list, select Window.

<P><LI>Click the Color drop-down list, and change the color to gray or any
   color other than white.

<P><LI>Open Visual FoxPro for Windows or FoxPro for Windows 2.6, and create a
   program with the following code:
<P>
   SET DEVICE TO PRINTER
<PRE>   FOR i = 1 TO 2       &amp;&amp;Loop shows different output from VFP &amp;FPW26
      @1,1 SAY 'This is a printing test' FONT 'Arial',14
      @3,1 SAY 'From '+VERSION() + ' under ' + OS(1) FONT 'Courier New'
   ENDFOR
   SET DEVICE TO SCREEN
   SET PRINTER TO

   NOTE: The above code can be executed in a FoxPro for Windows 2.6 screen,
   as well as in a Visual FoxPro for Windows 3.0 form.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprint kbbuglist<BR>
KBSubcategory: FxprintRaw vfoxwinFoxWin buglist3.00 buglist3.00b<BR>
buglist5.00<BR>
Additional reference words: 5.00 3.00 3.00b<BR>
Keywords          : buglist3.00 buglist3.00b FoxWin FxprintRaw vfoxwin vfpbug5.0a kbprint kbbuglist<BR>
Version           : 2.6a 3.0 3.0b 5.0 5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
