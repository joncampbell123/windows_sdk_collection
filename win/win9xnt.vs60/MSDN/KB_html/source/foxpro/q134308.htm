

<HTML>
<HEAD>
<TITLE>FIX: Upper Format Truncates Right/Center-Alligned Report Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134308">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/08/03">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b fixlist5.00 FxprintGeneral vfoxwin kbbuglist kbfixlist kbprint">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using a report designed with a field, variable, or expression formatted as uppercase and justified (alligned) either to the right or center of the area on the page for that field, you may encounter a probem. Upon clicking the OK button to open...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QABH,QBT6,QA7O,QA7N,QBWS,QAH4,QAHP,QDNG,QABI,QBJZ,QA01,QAUD,QAE8,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Upper Format Truncates Right/Center-Alligned Report Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134308</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbtool kbprint kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using a report designed with a field, variable, or expression
formatted as uppercase and justified (alligned) either to the right or
center of the area on the page for that field, you may encounter a probem.
Upon clicking the OK button to open and close the report expression dialog
box repeatedly (usually done after previewing or printing the report), you
may see that the field, variable, or expression has been reduced to a
single character; all the characters to the right of the first character
have been truncated. The field, variable, or expression now appears as a
single uppercase character alligned to the right or to the center. The
format picture code character string of "@!J" (without the quotes) is
transposed and enlarged to the string "@J&lt;space&gt;!"
<P>
Each time the Report Expression dialog box is reentered the number of
spaces between the justification code (J for right, I for center) and the
uppercase code (!) is increased by one if the OK button is used to close
the dialog box.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
One way to restore the field to the desired format is to delete the format
picture codes from the Format text box in the Report Expression dialog box.
Then click the three-dot button at the right to move to the Format dialog.
Restore the formats by selecting the To Upper Case check box, and the
appropriate justification check box.
<P>
Another way to work around the problem is to delete the space(s) that
appear in the format picture codes string between the justification
character (a J or an I) and the exclamation point that indicates uppercase.
This is the string that appears in the Format text box in the Report
Expression dialog box.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Set the default directory to Samples\Data.

<P><LI>Open the Testdata database by using the MODIFY DATABASE TESTDATA
   command,

<P><LI>Open the Customer table by using the USE CUSTOMER command.

<P><LI>Create a new report consisting of the Company, Contact, and Title
   fields. To do this, on the File menu, click New. Then click Report, and
   click New File. Then open the data environment of the report and add the
   Customer table to it. Drag the selected fields to the Detail band of the
   Report Designer.

<P><LI>Double-click the Contact field to open the Report Expression dialog box.

<P><LI>Click the three-dot button located to the right of the Format text box.

<P><LI>Select the To Upper Case check box under Editing Options.

<P><LI>Clear the Left justify check box, and select the Right justify check
   box.

<P><LI>Click OK to return to the Report Expression dialog box. Note the format
   picture codes. Now click OK to exit the Report Expression dialog box.

<P><LI>On the View menu, click Preview. Note that the Contact field appears is
<P><PRE>    in uppercase and right-justified (right-alligned).
</PRE>
<P><LI>On the Preview toolbar, click the open door icon to return to the
<P><PRE>    Report Designer.
</PRE>
<P><LI>Double-click the Contact field to open the Report Expression dialog
<P><PRE>    box. Here you will observe, in the Format edit box that the picture
    code characters are in a sequence different from that originally seen.
</PRE>
<P><LI>Click OK to return to the Report Designer, and on the View menu, click
<P><PRE>    Preview to preview the report again. Note that the Contact field is now
    a single uppercase letter positioned at the right of the field's area
    on the report.
</PRE>
<P><LI>Return to the Report Designer. Double-click the Contact field. Note the
<P><PRE>    spacing between characters in the Format text box.
</PRE>
<P><LI>Click OK. Then double-click the Contact field again, and note that the
<P><PRE>    spaces in the Format text box have increased by one.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbprint kbbuglist kbfixlist<BR>
KBSubcategory: FxprintGeneral fixlist5.00 VFoxWin buglist3.00 buglist3.00b<BR>
Additional reference words: 3.00 3.00b picture function<BR>
Keywords          : buglist3.00 buglist3.00b fixlist5.00 FxprintGeneral vfoxwin kbbuglist kbfixlist kbprint kbtool<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
