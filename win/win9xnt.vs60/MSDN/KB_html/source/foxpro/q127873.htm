

<HTML>
<HEAD>
<TITLE>PRB: Records Seem Missing from FoxPro 2.5 Table in Later Vers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127873">
<META NAME="KBModify" CONTENT="1995/03/23">
<META NAME="KBCreate" CONTENT="1995/03/21">
<META NAME="Keywords" CONTENT="kbusage kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  CDX tags containing a conditional test for the length of the key expression may return a different result set between FoxPro version 2.5 for MS-DOS and FoxPro version 2.5a (or higher) for MS-DOS, where trailing spaces (blanks) are stored with keys ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QA28,QATJ,QAH4,QANC,QATX,QAC1,QA5V,QAYV,QBWS,QBWA,QAY2,QAMB,QALW,QAI4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Records Seem Missing from FoxPro 2.5 Table in Later Vers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 23, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127873</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.5a, 2.5b, 2.6, and 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
CDX tags containing a conditional test for the length of the key expression
may return a different result set between FoxPro version 2.5 for MS-DOS and
FoxPro version 2.5a (or higher) for MS-DOS, where trailing spaces (blanks)
are stored with keys or are used to search for keys.
<P>
This problem occurs only when using an untouched version 2.5 table and CDX
in a later version.
<P>
<P><h2>CAUSE</h2>
 
<P>
There was a minor change in how the CDX tag is stored and read from the CDX
file between version 2.5 and later versions. This change was made to
accommodate index key construction for other-than machine collation
sequences.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Reindex the file in the current version.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Copy and run the following code in FoxPro version 2.5 for MS-DOS:
<P>
   CREATE TABLE cdxtest (f1 C(10))
   INDEX ON f1 TAG f1 FOR f1 &lt;&gt; "ABCD"
   APPEND BLANK
   REPLACE f1 WITH "ABC"
<P>
   * Find a string with no trailing blanks
   ? "'ABC'"
   SEEK ("ABC")
<PRE>   ? FOUND()                &amp;&amp; Returns true in all versions

   * Find a string with trailing blanks
   ? "'ABC '"
   SEEK ("ABC ")
   ? FOUND()                &amp;&amp; Returns true in 2.5

</PRE><P><LI>Copy and run the following code in version 2.5a or later:
<P>
   USE C:\fpd25\cdxtest ORDER f1  &amp;&amp; Open the file created in 2.5
<P>
   * Find a string with no trailing blanks
   ? "'ABC'"
   SEEK ("ABC")
<PRE>   ? FOUND()                &amp;&amp; Returns true in all versions

   * Find a string with trailing blanks
   ? "'ABC '"
   SEEK ("ABC ")
   ? FOUND()                &amp;&amp; Returns *FALSE* until reindexed.

</PRE><P><LI>Reindex the file in the later version. Then run the code again. Notice
   that the second SEEK where the string has trailing blanks is found this
   time.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbusage kbprb<BR>
KBSubcategory: FxotherGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 23, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
