

<HTML>
<HEAD>
<TITLE>PRB: SAY Field Refresh Option Causes Hidden Window to Reappear </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112484">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1994/03/09">
<META NAME="Keywords" CONTENT="FxtoolSbuilder kbdisplay kbprb kbprg kbui">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are running a screen set with multiple windows in which one has been hidden, the hidden window reappears even when a SHOW WINDOW command has not been executed.  CAUSE =====  In addition to other screen objects, the hidden window contains a...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAA8,QAXB,QA7O,QA7N,QBXS,QAPN,QAFR,QAUD,QA5A,QAGQ,QAUR,QA50,QABI,QABH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SAY Field Refresh Option Causes Hidden Window to Reappear</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112484</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>2.50b     | 2.00 2.50 2.50a 2.50b | 2.50 2.50a 2.50b
MACINTOSH | MS-DOS                | WINDOWS
</PRE>kbprg kbprb kbui kbdisplay
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, version 2.5b
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, and 2.5b
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are running a screen set with multiple windows in which one has
been hidden, the hidden window reappears even when a SHOW WINDOW command
has not been executed.
<P>
<P><h2>CAUSE</h2>
 
<P>
In addition to other screen objects, the hidden window contains at least
one SAY/output object, and the Refresh Output Field check box is selected.
A SHOW GETS command that does not include a WINDOW clause is placed in a
user-defined code snippet to update objects on the screen.
<P>
To understand why this behavior occurs requires looking at the generated
screen code. When the FoxPro screen code generator (GENSCRN.PRG) creates
the screen program (.SPR) from a screen with a SAY/output field, the
Refresh property of which has been checked, it generates code in the SHOW
snippet which looks like the following:
<P>
<PRE>   IF SYS(2016) = "SCR1" OR SYS(2016) = "*"
      ACTIVATE WINDOW scr1 SAME
      @ 1.000,2.800 SAY company ;
         SIZE 1.000,80.800, 0.000 ;
         FONT "MS Sans Serif", 8
   ENDIF

</PRE>As documented in the "Language Reference" and the online Help system,
SYS(2016) returns the name of the window to be refreshed by the last SHOW
GETS command executed. If SHOW GETS is called without the optional WINDOW
clause, SYS(2016) will return an asterisk (*). It is the ACTIVATE WINDOW
command in the IF ... ENDIF block above that causes the hidden window to be
redisplayed.
<P>
The following command will update the objects on the current window only:
<P>
<PRE>   SHOW GETS WINDOW (WOUTPUT())

</PRE><h2>RESOLUTION</h2>
 
<P>
See "Workarounds" in the "Steps to Reproduce Behavior" section below.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: ANY USE OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK.
Microsoft provides this code "as is" without warranty of any kind, either
expressed or implied, including but not limited to the implied warranties
of merchantability and/or fitness for a particular purpose.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following procedure illustrates the behavior described. The steps
describe dialog boxes and objects found in FoxPro for Windows and FoxPro
for Macintosh. Minor differences exist in the FoxPro for MS-DOS
environment.

<OL><P><LI>Open the CUSTOMER table (CUSTOMER.DBF) in the TUTORIAL subdirectory
    beneath the FoxPro main directory.

<P><LI>Create a screen, and save it as SCR1.SCX.

<P><LI>In SCR1, choose Screen Layout from the Screen menu and type "SCR1"
    (without the quotation marks) as the window name and "SCR 1" (without
    the quotation marks) as the window title.

<P><LI>Create an output field, select the Refresh Output Field check box, and
    specify the COMPANY field as the field to output.

<P><LI>Create a push button with the prompts "OK" and "NEXT SCREEN" and an
    "M.OK" variable. In the VALID code snippet, enter the following code:
<P>
       DO CASE
<PRE>          CASE m.ok=1
             CLEAR READ
          CASE m.ok=2
             HIDE WINDOW scr1
             SHOW WINDOW scr2
             _CUROBJ=OBJNUM(m.choice)
        ENDCASE

</PRE><P><LI>Create a second screen, and save it as SCR2.SCX.

<P><LI>In SCR2, choose Screen Layout from the Screen menu and type "SCR2"
    (without the quotation marks) as the window name and "SCR 2" (without
    the quotation marks) as the window title.

<P><LI>Create an output field, select the Refresh Output Field check box, and
    specify the CONTACT field as the field to output.

<P><LI>Create a push button set with the prompts "OK" and "Update" and an
    "M.CHOICE" variable. In the VALID code snippet of the push button set,
    enter the following code:
<P>
       DO CASE
<PRE>          CASE m.choice=1
             CLEAR READ
          CASE m.choice=2
             SKIP
             SHOW GETS &amp;&amp; WINDOW (WONTOP())
       ENDCASE

</PRE><P><LI>In the ON SCREEN ENTRY (When) code snippet, enter the following
    line of code:
<P>
       HIDE WINDOW SCR2

<P><LI>Save both SCR1.SCX and SCR2.SCX, bring SCR1.SCX to the foreground,
    and generate the two screens together. SCR1 should be listed first
    in the screen set list box.

<P><LI>Run the screen program SCR1.SPR. Disregard the momentary appearance
    of SCR2. This is a side-effect of combining two independent screens
    together in a single READ and is discussed below. When SCR1 is
    waiting to receive input, choose the Next Screen push button. SCR1
    disappears and SCR2 appears. Clicking Update causes SCR1 to
    reappear.
<P>
</OL><h3>Workarounds</h3>
 
<P>
To correct the screen set created above, eliminate the comments (&amp;&amp;) in
step 9, save SCR2.SCX, and regenerate the screen set, making sure that SCR1
is listed first in the screen set list box of the Generate Screen dialog
box.
<P>
There are a variety of ways to combine a screen set. If the limit on the
number of READs is a concern, see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q106697.htm">Q106697</A></B>
   TITLE     : How to Prevent "Too Many READs in Effect" Error Message

</PRE></OL>It describes a method of switching between screens without incrementing the
READ level much like the sample application EX1 included with Microsoft
FoxPro.
<P>
If speed of execution between screens is a concern, SAY fields cannot be
used. Instead, use GET objects. In the WHEN clause of each GET, return the
value .F., so that the user cannot enter the field.
<P>
A fundamental problem exists with the method described for tying two
independent screens together in a single READ, commonly referred to as a
"screen set." Without modifying the .SPR directly, there is no way to avoid
the momentary display of the hidden window before it is hidden again by the
HIDE WINDOW command the user places in the ON SCREEN ENTRY code snippet.
The screen generator doesn't provide an option to prevent the display of
one or more windows combined in a screen set. While the flicker may be
momentarily distracting on slower computers, the speed gained in having
more than one screen in memory simultaneously may provide justification.
Another benefit is that only a single READ level is consumed by all screens
involved.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin FoxMac 2.00 2.50 2.50a 2.50b<BR>
release<BR>
KBCategory: kbprg kbprb kbui kbdisplay<BR>
KBSubcategory: FxtoolSbuilder<BR>
Keywords          : FxtoolSbuilder kbdisplay kbprb kbprg kbui<BR>
Version           : 2.50b | 2.00 2.50 2.50a 2.50<BR>
Platform          : MACINTOSH MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
