

<HTML>
<HEAD>
<TITLE>PRB: View Designer Rewrites WHERE Clause </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164369">
<META NAME="KBModify" CONTENT="1997/07/14">
<META NAME="KBCreate" CONTENT="1997/02/27">
<META NAME="Keywords" CONTENT="FxprgSql vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a local SQL view is created from a CREATE SQL VIEW command with SELECT - SQL statement, the parenthetical WHERE clause is rewritten in View Designer.  CAUSE =====  According to the SQL lexicon, there is no parentheses support in SQL.  RESOLUTI...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADK,QAPN,QABM,QA2Q,QBWT,QBWS,QAG2,QAY2,QAB9,QABO,QAJQ,QBXS,QA6T,QAY5,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: View Designer Rewrites WHERE Clause</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164369</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a local SQL view is created from a CREATE SQL VIEW command with SELECT
- SQL statement, the parenthetical WHERE clause is rewritten in View
Designer.
<P>
<P><h2>CAUSE</h2>
 
<P>
According to the SQL lexicon, there is no parentheses support in SQL.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In View Designer, the parenthetical HAVING clause is parsed correctly.
Since HAVING sets conditions for the GROUP BY clause similarly to the way
that WHERE sets conditions for the SELECT clause; and HAVING without GROUP
BY has the same filtering effect as WHERE. The workaround for this problem
is to replace WHERE clause with HAVING, whenever it is applicable.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. The view designer was not built to handle
parenthetical WHERE clauses.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open Tastrade sample project and database.

<P><LI>At the Command window, issue the following command:
<P>
<P><PRE>      CREATE SQL View Test1 AS ;
<PRE></PRE>        SELECT * FROM customer ;
        WHERE (customer.country = "USA"  OR customer.country = "Mexico") ;
             AND max_order_amt &gt; 10000

</PRE><P><LI>Open View Designer to modify view Test1.

<P><LI>Select "View SQL" under Query menu. The SQL code is rewritten as the
   following.  Note that the WHERE clause is wrongly parsed:
<P>
<P><PRE>      SELECT *;
      FROM tastrade!customer;
      WHERE customer.country = "USA";
      OR (customer.country = "Mexico";
      AND customer.max_order_amt &gt; 10000)
</PRE><P>
</OL>However, at step 2, if you replace WHERE with HAVING, the View Designer
parses the SQL statement correctly.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxprgSql vfoxwin<BR>
Version             : 3.0 3.0b 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
