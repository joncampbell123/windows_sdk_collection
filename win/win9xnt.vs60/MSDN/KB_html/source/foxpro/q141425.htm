

<HTML>
<HEAD>
<TITLE>FIX: Toolbar Events Fire Differently When Using Dock Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141425">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1995/12/18">
<META NAME="Keywords" CONTENT="kbtool kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The BeforeDock, Undock, and AfterDock events are not triggered in the same order when a toolbar is docked interactively versus when a toolbar is docked under program control.  When the dock position of a toolbar is changed interactively, the events...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAO4,QAH4,QAF0,QANS,QAR4,QAGI,QABO,QATP,QAM1,QACI,QBVV,QA7O,QAOE,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Toolbar Events Fire Differently When Using Dock Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141425</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The BeforeDock, Undock, and AfterDock events are not triggered in the same
order when a toolbar is docked interactively versus when a toolbar is
docked under program control.
<P>
When the dock position of a toolbar is changed interactively, the events
fire in the following order:
<P>
<PRE>   BeforeDock, AfterDock

</PRE>When the dock position of a toolbar is changed under program control with
the Dock method, the events fire in the following order:
<P>
<PRE>   BeforeDock, Undock, BeforeDock, AfterDock

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There is no way to prevent the events from occurring, or to trigger the
events under program control. However, if you have code for the BeforeDock
and Undock methods and do not want to call it when the Dock method is
executed, follow these steps:

<OL><P><LI>Add a property to the class called lDockit.

<P><LI>In the Dock method, set the value of this property to true (.T.) as in
   this example:
<P>
   IF THIS.DockPosition != -1 &amp;&amp; The toolbar is already docked
<P><PRE>      THIS.lDockit=.T.
</PRE>   ENDIF

<P><LI>In the event handler for BeforeDock, add the following:
<P>
   IF THIS.lDockit &lt;&gt; .T.
<P><PRE>      &lt;your code here&gt;
</PRE>   ENDIF

<P><LI>In the event handler for Undock, add the following:
<P>
   IF THIS.lDockit&lt;&gt;.T.
<P><PRE>      &lt;your code here&gt;
      ELSE
      THIS.lDockit=.F.
</PRE>   ENDIF
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Type CREATE CLASS in the Command window.

<P><LI>In the Create Class dialog box, enter the following information to
   create a class based on the Toolbar class:
<P>
   ClassName: TbrDock
   Based On : select Toolbar
   Store In : Clstbar

<P><LI>In the Class Designer, enter the following line for the AfterDock,
   BeforeDock, and Undock event handlers:
<P>
   =MESSAGEBOX(PROGRAM())

<P><LI>Save the class.

<P><LI>Create a toolbar object by typing the following code in the Command
   window:
<P>
   SET CLASSLIB TO clstbar
   oTrdock=CREATEOBJECT("TbrDock")
   oTrdock.Show

<P><LI>Use the mouse to dock the toolbar. The BeforeDock and AfterDock events
   fire.

<P><LI>From the Command window, call the Dock method to move to another docked
   position:
<P>
   oTrDock.Dock(1)
<P>
   The BeforeDock, Undock, BeforeDock, and AfterDock events are triggered.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbbuglist kbfixlist<BR>
KBSubcategory: FxtoolFormdes VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
