

<HTML>
<HEAD>
<TITLE>HOWTO: Creating a Progress Indicator Using Threed Panel Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167192">
<META NAME="KBModify" CONTENT="1997/04/21">
<META NAME="KBCreate" CONTENT="1997/04/21">
<META NAME="Keywords" CONTENT="FxinteropOcx FxprgClassoop kbinterop vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes how to create a progress/status indicator using the Threed Panel ActiveX control in Visual FoxPro.  MORE INFORMATION  You can use the Threed Panel ActiveX control to display plain or three- dimensional text on a three-dimensi...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW9,QAEB,QAO2,QAGQ,QBXS,QA7O,QAOE,QAMN,QABA,QAB5,QBWS,QAHV,QAE8,QBWC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Creating a Progress Indicator Using Threed Panel Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167192</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to create a progress/status indicator using the
Threed Panel ActiveX control in Visual FoxPro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the Threed Panel ActiveX control to display plain or three-
dimensional text on a three-dimensional background. It can also present
progress/status information in a dynamically colored circle or bar with or
without showing percent.
<P>
Here is a listing of properties required to create a progress/status
indicator:

<UL><LI>FloodPercent: returns the percentage of the painted area inside the
   Threed Panel when the panel is used as a status or progress indicator.
   This property is not available at design time. The FloodPercent property
   can be set to an integer value between 0 and 100.

<LI>FloodType: Determines if and how the panel is used as a status or
   progress indicator. Here is a listing of all the available setting for
   FloodType property:
<P>
<P><PRE>      0 (Default) None - Panel has no status bar capability and the
<PRE></PRE>                         caption (if any) is displayed.
      1 - Left to right.
      2 - Right to left.
      3 - Top to bottom.
      4 - Bottom to top.
      5 - From the center outward in a widening circle.

   Threed Panel will be painted in a color base on the above setting, which
   is specified by the FloodColor property, as the FloodPercent property
   increases.

</PRE><LI>FloodShowPct: Determines whether the current setting of the FloodPercent
   property will be displayed in the center of the panel when the panel is
   used as a status or progress indicator. The FloodType property setting
   has to be other than None in order to work. The FloodShowPct property
   can either set it to TRUE to show or FALSE to hide the FloodPercent
   property.

<LI>FloodColor: returns the color used to paint the area when the Threed
   Panel is used as a status or progress indicator. The FloodType property
   setting has to be other than None in order to work.
<P>
</UL>The following example using a Timer control to simulate the progress/status
indicator:
<P>
NOTE: Before you run the example below, making sure you have the Threed
Panel ActiveX control installed(Windows\System\Threed32.ocx).

<OL><P><LI>Create a .prg file and cut and paste the following code into the .prg:
<P>
<P><PRE>      PUBLIC x
      x=CREATEOBJECT("progress")
      x.SHOW
</PRE><P>
<P><PRE>      **************************************************
<PRE></PRE>      *-- Class:        progress
      *-- ParentClass:  form
      *-- BaseClass:    form
      *
      DEFINE CLASS progress AS form


         Top = 0
         Left = 0
         Height = 198
         Width = 378
         DoCreate = .T.
         Caption = "Form1"
         Name = "Form1"

         ADD OBJECT timer1 AS Timer WITH ;
           Top = 9, ;
           Left = 18, ;
           Height = 23, ;
           Width = 23, ;
           Enabled = .F., ;
           Interval = 100, ;
           Name = "Timer1"

         ADD OBJECT command1 AS CommandButton WITH ;
           Top = 121, ;
           Left = 71, ;
           Height = 27, ;
           Width = 247, ;
           Caption = "Click Me to Begin Task", ;
           Name = "Command1"

         ADD OBJECT sspanel1 AS sspanel WITH ;
           Top = 27, ;
           Left = 28, ;
           Height = 72, ;
           Width = 328, ;
           Name = "sspanel1"

         ADD OBJECT command2 AS CommandButton WITH ;
           Top = 159, ;
           Left = 70, ;
           Height = 26, ;
           Width = 247, ;
           Caption = "Reset", ;
           Name = "Command2"

         PROCEDURE Init
           * Set the FloodType from Left to Right
           THISFORM.sspanel1.FloodType = 1
           * Initialize the FloodPercent to 0
           THISFORM.sspanel1.FloodPercent = 0
           THISFORM.sspanel1.FloodShowPct = .T. &amp;&amp; Show the percent sign
         ENDPROC

         PROCEDURE timer1.Timer
           IF THISFORM.sspanel1.FloodPercent &lt; 100
              THISFORM.sspanel1.FloodPercent = ;
                 THISFORM.sspanel1.FloodPercent + 1
           ELSE
              THISFORM.timer1.Enabled = .F.
              THISFORM.command1.Caption = "Click Me to Begin Task"
              WAIT WINDOW "Task Completed"
              THISFORM.sspanel1.FloodPercent = 0
           ENDIF
         ENDPROC

         PROCEDURE command1.Click
           IF THIS.Caption = "Click Me to Begin Task"
              THIS.Caption = "Click Me to Stop Task"
              THISFORM.timer1.Enabled = .T.
           ELSE
              THIS.Caption = "Click Me to Begin Task"
              THISFORM.timer1.Enabled = .F.
           ENDIF
         ENDPROC

         PROCEDURE command2.Click
           THISFORM.Timer1.Enabled = .F.
           THISFORM.sspanel1.FloodPercent = 0
           THISFORM.Command1.Caption = "Click Me to Begin Task"
         ENDPROC

      ENDDEFINE

      DEFINE CLASS sspanel AS OLECONTROL

          OLEClass = "Threed.SSPanel"

      ENDDEFINE
      *
      *-- EndDefine: progress
      **************************************************

</PRE><P><LI>Run the .prg file and click the "Click Me to Begin Task" button, and the
   progress/status indicator appears in the Threed panel ActiveX
   control as FloodPercent property increases.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Custom Control Reference Help File (Ctrlref.hlp in the Windows\System or
WinNT\System32 folder if using Windows NT). This file may also appear in
the Visual FoxPro folder.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxinteropOcx FxprgClassoop kbinterop vfoxwin<BR>
Technology          : kbole<BR>
Version             : 5.0 5.0a<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
