

<HTML>
<HEAD>
<TITLE>BUG: _PAGENO Wrong When Data Grouping &amp; New Page Selected </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110120">
<META NAME="KBModify" CONTENT="1995/07/05">
<META NAME="KBCreate" CONTENT="1994/01/13">
<META NAME="Keywords" CONTENT="FxtoolRwriter kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The _PAGENO system variable is incremented incorrectly when the following three conditions are met:   -  A field in the Detail band stretches past one page.   -  There is a data grouping.   -  In the Group Info dialog box, the When Group Changes, B...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QABO,QBWA,QBXS,QABI,QA2Q,QAAP,QBDM,QA7O,QA7N,QAYL,QAW9,QAWI,QASR,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: _PAGENO Wrong When Data Grouping &amp; New Page Selected</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110120</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The _PAGENO system variable is incremented incorrectly when the following
three conditions are met:

<UL><LI> A field in the Detail band stretches past one page.

<LI> There is a data grouping.

<LI> In the Group Info dialog box, the When Group Changes, Begin New Page
   check box is selected.
<P>
</UL>The _PAGENO system variable does not increment on the last page of the
group if the Detail band extends past one page. For example, if the first
group of a report has a Detail band that stretches from page 1 to page 3 of
the report, the value for _PAGENO for pages 1 and 2 would be correct, but
the value for page 3 would be 2. When the group changes on page 4, _PAGENO
will be 4, which is correct. This behavior will continue throughout the
report.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Execute these commands:
<P>
<P><PRE>     CREATE TABLE grp_tst (notes M)
     APPEND BLANK
     REPLACE notes WITH REPLICATE('X',10000)
     CREATE REPORT grp_tst.frx
</PRE>
<P><LI>Create a field in the Detail band and set the expression to
   GRP_TST.NOTES. Select the Position Relative to Top--Field Can Stretch
   check box. Size the field so that it stretches across the whole page.

<P><LI>Create a field in the Page Footer band and set the expression to
   _PAGENO.

<P><LI>From the Report menu, choose Data Grouping. Set the expression to
   RECNO() and select the When Group Changes, Begin New Page check box.

<P><LI>From the Report menu, choose Page Preview. Choose the Next button in the
   preview until you reach the last page. Note the value for _PAGENO. Now
   choose the Previous button, and note that the value for _PAGENO is the
   same.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b buglist2.50<BR>
buglist2.50a buglist2.50b<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: FxtoolRwriter<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 5, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
