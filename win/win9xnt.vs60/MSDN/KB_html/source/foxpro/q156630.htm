

<HTML>
<HEAD>
<TITLE>PRB: Incremental Search with Grid Causes Screen Flicker </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156630">
<META NAME="KBModify" CONTENT="1997/01/20">
<META NAME="KBCreate" CONTENT="1996/09/27">
<META NAME="Keywords" CONTENT="kbtool kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Refresh method of the Grid control does not move the record pointer in the grid to the selected record when the record pointer is moved from a control external to the grid. The grid has to get the focus in order for the record pointer in it to ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QBT6,QA5V,QAHP,QAPN,QAKJ,QARR,QAH4,QA7O,QAMN,QAB5,QA9N,QA2Q,QAO4,QAO3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Incremental Search with Grid Causes Screen Flicker</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156630</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro 5.0 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Refresh method of the Grid control does not move the record pointer in
the grid to the selected record when the record pointer is moved from a
control external to the grid. The grid has to get the focus in order for
the record pointer in it to move to the selected record. Because of this
problem, an incremental search routine, involving the grid and another
control, causes the screen to flicker every time a character is entered.
<P>
This article describes a way to avoid the screen flicker when using an
incremental search routine with a grid.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can use the LockScreen property of the Form to eliminate most of the
screen flicker. For example, you can make the following modifications to
the Form created in the STEPS TO REPRODUCE BEHAVIOR section below:

<OL><P><LI>Create a New Property for the Form and name it lRefreshingGrid. Set
   the property to .F.

<P><LI>Change the code in Text1.InterActiveChange event as follows:
<P>
<P><PRE>      ThisForm.lRefreshingGrid = .T.
      ThisForm.LockScreen = .T.
      SELECT customer
      SEEK UPPER(ALLTRIM(ThisForm.Text1.Value))
      ThisForm.grid1.SetFocus
      ThisForm.text1.SetFocus
      ThisForm.LockScreen = .F.
      ThisForm.lRefreshingGrid = .F.
</PRE>
<P><LI>To ensure that the Valid event of the text box does not fire when the
   focus is moved to the grid and then back to the text box, add the
   following code to the Valid event of the text box:
<P>
<P><PRE>      IF ThisForm.lRefreshingGrid
<PRE></PRE>         RETURN .T.
      ENDIF

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a Form, and set the LockScreen property to False (.F.).

<P><LI>Add the Customer table, in the home()+"SAMPLES\DATA" folder, to the
   Data Environment.

<P><LI>Drag the table onto the form to create a grid.

<P><LI>Add a TextBox control to the form. Make sure that SelectOnEntry property
   of the Textbox control is set to .F. (the default). Add the following
   code to the TextBox control's InterActiveChange event:
<P>
<P><PRE>      SELECT customer
      SEEK UPPER(ALLTRIM(ThisForm.Text1.Value))
      ThisForm.Grid1.Refresh
</PRE>
<P><LI>Run the Form and type a few characters in the text box.

<P><LI>Although the REFRESH method of the grid is being called from
   Text1.InterActiveChangeEvent, the record pointer in the grid does not
   move to the correct record.

<P><LI>Now change the code in Text1.InterActiveChange event as follows:
<P>
<P><PRE>      SELECT customer
      SEEK UPPER(ALLTRIM(ThisForm.Text1.Value))
      ThisForm.grid1.SetFocus
      ThisForm.text1.SetFocus
</PRE>
<P><LI>Repeat step 5.

<P><LI>Now the Record Pointer in the grid is moving correctly but there is a
   lot of screen flicker every time a character is entered into the text
   box.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbprg kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>
Additional reference words: 5.00 kbdse VFoxWin Flash
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
