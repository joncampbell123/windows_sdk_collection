

<HTML>
<HEAD>
<TITLE>PRB: "Too Many Files" Open in FoxPro for Macintosh </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134367">
<META NAME="KBModify" CONTENT="1996/06/01">
<META NAME="KBCreate" CONTENT="1995/08/06">
<META NAME="Keywords" CONTENT="kbenv kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When several users are running a FoxPro for Macintosh application and using tables stored on a server, it is possible to receive the message:     Too many files open  CAUSE =====  This indicates that there are not enough file handles on the server ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABN,QDO9,QAKC,QBC6,QBWS,QAGU,QAG8,QDIR,QBI8,QAJB,QAHT,QACJ,QABI,QBF0,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Too Many Files" Open in FoxPro for Macintosh</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 1, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134367</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When several users are running a FoxPro for Macintosh application and using
tables stored on a server, it is possible to receive the message:
<P>
<PRE>   Too many files open

</PRE><h2>CAUSE</h2>
 
<P>
This indicates that there are not enough file handles on the server for the
number of users and files that are open. This usually happens when the
server is another Macintosh connected to through the AppleTalk services
provided with the System Software. The absolute limit of file handles on a
Macintosh is 342. Note that each user that opens a file on a server uses
another file handle.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The following are suggestions that may help reduce the number of file
handles being used on the server:

<OL><P><LI>Place the application the local hard drive (on each workstation).

<P><LI>Use the TMPFILES setting in the CONFIG.FPM file to make sure that
   temporary files are going to the local hard drive (of each workstation).

<P><LI>Change the application so that tables and other files are only open as
   long as they are needed, instead of keeping them open throughout the
   application.
<P>
</OL>Another option is to upgrade to a server operating system that will support
a higher limit of open files, such as AppleShare Pro, Novell Netware, or
Microsoft Windows NT.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following information was provided by Apple Developer Support on the
maximum number of File Control Blocks (FCBs) available in the Macintosh
Operating System File Manager, and therefore, the number of files that can
be open at one time. This information only applies to System 7.x.
<P>
"While System 7 increases the number of FCBs as required, there is an
absolute limit imposed by the File Manager. This limit is 342 FCBs and is
documented in Inside Macintosh, File p. 2-81:
<P>
<PRE>'The initial size of the FCB buffer is determined by the system startup
</PRE></OL>information stored on a volume. Beginning in system software version 7.0,
the File Manager attempts to resize the FCB buffer whenever the existing
buffer is filled.
<P>
You can find the beginning of any particular FCB by adding the size of all
preceding FCBs to the size of the FCB buffer length word (that is, 2). This
offset from the head of the FCB buffer is used as the file reference number
of the corresponding open file. Because the current size of an FCB is 94
bytes, the first few valid file reference numbers are 2, 96, 190, 284, 378,
472, and so on. The maximum size of an expandable FCB buffer is 32,535
bytes, so there is an absolute limit of 342 FCBs in the FCB buffer.' "
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxMac 3.00b 2.50b 2.50c 2.60a FoxMac<BR>
KBCategory: kbenv kbprb<BR>
KBSubcategory: FxenvOs<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 1, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
