

<HTML>
<HEAD>
<TITLE>BUG: Double Data Type Does Not Display Small Values Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158756">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1996/11/05">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxprgTable vfoxwin vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When the stored value is smaller than 10 to the minus (-)15th power, the new data type, known as double, is not displayed correctly in a table field.  Visual FoxPro should display numbers smaller than 10 to the -15th power. For example, the number ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKD,QBB2,QAHH,QAKC,QA56,QA55,QAAP,QACI,QBE7,QBE6,QAYV,QAR4,QAYY,QAKZ,QAI4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Double Data Type Does Not Display Small Values Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158756</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the stored value is smaller than 10 to the minus (-)15th power, the
new data type, known as double, is not displayed correctly in a table
field.
<P>
Visual FoxPro should display numbers smaller than 10 to the -15th power.
For example, the number 0.00000000000000009 (9 x 10 to the -17th power)
should be displayed as 9.0000000000000E-17. You see this as
.0000000000000000000 in a browse.
<P>
In Visual FoxPro versions 3.0 and 3.0b, values smaller than 10 to the -15th
power are displayed as a string of zeros.
<P>
In Visual FoxPro 5.0, values between 10 to the -15th power and 10 to the
-30th power are displayed as zeros. Values smaller than 10 to the -30th
power are displayed correctly. For example, 9 x 10 to the -32nd power is
displayed correctly as 9.0000000000000E-32.
<P>
Values between 10 to the -13th power and 10 to the -15th power may also
appear incorrectly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The values are stored correctly, but displayed incorrectly. Arithmetic
operations that use the values are performed correctly. To see the values,
you must multiply them by a positive power of 10. As a result, the
significant digits are within the range of values that are displayed
correctly.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Visual FoxPro 3.0, 3.0b, and 5.0 may display the following commands in the
Command window:
<P>
<PRE>   CREATE TABLE dpt (dp B(18))     &amp;&amp; Double data, 18 to right of decimal
   INSERT INTO dpt (dp) VALUES (9)
   BROWSE     &amp;&amp; The data appears as a 9, a decimal, and 18 zeros
   REPLACE dp WITH dp/10**15  &amp;&amp; 0. then 14 zeros followed by 9000
   REPLACE dp WITH dp/10      &amp;&amp; 0. then 14 zeros followed by 1000
   REPLACE dp WITH 9          &amp;&amp; Reset
   REPLACE dp WITH dp/10**31  &amp;&amp; Correct in version 5, wrong in version 3.x
   REPLACE dp WITH dp/10**277 &amp;&amp; Correct in version 5, zeros in version 3.x
   REPLACE dp WITH dp*10**308 &amp;&amp; Restores 9.00000000000000000
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 3.00b 5.00<BR>
Keywords            : buglist3.00 buglist3.00b buglist5.00 FxprgTable vfoxwin vfpbug5.0a kbbuglist<BR>
Version             : 3.0 3.0b 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
