

<HTML>
<HEAD>
<TITLE>How to Hide Password and Show Entry Position in FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113011">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/03/23">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To prevent a password from being displayed during entry and to show the current editing position as well, a certain character can be echoed to the screen in place of the actual password characters, as demonstrated in the code below.  MORE INFORMATI...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAEF,QAUD,QAWK,QBE7,QBE6,QAYL,QAWN,QABI,QACI,QAKE,QAGB,QAKC,QAJX,QADR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Hide Password and Show Entry Position in FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113011</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To prevent a password from being displayed during entry and to show the
current editing position as well, a certain character can be echoed to the
screen in place of the actual password characters, as demonstrated in the
code below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code, when placed in a program, will accept up to the number
of characters specified in the variable PWLEN, allowing corrections with
the BACKSPACE key. This value can be changed to allow fewer or greater
characters in the password (minimum=1 character). If no characters are
input or if all the characters have been previously deleted, the BACKSPACE
key will be ignored when pressed. Attempting to enter more than the maximum
number of characters will ring the bell to indicate that no more characters
can be accepted; the additional characters will be ignored.
<P>
The variable W contains the character that will be echoed to the screen
during entry. This value can be any ASCII character, although the asterisk
(*), number sign (#), hyphen (-), or period (.) is most commonly used for
this purpose.
<P>
NOTE: The FONT clause in this code example will be ignored in FoxPro 2.5x
for MS-DOS, but must be removed if used with prior versions.
<P>
The ENTER key is required to terminate entry of the password, even if the
maximum number of characters are used, in order to allow editing of the
last character entered. This mimics the SET CONFIRM ON command option with
FoxPro which prevents the user from typing through the end of a field
accidentally.
<P>
<P><h3>Code Example</h3>
 
<P>
<PRE>   *-------------- password code within a program
   CLEAR
   CLEAR ALL
   SET TALK OFF     &amp;&amp; Prevents "double" echoing to the screen
   STORE '' TO x,y     &amp;&amp; Initialize variables to a null value
   z=0               &amp;&amp; Initialize INKEY variable to null character

   pwlen=10     &amp;&amp; Maximum characters permitted in password
   w='*'          &amp;&amp; Character used for display as placeholder

   * Display empty pseudo-GET field
   @2,2 SAY PADR(y,pwlen) FONT 'FoxFont',9 COLOR N/BG*

   DO WHILE z&lt;&gt;13
        z=INKEY(0,'H')     &amp;&amp; 0=wait indefinitely, H=hide cursor
        * Check for exit by ENTER key press
        IF z=13
             EXIT
        ENDIF
        xlen=LEN(x)
        * Check for BACKSPACE while characters still left
        IF z=127
             IF xlen=0
                  LOOP
             ENDIF
             x=LEFT(x,xlen-1)
             y=LEFT(y,xlen-1)
        ELSE
             * If max, wait for ENTER (CONFIRM=ON effect)
             IF xlen=pwlen
                  ?? CHR(7)     &amp;&amp; Ring the bell
                  LOOP
             ENDIF
             x=x+CHR(z)
             y=y+w
        ENDIF
        @2,2 SAY PADR(y,pwlen) FONT 'FoxFont',9 COLOR N/BG*
   ENDDO
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxDos FoxWin 2.50 2.50a 2.50b<BR>
mask encrypt<BR>
encryption<BR>
return<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
