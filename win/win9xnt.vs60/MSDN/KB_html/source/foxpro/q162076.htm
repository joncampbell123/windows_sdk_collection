

<HTML>
<HEAD>
<TITLE>HOWTO: Converting VFP Files from Version 3.0 to 5.0 and Back </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162076">
<META NAME="KBModify" CONTENT="1998/01/16">
<META NAME="KBCreate" CONTENT="1997/01/13">
<META NAME="Keywords" CONTENT="FxtoolConverter vfoxwin kb3rdparty kbdisplay kbprg kbtool kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Running or modifying Visual FoxPro 3.0 forms, class libraries, database containers, report/label files, programs, or menu files in Visual FoxPro 5.0 causes any program code to be recompiled under Visual FoxPro 5.0. This may render some of these ite...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QA56,QAH4,QAMB,QAC2,QAPN,QBWS,QAW6,QAGY,QAFI,QAUJ,QA2S,QAH6,QAB9,QBXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Converting VFP Files from Version 3.0 to 5.0 and Back</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162076</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Running or modifying Visual FoxPro 3.0 forms, class libraries, database
containers, report/label files, programs, or menu files in Visual FoxPro
5.0 causes any program code to be recompiled under Visual FoxPro 5.0. This
may render some of these items no longer able to be run or modified under
Visual FoxPro 3.0. Attempting to run or modify forms, classes, database
containers, or report/label files in Visual FoxPro 3.0 after they have been
recompiled under Visual FoxPro 5.0 yields an error similar to the
following:
<P>
<PRE>   Error loading file - Methods - record number &lt;n&gt;.  Object
   file &lt;drive and directory&gt;\&lt;filename&gt; was compiled in a
   previous version of FoxPro.

   -or-

   Object file &lt;drive and directory&gt;\&lt;filename&gt; was compiled
   in a previous version of FoxPro.

</PRE>You can take steps to allow the running or modifying of files containing
Visual FoxPro 5.0-compiled code under Visual FoxPro 3.0. This article
explains the basics of conversion, and the steps you can take to "go back,"
if desired.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Converting with a Project</h3>
 

<OL><P><LI>Opening a Visual FoxPro 3.0 project in Visual FoxPro 5.0 invokes the
   Converter and converts the project. Because the structure of the
   project file itself is different in Visual FoxPro 5.0, the project file
   cannot be reopened in Visual FoxPro 3.0 after conversion. It is highly
   recommended to accept the "Backup files" option to allow the Converter
   to create backup files for all converted files--the "Backup files"
   check box in the Converter dialog box is selected by default. Unless
   you specify a different directory, these backup files, including the
   project's .pjx and .pjt files, are placed in a subdirectory of the
   project's home directory called \Old.

<P><LI>It is important to note that some default property values have changed
   from Visual FoxPro 3.0 to Visual FoxPro 5.0. These include the FontBold
   and FontSize properties of the Label control, for example. These
   changes were made for compatibility with Windows interface standards.
   Upon conversion, these properties continue to have default values, but
   these default values are different under Visual FoxPro 5.0.
<P>
   If you wish to retain the Visual FoxPro 3.0 defaults for these
   properties, you must do the following:
<P>
   a. Forms or class libraries containing these controls must be converted
<P><PRE>      by converting a project that contains them.
</PRE><P>
   b. The "Retain Visual FoxPro 3.0 default property values" check box
<P><PRE>      must be selected in the Converter dialog box.
</PRE>
<P><LI>Upon conversion, any Visual FoxPro 3.0 .dbc, .vcx, .scx, .frx, or .lbx
   files (database containers, class libraries, forms, reports, and
   labels, respectively) within the project that contains procedure or
   method code are automatically recompiled. If .dbc files contain no
   stored procedures, or .vcx, .scx, .frx, or .lbx files contain no method
   code, recompiling is unnecessary and does not occur.

<P><LI>Upon conversion, all .prg and .mpr files (programs and menu programs)
   are automatically recompiled.
<P>
</OL><h3>Converting Individual Components (.vcx, .scx, .dbc, .frx, or .lbx Files)</h3>
 
<P>
<P><h3>Converting Individual Components (.vcx, .scx, .dbc, .frx, or .lbx Files)</h3>
 

<OL><P><LI>If a Visual FoxPro 3.0 .dbc, .vcx, .scx, .frx, or .lbx file (database
   container, class library, form, report, or label, respectively) is
   opened, modified, or run in Visual FoxPro 5.0, the file is automatically
   recompiled under Visual FoxPro 5.0 if it contains any method or
   procedure code. No changes other than recompiling should occur. If a
   .dbc file contains no stored procedures, or if .vcx, .scx, .frx, or .lbx
   files contain no method code, recompiling is unnecessary and does not
   occur.
<P>
   The .dbc file is an exception under one specific circumstance: If the
   .dbc is first opened shared under Visual FoxPro 3.0, the compiled stored
   procedure code within the .dbc will not be overwritten if subsequently
   opened shared from Visual FoxPro 5.0. In this case, the stored
   procedures are compile and stored locally in a temp file on the 5.0
   machine. Note that opening a .dbc shared within Visual FoxPro 5.0 that
   has not been opened in Visual FoxPro 3.0 will still result in a
   recompile.

<P><LI>Menus need no conversion; the .mpx file is re-created transparently when
   the .mpr file is run. Program (.prg) files also behave like this--they
   are transparently recompiled and an .fxp file created for the
   appropriate Visual FoxPro version. If the .mpr or .prg does not exist,
   and the .mpx or .fxp is run, the following error occurs:
<P>
<P><PRE>      Object file &lt;path\filename&gt; was compiled in a
      previous version of FoxPro
</PRE><P>
   For more information about the Converter, view the Visual FoxPro 5.0
   Help File's Converter Help topic.

<P><LI>Individual files may be explicitly recompiled under Visual FoxPro 5.0
   (without opening, modifying, or running) by executing the following
   commands from within a program file or from the Command window:
<P>
   Programs:
<P>
<P><PRE>      COMPILE &lt;.prg or .mpr filename&gt;
</PRE><P>
   Database containers:
<P>
<P><PRE>      COMPILE DATABASE &lt;Database container (.dbc) name&gt;
</PRE><P>
   Forms:
<P>
<P><PRE>      COMPILE FORM &lt;form (.scx) name&gt;
</PRE><P>
   Class Libraries (this command is new to Visual FoxPro 5.0):
<P>
<P><PRE>      COMPILE CLASSLIB &lt;Class library (.vcx) name&gt;
</PRE><P>
   Reports or labels (these commands are new to Visual FoxPro 5.0):
<P>
<P><PRE>      COMPILE REPORT &lt;report (.frx) name&gt;
      COMPILE LABEL &lt;label (.lbx) name&gt;
</PRE><P>
   For more information, view the Visual FoxPro 5.0 Help File for the
   above commands.
<P>
</OL><h3>Going Back to Visual FoxPro 3.0 from Visual FoxPro 5.0</h3>
 

<OL><P><LI>There is no conversion for Visual FoxPro 5.0 project files back to
   Visual FoxPro 3.0. However, the converter places, unless the Converter
   dialog box "Backup files" check box is unselected, a copy of the project
   files (.pjx/.pjt files, along with all other converted files) in a
   subdirectory of the project's home directory called \Old. Original,
   unconverted versions of all converted files may be found there.

<P><LI>Databases (.dbc files) containing stored procedure code may be
   recompiled back to Visual FoxPro 3.0 format by running the COMPILE
   DATABASE &lt;database name&gt; command within Visual FoxPro 3.0. Attempting to
   open or modify within Visual FoxPro 3.0 a .dbc file that was compiled in
   Visual FoxPro 5.0 gives an error like the following:
<P>
<P><PRE>      Object file &lt;drive and directory&gt;\&lt;filename&gt;.DBC was compiled in
      a previous version of FoxPro.
</PRE>
<P><LI>Forms (.scx files) containing method code may be recompiled back to
</OL>Visual FoxPro 3.0 format by running the COMPILE FORM &lt;form name&gt; command
within Visual FoxPro 3.0. Attempting to run or modify within Visual FoxPro
3.0 an .scx file, which was compiled in Visual FoxPro 5.0 gives an error
such as the following:
<P>
<PRE>      Error loading file - Methods - record number 3.  Object
      file &lt;drive and directory&gt;\&lt;filename&gt;.scx was compiled in
      a previous version of FoxPro.

</PRE><P><LI>Class libraries (.vcx files) containing method code may be recompiled
   back to Visual FoxPro 3.0 format by running the COMPILE FORM &lt;classlib
   name including .vcx extension&gt; command within Visual FoxPro 3.0. The
   COMPILE CLASSLIB command is not available in Visual FoxPro 3.0, so
   COMPILE FORM must be used, with the .vcx extension explicitly included
   with the file name. Attempting to instantiate or modify within Visual
   FoxPro 3.0 a class contained in a .vcx file that was compiled in Visual
   FoxPro 5.0 gives an error such as the following:
<P>
<P><PRE>      Object file &lt;drive and directory&gt;\&lt;filename&gt;.vcx was compiled
      in a previous version of FoxPro.
</PRE>
<P><LI>Program and generated menu files (.prg and .mpr files) are
   automatically recompiled into their respective .fxp and .mpx files. If
   the .mpr or .prg does not exist, and the .mpx or .fxp is run, the
   following error occurs:
<P>
<P><PRE>      Object file &lt;path\filename&gt; was compiled in a previous version
      of FoxPro
</PRE>
<P><LI>There is no COMPILE REPORT command under Visual FoxPro 3.0. Report and
   label files containing compiled code can be recompiled to Visual FoxPro
   3.0 format with the following program. Copy the code below into a .prg
   file and run the .prg from the Command window, passing the report or
   label file to be converted as a parameter (see Usage and Example below
   in the comment section in the program header).
<P>
</OL>******************************************************************
<PRE>*                           CONVREPO.PRG
*
</PRE></OL>* Program to compile Visual FoxPro 5.0 .frx or .lbx file to run under
* Visual FoxPro 3.
* This is necessary only if the report or label contains code in
* any of its DataEnvironment methods.
*
* Usage: DO CONVREPO WITH &lt;.frx or .lbx file including extension&gt;
*
* Example:  DO CONVREPO WITH "myreport.frx"
*
******************************************************************
<P>
LPARAMETER lcFrxName
LOCAL lcAlias, lcTmpFile
IF (TYPE('lcFrxName') = "C" AND UPPER('frx')$UPPER(lcFrxName)) OR ;
<PRE>      (TYPE('lcFrxName') = "C" AND UPPER('lbx')$UPPER(lcFrxName))

   IF NOT FILE(lcFrxName)
      =MESSAGEBOX('The file '+ UPPER(lcFrxName) + ' does not ' + ;
         'exist in the default directory. '+ CHR(13)+ ;
         'Please pass a valid report '+ ;
         'or label filename, including extension, to this program!' ;
         ,48, "Report/Label Code Compiler")
      RETURN
   ENDIF

   USE (lcFrxName)
   lcAlias = ALIAS()
   * Look for any Data Environment object's records
   SCAN FOR NAME='dataenvironment' ;
         OR NAME='cursor' ;
         OR NAME='relation'
      IF !EMPTY(TAG)                          &amp;&amp; Is there any code?
         lcTmpFile = SYS(3)
         COPY MEMO TAG TO (lcTmpFile+'.PRG')  &amp;&amp; Copy to temp .prg
         COMPILE (lcTmpFile)                  &amp;&amp; Compile it
         APPEND MEMO tag2 ;
            FROM (lcTmpFile+".FXP") OVERWRITE &amp;&amp; Write it back to .frx/.lbx
         ERASE (lcTmpFile+".PRG")             &amp;&amp; Delete temp files
         ERASE (lcTmpFile+".FXP")
      ENDIF
   ENDSCAN
   USE IN (lcAlias)
   SET MESSAGE TO "Recompile completed"
   WAIT "" TIMEOUT 2
   SET MESSAGE TO
</PRE>ELSE
<PRE>   =MESSAGEBOX('Please pass a report or label filename, '+ ;
      'including extension, to this program!' ,48, ;
      "Report/Label Code Compiler")
   RETURN
</PRE>ENDIF
RETURN
*
* End of CONVREPO.PRG
*
**************************************************************
<P>
Attempting to run or modify within Visual FoxPro 3.0 a report or label file
that was compiled in Visual FoxPro 5.0 gives an error such as the
following:
<P>
<PRE>      Error loading file - Methods - record number 8.  Object
      file &lt;drive and directory&gt;\&lt;filename&gt;.FRX was compiled in a
      previous version of FoxPro.

</PRE><h2>REFERENCES</h2>
 
<P>
Visual FoxPro 5.0 Help
<P>
(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Jim Saunders, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbprg kbdisplay kb3rdparty kbhowto<BR>
KBSubcategory: FxtoolConverter<BR>
Additional query words: compatibility backward screens<BR>
Keywords          : FxtoolConverter vfoxwin kb3rdparty kbdisplay kbprg kbtool kbhowto<BR>
Version           : 3.00 3.00b 5.00<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 16, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
