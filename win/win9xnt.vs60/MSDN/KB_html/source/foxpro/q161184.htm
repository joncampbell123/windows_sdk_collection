

<HTML>
<HEAD>
<TITLE>FIX: Combo Box Behaves Erratically with Timer Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161184">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1996/12/18">
<META NAME="Keywords" CONTENT="buglist5.00 FxprgGeneral vfoxwin vfpfix5.0a kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using a Timer Control and a combo box simultaneously may produce erratic results. Under some circumstances, the combo box may not reflect the last item chosen from its list. However, many times it may act properly. Furthermore, if a check box is pr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QABH,QAVX,QAVW,QATK,QAR4,QAH4,QAB9,QAHP,QBV3,QAM1,QAEB,QACE,QA2Q,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Combo Box Behaves Erratically with Timer Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161184</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using a Timer Control and a combo box simultaneously may produce erratic
results. Under some circumstances, the combo box may not reflect the last
item chosen from its list. However, many times it may act properly.
Furthermore, if a check box is present, the check box may become
automatically unchecked when certain selections are made from the combo box
list.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The example below contains two procedures, PROCEDURE Combo1.Valid and
PROCEDURE Check1.MouseDown, which are included in the code as comments. By
removing the asterisks, the two procedures fix the problems. The first
procedure, Combo1.Valid, allows the selection of any item in the combo's
list. The second procedure, Check1.MouseDown, prevents the check box from
becoming unchecked by selections made within the combo box.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Place the following code in a program and run it:
<P>
   PUBLIC oform1
   oForm1=CREATEOBJECT("Form1")
   oForm1.Show
<P>
   DEFINE CLASS form1 AS form
<P><PRE>      Height = 297
      Width = 579
      AutoCenter = .T.
      Caption = "ComboBox/Timer Example"
      Name = "Form1"
</PRE><P>
   ADD OBJECT timer1 AS timer WITH ;
<P><PRE>      Top = 270, ;
      Left = 278, ;
      Height = 23, ;
      Width = 23, ;
      Interval = 1000, ;
      Name = "Timer1"
</PRE><P>
   ADD OBJECT combo1 AS combobox WITH ;
<P><PRE>      RowSourceType = 1, ;
      RowSource = "Test 1,Test 2,Test 3,Test 4", ;
      Height = 24, ;
      Left = 239, ;
      Style = 2, ;
      Top = 180, ;
      Width = 100, ;
      Name = "Combo1"
</PRE><P>
   ADD OBJECT check1 AS checkbox WITH ;
<P><PRE>      Top = 239, ;
      Left = 239, ;
      Height = 17, ;
      Width = 100, ;
      Caption = "Timer Enabled", ;
      Value = .T., ;
      Name = "Check1"
</PRE><P>
   ADD OBJECT edit1 AS editbox WITH ;
<P><PRE>      FontBold = .T., ;
      FontSize = 8, ;
      BackStyle = 0, ;
      BorderStyle = 0, ;
      Height = 165, ;
      Left = 6, ;
      ReadOnly = .T., ;
      ScrollBars = 0, ;
      SpecialEffect = 1, ;
      TabStop = .F., ;
      Top = 5, ;
      Width = 564, ;
      Name = "Edit1"
</PRE><P>
<P><PRE>    PROCEDURE check1.Refresh
      ThisForm.Timer1.Enabled=This.Value
    ENDPROC
</PRE><P>
<P><PRE>    PROCEDURE check1.Click
       This.Refresh
    ENDPROC
</PRE><P>
   PROCEDURE edit1.Init
<P><PRE>      This.Value="A Timer is running when Timer Enabled is checked." ;
      +CHR(13)+CHR(13)+ ;
      "Whenever a timer is running (Enabled=.T., Interval&gt;0, lower values";
      +CHR(13)+ ;
      "make it more likely to show problem), both user defined and system";
      +CHR(13)+ ;
      "(VFP) dropdown list ComboBoxes (Style=2) don't work.";
      + CHR(13) +CHR(13)+ ;
      "When the Timer is on, select Test 1 or Test 4 and it usually";
      +CHR(13)+ ;
      "doesn't select."+CHR(13)+CHR(13)+ ;
      "With the Timer control on, select Test 3 twice in a row and the" ;
      +CHR(13)+ ;
      "checkbox is often unchecked automatically."+CHR(13)+CHR(13)+ ;
      "Turn off the Timer and the ComboBoxes work properly."+CHR(13)
</PRE>   ENDPROC
<P>
   ****The following code fixes the problems*****
<P>
   *PROCEDURE Combo1.Valid
   *This.Refresh
   *ENDPROC
<P>
   *PROCEDURE  Check1.mousedown
<P><PRE>    *  LPARAMETERS nButton, nShift, nXCoord, nYCoord
     * WAIT "" TIME .01
</PRE>   *ENDPROC
<P>
   ENDDEFINE

<P><LI>With the Timer enabled, the "Timer Enabled" check box is selected by
   default, make several selections from the combo box. Select the "Test 3"
   item and notice the check box becomes unchecked.

<P><LI>Clear the "Timer Enabled" check box and make selections from the combo
   box. The object acts normally.
<P>
</OL>The following code may be used in lieu of the above workaround:
<P>
<PRE>   PROCEDURE Combo1.mousedown
   LPARAMETERS nButton, nShift, nXCoord, nYCoord
     thisform.timer1.enabled= .f.
   ENDPROC

   PROCEDURE Combo1.InteractiveChangeEvent
   LPARAMETERS nButton, nShift, nXCoord, nYCoord
     thisform.timer1.enabled= .t.
   ENDPROC
</PRE></OL> 
<PRE>Keywords          : buglist5.00 FxprgGeneral vfoxwin vfpfix5.0a kbprg kbbuglist kbfixlist
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
