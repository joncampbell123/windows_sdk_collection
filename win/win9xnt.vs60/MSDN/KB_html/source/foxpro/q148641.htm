

<HTML>
<HEAD>
<TITLE>Generic Categories of ODBC Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148641">
<META NAME="KBModify" CONTENT="1996/03/27">
<META NAME="KBCreate" CONTENT="1996/03/18">
<META NAME="Keywords" CONTENT="kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article provides a generic description for each of three categories of ODBC errors including typical causes and the type of error trapping that can be used to trap for that type of error.  MORE INFORMATION  There are three types of error cases...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QA9E,QAKP,QAY5,QBG2,QA56,QA55,QAUD,QBV8,QAB9,QBXS,QAO4,QAGX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Generic Categories of ODBC Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148641</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides a generic description for each of three categories of
ODBC errors including typical causes and the type of error trapping that
can be used to trap for that type of error.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are three types of error cases in connectivity issues with ODBC:

<UL><LI>FoxPro Errors
<LI>ODBC Errors
<LI>Connectivity Warnings
<P>
</UL><h3>FoxPro Errors</h3>
 
<P>
These are typical Xbase errors that are not produced by ODBC. These errors
include fundamental errors such as invalid parameters, insufficient memory,
and so on. To trap these errors, you can use the traditional FoxPro error
handling paradigm, including ON ERROR.
<P>
<P><h3>ODBC Errors</h3>
 
<P>
These are errors returned from the ODBC Application Programming Interface
(API). Any error returned from the ODBC API is recognized by Visual FoxPro
as an error outside of the scope of the internal Visual FoxPro operation.
An example of this is when an SQL function called within a Visual FoxPro
application returns a -1 indicating that the function failed. In this case,
the value returned by the SQL function indicates failure and the errors are
saved and made accessible by using AERROR(). The exact process is described
in the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q134721.htm">Q134721</A></B>
   TITLE     : How to Handle Visual FoxPro Connectivity Errors
               w/o DBERROR()

</PRE>In this case, you can't use an ON ERROR routine.
<P>
<P><h3>Connectivity Warnings</h3>
 
<P>
These errors indicate situations where the ODBC-related function is
completed, but the user is warned that an exception occurred. For example,
some ODBC driver parameters were not set, conversion errors occurred while
fetching data, the user canceled the function, multiple updates were
produced by a single view row due to a non-unique key, and so on.
<P>
Warnings bring up simple alert windows that you can disable by setting the
DispWarning connection property to false (.F.). You can use the
SQLSETPROP() function to set the DispWarning Property.
<P>
These warnings are saved and are accessible by using AERROR().  The exact
process is described in the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q134721.htm">Q134721</A></B>
   TITLE     : How to Handle Visual FoxPro Connectivity Errors
               w/o DBERROR()

</PRE>However, if multiple warnings occur in the same connectivity command or
function, only the last one is available to AERROR(). This is different
from ODBC errors, which are batched in ODBC and buffered by the Visual
FoxPro error mechanism as a single error event.
<P>
In this case, you can't use an ON ERROR routine.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbinterop<BR>
KBSubcategory: FxinteropOdbc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
