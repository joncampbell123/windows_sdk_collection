

<HTML>
<HEAD>
<TITLE>PRB: Query Bases Result Set Field Size On Non-Included Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169791">
<META NAME="KBModify" CONTENT="1997/06/10">
<META NAME="KBCreate" CONTENT="1997/06/09">
<META NAME="Keywords" CONTENT="foxdos foxmac foxwin FxprgSql vfoxmac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A query may result with truncated values in an expression columns.  CAUSE =====  The expression column is basing its width on the first record value of the source table.  RESOLUTION  Change the expression to use an IIF() function that returns a val...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QAKD,QA5V,QAY2,QBL2,QA2O,QABA,QAE1,QAL3,QA2Q,QAY4,QAK6,QDMN,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Query Bases Result Set Field Size On Non-Included Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169791</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A query may result with truncated values in an expression columns.
<P>
<P><h2>CAUSE</h2>
 
<P>
The expression column is basing its width on the first record value of the
source table.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Change the expression to use an IIF() function that returns a value of
necessary width. This forces FoxPro to create a column wide enough to hold
the results of the expression column. NOTE: The example code uses the table
created at the bottom of this article in the MORE INFORMATION section.
Here's an example:
<P>
<PRE>   SELECT *, IIF(ISNULL(fld2),SPACE(15),TTOC(fld2,1)) AS test ;
   FROM temp WHERE fld2 is NOT NULL

</PRE>-or-
<P>
Change the source table's order so that the first record's value in the
source table is wide enough to hold the expression columns output. An index
order cannot be used here, since FoxPro opens the source table in another
workarea. Using an additional query can do this. Here's an example:
<P>
<PRE>   SELECT * FROM temp ORDER BY fld2 DESCEND INTO CURSOR temp2
   SELECT *, TTOC(fld2,1) AS test FROM temp2

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Execute the following five lines to create and populate a table:
<P>
<P><PRE>      CREATE TABLE temp (fld1 C(3), fld2 T NULL, fld3 C(3))
      INSERT INTO temp (fld1, fld2, fld3) VALUES ('aaa',NULL,'aaa')
      INSERT INTO temp (fld1, fld2, fld3) VALUES ('bbb',datetime(),'bbb')
      INSERT INTO temp (fld1, fld2, fld3) VALUES ('ccc',NULL,'ccc')
      INSERT INTO temp (fld1, fld2, fld3) VALUES ('ddd',datetime(),'ddd')
</PRE>
<P><LI>Execute the following lines from the Command window:
<P>
<P><PRE>      SELECT *, TTOC(fld2,1) AS test FROM temp
      SELECT *, TTOC(fld2,1) AS test FROM temp WHERE fld2 IS NOT NULL
</PRE><P>
</OL>Note that the test column comes up improperly sized for both queries. The
test column is based solely on the width of the source table's first
record, a 1 byte NULL character. Thus, the column shows only a 1 from the
result of the TTOC() function.
<P>
This occurs even when records that contain NULL are not included in the
result set, per the second query.
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : foxdos foxmac foxwin FxprgSql vfoxmac vfoxwin<BR>
Version             : 2.0 2.5b 2.5c 2.6a 3.0b<BR>
Platform            : MACINTOSH MS-DOS WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
