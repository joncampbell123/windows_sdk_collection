

<HTML>
<HEAD>
<TITLE>FIX: Insufficient Stack Space Hangs or Terminates FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120179">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/09/04">
<META NAME="Keywords" CONTENT="FxtoolGeneral kbbuglist kberrmsg kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If FoxPro runs too low on stack space to display the  Insufficient Stack Space  error message, it may hang or quit, displaying one of the following error messages:     FoxPro for Windows    ------------------        Application Error.       FOXPROW...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QAB4,QACI,QADX,QA9N,QAY4,QAKD,QAH4,QAGB,QAAP,QDO9,QDJO,QBW5,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Insufficient Stack Space Hangs or Terminates FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120179</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.60 | 2.5x 2.60 | 2.5x 2.60
<PRE>WINDOWS   | MS-DOS    | MACINTOSH
</PRE>kbprg kbbuglist kbfixlist kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If FoxPro runs too low on stack space to display the "Insufficient
Stack Space" error message, it may hang or quit, displaying one of the
following error messages:
<P>
<PRE>   FoxPro for Windows
   ------------------

      Application Error.
      FOXPROW caused a Stack Fault in module &lt;unknown&gt;
      FOXPROW will close.

   FoxPro for MS-DOS
   -----------------

      Memory manager internal consistency error.

   FoxPro for Macintosh
   --------------------

    - The application "unknown" has unexpectedly quit, because an
      error of type 1 occurred.

      -or-

    - Internal Consistency Error.

      -or-

    - &lt;Picture of a Bomb&gt;
      Sorry, a system error occurred
      "Microsoft FoxPro"
      bad F-Line instruction

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
FoxPro 2.6a for Windows, FoxPro 2.6a for MS-DOS, and FoxPro 2.6a for
Macintosh.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In FoxPro 2.6a, the code shown below causes a special "Insufficient stack
space" error message to be displayed. This special error message is
displayed only when there is isn't sufficient stack space to display the
normal "Insufficient stack space" error message.
<P>
Instead of containing Cancel, Suspend, and Ignore buttons, this special
error message only contains an OK button in FoxPro 2.6a for Windows and
FoxPro 2.6a for Macintosh. In FoxPro 2.6a for MS-DOS, it only contains a
Cancel button.
<P>
The SHOW GETS statement in the following code is called recursively,
depleting all stack space, which causes the "Insufficient stack space"
error message.
<P>
NOTE: The following code runs successfully if the SHOW GETS statement,
which is unneeded, is removed.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
NOTE: FoxPro for MS-DOS and FoxPro for Macintosh do not usually hang or
crash the first time this code is run. This code usually must be run
several times, with the Suspend or Cancel buttons sometimes being chosen,
before the stack space is depleted, which causes FoxPro to crash.
<P>
Create and run the following program in FoxPro:
<P>
<PRE>   CREATE TABLE test (one C (30))
   INSERT INTO test (one) VALUES ("Los Angeles")
   INSERT INTO test (one) VALUES ("San Diego")
   INSERT INTO test (one) VALUES ("New York")
   INSERT INTO test (one) VALUES ("Bellevue")
   INSERT INTO test (one) VALUES ("Seattle")
   INSERT INTO test (one) VALUES ("Redmond")
   INSERT INTO test (one) VALUES ("Detroit")
   INSERT INTO test (one) VALUES ("Miami")
   INSERT INTO test (one) VALUES ("San Francisco")
   INSERT INTO test (one) VALUES ("Houston")
   INSERT INTO test (one) VALUES ("Minneapolis")
   INSERT INTO test (one) VALUES ("Boston")
   INSERT INTO test (one) VALUES ("Kansas City")
   INSERT INTO test (one) VALUES ("West Palm Beach")

   DEFINE POPUP new ;
     PROMPT FIELD display() ;
     SCROLL

   lchoice  = 1
   @ 1.000,2.571 GET lchoice ;
     PICTURE "@&amp;N" ;
     POPUP new ;
     SIZE 9.000,83.857 ;
     FONT "MS Sans Serif", 8

   READ

   RELEASE POPUPS new

   CLOSE ALL

   PROCEDURE DISPLAY
   rtxt = one
   SHOW GETS
   RETURN rtxt
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.50 2.50a 2.50b 2.50c<BR>
2.60 2.60a buglist2.50 buglist2.50a buglist2.50b buglist2.50c buglist2.60<BR>
fixlist2.60a errmsg err msg gpf gp general protection fault hang hung crash<BR>
freeze ice lock up exit terminate<BR>
KBCategory: kbprg kbfixlist kbbuglist kberrmsg<BR>
KBSubcategory: FxtoolGeneral<BR>
Keywords          : FxtoolGeneral kbbuglist kberrmsg kbfixlist kbprg<BR>
Version           : 2.5x 2.60 | 2.5x 2.60 | 2.5x 2.6<BR>
Platform          : MACINTOSH MS-DOS WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
