

<HTML>
<HEAD>
<TITLE>How to Programatically List .VCX File's Class Definitions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129512">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/27">
<META NAME="Keywords" CONTENT="kbprg kbocde">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A Visual Class Library (VCX) contains references to classes. This article provides two methods that will allow you to list the name of the classes contained in a class library.  MORE INFORMATION  The Visual Class designer provides an interface that...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QBJZ,QBXF,QDKS,QA5V,QBWS,QAE1,QBHQ,QA56,QA55,QAPF,QAPN,QAH4,QBSO,QBD0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Programatically List .VCX File's Class Definitions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129512</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A Visual Class Library (VCX) contains references to classes. This article
provides two methods that will allow you to list the name of the classes
contained in a class library.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Visual Class designer provides an interface that allows you to create
classes visually. The class definitions are stored in a table with a .VCX
extension. Although there is no native Visual FoxPro command that will
allow you to list all the classes saved in a .VCX file, there are ways to
retrieve this information.
<P>
<P><h3>Use the VCX as a Table</h3>
 
<P>
A VCX is a FoxPro table, so you can open it with the USE command, and you
can manipulate the table as if it were a .DBF file. When a class is
created, a new record is added for each object that belongs to the class.
Additionally, the first record for the class contains information about the
class definition, and the Reserved1 field of the .VCX file contains the
word "Class" to tag a class definition. It is therefore possible to query
the table for these records that have the Class string in the Reserved1
field. The following example queries the LOGIN.VCX file located in the
SAMPLES\MAINSAMP\LIBS directory; it retrieves the name of class
definitions.
<P>
<PRE>   olddir=CURDIR()
   CD SYS(2004)+"SAMPLES\MAINSAMP\LIBS"
   IF NOT USED('LOGIN.VCX')
      USE LOGIN.VCX NOUPDATE
      ELSE
      SELECT LOGIN.VCX
   ENDIF

   SELECT PADR(objname,20) FROM LOGIN.VCX WHERE Reserved1=='Class' ;
     INTO ARRAY myarray
   = MESSAGEBOX ("There are "+ALLTRIM(str(alen(myarray)))+ " classes")
   CD EVALUATE('olddir')

</PRE><h3>Use the Class Browser</h3>
 
<P>
In development mode, you can use the Class Browser to list the classes in a
.VCX file. To do so:

<OL><P><LI>Run the Class Browser and open the VCX you need. You can open the Class
   Browser by choosing Class Browser from the Tools menu and selecting the
   library. You can also type the following from the Command window:
<P>
   DO (_BROWSER) WITH &lt;library&gt;

<P><LI>Run the following code. When the Class Browser is loaded, the _Obrowser
   instance variable is created. It references the Browser object. The
   _oBrowser object contains a two dimensional array member (aclasslist)
   that lists the elements of a class. The fist element contains the name
   of the class. You can therefore list the classes stored in a VCX by
   running this code:
<P>
   DO (_BROWSER) with "c:\vfp\samples\mainsamp\libs\login.vcx"
   nArraylen=ALEN(_obrowser.aclasslist,1) &amp;&amp;How many classes
   * The first element of the array is ignored because it contains
   * information about the class library.
   DIMENSION arrayclass(narraylen-1)
   FOR I=2 to narraylen
<P><PRE>       arrayclass(I-1)=_obrowser.aclasslist(I,1)
</PRE>   ENDFOR
   ACTIVATE SCREEN
   DISPLAY MEMO like ARRAYCLASS
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Class Browser, search for "_BROWSER" and
"Sample Files" topics in the Visual FoxPro Help menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgClassoop<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
