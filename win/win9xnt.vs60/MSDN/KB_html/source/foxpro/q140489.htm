

<HTML>
<HEAD>
<TITLE>PRB: One-to-Many Report Prints First Child If Scope Is One </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140489">
<META NAME="KBModify" CONTENT="1995/12/14">
<META NAME="KBCreate" CONTENT="1995/11/30">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A one-to-many report with a scope of one record in the parent table does not display all the related records in the child table. Only the first related child record prints where the tables have a parent and child one-to-many relationship.  CAUSE ==...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAVW,QAVX,QASR,QAOX,QDMH,QBE7,QBE6,QA7O,QA7N,QA56,QA55,QAUR,QABA,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: One-to-Many Report Prints First Child If Scope Is One</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 14, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140489</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A one-to-many report with a scope of one record in the parent table does
not display all the related records in the child table. Only the first
related child record prints where the tables have a parent and child
one-to-many relationship.
<P>
<P><h2>CAUSE</h2>
 
<P>
In one-to-many relationships, when you skip through the parent table, the
record pointer remains on the same parent record until the record pointer
moves through all related records in the child table.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To have all the related records in the child table print for a specific
parent record:

<UL><LI>Use the FOR &lt;expL&gt; clause of the REPORT FORM command to identify the
   record in the parent table.
<P>
   -or-

<LI>Use the NEXT &lt;expN&gt; clause of the REPORT FORM command where &lt;expN&gt; = the
   number of child records related to the parent record.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information about how to specify a scope for a report in Visual
FoxPro, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q135342.htm">Q135342</A></B>
   TITLE     : BUG: Scope on Report Command Doesn't Work as It Did in 2.x

</PRE><h3>Visual FoxPro Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the Testdata database located in the \Samples\Data directory
   under the Main Visual FoxPro directory.

<P><LI>Create a new report using the One-to-Many Report Wizard.
<P>
   Step 1 - Fields from the parent table
<P>
<PRE>            Select Customer for the parent table, and choose any fields.

   Step 2 - Fields from the child table

            Select Orders for the child table, and choose any fields.

   Step 3 - Relationships

            Customer.cust_id -- Orders.cust_id (should be the default)

   Step 4 - Sort order

            Ignore. Go on to Step 5.

   Step 5 - Style

            Use the defaults. Go on to Step 6.

   Step 6 - Finish

            Choose "Save report for later use" and click Finish.

</PRE><P><LI>Save the report as Test.frx in the default directory.

<P><LI>In the Command window, type:
<P>
   REPORT FORM test RECORD 3
<P>
   -or-
<P>
   REPORT FORM test NEXT 1

<P><LI>Examine the report. Only the first of thirteen child records prints.
<P>
</OL><h3>Example Resolution</h3>
 
<P>
To resolve this behavior, use the FOR clause of the REPORT FORM command, as
in these examples:
<P>
<PRE>   REPORT FORM Test FOR Cust_Id = "ANTON"

   -or-

   REPORT FORM Test FOR RECNO() = 3

   -or-

   REPORT FORM Test NEXT x

   where x is the number of child records related to the parent record.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.50 2.50a 2.50b 2.60 2.60a 3.00 3.00b FoxWin<BR>
VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgRelation
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 14, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
