

<HTML>
<HEAD>
<TITLE>HOWTO: How To Cut/Paste from General Field into a Word Document </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172847">
<META NAME="KBModify" CONTENT="1997/08/19">
<META NAME="KBCreate" CONTENT="1997/08/18">
<META NAME="Keywords" CONTENT="FxinteropWinword vfoxwin kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article illustrates how to  Select All  and  Cut and Paste  an embedded Word Document from a general field into another Word document using code and OLE automation.  MORE INFORMATION  The following example consists of two sections. The first s...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAUJ,QAPP,QDO7,QAEF,QA6A,QBWR,QA7O,QAK9,QABC,QBWS,QA7N,QAH4,QA9N,QBWA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: How To Cut/Paste from General Field into a Word Document</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172847</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article illustrates how to "Select All" and "Cut and Paste" an
embedded Word Document from a general field into another Word document
using code and OLE automation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example consists of two sections. The first section is to
create a mail merge Word document with bookmarks.
<P>
NOTE: This example only works in Microsoft Word 97.
<P>
<P><h2>Create a Word 97 merge document</h2>
 

<OL><P><LI>Create a new Word document in Word 97, and format the document as
   follows:
<P>
   Dear NAME,
<P>
<P><PRE>       CONTENT
</PRE><P>
   Sincerely,
<P>
   John Smith

<P><LI>Create a bookmark for CONTENT and NAME (the names of the bookmarks are
   CONTENT and NAME, respectively).
<P>
   To create these bookmarks, follow these steps:
<P>
   a. Highlight the items in the document (for example, CONTENT).
<P>
   b. Click the Insert menu option and select Bookmark.
<P>
   c. In the Bookmark dialog box, type in the bookmark's name and click
<P><PRE>      Add.
</PRE><P>
   d. Repeat steps a through c for the NAME bookmark.

<P><LI>Save the Word document as “mytest.doc.”
<P>
</OL><h2>Visual FoxPro-Specific Items</h2>
 

<OL><P><LI>Create a table named "mydoc" with the following structure:
<P>
<PRE>   Field name    Type       Size
   ===========   ====       ====
   Content       General     8
   Name          Character   10

</PRE><P><LI>There should be only one record in this table. In the general field,
   paste in any existing Word document. In the Name field, place a ten
   character expression.

<P><LI>Close the table.

<P><LI>Create a form called mail.scx in Visual FoxPro that only has a Command
   button.

<P><LI>Place the following code in the 'Click' method of the Command button:
<P>
   LOCAL oWordObj
   *   Open table
   IF !USED("mydoc")
<P><PRE>     USE mydoc
</PRE>   ELSE
<P><PRE>     SELECT mydoc
</PRE>   ENDIF
<P>
   *   Open a Word Object
   oWordObj = CREATEOBJECT("Word.Application")
<P>
   *   Next open the original document in a second window
   oWordObj.Documents.Open("C:\VFP50\mytest.doc")
<P>
   *   Retrieve the number of bookmarks defined in DOC
   pnCountMarks = oWordObj.ActiveDocument.Bookmarks.Count
<P>
   *   Store bookmarks in an array
   DIMENSION aMark[pnCountMarks]
<P>
   FOR pnCount = 1 TO pnCountMarks
<P><PRE>     aMark[pnCount] = oWordObj.ActiveDocument.Bookmarks(pnCount).Name
</PRE>   ENDFOR
<P>
   *   Loop through all the bookmarks in the document
   FOR pnCount = 1 TO pnCountMarks
<P><PRE>     pcMarkName = UPPER(aMark[pnCount])
</PRE><P>
<PRE>  *     Move to the next bookmark
     WITH oWordObj.ActiveDocument.Bookmarks(pcMarkName).Range

       DO CASE
          CASE pcMarkName = "ANAME"
            .text = ALLTRIM(Name)
          CASE pcMarkName = "CONTENT"  &amp;&amp; goes to bookmark
            oWordObj.WordBasic.ww7_editgoto("CONTENT")
     *         Starts Word
            oWord=GETOBJECT(,"WORD.basic")
     *         Creates Form in VFP
            frmWord=CREATEOBJECT("FORM")
     *         Adds OLE object to form
            frmWord.ADDOBJECT("OBJWORDDOC","OLEBOUNDCONTROL")
     *         Sets the control source
            frmWord.OBJWORDDOC.CONTROLSOURCE="mydoc.content"
     *         frmWord.show
            frmWord.OBJWORDDOC.DoVerb(0)  &amp;&amp; Default for Word doc is 'Edit'
            oWord.EditSelectAll
            oWord.EditCopy
            oWordObj.WordBasic.editpaste
       ENDCASE
     ENDWITH
   ENDFOR
   * Release the Word.Basic object that edits the General field contents,
   * and Close the Form that was opened to access the VFP table with that
   * General field.

   Release oWord
   Release frmWord

   *    Save and Print the document
   oWordObj.WordBasic.FilePrint(0) &amp;&amp; Turn background printing off
   WAIT WINDOW "Printing in Progress" TIMEOUT 3

   oWordObj.WordBasic.FileSaveAs("c:\VFP50\DEMO1.DOC")

   *    Close Word
   oWordObj.WordBasic.DocClose

   *    Quit Word, release the object and clear the desktop
   oWOrdObj.Quit
   Release oWordObj
   Thisform.release

</PRE><P><LI>Save, and run the form. Click on the command button, and Word prints out
   the document with the Name and the Content of the mail merge.
<P>
</OL>NOTE: With the GetObject() command, Word 97 looks for a document with the
<PRE>      desired name. If you want to refer to an already launched instance
      containing your word document, you should leave the first parameter
      empty instead of using an empty string, otherwise you can launch a
      new (invisible) instance of Word containing a NEW document.

</PRE></OL>NOTE: On random occasions this solution can cause an unexplained OLE error
<PRE>      at the following line of code:

      WITH oWordObj.ActiveDocument.Bookmarks(pcMarkName).Range

</PRE>The error message follows:
<P>
<PRE>     OLE IDispatch exception Code 0 from Microsoft Word. The requested
     member of the collection does not exist.

</PRE>Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: vfoxwin<BR>
Keywords          : FxinteropWinword vfoxwin kbinterop<BR>
Technology        : ole<BR>
Version           : WINDOWS:5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
