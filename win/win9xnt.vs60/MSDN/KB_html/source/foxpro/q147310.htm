

<HTML>
<HEAD>
<TITLE>How to Print a Report Based On Selections in a List </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147310">
<META NAME="KBModify" CONTENT="1996/02/23">
<META NAME="KBCreate" CONTENT="1996/02/22">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to present the user with a form containing a multiple select list from a field in a table, and then print a report that contains only the selected records.  MORE INFORMATION  Step-by-Step Example  This example uses...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA4H,QAOX,QA5V,QAPN,QAPF,QAE1,QBXS,QAY2,QAV1,QAV0,QABA,QAYY,QDMW,QA2Q,QA2O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Print a Report Based On Selections in a List</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147310</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to present the user with a form
containing a multiple select list from a field in a table, and then print a
report that contains only the selected records.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
This example uses the Customer table from Testdata.dbc database in the
\Samples\Data subdirectory.

<OL><P><LI>Create a new report. Add the Customer table to the Data Environment, and
   choose Quick Report from the Report Menu. Accept the defaults for a
   Quick Report. Save the report as CustRepo.

<P><LI>Create a new form, and add the Customer table to the Data Environment.

<P><LI>Add a List to the form. In the Properties Sheet of the List do the
   following:
<P>
   a. In the Data tab, set the RowSourceType to 2-Alias and the RowSource
<P><PRE>      to customer.cust_id.
</PRE><P>
   b. In the Other tab, set MultiSelect to true (.T.) and the Name to
<P><PRE>      lstCust_id.
</PRE>
<P><LI>Add a new property to the form. In the New Property dialog box, type:
<P>
   achosen[1]

<P><LI>Add a command button to the form. Type the following code into its
   Click event:
<P>
   local lnCounter
   lnCounter = 0
   DIMENSION ThisForm.achosen[ThisForm.lstCust_id.ListCount]
   WITH ThisForm
<P><PRE>      FOR i = 1 TO .lstCust_id.ListCount
<PRE></PRE>         IF .lstCust_id.Selected(i)
            lnCounter = lnCounter + 1
            .achosen[lnCounter] = .lstCust_id.List[i]
         ENDIF
      ENDFOR
   ENDWITH
   IF lnCounter = 0
     WAIT WINDOW "No Records Chosen !"
   ELSE
      DIMENSION ThisForm.achosen[lnCounter]
      REPORT FORM CustRepo FOR ASCAN(ThisForm.achosen,cust_id) &gt; 0 PREVIEW
   ENDIF
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
