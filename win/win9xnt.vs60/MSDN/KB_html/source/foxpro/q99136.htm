

<HTML>
<HEAD>
<TITLE>How to Use the SCATTER and GATHER Commands in FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99136 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/05/23">
<META NAME="Keywords" CONTENT="kbenv kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The SCATTER command moves data from a database record to an array or a set of memory variables. The array or memory variables can be edited, and the record can then be replaced with the contents of the edited array or memory variables.  The GATHER ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QA7O,QA7N,QA5V,QA9V,QA9U,QA9T,QAY2,QBW6,QBV8,QAB9,QBXS,QAZV,QBLX,QA6A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use the SCATTER and GATHER Commands in FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99136 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 1.0, 1.02, 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The SCATTER command moves data from a database record to an array or a
set of memory variables. The array or memory variables can be edited,
and the record can then be replaced with the contents of the edited
array or memory variables.
<P>
The GATHER command moves data from a set of memory variables or a
memory variable array into the current database record of the active
database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: Although article applies to Visual FoxPro,an alternative to the
SCATTER and GATHER is to turn on BUFFERING. For more information about
Buffering, see Visual FoxPro' online Help on CURSORSETPROP(), Pessimistic
Record Locking, and Optimistic Record Locking.
<P>
For more information about using Buffering, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q129641.htm">Q129641</A></B>
   TITLE     : Alternative to SCATTER and GATHER in the New VFP Model

</PRE><h3>SCATTER and GATHER</h3>
 
<P>
The syntax for the SCATTER command is as follows:
<P>
<PRE>   SCATTER [FIELDS &lt;fields list&gt;] TO  &lt;array&gt;  | TO &lt;array&gt; BLANK |
   MEMVAR | MEMVAR BLANK | MEMO

</PRE>The syntax for the GATHER command is as follows:
<P>
<PRE>   GATHER MEMVAR | FROM &lt;array&gt; FIELDS &lt;field list&gt; | MEMO

  NOTE: In FoxPro 1.02, the SCATTER and GATHER commands ignore memo
  fields and work with only one record. In FoxPro versions 2.0 and 2.5, the
  MEMO keyword places the memo information in an element of an array
  or a memory variable.

</PRE>If a memory variable (&lt;array&gt;) is specified, the contents of the
fields in the record are copied, starting with the first field, into
each element of the array in sequential order.
<P>
If the FIELDS clause is included with a field list, only the specified
fields are transferred to the array. If the FIELDS clause is omitted,
all the fields are transferred.
<P>
The BLANK option creates a memory variable array the same size and
type as the fields from the database. The elements of this array are
left blank.
<P>
The MEMVAR option creates a set of memory variables. One memory
variable is created for each field in the database. Each memory
variable is filled with the corresponding field contents from the
current record.
<P>
NOTE: If you issue the DISPLAY MEMORY command you will see that the memory
variables created by SCATTER are the exact same names as the fields which
they are created from.  The convention of using "m." in front of the field
name is used to distinguish the memory variable from the field. This is
important due to the fact that references to the fields have precedence
over references to the memory variables.
<P>
When the MEMVAR BLANK option is used, a set of empty memory variables
is created.
<P>
The sample code below demonstrates using the SCATTER and GATHER commands.
The Customer database used below is from the FoxPro version 2.x TUTORIAL
directory.
<P>
<PRE>   SET TALK OFF
   USE customer
   SCATTER MEMVAR BLANK
   DEFINE WINDOW menter FROM 6,10 to 18,70 PANEL
   ACTIVATE WINDOW menter
   @ 1,3 SAY 'Customer:'  GET m.company
   @ 3,3 SAY 'Address:'   GET m.address
   @ 5,3 SAY 'City:  '    GET m.city
   @ 7,3 SAY 'State:  '   GET m.state
   @ 7,18 SAY 'ZIP:'      GET m.zip
   @ 9,18 SAY 'Press &lt;esc&gt; to abort'
   READ
   If lastkey() = 27
      GATHER FROM temp
   ENDIF
   DEACTIVATE WINDOW menter
   DISPLAY

</PRE><h2>REFERENCES</h2>
 
<P>
"Commands &amp; Functions": see the SCATTER and GATHER commands
<P>
"Language Reference," version 2.5, L3-542 to L3-543 and L3-851 to L3-853
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxDos FoxWin 1.02 2.00 2.50 2.50a<BR>
scatter gather<BR>
KBCategory: kbenv kbprg<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
