

<HTML>
<HEAD>
<TITLE>PRB: List Boxes and Combo Boxes Lose Item Properties </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136588">
<META NAME="KBModify" CONTENT="1997/08/06">
<META NAME="KBCreate" CONTENT="1995/09/11">
<META NAME="Keywords" CONTENT="FxprgClassoop vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When the RowSource property of a ComboBox or ListBox control is set to a value other than 0-None and there are many items in the list, properties of individual items are lost when you scroll down the list. For example, if you select several items f...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAPN,QAE1,QAHP,QBXQ,QAY5,QAMN,QA7O,QBWS,QA3W,QBVV,QA56,QA55,QA2Q,QAOE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: List Boxes and Combo Boxes Lose Item Properties</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136588</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the RowSource property of a ComboBox or ListBox control is set to a
value other than 0-None and there are many items in the list, properties of
individual items are lost when you scroll down the list. For example, if
you select several items from the list, scroll down the list, and then
scroll up the list, the selected items might not be highlighted anymore.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is due to architectural limitations in the manager that
handles the lists. When the RowSource is non-zero, the list manager creates
60 items internally and recycles them. This improves performance for lists
that have a large number of items. For example, if a list is populated with
a million-row table, Visual FoxPro does not have to take the speed and
memory penalty associated with creating a million list items. Because they
are recycled, properties set on the items are lost during operations such
as scrolling. This behavior does not occur in Visual FoxPro 5.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Populate the controls with the AddItem and RemoveItem methods. These
methods create non-recyclable items that are guaranteed to retain their
properties.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Place a ListBox control on a form.

<P><LI>Save and run the form.

<P><LI>Type the following in a program, and run the program:
<P>
   Listbox.RowSourceType = 6 *** type fields
   Listbox.RowSource = "customer.name"
   Listbox.MultiSelect = .T.
   Listbox.Selected(1) = .T.
   Listbox.Selected(100) = .T.

<P><LI>Query the value of Listbox.Selected(1). It returns false (.F.). If you
   select the first property manually, then scroll down 100 items and
   multiple-select (hold the SHIFT key down as you click) the 100th item,
   and then scroll back up to the top, the selection is gone.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: List box<BR>
Keywords          : FxprgClassoop vfoxwin<BR>
Version           : 3.0 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
