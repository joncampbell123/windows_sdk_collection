

<HTML>
<HEAD>
<TITLE>PRB: "The database must be opened exclusively" Multiuser Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130659">
<META NAME="KBModify" CONTENT="1997/07/01">
<META NAME="KBCreate" CONTENT="1995/05/24">
<META NAME="Keywords" CONTENT="FxprgMultiuser kbnetwork kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a multiuser situation, when you perform tasks that affect the contents of a database (.DBC file), the error  The database must be opened exclusively  is displayed.  CAUSE =====  The command requires exclusive access to the database. Several comm...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QAGB,QBWS,QAAW,QAB4,QA28,QATJ,QAB9,QAI5,QAAP,QADK,QBV8,QBVV,QALQ,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "The database must be opened exclusively" Multiuser Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130659</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a multiuser situation, when you perform tasks that affect the contents
of a database (.DBC file), the error "The database must be opened
exclusively" is displayed.
<P>
<P><h2>CAUSE</h2>
 
<P>
The command requires exclusive access to the database. Several commands
that create or modify database objects require that the database not be
shared--at design time or run time.
<P>
This error may also occur at run time in an application or EXE if you have
included the database(s) in the project. By including the database(s) in
the project, you have caused them to be read-only, and you will not be able
to properly validate the database. In this situation, it is possible for
ISE CLUSIVE() to return a .T. (true) value and still get the error message
described above.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you receive the error "The database must be opened exclusively" at
design time, all developers must close the database before you can proceed.
<P>
To prevent this error from occurring at run time when manipulating views or
connections, create a local database for each user. All users will have
exclusive access to their database, and will also be able to update the
table records contained in a centralized, shared database.
<P>
To verify whether or not a database is open exclusively, use the
ISEXCLUSIVE() function. The syntax for the ISEXCLUSIVE() function is:
<P>
<PRE>   ISEXCLUSIVE([cTableAlias | nWorkArea | cDatabaseName [, nType]])

</PRE>When the nType parameter has a value of 2, the function returns the
exclusive status for a database. The following example code makes sure the
database is open exclusively before using the INDEX ON command:
<P>
<PRE>   CLOSE ALL
   OPEN DATABASE SYS(2004)+"SAMPLES\DATA\TESTDATA"
   SELECT 0
   USE CUSTOMER
   IF ISEXCLUSIVE('testdata',2)
      INDEX ON CITY TAG CITY
      ELSE
      =MESSAGEBOX("Database must be opened Exclusively")
   ENDIF
   CLOSE DATABASE

</PRE>NOTE: The above code uses CLOSE ALL to close all the files so that the
database can be opened but not selected, making the CLOSE DATABASE command
useless. Of course using CLOSE DATABASE ALL might not be helpful if only
one database needs to be closed. Therefore, issue the following code to
select a certain database to close and reopen:
<P>
<PRE>   SET DATABASE TO &lt;dbc name&gt;
   CLOSE DATABASE
   OPEN DATABASE &lt;dbc name&gt; EXCLUSIVE

</PRE>This ensures that the correct database container is selected, closed, and
reopened.
<P>
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If a view or a table contained in a database is open for shared use, the
database is also shared. Therefore, all multiuser applications require that
a database be shared.
<P>
However, commands that directly relate to the database (.DBC file)
structure and commands that involve the creation or deletion of objects
require exclusive use of the database. These commands include:
<P>
<PRE>   CREATE TABLE
   MODIFY STRUCTURE
   ALTER TABLE
   ADD TABLE
   RENAME TABLE

   CREATE SQL VIEW
   MODIFY VIEW
   DELETE VIEW
   RENAME VIEW

   CREATE CONNECTION
   MODIFY CONNECTION
   DELETE CONNECTION
   RENAME CONNECTION

   INDEX ON         &amp;&amp; You can however use INDEX ON on a view
   DELETE TAG

   CREATE TRIGGER
   DELETE TRIGGER

   APPEND PROCEDURES
   COPY PROCEDURES
   MODIFY PROCEDURE

   COMPILE DATABASE
   PACK DATABASE
   VALIDATE DATABASE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: denied<BR>
Keywords            : FxprgMultiuser kbnetwork kbprg kbprb<BR>
Version             : 3.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
