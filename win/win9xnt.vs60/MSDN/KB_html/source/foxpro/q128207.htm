

<HTML>
<HEAD>
<TITLE>How to Create Disappearing GETs in FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128207">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/03/27">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to offer a GET object for selection only after specific criteria are met, preventing the selection and display of the GET object at all other times.  Although a simple WHEN test controls selection of a GET object, ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QAPN,QAG9,QBXS,QAW6,QAA8,QAH4,QBWS,QA5D,QAXC,QA4P,QBJZ,QACF,QAPG,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create Disappearing GETs in FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128207</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to offer a GET object for selection only
after specific criteria are met, preventing the selection and display of
the GET object at all other times.
<P>
Although a simple WHEN test controls selection of a GET object, it does not
prevent the user from viewing it if the condition is not met. In the case
of input fields, the disabled colors can be set to the same colors as the
background screen, causing it to effectively disappear. Unfortunately, this
technique won't work for buttons and popups, and disabling the GET does not
prevent the button or popup object from appearing on the screen in dithered
colors.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following code demonstrates how to define objects in Screen Builder
that through sleight-of-Hand give the appearance of disappearing and
re-appearing on command. The example demonstrates how to hide the GET
object when the screen is initially displayed, and then reveal it in
response to a push button.

<OL><P><LI>Issue the following to create a new screen:
<P>
   CREATE SCREEN MAGIC

<P><LI>Pick Layout from the Screen menu pad. Then choose the Color... button.

<P><LI>Set the background to light gray. Then click OK twice to return.

<P><LI>Add a push button in the lower center of the screen.

<P><LI>Enter the following as the push button Prompt:
<P>
   \&lt;Pres-to!

<P><LI>Name the variable hocus.

<P><LI>In the VALID clause, add the following code:
<P>
   IF hocus = 'Pres-to!!'
<P><PRE>      SHOW GET hocus,1 PROMPT 'Change-o!'
      SHOW GET pocus,1 ENABLED
</PRE>   ELSE
<P><PRE>      SHOW GET hocus,1 PROMPT 'Prest-o!!'
      SHOW GET pocus,1 DISABLED
      SHOW GETS OFF
</PRE>   ENDIF

<P><LI>Add another push button in the upper center of the screen.

<P><LI>Enter the following as the push button Prompt:
<P>
   \&lt;Abracadabra!

<P><LI>Name the variable pocus.

<P><LI>Mark it as Initially Disabled.

<P><LI>In the WHEN clause, enter this command:
<P>
<P><PRE>    WAIT WINDOW "Voila!" NOWAIT
</PRE>
<P><LI>Surround the Abracadabra push button with a Box object.

<P><LI>While the Box is selected, choose Object from the menu.

<P><LI>Select light gray for Fill color and also for Pen color.

<P><LI>Generate the screen. Then open the .SPR as shown:
<P>
<P><PRE>    MODIFY COMMAND MAGIC.SPR
</PRE>
<P><LI>Locate the line in the Screen Layout section of the .SPR file that
<P><PRE>    creates the Box object, such as the following example:
</PRE><P>
<P><PRE>    @ 7.385,19.200 TO 14.847,38.600 ;
    PATTERN 1 ;
    PEN 1, 8 ;
    COLOR RGB(192,192,192,192,192,192)
</PRE>
<P><LI>Highlight the entire statement. Then copy it by pressing CTRL+C or by
<P><PRE>    choosing Copy from the Edit menu.
</PRE>
<P><LI>Close the .SPR file. Then execute the MODIFY SCREEN MAGIC command.

<P><LI>Under Screen Layout, choose Code... and select On Refresh.

<P><LI>Select the procedure box. Then paste the code by pressing CTRL+V or by
<P><PRE>    choosing Paste from the Edit menu.
</PRE>
<P><LI>Regenerate the screen. Close the .SCX file and execute the DO MAGIC.SPR
<P><PRE>    command.
</PRE><P>
</OL>To test the effect, click the 'Prest-o!!' button to cause the hidden button
to appear. Click the 'Abracadabra!' button. Then click the 'Change-o!'
button to cause the button to vanish. Then click where the other button was
to show it is no longer accessible.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.60a<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
