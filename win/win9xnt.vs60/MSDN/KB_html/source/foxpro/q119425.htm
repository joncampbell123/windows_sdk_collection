

<HTML>
<HEAD>
<TITLE>FIX: Long Numeric Values Lost When Returning Data from SQL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119425">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/08/16">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In FoxPro for MS-DOS, when you are querying a SQL Server database using the FoxPro SQL (FPSQL) function library in the FoxPro Connectivity Kit, null values may be returned for numeric data if the data is stored on the server as float with a high nu...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAKC,QA7O,QA7N,QAY2,QAUD,QAR4,QAKD,QBC6,QA5V,QAXB,QACI,QAKP,QBG2,QAG8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Long Numeric Values Lost When Returning Data from SQL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119425</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.60
MS-DOS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6
<LI>Microsoft FoxPro Connectivity Kit, versions 2.5x, 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In FoxPro for MS-DOS, when you are querying a SQL Server database using the
FoxPro SQL (FPSQL) function library in the FoxPro Connectivity Kit, null
values may be returned for numeric data if the data is stored on the server
as float with a high number of decimal places.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem is caused by FPSQL.PLB not handling long numbers properly. When
you are trying to bring in a number such as -0.07, which is stored in SQL
Server as something like -0.07000000000000001, FPSQL cannot handle this
properly and instead of returning the number, it returns a blank field.
<P>
<P><h2>STATUS</h2>
 
<P>
This problem has been confirmed in the Microsoft products listed at the
beginning of this article. This problem was corrected in version 2.6a of
the Microsoft FoxPro Connectivity Kit, which is part of Microsoft FoxPro
version 2.6a for MS-DOS Professional Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce the Problem</h3>
 

<OL><P><LI>Create or use a table on a SQL Server machine that has a float field. If
   the table has already been created, use the following commands from
   FoxPro to load FPSQL.PLB and connect to the database
<P>
<P><PRE>      SET LIBRARY TO LOCFILE("fpsql.plb")
      handle = DBCONNECT(&lt;Data Source Name&gt;, &lt;User&gt;, &lt;Password&gt;)
</PRE><P>
   where &lt;Data Source Name&gt; is the name of the SQL Server, &lt;User&gt; is the
   user identifier, and &lt;Password&gt; is the corresponding password. All of
   these should be character expressions. There is a fourth parameter on
   the DBCONNECT command for a connection string, but it is not required.

<P><LI>From FoxPro, insert a new record in the SQL Server table. For example,
   if there was a table called "Table1" with two fields called "Field1" and
   "Field2" that were a character and a float respectively, the command
   would be:
<P>
<P><PRE>      =DBEXEC(handle,'INSERT INTO Table1 VALUES("One",-0.07)')
</PRE>
<P><LI>Send a SQL command to the server from FoxPro:
<P>
<P><PRE>      =DBEXEC(handle,'SELECT * FROM Table1')
</PRE><P>
</OL>Browsing the resulting cursor will show a empty float field for the record
that was just inserted. The character field will have the correct data. No
error will be returned.
<P>
This problem occurs with -0.07 because of the way SQL Server stores this
number. You can also reproduce this problem by using this code with the
field and table names mentioned above:
<P>
<PRE>   =DBEXEC(handle,'INSERT INTO Table1 VALUES("TWO",-0.05)')
   =DBEXEC(handle,"SELECT * FROM Table1")
   BROWSE
   * The record will show up and the value in the
   * float field will show -0.05
   =DBEXEC(handle,'UPDATE Table1 SET Field2 = Field2 - 1 ;
      WHERE Field1 = "TWO"')
   =DBEXEC(handle,'UPDATE Table1 SET Field2 = Field2 + 1 ;
      WHERE Field1 = "TWO"')
   =DBEXEC(handle,"SELECT * FROM Table1")
   BROWSE

</PRE></OL>Once again, the numeric field will be empty. Although the number should be
the same by adding and subtracting 1, the UPDATE query will actually make a
slight change to the value on the server.
<P>
NOTE: If you have problems running the code in FoxPro for MS-DOS, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q112482.htm">Q112482</A></B>
   TITLE     : How to Make an MS-DOS Level SQL Server Connection
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos buglist2.50 buglist2.50a buglist2.50b<BR>
buglist2.60 fixlist2.60a 2.50 2.50a 2.50b 2.60 ck<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory:<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
