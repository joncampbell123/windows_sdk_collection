

<HTML>
<HEAD>
<TITLE>BUG: Report Preview with Form's Name Clears Object Reference </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155463">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1996/08/29">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxprgGeneral vfpbug5.0a kbdisplay kbother kbprg kb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Issuing a REPORT FORM PREVIEW command on a report that has the same file name as a form that is running causes the form to lose its object reference. If you attempt to reference the form object in code, this error message appears:     Object not fo...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QAPN,QAW6,QAUJ,QBV8,QAB9,QAH4,QAI2,QAK5,QAJQ,QAB3,QBWS,QAUR,QAJX,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Report Preview with Form's Name Clears Object Reference</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155463</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Issuing a REPORT FORM PREVIEW command on a report that has the same file
name as a form that is running causes the form to lose its object
reference. If you attempt to reference the form object in code, this error
message appears:
<P>
<PRE>   Object not found

</PRE><h2>WORKAROUND</h2>
 
<P>
If you have a form called Customer and issue the following command, an
object reference named Customer is created for the form:
<P>
<PRE>   DO FORM Customer

</PRE>Preview a report named Customer by issuing the following command:
<P>
<PRE>   REPORT FORM Customer PREVIEW

</PRE>The customer object now references the Report Preview window. When the
Report Preview window is closed, the customer object is released. Work
around this problem by giving your forms a different object reference than
the reports with the same name. Do this by using the NAME clause in the DO
FORM command. For example, to give the Customer Form an object reference of
Custform, you would issue the following command:
<P>
<PRE>   DO FORM Customer NAME Custform

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Steps to Reproduce Problem
 

<OL><P><LI>Create a report using the Customer.dbf file in the Vfp\Samples\Data
   folder.

<P><LI>Save the report as Customer.

<P><LI>Create a new form.

<P><LI>Add two command buttons to the form.

<P><LI>In the Click event of the first command button, add the following code:
<P>
<P><PRE>      Customer.Caption = "Change Me"
</PRE>
<P><LI>In the Click event of the second command button, add the following code:
<P>
<P><PRE>      REPORT FORM Customer PREVIEW
</PRE>
<P><LI>Save the form as Customer.

<P><LI>Run the Customer form and click the first command button, then click the
   second command button.

<P><LI>Close the Print Preview window and then click the first command
   button again.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbother kbdisplay kbbuglist<BR>
KBSubcategory: FxprgGeneral vfoxwin buglist3.00 buglist3.00b buglist5.00<BR>
Additional reference words: 5.00 3.00 3.00b<BR>
Keywords          : buglist3.00 buglist3.00b buglist5.00 FxprgGeneral vfpbug5.0a kbdisplay kbother kbprg kbbuglist<BR>
Version           : 3.0 3.0b 5.0 5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
