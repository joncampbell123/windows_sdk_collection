

<HTML>
<HEAD>
<TITLE>PRB: Caption Dithered If DisabledForeColor Equals ForeColor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156101">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/17">
<META NAME="Keywords" CONTENT="kbui kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  For certain Visual FoxPro controls, if the DisabledForeColor property is set the same as the ForeColor property when the control is disabled, the disabled control's foreground color appears dithered. This behavior applies to command buttons, labels...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QABI,QAMB,QBXS,QAPN,QA7O,QA4P,QAMN,QAB5,QAOE,QAH4,QAEB,QAUJ,QAJQ,QAW6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Caption Dithered If DisabledForeColor Equals ForeColor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156101</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
For certain Visual FoxPro controls, if the DisabledForeColor property is
set the same as the ForeColor property when the control is disabled, the
disabled control's foreground color appears dithered. This behavior applies
to command buttons, labels, option buttons, and check boxes. This behavior
also affects how their captions appear.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Set the DisabledForeColor property to be 1 (one) different from the
ForeColor property. For example, place the following code in the Init
method for a check box:
<P>
<PRE>   this.DisabledForeColor = this.ForeColor + 1

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior occurs when the two properties are set the same. Because the
control is disabled, its caption appears dithered to indicate the control
is disabled. In certain cases, you may want the disabled control to appear
nearly identical to the enabled control. If so, use the technique in the
WORKAROUND section above.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Run the following code from a program (.prg) file:
<P>
<P><PRE>      * Start of code example
      *
      PUBLIC oform1
      oform1=CREATEOBJECT("form1")
      oform1.SHOW
</PRE><P>
<P><PRE>      DEFINE CLASS form1 AS FORM
</PRE><P>
<PRE>        HEIGHT = 184
        WIDTH = 251
        AUTOCENTER = .T.
        CAPTION = "DisabledForeColor Test"
        NAME = "Form1"

        ADD OBJECT label1 AS LABEL WITH ;
          CAPTION = "Label1", ;
          LEFT = 24, ;
          TOP = 12, ;
          AUTOSIZE = .T., ;
          NAME = "Label1"

        ADD OBJECT optiongroup1 AS OPTIONGROUP WITH ;
          BUTTONCOUNT = 2, ;
          VALUE = 1, ;
          LEFT = 24, ;
          TOP = 48, ;
          AUTOSIZE = .T., ;
          NAME = "Optiongroup1", ;
          option1.CAPTION = "Option1", ;
          option1.VALUE = 1, ;
          option1.LEFT = 5, ;
          option1.TOP = 5, ;
          option1.AUTOSIZE = .T., ;
          option2.CAPTION = "Option2", ;
          option2.VALUE = 0, ;
          option2.LEFT = 5, ;
          option2.TOP = 24, ;
          option2.AUTOSIZE = .T.

        ADD OBJECT check1 AS CHECKBOX WITH ;
          TOP = 12, ;
          LEFT = 132, ;
          AUTOSIZE = .T., ;
          CAPTION = "Check1", ;
          NAME = "Check1"

        ADD OBJECT check2 AS CHECKBOX WITH ;
          TOP = 132, ;
          LEFT = 24, ;
          AUTOSIZE = .T., ;
          CAPTION = "Disable all", ;
          NAME = "Check2"

        ADD OBJECT check3 AS CHECKBOX WITH ;
          TOP = 132, ;
          LEFT = 132, ;
          AUTOSIZE = .T., ;
          CAPTION = "Add the 1?", ;
          NAME = "Check3"

        ADD OBJECT command1 AS COMMANDBUTTON WITH ;
          TOP = 60, ;
          LEFT = 120, ;
          HEIGHT = 27, ;
          WIDTH = 90, ;
          CAPTION = "Command1", ;
          NAME = "Command1"

        PROCEDURE optiongroup1.option1.REFRESH
          THIS.DISABLEDFORECOLOR=THIS.FORECOLOR + THISFORM.check3.VALUE
        ENDPROC

        PROCEDURE optiongroup1.option2.REFRESH
          THIS.DISABLEDFORECOLOR=THIS.FORECOLOR + THISFORM.check3.VALUE
        ENDPROC

        PROCEDURE check1.REFRESH
          THIS.DISABLEDFORECOLOR=THIS.FORECOLOR + THISFORM.check3.VALUE
        ENDPROC

        PROCEDURE check2.CLICK
          THISFORM.label1.DISABLEDFORECOLOR = ;
            THISFORM.label1.FORECOLOR + ;
            THISFORM.check3.VALUE  &amp;&amp;  Added because Label has no refresh
          THISFORM.REFRESH
          THISFORM.SETALL('enabled',!THISFORM.check1.ENABLED)
          THIS.ENABLED=.T.
        ENDPROC

        PROCEDURE command1.REFRESH
          THIS.DISABLEDFORECOLOR=THIS.FORECOLOR + THISFORM.check3.VALUE
        ENDPROC

      ENDDEFINE
      *
      * End of code example

</PRE><P><LI>Click the "Disable all" check box. The captions of the disabled controls
   appear dithered.

<P><LI>To demonstrate the workaround, clear the "Disable all" check box, click
   the "Add the 1?" check box, and click the "Disable all" check box. The
   control captions are not dithered but are still displayed with a 3-D
   effect.
<P>
</OL>NOTE: Depending on whether the "Add the 1?" check box is checked, the
DisabledForeColor property for each of the controls is set to either its
ForeColor (the "Add the 1?" check box is cleared) or its ForeColor + 1 (the
"Add the 1?" check box is cleared).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbui kbprb<BR>
KBSubcategory: FxprgClassoop FxtoolFormdes<BR>
Additional reference words: 3.00 3.00b 5.00 kbdse VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
