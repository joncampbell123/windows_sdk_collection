

<HTML>
<HEAD>
<TITLE>PRB: "Multi Use" Cannot be Selected Until .exe is Created </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162298">
<META NAME="KBModify" CONTENT="1997/02/10">
<META NAME="KBCreate" CONTENT="1997/01/17">
<META NAME="Keywords" CONTENT="kbole kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When building an OLE Server, you may want to allow multiple users to access one instance of an OLE server executable. You can do this by selecting Multi Use in the Instances list that is located on the Servers tab in the Project Info dialog box. If...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2Q,QABO,QBWS,QBHQ,QBW7,QAI5,QBVV,QAJN,QAG2,QBWG,QAJQ,QA9Q,QA56,QA55,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Multi Use" Cannot be Selected Until .exe is Created</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162298</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When building an OLE Server, you may want to allow multiple users to access
one instance of an OLE server executable. You can do this by selecting
Multi Use in the Instances list that is located on the Servers tab in the
Project Info dialog box. If the Project has not been built into an
executable at least once, this selection is not available. This selection
is only available after the executable has been built if olepublic is
selected in the Class Info dialog box for a class in the Visual Class
Library.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Build the executable. When the library is displayed, select Multi Use.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Servers tab shows the class library name that is included in the
project only after the executable has been built. So an OLE server
executable that is designed to allow multiple users to access the same
instance must be built at least twice. It must be built the first time so
that the class library appears and you can select Multi Use for instancing.
It must be built again so that the executable builds in multi use
capability. Typically this is not a problem because the executable is built
several times before it is made multi-user capable.
<P>
The project does not know that the class is marked as olepublic until the
executable is built.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a wait window program and add it to a new project.

<P><LI>Add a library with a class in it to the project.

<P><LI>Modify the class, mark its class as olepublic under the Class Info
   dialog box, and save the class.

<P><LI>On the Project menu, click Project Info.

<P><LI>Click the Servers tab. Nothing is displayed, and you cannot select Multi
   Use in the Instances list.
<P>
</OL>Build the executable, and check the Servers tab again. The library is
displayed and you can select Multi Use in the Instances list.
<P>
NOTE: The same executable should not be used as an OLE server and as a
standalone executable. If the executable is run as a standalone executable
and then accessed as a server, two instances of the executable will run.
The executable, running standalone, cannot be accessed as a server.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Visual FoxPro Developer's Guide," version 5, page 441
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbole kbtool kbprb<BR>
KBSubcategory: FxtoolDk FxtoolProjman vfoxwin<BR>
Additional reference words: 5.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
