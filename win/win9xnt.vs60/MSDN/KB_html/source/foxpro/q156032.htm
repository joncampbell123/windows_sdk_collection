

<HTML>
<HEAD>
<TITLE>PRB: Position of @...SAYs Incorrect When Printing in Raw Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156032">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/13">
<META NAME="Keywords" CONTENT="kbprint kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In both FoxPro for Windows and Visual FoxPro for Windows, when attempting to use raw mode printing with @...SAYs that changes the formatting of a word or words on the same line of output, the printed words following the format changes will not prin...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAOX,QAE1,QAGB,QDMN,QACI,QA5A,QAKC,QABX,QACT,QBC6,QABG,QAG8,QBEN,QBEM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Position of @...SAYs Incorrect When Printing in Raw Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156032</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
<LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In both FoxPro for Windows and Visual FoxPro for Windows, when attempting
to use raw mode printing with @...SAYs that changes the formatting of a
word or words on the same line of output, the printed words following the
format changes will not print in the expected position. The text after the
escape codes will be moved to the left one column for each escape code that
is inserted in the @...SAY.
<P>
<P><h2>CAUSE</h2>
 
<P>
When FoxPro executes a series of @...SAYs, it determines the output column
of the first @...SAY, determines the length of the output text, and then
pads the remaining columns with spaces up to the next @...SAY command.
<P>
Therefore, when FoxPro calculates the column position of the @...SAY of the
next word in the line of output, it includes the escape codes as viable
columns. However, when the output is sent to the printer, the printer
removes these escape codes from the line and executes the command. Since
escape codes are printer commands, they are essentially treated as null
characters and the following text is moved to the left one column for each
escape code the printer uses.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are two ways to work around this behavior. Use one of the following
methods:
<P>
<P><h3>Method 1</h3>
 
<P>
With this method, the second @...SAY command must take into account the
number of escape codes entered, and the column number must be incremented
accordingly. For example, if the name needs to be printed in column 35, the
code would appear as follows:
<P>
<PRE>   @1,1 SAY CHR(27)+ '(s3B' + 'Pay to the order of:'  &amp;&amp;BOLD on
   @1,40 SAY CHR(27)+ '(s30' + 'John Doe'       &amp;&amp;BOLD off

</PRE>Note that the second @...SAY has incremented the column count by five to
offset the five escape codes.
<P>
<P><h3>Method 2</h3>
 
<P>
This method requires the ability to move the printer head to an exact
column position with an escape code. If this is possible, then the two text
portions of the @...SAY are concatenated along with the escape code that
moves the second text to an exact column number. The following example
demonstrates printing the name in column 35 on a Hewlett-Packard LaserJet:
<P>
<PRE>   * Escape code CHR(27)+'&amp;a35C' starts the name in column 35
   @1,1 SAY CHR(27)+ '(s3B' + 'Pay to the order of:;
      '+CHR(27)+'(s0B'+CHR(27)+'&amp;a35C'+'Jack Doe'

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Sometimes it is desirable to use raw mode printing in FoxPro for Windows
2.6 or Visual FoxPro for Windows 3.0 to obtain output that may not be
possible using the Report Writer. This works as expected when using escape
codes to change an entire line of output to bold or italic, for example.
The problem occurs when performing in-line formatting changes of a word or
group of words. When attempting to change the word formatting in this
manner, FoxPro will interpret the escape codes as a part of the output
character string and will not print the next word in the correct column
even though it is told in the @...SAY to start printing at an explicit
column number. Therefore, for every escape code entered, the actual column
in which the following word will print will be one less than the actual
column number in the @...SAY.
<P>
For example, if the desired output is to be formatted like this:
<P>
<PRE>   Column number:
   1                                 35
   Pay to the order of:              John Doe

</PRE>the code would appear as follows for an HP LaserJet printer:
<P>
<PRE>   @1,1 SAY CHR(27)+ '(s3B' + 'Pay to the order of:'    &amp;&amp; (s3B'= BOLD on
   @1,35 SAY CHR(27)+ '(s30' + 'John Doe'               &amp;&amp; (s30'= Bold off

</PRE>where 'Pay to the order of:' is bold and the name is non-bold text. The
printer would move the name five columns to the left. This occurs because
the printer requires five escape codes, 'CHR(27)'+'('+'s'+'3' +'0', to turn
off bold formatting. The actual printer output would look like the
following:
<P>
<PRE>   Column number:
   1                            30
   Pay to the order of:         John Doe

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
<PRE>   * Start of code example
   SET DEVICE TO PRINTER
   ???""
   @1,1 SAY '1        10        20        30'          &amp;&amp;Column    numbers
   @2,1 SAY CHR(27)+ '(s3B' + 'Pay to the order of:'   &amp;&amp;Turn bold    on
   @2,35 SAY CHR(27)+ '(s0B' + 'John Doe'              &amp;&amp;Turn bold off
   SET DEVICE TO SCREEN
   SET PRINTER TO                                      &amp;&amp;Flush print job
   * end of code
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprint kbprb<BR>
KBSubcategory: FxprintRaw<BR>
Additional reference words: 2.60a 3.00 3.00b kbdsd VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
