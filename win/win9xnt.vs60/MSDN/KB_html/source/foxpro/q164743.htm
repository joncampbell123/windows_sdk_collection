

<HTML>
<HEAD>
<TITLE>PRB: Printing @..SAYs is Slow in FoxPro/DOS Under Win95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164743">
<META NAME="KBModify" CONTENT="1997/03/07">
<META NAME="KBCreate" CONTENT="1997/03/06">
<META NAME="Keywords" CONTENT="FoxDos FxprintGeneral FxprintNet kbprint">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Printing @..SAYs from FoxPro for MS-DOS to some network printers under Windows 95 on a Windows NT network is slow. The output comes out of other printers much more quickly.  CAUSE =====  The printers that are slow to release the print jobs are capt...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QDJP,QACT,QBXS,QAKG,QBWQ,QDL9,QBWO,QBWN,QAVZ,QBWS,QA1O,QBV8,QAB9,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Printing @..SAYs is Slow in FoxPro/DOS Under Win95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164743</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, version 2.6a
   on the following platform: Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Printing @..SAYs from FoxPro for MS-DOS to some network printers under
Windows 95 on a Windows NT network is slow. The output comes out of
other printers much more quickly.
<P>
<P><h2>CAUSE</h2>
 
<P>
The printers that are slow to release the print jobs are captured on the
LPT2 or LPT3 ports.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Capture the printers on LPT ports other than LPT2 and LPT3.
<P>
To change the port that the printer is captured under, follow these steps:

<OL><P><LI>From the Windows 95 Start menu, choose Settings and then Printers.

<P><LI>Click the desired printer icon to select it.

<P><LI>Right-click the selected printer icon and select Properties.

<P><LI>In the Properties dialog box, click the Details tab.

<P><LI>Click End Capture and (if more than one printer is listed) select the
   printer that is on LPT2 or LPT3. Click OK to end the capture of the
   printer port.

<P><LI>In the Properties dialog box, click Capture Printer Port...

<P><LI>Choose any LPT port except LPT2 or LPT3 from the Device dropdown list.

<P><LI>In the Path dropdown list, choose the path to the network printer or
   type the path in if it is not listed.

<P><LI>Click OK.
<P>
</OL>Note that the LPT ports listed in the Capture Printer Port... dialog box
are logical ports. They do not need to be physically available on the
computer.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Because printing is very complex and the printer, network and
configuration of the computer can have a major influence on it, the scope
of this article is very narrow. However, if the scenario described herein
applies, the resolution should solve the problem.
<P>
The resolution should work if you are running FoxPro for MS-DOS in a DOS
window under Windows 95. The network should either be a Windows NT or
Windows 95 network. The printers should be shared via the network.
<P>
In order to print from MS-DOS based programs, printers in Windows 95 need
to be captured. The Add Printer Wizard in Windows 95 asks this question
when setting up an new printer.
<P>
Printing reports in FoxPro for MS-DOS exhibits similar behavior as the @
SAY commands. However, without issuing the SET PRINTER TO command after
the REPORT FORM command, the report will still come out slowly. By issuing
SET PRINTER TO immediately after the REPORT FORM command, it allow the
report to start printing immediately if the printer is captured on any LPT
port except LPT2 or LPT3. Some sample code follows:
<P>
<PRE>   SET PRINTER TO LPT1
   REPORT FORM &lt;whatever&gt; TO PRINT
   SET PRINTER TO

</PRE></OL><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Follow the steps in the resolution section to capture a network printer
   on the LPT1 port.

<P><LI>In the FoxPro for MS-DOS Command window, type the following commands:
<P>
<P><PRE>      SET PRINTER TO
      SET DEVICE TO PRINTER
      SET PRINTER TO LPT1
      @ 1,1 SAY "Hello"
      @ 2,1 SAY "Goodbye"
<PRE></PRE>      SET PRINTER TO          &amp;&amp; the print job should start printing now
      SET DEVICE TO SCREEN

   Note that as soon as the second SET PRINTER TO command is issued when
   the printer is captured on LPT1, the print job starts printing
   immediately.

</PRE><P><LI>Capture the same network printer on the LPT2 or LPT3 port following the
   steps in the resolution section. Be sure to End Capture the printer
   from the LPT1 port first.

<P><LI>Repeat the commands in step 2 above substituting LPT2 (or LPT3) for
   LPT1 in the SET PRINTER TO LPT1 command. Note that the print job does
   not immediately come out when the SET PRINTER TO command is issued. In
   fact, it may not come out at all until FoxPro is exited. Even a second
   SET PRINTER TO command after the @..SAYs will not cause the print job
   to be released.

<P><LI>Repeat all this using LPT4, LPT5, LPT6 or higher. The print job should
   be released immediately after the SET PRINTER TO command with all ports
   except LPT2 and LPT3.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft "Windows 95 Resource Kit," pages 393-394, 602 and 781
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FoxDos FxprintGeneral FxprintNet kbprint<BR>
Version             : 2.6a<BR>
Platform            : MS-DOS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
