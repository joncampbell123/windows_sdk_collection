

<HTML>
<HEAD>
<TITLE>PRB: "Out of Environment Space" Error When Using RUN Command </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101596">
<META NAME="KBModify" CONTENT="1995/04/17">
<META NAME="KBCreate" CONTENT="1993/07/19">
<META NAME="Keywords" CONTENT="kbprg kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You receive an  Out of Environment Space  error message when you are using a RUN command in FoxPro to execute a batch file or program that issues SET commands or other commands that take up environment space.  CAUSE =====  When the FoxPro RUN comma...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QAB4,QAX1,QAB9,QBV8,QAEF,QADN,QBWS,QBFY,QBW5,QAVX,QAVW,QBBI,QAVI,QAEX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Out of Environment Space" Error When Using RUN Command</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101596</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You receive an "Out of Environment Space" error message when you are using
a RUN command in FoxPro to execute a batch file or program that issues SET
commands or other commands that take up environment space.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the FoxPro RUN command is issued, it has a default of 256 bytes of
environment space. After this 256 bytes is used up, an "Out of Environment
Space" error message is displayed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Issue the RUN command in the following form:
<P>
<PRE>   RUN c:\command.com /e:&lt;nnnnn&gt; /c &lt;string&gt;

</PRE>The /e:&lt;nnnnn&gt; parameter specifies the environment size; increasing this
parameter (for example, to 2048) will cause the "Out of Environment Space"
message to disappear. The /c &lt;string&gt; parameter specifies that the command
interpreter is to perform the command specified by &lt;string&gt; and then stop.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Increasing the /e: parameter on a SHELL statement has no effect on the
above error message because when an MS-DOS virtual machine (VM) is started,
it does not inherit the settings from the SHELL statement in the
CONFIG.SYS; thus, it is necessary to directly specify the environment space
needed when starting the MS-DOS shell.
<P>
<P><h3>Steps to Reproduce the Problem</h3>
 

<OL><P><LI>Create a batch file called TEST.BAT and input the following:
<P>
<P><PRE>      SET test1=1
      SET test2=2
      SET test3=3
      SET test4=4
      SET test5=5
      SET test6=6
      SET test7=7
      SET test8=8
      SET test9=9
      SET test10=10
      PAUSE
      SET test11=11
      SET test12=12
      SET test13=13
      SET test14=14
      SET test15=15
      SET test16=16
      SET test17=17
      SET test18=18
      SET test19=19
      SET test20=20
      PAUSE
      SET test21=21
      SET test22=22
      SET test23=23
      SET test24=24
      SET test25=25
      SET test26=26
      SET test27=27
      SET test28=28
      SET test29=29
      SET test30=30
      PAUSE
      SET test31=31
      SET test32=32
      SET test33=33
      SET test34=34
      SET test35=35
      SET test36=36
      SET test37=37
      SET test38=38
      SET test39=39
      SET test40=40
      PAUSE
</PRE>
<P><LI>Issue the following command in the Command window:
<P>
<P><PRE>      RUN c:\test.bat
</PRE><P>
   Note that after the SET test4=4 statement is executed that an "Out
   of Environment Space" error message is displayed.

<P><LI>In the CONFIG.SYS file, change the /e:&lt;nnnnn&gt; environment setting
   to be twice its current value. Repeat step 2. Note that an "Out of
   Environment Space" error message is still displayed.

<P><LI>Issue the following command in the Command window:
<P>
<P><PRE>      RUN c:\command.com /e:2048 /c c:\test.bat
</PRE><P>
   Note that the "Out of Environment Space" error message is no longer
   displayed.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 2.50a errmsg err msg<BR>
KBCategory: kbprg kberrmsg kbprb<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
