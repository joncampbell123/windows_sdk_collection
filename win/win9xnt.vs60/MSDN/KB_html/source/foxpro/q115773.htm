

<HTML>
<HEAD>
<TITLE>PRB: Printer Orientation &amp; Settings Ignored by FoxPro for Mac </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115773">
<META NAME="KBModify" CONTENT="1996/05/21">
<META NAME="KBCreate" CONTENT="1994/06/02">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a report is created in FoxPro version 2.5, 2.5a, 2.5b, or 2.6 for Windows and is then executed in FoxPro version 2.5b for Macintosh, FoxPro for Macintosh ignores the page orientation and other page layout settings. For example, if a report wit...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO9,QABA,QDIR,QBAO,QDL9,QBWO,QBWN,QAOX,QBP6,QBXS,QBWQ,QBVV,QBXR,QBWS,QACT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Printer Orientation &amp; Settings Ignored by FoxPro for Mac</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 21, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115773</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a report is created in FoxPro version 2.5, 2.5a, 2.5b, or 2.6 for
Windows and is then executed in FoxPro version 2.5b for Macintosh, FoxPro
for Macintosh ignores the page orientation and other page layout settings.
For example, if a report with landscape page orientation is created in
FoxPro for Windows and then executed in FoxPro for Macintosh, the landscape
setting will be ignored, and the report will be printed with portrait
orientation.
<P>
<P><h2>CAUSE</h2>
 
<P>
The information used by the Macintosh operating system to describe the
printer settings is an undocumented binary structure called a Tprint
structure. Since the structure of this data is not documented by Apple and
is subject to change at any time in the future, the Transporter program
cannot create a new Macintosh Tprint structure from the data that is used
to describe printer settings on a machine running the Microsoft Windows
operating system.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
According to article <B><A href="../foxpro/q107824.htm">Q107824</A></B> in the Microsoft Knowledge Base, you can
select the desired page orientation by opening the report and then choosing
Page Layout from the Report menu. This is the recommended resolution to the
problem.
<P>
However, because implementation of this suggestion requires the user to
manually open and edit the report, this approach may not be desirable in
all cases. For example, the Transporter may change the appearance of the
report or you may need to port a large number of reports from FoxPro for
Windows to FoxPro for Macintosh.
<P>
In cases where it is not practical or desirable to follow the instructions
provided in article <B><A href="../foxpro/q107824.htm">Q107824</A></B>, you can use the following approach to cause
the report to recognize the desired printer settings.
<P>
IMPORTANT: This approach is provided as a convenience for customers and is
not supported by Microsoft. Please make a backup copy of your report files
before modifying them on the Macintosh.
<P>
The resolution presented in this article is not compatible with System 7.0
of the Macintosh operating system. To implement the resolution presented
below, you must have System 7.1 or later of the Macintosh operating system.
Note also that the approach illustrated by this article may not solve all
printing problems.
<P>
The structure of Tprint may be affected by the currently executing version
of the Macintosh operating system, the hardware on which FoxPro is
currently executing, or other factors. For this reason, you must create a
Tprint structure on the machine where the report will be executed. If you
follow this procedure, you should not modify a report on one machine, and
then run that report on another machine. This procedure should be followed
on the computer where this report will be executed.
<P>
The printer settings information for a report created in FoxPro for Windows
is stored in the TAG and TAG2 fields of the first record of the .FRX file.
The printer settings information for a report created in FoxPro for
Macintosh is stored in the ORDER field of the first record of the .FRX
file. The following instructions explain how to create a report in FoxPro
for Macintosh that contains the desired print settings and then add the
Tprint structure (which describes the desired print settings) to a report
that was created in FoxPro for Windows. These instructions assume that the
filename of the report created in FoxPro for Windows is WINRPT and the
filename of the report created in FoxPro for Macintosh is MACRPT.

<OL><P><LI>Copy the report created in FoxPro for Windows to the Macintosh. The
   report should be placed in the default FoxPro for Macintosh
   subdirectory. If the report is placed in another directory, you must use
   the SET DEFAULT command to set the default directory to the directory
   containing the report or use an appropriate path to reference the report
   files.

<P><LI>Load FoxPro for Macintosh.

<P><LI>Create a simple database. For example, type the following in the Command
   window:
<P>
<P><PRE>      CREATE TABLE small (fld C(2))
</PRE>
<P><LI>Create a report by typing the following command in the Command window:
<P>
<P><PRE>      CREATE REPORT macrpt
</PRE>
<P><LI>Create a quick report by choosing Quick Report from the Report menu.

<P><LI>Set the desired printer settings by choosing Page Layout from the Report
   menu. Choose the Page Settings button, make the desired selections, and
   then choose OK twice to close the dialog boxes.

<P><LI>Save the report by choosing Save from the File menu. Do NOT save the
   environment information.

<P><LI>Press the ESC key to close the Report Writer.

<P><LI>Modify the report created in FoxPro for Windows by placing the following
   code in a .PRG file and then executing it:
<P>
<P><PRE>      CLOSE ALL
      USE winrpt.frx IN 1
      USE macrpt.frx IN 2
      SELECT macrpt
      GOTO 1
      SELECT winrpt
      GOTO 1
<PRE></PRE>      REPLACE tag   WITH ""
      REPLACE tag2  WITH ""
      REPLACE order WITH macrpt.order
      CLOSE ALL

</PRE></OL>The .FRX file for the report created in FoxPro for Windows has now been
modified. The printer settings information specific to the Microsoft
Windows operating system has been removed and the printer settings
information specific to the Macintosh operating system has been added.
<P>
If the report is executed, it should now reflect the printer settings
established in MACRPT.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac 2.50b respect<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 21, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
