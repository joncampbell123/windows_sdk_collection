

<HTML>
<HEAD>
<TITLE>Using Printer Drivers in Coded Output </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88579 ">
<META NAME="KBModify" CONTENT="1995/12/18">
<META NAME="KBCreate" CONTENT="1992/08/27">
<META NAME="Keywords" CONTENT="kbprint kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To use a printer driver in a FoxPro application, additional code is required. The text below provides examples of the necessary code.  MORE INFORMATION  NOTE: The following code may need to be modified to work with your specific printer.  PostScrip...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QADF,QAOX,QAH4,QACT,QAU9,QAVX,QAVW,QAN8,QBHQ,QBE7,QBE6,QAB9,QABG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Printer Drivers in Coded Output</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88579 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6x
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To use a printer driver in a FoxPro application, additional code is
required. The text below provides examples of the necessary code.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: The following code may need to be modified to work with your specific
printer.
<P>
<P><h3>PostScript Driver</h3>
 
<P>
The PostScript printer driver is unique because it is the only driver that
parses the data it receives and adjusts the output for any special
characters it receives. For example, when a left parenthesis ("(") is
printed with the PostScript driver, the driver adds a backslash character
(\) to the data stream. For this reason, a printer driver must not be
affected when the PDDOCST and PDDOCEND procedures make these changes. The
value returned from these procedures is sent to the PDOBJECT procedure and
evaluated.
<P>
The following code fragment demonstrates how to use a PostScript printer
driver in an application:
<P>
<PRE>   SET TALK OFF
   *
   * Set PDSETUP to any valid PostScript printer driver listed in the
   * FOXUSER database.
   SET PDSETUP TO "PALATINO 10"
   SET LIBRARY TO GOODIES\PDRIVERS\PSAPI.PLB
   *
   * To print to a network printer, change the following command.
   SET PRINTER TO TEST.TXT
   SET PRINT ON
   *
   * Save the printer driver setup and remove the printer driver.
   * Doing so prevents the PostScript printer driver from interpreting
   * the information in the page header. Afterwards, set the printer
   * driver back to its initial setting.
   *
   X=SET("PDSETUP")
   SET PDSETUP TO
   ?PDDOCST(_PLENGTH,128)
   SET PDSETUP TO (X)

   ? "This is a test"

   *
   * Return the printer driver to its initial setting.
   *
   X=SET("PDSETUP")
   SET PDSETUP TO
   ?PDDOCEND()

   SET PRINT OFF
   SET PRINTER TO
   SET LIBRARY TO

</PRE><h3>Non-PostScript Printer</h3>
 
<P>
The following code fragment demonstrates how to use the Hewlett-Packard
Printer Control Language (HP-PCL) printer driver in an application:
<P>
<PRE>   SET TALK OFF
   SET PDSETUP TO "HP"
   SET LIBRARY TO GOODIES\PDRIVERS\DRIVER2.PLB
   *
   * To print to a network printer, change the following command.
   SET PRINTER TO TEST.TXT
   SET PRINT ON
   PRINTJOB

   ? PDDOCST(_PLENGTH,128)
   ? "This is a test"
   ? PDDOCEND()

   ENDPRINTJOB
   SET PRINT OFF
   SET PRINTER TO
   SET LIBRARY TO
   SET PDSETUP TO "HP"

</PRE><h3>.PRG in GENPD.APP</h3>
 
<P>
NOTE: The following code may need to be modified to work with your specific
printer.
<P>
When you are using _pdriver="driver.prg" in GENPD.APP, use the following
code:
<P>
<PRE>   SET TALK OFF
   SET PDSETUP TO "HP"
   SET PROCEDURE TO GOODIES\PDRIVERS\DRIVER.PRG

</PRE>NOTE: Instead of using SET LIBRARY TO, you use SET PROCEDURE TO.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 2.50a 2.50b 2.60 2.60a report<BR>
KBCategory: kbprint kbprg<BR>
KBSubcategory: FxprintDriver<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
