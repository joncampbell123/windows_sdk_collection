

<HTML>
<HEAD>
<TITLE>BUG: Appending to a Table on a Network Hangs the Power Mac </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153154">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1996/07/01">
<META NAME="Keywords" CONTENT="kbprg kb3rdparty kbnetwork kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using FoxPro for Macintosh 2.6 on a Power Macintosh computer with the operating system 7.5.3 software, the computer will hang after appending or editing records to a table located on the network server. This problem occurs on computers that ha...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO9,QAH4,QA28,QATJ,QDJO,QAKP,QAJG,QBB2,QAVX,QAVW,QAJ6,QDJD,QDIR,QBFY,QBWA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Appending to a Table on a Network Hangs the Power Mac</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153154</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using FoxPro for Macintosh 2.6 on a Power Macintosh computer with the
operating system 7.5.3 software, the computer will hang after appending or
editing records to a table located on the network server. This problem
occurs on computers that have a Peripheral Component Interconnect (PCI)
board as part of their hardware. Apple is shipping these PCI boards as part
of their standard equipment on most Power Macintosh computers.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To solve the problem of appending and editing tables on the server, try one
of the following:

<UL><LI>Turn the Modern Memory Manager off;
<P>
   -or-

<LI>Use a third-party product called Speed Doubler;
<P>
   -or-

<LI>Load the 68K version of FoxPro to work around this problem;
<P>
   -or-

</UL><OL><P><LI>Use Visual FoxPro Macintosh 3.0.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem does not occur on Power Macintosh computers with operating
systems before 7.5.3. Turning off the Modern Memory Manager(MMM) will work
sometimes and the computer will not hang when appending a record from a
table on the server. If a software program called Speed Doubler is
installed, the problem goes away. Speed Doubler installs its own 68K
emulator, replacing the one that comes with system 7.5.3. The 68K emulator
that comes with 7.5.3 seems to be the controlling problem. Below is a
sample program that causes a Power Macintosh with a PCI board to hang.
<P>
When running the code below in the Trace window, place the table out on a
server when prompted, and note that the computer hangs after issuing the
second UNLOCK command. If the LOCK and UNLOCK commands are not used, the
system hangs after three or more passes through the FOR loop.
<P>
<P><h3>Sample Code</h3>
 
<P>
************* Beginning of Code.
<PRE>   CLOSE DATABASES
   SET SAFETY OFF

   x = PUTFILE( "Where?", "test.dbf")
   IF !EMPTY( x )
     SELECT 0
     CREATE TABLE (x) ;
        ( CUST      C( 8 ), SUBNO     C( 4 ), ;
        NKEY      C( 35 ), NAME    C( 25 ), ;
        PHONEKEY  C( 23 ))

     INDEX ON UPPER( nkey ) TAG nkey ADDITIVE
     INDEX ON cust+subno TAG cust ADDITIVE
     INDEX ON phonekey TAG phonekey ADDITIVE
     INDEX ON name TAG name ADDITIVE

     USE (x) SHARED

     FOR i = 1 TO 10
        APPEND BLANK
        =RLOCK()
        REPLACE Test.phonekey WITH REPLICATE( ALLTRIM( STR( i ) ), 10 )
        REPLACE Test.name WITH REPLICATE( CHR( 64 + i ), 10 )
        UNLOCK
     ENDFOR
   ENDIF

   ************* End of Code.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.60a FoxMac INSERT INTO FROM MEMVAR<BR>
KBCategory: kbprg kb3rdparty kbnetwork kbbuglist<BR>
KBSubcategory: FxprgGeneral
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
