

<HTML>
<HEAD>
<TITLE>PRB: Application Wizard EXE or APP Gives Path or File Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168058">
<META NAME="KBModify" CONTENT="1997/05/06">
<META NAME="KBCreate" CONTENT="1997/05/05">
<META NAME="Keywords" CONTENT="FxtoolWizother kbtool VFoxWin kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If an EXE or APP built from a project created by the Application Wizard is run from a directory on a drive that does not contain the home directory of the application project and source files, one or more of the following errors will occur:      In...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJH,QAH4,QAFI,QAIK,QBXB,QBVV,QAY2,QATJ,QAUJ,QAML,QAMA,QAAP,QAB4,QBWS,QAJN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Application Wizard EXE or APP Gives Path or File Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168058</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If an EXE or APP built from a project created by the Application Wizard is
run from a directory on a drive that does not contain the home directory of
the application project and source files, one or more of the following
errors will occur:
<P>
<PRE>   "Invalid path or file name"

  -or-

   "File "&lt;path to app or exe&gt;\&lt;appname&gt;.mpr" not found"

</PRE><h2>CAUSE</h2>
 
<P>
The application home directory is hard-coded into the project's main
program, and the wzApplication.DoMenu method contains a check for the
existence of the .MPR file, while the EXE or APP only contains the compiled
MPX code.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Invalid Path or File name</h3>
 

<OL><P><LI>To alleviate the "Invalid path or file name" error, open the main
   program in the project created by the Application Wizard. The main
   program will have the same name as the project name and is located in
   the "&lt;application directory name&gt;\Progs" directory. It will also appear
   in bold in the Project Manager's Code tab under the Programs heading.
   Replace the line:
<P>
<P><PRE>      CD "&lt;path\directory containing app&gt;"
</PRE><P>
  with the following:
<P>
<P><PRE>      * Are we running from a PRG (FXP)? If so, strip off all after the
      * last 2 "\" characters else strip all after the last "\" character
</PRE><P>
<P><PRE>      CD (SUBSTR(SYS(16,0),1,RAT('\',SYS(16,0), ;
<PRE></PRE>        IIF(".FXP"$SYS(16,0),2,1))-1))

</PRE><P><LI>In the WZApplication.DoMenu method located in the class library
   \VFP\wizards\appwiz.vcx, the following code is used to verify the
   existence and then call menus used within the application:
<P>
<P><PRE>      LPARAMETERS tcFileName
      LOCAL lcFileName
</PRE>   
<P><PRE>      lcFileName=ALLTRIM(tcFileName)
      IF EMPTY(lcFileName)
<PRE></PRE>         RETURN .F.
      ENDIF
      lcFileName=LOWER(FULLPATH(lcFileName))
      IF NOT "."$lcFileName
         lcFileName=lcFileName+".mpr"
      ENDIF
      IF NOT FILE(lcFileName)
         this.FileNotFoundMsgBox(lcFileName)
         RETURN .F.
      ENDIF
      DO (lcFileName)

</PRE></OL><h3>File &lt;path and mpr name&gt; Not Found</h3>
 
<P>
To alleviate the "File &lt;path and mpr name&gt; not found" error, change the
line:
<P>
<PRE>   lcFileName=lcFileName+".mpr"

</PRE>to:
<P>
<PRE>   * Since the lowest level program is an FXP, we are not in an APP or EXE,
   * so it is OK to look for MPR since we know source code is available.
   * Otherwise look for MPX contained in APP or EXE

   lcFileName = lcFileName+ iif(".FXP"$sys(16,0),".mpr", ".mpx")

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Type the following commands in the Command Window within Visual FoxPro:
<P>
<P><PRE>     MD c:\awtest
     CD c:\awtest
</PRE>
<P><LI>Run the Application Wizard by selecting Tools/Wizards from the Visual
   FoxPro system menu. Select All from the submenu, then Application Wizard
   from the list and select OK.

<P><LI>In step 1, Call the application "awtest" and select Complete
   Application.

<P><LI>Select Finish.

<P><LI>Build this project into an EXE file.

<P><LI>Copy the EXE to a different directory than the one it was built in.

<P><LI>Run the EXE.
<P>
</OL>The steps in the RESOLUTION section above describe how to fix the main
program in an application that has already been created. By the object-
oriented nature of Visual FoxPro, the change in the DoMenu method will
automatically be applied to future applications created with the
Application Wizard. In order to fix the main program template so that
future applications built with the Application Wizard will correctly
resolve the default path, you must modify the template located in the
Appwiz.dbf table. This can be done by completing the following steps:

<OL><P><LI>From the Command Window:
<P>
<P><PRE>      USE HOME()+'wizards\appwiz.dbf'
      BROWSE FOR type = 'STARTUP PROGRAM'
      MODIFY MEMO DATA1
</PRE>
<P><LI>Locate the following line in the memo edit window:
<P>
<P><PRE>      *&lt;CD&gt;*
</PRE>
<P><LI>Delete the above line, and replace it with:
<P>
<P><PRE>      CD (SUBSTR(SYS(16,0),1,RAT('\',SYS(16,0), ;
<PRE></PRE>        IIF(".FXP"$SYS(16,0),2,1))-1))

</PRE><P><LI>Close the edit window, then type USE in the Command Window to close
   the Appwiz table and save the changes.

<P><LI>Future applications created with the Application Wizard will contain
   both the changes in the main program and the DoMenu method, and neither
   of the errors described in the SYMPTOMS section above will occur.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxtoolWizother kbtool VFoxWin kbprb<BR>
Version             : 5.0 5.0a<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
