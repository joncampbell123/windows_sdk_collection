

<HTML>
<HEAD>
<TITLE>FIX: Control Class in Control Not Shown in Control Array </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142194">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1996/01/07">
<META NAME="Keywords" CONTENT="kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When one control class is added to another control class, the AMEMBERS() function and the Controls array do not see the control class that was added. This occurs whether the classes are created programmatically or visually.  STATUS ======  Microsof...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QAB5,QAOE,QAMN,QABO,QAW6,QAH4,QAB9,QBV8,QBVV,QAY5,QAR4,QBXF,QADZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Control Class in Control Not Shown in Control Array</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142194</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When one control class is added to another control class, the AMEMBERS()
function and the Controls array do not see the control class that was
added. This occurs whether the classes are created programmatically or
visually.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code creates two control classes: Ctl and Subcontrol. The
program adds the Subcontrol class to the Ctl class. The ADD OBJECT method
also adds two command buttons and a two-page pageframe to the Ctl class.
Therefore, Ctl class contains the Subcontrol class, two command buttons,
and a pageframe.
<P>
The object positions referenced in the class definitions only apply if the
class is created visually.
<P>
The code example uses the AMEMBERS() function to place properties,
procedures, and member objects into a memory variable array named atest.
Because the Printmembers function is part of the Ctl class, it should have
access to all the objects within that class. However, the AMEMBERS()
functions lists all the objects in class except the subclass object. The
AMEMBERS() function should have to access to all the members of its own
class.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a program called Test.prg, and add the following code:
<P>
   ** Ctl Class Definition
   DEFINE CLASS ctl AS control
<P>
<P><PRE>      ADD OBJECT command1 AS commandbutton WITH ;
<PRE></PRE>         Top = 31
         Left = 23

      ADD OBJECT command2 AS commandbutton WITH ;
         Top = 81
         Left = 21

      ADD OBJECT pageframe1 AS pageframe WITH ;
         ErasePage = .T.
         PageCount = 2
         Top = 115
         Left = 37

      ADD OBJECT subcontrol1 AS subcontrol WITH ;
         Top = 6
         Left = 146

      PROCEDURE printmembers

         ACTIVATE SCREEN
         x=This.name
         ? AMEMBERS(atest,This,2)
         DISPLAY MEMORY LIKE atest

         FOR ii = 1 TO This.ControlCount
           ? This.controls[ii].Name
         ENDFOR

         ? This.SubControl1.Name
      ENDPROC

   ENDDEFINE

   *-- EndDefine: ctl

   ** Subcontrol Class Definition

   DEFINE CLASS subcontrol AS control
   ENDDEFINE

</PRE><P><LI>In the Command window, type each of the following commands on a separate
   line:
<P>
   SET LIBRARY TO TEST.PRG
   X=CREATEOBJECT('Ctl')
   X.Printmembers
<P>
</OL>The array atest contains elements representing the command buttons and the
pageframe objects that appear listed on the desktop. However, the
Subcontrol class object is not listed. The AMEMBERS() functions does not
find the Subcontrol object because it was added as a control. This causes
the error message "Property Controls is not found." If the "Ignore" button
is pressed, an "Unknown member SUBCONTOL1" message is displayed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: FxprgGeneral VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
