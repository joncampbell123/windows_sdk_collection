

<HTML>
<HEAD>
<TITLE>BUG: Can't Enter Period in a Text Box with Scientific Notation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138607">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1995/10/24">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxprgGeneral vfoxwin vfpbug5.0a kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a text box that has a Scientific Notation format and a picture clause of Numeric (for example: 99999.999), when you press the Period key on the keyboard to enter a period in the text box, the focus moves immediately to another object.  CAUSE ===...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QBT6,QBB2,QAHP,QAPN,QAEF,QAH4,QAUD,QALY,QAMB,QACI,QA9N,QANJ,QA5V,QAYV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Can't Enter Period in a Text Box with Scientific Notation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138607</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a text box that has a Scientific Notation format and a picture clause of
Numeric (for example: 99999.999), when you press the Period key on the
keyboard to enter a period in the text box, the focus moves immediately to
another object.
<P>
<P><h2>CAUSE</h2>
 
<P>
There is a format conflict between the scientific notation format and the
numeric picture clause.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Either remove the numeric picture clause, and write code to validate the
data, or remove the scientific notation format.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Numbers displayed in scientific notation are treated as text. If you place
a picture clause on the text box that displays numbers in scientific
notation, a conflict between the two formats is created. You may enter
numeric data but as soon as you enter a period, focus is removed from the
text box.
<P>
Steps to Reproduce Problem
 
<P>
Run the following program. It will demonstrate the behavior.
<P>
*-- Create an array from which to load records in a table.
LOCAL ARRAY aBunchONums[3,1]
*-- Create a table
CREATE TABLE testtube FREE (number n(14,4))
*-- Load three records in the table with random numbers.
=RAND(-1)
FOR i = 1 to 3
<PRE>     aBunchONums[i] = RAND()*SECONDS()*VAL(sys(11, date()))/100
</PRE>ENDFOR
APPEND FROM ARRAY aBunchONums
GO TOP
*-- Instantiate a form based on custom form class, TestForm.
frmMyForm = CREATEOBJECT("TestForm")
*-- Add a textbox to the form with format and picture clause.
<PRE>     frmMyForm.addobject("txbFooBox", "TEXTBOX")
          WITH frmMyForm.txbFooBox
               .ControlSource = "testtube.number"
               .Format        = "KZ^"
               .InputMask     = "999999999.9999"
               .Top           = 10
               .Left          = 10
               .Visible       = .T.
               .Width         = 120
          ENDWITH
</PRE>*-- Display the form.
frmMyForm.show
<P>
READ EVENTS
<P>
*-- Define a custom class based on the FORM baseclass.
DEFINE CLASS TestForm AS FORM
<PRE>     CAPTION     = "Period Test"
     AUTOCENTER  = .T.
     HEIGHT      = 120
     WIDTH       = 140
</PRE>*-- Add command button to move between records.
<PRE>     ADD OBJECT cmdNext AS COMMANDBUTTON ;
          WITH ;
          TOP            = 50, ;
          LEFT           = 20, ;
          HEIGHT         = 24, ;
          CAPTION        = "Next"
</PRE>*-- Add command button to exit the program (form).
<PRE>     ADD OBJECT cmdQuit AS COMMANDBUTTON ;
          WITH ;
          TOP            = 80, ;
          LEFT           = 20, ;
          HEIGHT         = 24, ;
          CAPTION        = "Quit"
</PRE>*-- Add custom code to the Click event of cmdNext.
<PRE>     PROCEDURE cmdNext.click
          SKIP
          IF EOF()
               GO TOP
          ENDIF
          THISFORM.REFRESH
     ENDPROC
</PRE>*-- Add custom code to the Click event of cmdQuit.
<PRE>     PROCEDURE cmdQuit.click
          THISFORM.Release
          CLEAR EVENTS
     ENDPROC

</PRE>ENDDEFINE
*-- End custom class definition.
*-- End program.
<P>
When you run this program, press the TAB key to move to the text box and
enter numbers. If you attempt to enter a period in the text box at any
time, the focus is moved immediately to another object on the form.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprgGeneral vfoxwinbuglist3.00 buglist3.00b buglist5.00<BR>
Additional reference words: 5.00 3.00 3.00b scientific textbox<BR>
Keywords          : buglist3.00 buglist3.00b buglist5.00 FxprgGeneral vfoxwin vfpbug5.0a kbprg kbbuglist<BR>
Version           : 3.0 3.0b 5.0 5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
