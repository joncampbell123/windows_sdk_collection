

<HTML>
<HEAD>
<TITLE>PRB: Return Parameter Variable Name for SQL Server Causes Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177056">
<META NAME="KBModify" CONTENT="1997/11/21">
<META NAME="KBCreate" CONTENT="1997/11/20">
<META NAME="Keywords" CONTENT="FxinteropOdbc vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you call a Microsoft SQL Server Stored Procedure through ODBC and supply a variable for the return or OUTPUT parameter, a single character variable name causes an error.  RESOLUTION  Use a variable name with more than one character.  In the ex...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAYL,QAB4,QAUD,QAGI,QAAP,QAUJ,QDIZ,QA9E,QAU9,QAA1,QDI2,QAIJ,QAH4,QAHE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Return Parameter Variable Name for SQL Server Causes Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177056</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you call a Microsoft SQL Server Stored Procedure through ODBC and
supply a variable for the return or OUTPUT parameter, a single character
variable name causes an error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use a variable name with more than one character.
<P>
In the example below, change the Callsp.prg variable name Z to more than
one character, for example, Z1.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With SQL ODBC driver version 3.50.0300, the following error message is
generated:
<P>
<PRE>   [Microsoft][ODBC SQL Server Driver]Invalid character value for cast
   specification.

</PRE>With SQL ODBC driver version 2.65.0240, the following error message is
generated:
<P>
<PRE>   [Microsoft][ODBC SQL Server Driver]Error in assignment.

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Copy the following code into a file called Setup.prg:
<P>
<P><PRE>      ********Start of Setup.prg***********
      MyConnStr="'driver=sql server;server=myserver;uid=sa;pwd=mypass; "+ ;
<PRE></PRE>         "database=Pubs'"
      *String to create the SQL Server Stored Procedure in Pubs
      SP_String="Create Proc KBtemp @Param1 char(20)OUTPUT " + ;
          "as Select @Param1='Return Success'"
      CREATE DATABASE SP_Test
      CREATE CONNECTION SP_Test CONNSTRING &amp;MyConnStr
      MyConn=SQLCONNECT('SP_Test')
      IF MyConn &gt; 0 then
          rSucc1=SQLEXEC(MyConn, SP_String)
          IF rSucc1 == -1 then
              MESSAGEBOX("Creating Stored Procedure Failed")
              AERROR(MyError)
              ?"Create Stored Proc Error: "
              DISPLAY MEMORY LIKE MyError
          ENDIF
          SQLDISCONNECT(MyConn)
      ELSE
          MESSAGEBOX("SQL Connection Failed")
      ENDIF
      *******End of Setup.prg*************

</PRE></OL>NOTE: Replace the server, uid and pwd in the MyConnStr with the appropriate
servername, user id, and password on your system.

<OL><P><LI>Copy the following code to a file called Callsp.prg.
<P>
<P><PRE>      *******Start of CallSP.prg************
      *Variable for the return parameter
      Z=SPACE(25)
      SP_Call="{Call KBTemp (?@Z)}"
      MyConn=SQLCONNECT('SP_Test')
      IF MyConn &gt; 0 then
<PRE></PRE>          rSucc1=SQLEXEC(MyConn,SP_Call)
          IF rSucc1&lt;&gt;-1 then
              MESSAGEBOX(Z1)
          ELSE
              MESSAGEBOX("Calling Stored Procedure Failed")
              AERROR(MyError)
              ?"Calling Stored Proc Error: "
              DISPLAY MEMORY LIKE MyError
          ENDIF
          SQLDISCONNECT(MyConn)
      ELSE
          MESSAGEBOX("SQL Connection Failed")
      ENDIF
      ******End of CallSP.prg*************

</PRE><P><LI>Run Setup.prg.

<P><LI>Run Callsp.prg.
<P>
</OL>NOTE: Check the name of the stored procedure, KBTemp, with your Database
Administrator to ensure it is correct to use.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: variable SQl odbc<BR>
Keywords          : FxinteropOdbc vfoxwin<BR>
Version           : WINDOWS:5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
