

<HTML>
<HEAD>
<TITLE>How to Modify GENSCRN.PRG to Refresh Text Field Labels </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119302">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/08/11">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  NOTE: Microsoft does not provide technical support for FoxPro tools such as GENSCRN.PRG after they have been modified from their original form.  In some cases, the text labels and refreshable SAY fields in the Screen Builder may need to be redispla...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAMB,QAXB,QAPN,QA5V,QACI,QBXT,QAIB,QATX,QA7O,QA7N,QAC2,QA9N,QAB9,QAYZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Modify GENSCRN.PRG to Refresh Text Field Labels</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119302</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
NOTE: Microsoft does not provide technical support for FoxPro tools such as
GENSCRN.PRG after they have been modified from their original form.
<P>
In some cases, the text labels and refreshable SAY fields in the Screen
Builder may need to be redisplayed, such as on a screen that was previously
CLEARed. Text objects created in the Screen Builder are generated as SAY
objects in the .SPR code. In order to refresh these field label SAYs as
well as the output SAY fields, the @ ... SAY commands must be placed in the
SHOW clause of the generated code. The example below shows how to modify
GENSCRN to accept a custom generator directive which will force all text
labels along with refreshed SAY field objects to be redisplayed.
<P>
NOTE: At least one SAY field must have the Refresh check box option marked
in the Output Field dialog box of the Screen Builder so that its contents
will reappear, as well as to trigger generation of the SHOW clause code.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Copy the current GENSCRN.PRG file to another file. For example, type
    the following command at the MS-DOS command prompt in the main FoxPro
    directory:
<P>
       COPY GENSCRN.PRG SCRENGEN.PRG

<P><LI>The newly created file should replace GENSCRN so that future updates
    will not overwrite changes, as well as to preserve a copy of the
    original file. In order for FoxPro to always use SCRENGEN instead of
    the original GENSCRN program, the _GENSCRN system variable must be
    changed to point to the custom program. If the CONFIG.FPW or CONFIG.FP
    file does not already exist, create it as an ASCII text file and type
    the following command in the file:
<P>
<PRE>        _GENSCRN="C:\&lt;FoxPro_directory&gt;\SCRENGEN.FXP"

</PRE><P><LI>Start FoxPro, and then issue the following command in the Command
    window:
<P>
<PRE>        MODIFY COMMAND SCRENGEN

</PRE><P><LI>In the editing window, press CTRL+F, type the following text to look
    for, and then choose the Find button or press CTRL+W:
<P>
<PRE>        m.g_noreadp

</PRE><P><LI>Add a new line below the "m.g_noreadplain = .F." line, and enter the
    following statement:
<P>
<PRE>        m.g_saytext      = .F.    &amp;&amp; custom flag to refresh text SAYs

    NOTE: Although it is not critical to align the text with the
    statements above it, readability will be maintained in doing so.

</PRE><P><LI>Press CTRL+F, and find the following text:
<P>
       #READ"
<P>
    NOTE: Be sure to use a double quotation mark, not two single quotation
    marks.

<P><LI>When you find the text, press the HOME key, copy the line (including
    the carriage return) by pressing SHIFT+END, SHIFT+RIGHT ARROW, and
    then CTRL+C. Press the DOWN ARROW key 17 times, and place the cursor
    in the home position on the line containing "ENDCASE".

<P><LI>Press CTRL+V to paste in the new line, and change "READ" to "SAYT" and
    "READCLAUSES - Additional READ clauses" to "SAYTEXT - Custom
    directive".

<P><LI>Insert a new line below the pasted line, and type:
<P>
       REPLACE ALL showtype WITH 1, refresh WITH .T. FOR objtype = 5

<P><LI>Insert another line, and type:
<P>
       m.g_saytext=.T.
<P>
   The additions in context should now appear as follows:
<P>
       .
       .
       .
<PRE>            ENDIF
       CASE LEFT(m.upline,5)="#SAYT"    &amp;&amp; #SAYTEXT - Custom directive
            REPLACE ALL showtype WITH 1, refresh WITH .T. FOR objtype = 5
            m.g_saytext = .T.
       ENDCASE
       .
       .
       .

</PRE><P><LI>Press CTRL+F, and find the following text:
<P>
       REFRESH =
<P>
   NOTE: Make sure you include the space before the equal sign.

<P><LI>Press the HOME, UP ARROW, UP ARROW, CTRL+RIGHT ARROW, and CTRL+RIGHT
   ARROW keys to move the cursor to the first parenthesis in the "SCAN FOR
   ((objtype = c_otfield ..." line, and then insert an additional left
   parenthesis, so that the first part of the line now reads:
<P>
       SCAN FOR (((objtype = c_otfield ...

<P><LI>Press CTRL+G and then press END to move to the end of the line, and add
   another right parenthesis, a space, and a semicolon, so that the line
   now reads:
<P>
       ... g_screens[m.g_thisscreen,7])) ;

<P><LI>Add a new line below this line, and enter the following:
<P>
       OR (objtype = 5 AND m.g_saytext)

<P><LI>Press CTRL+W to close and save the program. Compile the new program  by
   choosing Compile from the Program menu, or by typing the following
   command in the Command window:
<P>
       COMPILE SCRENGEN.PRG
<P>
</OL>Now that the SCRENGEN.PRG program is in place, you can specify the option
to refresh text field label SAYs by placing the custom generator directive
#SAYTEXT in the Setup code of the appropriate screen. If the #SAYTEXT
directive is not used, the screen will be generated normally.
<P>
<P><h3>Functionality</h3>
 
<P>
The memory variable m.g_saytext is used to determine whether to generate
code to refresh all the SAYs found in the .SCX file. In order for SAYs to
be refreshed, the same code used in the screen layout section of the
generated code is repeated in the SHOW clause of the READ command.
Normally, only SAY screen fields (objcode 15) that have the Refresh check
box selected are generated in the SHOW clause during the PLACESAYS
procedure within the screen generator. By adding the OR clause to include
SAY objects (objcode 5) when m.g_saytext is .T., normal SAYs will also be
placed in the SHOW routine.
<P>
However, to meet the other requirements imposed by the generator code, two
values must be changed in the .SCX file so that the SAY objects will be
included. The Showtype and Refresh fields are changed within the
NOTEDIRECTIVES procedure whenever it detects that the #SAYTEXT directive is
found in the Setup code of the current screen. (Changing the .SCX database
for the SAYs will not affect their appearance within the Screen Builder
during modification.) Additionally, the m.g_saytext memory variable is set
to TRUE.
<P>
To further refine the scope of which normal SAY objects are included, this
section of the generator program could be modified to accept parameters
after the #SAYTEXT directive. For example, "#SAYTEXT 2,5,6-12" could
indicate to refresh only objects 2 and 5 along with the range of objects 6
through 12. This would be determined by only replacing the Showtype and
Refresh fields for these particular records, indicated by a further
condition of the REPLACE ... FOR clause. The actual code to perform this
restriction would vary, depending upon the chosen implementation of
parameter representations.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.50 2.50a 2.50b 2.60 blank empty<BR>
"missing<BR>
text"<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxtoolSbuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
