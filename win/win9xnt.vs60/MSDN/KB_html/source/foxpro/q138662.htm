

<HTML>
<HEAD>
<TITLE>How to Start FoxPro 2.6 Catalog Manager with Specific Catalog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138662">
<META NAME="KBModify" CONTENT="1995/10/29">
<META NAME="KBCreate" CONTENT="1995/10/24">
<META NAME="Keywords" CONTENT="kbother kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The FoxPro resource file can be modified to cause the FoxPro 2.6 Catalog Manager to start with a specific catalog. By design, the FoxPro 2.6 Catalog Manager starts with the catalog that was active when the Catalog Manager was last closed.  Upon sta...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QAUJ,QAIM,QA7O,QA7N,QAIJ,QDIV,QA5V,QAGU,QAH5,QBXS,QBJZ,QBWS,QAYB,QARM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Start FoxPro 2.6 Catalog Manager with Specific Catalog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138662</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
<LI>Microsoft FoxPro for Macintosh, version 2.6a
<LI>Microsoft FoxPro for MS-DOS, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The FoxPro resource file can be modified to cause the FoxPro 2.6 Catalog
Manager to start with a specific catalog. By design, the FoxPro 2.6 Catalog
Manager starts with the catalog that was active when the Catalog Manager
was last closed.
<P>
Upon startup, the FoxPro 2.6 Catalog Manager gets the last-used catalog
name from the Foxuser resource file. The record is identified by the fields
Id = "CATALOG" and Name = "Catalog Name." The Data field holds the path and
name of the most recently used catalog. The Data field can be modified
either directly or programatically. This article describes both ways.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Directly Changing the Default Catalog</h3>
 
<P>
Edit the Foxuser.dbf file putting the path and name of the catalog in the
data field. Then change the Readonly field's value to true (.T.). This can
be done as follows:

<OL><P><LI>If you are running the catalog manager, on the File menu, click Command
   window to return to the Command window.

<P><LI>In the Command window, type the following commands:
<P>
   SET RESOURCE OFF
   USE SYS(2005)
   BROWSE FOR Id="CATALOG"

<P><LI>Press the TAB key to move to the data field for the record where the
   Name field contains Catalog Name. To edit the memo, double-click Memo
   or press CTRL+PGDN.

<P><LI>Type in the path and name of the desired catalog, including the
   .fpc extension. Press CTRL+W to save changes to the memo.

<P><LI>In the field named readonly, change the value to true (.T.). This will
   keep FoxPro from changing this information in future sessions.

<P><LI>Press CTRL+W to save changes to the Foxuser.dbf file.

<P><LI>Tell FoxPro to again use the resource file, by issuing the following
   commands in the command window:
<P>
   USE
   SET RESOURCE ON
<P>
</OL>To confirm the results, on the File menu, click Catalog Manager, or quit
and restart FoxPro.
<P>
<P><h3>Programatically Setting the Default Catalog</h3>
 
<P>
Setting the default catalog programatically could allow more flexibility.
This can be done by calling a program from the Config.fp(w/m) file to reset
the catalog specified in the Data field. This program will replace the
catalog name in the Data field with the catalog specified in the called
program. The following example uses a catalog file called Mycat.fpc located
in the C:\Fpw directory.

<OL><P><LI>Create the following program:
<P>
   *** defltcat.prg
<P>
<PRE>   SET RESOURCE OFF               &amp;&amp; Turn off resource file
   USE SYS(2005)                  &amp;&amp; Open the resource file
   LOCATE FOR id="CATALOG" AND ;
      name= "Catalog Name"        &amp;&amp; Find the catalog record
   REPLACE data WITH "c:\fpw26\mycat.fpc"   &amp;&amp; Store catalog's path &amp; name
   USE                                      &amp;&amp; Close resource file
   SET RESOURCE ON                          &amp;&amp; Turn on resource file

   * End of defltcat.prg

</PRE><P><LI>Call the defltcat program on startup by adding the following line to the
   Config.fp(w/m) file:
<P>
   COMMAND = DO c:\fpw26\defltcat
<P>
   If the line "CATMAN=ON" is not in the file, add it.

<P><LI>Confirm the results by quitting FoxPro and restarting.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.60a FoxWin catman catalog manager<BR>
KBCategory: kbother kbhowto<BR>
KBSubcategory: FxotherGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
