

<HTML>
<HEAD>
<TITLE>How to Customize Icons &amp; Mouse Pointers in Forms Designer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130407">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/05/18">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A Visual FoxPro form contains several properties that make it easy to customize icons and mouse pointers displayed when a form is running.  MORE INFORMATION  NOTE: For backward compatibility, Visual FoxPro still supports FOXTOOLS.FLL (included in e...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QAPN,QA7O,QAB5,QAOE,QAMN,QA9N,QA56,QA55,QBXS,QBV4,QAB2,QAYS,QAGI,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Customize Icons &amp; Mouse Pointers in Forms Designer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130407</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A Visual FoxPro form contains several properties that make it easy to
customize icons and mouse pointers displayed when a form is running.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: For backward compatibility, Visual FoxPro still supports FOXTOOLS.FLL
(included in earlier FoxPro versions), the Visual FoxPro API library that
allows calls to 16-bit .DLL functions. However, in Visual FoxPro, the
DECLARE command is the preferred method for calling .DLL functions.
<P>
For more information about using the DECLARE command, search the online
Help.
<P>
<P><h3>Mouse Pointers</h3>
 
<P>
There are two properties (DragIcon and MousePointer) that control mouse
pointers:
<P>
<PRE>   Property         Value
   ---------------------------------------------------------------------
   DragIcon         &lt;cFilename&gt; - the name of any .CUR file created with
                    a cursor editing program such as IMAGEDIT

   MousePointer     0 - Default
                    1 - Arrow
                    2 - Cross
                    3 - I-Beam
                    4 - Icon
                    5 - Size
                    6 - Size NE SW
                    7 - Size NS
                    8 - Size NW SE
                    9 - Size WE
                   10 - Up Arrow
                   11 - Hourglass
                   12 - No Drop

</PRE>The DragIcon property controls the shape of the mouse pointer while an
object is being dragged to a new location. The MousePointer property
controls the shape of an object while the mouse is located over that
object. These two properties may be set in tandem to achieve a desired
effect.
<P>
For example, in an object that may be dragged, set the following properties
through the Forms Designer Properties Sheet:

<OL><P><LI>Set the DragIcon property to:
<P>
   \VFP\SAMPLES\GRAPHICS\DRAGMOVE

<P><LI>Place the following code in the Drag event to have all controls,
   except EditBoxes, display a No Drop pointer:
<P>
   ThisForm.setall("MousePointer",12)
   ThisForm.setall("MousePointer", 0, "EditBox")

<P><LI>Place the following code in the DragDrop event to reset the mouse
   pointer for all controls back to the default:
<P>
   Thisform.Setall("MousePointer",0)
<P>
</OL>This example allows the mouse pointer to remain at the default until a drag
and drop operation is performed. Once the drag starts, the mouse pointer
for every control on the form is set to a "No Drop" icon. Then all the edit
boxes are set back to the default icon for edit boxes.
<P>
After the object is dropped, all controls on the form are set back to the
default.
<P>
<P><h3>Icons</h3>
 
<P>
There are two properties (Icon and Picture) that control icons:
<P>
<PRE>   Property      Value
   ----------------------------------------------------------------------
   Icon          The name of any valid .ICO file

   Picture       The name of any valid .BMP or .ICO file, or the name of a
                 general field which contains a .BMP or .ICO.

</PRE></OL>The Icon property controls the icon displayed when a form is minimized. The
Picture property controls the icon displayed for the following controls
contained within a formset: check box, CommandButton, Form, Image,
OptionButton, and Page.
<P>
The Form.Picture property acts as a wallpaper behind all the controls
placed on a form. The Form.PageFrame.Page.Picture property creates a
wallpaper effect for a specific page within a pageframe.
<P>
<P><h3>Version 2.x Compatibility</h3>
 
<P>
The following compares the version 3.0 property functionality with the
functionality available in FoxPro version 2.x commands.
<P>
<PRE>Version 3.0 Property        Version 2.x Commands
</PRE> 
<PRE>DragIcon                    No drag and drop functionality was available

MousePointer                SET LIBRARY TO FOXTOOLS
                            Use REGFN and CALLFN to access the Windows
                            LoadCursor API call

Form.Picture                DEFINE WINDOW ... FILL &lt;bmp file name&gt;

Page.Picture                No page frame functionality was available

Check box.Picture           Specify the picture as part of an @ GET
CommandButton.Picture       command, or use the SHOW GET PROMPT command
OptionButton.Picture        to change the picture associated with an
                            existing control

Image.Picture               Specify the picture as part of an @ SAY
                            BITMAP command.

Form.Icon                   MODIFY WINDOW ... ICON &lt;icon file name&gt; or
                            specify the filename in the Window Style dialog
                            from the Screen, Screen Layout menu.

</PRE><h3>Advantages of Version 3.0 Functionality</h3>
 
<P>
Visual FoxPro offers the advantage of built-in mouse pointer functionality.
You can easily change the shape of the mouse pointer without using Windows
API calls or loading the FOXTOOLS.FLL file with its memory overhead.
<P>
In version 2.x, the developer had to be familar with a number of different
commands to control the image displayed. In Visual FoxPro, these
capabilities are consistently under the control of the picture property.
<P>
In some cases in version 2.x, bitmaps were not refreshed if the image was
changed in Paintbrush during an application session. An undocumented sys
function was used to reorganize memory and cause the bitmap to be reread
from disk. The image.picture property eliminates this problem in Visual
FoxPro version 3.0.
<P>
<P><h3>Sample Files</h3>
 
<P>
Visual FoxPro version 3.0 offers a large number of sample cursor (.CUR),
bitmap (.BMP), and icon (.ICO) files in \VFP\SAMPLES\GRAPHICS.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
