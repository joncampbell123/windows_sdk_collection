

<HTML>
<HEAD>
<TITLE>Limitations of the AINSTANCE Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129865">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbprg FxprgGeneral">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The AINSTANCE function places all instances of a class into a memory variable array. The function also returns the number of instances of a class. The function does not, however, report information about  member objects  added by the ADD OBJECT met...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QAY5,QBVR,QAUD,QAB9,QBV8,QBVV,QADN,QACI,QAY4,QAYL,QAPF,QABO,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Limitations of the AINSTANCE Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129865</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The AINSTANCE function places all instances of a class into a memory
variable array. The function also returns the number of instances of a
class. The function does not, however, report information about "member
objects" added by the ADD OBJECT method. "Member objects" are not, in
themselves, instances; they are a part (member) of a container.
<P>
This article provides an explanation of this function to clarify what the
AINSTANCE function does and does not do.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The AINSTANCE function places all instances of a class into a memory
variable array:
<P>
<PRE>   =AINSTANCE(aMyArray,"Form") &amp;&amp;  Places all instances of the base class
                               &amp;&amp;  Form into an array called "aMyArray"

</PRE>In the following example, AINSTANCE places all "created" instances into an
array. The WAIT WINDOWS will show how many "created" instances exist. The
list box will show "0" because it is added to the Form by the ADD OBJECT
method and is not "created." As an alternative to the AINSTANCE function,
you can use the AMEMBERS function to return information about whether or
not an object exists. The AMEMBERS function is used to populate the list
box in the following example:
<P>
<PRE>   &amp;&amp; Start of the Example:

   frmMyForm=CREATEOBJECT("FORM")
      WITH frmMyForm
          .Left = 200
          .Top  = 100
      ENDWITH

   cmdMyQuitButton=CREATEOBJECT("cmdQuitButton")

   &amp;&amp; If the above line is changed to a comment, the form and button
   &amp;&amp; still work the same but the AINSTANCE function will not
   &amp;&amp; return information for the commandbutton.

   frmMyForm.ADDOBJECT("cmdMyQuitButton", "cmdQuitButton")
   frmMyform.ADDOBJECT("cmdMyButton","commandbutton")
   &amp;&amp;The above button will not be visible on the Form

   frmMyForm.ADDOBJECT("lstMyList","ListBox")

   frmMyForm.SHOW

   nMvar=AINSTANCE(aMyArray,"Form")
   WAIT WINDOW "Forms = "+ALLTRIM(str(nMvar))

   nMvar=AINSTANCE(aMyArray,"cmdQuitButton")
   WAIT WINDOW "QuitButtons = "+ALLTRIM(str(nMvar))

   nMvar=AINSTANCE(aMyArray,"lstMyList")
   WAIT WINDOW "List Boxes = "+ALLTRIM(str(nMvar))

   =AMEMBERS(aMarray,frmMyForm,1)

   nX=ASUBSCRIPT(aMarray,(ASCAN(aMarray,"Object")),1)

   nMPos   = 1
   nMySize = 2

   FOR i = 1 to ALEN(aMarray)*2
      nMPos    = ASCAN(aMarray,"Object",nMPos)
      IF nMPos = 0
          EXIT
      ELSE
          DIMENSION aMarray2(nMySize/2,2)
      ENDIF

      WAIT WINDOW aMarray(ASUBSCRIPT(aMarray,;
      (ASCAN(aMarray,"Object",nMPos)),1),1)+"  "+;
      aMarray(ASUBSCRIPT(aMarray,;
      (ASCAN(aMarray,"Object",nMPos)),1),2)

      =ACOPY(aMarray,aMarray2,nMPos-1,2,nMySize-1)

      nMPos   = nMPos+1
      nMySize = nMySize+2

   ENDFOR

   WAIT WINDOW "No Other Objects Found"

   &amp;&amp; The list box displays the members of the Form or rather the objects
   &amp;&amp; that are contained on the Form.

   WITH frmMyForm.lstMyList
        .visible = .T.
        .width   = 300
        .height  = 150
        .top     = 30
        .left    = 30
        .rowsourcetype = 5
        .rowsource     = "aMarray2"
        .columncount   = 2
        .columnwidths  = "150"
   ENDWITH

   READ EVENTS

   DEFINE CLASS cmdQuitButton AS CommandButton
      PROCEDURE Click
         RELEASE ThisForm
         CLEAR EVENTS
      ENDPROC

      Visible = .T.
      Caption = "Quit"

      Top    = 200
      Left   = 300
      Width  = 60
      Height = 30
   ENDDEFINE

   &amp;&amp; End of the Example.

</PRE>The AINSTANCE function returns object information only on those objects
that have been instantiated programmatically by the CREATEOBJECT function
or through the interface, even though the object is a member of a defined
class. The AINSTANCE function can not return object information on "member
objects."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
