

<HTML>
<HEAD>
<TITLE>How to Set File Attributes: Use C to Create FLL &amp; Then Call It </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126454">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1995/02/23">
<META NAME="Keywords" CONTENT="kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can change the attributes of a file in FoxPro for Windows without performing a RUN ATTRIB                        . This article contains:   - The C code you need to create an FLL.  - The FoxPro code you need to call the FLL.  MORE INFORMATION  ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBXS,QBFY,QAGI,QBFN,QALQ,QAI4,QDI1,QAZZ,QAAP,QADN,QAB4,QAIF,QDMW,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Set File Attributes: Use C to Create FLL &amp; Then Call It</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126454</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can change the attributes of a file in FoxPro for Windows without
performing a RUN ATTRIB &lt;attributes&gt; &lt;filename&gt;. This article contains:

<UL><LI>The C code you need to create an FLL.
<LI>The FoxPro code you need to call the FLL.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>C Code to Create an FLL that Can Be Called from FoxPro</h3>
 
<P>
<PRE>#include &lt;dos.h&gt;
#include &lt;pro_ext.h&gt;

void FAR SetFA(ParamBlk FAR *parm)
</PRE>{
<PRE>#define FN (parm-&gt;p[0].val)
#define FA (parm-&gt;p[1].val)

char FAR *FName;
</PRE>unsigned FAttr, retst;
<P>
if(!_SetHandSize(parm-&gt;p[0].val.ev_handle, parm-&gt;p[0].val.ev_length + 1))
<PRE>//
 null terminate string
</PRE>{
<PRE>   _Error(182);
</PRE>}
_HLock(FN.ev_handle);
_HLock(FA.ev_handle);
<P>
FName = (char FAR *) _HandToPtr(parm-&gt;p[0].val.ev_handle);
FName[parm-&gt;p[0].val.ev_length] = '\0';
<P>
FAttr = (unsigned) FA.ev_long;  // set FAttr value and convert second
<PRE>                                // attribute from integer to unsigned.

retst=_dos_setfileattr(FName, FAttr);   // change file attribute

</PRE>_HUnLock(FN.ev_handle);
_HUnLock(FA.ev_handle);
<P>
_RetInt(retst, 10);  // return success or failure (0 = success) otherwise
DOS
<PRE> error
</PRE>}
<P>
FoxInfo myFoxInfo[] = {
<PRE>     {"ATTRIB", (FPFI) SetFA, 2, "C, I"},
</PRE>};
<P>
FoxTable _FoxTable = {
<PRE>     (FoxTable FAR *) 0, sizeof(myFoxInfo)/sizeof(FoxInfo), myFoxInfo
</PRE>};
<P>
<P><h3>FoxPro Code Sample Showing How to Use the FLL</h3>
 
<P>
The following FoxPro code shows by example how to use the FLL to change the
attributes of the file CUSTOMER.DBF to read only, and then reset all of the
attributes. Also included is a table showing what each of the numbers means
to the function _dos_setfileattr.
<P>
<PRE>  * Table of properties for _dos_setfileattr:
  * 0 - unset all attributes
  * 1 - read only
  * 2 - hidden
  * 3 - read only/hidden
  * 4 - system
  * 5 - read only/system
  * 6 - hidden/system
  * 7 - read only/hidden/system

  SET LIBRARY TO SYS(2004)+"fileattr.fll"
  FileStat=ATTRIB("C:\FOXPROW\TUTORIAL\CUSTOMER.DBF",1)
  IF FileStat=0
    WAIT WINDOW "Attribute of CUSTOMER.DBF set to read only"
  ELSE
    WAIT WINDOW "DOS Error: "+STR(FileStat)+" setting file attribute"
  ENDIF
  FileStat=ATTRIB("C:\FOXPROW\TUTORIAL\CUSTOMER.DBF",0)
  IF FileStat=0
    WAIT WINDOW "Attribute of CUSTOMER.DBF reset"
  ELSE
    WAIT WINDOW "DOS Error: "+STR(FileStat)+" setting file attribute"
  ENDIF
  SET LIBRARY TO
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbtool kbcode kbprg<BR>
KBSubcategory: FxtoolLck<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
