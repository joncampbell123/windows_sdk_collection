

<HTML>
<HEAD>
<TITLE>How to Make a Builder that Adds a Custom VCR Control to a Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147787">
<META NAME="KBModify" CONTENT="1996/03/06">
<META NAME="KBCreate" CONTENT="1996/02/29">
<META NAME="Keywords" CONTENT="kbtool kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows you how to make a builder that adds an instance of the VCR class to your form allowing the user to customize it with the .ico files that come with the Professional version of Visual FoxPro.  MORE INFORMATION  The following proced...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAEB,QAPF,QBC9,QBC8,QAO2,QANO,QAGX,QAJD,QAYS,QAE8,QBXS,QA7O,QA5D,QANS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Make a Builder that Adds a Custom VCR Control to a Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 6, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147787</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows you how to make a builder that adds an instance of the
VCR class to your form allowing the user to customize it with the .ico
files that come with the Professional version of Visual FoxPro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following procedure creates a builder that uses a graphical option-
group control to allow the user to pick a navigation button style. After
the user selects a style, the builder creates an instance of the VCR class
on the form. The VCR class is in the Buttons.vcx file located in the
Vfp\Samples\Controls directory.
<P>
Make sure that you've completed a full installation of the Professional
edition before using the following procedure to create the builder.
<P>
<P><h3>Step-by-Step Procedure to Create the New Builder</h3>
 

<OL><P><LI>Type the following command in the Command window to create a form class,
   and modify it in the Visual Class Designer:
<P>
   CREATE CLASS navbutton AS form OF nvbuild.vcx

<P><LI>Set the following properties for the class:
<P>
<PRE>   Property      Value
   ---------------------------------------
   BackColor     192,192,192
   Height        250
   Left          260
   Top           144
   Caption       Navigation Button Builder
   MinButton     .F.
   MaxButton     .F.
   Width         375
   WindowType    1-Modal

</PRE><P><LI>Add an OptionGroup control to the form, and set the following
   properties:
<P>
<PRE>   Property      Value
   -------------------
   ButtonCount     9
   Height        148
   Left           15
   Top            17
   Width         148

</PRE><P><LI>From the properties sheet, select Option1, and set the following
   properties. Repeat this step for Option2, Option3, Option4, Option5,
   Option6, Option7, Option8 and Option9.
<P>
<PRE>   Property        Value
   ------------------------
   Caption
   Style        1-Graphical
   Height          44
   Width           44

</PRE><P><LI>From the properties sheet, select the following objects and set their
   properties to the indicated value. All of the .ico files are located in
   the Samples\Graphics\Icons\Arrows directory off the main Visual FoxPro
   directory.
<P>
<PRE>   Property        Value
   ------------------------
   Option1
   Left                 5
   Top                  5
   Picture       arw01rt.ico

   Option2
   Left                52
   Top                  5
   Picture       arw03rt.ico

   Option3
   Left                99
   Top                  5
   Picture       arw06rt.ico

   Option4
   Left: 5
   Top: 51
   Picture       arw02rt.ico

   Option5
   Left                52
   Top                 51
   Picture:      arw05rt.ico

   Option6
   Left                 99
   Top                  51
   Picture       arw07rt.ico

   Option7
   Left                  5
   Top                  98
   Picture       arw04rt.ico

   Option8
   Left                 52
   Top                  98
   Picture       arw08rt.ico

   Option9
   Left                 99
   Top                  98
   Picture       point04.ico

</PRE><P><LI>Add a command button to the form, and set its caption to OK. Add the
   following code to its Click event:
<P>
   SET CLASSLIB TO SYS(2004)-"samples\controls\buttons.vcx" ADDITIVE
<P>
<P><PRE>      DO CASE
      CASE THISFORM.OptionGroup1.Value = 1
<PRE></PRE>        THISFORM.Tag=SYS(2004)-"samples\graphics\ICONS\ARROWS\ARW01"
      CASE THISFORM.OptionGroup1.Value = 2
        THISFORM.Tag=SYS(2004)-"samples\graphics\ICONS\ARROWS\ARW03"
      CASE THISFORM.OptionGroup1.Value = 3
        THISFORM.Tag=SYS(2004)-"samples\graphics\ICONS\ARROWS\ARW06"
      CASE THISFORM.OptionGroup1.Value = 4
        THISFORM.Tag=SYS(2004)-"samples\graphics\ICONS\ARROWS\ARW02"
      CASE THISFORM.OptionGroup1.Value = 5
        THISFORM.Tag=SYS(2004)-"samples\graphics\ICONS\ARROWS\ARW05"
      CASE THISFORM.OptionGroup1.Value = 6
        THISFORM.Tag=SYS(2004)-"samples\graphics\ICONS\ARROWS\ARW07"
      CASE THISFORM.OptionGroup1.Value = 7
        THISFORM.Tag=SYS(2004)-"samples\graphics\ICONS\ARROWS\ARW04"
      CASE THISFORM.OptionGroup1.Value = 8
        THISFORM.Tag=SYS(2004)-"samples\graphics\ICONS\ARROWS\ARW08"
      CASE THISFORM.OptionGroup1.Value = 9
        THISFORM.Tag=SYS(2004)-"samples\graphics\ICONS\ARROWS\POINT"
   ENDCASE

   = ASELOBJ(aContainer,1)
   aContainer[1].ADDOBJECT("Myvcr","vcr")
   aContainer[1].Myvcr.Height=40
   aContainer[1].Myvcr.Width=185

   * Up button
   aContainer[1].Myvcr.cmdTop.Height=40
   aContainer[1].Myvcr.cmdTop.Width=40
   aContainer[1].Myvcr.cmdTop.Caption=""
   aContainer[1].Myvcr.cmdTop.picture = ThisForm.Tag- ;
       IIF(RIGHT(ThisForm.Tag,5)="POINT","05","UP")-".ICO"

   * Left button
   aContainer[1].Myvcr.cmdPrior.Height=40
   aContainer[1].Myvcr.cmdPrior.Width=40
   aContainer[1].Myvcr.cmdPrior.Caption=""
   aContainer[1].Myvcr.cmdPrior.picture = ThisForm.Tag- ;
       IIF(RIGHT(ThisForm.Tag,5)="POINT","02","LT")-".ICO"

   * Right button
   aContainer[1].Myvcr.cmdNext.Height=40
   aContainer[1].Myvcr.cmdNext.Width=40
   aContainer[1].Myvcr.cmdNext.Caption=""
   aContainer[1].Myvcr.cmdNext.picture = ThisForm.Tag- ;
       IIF(RIGHT(ThisForm.Tag,5)="POINT","04","RT")-".ICO"

   * Down button
   aContainer[1].Myvcr.cmdBottom.Height=40
   aContainer[1].Myvcr.cmdBottom.Width=40
   aContainer[1].Myvcr.cmdBottom.Caption=""
   aContainer[1].Myvcr.cmdBottom.picture = ThisForm.Tag- ;
       IIF(RIGHT(ThisForm.Tag,5)="POINT","03","DN")-".ICO"

   THISFORM.Release

</PRE><P><LI>Add another command button to the form, and set its caption to Cancel.
   Add the following command to its Click event:
<P>
   THISFORM.Release

<P><LI>Add the following command to the Init event of the form:
<P>
   PARAMETERS uP1,uP2,uP3

<P><LI>Save the class. To register this builder, add a new record to the
   Builder.dbf table located in the Wizards directory, and enter the
   following values into the appropriate fields:
<P>
<PRE>   NAME       Navigation Button Builder
   DESCRIPT   Applies a set of customized navigation buttons onto a form
   TYPE       FORM
   CLASSLIB   NVBUILD.VCX
   CLASSNAME  NAVBUTTON

</PRE><P><LI>Copy Nvzbuild.vcx and Nvbuild.vct to the Wizards directory.
<P>
</OL><h3>Steps to Use the New Builder</h3>
 
<P>
To use the builder, create a new form, and then either:

<UL><LI>Right-click the form, and select Builder.
<P>
   -or-

<LI>Click the Builder icon in the Properties sheet.
<P>
</UL>To select your new builder, click Navigation Button Builder in the Builder
Selection dialog dialog box.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbtool kbhowto kbcode<BR>
KBSubcategory: FxtoolBuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 6, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
