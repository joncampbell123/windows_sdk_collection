

<HTML>
<HEAD>
<TITLE>PRB: REPLACE Command Replaces Field in Selected Table &amp; Cursor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120459">
<META NAME="KBModify" CONTENT="1995/08/28">
<META NAME="KBCreate" CONTENT="1994/09/12">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you create a cursor from a SELECT-SQL statement and then select the original table and issue a REPLACE command against the original table, the replacement takes place against both the original table and the cursor.  For example, issue the follow...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO0,QAO2,QA2Q,QABA,QAG2,QAJ2,QAY2,QACI,QBWS,QAB9,QBNG,QBV8,QA7O,QA7N,QAY4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: REPLACE Command Replaces Field in Selected Table &amp; Cursor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120459</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you create a cursor from a SELECT-SQL statement and then select the
original table and issue a REPLACE command against the original table, the
replacement takes place against both the original table and the cursor.
<P>
For example, issue the following commands in the Command window:
<P>
<PRE>   USE customer    &amp;&amp; Use the CUSTOMER table in the TUTORIAL subdirectory
   SELECT * FROM customer INTO CURSOR temp
   SELECT customer
   REPLACE ALL customer.company WITH " "

</PRE>The REPLACE command works as expected on the CUSTOMER table; however, every
COMPANY field for each record in the TEMP cursor now also has no values. In
essence, the one REPLACE command takes place on both the table and the
cursor.
<P>
<P><h2>CAUSE</h2>
 
<P>
Because the original query did not specify any criteria that would cause
the results to return a structure different than the original table, FoxPro
just returns a "phantom" cursor that is really a pointer or reference to
the original table.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you SELECT the fields from the original table into another table, rather
than a cursor, this behavior will not occur.
<P>
For example, the following sequence of commands will behave correctly:
<P>
<PRE>   USE customer
   SELECT * FROM customer INTO TABLE temp
   SELECT customer
   REPLACE ALL customer.company WITH " "

</PRE><h2>MORE INFORMATION</h2>
 
<P>
There are other similar sequences of commands that can duplicate this
behavior. For example:
<P>
<PRE>   USE customer
   SELECT * FROM customer INTO CURSOR temp
   SELECT customer
   ZAP

</PRE>When you issue these commands, FoxPro will generate an error message from
the ZAP command saying the "File is open in another work area." This
message is referring to the original table.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.00 2.50 2.50a 2.50b<BR>
2.50c 2.60<BR>
database<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgSql<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
