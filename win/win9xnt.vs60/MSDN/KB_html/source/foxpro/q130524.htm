

<HTML>
<HEAD>
<TITLE>BUG: COPY TO ARRAY Behaves Differently from dBASE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130524">
<META NAME="KBModify" CONTENT="1997/05/06">
<META NAME="KBCreate" CONTENT="1995/05/22">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 kb3rdparty vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the command COPY TO ARRAY              FIELDS              where one of the fields in the field list is a calculated expression generates one of the following errors:   - Not a character expression.     -or-   - Command contains unrecognized ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB9,QAE5,QA7O,QA7N,QAY2,QAH4,QA9N,QASB,QABM,QAB4,QDI1,QAML,QALZ,QADX,QAEN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: COPY TO ARRAY Behaves Differently from dBASE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130524</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the command COPY TO ARRAY &lt;array name&gt; FIELDS &lt;field list&gt; where one
of the fields in the field list is a calculated expression generates one of
the following errors:

<UL><LI>Not a character expression.
<P>
   -or-

<LI>Command contains unrecognized phrase/keyword.
<P>
</UL><h2>CAUSE</h2>
 
<P>
Calculated expressions are not evaluated in the COPY TO ARRAY command.
<P>
NOTE: This is a common practice among dBASE programmers and will cause
legacy code to break.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this error message do one of the following:

<UL><LI>Modify the structure of the source table to accommodate result data from
   calculated expressions.
<P>
   -or-

<LI>Create the array using the SQL syntax. This syntax permits calculated
   expressions to some degree. For example, if you need a four-element
   array that contains data from three specific fields in your table in
   addition to a calculated expression, your code would look like this:
<P>
   SELECT product, units, cost, (cost*unit) ;
<P><PRE>      FROM products ;
      INTO ARRAY aTemp
</PRE><P>
   Here product, units, and cost are fields from a table called products
   and (cost*units) is a calculated expression.
<P>
   -or-

<LI>Create the array with an extra element and STORE the results of the
   calculation in the corresponding array element by using a FOR loop. For
   example, if you need a four-element array with 10 rows and the last
   element in the array should contain the calculated expression, your code
   would look like this:
<P>
   DIMENSION aTemp[5,10]
   FOR i = 1 TO 10 STEP 1
<P><PRE>      STORE (i + 1) TO aTemp[5,i]
</PRE>   ENDFOR
<P>
   Here (i + 1) is the calculated expression.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist3.00 buglist3.00b buglist5.00 kb3rdparty vfpbug5.0a kbbuglist<BR>
Version             : 3.0 3.0b 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
