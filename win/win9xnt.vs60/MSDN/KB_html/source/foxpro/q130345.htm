

<HTML>
<HEAD>
<TITLE>How to Retreive Database Properties in a Program </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130345">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/05/17">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Visual FoxPro introduces several database properties available to databases. These properties include comments and stored procedures. This article describes how to determine database properties from a Visual FoxPro program.  MORE INFORMATION  The D...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QBRZ,QAB9,QAPN,QAMB,QAE1,QAPF,QADK,QA9N,QAUJ,QAUD,QASB,QBV8,QAFR,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Retreive Database Properties in a Program</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130345</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual FoxPro introduces several database properties available to
databases. These properties include comments and stored procedures. This
article describes how to determine database properties from a Visual FoxPro
program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DISPLAY DATABASE and LIST DATABASE commands can view several database
properties at once. These commands can direct output to the console, to a
printer, or to a text file. The example in this article retrieves
individual components of a database.
<P>
<P><h3>Comment</h3>
 
<P>
A database comment can be obtained by using the DBGETPROP() function. The
following example shows how to return the comment of a database by using
DBGETPROP():
<P>
<PRE>   cResult=DBGETPROP('mydata', 'DATABASE', 'Comment')

</PRE>The parameters are:

<UL><LI>mydata is the table name.
<LI>DATABASE specifies that the property is a database property.
<LI>Comment is the property desired.
<P>
</UL><h3>Version</h3>
 
<P>
The version number of a database can be obtained by using DBGETPROP()
function. The following example shows how to return the version number of a
database by using DBGETPROP():
<P>
<PRE>   cResult=DBGETPROP('mydata', 'DATABASE', 'Version')

</PRE>The parameters are:

<UL><LI>mydata is the table name.
<LI>DATABASE specifies that the property is a database property.
<LI>Version is the property desired.
<P>
</UL><h3>Path</h3>
 
<P>
The path to the database can be obtained by using the DBC() function. The
following example shows how to return the path of a database by using
DBC():
<P>
<PRE>   SET DATABASE TO alldata        &amp;&amp;Assumes a database named "alldata"
   cResult=DBC()

</PRE><h3>Stored Procedures</h3>
 
<P>
Stored procedures contained within a database can be obtained by using the
DISPLAY PROCEDURES or COPY PROCEDURES command. There is no way to store the
contents of stored procedures in a memory variable. DISPLAY and COPY
PROCEDURES can both be used to copy stored procedures to a text file or to
the printer. The following example uses COPY PROCEDURES to copy the stored
procedures to a file named STORCODE.TXT:
<P>
<PRE>   OPEN DATABASE alldata
   COPY PROCEDURES TO storcode.txt

</PRE><h3>Tables</h3>
 
<P>
A list of tables contained within a database can be obtained by using the
DISPLAY TABLES or LIST TABLES command to display the list to the console, a
printer, or a text file. Here's an example:
<P>
<PRE>   OPEN DATABASE alldata
   LIST TABLES TO FILE tblfile.txt NOCONSOLE

</PRE><h3>Views</h3>
 
<P>
A list of views contained within a database can be obtained by using the
DISPLAY VIEWS or LIST VIEWS command to display the list to the console, a
printer, or a text file. Here's an example:
<P>
<PRE>   OPEN DATABASE alldata
   LIST VIEWS TO FILE viewfile.txt NOCONSOLE

</PRE><h3>Named Connections</h3>
 
<P>
A list of named connections contained within a database can be obtained
by using the DISPLAY CONNECTIONS or LIST CONNECTIONS command to display the
list to the console, a printer, or a text file. Here's an example:
<P>
<PRE>   OPEN DATABASE alldata
   LIST CONNECTIONS TO FILE connfile.txt NOCONSOLE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
