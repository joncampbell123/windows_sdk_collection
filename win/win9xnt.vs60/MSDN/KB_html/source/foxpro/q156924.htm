

<HTML>
<HEAD>
<TITLE>PRB: Menu with Internal Names in SDI Form Changes System Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156924">
<META NAME="KBModify" CONTENT="1996/10/29">
<META NAME="KBCreate" CONTENT="1996/10/02">
<META NAME="Keywords" CONTENT="kbtool kbui kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a single-document interface (SDI), or Top-Level, form is run with its own menu, which uses Visual FoxPro's internal menu names, any modifications made to the menu in the SDI form also change the corresponding pop-up or pad in the Visual FoxPro s...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAF0,QBWS,QBWR,QA01,QBJZ,QAUJ,QANE,QA56,QA55,QAGB,QABA,QBT6,QAI2,QBV4,QA7Y V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Menu with Internal Names in SDI Form Changes System Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156924</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a single-document interface (SDI), or Top-Level, form is run with its
own menu, which uses Visual FoxPro's internal menu names, any modifications
made to the menu in the SDI form also change the corresponding pop-up or
pad in the Visual FoxPro system menu.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Issue the following command after the SDI form is closed:
<P>
<PRE>   SET SYSMENU TO DEFAULT

</PRE>-or-
<P>
Do not use internal menu names.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior occurs because there is only one System menu. If the menu
code used in your SDI form is doing an explicit DEFINE POPUP _mfile, which
redefines the File menu--a Quick menu does this--the definition supersedes
any existing definition of the File menu, regardless of whether the System
menu appears in an SDI form or the Visual FoxPro desktop. In Visual FoxPro
version 5.0, you can use System menus in SDI forms as well as on the Visual
FoxPro desktop. If internal System menu names are used in a menu
definition, the system menu changes, regardless of where it appears, after
that menu definition becomes effective.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form called Test.

<P><LI>Set the form's ShowWindow property to 2 in the Form Designer Property
   window.

<P><LI>In the Init method of the form, add the following code:
<P>
<P><PRE>      DO TESTMENU.MPR WITH This, .T.
</PRE>
<P><LI>Create a new menu. Make it a Menu rather than a Shortcut.

<P><LI>On the Menu menu, click Quick Menu to create a default quick menu.

<P><LI>On the View menu, click General Options. In the General Options dialog
   box, click the Top-Level Form check box, then OK.

<P><LI>In the Menu Designer, click the File prompt, then the Edit button.

<P><LI>With New under Prompt selected, click on the Result drop-down list.
   Click Command. Click Yes in the Delete Bar Number dialog box.

<P><LI>Tab to the empty text box to the right of the Result box, type the
   following, then press enter:
<P>
<P><PRE>      =MESSAGEBOX('From SDI Menu',0)
</PRE>
<P><LI>On the Menu menu, click Generate. Save the menu as Testmenu, then
<P><PRE>    select the Generate button to generate the default .mpr file.
</PRE>
<P><LI>Run the Test form. On the SDI form, click File then New from the menu.
<P><PRE>    The message box appears; click OK to close it.
</PRE>
<P><LI>Click the Close button [X] in the upper right corner of the form
<P><PRE>    under Windows 95 or NT 4.0, or select Alt+F4 or Close from the control
    menu to close the SDI form.
</PRE>
<P><LI>On the File menu, click New. The message box again appears. Typing SET
<P><PRE>    SYSMENU TO DEFAULT in the Command window restores the default menu
    functionality.
</PRE><P>
</OL><h3>NOTES</h3>
 

<UL><LI>Often, the SDI form is the main window in your application. In this
   scenario, since the Visual FoxPro desktop is hidden, it makes no
   difference how the menu in the Visual FoxPro desktop appears. You can
   add a SET SYSMENU TO DEFAULT command in the Destroy() or Unload()
   methods of your form to reset the System menu when you exit your SDI
   form or application. This allows the menu to appear as expected when you
   return to the Visual FoxPro development environment.

<LI>There may be other situations where you wish to simultaneously have an
   SDI form or forms and the Visual FoxPro desktop open in your application
   with different menus. In this case, you can rename the menu names to
   something other than the FoxPro internal menu names.
<P>
</UL>Use the following steps to incorporate this change into the original
example above:

<OL><P><LI>Open Testmenu in the Menu Designer.

<P><LI>In the Menu Designer, click the File prompt, then the Edit button.

<P><LI>On the View menu, click Menu.

<P><LI>In the Menu Options dialog box, change the contents of the Name text box
   from _mfile to myfilemenu.

<P><LI>On the Menu menu, click Generate. Click Yes to save the changes, then
   click the Generate button, and click Yes to overwrite the old version of
   the .mpr file.

<P><LI>Repeat steps 11 through 13 from the original example. After step 13, the
   New File dialog box opens, rather than the message box.
<P>
</OL>Likewise, you can change the menu names for all the menu names, rather than
just _mfile, to allow customization of each.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Visual FoxPro 5.0 Help file; search on topic: System Menu Names
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbui kbprb<BR>
KBSubcategory: FxprgClassoop FxtoolFormdes FxtoolMbuilder<BR>
Additional reference words: 5.00 kbdse VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
