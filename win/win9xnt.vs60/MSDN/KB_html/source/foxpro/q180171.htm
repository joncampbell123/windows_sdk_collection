

<HTML>
<HEAD>
<TITLE>PRB: FoxPro/Mac Table Operations Do Not Release Memory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180171">
<META NAME="KBModify" CONTENT="1998/01/30">
<META NAME="KBCreate" CONTENT="1998/01/30">
<META NAME="Keywords" CONTENT="FoxMac FxenvMemory FxprgTable VFoxMac">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  User object memory in FoxPro increases greatly and does not decrease when you issue any of the following commands on a large table:     DELETE ALL    RECALL ALL    INDEX ON    SCAN...ENDSCAN  RESOLUTION  Closing and reopening the table reduces memo...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW6,QDO9,QAB9,QBV8,QABH,QABI,QAJH,QAY5,QAW6,QAPN,QA28,QATJ,QAGU,QDIR,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: FoxPro/Mac Table Operations Do Not Release Memory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 30, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180171</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft FoxPro for Macintosh, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
User object memory in FoxPro increases greatly and does not decrease when
you issue any of the following commands on a large table:
<P>
<PRE>   DELETE ALL
   RECALL ALL
   INDEX ON
   SCAN...ENDSCAN

</PRE><h2>RESOLUTION</h2>
 
<P>
Closing and reopening the table reduces memory usage back to its
approximate original value.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
User object memory is defined as memory used by objects that the user or
programmer defines. User-defined objects include user-defined windows, menu
bars, menus, variables, arrays, open tables, files opened with low-level
file functions, and so on. User object memory can be checked with the
SYS(1016) function.
<P>
Applications on the Macintosh obtain memory from the operating system in a
different way than Windows applications. On the Macintosh, the amount of
memory to be allocated to a program is specified in the Get Info window
under the Mac's File menu. The minimum amount of memory to be used for an
application and the preferred amount can be set. However, the application
must be closed to change these settings. If there is enough memory for the
preferred amount to be used, the application takes this much memory from
the operating system upon startup although the application may not be using
all that memory. The memory is just reserved for the application.
<P>
In addition to using the SYS(1016) function, the amount of memory allocated
to FoxPro that is in use can be viewed from the About This Computer (or
About This Macintosh, depending on the System software version) command on
the Apple menu in Finder. This dialog box displays the System software
version, the amount of total memory, the amount of virtual memory and the
memory allocated to all running applications, including Finder itself. If
Balloon Help is turned on and the mouse pointer is placed over the memory
bar for an application, the balloon displays the amount of memory in use by
the application. For instance, with Visual FoxPro, the balloon may display
"This program is currently using 2.8 MB out of the 5.9 MB reserved for it."
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Obtain or create a large table. The program below can be used to create
   a large table with 90,000 records. This may take considerable time to
   run depending on the speed of the Macintosh.
<P>
<P><PRE>      CREATE TABLE BigTable (CharVal C(12), NumVal N(8.0))
      USE BigTable.DBF
      FOR x = 1 TO 90000
      INSERT INTO bigtable (CharVal, NumVal) ;
<PRE></PRE>         VALUES (SYS(2015), RECCOUNT()+1)
      NEXT
      USE

</PRE><P><LI>Check user object memory with the SYS(1016) function. From
   the Command window type in the code below and then press ENTER:
<P>
<P><PRE>      ? SYS(1016)
</PRE><P>
   A number should appear on the FoxPro screen.
<P>
   Here is an example:
<P>
<P><PRE>      2516480
</PRE>
<P><LI>In the Command window type:
<P>
<P><PRE>      USE Big_Table
      ? SYS(1016)
</PRE><P>
   The User object memory should increase slightly.

<P><LI>Issue a DELETE ALL command in the Command window and check SYS(1016)
   again.

<P><LI>Now issue a RECALL ALL in the Command window and check SYS(1016).

<P><LI>Close the table by issuing just the USE command in the Command window
   and check SYS(1016).

<P><LI>Similar results can be seen using the INDEX ON command and a
   SCAN...ENDSCAN loop. The INDEX ON &lt;fieldname&gt; TO &lt;filename.idx&gt; command
   uses more memory than the DELETE ALL or RECALL ALL commands.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information on creating large tables for testing purposes, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q170128.htm">Q170128</A></B>
   TITLE     : HOWTO: Programmatically Create Large Tables for Testing
               Purposes

</PRE></OL> 
<PRE>Keywords          : FoxMac FxenvMemory FxprgTable VFoxMac
Version           : MACINTOSH:2.6a,3.0b
Platform          : MACINTOSH
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 30, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
