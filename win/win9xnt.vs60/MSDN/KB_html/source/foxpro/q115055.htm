

<HTML>
<HEAD>
<TITLE>Function to Calculate Elapsed or Accumulated Time </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115055">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/05/18">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Although the TIME() and SECONDS() functions in FoxPro return the current time and seconds elapsed since midnight, respectively, there are no intrinsic functions within FoxPro to directly perform arithmetic operations on time values.  The user-defin...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QAU3,QAMR,QAFH,QAUD,QAY5,QBXS,QAH4,QBV8,QAPN,QAB9,QATK,QASJ,QAJQ,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Function to Calculate Elapsed or Accumulated Time</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115055</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 1.02, 2.0, 2.5, 2.5a, 2.6
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Although the TIME() and SECONDS() functions in FoxPro return the current
time and seconds elapsed since midnight, respectively, there are no
intrinsic functions within FoxPro to directly perform arithmetic operations
on time values.
<P>
The user-defined (UDF) function shown below makes it possible to add or
subtract values returned by the TIME() function or those entered manually
in the standard hours:minutes:seconds format.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following function is used by the first set of code samples found below
it:
<P>
<PRE>   * TIMECALC.PRG
   PARAMETERS bt,et,op
   hr1=VAL(LEFT(bt,2))
   hr2=VAL(LEFT(et,2))
   mn1=VAL(SUBSTR(bt,4,2))
   mn2=VAL(SUBSTR(et,4,2))
   sc1=VAL(RIGHT(bt,2))
   sc2=VAL(RIGHT(et,2))
   tot1=(hr1*3600)+(mn1*60)+sc1
   tot2=(hr2*3600)+(mn2*60)+sc2
   IF op=1
     tt=tot1+tot2
   ELSE
     tt=tot2-tot1
   ENDIF
   thr=ALLTRIM(STR(INT(tt/3600)))
   tmn=ALLTRIM(STR(INT((tt%3600)/60)))
   tsc=ALLTRIM(STR((tt%3600)%60))
   tdc=RIGHT(STR(INT((VAL(tmn)/60)*10)/10,5,1),1)
   RETURN chr(13)+'  '+ ;
          thr+' hour'+iif(val(thr)&lt;&gt;1,'s','')+', '+ ;
          tmn+' minute'+iif(val(tmn)&lt;&gt;1,'s','')+', '+ ;
          tsc+' second'+iif(val(tsc)&lt;&gt;1,'s','')+'.' + ;
          chr(13)+chr(13)+ '  Decimal equivalent: '+ ;
          thr+'.'+tdc+' hour'+iif(val(tdc)&lt;&gt;1,'s','')+'.'+chr(13)

</PRE><h3>Sample Code</h3>
 
<P>
<PRE>   *-&gt; FOR MS-DOS and Macintosh
   ? timecalc('00.05.15','01.25.00',1)
   ? timecalc('00.05.15','01.25.00',2)

   *-&gt; FOR WINDOWS 2.5
   SET TEXTMERGE ON
   \&lt;&lt;timecalc('00.05.15','01.25.00',1)&gt;&gt;
   \&lt;&lt;timecalc('00.05.15','01.25.00',2)&gt;&gt;
   SET TEXTMERGE OFF

   *-&gt; FOR 2.5a MS-DOS or WINDOWS
   WAIT WIND timecalc('00.05.15','01.25.00',1) NOWAIT
   WAIT WIND timecalc('00.05.15','01.25.00',2) NOWAIT

   **** R E S U L T S ******************************

   * (1=ADDITION) returns:
   *
   *    1 hour, 30 minutes, 15 seconds.
   *
   *    Decimal equivalent: 1.5 hours.
   *

   * (2=SUBTRACTION) returns:
   *
   *    1 hour, 19 minutes, 45 seconds.
   *
   *    Decimal equivalent: 1.3 hours.
   *
   * NOTE: While a period is used in this example as a separator
   * character for hr.mn.sc, any other character may be used.

</PRE>The following program demonstrates a FoxPro for Windows-specific
implementation of the TimeCalc() function, which tracks the time since the
current FoxPro session began. The timer can optionally be reset. This
example uses a program file called by the CONFIG.FPW file when FoxPro is
started to initialize the variables and set keytraps for displaying and
resetting the timer.
<P>
<PRE>   *** T I M E T R A K . P R G
   *
   PUBLIC btime
   ON KEY LABEL F4 btime=TIME()
   ON KEY LABEL F5 WAIT WINDOW TimeCalc( btime, TIME(), 2 ) NOWAIT
   KEYBOARD "{F4}"
   * end of program

</PRE>To have the program load automatically when FoxPro starts, modify the
CONFIG.FPW file to include the following line:
<P>
<PRE>   COMMAND=DO timetrak

</PRE>To use the timer, press F5 to display how long FoxPro has been running. You
can display the elapsed time at any time during the session by pressing F5.
<P>
If you are repeating a specific action and each action must be timed
separately (such as data entry or phone call tracking), press F4 (or
issued it programmatically with the KEYBOARD command) to reset the timer
at the beginning of the action. When you have completed the action, press
F5 to display the elapsed time for that action.
<P>
If the timer has not been reset, you can display the entire session time by
issuing F5 within an ON SHUTDOWN routine. If individual actions must be
tracked as well, you can assign an additional variable in the TIMETRAK
program to track the entire session.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxMac FoxDos FoxWin 2.60 timing<BR>
stopwatch lap<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxenvConfigfp<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
