

<HTML>
<HEAD>
<TITLE>HOWTO: Export an Embedded .bmp Image into a File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161832">
<META NAME="KBModify" CONTENT="1997/08/06">
<META NAME="KBCreate" CONTENT="1997/01/06">
<META NAME="Keywords" CONTENT="FxotherGraphic VFoxMac vfoxwin kbgraphic kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The command  APPEND GENERAL                      FROM           .bmp  imports a BMP image from a file and places it into a general field. But there is no reverse command like  Copy General To,  which can export an embedded BMP image into a .bmp fil...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAH2,QA3P,QAY4,QAVX,QAVW,QA5V,QAB2,QA9N,QAYY,QAY2,QAUR,QAFI,QDO9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Export an Embedded .bmp Image into a File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161832</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The command "APPEND GENERAL &lt;General field name&gt; FROM &lt;filename&gt;.bmp"
imports a BMP image from a file and places it into a general field. But
there is no reverse command like "Copy General To," which can export an
embedded BMP image into a .bmp file. The following steps offer a workaround
specially designed for embedded .bmp files only, other data formats can be
easily exported if the storage structure of an OLE object is recognizable.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps and sample program can be used to save an embedded
bitmap file to a physical file on disk:

<OL><P><LI>Go to the record number of a table that you would like the associated
   BMP image exported to.

<P><LI>Copy the general field (Name "Picture") of the record to a temporary
   file (Name "Temp"). So the newly created Temp.dbf file contains one
   general field "Picture" and one record only. The syntax for this
   follows:
<P>
<P><PRE>      COPY TO temp FIELDS picture NEXT 1
</PRE>
<P><LI>Execute the following code, assuming the file name for the output BMP
   image is "Test.Bmp":
<P>
<P><PRE>      *** Open two files, "temp.fpt" contains the physical BMP data.
      *** and Create a file handle for the output file "Test.Bmp"
      handlein=FOPEN("temp.fpt")
      handleout=FCREATE("test.bmp")
</PRE><P>
<P><PRE>      *** To determine the length of the Input file "Temp.fpt"
      gnEnd = FSEEK(handlein, 0, 2)
      gnTop = FSEEK(handlein, 0)
</PRE><P>
<P><PRE>      *** Store the whole file into a string "str1"
      str1 = FREAD(handlein, gnEnd)
</PRE><P>
<P><PRE>      ***  Offset 599 bytes from Str1 and save it to "str2"
      str2=RIGHT(str1,LEN(str1)-599)
</PRE><P>
<P><PRE>      *** Write "Str2" into the BMP file "Test.BMP"
      n=FWRITE(handleout,str2)
</PRE><P>
<P><PRE>      *** Close both opened files
      =FCLOSE(handlein)
      =FCLOSE(handleout)
</PRE><P>
</OL>NOTE: If the BMP is placed into a General field by Edit/Paste from
Clipboard, the data stored in general field is 599 bytes of header bytes
plus the actual BMP data.
<P>
If the .bmp file is embedded in a general field by "Insert Object" or
"Append General," then FoxPro creates presentation data plus the actual
.bmp file data into the general field, which may result in the size of the
FTP file being twice as big as the original .bmp data and if this is the
case, 599 may not be the correct offset.
<P>
 
<PRE>Keywords          : FxotherGraphic VFoxMac vfoxwin kbgraphic kbhowto
Technology        : kbole
Version           : 2.5b 2.5c 2.6a 3.0 3.0b 5.0
Platform          : MACINTOSH WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
