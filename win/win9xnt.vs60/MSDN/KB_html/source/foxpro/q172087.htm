

<HTML>
<HEAD>
<TITLE>SAMPLE: Agrid.exe Navigates to Non-Visible Grid Cells in Visual </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172087">
<META NAME="KBModify" CONTENT="1998/02/20">
<META NAME="KBCreate" CONTENT="1997/07/29">
<META NAME="Keywords" CONTENT="FxprgGrid VFoxMac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Agrid.exe is a sample for FoxPro for Windows that shows a way to move to grid cells that are not visible on the face of the grid with program code. The files include a form, Gridtest.scx, with a grid on it. The grid is based on a class stored in th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QA56,QARR,QAH4,QAPF,QDO9,QAY2,QBR5,QABA,QABO,QAFI,QBHQ,QBV8,QAUY,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Agrid.exe Navigates to Non-Visible Grid Cells in Visual</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172087</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Agrid.exe is a sample for FoxPro for Windows that shows a way to move to
grid cells that are not visible on the face of the grid with program code.
The files include a form, Gridtest.scx, with a grid on it. The grid is
based on a class stored in the Agrid.vcx visual class library.
<P>
Agrid.hqx is a sample for the Macintosh that shows a way to move to grid
cells that are not visible on the face of the grid with program code. The
files include a form, Gridtest.scx, with a grid on it. The grid is based on
a class stored in the Agrid.vcx visual class library.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following files are available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/agrid.exe">Agrid.exe</A> <I>(size: 21556 bytes)</I> 
             - Compressed file for Visual FoxPro for Windows
 ~ <A href="http://support.microsoft.com/download/support/mslfiles/agrid.hqx">Agrid.hqx</A> <I>(size: 31492 bytes)</I> 
             - Stuffed file for Visual FoxPro for Macintosh

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>In Visual FoxPro, the ActivateCell() method of a grid can be used to change
the active cell in a grid. However, ActivateCell() works only for cells
that are visible in the grid. A grid may have thousands of rows and more
columns than can be shown. These rows and columns can be accessed if the
user scrolls the grid or uses the navigation keys (page up, page down,
arrow keys, and so forth) to move to them. The sample .vcx file contains a
class based on a grid that has a custom method to allow access to any cell
in the grid, visible or not.
<P>
To use the files included, follow these steps:

<OL><P><LI>Download the Agrid.exe or Agrid.hqx file and place it in a new folder.

<P><LI>Double-click Agrid.exe or Agrid.hqx to extract the files.

<P><LI>Once the files are extracted, start Visual FoxPro.

<P><LI>In Visual FoxPro, set the default directory to the location of the files
   through the Tools, Options dialog box, File Locations tab or with the
   SET DEFAULT TO command.

<P><LI>The sample form, Gridtest.scx, uses the TestData!Customer table. This
   is a sample table installed with Visual FoxPro in the \Samples\Data
   folder. Copy the files from that folder to the folder where the sample
   files for this article have been saved. Visual FoxPro 5.x users won't
   need to copy the .qpr, .prg, .pjx and .pjt files from that folder.

<P><LI>The form and class library were created in Visual FoxPro 5.0a. To use
   them in Visual FoxPro 3.x, issue the following commands in Visual FoxPro
   3.x to recompile them:
<P>
<P><PRE>      COMPILE FORM Gridtest.scx
      COMPILE FORM Agrid.vcx
</PRE><P>
   When using the files in Visual FoxPro for Macintosh, at least for
   purposes of this article, setting MacDeskTop off is recommended. The
   following command will do that:
<P>
<P><PRE>      SET MACDESKTOP OFF
</PRE><P>
   The form and class library should be recompiled on the Macintosh.
   Use the commands above in Visual FoxPro for Macintosh.

<P><LI>Run the form by issuing DO FORM Gridtest.scx in the Visual FoxPro
   Command window or by selecting Do from the Program menu, changing the
   Files Of Type drop-down list to Form, and selecting Gridtest.scx.

<P><LI>The syntax for using the custom function of the agrid class is:
<P>
<P><PRE>      grid.GoToCell(nrow,ncol)
</PRE><P>
   where nrow and ncol specify the row and column of the cell to make
   active.
<P>
   Try these commands in the Command window with the form running to test
   the custom method:
<P>
<P><PRE>      gridtest.agrid1.GoToCell(65,7)
</PRE><P>
<P><PRE>      gridtest.agrid1.GoToCell(18,5)
      gridtest.agrid1.GoToCell(12,2)
      gridtest.agrid1.GoToCell(1,1)
      gridtest.agrid1.ActivateCell(18,5)  &amp;&amp; Note that this will not work.
</PRE><P>
</OL>NOTE: An "Invalid subscript reference" error message results from
<PRE>      either a zero or negative number entered for the column reference.

</PRE><P><LI>Quit and examine the agrid class in the Agrid.vcx visual class library
   as desired.
<P>
</OL>Any improvements to the code in the GoToCell custom method in the agrid
class are appreciated.
<P>
 
<PRE>Keywords          : FxprgGrid VFoxMac vfoxwin
Version           : MACINTOSH:3.0b; WINDOWS:3.0,3.0b,5.0,5.0a
Platform          : MACINTOSH WINDOWS
Issue type        : kbfile
Solution Type     : kbsample</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
