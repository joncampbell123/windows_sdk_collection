

<HTML>
<HEAD>
<TITLE>PRB: "Record is not locked" When Editing Multi-table Browse </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124865">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/01/15">
<META NAME="Keywords" CONTENT="kbprg kbprg kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When editing the data in a Browse window using the BROWSE command with the FIELDS clause, where the fields come from more than one table, a dialog box appears containing the message:     Record is not locked  CAUSE =====  One or more of the tables ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA7O,QA7N,QALQ,QBXS,QBVV,QBWS,QAWI,QBWT,QADX,QATJ,QAEV,QBQU,QBWA,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Record is not locked" When Editing Multi-table Browse</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124865</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
<LI>Microsoft FoxPro for MS-DOS, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When editing the data in a Browse window using the BROWSE command with the
FIELDS clause, where the fields come from more than one table, a dialog box
appears containing the message:
<P>
<PRE>   Record is not locked

</PRE><h2>CAUSE</h2>
 
<P>
One or more of the tables whose fields are included in the BROWSE is opened
exclusively.
<P>
One cause of the "Record is not locked" message is attempting to edit any
field of a multi-table BROWSE involving related tables when one of the
tables is opened for exclusive use.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not open any of the tables exclusively, or edit the fields within the
@ ... GET fields of a window defined by FoxPro's Screen Builder.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Steps to Reproduce Behavior
 

<OL><P><LI>Set the default directory to the TUTORIAL directory provided with the
   product by typing the following in the Command window:
<P>
<P><PRE>      SET DEFAULT TO SYS(2004)+ "tutorial"
</PRE>
<P><LI>Create and run a program containing the following commands:
<P>
<P><PRE>      CLOSE ALL
      USE detail EXCLUSIVE &amp;&amp; Open the file exclusively
      INDEX ON pno TAG pno &amp;&amp; If the tag already exists, reply YES
<PRE></PRE>      CLOSE ALL            &amp;&amp; Remove exclusive setting
      SET EXCLUSIVE OFF
      USE parts EXCLUSIVE  &amp;&amp; EXCLUSIVE will cause the message
      USE detail IN 0 ORDER TAG pno
      SELECT parts
      SET RELATION TO pno INTO detail
      BROWSE FIELDS parts.pno, detail.price

</PRE><P><LI>Move the insertion point to the PRICE field of any record and enter some
   new data, including two digits to the right of the decimal point.
<P>
</OL>The message "Record is not locked" appears. This happens on a single-user
system and on a shared (network) system, with or without multi-locks being
set on or off, and with or without the Detail table being opened in Shared
mode.
<P>
This occurs because FoxPro assigns Exclusive status to the browsed data
of all of the related tables when one of those tables is opened
exclusively.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.60a FoxWin FoxDos errmsg multiuser network<BR>
KBCategory: kbprg kbprg kberrmsg<BR>
KBSubcategory: FxprgMultiuser<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
