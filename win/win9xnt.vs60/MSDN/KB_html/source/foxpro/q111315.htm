

<HTML>
<HEAD>
<TITLE>BROWSE Clauses Saved by PREFERENCE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111315">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/02/09">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The PREFERENCE clause of the BROWSE command is used to save certain attributes of a Browse window for later use. Some BROWSE clauses are saved by the PREFERENCE clause, others are not. This article explains which clauses are saved by the PREFERENCE...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWT,QADN,QA7O,QA7N,QAVX,QAVW,QAGQ,QAUR,QAU7,QAUD,QAPN,QAJX,QAEF,QADR,QAC2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BROWSE Clauses Saved by PREFERENCE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111315</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.5b
<LI>Microsoft FoxPro for MS-DOS, version 2.5b
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The PREFERENCE clause of the BROWSE command is used to save certain
attributes of a Browse window for later use. Some BROWSE clauses are saved
by the PREFERENCE clause, others are not. This article explains which
clauses are saved by the PREFERENCE clause and which are not.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following BROWSE commands demonstrate clauses that are saved by the
PREFERENCE clause:
<P>
<PRE>   BROWSE FIELDS client_id,company PREF b1
   BROWSE FONT "Courier New",10 PREF b2
   BROWSE STYLE "I" PREF b3

   BROWSE FREEZE contact PREF b6
   BROWSE PARTITION 20 LEDIT PREF b8
   BROWSE PARTITION 20 REDIT PREF b9
   BROWSE LOCK 2 PREF b10
   BROWSE PARTITION 20 PREF b11
   BROWSE PARTITION 20 LPARTITION PREF b12
   BROWSE NOAPPEND PREF b13

   BROWSE NODELETE PREF b15

   BROWSE NOEDIT PREF b16
   BROWSE NOMODIFY PREF b17

   BROWSE PARTITION 20 NOLGRID PREF b18
   BROWSE NORGRID PREF b19
   BROWSE PARTITION 20 NOLINK PREF b20
   BROWSE NOMENU PREF b21
   BROWSE TITLE "Hello" PREF b29
   BROWSE VALID myudf() PREF b30
   BROWSE WHEN mywhen() PREF b33
   BROWSE WIDTH 2 PREF b34
   BROWSE WINDOW test PREF b35
   BROWSE IN WINDOW test PREF b36
   BROWSE COLOR SCHEME 3 PREF b37
   BROWSE FIELD client_id,company:R PREF b38
   BROWSE FIELD client_id,company:3 PREF b39
   BROWSE FIELD client_id,company:v=myudf() PREF b40
   BROWSE FIELD client_id,company:v=myudf():F PREF b41
   BROWSE FIELD client_id,company:v=myudf():F:E='Error' PREF b42
   BROWSE FIELD client_id,company:P='!!!!!!!' PREF b43
   BROWSE FIELD client_id,startbal:B=5,10 PREF b44
   BROWSE FIELD client_id,startbal:B=5,10:F PREF b45
   BROWSE FIELD client_id,startbal:H='Header' PREF b46
   BROWSE FIELD client_id,startbal:W=mywhen() PREF b47

</PRE>The following BROWSE commands demonstrate clauses that are not saved by the
PREFERENCE clause:
<P>
<PRE>   BROWSE FOR client_id = "A8101" PREF b4
   BROWSE KEY "A8101" PREF b7
   BROWSE NOCLEAR PREF b14
   BROWSE NOOPTIMIZE PREF b22
   BROWSE NOREFRESH PREF b23
   BROWSE NORMAL PREF b24
   BROWSE NOWAIT PREF b25
   BROWSE SAVE PREF b27
   BROWSE TIMEOUT 3 PREF b28
   BROWSE VALID :F myudf() PREF b31
   BROWSE VALID :F myudf() ERROR "Error Here" PREF b32

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following code can be used to reproduce the behavior documented in this
article.
<P>
* brtest.prg
*****************************************************************
<PRE>* This program creates a Browse window, saves the preference,   *
* and then issues BROWSE PREFERENCE &lt;prefname&gt; to verify        *
* whether or not the preference was saved. The user must        *
* pay close attention to the information that appears in        *
</PRE>* a WAIT WINDOW before each BROWSE variation, take any required *
<PRE>* action, and then compare the BROWSE PREFERENCE results.       *
</PRE>*****************************************************************
* Run Instructions:
* DO browpref IN brtest
* Use Ctrl + W or Esc to exit each BROWSE window.
* Press Esc repeatedly to terminate the program.
<P>
<P>
PROCEDURE browpref
<P>
ON KEY LABEL F10 RETURN TO browpref
ON KEY LABEL F2 DO varswap
<P>
mgood = .T.
<P>
SET RESO OFF
IF !FILE("myres.dbf")
<PRE>     USE SYS(2005) AGAIN
     COPY STRUCTURE TO myres
</PRE>ENDIF
CLOSE ALL
SET RESOURCE TO myres
CLEAR
<P>
DEFINE WINDOW test FROM 05,05 TO 20,40 TITLE "mytestwin" COLO r/w,b/r
<P>
CLOSE ALL
<P>
SET SAFETY OFF
<P>
CREATE TABLE clients (CLIENT_ID C(5),COMPANY C(35), ;
<PRE>  CONTACT C(20),ADDRESS C(30),CITY C(15),STARTBAL N(5,2))
</PRE>INSERT INTO clients (CLIENT_ID,COMPANY,CONTACT,ADDRESS,CITY, ;
<PRE>  STARTBAL) VALUES ;
  ("A8331",;
   "Advantage Computer School            ",;
   "Martin Daniels       ", ;
   "575 Howell Ln.           ;
   ","Wilmette     ",0)
     INSERT INTO clients (CLIENT_ID,COMPANY,CONTACT,ADDRESS,CITY, ;
  STARTBAL) VALUES ;
  ("A8101",;
   "Automated Mayo Miley                ",;
   "Ardew Haldeman       ",;
   "229 Drank Suite 43             ",;
   "San Diego    ",0)

</PRE>INSERT INTO clients (CLIENT_ID,COMPANY,CONTACT,ADDRESS,CITY, ;
<PRE>  STARTBAL) VALUES ;
  ("A8101",;
   "Automated Mayo Miley                ",;
   "Ardew Haldeman       ",;
   "229 Drank Suite 43             ",;
   "San Diego    ",0)
     INSERT INTO clients (CLIENT_ID,COMPANY,CONTACT,ADDRESS,CITY, ;
  STARTBAL) VALUES ;
  ("A8101",;
   "Automated Mayo Miley                ",;
   "Ardew Haldeman       ",;
   "229 Drank Suite 43             ",;
   "San Diego    ",0)
</PRE>INSERT INTO clients (CLIENT_ID,COMPANY,CONTACT,ADDRESS,CITY, ;
<PRE>  STARTBAL) VALUES ;
  ("B4876",;
   "Balance Computing Systems           ",;
   "M Rasmussen          ",;
   "7 Loop Readied                 ",;
   "Sunnyvale    ",0)

</PRE>INSERT INTO clients (CLIENT_ID,COMPANY,CONTACT,ADDRESS,CITY, ;
<PRE>  STARTBAL) VALUES ;
  ("B3615",;
  "Big Masters                         ",;
  "Dorit Springer       ",;
  "8920 Recsize Drive             ",;
  "Fairmont     ",0)
</PRE>INSERT INTO clients (CLIENT_ID,COMPANY,CONTACT,ADDRESS,CITY, ;
<PRE>  STARTBAL) VALUES ;
  ("B5620",;
  "Blue Solutions                      ",;
  "Billy Barba          ",;
  "3972 Myron Drive 7             ",;
  "Canoga Park  ",0)

</PRE>INDEX ON client_id TAG client_id
<P>
SET SAFETY ON
SET REFRESH TO 2
<P>
DO browchk
<P>
CLOSE ALL
CLEAR ALL
RELEASE ALL
<P>
RETURN
<P>
PROCEDURE browchk
<P>
BROWSE
<P>
WAIT WINDOW "BROWSE FIELDS client_id,company PREF b1"
BROWSE FIELDS client_id,company PREF b1
BROWSE PREF b1
<P>
IF _windows
<PRE>     WAIT WINDOW "BROWSE FONT 'Courier New',10 PREF b2"
     BROWSE FONT "Courier New",10 PREF b2
     BROWSE PREF b2
</PRE>ELSE
<PRE>     WAIT WINDOW "&lt;&lt;SKIP&gt;&gt; BROWSE FONT 'Courier New',10 PREF b2"
</PRE>ENDIF
<P>
IF _windows
<PRE>     WAIT WINDOW "BROWSE STYLE 'I' PREF b3"
     BROWSE STYLE "I" PREF b3
     BROWSE PREF b3
</PRE>ELSE
<PRE>     WAIT WINDOW "&lt;&lt;SKIP&gt;&gt; BROWSE STYLE 'I' PREF b3"
</PRE>ENDIF
<P>
WAIT WINDOW "BROWSE FOR client_id = A8101 PREF b4"
BROWSE FOR client_id = "A8101" PREF b4
BROWSE PREF b4
<P>
WAIT WINDOW "BROWSE FREEZE contact PREF b6"
BROWSE FREEZE contact PREF b6
BROWSE PREF b6
<P>
WAIT WINDOW "BROWSE KEY 'A8101' PREF b7"
BROWSE KEY "A8101" PREF b7
BROWSE PREF b7
<P>
WAIT WINDOW "BROWSE LEDIT PREF b8"
BROWSE PARTITION 20 LEDIT PREF b8
BROWSE PREF b8
<P>
WAIT WINDOW "BROWSE REDIT PREF b9"
BROWSE PARTITION 20 REDIT PREF b9
BROWSE PREF b9
<P>
WAIT WINDOW "BROWSE LOCK 2 PREF b10"
BROWSE LOCK 2 PREF b10
BROWSE PREF b10
<P>
WAIT WINDOW "BROWSE PARTITION 2 PREF b11"
BROWSE PARTITION 20 PREF b11
BROWSE PREF b11
<P>
WAIT WINDOW "BROWSE PARTITION 20 LPARTITION PREF b12"
BROWSE PARTITION 20 LPARTITION PREF b12
BROWSE PREF b12
<P>
WAIT WINDOW "BROWSE NOAPPEND PREF b13"
BROWSE NOAPPEND PREF b13
BROWSE PREF b13
<P>
WAIT WINDOW "BROWSE NOCLEAR PREF b14"
BROWSE NOCLEAR PREF b14
WAIT WINDOW "image should be on screen, clear next"
CLEAR
BROWSE PREF b14
WAIT WINDOW "image should be on screen, clear next"
CLEAR
<P>
WAIT WINDOW "BROWSE NODELETE PREF b15"
BROWSE NODELETE PREF b15
BROWSE PREF b15
<P>
WAIT WINDOW "BROWSE NOEDIT PREF b16"
BROWSE NOEDIT PREF b16
BROWSE PREF b16
<P>
WAIT WINDOW "BROWSE NOMODIFY PREF b17"
BROWSE NOMODIFY PREF b17
BROWSE PREF b17
<P>
WAIT WINDOW "BROWSE PARTITION 20 NOLGRID PREF b18"
BROWSE PARTITION 20 NOLGRID PREF b18
BROWSE PREF b18
<P>
WAIT WINDOW "BROWSE NORGRID PREF b19"
BROWSE NORGRID PREF b19
BROWSE PREF b19
<P>
WAIT WINDOW "BROWSE NOLINK PREF b20"
BROWSE PARTITION 20 NOLINK PREF b20
BROWSE PREF b20
<P>
WAIT WINDOW "BROWSE NOMENU PREF b21"
BROWSE NOMENU PREF b21
BROWSE PREF b21
<P>
WAIT WINDOW "BROWSE NOOPTIMIZE PREF b22"
BROWSE NOOPTIMIZE PREF b22
BROWSE PREF b22
<P>
WAIT WINDOW "BROWSE NOREFRESH PREF b23"
BROWSE NOREFRESH PREF b23
BROWSE PREF b23
<P>
WAIT WINDOW "BROWSE NORMAL PREF b24"
ACTI WIND test
BROWSE NORMAL PREF b24
BROWSE PREF b24
DEAC WIND test
<P>
WAIT WINDOW "BROWSE NOWAIT PREF b25"
BROWSE NOWAIT PREF b25
WAIT WINDOW "after br 1"
BROWSE PREF b25
WAIT WINDOW "after br 2"
<P>
WAIT WINDOW "BROWSE SAVE PREF b27"
BROWSE SAVE PREF b27
BROWSE PREF b27
<P>
WAIT WINDOW "BROWSE TIMEOUT 3 PREF b28"
BROWSE TIMEOUT 3 PREF b28
WAIT WINDOW "after browse 1"
BROWSE PREF b28
WAIT WINDOW "after browse 2"
<P>
WAIT WINDOW "BROWSE TITLE 'Hello' PREF b29"
BROWSE TITLE "Hello" PREF b29
BROWSE PREF b29
<P>
WAIT WINDOW "BROWSE VALID myudf() PREF b30"
BROWSE VALID myudf() PREF b30
BROWSE PREF b30
<P>
WAIT WINDOW "BROWSE VALID :F myudf() PREF b31"
BROWSE VALID :F myudf() PREF b31
BROWSE PREF b31
<P>
WAIT WINDOW "BROWSE VALID :F myudf() ERROR 'Error Here' PREF b32"
BROWSE VALID :F myudf() ERROR "Error Here" PREF b32
BROWSE PREF b32
<P>
WAIT WINDOW "BROWSE WHEN mywhen() PREF b33"
BROWSE WHEN mywhen() PREF b33
BROWSE PREF b33
<P>
WAIT WINDOW "BROWSE WIDTH 20 PREF b34"
BROWSE WIDTH 2 PREF b34
BROWSE PREF b34
<P>
WAIT WINDOW "BROWSE WINDOW test PREF b35"
BROWSE WINDOW test PREF b35
BROWSE PREF b35
<P>
WAIT WINDOW "BROWSE IN WINDOW test PREF b36"
ACTI WIND test
BROWSE IN WINDOW test PREF b36
BROWSE PREF b36
DEAC WIND test
<P>
WAIT WINDOW "BROWSE COLOR SCHEME 3 PREF b37"
BROWSE COLOR SCHEME 3 PREF b37
BROWSE PREF b37
<P>
WAIT WINDOW "BROWSE FIELD client_id,company:R PREF b38"
BROWSE FIELD client_id,company:R PREF b38
BROWSE PREF b38
<P>
WAIT WINDOW "BROWSE FIELD client_id,company:3 PREF b39"
BROWSE FIELD client_id,company:3 PREF b39
BROWSE PREF b39
<P>
WAIT WINDOW "BROWSE FIELD client_id,company:v=myudf() PREF b40"
BROWSE FIELD client_id,company:v=myudf() PREF b40
BROWSE PREF b40
<P>
WAIT WINDOW "BROWSE FIELD client_id,company:v=myudf():F PREF b41"
BROWSE FIELD client_id,company:v=myudf():F PREF b41
BROWSE PREF b41
<P>
WAIT WINDOW "BROWSE FIELD client_id,company:v=myudf():F:E='Error Text';
<PRE> PREF b42"
</PRE>BROWSE FIELD client_id,company:v=myudf():F:E='Error Text' PREF b42
BROWSE PREF b42
<P>
WAIT WINDOW "BROWSE FIELD client_id,company:P='!!!!!!!' PREF b43"
BROWSE FIELD client_id,company:P='!!!!!!!' PREF b43
BROWSE PREF b43
<P>
WAIT WINDOW "BROWSE FIELD client_id,startbal:B=5,10 PREF b44"
BROWSE FIELD client_id,startbal:B=5,10 PREF b44
BROWSE PREF b44
<P>
WAIT WINDOW "BROWSE FIELD client_id,startbal:B=5,10:F PREF b45"
BROWSE FIELD client_id,startbal:B=5,10:F PREF b45
BROWSE PREF b45
<P>
WAIT WINDOW "BROWSE FIELD client_id,startbal:H='Header Here' PREF b46"
BROWSE FIELD client_id,startbal:H='Header Here' PREF b46
BROWSE PREF b46
<P>
WAIT WINDOW "BROWSE FIELD client_id,startbal:W=mywhen() PREF b47"
BROWSE FIELD client_id,startbal:W=mywhen() PREF b47
BROWSE PREF b47
<P>
<P>
RETURN
<P>
FUNC myudf
<P>
<PRE>     WAIT WINDOW "We are validating"

</PRE>RETURN (mgood)
<P>
FUNC mywhen
<P>
<PRE>     WAIT WINDOW "We are in the WHEN clasue"

</PRE>RETURN .T.
<P>
PROC varswap
<P>
<PRE>     IF mgood = .T.
          mgood = .F.
     ELSE
          mgood = .T.
     ENDIF

</PRE>RETURN
<P>
* eof brtest.prg
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.50b<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
