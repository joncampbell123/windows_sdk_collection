

<HTML>
<HEAD>
<TITLE>FIX: Can't Restore Default Foxhead Icon After Set Icon Prop </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135906">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/08/29">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b fixlist5.00 FxprgGeneral vfoxwin kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After setting the Icon property of the _SCREEN object in Visual FoxPro to an icon file or to blank, you can't restore the default foxhead icon. If you set _SCREEN.Icon=  , then only a square white box is shown when Visual FoxPro is minimized when r...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QA56,QAPN,QAA8,QABA,QBJZ,QAG9,QDL9,QBWQ,QBWO,QBWN,QBXS,QAFR,QAB2,QA0J V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Can't Restore Default Foxhead Icon After Set Icon Prop</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135906</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbprg kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After setting the Icon property of the _SCREEN object in Visual FoxPro to
an icon file or to blank, you can't restore the default foxhead icon. If
you set _SCREEN.Icon="", then only a square white box is shown when Visual
FoxPro is minimized when running under Windows 3.x or Windows NT. In
Windows 95, the icon shown on the task bar button for the minimized Visual
FoxPro, is a generic gray button that looks like a program window with a
blue title bar. These same incorrect icons show up when switching tasks by
pressing ALT+TAB.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are at least two known workarounds for this, each one with its own
advantages and disadvantages.
<P>
<P><h3>Workaround One</h3>
 
<P>
Use the MODIFY WINDOW SCREEN command without any clauses to set the Visual
FoxPro icon back to the default foxhead. The main drawback of this method
is that other properties of the _SCREEN object are also set back to their
defaults. Therefore, _SCREEN.Picture, _SCREEN.Fontname, _SCREEN.Caption,
and so on are set back to their defaults. An additional side effect of this
is that the Picture and Icon properties of the _SCREEN object will still
report the user defined values even though the defaults show up visually
(no picture and the foxhead icon). To work around this drawback, you can
save the necessary properties of the _SCREEN object in variables, and then
restore them after using the MODIFY WINDOW SCREEN command. The following
commands can be issued in the Command window to illustrate this:
<P>
<PRE>   _SCREEN.Icon=HOME()+"samples\graphics\icons\flag\ctrcan.ico"
   _SCREEN.Picture=HOME()+"fox.bmp"
   _SCREEN.Fontname="Wingdings"
   _SCREEN.Fontsize=16
   cScrPic=_SCREEN.Picture
   cScrFont=_SCREEN.Fontname
   nScrFontsz=_SCREEN.Fontsize
   * Minimize Visual FoxPro and check the icon. Restore Visual FoxPro.
   MODIFY WINDOW SCREEN
   * Minimize Visual FoxPro and check the icon. Restore Visual FoxPro.
   ? _SCREEN.Picture      &amp;&amp; this returns the name of the picture file
   *                         even though the picture isn't displayed
   ? _SCREEN.Icon         &amp;&amp; this returns the name of the icon file even
   *                         though the icon is now the default icon
   ? _SCREEN.Fontname     &amp;&amp; this should be Arial
   ? _SCREEN.Fontsize     &amp;&amp; this should be 10
   * The next three commands restore the specified settings:
   _SCREEN.Picture=cScrPic
   _SCREEN.Fontname=cScrFont
   _SCREEN.Fontsize=nScrFontsz

</PRE><h3>Workaround Two</h3>
 
<P>
Create a foxhead icon file and set the _SCREEN.Icon property to that icon
file. You can change the Fox.bmp bitmap file (located in the VFP directory)
to an icon file by using the Imagedit program that comes with the
Professional Edition of Visual FoxPro. The main drawbacks for this
workaround are that the icon file will not have a transparent background
and the resolution isn't as good as the default icon built into Visual
FoxPro.
<P>
Steps to convert the Fox.bmp file to an icon file:

<OL><P><LI>Start Imagedit and open the VFP\Fox.bmp file.

<P><LI>On the Edit menu in Imagedit, click Copy.

<P><LI>On the File menu in Imagedit, click New, and create a new icon file.
   Choose the "EGA/VGA 16-Color 32x32" option for the icon file.

<P><LI>On the Edit menu, click Paste. In the Paste From Clipboard dialog box,
   choose either option. The "Stretch/shrink clipboard bitmap?" option
   produces a larger icon but it won't look as good as the "Clip clipboard
   bitmap?" option. Both will have white backgrounds and this will show
   when using the icon in Visual FoxPro. The background can be changed to
   black, but that will also appear when it is used in Visual FoxPro if the
   Windows desktop is other than black.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In FoxPro version 2.x for Windows, the MODIFY WINDOW SCREEN command can be
used to set what are now many of the properties of the _SCREEN object. The
_SCREEN object is the system memory variable that refers to the Visual
FoxPro application window. Some of the _SCREEN properties and the
corresponding clauses for the MODIFY WINDOW SCREEN command are:
<P>
<PRE>_SCREEN Property     MODIFY WINDOW Clause
</PRE></OL> 
<PRE>Caption              Title
Picture              Fill File
Icon                 Icon File
FontName             Font

</PRE>For more information, please use the Visual FoxPro Help menu and search for
_SCREEN and the MODIFY WINDOW command.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new session of Visual FoxPro. If running Visual FoxPro under
   Windows 3.x or Windows NT, minimize Visual FoxPro and any other running
   programs, including Program Manager, and note that Visual FoxPro has the
   foxhead icon on the desktop. In Windows 95, look on the status bar to
   see the default foxhead icon. Under all platforms, press ALT+TAB to
   switch tasks and see the default foxhead icon.

<P><LI>In the Visual FoxPro Command window, type:
<P>
<P><PRE>    _SCREEN.Icon=""
</PRE>
<P><LI>Repeat step 1. This time notice that the icon is either a square white
   box under Windows 3.x or Windows NT, or it is a generic gray button that
   looks like a program window with a blue title bar under Windows 95.

<P><LI>In the Visual FoxPro Command window, type the following command to get
   the default foxhead icon back:
<P>
   MODIFY WINDOW SCREEN
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: FxprgGeneral VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b<BR>
Keywords          : buglist3.00 buglist3.00b fixlist5.00 FxprgGeneral vfoxwin kbbuglist kbfixlist kbprg<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
