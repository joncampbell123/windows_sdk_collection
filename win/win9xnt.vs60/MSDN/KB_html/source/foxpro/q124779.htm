

<HTML>
<HEAD>
<TITLE>How to Simulate a Combo Box in FoxPro for Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124779">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/01/11">
<META NAME="Keywords" CONTENT="kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A combo box is a object into which you can enter data directly or select an item from a predefined drop-down list. FoxPro does not have a combo box option to choose when making a screen, but you can use the technique presented in this article to si...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QBV3,QAH4,QAHP,QAPN,QACF,QAFX,QAAF,QA7O,QA7N,QAY2,QAW6,QAUD,QBFM,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Simulate a Combo Box in FoxPro for Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124779</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A combo box is a object into which you can enter data directly or select an
item from a predefined drop-down list. FoxPro does not have a combo box
option to choose when making a screen, but you can use the technique
presented in this article to simulate a combo box in FoxPro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code in the VALID clause of the GET object will vary depending on where
the information for the drop-down list comes from: arrays, a field from a
table, or defining bars for the popup box. Use the following steps to make
a combo box by using a popup with a predefined list:

<OL><P><LI>Create a screen in FoxPro, and add a GET object to the screen, giving it
   the variable name of COMBO. Make sure it is a character field.

<P><LI>In the VALID clause of the object COMBO, add the following code:
<P>
   IF EMPTY(combo)
<P><PRE>      DEFINE POPUP combobox FROM 7,25 to 14,50
      DEFINE BAR 1 OF combobox PROMPT 'Choice 1'
      DEFINE BAR 2 OF combobox PROMPT 'Choice 2'
      DEFINE BAR 3 OF combobox PROMPT 'Choice 3'
      DEFINE BAR 4 OF combobox PROMPT 'Choice 4'
      DEFINE BAR 5 OF combobox PROMPT 'Choice 5'
      ON selection popup combobox DO getcombo WITH PROMPT()
      ACTIVATE POPUP combobox
</PRE>   ENDIF
   SHOW GETS

<P><LI>In the cleanup code of the screen, add the following code:
<P>
   PROCEDURE getcombo
<P>
   PARAMETER mprompt
   combo=mprompt
<PRE>   KEYBOARD '{TAB}'           &amp;&amp; Moves you off of the popup after
                              &amp;&amp;pressing ENTER to select your choice.

</PRE><P><LI>Add a push button to the screen; call it EXIT. In the VALID clause,
   put the code CLEAR READ.
<P>
</OL>After generating and running the screen, you will see that the object that
represents the combo box is blank. If information is not typed into the
object before the ENTER key is pressed, the code in the VALID clause of the
field is executed and the popup appears.
<P>
Adjust the coordinates in the DEFINE POPUP statement if you want the popup
to overlay the get field exactly. The example code shows how to define bars
for the popup. If you want information from a field to be listed in the
popup, change the code as indicated below.
<P>
NOTE: This code uses the CUSTOMER.DBF file located in the TUTORIAL
subdirectory of FoxPro.
<P>
In the VALID clause of the COMBO GET object, change the code to match this:
<P>
<PRE>   IF EMPTY(combo)
      DEFINE POPUP combobox PROMPT FIELD cno FROM 6,29 TO 12,43
      ON SELECTION POPUP combobox DO getcombo
      ACTIVATE POPUP combobox
   ENDIF
   SHOW GETS

</PRE></OL>In the cleanup code, change the code to match this:
<P>
<PRE>   PROCEDURE getcombo

   combo=&lt;fieldname&gt;     &amp;&amp; This is the fieldname that follows the PROMPT
                         &amp;&amp; FIELD clause in the DEFINE POPUP
   KEYBOARD '{TAB}'

</PRE>This revised code fills the popup with the information from all the records
in that table of that field. Again, to position the popup on the screen
where you want it, experiment with the numbers of the DEFINE POPUP
statement.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin SBuilder 2.60a<BR>
KBCategory: kbtool kbprb kbcode<BR>
KBSubcategory: FxtoolSbuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
