

<HTML>
<HEAD>
<TITLE>How to Insert Records in SQL Table Using Connectivity Kit </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113753">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/04/13">
<META NAME="Keywords" CONTENT="kbinterop kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  By using the FoxPro Connectivity Kit's DBExec() command, you can insert records in a native platform's database that you are connecting to.  MORE INFORMATION  Using the standard SQL INSERT command with the Connectivity Kit's DBExec() command, you c...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QACI,QA9N,QAH4,QDMF,QAZV,QABM,QBG2,QAB9,QAKP,QBXS,QADN,QAB4,QAAP,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Insert Records in SQL Table Using Connectivity Kit</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113753</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro Connectivity Kit, version 2.5
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, and 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, and 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By using the FoxPro Connectivity Kit's DBExec() command, you can insert
records in a native platform's database that you are connecting to.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Using the standard SQL INSERT command with the Connectivity Kit's DBExec()
command, you can insert records into a table that exists on the native
platform. "Native platform" refers to the DBMS that you are connecting to.
<P>
In the example below, the source is SQL Server and the code example
inserts a record in the sales table in the pubs database.
<P>
With minor modifications, this same code can be used to insert a new record
in an Oracle database or in any other data source that may be in use.
<P>
NOTE: If you have problems running the following code in FoxPro for MS-DOS,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q112482.htm">Q112482</A></B>
   TITLE     : How to Make an MS-DOS Level SQL Server Connection

</PRE><h3>Code Sample</h3>
 
<P>
<PRE> *****SET THE LIBRARY AND INITIALIZE VARS
   IF _DOS
      SET LIBRARY TO SYS(2004)+"fpsql.plb"
   ELSE
      SET LIBRARY TO SYS(2004)+"fpsql.fll"
   ENDIF

   PUBLIC errval
   PUBLIC errmsg
   PUBLIC handle
   PUBLIC do_more

   errval=0
   errmsg=' '
   do_more=.T.

   *****SOURCE INFORMATION
   sourcename= 'test'
   user= 'sa'
   passwd=''

   *****CONNECT

   handle=DBConnect(sourcename,user,passwd)
   IF handle &gt; 0
      WAIT WINDOW 'Successfully Connected'
   ELSE
      error=DBError(0,@errmsg,@errval)
      WAIT WINDOW STR(error)+' '+STR(errval)+' '+errmsg
      do_more=.F.
   ENDIF

   IF do_more=.T.
      *****SET SESSION DEFAULTS

      =DBSetOpt(handle,'Asynchronous',0)
      =DBSetOpt(handle,'BatchMode',1)
      =DBSetOpt(handle,'ConnTimeout',0)
      =DBSetOpt(handle,'Transact',1)
      =DBSetOpt(handle,'UseTable',0)

      *****USE THE PUBS DATABASE ON SQL SERVER; On SQL Server
      *****it is necessary to open the pubs database
      *****in order to insert a record into the sales table that is
      *****in the pubs database.  In other words, databases
      *****on SQL Server contain tables and we are inserting
      *****into a table that is part of the pubs database.

      err=DBExec(handle,'use pubs')
      DO errhand WITH err,'USE PUBS'

      *****INSERT_IT-- THE PROCEDURE THAT INSERTS RECORDS INTO
      *****THE SALES TABLE.

      DO insert_it

      *****Displays the change made after the insert is completed.

      sqlcomm= 'select * from sales'
      err=DBExec(handle,sqlcomm)
      DO errhand WITH err,"DBExec(handle,"+sqlcomm+")"

      IF err &gt; 0
         WAIT WINDOW 'PRESS ESC TO CLEAR BROWSE WINDOW AND TO DISCONNECT'
         BROWSE
      ENDIF

      *****DISCONNECT

      err=DBDisconn(handle)
      DO errhand WITH err,"DBDisconn()"
      SET LIBRARY TO
      CLOSE ALL
   ENDIF

   *****Simple Error Handler Program
   PROCEDURE errhand
   PARAMETERS err,command
      IF err &gt; 0
         WAIT WINDOW ALLTRIM(UPPER(command))+" Completed Successfully"
      ELSE
         ? UPPER(ALLTRIM(command))+" NOT Completed Successfully"
         error=DBError(handle,@errmsg,@errval)
         ? ALLTRIM(STR(error))+" "+ALLTRIM(STR(errval))+" " ;
           + ALLTRIM(errmsg)
      ENDIF
   RETURN

   *****THE DBExec() FUNCTION IS USED TO INSERT A RECORD

   PROCEDURE insert_it

      m.stor_id="0000"
      m.ord_num="QA7442.3"
      m.date="09/13/85"
      m.qty="75"
      m.payterms="Pauls Play"
      m.title_id="PS2091"

      insertcomm= "insert sales ;
                values ("+"'"+ALLTRIM(m.stor_id)+"',"+ ;
                          "'"+ALLTRIM(m.ord_num)+"',"+;
                          "'"+ALLTRIM(m.date)+"',"+;
                          + ALLTRIM(m.qty)+","+;
                          "'"+ALLTRIM(m.payterms)+"',"+;
                          "'"+ALLTRIM(m.title_id)+"'"+")"

      err=DBExec(handle,insertcomm)
      DO errhand WITH err,"DBExec(handle,"+insertcomm+")"
      IF err &gt; 0
         WAIT WINDOW 'Insert went ok'
      ENDIF

   RETURN
   * End of Code
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.50 2.50a 2.50b 2.60 ODBC CK<BR>
KBCategory: kbinterop kbtool kbprg kbcode<BR>
KBSubcategory: FxtoolCk<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
