

<HTML>
<HEAD>
<TITLE>Printing Reports Created w/ Question Marks in FP for Win </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99542 ">
<META NAME="KBModify" CONTENT="1996/05/20">
<META NAME="KBCreate" CONTENT="1993/06/02">
<META NAME="Keywords" CONTENT="kbprint">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT=" You may have reports (commonly xBASE-programmed) that used to print correctly but now do not align properly. This problem may occur because of the use of proportional fonts in Windows.  The following two methods allow FoxPro for Windows to print rep...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QADF,QBXS,QBTC,QAH4,QDL9,QBWQ,QBWO,QBWN,QACT,QA56,QA55,QAPN,QAB5,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Printing Reports Created w/ Question Marks in FP for Win</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99542 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
You may have reports (commonly xBASE-programmed) that used to print
correctly but now do not align properly. This problem may occur because of
the use of proportional fonts in Windows.
<P>
The following two methods allow FoxPro for Windows to print reports that
are created using ? commands and also send escape codes to the printer.
<P>
<P><h3>Method If You Previously Used FoxPro for MS-DOS</h3>
 
<P>
NOTE: For the following method to work correctly, you must have had FoxPro
2.0 or 2.5 for MS-DOS previously installed and have an existing 2.0 or 2.5
printer driver in the current resource file. Loading the printer driver
provides hooks into the GENPD.APP program, which is used for MS-DOS-style
printing. The GENPD.APP program is not available with Visual FoxPro.

<OL><P><LI>Turn off all open print commands by issuing SET DEVICE TO SCREEN and SET
   PRINTER TO commands.

<P><LI>Load an existing FoxPro for MS-DOS version 2.0 or 2.5 printer driver
   that is in the current resource file. The sample program below uses an
   existing printer driver named HPCOMPRESS. This printer driver opens the
   printer in "raw mode," which bypasses the Windows printer drivers.

<P><LI>Issue a SET PRINT ON command, which redirects any question mark (?)
   output to the printer.

<P><LI>At the end of the report code, issue a SET PRINTER TO command to clear
   the raw mode and begin using Windows printer drivers again.
<P>
</OL>The following code illustrates the above steps:
<P>
<PRE>   SET DEVICE TO SCREEN
   SET PRINTER TO
   SET PDSETUP TO "hpcompress"
   SET PRINT ON
   ? _pdparms(15)    &amp;&amp; This is an example of using _PDPARMs and
                     &amp;&amp; escape codes to control printing attributes.
                     &amp;&amp; This is for turning italics on.

   ?"Hello"
   ? chr(27)+"(s16.66H" &amp;&amp; This is an example of sending a control
                        &amp;&amp; sequence directly.
   ?"There"
   EJECT
   SET PRINTER TO
   SET LIBRARY TO
   SET PDSETUP TO

</PRE></OL><h3>Method If You Use Only FoxPro for Windows or Visual FoxPro for Windows</h3>
 
<P>
If you do not have access to FoxPro for MS-DOS and its drivers, you can
accomplish the same result by doing either of the following:

<UL><LI>Setting the Windows output to Generic/Text only.
<P>
   -or-

<LI>Selecting one of the monospace (nonproportional) fonts (such as Courier,
   FoxFont, or FoxPrint) by issuing the SET PRINT FONT "&lt;fontname&gt;",10
   command. This method is also valid for reports being to Visual FoxPro
   for Macintosh.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: vFoxMac 3.00b VFoxWin 3.00  FoxWin 2.50 2.50a<BR>
pdparms FOXPROW<BR>
KBCategory: kbprint<BR>
KBSubcategory: FxprintRaw<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
