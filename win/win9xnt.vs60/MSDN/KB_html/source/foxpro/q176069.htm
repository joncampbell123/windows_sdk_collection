

<HTML>
<HEAD>
<TITLE>HOWTO: Printing a Range of Pages in Word Using OLE Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176069">
<META NAME="KBModify" CONTENT="1997/11/14">
<META NAME="KBCreate" CONTENT="1997/10/31">
<META NAME="Keywords" CONTENT="FxinteropOle FxprgGeneral vfoxwin kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Printing either a range or selection of pages in a Word for Windows document from Visual FoxPro for Windows using OLE automation requires additional parameters for the PrintOut method of Word for Windows 97 or the FilePrint command in Word for Wind...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QDMR,QAPN,QAOX,QAHE,QBWA,QDL9,QBWQ,QBWO,QBWN,QDO7,QDNZ,QAI4,QAJB,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Printing a Range of Pages in Word Using OLE Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176069</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Visual Studio versions 97, 97sp2
<LI>Microsoft Visual FoxPro for Windows, versions 3.0b, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Printing either a range or selection of pages in a Word for Windows
document from Visual FoxPro for Windows using OLE automation requires
additional parameters for the PrintOut method of Word for Windows 97 or the
FilePrint command in Word for Windows 95.
<P>
All the parameters passed to Word in an OLE automation statement are
positional. For example, the Range parameter is the third argument out of
15 in the parameter list for the Printout method. Therefore, arguments 1
and 2 must have the appropriate value for the argument and cannot be left
out. However, any arguments past the last argument with a value do not need
to be included in the command. For example, if no other parameters require
a value after the Range is set, then Range could be the last argument
passed to the PrintOut method.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code samples in this article are written to run exclusively with a
particular version of Word. The examples for Word for Windows 95 were
written to work with both Visual FoxPro for Windows versions 3.0b and 5.0a.
The Word 97 example work only with Visual FoxPro for Windows version 5.0a
with Service Pack 2 installed. If the code is used with any other version
of Word or Visual FoxPro for Windows, the following OLE error may occur:
<P>
<PRE>   OLE error code 0x80020005: Type Mismatch.

</PRE>The Range parameter accepts five valid values. Therefore, unless the Range
parameter is properly set, Word will not print. The valid Range values are
listed below with a description of the their action:
<P>
<PRE>   0 Prints the entire document
   1 Prints the selection
   2 Prints the current page
   3 Prints the range of pages specified by the From and To parameters
   4 Prints the range of pages specified by Pages parameter

</PRE>For more information on the FilePrint command in Word 95 and PrintOut
command in Word 97, see the Word for Windows documentation. The format of
the Word 97 PrintOut method and the Word 95 FilePrint command are listed
below:
<P>
<PRE>   PrintOut(Background, Append, Range, OutputFileName, From, To,
   Item, Copies, Pages, PageType, PrintToFile, Collate, FileName,
   ActivePrinterMacGX, ManualDuplexPrint)

   FilePrint(.Background, .AppendPrFile, .Range, .PrToFileName, .From,
   .To, .Type, .NumCopies, .Pages, .Order, .PrintToFile, .Collate,
   .FileName, .OutputPrinter)

</PRE>In the code examples below a Word document named Testdoc.doc is used that
contains at least 10 pages.
<P>
Printing Contiguous Range of pages
 
<P>
There are two ways to print a contiguous range of pages using the Range
parameter. Both methods depend on the value of Range. For instance, if the
Range is set to 3, then set the From and To parameters. If the Range is 4,
use the Pages parameter. Both methods are discussed below. In each code
example, the FilePrint and PrintOut commands are shown using both variables
and the explicit values for the arguments. This provides a better
representation of the positions these arguments will take in the statement.
The command using variables is commented out.
<P>
Method 1: Range Argument Set to 3
 
<P>
With the Range set to 3, the From and To parameters need to set for both
the PrintOut method in Word 97 and FilePrint command in Word 95.
<P>
For example, to print pages 4 through 8 of Testdoc.doc use the following
Code.
<P>
NOTE: This works with Word 95 and Visual FoxPro for Windows versions 3.0
and 5.0.
<P>
<PRE>     range = "3"
     from = "4"
     to = "8"
     oword = CreateObject("Word.Basic")
     WITH oword
      .FileOpen("C:\winword\testdoc.doc")   &amp;&amp; Enter appropriate path.

      * FilePrint statement using variables.
      *.FilePrint(0,"0","",0,range,"",from,to)

      * FilePrint using explicit values
      .FilePrint(0,"0","",0,"3","","4","8")
      .FileClose(2)
     ENDWITH
     oword=""

</PRE>NOTE:  This works with Word 97 and Visual FoxPro for Windows version 5.0a
with Service Pack 2:
<P>
<PRE>     range = "3"
     from = "4"
     to = "8"
     oword = CreateObject("Word.Application")
     WITH oword
      .Documents.Open("C:\winword\testdoc.doc")  &amp;&amp; Enter appropriate path.

      * PrintOut statement using variables
      *.ActiveDocument.PrintOut(0,0,range,"",from,to)

      * PrintOut using explicit values
      .ActiveDocument.PrintOut(0,0,"3","","4","8")
      .Quit
     ENDWITH

</PRE>Method 2: Range Argument Set to 4
 
<P>
Assign 4 to the Range argument, then assign the pages to be printed to the
Pages argument. To print pages 4 through 8, the Pages argument would be "4-
8."
<P>
NOTE: This works with Word 95 and Visual FoxPro for Windows versions 3.0
and 5.0:
<P>
<PRE>     range = "4"
     pages = "4-8"
     oword = CreateObject("Word.Basic")
     WITH oword
      .FileOpen("C:\winword\testdoc.doc")   &amp;&amp; Enter appropriate path.

      * FilePrint statement using variables.
      *.FilePrint(0,"0","",0,range,"","","",0,1,pages)

      * FilePrint using explicit values
      .FilePrint(0,"0","",0,"4","","","",0,1,"4-8")
      .FileClose(2)
     ENDWITH
     oword=""

</PRE>NOTE: This works with Word 97 and Visual FoxPro for Windows version 5.0a
with Service Pack 2:
<P>
<PRE>     range = "4"
     pages = "4-8"
     oword = CreateObject("Word.Application")
     WITH oword
      .Documents.Open("C:\winword\testdoc.doc")  &amp;&amp; Enter appropriate path.

      * PrintOut statement using variables
      *.ActiveDocument.PrintOut(0,0,range,"","","",0,1,pages)

      * PrintOut using explicit values
      .ActiveDocument.PrintOut(0,0,"4","","6","8",0,1,"4-8")
      .Quit
     ENDWITH

</PRE>Printing Non-Contiguous Range of Pages
 
<P>
To print non-contiguous pages, set the Range parameter to 4 and the Pages
parameter to the pages to print. For example, to print page 2 and then
pages 6 through 9, the Pages argument would be "2,6-9." The Pages parameter
is set the same for both Word 95 and Word 97.
<P>
NOTE: This works in Word 95 and Visual FoxPro for Windows versions 3.0 and
5.0:
<P>
<PRE>     range = "4"
     pages = "2,6-9"
     oword = CreateObject("Word.Basic")
     WITH oword
      .FileOpen("C:\winword\testdoc.doc")   &amp;&amp; Enter appropriate path.

      * FilePrint statement using variables.
      *.FilePrint(0,"0","",0,range,"","","",0,1,pages)

      * FilePrint using explicit values
      .FilePrint(0,"0","",0,"4","","","",0,1,"2,6-9")
      .FileClose(2)
     ENDWITH
     oword=""

</PRE>NOTE: This works with Word 97 and Visual FoxPro for Windows version 5.0a
with Service Pack 2:
<P>
<PRE>     range = "4"
     pages = "2,6-9"
     oword = CreateObject("Word.Application")
     WITH oword
      .Documents.Open("C:\winword\testdoc.doc")  &amp;&amp; Enter appropriate path.

      * PrintOut statement using variables
      *.ActiveDocument.PrintOut(0,0,range,"","","",0,1,pages)

      * PrintOut using explicit values
      .ActiveDocument.PrintOut(0,0,"4","","","",0,1,"2,6-9")
      .Quit
      ENDWITH


</PRE>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by Dean
Christopher, Microsoft Corporation
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Word Visual Basic Help
<P>
 
<PRE>Keywords          : FxinteropOle FxprgGeneral vfoxwin kbcode
Version           : WINDOWS:3.0b,5.0a,7.0,7.0a,97; WINNT:97,97sp2
Platform          : WINDOWS winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
