

<HTML>
<HEAD>
<TITLE>How To Optimize SQL Using the FORCE Clause and SYS(3054) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155788">
<META NAME="KBModify" CONTENT="1997/01/20">
<META NAME="KBCreate" CONTENT="1996/09/09">
<META NAME="Keywords" CONTENT="kbusage kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Visual FoxPro 5.0 has a new clause--the FORCE clause--in the SELECT - SQL command. You can use the FORCE clause to override the default query optimization that Visual FoxPro performs.  The FORCE clause specifies that tables are joined in the order ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA63,QAPN,QA4H,QA2Q,QAB9,QA56,QA55,QAG2,QA26,QABM,QAB6,QBWS,QAY2,QAL3,QADK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Optimize SQL Using the FORCE Clause and SYS(3054)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155788</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual FoxPro 5.0 has a new clause--the FORCE clause--in the SELECT - SQL
command. You can use the FORCE clause to override the default query
optimization that Visual FoxPro performs.
<P>
The FORCE clause specifies that tables are joined in the order in which
they appear in the FROM clause. If the FORCE clause is omitted, Visual
FoxPro attempts to optimize the query. However, Visual FoxPro might execute
the query faster by including the FORCE clause to disable the Visual FoxPro
query optimization.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When a SQL statement is processed, the SQL optimizer determines the most
efficient way to join the tables. There are times when you have a better
understanding of the data structures than FoxPro. The FORCE clause, tells
Visual FoxPro that the SELECT statement is optimized and that it does not
need to be further changed.
<P>
In order to use FORCE clause, you must use the ANSI join syntax within the
FROM clause. Any conditions within the WHERE clause are not subject to the
FORCE clause. When the FORCE clause is positioned, it is global to all
listed joins. The order in which the Join tables appear in the statement is
the order in which they are joined. The following statements, therefore,
may produce different performance results:
<P>
SELECT * ;
FROM FORCE customer JOIN(orders JOIN orditems ;
ON orditems.order_id=orders.order_id) ;
ON orders.customer_id=customer.customer_id
<P>
SELECT * ;
FROM FORCE customer JOIN orders ;
ON orders.customer_id=customer.customer_id ;
JOIN orditems ;
ON orditems.order_id=orders.order_id
<P>
In the first SELECT statement, the orders and orditems tables are joined
and the result is joined to the customer table. In the second statement,
the customer table is joined with the orders table first. The result is
then joined with the orditems table.
<P>
In order to make the decision to Force a join condition, you can use the
SYS(3054) function to determine the extent to which the query is optimized
by Rushmore technology. For example, you can issue the following command
before the SELECT statement to determine the internal optimization plan for
the query:
<P>
? SYS(3054,1)
SELECT * FROM customer JOIN orders;
ON customer.customer_id=orders.customer_id ;
WHERE UPPER(country)="USA"
<P>
SYS(3054) returns information, such as the index tag used to optimize the
join as well as the optimization level for each table, whether it be
<PRE>'full,' 'partial,' or 'none.'

</PRE>Sometimes, you can determine the best optimization level by trial and
error. Try running the SQL statement with and without the FORCE clause to
see if there is a significant change in performance. Make sure to clear the
environment between SELECT statements so that caching does not effect the
outcome of successive queries.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbprg kbhowto<BR>
KBSubcategory: FxprgSql<BR>
Additional reference words: 5.00 kbdse vfoxwin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
