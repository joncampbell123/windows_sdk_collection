

<HTML>
<HEAD>
<TITLE>HOWTO: Alter the Properties of a View at Run Time </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178760">
<META NAME="KBModify" CONTENT="1998/01/08">
<META NAME="KBCreate" CONTENT="1998/01/02">
<META NAME="Keywords" CONTENT="FxprgGeneral VFoxMac vfoxwin kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Under some circumstances, it may be desirable to modify the properties of a view at run time. This article describes the properties and default property values associated with a view. The sample code illustrates how to create a view and use the DBS...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADK,QAPN,QBWT,QABA,QA7O,QA7N,QA56,QA55,QAKD,QAH4,QATX,QBWS,QBXS,QAY2,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Alter the Properties of a View at Run Time</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178760</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Under some circumstances, it may be desirable to modify the properties of a
view at run time. This article describes the properties and default
property values associated with a view. The sample code illustrates how to
create a view and use the DBSETPROP() function to alter the properties of
the view programmatically.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The properties of a view created with the View Designer are readily
accessible from the View Designer. The properties of a view created
programmatically, however, use default values unless those values are
changed either programmatically or from the View Designer.
<P>
The default values of a view created programmatically are as follows:
<P>
<PRE>   Property Name            Default Value
   --------------------------------------

   SendUpdates              .F. (False)
   UpdateType               1 SQL Update
   WhereType                3 Key and Modified Fields
   BatchUpdateCount         1
   UseMemoSize              255
   FetchSize                100
   FetchMemo                .T. (True)
   MaxRecords               -1 (All)
   Tables                   Database Container and Table Name
   Comment                  Null String
   Prepared                 .F. (False)
   CompareMemo              .T. (True)
   FetchAsNeeded            .F. (False)


   View Field Properties    Default Value
   -------------------------------------

   KeyField                 .T. (True if the field is a Primary Key)
                            .F. (False if the field is not a Primary Key)
   Updatable                .F. (False)
   UpdateName               Database Container, Table Name And Field Name
   DataType                 Same as source field
   Caption                  Null String
   RuleExpression           Null String
   RuleText                 Null String
   Default                  Null String


</PRE>The following View Properties are not available in Visual FoxPro 3.0 or
Visual FoxPro 3.0b:
<P>
<PRE>   Prepared
   CompareMemo
   FetchAsNeeded


</PRE>The following sample code creates a view based on the Customer table
contained in the \Samples\Data subdirectory of the Visual FoxPro
installation folder:
<P>

<OL><P><LI>Create a program called Makeview.prg using the following code:
<P>
<P><PRE>      thisversion=VERSION()
      IF LEFT(ALLTRIM(thisversion),6)="Visual"
<PRE></PRE>        thisversion=VAL(SUBSTR(thisversion,15,2))
      ELSE
        thisversion=0
      ENDIF
      SET EXCLUSIVE ON
      SET MULTILOCKS ON
      OPEN DATABASE home()+"\SAMPLES\DATA\TESTDATA"
      CREATE SQL VIEW customerview ;
       AS SELECT DISTINCT cust_id, company, contact ;
      FROM testdata!customer ;
      ORDER BY customer.cust_id
      * Set view properties.
      =DBSETPROP('CUSTOMERVIEW','View','SendUpdates',.T.)
      =DBSETPROP('CUSTOMERVIEW','View','UpdateType',2)
      =DBSETPROP('CUSTOMERVIEW','View','WhereType',1)
      =DBSETPROP('CUSTOMERVIEW','View','BatchUpdateCount',3)
      =DBSETPROP('CUSTOMERVIEW','View','UseMemoSize',255)
      =DBSETPROP('CUSTOMERVIEW','View','FetchSize',100)
      =DBSETPROP('CUSTOMERVIEW','View','FetchMemo',.T.)
      =DBSETPROP('CUSTOMERVIEW','View','MaxRecords',10)
      =DBSETPROP('CUSTOMERVIEW','View','Tables','CUSTOMER')
      =DBSETPROP('CUSTOMERVIEW','View','Comment',"Demonstration View")
      IF thisversion&gt;=5
      =DBSETPROP('CUSTOMERVIEW','View','Prepared',.F.)
      =DBSETPROP('CUSTOMERVIEW','View','CompareMemo',.T.)
      =DBSETPROP('CUSTOMERVIEW','View','FetchAsNeeded',.T.)
      ENDIF
      SELECT customer
      USE
      * Set Key and Updatable fields.
      =DBSETPROP('CUSTOMERVIEW.Cust_id','Field','KeyField',.T.)
      =DBSETPROP('CUSTOMERVIEW.Cust_id','Field','Updatable',.T.)
      =DBSETPROP('CUSTOMERVIEW.Cust_id','Field','UpdateName', ;
      'CUSTOMER.Cust_id')
      =DBSETPROP('CUSTOMERVIEW.Cust_id','Field','DataType',"C(12)")
      =DBSETPROP('CUSTOMERVIEW.Cust_id','Field','Caption','Primary Key')
      =DBSETPROP('CUSTOMERVIEW.Company','Field','KeyField',.F.)
      =DBSETPROP('CUSTOMERVIEW.Company','Field','Updatable',.T.)
      =DBSETPROP('CUSTOMERVIEW.Company','Field','UpdateName', ;
      'CUSTOMER.Company')
      =DBSETPROP('CUSTOMERVIEW.Company','Field','DataType',"N(15,2)")
      =DBSETPROP('CUSTOMERVIEW.Company','Field','Caption','Company Name')
      =DBSETPROP('CUSTOMERVIEW.Contact','Field','KeyField',.F.)
      =DBSETPROP('CUSTOMERVIEW.Contact','Field','Updatable',.F.)
      =DBSETPROP('CUSTOMERVIEW.Contact','Field','UpdateName', ;
      'CUSTOMER.Contact')
      =DBSETPROP('CUSTOMERVIEW.Contact','Field','DataType',"N(15,2)")
      =DBSETPROP('CUSTOMERVIEW.Contact','Field','Caption','Contact Name')
      USE customerview
      BROWSE
      RETURN

</PRE><P><LI>From the Command window, type:
<P>
<P><PRE>      DO Makeview.prg
</PRE><P>
   The program creates an updateable view based on the Customer table.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : FxprgGeneral VFoxMac vfoxwin kbcode<BR>
Version           : MACINTOSH:3.0b; WINDOWS:3.0,3.0b,5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
