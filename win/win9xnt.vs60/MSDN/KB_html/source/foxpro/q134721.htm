

<HTML>
<HEAD>
<TITLE>How to Handle Visual FoxPro Connectivity Errors w/o DBERROR() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134721">
<META NAME="KBModify" CONTENT="1995/09/01">
<META NAME="KBCreate" CONTENT="1995/08/10">
<META NAME="Keywords" CONTENT="kbprg kbtool kbinterop kbcode kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The DBERROR() function from previous versions no longer exists nor does an equivalent SQLERROR() function that you might expect to find. There are still ways to find out the same information though. The function AERROR() is used throughout the prod...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QAY5,QAJQ,QBG2,QBV8,QAB9,QAA1,QBXS,QA56,QA55,QAUD,QAPN,QAI5,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Handle Visual FoxPro Connectivity Errors w/o DBERROR()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 1, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134721</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The DBERROR() function from previous versions no longer exists nor does an
equivalent SQLERROR() function that you might expect to find. There are
still ways to find out the same information though. The function AERROR()
is used throughout the product for retrieving error information and the
SQLSETPROP() function also gives us some control over the SQL error
messages specifically.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>First Method</h3>
 
<P>
Using Aerror() will create an array containing the error code and error
message. It could be implemented as follows for catching the full ODBC
error that occurs when connecting to a datasource :
<P>
****************************
*  Example of using AERROR()
*
dsource='test'
Handle=SQLCONNECT(dsource,"","")
IF HANDLE&lt;0
<PRE>     retval=AERROR(atmp)
     errval=atmp(1,1)
     errmsg=atmp(1,2)
     WAIT WINDOW STR(ERRVAL)+": "+ERRMSG
</PRE>ENDIF
<P>
<P><h3>Second Method</h3>
 
<P>
Setting up similar error trapping would be to use the SQLSetProp() function
to set the DispWarning property to True. This will actually be easier than
the old DBError() function because once this is set the full ODBC error
text will automatically be displayed without having to test the return
value or having to fill variables and display them yourself. A connection
handle of 0 sets this as a default for all subsequent connections.
<P>
****************************
*  Example using SQLSETPROP()
*
retval=SQLSETPROP(0,"DispWarnings",.T.)
* The "0" parameter above creates a "dummy" channel to turn Dispwarnings on
dsource='test'
Handle=SQLCONNECT(dsource,"","") &amp;&amp; Error returning line
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin ck<BR>
KBCategory: kbprg kbtool kbinterop kbcode kberrmsg<BR>
KBSubcategory: FxtoolCk<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 1, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
