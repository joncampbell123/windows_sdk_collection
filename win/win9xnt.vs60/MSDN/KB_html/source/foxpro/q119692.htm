

<HTML>
<HEAD>
<TITLE>Keeping Forms/Screens from Flashing in Multi-Form/Screen Set </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119692">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/08/20">
<META NAME="Keywords" CONTENT="kbtool kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are running a program with multiple screens that has been built with the Form Designer or Screen Builder, it is not desirable to have the forms or screens flash when the program starts up.  In Visual FoxPro, use the .Visible property to pr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAA8,QA50,QBXS,QACI,QAFR,QAPN,QAY2,QA9N,QANJ,QAEF,QAGX,QBWS,QDIZ,QA0J V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Keeping Forms/Screens from Flashing in Multi-Form/Screen Set</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119692</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6x
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you are running a program with multiple screens that has been built
with the Form Designer or Screen Builder, it is not desirable to have the
forms or screens flash when the program starts up.
<P>
In Visual FoxPro, use the .Visible property to prevent this from happening.
<P>
In FoxPro 2.x, by using the MOVE WINDOW command to move the screens after
they are defined, you can keep them from flashing on the screen when they
start up. After the screen set is started and the first screen is in place,
the other screens can then be moved to their positions within the screen
set. Below is the code needed to keep the second and third screens from
flashing when they are started with the first screen of a three-screen set.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Visual FoxPro</h3>
 

<OL><P><LI>Create a FormSet containing three forms, using their default names of
   Form1, Form2, and Form3. Change the Visible property to .F. for Form2
   and Form3.

<P><LI>Add two buttons named btnScr2, btnScr3 to Form1.

<P><LI>Add the following code to the btnScr2 Click method:
<P>
<P><PRE>      IF ThisFormSet.Form2.visible=.F.
<PRE></PRE>        ThisFormSet.Form2.visible=.T.
      ENDIF

</PRE><P><LI>Next, add another line at the bottom of the code for the btnScr2 Click
   method to set the focus to a specific object on that form. For example,
   if there is a TextBox called Text1 on the form, the last line of code in
   the Click method should be:
<P>
<PRE>         ThisFormSet.Form2.Text1.SetFocus

   5. Repeat steps 3 and 4 for the btnScr3 Click method, changing the
      references from Form2 to Form3.

</PRE></OL>NOTE: Similar buttons using the Setfocus method could be used on Form2 and
Form3 to switch between screens.
<P>
NOTE: As an alternative, a pageframe could be used to accomplish this too.
<P>
<P><h3>FoxPro 2.x</h3>
 

<OL><P><LI>Create a screen called SCR_ONE.

<P><LI>From the Screen menu, choose Layout (choose Screen Layout in FoxPro
    for MS-DOS). In the Name box, type "firstscr" (without the quotation
    marks). If you are using FoxPro for Windows, choose the Code button
    and then choose Screen Setup Code. If you are using FoxPro for MS-DOS,
    select the Setup check box. In this box, type:
<P>
<PRE>       MOVE WINDOW secondscr TO 0,200   &amp;&amp; This will move the
                                        &amp;&amp; screens off the
       MOVE WINDOW thirdscr  TO 0,200   &amp;&amp; current desktop area.
       moveflag = .T.

</PRE><P><LI>Create a push button with the prompts "SCREEN2" and "SCREEN3" (without
    the quotation marks). Give it the variable name "m.scr1" (without the
    quotation marks). In the VALID clause of the push button, type this
    code:
<P>
       IF moveflag = .T.
<PRE>          MOVE WINDOW secondscr to 0,0   &amp;&amp; This will move the
          MOVE WINDOW thirdscr  to 0,0   &amp;&amp; screens to the upper-
          moveflag = .F.                 &amp;&amp; left corner.
       ENDIF

       DO CASE
          CASE m.scr1 = 1
             _CUROBJ=OBJNUM(m.scr2)
          CASE m.scr1 = 2
             _CUROBJ=OBJNUM(m.scr3)
       ENDCASE

</PRE><P><LI>Create a screen called SCR_TWO.

<P><LI>From the Screen menu, choose Layout (choose Screen Layout in FoxPro
    for MS-DOS). In the Name box, type "secondscr" (without the quotation
    marks).

<P><LI>Create a push button with the prompts "SCREEN1" and "SCREEN3" (without
    the quotation marks). Give it the variable name "m.scr2" (without the
    quotation marks). In the VALID clause of the push button, type this
    code:
<P>
       DO CASE
<PRE>          CASE m.scr2 = 1
             _CUROBJ=OBJNUM(m.scr1)
          CASE m.scr2 = 2
             _CUROBJ=OBJNUM(m.scr3)
       ENDCASE

</PRE><P><LI>Create a screen called SCR_THRE.

<P><LI>From the Screen menu, choose Layout (choose Screen Layout in FoxPro
    for MS-DOS). In the Name box, type "thirdscr" (without the quotation
    marks).

<P><LI>Create a push button with the prompts "SCREEN1" and "SCREEN2" (without
    the quotation marks). Give it the variable name "m.scr3" (without the
    quotation marks). In the VALID clause of the push button, type this
    code:
<P>
       DO CASE
<PRE>          CASE m.scr3 = 1
             _CUROBJ=OBJNUM(m.scr1)
          CASE m.scr3 = 2
             _CUROBJ=OBJNUM(m.scr2)
       ENDCASE

</PRE><P><LI>Bring up screen SCR_ONE. From the PROGRAM menu, choose Generate.  Add
    screens SCR_TWO and SCR_THRE  to the screen set, and then generate the
    screen set. At the Command window,  type "DO scr_one.spr" (without the
    quotation marks).
<P>
</OL>The screens will not flash because they have been moved. If one of the push
buttons is pressed, screen 2 and screen 3 will move to the upper-left
corner of the screen. The HIDE WINDOW command also can be used to hide the
screens that are not on top until they are called.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin VFoxWin 2.00 2.50 2.50a 2.50b<BR>
2.60 3.00 Sbuilder<BR>
KBCategory: kbtool kbprg<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
