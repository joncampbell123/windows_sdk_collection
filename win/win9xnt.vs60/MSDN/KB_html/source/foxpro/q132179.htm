

<HTML>
<HEAD>
<TITLE>PRB: Controls in a Page Frame Are Not Refreshed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132179">
<META NAME="KBModify" CONTENT="1995/07/28">
<META NAME="KBCreate" CONTENT="1995/06/29">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a page frame, you observe that only the controls placed on the active page are refreshed when data changes. Controls in underlying pages are not refreshed until they receive the focus.  CAUSE =====  For performance reasons, only the active page ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAPN,QAXB,QBWA,QAHP,QACI,QA7O,QAOE,QAMN,QAH4,QAB5,QAIB,QAIA,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Controls in a Page Frame Are Not Refreshed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132179</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a page frame, you observe that only the controls placed on the active
page are refreshed when data changes. Controls in underlying pages are not
refreshed until they receive the focus.
<P>
<P><h2>CAUSE</h2>
 
<P>
For performance reasons, only the active page in a page frame is refreshed
when a form is refreshed. This is by design.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Alternatives include explicitly calling the Refresh method for each page
that is to be refreshed. For example, it is possible to define a method
that loops through the pages in a page frame and refreshes all the pages.
The following code sample illustrates this method.
<P>
<P><h3>Code Sample</h3>
 
<P>
* Call this method ,and pass the name of the page frame as a
* parameter.
* For example,
*    Thisform.RefreshAllPages('PageFrame1')
*
PROCEDURE RefreshAllPages
PARAMETER tcPageFrameName
oRef=EVAL('thisform.'+tcPageFrameName)
FOR I=1 TO oRef.PageCount
<PRE>   oRef.Pages(I).Refresh
</PRE>ENDFOR
Thisform.Refresh
<P>
<P><h3>Alternative Workaround</h3>
 
<P>
Another alternative is to refresh a page when it becomes active. To
accomplish this, place the following code in the method associated with the
activate event of the page:
<P>
<PRE>   This.Refresh

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a Form.

<P><LI>Place a page frame on the Form.

<P><LI>Using the secondary (right) mouse button, click the form. Then select
   Data Environment. Add the Employee table, located in the Samples\Data
   directory, to the Data Environment.

<P><LI>Click Page1 on the Object menu in the Property sheet.

<P><LI>Select the text box control from the Form Controls toolbar, and place
   the text box on Page1. Modify the ControlSource property to be:
<P>
   Employee.Emp_id

<P><LI>Place another text box on Page1, and modify the ControlSource property
   to be:
<P>
   Employee.Last_name
<P>
   NOTE: This step is important as the controls that do not have the focus
   when the page is activated are not refreshed.

<P><LI>Select Page2, and place two text boxes on that page. Change the
   ControlSource property of the controls to Employee.Address and
   Employee.City, respectively.

<P><LI>Place a command button on the form, and place the following code in its
   Click event method:
<P>
   SKIP
   ThisForm.Refresh

<P><LI>Save and run the form. Click the command button to skip through the
   table, and activate each page. The data on the second text box is not
   refreshed.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 28, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
