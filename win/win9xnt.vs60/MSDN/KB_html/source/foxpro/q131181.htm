

<HTML>
<HEAD>
<TITLE>How to Manage the Exiting Process with QueryUnLoad Event </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131181">
<META NAME="KBModify" CONTENT="1996/04/04">
<META NAME="KBCreate" CONTENT="1995/06/05">
<META NAME="Keywords" CONTENT="kbtool kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a user attempts to leave a form, you want to query the user to ensure that they really want to leave the form. Using the QueryUnload event of a form, you can ask the user, and then take appropriate action in response.  MORE INFORMATION  As des...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAO4,QAH4,QAGB,QAGU,QDL9,QBWQ,QBWO,QBWN,QAGI,QAJX,QAGX,QADR,QAEF,QAAW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Manage the Exiting Process with QueryUnLoad Event</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 4, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131181</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a user attempts to leave a form, you want to query the user to ensure
that they really want to leave the form. Using the QueryUnload event of a
form, you can ask the user, and then take appropriate action in response.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
As described in the Help menu, the QueryUnload event occurs before the
Destroy event. The ReleaseType property is set prior to the QueryUnload
event being called. The QueryUnload event occurs when:

<UL><LI>The CLEAR WINDOWS, RELEASE WINDOWS, or QUIT command is executed in code.
<LI>The user double-clicks the Control-menu box.
<LI>The user chooses Close from the Control menu on a Form.
<P>
</UL>QueryUnload is where you should put your exit confirmation dialog box to
verify that the user really wants to leave. The QueryUnload event uses a
related property, the ReleaseType property, to indicate how the user is
exiting. This is a particularly useful for users choosing the Close option
from the Control menu on a form.
<P>
The following table summarizes the values for the ReleaseType property and
indicates when the QueryUnload event is called.
<P>
<PRE>Action                 ReleaseType Value    QueryUnload Called?
</PRE> 
<PRE>QUIT                   2                    Yes
CLEAR WINDOWS          1                    Yes
RELEASE WINDOWS        1                    Yes
Click in Close Box     1                    Yes
RELEASE thisform       0                    No

</PRE>Note that the QueryUnload event is not called when a RELEASE thisform
command is called. Therefore, if you are using the RELEASE thisform command
as a means of exiting a form, you won't be able to use the code example
below in the QueryUnload event; you'll need to use an alternate method to
achieve the same result.
<P>
<P><h3>Code Sample</h3>
 
<P>
The following code sample demonstrates how to use the QueryUnload event in
a form:
<P>
<PRE>   *--------------------------------------------------------------*
   * Program: QUNLDTST - QueryUnload test code                    *
   * Purpose: Demonstrates trapping user exit from form.      *
   *--------------------------------------------------------------*
   cMessageTitle = 'Test'
   cMessageText  = 'Did you *really* mean to close this form?'
   nDialogType   = 4 + 32 + 256
   *  4   = Yes and No buttons
   *  32  = Question mark icon
   *  256 = Second button is default
   nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
   DO CASE
     CASE nAnswer = 6
       RELEASE THISFORM
     CASE nAnswer = 7
       NODEFAULT
   ENDCASE

</PRE>The use of NODEFAULT in the DO CASE construction overrides the default
action of closing the form, in effect canceling the user's actions.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 4, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
