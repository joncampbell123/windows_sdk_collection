

<HTML>
<HEAD>
<TITLE>PRB: Cannot Trap for Error #1739 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142287">
<META NAME="KBModify" CONTENT="1996/01/15">
<META NAME="KBCreate" CONTENT="1996/01/08">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Changing a property of a Cursor or Relational Object correctly initiates error #1739  Property setting will not take effect until data environment reloaded.  Unfortunately, the error cannot be trapped with an Error Event nor an ON ERROR command.  W...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBE7,QBE6,QAB4,QAAP,QAX1,QAH4,QAYY,QAW6,QAO4,QAO2,QAKP,QBVV,QAUJ,QALZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Trap for Error #1739</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142287</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Changing a property of a Cursor or Relational Object correctly initiates
error #1739 "Property setting will not take effect until data environment
reloaded." Unfortunately, the error cannot be trapped with an Error Event
nor an ON ERROR command.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Avoid any possibility of getting the error. Always unload the Data
Environment before changing the property. To unload the Data Environment,
use the following steps to initiate the CloseTables method of the Data
Environment:

<OL><P><LI>Create a new property of the form called "DataLoad" with an initial
   value of False (.F.).

<P><LI>Inside the OpenTables method, include the following code:
<P>
   THISFORM.DataLoad=.T.

<P><LI>Inside the CloseTables method, include the following code:
<P>
   THISFORM.DataLoad=.F.

<P><LI>Use the DataLoad flag to check to see if the Data Environment has been
   loaded and act accordingly. In the following code, the Data Environment
   is unloaded before the Cursor property is changed. The code can be
   located inside any method or event of the form.
<P>
<P><PRE>      IF THISFORM.DataLoad
<PRE></PRE>         THISFORM.DataEnvironment.CloseTables
      ENDIF
      THISFORM.DataEnvironment.Cursor1.ALIAS="FOX"

   The DataLoad flag is used to determine if the data environment has been
   loaded because the CloseTables method will generate an error if the Data
   Environment had not first been loaded with the OpenTables method.
   OpenTables is called initially if AutoOpenTables is True (.T.).

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following chart is a listing of all the current properties for the Data
Environment, Cursor, and Relation objects. If the Data Environment has been
loaded with the OpenTables method, the chart will show what will occur if
an attempt is made to change the property. Although Error #1739 will occur
for many of the Cursor and Relation objects, the value of the property will
change and be in effect the next time the Data Environment is loaded.
<P>
<PRE>Data Environment       Read Only      Error #1739         No Error
</PRE> 
<PRE>AutoCloseTables            X
AutoOpenTables             X
InitialSelectedAlias                                          X
Name                                                          X

</PRE>Cursor Object
 
<PRE>Alias                                      X
Database                                   X
Name                                                          X
ReadOnly                                   X
BufferModeOverride                         X
Exclusive                                  X
NoDataOnLoad                               X
CursorSource                               X
Filter                                                        X
Order                                                         X

</PRE>Relation Object
 
<PRE>ChildAlias                                 X
OneToMany                                  X
ChildOrder                                 X
ParentAlias                                X
Name                                                          X
RelationalExpr                             X

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form.

<P><LI>Add any table to the Data Environment of the form.

<P><LI>In the Load event for the form, type the following:
<P>
   ON ERROR WAIT WINDOW "This is an Error"

<P><LI>Run the form.

<P><LI>In the Command window, type the following:
<P>
   _SCREEN.Forms(1).DataEnvironment.Cursor1.Alias="FOX"

<P><LI>The ON ERROR routine does not activate. A FoxPro Error Message is
   displayed on the screen.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
