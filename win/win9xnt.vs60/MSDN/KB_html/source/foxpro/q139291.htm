

<HTML>
<HEAD>
<TITLE>How to Change the BackColor of a ToolBar When It's Docked </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139291">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1995/11/08">
<META NAME="Keywords" CONTENT="FxprgGeneral vfoxwin kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In Visual FoxPro, the BackColor of a custom toolbar is set to grey by default. This article describes how to use the Windows API to ensure that your toolbar BackColor is the same as the color of the docking area of your application window.  MORE IN...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPG,QAG9,QACJ,QDL9,QBWQ,QBWO,QBWN,QAF0,QBRZ,QANS,QA56,QA55,QAKJ,QAH4,QDIT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Change the BackColor of a ToolBar When It's Docked</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139291</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Visual FoxPro, the BackColor of a custom toolbar is set to grey by
default. This article describes how to use the Windows API to ensure that
your toolbar BackColor is the same as the color of the docking area of your
application window.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The background color of the docking area is controlled by the Button Face
color in Windows 3.1 and by the 3D Objects color in Windows 95. To ensure
that your toolbar BackColor matches the background color of the docking
area of your application window, use the Windows API to get the current
color of the docking area, and then set the BackColor of your toolbar to
the color returned.
<P>
To get the 3D Objects color in Windows 95 or the Button Face color in
Windows 3.1, add the following code to the AfterDock event in your ToolBar
or ToolBar class:
<P>
<PRE>   DECLARE INTEGER GetSysColor in User32.dll Integer
   This.BackColor = GetSysColor(15)

</PRE>The GetSysColor() API function can use the following list of color
constants. These constants were obtained from the Winuser.h header file
that is shipped with Microsoft Visual C++. This list can be placed in a
header file and used with the formset that is associated with the toolbar.
Using the actual Winuser.h header file as an include file with a form may
cause Visual FoxPro to crash.
<P>
Here is the list of color constants:
<P>
<PRE>   #define CTLCOLOR_MSGBOX             0
   #define CTLCOLOR_EDIT               1
   #define CTLCOLOR_LISTBOX            2
   #define CTLCOLOR_BTN                3
   #define CTLCOLOR_DLG                4
   #define CTLCOLOR_SCROLLBAR          5
   #define CTLCOLOR_STATIC             6
   #define CTLCOLOR_MAX                7

   #define COLOR_SCROLLBAR             0
   #define COLOR_BACKGROUND            1
   #define COLOR_ACTIVECAPTION         2
   #define COLOR_INACTIVECAPTION       3
   #define COLOR_MENU                  4
   #define COLOR_WINDOW                5
   #define COLOR_WINDOWFRAME           6
   #define COLOR_MENUTEXT              7
   #define COLOR_WINDOWTEXT            8
   #define COLOR_CAPTIONTEXT           9
   #define COLOR_ACTIVEBORDER         10
   #define COLOR_INACTIVEBORDER       11
   #define COLOR_APPWORKSPACE         12
   #define COLOR_HIGHLIGHT            13
   #define COLOR_HIGHLIGHTTEXT        14
   #define COLOR_BTNFACE              15
   #define COLOR_BTNSHADOW            16
   #define COLOR_GRAYTEXT             17
   #define COLOR_BTNTEXT              18
   #define COLOR_INACTIVECAPTIONTEXT  19
   #define COLOR_BTNHIGHLIGHT         20

   #if("4" $ OS())
   #define COLOR_3DDKSHADOW           21
   #define COLOR_3DLIGHT              22
   #define COLOR_INFOTEXT             23
   #define COLOR_INFOBK               24

   #define COLOR_DESKTOP           COLOR_BACKGROUND
   #define COLOR_3DFACE            COLOR_BTNFACE
   #define COLOR_3DSHADOW          COLOR_BTNSHADOW
   #define COLOR_3DHIGHLIGHT       COLOR_BTNHIGHLIGHT
   #define COLOR_3DHILIGHT         COLOR_BTNHIGHLIGHT
   #define COLOR_BTNHILIGHT        COLOR_BTNHIGHLIGHT
   #endif

</PRE>To create a header file out of the constants listed above:

<OL><P><LI>Either copy and paste the code or type the code into a new text file in
   Visual FoxPro.

<P><LI>Save the text file as Colors.h or any other valid file name with a .h
   extension.

<P><LI>Open a form in the Visual FoxPro Form Designer and select the Include
   file command from the Form menu. Click the name of the header file
   created in step 2.

<P><LI>Use the constant names in the GetSysColor() API function.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  API GetSysColor<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: FxprgGeneral<BR>
Keywords          : FxprgGeneral vfoxwin kbhowto kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
