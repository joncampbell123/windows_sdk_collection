

<HTML>
<HEAD>
<TITLE>PRB: Visual FoxPro Mac Cannot Understand Apple Object Types </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151637">
<META NAME="KBModify" CONTENT="1996/05/29">
<META NAME="KBCreate" CONTENT="1996/05/28">
<META NAME="Keywords" CONTENT="kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Microsoft Visual FoxPro for Power Macintosh does not support the Apple Object Model. Apple Objects such as  paragraph  ,  word ,  range , etc., cannot be passed directly or indirectly to Visual FoxPro for Power Macintosh.  WORKAROUND  You can cast ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QA55,QA56,QAD7,QAH7,QAH6,QAB4,QAUR,QATX,QDO9,QAMB,QDMR,QAVX,QAVW,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual FoxPro Mac Cannot Understand Apple Object Types</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151637</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Visual FoxPro for Power Macintosh does not support the Apple
Object Model. Apple Objects such as "paragraph" , "word", "range", etc.,
cannot be passed directly or indirectly to Visual FoxPro for Power
Macintosh.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can cast or change the object, or a property of the object, into a
simple data type that Visual FoxPro understands.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following examples illustrate the problem and the workaround:
<P>
Enter the script:
<P>
<PRE>   -- Save this script as "Excel2VFP"
   tell application "Microsoft Excel"
      Activate
      set Range "R1C1" to "Data to go to Visual FoxPro"
      get Range "R1C1"
      --get Value of Range "R1C1"
      set myVar to the result
   end tell

   tell application "Microsoft Visual FoxPro"
      Activate
      Do Script "SET DEFAULT TO HOME()"
      Do Script "DO TEST WITH '"&amp; myVar &amp;"'"
   end tell

</PRE>Enter the Visual FoxPro program:
<P>
<PRE>   * Save this program as "Test" in the Visual FoxPro folder
   PARAMETER MyVar

   LenMyVar = LEN(MyVar)
   =MessageBox("The length of the data from Excel is ";
    +LEFT(STR(LenMyVar)))

</PRE>Run the script and note that you get the following error message:
<P>
<PRE>   Can't make {...} into a string

</PRE>What you attempted to do was try to pass an Excel "Range" to Visual FoxPro,
which does not understand what a range of cells is. To work around this
behavior, comment out the line [get Range "R1C1"] and uncomment the line
[--get Value of Range "R1C1"].
<P>
Save the script, run it, and note that the process works properly because
Visual FoxPro understands the "Value of" simple string type that is passed.
<P>
Following is another example of an attempt to pass data to Visual FoxPro.
This example also fails initially, but returns a different error message.
<P>
Enter the script:
<P>
<PRE>   -- Save this script as "STE2VFP"
   tell application "Scriptable Text Editor"
      activate
      open file "Macintosh HD:TestText"
      get contents of document 1
      -- get contents of document 1 as string
      set myVar to the result
      quit
   end tell

   tell application "Microsoft Visual FoxPro"
      Activate
      Do Script "SET DEFAULT TO HOME()"
      Do Script "DO TEST2 WITH '"&amp; myVar &amp;"'"
   end tell

</PRE>Enter the Visual FoxPro program:
<P>
<PRE>   * Save this program as "Test2" in the Visual FoxPro folder
   PARAMETER MyVar

   LenMyVar = LEN(MyVar)
   =MessageBox("The length of the data from Scriptable Text Editor is ";
    +LEFT(STR(LenMyVar)))

</PRE>Enter the Scriptable Text Editor file 'TestText':
<P>
<PRE>    This is a test of VFP and AppleScript.

</PRE>After you create the files and you run the script, STE2VFP, you will get
the following error message:
<P>
<PRE>   Microsoft Visual FoxPro got an error: "do test2 with 'This is a test
   of VFP and AppleScript.' doesn't understand the Do Script message.

</PRE>Once you have cleared the error message, edit the script STE2VFP. Comment
out the line [get contents of document 1] and uncomment the line
[-- get contents of document 1 as string]. Save the script and run it.
You will get a dialog window from Visual FoxPro displaying the number of
characters in the string that was passed.
<P>
NOTE: You cannot pass a string longer than 255 characters to Visual FoxPro
in this manner. If you attempt to pass a longer string, Visual FoxPro
appears to hang on the Do Script command used to pass the variable to
Visual FoxPro. To pass strings longer than 255 characters, use an ASCII
text file that Visual FoxPro can append into a memo field or that can be
read using low-level file I/O.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00b VFoxMac<BR>
KBCategory: kbinterop kbprb<BR>
KBSubcategory: FxinteropGeneral
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
