

<HTML>
<HEAD>
<TITLE>FIX: Command Button's Default Property Cannot Be Changed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148683">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1996/03/19">
<META NAME="Keywords" CONTENT="kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A command button's Default property is set to true (.T.), and it can't be set back to false (.F.). This Results in a command button that fires its Click event whenever the user presses the ENTER key anywhere on the form.  This problem occurs when a...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBXS,QBWS,QAH4,QAB9,QAO4,QAGI,QAUD,QBV8,QAI2,QA5D,QAR4,QAKD,QAJD,QAM1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Command Button's Default Property Cannot Be Changed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148683</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A command button's Default property is set to true (.T.), and it can't
be set back to false (.F.). This Results in a command button that fires its
Click event whenever the user presses the ENTER key anywhere on the form.
<P>
This problem occurs when all of the following are true:

<UL><LI>Another form in the form set is called from the Click event of a command
   button.

<LI>The command button is not the first object in the Tab order.

<LI>The form that is being called has its Visible property set to false.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
Here are two possible workarounds:

<UL><LI>Pull the "called" form from the form set, and make it a stand-alone
   form. Then call it from the Click event of the command button with a
   DO FORM command.
<P>
   -or-

<LI>If the form set must stay intact, set the Visible property of the
   "called" form back to true (.T.), which is the default. Set its Top
   property to a very high negative value such as -500. Then in the
   "called" form's Show method, set the Top value back to an appropriate
   value such as 12, and in the Hide method, set the Top value back to the
   high negative value. This effectively keeps the form hidden until the
   application is ready to present the form and then rehides it.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new form.

<P><LI>On the Form menu, click "Create a Form Set," and then click "Add a New
   Form."

<P><LI>Select the Form1 form. Place a Text box and two command buttons on the
   form.

<P><LI>Double-click the Command1 button to bring up its Code window. Enter the
   following line of code in its Click event:
<P>
   THISFORMSET.FORM2.SHOW()

<P><LI>Double-click the Command2 button to bring up its Code window, and enter
   the following in its Click event:
<P>
   THISFORMSET.RELEASE()

<P><LI>Select the Form2 form, and bring up the Property Sheet. Place a command
   button on Form2, and enter the following code in the command button's
   Click event procedure:
<P>
   THISFORM.HIDE()

<P><LI>Set Form2's Visible property to false (.F.).

<P><LI>Save and Run the Form Set.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: FxprgClassoop VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
