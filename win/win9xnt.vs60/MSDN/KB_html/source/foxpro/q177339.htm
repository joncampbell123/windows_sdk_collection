

<HTML>
<HEAD>
<TITLE>PRB: OLE Error When Appending from Excel 97 Workbook </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177339">
<META NAME="KBModify" CONTENT="1997/12/04">
<META NAME="KBCreate" CONTENT="1997/11/25">
<META NAME="Keywords" CONTENT="FxprgGeneral vfoxwin kbinterop kbole">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you use the APPEND FROM            TYPE XL5 to import an Excel 97 workbook into a FoxPro table, one of two OLE error messages appear:  Visual FoxPro versions 3.0x and 5.0x running on Windows 95 produces the following error:     OLE error code ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QAAP,QA9Q,QAY2,QAUR,QAH4,QDNM,QA56,QA55,QDO5,QAP2,QBV8,QAB9,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: OLE Error When Appending from Excel 97 Workbook</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177339</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0b, 5.0, 5.0a
   on the following platforms: NT, Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the APPEND FROM &lt;filename&gt; TYPE XL5 to import an Excel 97
workbook into a FoxPro table, one of two OLE error messages appear:
<P>
Visual FoxPro versions 3.0x and 5.0x running on Windows 95 produces the
following error:
<P>
<PRE>   OLE error code
   0X800300002:%1
   could not be found

</PRE>Running on Windows NT 4.0 produces the following error:
<P>
<PRE>   OLE error code
   0X800300002:
   unknown OLE status code

</PRE><h2>CAUSE</h2>
 
<P>
The APPEND FROM command in Visual FoxPro versions 3.0x and 5.0x does not
support Excel 97 workbook files.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Here are two resolutions:

<UL><LI>Save the Excel workbook in Excel as a Microsoft Excel 5.0/95 workbook
   and use the APPEND FROM command with the TYPE XL5 clause.
<P>
 -or-

<LI>Save the file as a Microsoft Excel 4.0, 3.0 or 2.1 worksheet and use the
   TYPE XLS clause.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Since both error messages are OLE errors and most developers do not
consider APPEND FROM to be an OLE command, it is not apparent that the
Excel file type is causing the error to occur.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Excel 97 and create a new workbook.

<P><LI>In cells A1 through C1, type the following data:
<P>
<P><PRE>      Some test data
</PRE>
<P><LI>Save the file to your Visual FoxPro home folder with the name Ztest.xls
   as a Microsoft Excel Workbook (*.xls) and then close Excel.

<P><LI>Start Visual FoxPro and type the following command in the FoxPro Command
   window to create a test table:
<P>
<P><PRE>      CREATE TABLE ztest (first c(10), second c(10), third c(10))
</PRE>
<P><LI>In the FoxPro Command window, type the following command to import data
   from the Excel workbook:
<P>
<P><PRE>      APPEND FROM Ztest.xls TYPE XL5
</PRE><P>
   The error that appears depends on the operating system on the machine.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Excel APPEND FROM OLE<BR>
Keywords          : FxprgGeneral vfoxwin kbinterop kbole<BR>
Version           : WINDOWS:3.0b,5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
