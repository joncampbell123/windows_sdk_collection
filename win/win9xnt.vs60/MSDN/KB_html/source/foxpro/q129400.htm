

<HTML>
<HEAD>
<TITLE>FREE TABLE Command Removes Table from Corrupted Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129400">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/25">
<META NAME="Keywords" CONTENT="kbprg kbcode kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The FREE TABLE command removes a table from a database. The purpose of this command is to provide a programmatic way to remove a table from a corrupted database.  You should normally use REMOVE TABLE to remove a table from a database that is not co...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QAEF,QAB4,QARR,QAY2,QAAP,QDKD,QDH6,QA9N,QANJ,QAB9,QBVV,QA5V,QAA1,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FREE TABLE Command Removes Table from Corrupted Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129400</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The FREE TABLE command removes a table from a database. The purpose of this
command is to provide a programmatic way to remove a table from a corrupted
database.
<P>
You should normally use REMOVE TABLE to remove a table from a database that
is not corrupted.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If FREE TABLE is used to remove a table from a database that is not
corrupted, the Table Designer window still displays the table. However, the
table is no longer really part of the database, and issuing the VALIDATE
DATABASE command causes the following error message to be displayed:
<P>
<PRE>   Validate Database database name
    Rebuilding Structural Index.....Index Rebuilt
    Object #N(Table 'table name'): table is not in database

</PRE>Also, attempting to browse or modify the table causes the error message to
be displayed:
<P>
<PRE>   Table &lt;table name&gt; is not marked as belonging to &lt;database name&gt;
   database.

    Would you like to create the back link to mark it?

</PRE>Answering Yes to this question recreates the back link of the table to
the database and issuing the VALIDATE DATABASE command returns the message
"Database container is valid". The table is now part of the database again.
<P>
<P><h3>Example Usage of the FREE TABLE Command</h3>
 
<P>
CAUTION: Performing this example will corrupt the TESTDATA.DBC database in
the SAMPLE subdirectory.

<OL><P><LI>First corrupt a database by running the following:
<P>
<P><PRE>      SET DEFAULT TO c:\vfp\samples\data
      USE testdata.dbc
      GO TOP
<PRE></PRE>      DELETE            &amp;&amp; Delete one record of the .DBC.
      USE               &amp;&amp; Now TESTDATA cannot be opened as a database

</PRE><P><LI>Run the following program which has an on error routine to trap for a
   damaged database. If this program is run without the error routine, the
   message "Testdata.DBC is not a database" will be returned.
<P>
<PRE>      SET PROCEDURE TO freetabl      &amp;&amp; FREETABL is the name of the program

      ON ERROR DO errhand WITH ERROR()
      * The next line should cause an error because the first record
      * was deleted from TESTDATA.DBC

      OPEN DATA testdata
      USE customer
      USE products IN 0
      USE orders IN 0
      USE orditems IN 0
      USE employee IN 0

      ON ERROR  &amp;&amp; restore system error handler

      PROCEDURE errhand
        PARAMETER merror
        WAIT WINDOW STR(merror)
        IF merror=1552
          FREE TABLE customer      &amp;&amp; Allows the tables to be opened
          FREE TABLE orders        &amp;&amp; by freeing them from the corrupted
          FREE TABLE products      &amp;&amp; DATABASE
          FREE TABLE orditems
          FREE TABLE employee
        ENDIF
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin errmsg<BR>
KBCategory: kbprg kbcode kberrmsg kbprb<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
