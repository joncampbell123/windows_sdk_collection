

<HTML>
<HEAD>
<TITLE>DBWEB: How to Create a Dynamic Combo Box in a dbWeb Custom DBX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155673">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1996/09/04">
<META NAME="Keywords" CONTENT="DbwebUtils kbusage">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  This article describes a technique that will dynamically populate an HTML combo box in a Microsoft dbWeb custom DBX.  MORE INFORMATION  In order to dynamically populate a combo box in an HTML QBE form using the dbWeb Administrator, you must set the...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QA2Q,QBWA,QBCF,QA5V,QAYY,QAK6,QAUJ,QAG2,QAPN,QALZ,QDNQ,QBCE,QAM3,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DBWEB: How to Create a Dynamic Combo Box in a dbWeb Custom DBX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155673</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft dbWeb versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes a technique that will dynamically populate an HTML
combo box in a Microsoft dbWeb custom DBX.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order to dynamically populate a combo box in an HTML QBE form using the
dbWeb Administrator, you must set the data value property for the
appropriate field in the QBE tab to #autofill# (or #autofill+# if you want
the first value displayed in the combo box to be blank). However, you may
want to use a custom DBX to create your HTML form so you can use HTML tags
that dbWeb doesn't generate automatically. In order to fill a combo box
with values in a custom DBX, you must create two schemas. The first schema
contains a custom DBX that uses dbWeb banding tags to populate the combo
box; then it uses the POST method to send the value you select in the combo
box to the getresults or getxresults method for the second schema. Follow
the steps below to create a sample custom DBX with a dynamically populated
combo box.
<P>
The following example shows you how to create an ODBC data source and two
dbWeb schemas to dynamically fill a combo box with customer ID numbers.
The example uses the sample database Northwind.mdb from Microsoft Access
for Windows 95 as the data source. It assumes that you are using the
default paths for Microsoft Internet Information Server. If you are using
other web server software, adjust these paths accordingly.
<P>
<P><h3>Creating the ODBC Data Source</h3>
 

<OL><P><LI>Start the dbWeb Administrator.

<P><LI>On the Utilities menu, click ODBC Manager.

<P><LI>In the Data Sources dialog box, click System DSN, and then click Add.

<P><LI>Click Microsoft Access Driver, and then click OK.

<P><LI>In the Data Source Name box, type Acc95.

<P><LI>Under Database, click the Select button.

<P><LI>In the Select Database dialog box, locate the sample database
   Northwind.mdb, and then click OK.

<P><LI>In the ODBC Microsoft Access 7.0 Setup dialog box, click OK.

<P><LI>Close the ODBC Manager.
<P>
</OL><h3>Creating the First dbWeb Schema</h3>
 

<OL><P><LI>In the Data Sources window of the dbWeb Administrator, click Data
    Sources And Schemas, and then click New Datasource.

<P><LI>In the Data Source Name box, type Acc95, and then click OK.

<P><LI>Click the Acc95 Data Source, and then click New Schema.

<P><LI>In the New Schema dialog box, click the New Schema button.

<P><LI>Under Schema name, type Dynabox1.

<P><LI>Click the Tables tab.

<P><LI>Click the Customers table, and then click Add.

<P><LI>Click the Tabular tab.

<P><LI>In the "Data columns in selected tables" box, double-click Customers.

<P><LI>Click CustomerID, and then click Add.

<P><LI>Click the DBX tab.

<P><LI>Click the Editor button next to "Multi record result output custom
    format file."

<P><LI>Type the following HTML code in the right pane of the Editor, depending
    on your version of dbWeb.
<P>
    Microsoft dbWeb version 1.0:
<P>
       &lt;HTML&gt;
       &lt;TITLE&gt;Customer List&lt;/TITLE&gt;
       &lt;BODY&gt;
       &lt;FORM METHOD="POST"
       ACTION="/scripts/dbweb/$dbwebc.exe/Dynabox2?getresults"&gt;
       Please select a Customer ID from the list.&lt;BR&gt;
       &lt;!--BUILD THE FORM--&gt;
       &lt;!--Orders is the second argument of NAME--&gt;
       &lt;!--because the result will be used--&gt;
       &lt;!--to filter the Orders table--&gt;
       &lt;SELECT NAME="4,Orders,CustomerID"&gt;
       &lt;!--Start of banding to fill the combo box--&gt;
       \tbon\t
       &lt;OPTION&gt;\tobj\tCustomers\tcol\tCustomerID\t
       \tboff\t
       &lt;!--End of banding--&gt;
       &lt;/SELECT&gt;&lt;BR&gt;
<P>
       &lt;INPUT TYPE="checkbox" NAME="8,all,rows"&gt; Use full-screen output
       even if more than one row is returned.&lt;BR&gt;
       Return no more than &lt;INPUT VALUE="100" SIZE="4" NAME="9,9,9"&gt;
       rows (maximum 100).&lt;BR&gt;
       &lt;INPUT TYPE="SUBMIT" VALUE="Submit Query"&gt;
       &lt;/FORM&gt;
       &lt;/BODY&gt;
       &lt;/HTML&gt;
<P>
    Microsoft dbWeb version 1.1:
<P>
       &lt;HTML&gt;
       &lt;TITLE&gt;Customer List&lt;/TITLE&gt;
       &lt;BODY&gt;
       &lt;FORM METHOD="POST"
       ACTION="/scripts/dbweb/dbwebc.dll/Dynabox2?getresults"&gt;
       Please select a Customer ID from the list.&lt;BR&gt;
       &lt;!--BUILD THE FORM--&gt;
       &lt;!--Orders is the second argument of NAME--&gt;
       &lt;!--because the result will be used--&gt;
       &lt;!--to filter the Orders table--&gt;
       &lt;SELECT NAME="4,Orders,CustomerID"&gt;
       &lt;!--Start of banding to fill the combo box--&gt;
       \tbon\t
       &lt;OPTION&gt;\tobj\tCustomers\tcol\tCustomerID\t
       \tboff\t
       &lt;!--End of banding--&gt;
       &lt;/SELECT&gt;&lt;BR&gt;
       &lt;INPUT TYPE="checkbox" NAME="8,all,rows"&gt; Use full-screen output
       even if more than one row is returned.&lt;BR&gt;
       Return no more than &lt;INPUT VALUE="100" SIZE="4" NAME="9,9,9"&gt;
       rows (maximum 100).&lt;BR&gt;
       &lt;INPUT TYPE="SUBMIT" VALUE="Submit Query"&gt;
       &lt;/FORM&gt;
       &lt;/BODY&gt;
       &lt;/HTML&gt;

<P><LI>Save the file as Dynabox.htm and close the DBX Editor.

<P><LI>Click the Browse button next to "Multi record output custom format
    file," select Dynabox.htm, and then click OK.

<P><LI>In the Dynabox1 [Acc95] dialog box, click OK.
<P>
</OL><h3>Creating the Second dbWeb Schema</h3>
 

<OL><P><LI>Click the Acc95 Data Source, and then click New Schema.

<P><LI>In the New Schema dialog box, click the New Schema button.

<P><LI>Under Schema name, type Dynabox2.

<P><LI>Click the Tables tab.

<P><LI>Click the Orders table, and then click Add.

<P><LI>Click the Tabular tab.

<P><LI>In the "Data columns in selected tables" box, double-click Orders.

<P><LI>Click OrderID, and then click Add.

<P><LI>Click the Freeform tab.

<P><LI>In the "Data columns in selected tables" box, double-click Orders.

<P><LI>Click OrderID, and then click Add. Click CustomerID, and then click
    Add.

<P><LI>In the Dynabox2 [Acc95] dialog box, click OK.
<P>
</OL><h3>Testing the Results</h3>
 

<OL><P><LI>Type the following URL into the Address line of a browser, depending on
   your version of dbWeb.
<P>
   Microsoft dbWeb version 1.0:
<P>
<P><PRE>      <B>http://&lt;hostname&gt;/scripts/dbweb/$dbwebc.exe/Dynabox1?getxresults</B>
</PRE><P>
   Microsoft dbWeb version 1.1:
<P>
<P><PRE>      <B>http://&lt;hostname&gt;/scripts/dbweb/dbwebc.dll/Dynabox1?getxresults</B>
</PRE>
<P><LI>Select a CustomerID from the combo box, and then click Submit Query.

<P><LI>Note that the results display only the order numbers for the customer
   you selected.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : DbwebUtils kbusage<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
