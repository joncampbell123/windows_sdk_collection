

<HTML>
<HEAD>
<TITLE>ADT/ODE: How to Modify RefreshTableLinks Module in Solutions.mdb </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154397">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1996/08/04">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The RefreshTableLinks module in the Developer Solutions sample application (Solutions.mdb) demonstrates a method of updating the connection information for linked (attached)...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBB1,QAY5,QAH4,QDN9,QDKY,QBV8,QAB9,QAZV,QASR,QAUJ,QAJH,QAUF,QAPN,QBS0 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ADT/ODE: How to Modify RefreshTableLinks Module in Solutions.mdb</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154397</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access Developer's Toolkit version 7.0
<LI>Microsoft Office 97 Developer Edition Tools
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The RefreshTableLinks module in the Developer Solutions sample application
(Solutions.mdb) demonstrates a method of updating the connection
information for linked (attached) tables in an application that uses
multiple databases.
<P>
This article describes how you can modify the functions used in the
modRefreshTableLinks module (or RefreshTableLinks module in Solutions.mdb
for Microsoft Access 7.0) to work in a run-time environment.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To modify the functions used in the modRefreshTableLinks module to work in
a run-time environment, follow these steps while running the retail version
of Microsoft Access. Each of these steps is described in detail in the
following sections.

<OL><P><LI>Import the modRefreshTableLinks (or RefreshTableLinks in Solutions.mdb
   for Microsoft Access 7.0) module from Solutions.mdb.

<P><LI>Modify the sample CheckLinks() function.

<P><LI>Modify the sample FindNorthwind() function.

<P><LI>Modify the sample RelinkTables() function.

<P><LI>Call the ReLinkTables() function in your application's AutoExec macro.
<P>
</OL><h3>Step 1</h3>
 
<P>
Import the modRefreshTableLinks Module from Solutions.mdb:

<OL><P><LI>With your database open, on the File menu, point to Get External Data,
   and then click Import.

<P><LI>In the Look In box, select the Samples folder under your Microsoft
   Access folder.

<P><LI>In the File Name box, select Solutions.mdb, and then click Import.

<P><LI>In the Import Objects dialog box, click the Modules tab, select
   modRefreshTableLinks, and then click OK.
<P>
</OL><h3>Step 2</h3>
 
<P>
Follow these steps to modify the CheckLinks() function to test if the
path of your current attachments are correct:

<OL><P><LI>Search the CheckLinks() function for the following line:
<P>
<P><PRE>      Set RST=dbs.OpenRecordset("Products")
</PRE>
<P><LI>Replace "Products" with the name of a linked table in your
   application.mdb.
<P>
<P><PRE>      Set RST=dbs.OpenRecordset("&lt;your table name&gt;")
</PRE><P>
</OL><h3>Step 3</h3>
 
<P>
Follow these steps to modify the FindNorthwind() function to display the
Open File dialog box for the user to locate your back-end database. The
function returns the full path to the back-end database:

<OL><P><LI>Find the following line in the FindNorthwind() function:
<P>
<P><PRE>      msaof.strDialogTitle = "Where Is Northwind?"
</PRE>
<P><LI>Replace "Northwind" with the name of your back-end database:
<P>
<P><PRE>      msaof.strDialogTitle = "Where Is &lt;your database name&gt;?"
</PRE><P>
</OL><h3>Step 4</h3>
 
<P>
Follow these steps to modify the RelinkTables() function to look for
a table in your linked database and replace references to Northwind.mdb and
Solutions.mdb with references to your application:

<OL><P><LI>Search the RelinkTables() function for one of the following lines:
<P>
<P><PRE>      Const conAppTitle = "Developer Solutions"
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      Const conAppTitle = "Solutions"
</PRE>
<P><LI>Replace "Developer Solutions" or "Solutions" with the name of your
   application database:
<P>
<P><PRE>      Const conAppTitle = "&lt;your application database&gt;"
</PRE>
<P><LI>Search for and replace all references to Northwind.mdb, Solutions.mdb,
   and "Developer Solutions or Solutions." Replace these references with
   your database names.
<P>
</OL><h3>Step 5</h3>
 
<P>
Call the ReLinkTables() Function in your application's AutoExec Macro or
from your SwitchBoard's Load event.
<P>
In the Developer Solutions sample application, the ReLinkTables() function
is called from the DeveloperSolutions (or Solutions in Microsoft Access
7.0) form's Load event. This function determines whether the table
attachments are valid. If the attachments are not valid, the function
prompts the user for the location of the linked tables. The ReLinkTables()
function could also be called from your AutoExec macro.
<P>
The AutoExec macro entries are as follows:
<P>
<PRE>   Condition                         Action
   ------------------------------------------------------------------------
   NOT ReLinkTables()                RunCommand (or DoMenuItem in Microsoft
                                     Access 7.0)

                                     OpenForm

   Action Arguments
   ---------------------------------------------
   RunCommand         or      DoMenuItem
   Command: Close             Menu Bar: Database
                              Menu Name: File
                              Command: Close

   OpenForm
      Form Name: &lt;your SwitchBoard's name&gt;
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: attach adt<BR>
Keywords          : kbprg PgmHowTo<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
