

<HTML>
<HEAD>
<TITLE>DBWEB: How to Create a Custom Update DBX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154867">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1996/08/15">
<META NAME="Keywords" CONTENT="DbwebUsage kbusage">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Microsoft dbWeb provides a default form that you can use as your Update form. However, with a text editor you can create a custom HTML document to use as your Update form. You can design the look of the form so that it resembles other HTML document...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAGU,QAUJ,QAMB,QAC1,QBD2,QBWS,QAP2,QBVX,QBWA,QATX,QAPF,QAKD,QBQX,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DBWEB: How to Create a Custom Update DBX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154867</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft dbWeb versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft dbWeb provides a default form that you can use as your Update
form. However, with a text editor you can create a custom HTML document to
use as your Update form. You can design the look of the form so that it
resembles other HTML documents on your web site.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example uses the Employees table in the sample database
Nwind.mdb and the dbnwind data source. Before you begin the example, make
sure you can query the Employees sample schema in the dbnwind data source
of the dbWeb administrator.
<P>
CAUTION: Following the steps in this example will modify the sample
database Nwind.mdb and the Employees sample schema.  You may want
to back up the Nwind.mdb and Dbweb.mdb files, or use a copy of them for
this example.
<P>
<P><h3>Creating a Custom Update Form</h3>
 
<P>
NOTE: The HTML example below uses /scripts as the cgi files folder. That is
the default folder for Internet Information Server (IIS). If you use a
different web server, the folder may be different. Change the path as
appropriate for your web server. Also, if you are using dbWeb 1.0, replace
dbwebc.dll with $dbwebc.exe in the following example.

<OL><P><LI>Using Notepad or your favorite HTML editor, type the following text into
   a new file:
<P>
<P><PRE>      &lt;HTML&gt;
      &lt;HEAD&gt;&lt;TITLE&gt;Update Employee Information&lt;/TITLE&gt;&lt;/HEAD&gt;
      &lt;BR&gt;
</PRE><P>
<P><PRE>      &lt;BODY&gt;
      &lt;H2 ALIGN=CENTER&gt;Update Employee Information&lt;/H2&gt;
      &lt;BR&gt;
</PRE><P>
<P><PRE>      &lt;FORM ACTION="/scripts/dbweb/dbwebc.dll/Employees?update"
      METHOD="POST"&gt;
      &lt;INPUT TYPE="hidden" NAME="11,Employees,Employee ID"
      VALUE="\tobj\tEmployees\tcol\tEmployee ID\t"&gt;
</PRE><P>
<P><PRE>      &lt;TABLE&gt;
      &lt;TR&gt;&lt;TH&gt;Last Name:&lt;/TH&gt;&lt;TD&gt;&lt;INPUT TYPE="text" SIZE=20 MAXLENGTH=256
      NAME="1,Employees,Last Name" VALUE="\tobj\tEmployees\tcol\tLast
      Name\t"&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;TR&gt;&lt;TH&gt;First Name:&lt;/TH&gt;&lt;TD&gt;&lt;INPUT TYPE="text" SIZE=20 MAXLENGTH=256
      NAME="1,Employees,First Name" VALUE="\tobj\tEmployees\tcol\tFirst
      Name\t"&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;TR&gt;&lt;TH&gt;Title:&lt;/TH&gt;&lt;TD&gt;&lt;INPUT TYPE="text" SIZE=20 MAXLENGTH=256
      NAME="1,Employees,Title"
      VALUE="\tobj\tEmployees\tcol\tTitle\t"&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;TR&gt;&lt;TH&gt;Address:&lt;/TH&gt;&lt;TD&gt;&lt;INPUT TYPE="text" SIZE=20 MAXLENGTH=256
      NAME="1,Employees,Address"
      VALUE="\tobj\tEmployees\tcol\tAddress\t"&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;TR&gt;&lt;TH&gt;City:&lt;/TH&gt;&lt;TD&gt;&lt;INPUT TYPE="text" SIZE=20 MAXLENGTH=256
      NAME="1,Employees,City"
      VALUE="\tobj\tEmployees\tcol\tCity\t"&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;TR&gt;&lt;TH&gt;Region:&lt;/TH&gt;&lt;TD&gt;&lt;INPUT TYPE="text" SIZE=20 MAXLENGTH=256
      NAME="1,Employees,Region"
      VALUE="\tobj\tEmployees\tcol\tRegion\t"&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;TR&gt;&lt;TH&gt;Postal Code:&lt;/TH&gt;&lt;TD&gt;&lt;INPUT TYPE="text" SIZE=20 MAXLENGTH=256
      NAME="1,Employees,Postal Code" VALUE="\tobj\tEmployees\tcol\tPostal
      Code\t"&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;TR&gt;&lt;TH&gt;Country:&lt;/TH&gt;&lt;TD&gt;&lt;INPUT TYPE="text" SIZE=20 MAXLENGTH=256
      NAME="1,Employees,Country"
      VALUE="\tobj\tEmployees\tcol\tCountry\t"&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;TR&gt;&lt;TH&gt;Home Phone:&lt;/TH&gt;&lt;TD&gt;&lt;INPUT TYPE="text" SIZE=20 MAXLENGTH=256
      NAME="1,Employees,Home Phone" VALUE="\tobj\tEmployees\tcol\tHome
      Phone\t"&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;TR&gt;&lt;TH&gt;&lt;INPUT TYPE=submit VALUE="Submit Update"&gt;&lt;/TR&gt;&lt;/TH&gt;
      &lt;/TABLE&gt;
</PRE><P>
<P><PRE>      &lt;/FORM&gt;
      &lt;/BODY&gt;
      &lt;/HTML&gt;
</PRE>
<P><LI>Save the file as Upempinf.htm in the dbweb subfolder of the HTML
   document root folder (\inetsrv\wwwroot\dbweb, if IIS is your web
   server).
<P>
</OL><h3>Modifying the Schema</h3>
 

<OL><P><LI>Start the dbWeb Administrator.

<P><LI>Double-click the dbnwind data source.

<P><LI>Double-click the Employees schema.

<P><LI>Click the Schema tab, and then click to select the Update check box.

<P><LI>Click the QBE tab.

<P><LI>In the "Data columns in selected tables" box, select Employee ID, and
    then click Add.

<P><LI>Click the Ins/Upd/Del tab.

<P><LI>In the "Data columns in selected tables" box, select each of the
    following fields, and then click Add:
<P>
       Employee ID
       Last Name
       First Name
       Title
       Address
       City
       Region
       Postal Code
       Country
       Home Phone

<P><LI>In the "Update data columns" box, select Employee ID, and then click
    Properties.

<P><LI>Under Column Properties, set the Key property to Key(non updateable).

<P><LI>Click the DBX tab.

<P><LI>In the "Single record result output custom format file" box, click
    Browse to find the Upempinf.htm file (in the \inetsrv\wwwroot\dbweb
    folder, if IIS is your server).

<P><LI>Click Apply.
<P>
</OL><h3>View the custom update form:</h3>
 

<OL><P><LI>Open your favorite browser, and type the URL path to the Employees
   schema using the getxqbe method. For dbWeb 1.1, the default path is
   /scripts/dbweb/dbwebc.dll/Employees?getxqbe. For dbWeb version 1.0, the
   default path is /scripts/dbweb/$dbwebc.exe/Employees?getxqbe.

<P><LI>On the Employees QBE page, type 1 in the Employee ID field.

<P><LI>Click the Submit Query button to run the query and invoke your custom
   Update form.

<P><LI>Change some information on the form, and then click Submit Update. You
   will receive a success or failure message.
<P>
</OL>NOTE: If Submit Query returns more than one record, you will not see the
custom Update form you created. In this example, you must limit the query
results to one record. However, it is possible to use this form for
multiple record queries. Just set Upempinf.htm as the "Multi record result
output custom format" file on the DBX tab of the Employees schema.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : DbwebUsage kbusage<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
