

<HTML>
<HEAD>
<TITLE>ACC: How Replication Manager Determines Base Replica </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173002">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1997/08/21">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft Replication Manager is a tool included with the Microsoft Access Developer's Toolkit (ADT) for Windows 95, version 7.0, and with Microsoft Office 97 Developer Edit...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFO,QA2O,QABA,QBXS,QAGU,QAH5,QACI,QBWS,QAGR,QANJ,QAEF,QBJZ,QDMC,QA9N,QBWE P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How Replication Manager Determines Base Replica</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173002</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access Developer's Toolkit, version 7.0
<LI>Microsoft Office 97 Developer Edition Tools
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Replication Manager is a tool included with the Microsoft Access
Developer's Toolkit (ADT) for Windows 95, version 7.0, and with Microsoft
Office 97 Developer Edition Tools. An important feature of Microsoft
Replication Manager is its ability to manage members of a replica set, and
schedule synchronizations between them.
<P>
One of the components that Microsoft Replication Manager uses to control
synchronization is the Synchronizer (formerly known as the Transporter in
Microsoft Replication Manager 3.0). The Synchronizer is a program that runs
in the background and allows database changes to be stored in a dropbox
folder for later synchronization. This is especially useful when you are
distributing your application to users with portable computers that are not
always connected to the network.
<P>
When initiating synchronization between members of a replica set managed by
multiple Synchronizers, each Synchronizer selects one replica that sends
changes to and receives changes from a member of the replica set managed by
a different Synchronizer. Likewise, when initiating a local synchronization
of a replica set managed by one Synchronizer, Microsoft Replication Manager
selects one replica that sends changes to and receives changes from all
other replicas in the set. This replica is called the "base" or "gateway"
replica.
<P>
This article discusses how the Synchronizer determines which replica is
designated as the base replica, and what problems may occur as a result.
<P>
NOTE: This article assumes you have previously configured Microsoft
Replication Manager and are currently managing multiple members of a
replica set.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Each Synchronizer is responsible for determining which one of the members
of the replica set it is currently managing becomes the base replica. The
Synchronizer uses the following algorithm to determine which replica
becomes the base replica:

<OL><P><LI>Determine which members of the replica set currently managed by this
   Sychronizer are still valid (that is, not deleted, renamed,
   inaccessible, and so on).

<P><LI>Exclude any partial replicas in the set. Only full replicas can be
   base replicas.

<P><LI>Of the remaining replicas, select the replica with the lowest Replica
   ID. This replica becomes the base replica; it is designated to send
   and receive changes during synchronization.
<P>
</OL><h3>Determining the Current Base Replica</h3>
 
<P>
To determine which replica has been designated as the base replica by the
Synchronizer, follow these steps:

<OL><P><LI>Start Microsoft Replication Manager.

<P><LI>On the File menu, click Open Replica Set. Select a member of a replica
   set you have previously managed with Microsoft Replication Manager,
   and then click OK. (In Microsoft Replication Manager 3.0, select
   a folder you have previously managed from the Folders list.)

<P><LI>Right-click the Synchronizer icon that is managing the replica
   set, and then click "Synchronize Locally Managed Replicas."

<P><LI>After the synchronization is complete, right-click the Synchronizer
   icon again, and then click "View Synchronizer Log File." (In Microsoft
   Replication Manager 3.0, point to the View menu, and then click
   Transporter Log.)

<P><LI>Scroll to the end of the text file and look for entries in the log
   documenting the latest synchronization. These entries should
   look similar to the following:
<P>
<P><PRE>       Time = 8/7/97 4:00:05 PM
       Log Type =  Direct exchange
       Result = Success
       Replica = C:\Windows\Replicas\Replica1.mdb
       ReplicaID = {33F32D42-0F20-11D1-9B50-00AA00B67747}
       Partner Replica Set Member = C:\WINDOWS\replicas\Replica2.mdb
       ReplicaID = {03B1A944-0F20-11D1-9B50-00AA00B67747}
</PRE><P>
   Note the "Replica = " entry. This identifies the base replica of the
   replica set for this synchronization. In the example in Step 5, the
   base replica is "C:\Windows\Replicas\Replica1.mdb."
<P>
</OL><h3>Base Replica Scenario</h3>
 
<P>
There are scenarios in which the base replica selected by the Synchonizer
could cause synchronization to take an extended amount of time and generate
unexpected network traffic. Consider the following:
<P>
You have one replica set with three replicas (R1, R2, and R3), located on
three computers (Machine A, Machine B, and Machine C). R1 is located on
Machine A, R2 is located on Machine B, and R3 is located on Machine C. All
three replicas are being managed by a Synchronizer running on Machine A.
Machines A and B are both located on the same local area network (LAN),
while Machine C is located on a separate LAN that is accessible over a
wide area network (WAN).
<P>
Assume that R3 has the lowest Replica ID in this replica set, and that all
replicas in the set are valid (not deleted, renamed, or inaccessible).
Synchronizer will select R3 as the base replica. Therefore, when
synchronization is initiated through Microsoft Replication Manager, R3 will
be involved in every synchronization to other members of the same replica
set managed by this Synchronizer. Since R3 is physically located on a
remote computer, this may cause synchronization to take an extended amount
of time and cause an unanticipated amount of network traffic. In this
scenario, you can improve performance and reduce the amount of network
traffic by moving R3 to Machine A (where its Synchronizer is located) and
by moving one of the other replicas to Machine C.
<P>
<P><h3>Moving a Replica in Microsoft Replication Manager</h3>
 
<P>
To move a managed replica to another location, follow these steps. If you
manually move a managed replica instead of following these steps, the
replica will be marked as invalid, and it will be removed from the list of
managed replicas.

<OL><P><LI>Start Microsoft Replication Manager.

<P><LI>On the File menu, click Open Replica Set. Select a member of a replica
   set you have previously managed with Microsoft Replication Manager,
   and then click OK. (In Microsoft Replication Manager 3.0, select a
   folder you have previously managed from the Folders list.)

<P><LI>On the File menu, click Move Replica.

<P><LI>In the Move Replica dialog box, select the replica you want to move,
   and then click Open.

<P><LI>In the Move To dialog box, select the location you want to move
   the replica to, and then click Save.

<P><LI>Repeat steps 3 - 5 for each replica you want to move.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about Microsoft Replication Manager, please see the
Microsoft Jet Replication white paper. This white paper is included with
Microsoft Office 97 Developer Edition Tools. You may also obtain this white
paper from the Microsoft Software Library on the World Wide Web. For more
information on how to obtain the Microsoft Jet Replication white paper,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q164553.htm">Q164553</A></B>
   TITLE     : ACC97: Jet 3.5 Replication White Paper Available on MSL
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hub gateway<BR>
Component         : jet<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
