

<HTML>
<HEAD>
<TITLE>UT97: "Overflow" or "Division by zero" Error Upsizing Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165827">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1997/03/25">
<META NAME="Keywords" CONTENT="AutPrb WzOthr WzProb kberrmsg kbother">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you use the Microsoft Access 97 Upsizing Tools to export a table to Microsoft SQL Server, you receive one of the following errors when you try to export a large table w...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA5V,QAH4,QAZV,QABM,QAB4,QAKC,QANF,QBS0,QAB9,QBXT,QBWS,QBC6,QA7O P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>UT97: "Overflow" or "Division by zero" Error Upsizing Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165827</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97 Upsizing Tools
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you use the Microsoft Access 97 Upsizing Tools to export a table to
Microsoft SQL Server, you receive one of the following errors when you try
to export a large table with few or no records:
<P>
<PRE>   Overflow

   -or-

   Division by zero

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You must add error handling to the UT_ComputeLocksNeeded procedure in the
Upsizing Wizard database. The extra code sets the number of locks needed to
0 when the number of records in the table is small and the number of fields
in the table is large:

<OL><P><LI>Start Microsoft Access 97 and open the Upsizing Wizard database,
   Wzcs97.mda. This database is installed by default in the \Program
   Files\Microsoft Office\Office folder.
<P>
   NOTE: If you have already used the Upsizing Wizard in the current
   session of Microsoft Access, you must quit and restart Microsoft Access
   before you can open the Wizard database.

<P><LI>Open the UT_modUpsizerMain module in Design view.

<P><LI>Add code to the UT_ComputeLocksNeeded procedure so it looks like the
   following. Note that the four lines you need to add are commented to
   make them easier to see:
<P>
<P><PRE>      '-------------------------------------------------------------------
      ' UT_ComputeLocksNeeded
      '
      ' Computes the number of SQL Server locks needed to upsize a given
      ' table. The formula used is:
      '
<PRE></PRE>      '       r / (p \ s)
      '
      ' where:
      '       s = max record size (we don't average text fields)
      '       p = SQL Server page size less overhead
      '       r = number of records in the table
      '-------------------------------------------------------------------
      Function UT_ComputeLocksNeeded(tdf As TableDef) As Long
      On Error GoTo Error_out                ' Add this line.
      Dim fld As Field
      Dim lngRecSize As Long
      Dim intBytesPerPage As Integer

      ' Get record size.
      For Each fld In tdf.Fields
         lngRecSize = lngRecSize + fld.Size
      Next

      ' Get bytes available per page.
      intBytesPerPage = UT_SQL_PAGE_SIZE - UT_SQL_PAGE_OVERHEAD

      ' Compute number of pages, and thus locks, needed.
      UT_ComputeLocksNeeded = tdf.RecordCount / (intBytesPerPage \ _
         lngRecSize)
      Exit Function                          ' Add this line.
      Error_out:                             ' Add this line.
      UT_ComputeLocksNeeded = 0              ' Add this line.
      End Function

</PRE><P><LI>Save the UT_modUpsizerMain module.

<P><LI>On the Debug menu, click "Compile and Save All Modules."

<P><LI>Close the UT_modUpsizerMain module and the Wzcs97 database.

<P><LI>Open your database and upsize your table.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access Upsizing
Tools 97. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Microsoft Access 97 and open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure. This procedure creates
   an empty table with 100 text fields of 50 characters each:
<P>
<P><PRE>      Function MakeUpsizeTable()
      Dim db As Database
      Dim td As TableDef
      Dim fd As Field
      Dim i As Integer
      Set db = CurrentDb
      Set td = db.CreateTableDef("tblUpsizeTable")
      For i = 1 to 100
<PRE></PRE>         Set fd = td.CreateField("Field" &amp; i, dbText, 50)
         td.Fields.Append fd
      Next i
      db.TableDefs.Append td
      RefreshDatabaseWindow
      Msgbox "Table Created."
      End Function

</PRE><P><LI>To create the table, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       ?MakeUpsizeTable
</PRE>
<P><LI>Close the module. You do not need to save it.

<P><LI>On the Tools menu, point to Add-Ins, and then click Upsize to
   SQL-Server.

<P><LI>Follow the instructions on your screen to log on to your SQL Server
   database and upsize the table tblUpsizeTable. Note that you receive the
   error message "Overflow."
<P>
</OL><h2>REFERENCES</h2>
 
<P>
You can download the Microsoft Access Upsizing Wizard 97 free of charge
from the Microsoft Access Developer Forum Web site at the following
address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/accessdev/a-free.htm">http://www.microsoft.com/Accessdev/a-free.htm</A></B>

</PRE></OL>Click the link to Microsoft Access Upsizing Tools 97 to download and
install the wizard.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: uw divide<BR>
Keywords          : AutPrb WzOthr WzProb kberrmsg kbother<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
