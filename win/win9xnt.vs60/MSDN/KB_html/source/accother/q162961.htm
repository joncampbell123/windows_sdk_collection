

<HTML>
<HEAD>
<TITLE>ODE97: Run-Time Application Can't Find System.mdw After Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162961">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="StpOthr kberrmsg kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the Microsoft Office 97 Developer Edition Tools (ODE Tools) Setup Wizard to create a setup image for a run-time application, you may receive the following error mess...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QBWS,QA9A,QAJH,QAPN,QBWR,QAB4,QBV8,QDL9,QBWO,QBWN,QAFI,QAH4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ODE97: Run-Time Application Can't Find System.mdw After Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162961</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
<LI>Microsoft Office 97 Developer Edition Tools
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the Microsoft Office 97 Developer Edition Tools (ODE Tools)
Setup Wizard to create a setup image for a run-time application, you may
receive the following error message when you run your Setup program on
another computer:
<P>
<PRE>   Couldn't find file C:\Windows\System\System.mdw

</PRE>NOTE: The path to System.mdw may be different in your error message; it
will display the path to the Windows System folder on your computer.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you created the setup image, you clicked to select the Workgroup and
Run-Time check boxes when you let the Wizard create a command-line for your
application's shortcut, but you did not include a workgroup information
file with your application.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are four methods to resolve this problem.
<P>
Methods 1 and 2 prevent the error from occurring by modifying the command
line created by the Setup Wizard or by including a workgroup information
file with your application's setup files.
<P>
Methods 3 and 4 fix the error after your application is already installed
by modifying your application's shortcut or by moving the workgroup
information file.
<P>
<P><h3>Method 1: Modifying the Wizard-Created Command Line</h3>
 

<OL><P><LI>Open your application's setup options in the Setup Wizard.

<P><LI>Proceed to the "Add the shortcuts" screen in the Setup Wizard, and
   select your application's shortcut in the List Of Shortcuts box.

<P><LI>Click to select the "I would like to specify my own custom command line"
   option.

<P><LI>Edit the text in the Command Line box to change the /wrkgrp command-line
   option. Change this portion of the command line
<P>
<P><PRE>      /wrkgrp $(WorkgroupFile)
</PRE><P>
   to:
<P>
<P><PRE>      /wrkgrp "$(FilePath)\System.mdw"
</PRE><P>
   Following is an example of how the modified shortcut will look with
   /runtime and /wrkgrp command-line options:
<P>
<P><PRE>      "msaccess.exe"  /runtime  /wrkgrp "$(FilePath)\System.mdw
<PRE></PRE>         "$(FilePath)\MyNewApp.mdb"

</PRE><P><LI>Proceed through the remaining screens of the Setup Wizard and create a
   new setup image for your application.
<P>
</OL><h3>Method 2: Including a Workgroup Information File with Your Setup</h3>
 

<OL><P><LI>Open your application's setup options in the Setup Wizard.

<P><LI>In the Add The Files screen in the Setup Wizard, click the Add button,
   and then add a workgroup information file.
<P>
   NOTE: If you try to add the workgroup file to which you are currently
   joined, you receive the following errors when the Setup Wizard tries to
   create your setup image:
<P>
<P><PRE>      Permission denied
</PRE><P>
<P><PRE>      The creation of your custom Setup program was not completed
      successfully.
</PRE><P>
   This error occurs because the workgroup file is in use by you. Use the
   Workgroup Administrator to temporarily join another workgroup file
   before you run the Setup Wizard, or include a different workgroup file
   in your setup image.

<P><LI>Proceed through the remaining screens of the Setup Wizard and create a
   new setup image for your application.
<P>
</OL><h3>Method 3: Modifying Your Application's Shortcut</h3>
 
<P>
After your run-time application is installed, you can modify the shortcut
to your application so that it looks for the workgroup information file in
the correct location.
<P>
<P><h3>In Microsoft Windows 95 or Microsoft Windows NT version 4.0</h3>
 

<OL><P><LI>Click the Start button on the taskbar, point to Settings, and then
   click  Taskbar.

<P><LI>In the Taskbar Properties dialog box, click the Start Menu Programs
   tab, and then click the Advanced button.

<P><LI>Locate your application's folder and the application shortcut in
   Windows Explorer.

<P><LI>Using the right mouse button, click the shortcut, and then click
   Properties on the shortcut menu that appears.

<P><LI>In the Properties dialog box, click the Shortcut tab.

<P><LI>Modify the command line in the Target box so that the /wrkgrp option
   is followed by the correct path to the System.mdw file. For example,
   change this portion of the command line
<P>
<P><PRE>      /wrkgrp C:\Windows\System\System.mdw
</PRE><P>
   to:
<P>
<P><PRE>      /wrkgrp "C:\My Application\System.mdw"
</PRE><P>
   Note that you must place quotation marks around the path and file
   name if it contains any spaces.

<P><LI>Click OK in the Properties dialog box, and then close Windows
   Explorer and the Taskbar Properties dialog box.
<P>
</OL><h3>In Microsoft Windows NT version 3.51</h3>
 

<OL><P><LI>Open your application group in Program Manager.

<P><LI>Select your application's icon by clicking it once.

<P><LI>On the File menu, click Properties.

<P><LI>In the Program Item Properties dialog box, modify the command line in
   the Command Line box so that the /wrkgrp option is followed by the
   correct path to the System.mdw file. For example, change this portion
   of the command line
<P>
<P><PRE>      /wrkgrp C:\Windows\System\System.mdw
</PRE><P>
   to:
<P>
<P><PRE>      /wrkgrp "C:\My Application\System.mdw"
</PRE>
<P><LI>Click OK in the Program Item Properties dialog box.
<P>
</OL><h3>Method 4: Moving the Workgroup Information File</h3>
 
<P>
After your application is installed, the shortcut looks for the System.mdw
file in the Windows System folder by default. Your Setup program installed
the System.mdw in your application's main folder. If you copy or move the
System.mdw file to the Windows System folder, the shortcut will work
correctly as is.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Office 97
Developer Edition Tools. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Workgroup Administrator, Wrkgadm.exe, is included with your run-time
application by the Setup Wizard. If you do not include a workgroup
information file (called System.mdw by default) with your setup files, the
Workgroup Administrator automatically creates one when you run Setup for
your application. Workgroup Administrator creates the System.mdw file in
the folder where your application is installed. However, the Setup Wizard
incorrectly sets the /wrkgrp command-line option to look for System.mdw in
the Windows System folder when it creates your application's shortcut. This
only happens when you indicate to the Setup Wizard that you want to include
the Workgroup command-line option in your application's shortcut, but you
do not include your own workgroup information file.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start the ODE Tools Setup Wizard.

<P><LI>In the first screen of the Setup Wizard, click "Create a new set of
   setup options for my application's custom Setup program," and then click
   Next.

<P><LI>In the "Add the files" screen of the Setup Wizard, click the Add button,
   and then add the sample database Northwind.mdb. Click to select the "Set
   as Application's Main File" check box, and then click Next.

<P><LI>In the Add The Shortcuts screen of the Setup Wizard, click the Add
   button. The Setup Wizard automatically creates a new shortcut for
   Northwind.mdb. Type Northwind Test in the Description box for the new
   shortcut.

<P><LI>Click the Database Shortcut Properties tab, and then click Workgroup and
   Run-Time under Database Command-Line Options.

<P><LI>Click Next, answer Yes when prompted to include the Microsoft Access
   run-time executable file, and then click OK when prompted about
   including a workgroup information file.

<P><LI>Click Next until you get to the final screen in the Setup Wizard, "Where
   do you want the Setup Wizard to copy the files for your custom Setup
   program?". Select a folder for the setup files, and click to select a
   check box for the kind of distribution disks you want to create.

<P><LI>Click Finish and let the Setup Wizard create your setup image. You do
   not need to save the current Setup template when prompted.

<P><LI>After the Setup Wizard finishes, run Setup for this custom application
   on a computer that does not have Microsoft Access installed. Then start
   the Northwind Test application and note that you receive the error
   message mentioned in the "Symptoms" section of this article.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using the Workgroup Administrator, search the
Help Index for "Workgroup Administrator," or ask the Microsoft Access 97
Office Assistant.
<P>
For more information about workgroup information files, search the Help
Index for "workgroup information files," or ask the Microsoft Access 97
Office Assistant.
 
<PRE>Keywords          : StpOthr kberrmsg kbsetup
Version           : 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
