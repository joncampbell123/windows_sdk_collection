

<HTML>
<HEAD>
<TITLE>ODE97: Setup Wizard Fails to Register New File Name Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162934">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1997/01/30">
<META NAME="Keywords" CONTENT="StpOthr kbtool">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you change the application's main file name or extension, the dialog page that you use to set up the Registry Values List for your main application file does not reflect the...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAKD,QAFI,QDI2,QBWS,QDNJ,QAUJ,QDIZ,QA50,QABA,QAMA,QAAW,QABI,QDKX,QBWJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ODE97: Setup Wizard Fails to Register New File Name Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162934</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 Developer Edition Tools
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you change the application's main file name or extension, the dialog
page that you use to set up the Registry Values List for your main
application file does not reflect the change to the base value, if the
value data is set to "$(FilePath)\&lt;Name of the File&gt;." For example, if you
change the name of the "Northwind.mdb" file to "Northwind.mde," the Value
Data entry does not change to "$(FilePath)\Northwind.mde" (without the
quotation marks). This will be a problem, if you change your installation
routines to use the new .mde extension.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is by design.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To change the value of the original file name to the correct new file name,
you must manually change the Value Data entry in the main file selection in
the Registry Values list.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start the Setup Wizard. Select "Create a new set of setup options for
    my application's custom Setup program." Click Next.

<P><LI>Add the sample Northwind database to the List of Files dialog box.

<P><LI>Click to select the "Set as Application's Main File" check box. Click
    Next.

<P><LI>Click Next to skip the List Of Shortcuts dialog box.

<P><LI>Click Add in the List of Registry Values dialog box.

<P><LI>In the "Top level for the Key" box, type "HKEY_LOCAL_MACHINE" (without
    the quotation marks).

<P><LI>In the "Path to the Key" box, type
    "Software\Microsoft\Office\8.0\Access\Menu Add-Ins" (without the
    quotation marks).

<P><LI>In the Value Name box type "Library" (without the quotation marks).

<P><LI>In the "Base Value Data on File" box, type the path and name of the
    application file (&lt;path&gt;\Northwinds.mdb).

<P><LI>Make sure that the Value Data box contains "$(FilePath)\Northwind.mdb"
    (this is the default).

<P><LI>Accept the rest of the defaults on each of the following screens, but
    on the last screen, click Save and save the template.

<P><LI>Click Finish to close the Setup Wizard.

<P><LI>Create another copy of the Northwind.mdb file named Northwind.mde.

<P><LI>Open the Setup Wizard.

<P><LI>Select the option to open an existing template, and choose "Use
    previously saved setup options to create a custom Setup program for
    my application."

<P><LI>Highlight the File Name and Path box, and change the path and file to
    the location of the Northwind.mde file you just created.

<P><LI>Click Next, Next to get to the Registry Values dialogs.
<P>
</OL>Note that the value displayed for Value Data reflects the old file name
$(&lt;path&gt;\Northwind.mdb). If you run the setup, this will cause the registry
entry to be incorrect for the name of the database. This issue manifests
itself as a real problem when you are installing a wizard. The registry
entry will be incorrect, making it difficult to troubleshoot and determine
why the add-in will not start.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MDE<BR>
Keywords          : StpOthr kbtool<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
