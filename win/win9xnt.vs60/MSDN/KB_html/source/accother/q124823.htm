

<HTML>
<HEAD>
<TITLE>ADK/ADT: How to Create Pop-up, Context-Sensitive Help </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124823">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1995/01/12">
<META NAME="Keywords" CONTENT="kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  One alternative to displaying your application's online Help system in a separate window is to display it in a small, shaded pop-up window within your application. To do so,...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAH4,QDL9,QBWO,QBWN,QAY5,QBV8,QAB5,QAB9,QAPN,QBK5,QA5F,QAMA,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ADK/ADT: How to Create Pop-up, Context-Sensitive Help</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124823</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access Distribution Kit version 1.1
<LI>Microsoft Access Developer's Toolkit version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
One alternative to displaying your application's online Help system in a
separate window is to display it in a small, shaded pop-up window within
your application. To do so, you can use the Windows API WinHelp() function
with its HELP_CONTEXTPOPUP argument. This article describes how to
implement such a Help system.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Introduction to Programming" manual in Microsoft Access
version 1.x, or the "Building Applications" manual in version 2.0.
<P>
This article also assumes that you are familiar with creating Windows Help
files. For more information about creating Help files, refer to the "Help
Compiler Guide" included with the Microsoft Access Distribution Kit
version 1.1 and the Microsoft Access Developer's Toolkit version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Windows API WinHelp() function supports a large number of options. The
HELP_CONTEXTPOPUP option opens a shaded pop-up window for you to display
Help in. This window is similar to the window that opens when you click a
glossary entry (green underlined text) in the Microsoft Access Help system.
<P>
To implement this feature you need to:

<UL><LI>Create a working Help system by setting the HelpContextID and HelpFile
   properties for your forms to a valid Windows Help file.

<LI>Redirect the F1 key to call a user-defined function that opens the
   Help file using the HELP_CONTEXTPOPUP option.
<P>
</UL>Note that jumping or branching to other Help topics from the pop-up Help
window is not supported using the methods discussed in this article.
<P>
The following steps describe how to create the user-defined function to
open the pop-up Help window and how to redirect the F1 key.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.

<OL><P><LI>Open a new module and declare the Windows API WinHelp() and FindWindow()
   functions by entering the following lines in the module's Declarations
   section:
<P>
<P><PRE>      Declare Function WinHelp% Lib "User" (ByVal hwnd%, ByVal _
      szHelpFile$, ByVal uCmd%, ByVal dwData&amp;)
      Declare Function FindWindow% Lib "User" (ByVal szClass$, ByVal _
      szTitle As Any)
</PRE><P>
   NOTE: You may have some Microsoft Windows API functions defined in an
   existing Microsoft Access library; therefore, your declarations may be
   duplicates. If you receive a duplicate procedure name error message,
   remove or comment out the declarations statement in your code.

<P><LI>Enter the following line to add the constant for HELP_CONTEXTPOPUP:
<P>
<P><PRE>      Const HELP_CONTEXTPOPUP = 8
</PRE>
<P><LI>Enter the following code in the module:
<P>
<P><PRE>      Function Help ()
<PRE></PRE>         Dim Cid As Integer, Dummy As Integer
         On Error Resume Next
         ' Get the HelpContextID of the active control.
         Cid = Screen.ActiveControl.HelpContextID
         ' The error is 2474 if no control is active.
         If Cid = 0 Then
            ' There is no control context ID, so check the form and get
            ' the HelpContextID of the active form.
            Cid = Screen.ActiveForm.HelpContextID
            ' The error is 2475 if no form is active.
         End If
         ' If there is a context ID, open the Help file with context.
         ' FindWindow() returns the handle of the Microsoft Access window.
         ' Specify your custom Help file for the second argument.
         If Cid &gt; 0 And Cid &lt; 32767 Then
            Dummy = WinHelp(FindWindow("OMain", 0&amp;), "C:\Myhelp.Hlp", _
            HELP_CONTEXTPOPUP, Cid)
         End If
      End Function

</PRE><P><LI>Create the following new macro called AutoKeys to redirect the F1 key:
<P>
<PRE>      Macro Name   Condition   Action
      --------------------------------
      {F1}                     RunCode

      AutoKeys Action
      ------------------------
      RunCode
         Function Name: Help()

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Microsoft Windows version 3.0 Software Development Kit "Reference Volume 1"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pop up popup<BR>
Keywords            : kbprg PgmOthr<BR>
Version             : 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
