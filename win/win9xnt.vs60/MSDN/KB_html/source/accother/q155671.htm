

<HTML>
<HEAD>
<TITLE>DBWEB: NT 3.51 SP4 Doesn't Restart After Installing dbWeb1.1a </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155671">
<META NAME="KBModify" CONTENT="1997/08/04">
<META NAME="KBCreate" CONTENT="1996/09/04">
<META NAME="Keywords" CONTENT="DbwebInstall kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Windows NT Server 3.51 with Service Pack 4 does not restart after you install Microsoft dbWeb 1.1a. A blue screen appears with the message:     SESSION3_INITIALIZATION_FAILED  CAUSE =====  The initial release of dbWeb 1.1a contained a Setup program...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDI2,QDIZ,QAR4,QA9N,QANE,QDO3,QBVV,QDL9,QBWQ,QBWO,QBWN,QDK2,QAXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DBWEB: NT 3.51 SP4 Doesn't Restart After Installing dbWeb1.1a</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155671</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft dbWeb version 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Windows NT Server 3.51 with Service Pack 4 does not restart after you
install Microsoft dbWeb 1.1a. A blue screen appears with the message:
<P>
<PRE>   SESSION3_INITIALIZATION_FAILED

</PRE><h2>CAUSE</h2>
 
<P>
The initial release of dbWeb 1.1a contained a Setup program that failed to
copy the Microsoft Windows NT 3.51 system file Smss.exe back onto the hard
drive after removing the original Smss.exe from the \Winnt\System32 folder.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Rerun Windows NT Server Setup and initiate the emergency repair process in
order to copy Smss.exe back to the \Winnt\System32 directory. To do this,
you need the original Windows NT Server installation disks and CD-ROM.
<P>
You can use an emergency repair disk with Setup, but it is not required.
If you do not supply an emergency repair disk, Setup will attempt to use
the repair directory on the hard drive. An emergency repair disk created
for one computer will not work on another computer. Use the following steps
to rerun Setup and initiate the emergency repair process.
<P>
NOTE: The following steps assume that Windows NT is installed in a folder
called \Winnt. Change the folder name as appropriate for your computer.

<OL><P><LI>Restart the computer using the Windows NT Setup startup disk. When
   prompted, insert Windows NT Setup disk 2.

<P><LI>When the Windows NT Setup screen appears, type R to initiate the
   emergency repair process. Follow the instructions on screen to clear
   and select from the following:
<P>
<P><PRE>      [ ] Inspect registry files
      [ ] Inspect startup environment
      [X] Verify Windows NT system files
      [ ] Inspect boot sector
      Continue (perform selected tasks)
</PRE><P>
   Select Verify Windows NT system files.

<P><LI>Select Continue (perform selected tasks) and press ENTER.

<P><LI>Press ENTER to continue detection of mass storage devices in your
   computer. When prompted, insert Setup disk 3 and press ENTER.

<P><LI>Press ENTER to continue without specifying additional mass storage
   devices in your computer. At the next screen, press ENTER to continue.

<P><LI>When prompted, insert your Emergency Repair disk and press ENTER. If
   you do not have an Emergency Repair disk, Windows NT will use the
   Repair folder on your hard drive.

<P><LI>Setup asks if you want your hard disks examined for corruption. Because
   the purpose of this repair is to copy Smss.exe back into the
   \Winnt\System32 folder, you can press ESC to skip disk verification.

<P><LI>The emergency repair process will check the date and time of files on
   your computer to determine if they are the original files copied by the
   Windows NT Server installation. Because Service Pack 4 is installed,
   Setup prompts you to replace many files, but Smss.exe is the only file
   you need to copy. When Setup prompts you to replace a file, press ESC
   to bypass the replacement for all files except Smss.exe.

<P><LI>Press ENTER to restart your computer.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
A setup program sometimes attempts to upgrade system files. Because it
cannot overwrite files when they are in use, Setup copies the new files as
temporary files to a temporary location, and creates new Windows registry
entries detailing which files need to be deleted or overwritten. When you
restart your computer, Smss.exe reads the registry files and performs those
actions.
<P>
The version of Smss.exe in Windows NT 3.51 Service Pack 4 does not perform
its task correctly, so the dbWeb 1.1 and 1.1a Setup program compares the
date and time on the current Smss.exe file to the one in its compressed
archive. If the latter file has a more recent date and time, the Setup
program prompts you whether you want to install a patch to NT 3.51 SP4.
<P>
This works fine in the initial release of dbWeb 1.1. However, with dbWeb
1.1a, the Smss.exe file location in the Setup program's compressed archive
was changed because it caused a problem during the digital signing process
(necessary for all downloads from the www.microsoft.com Internet address).
The setup script, however, does not reflect the change in location, and it
expects to find Smss.exe in its old location. During setup, if you choose
to install the patch to Windows NT 3.51 SP4, the dbWeb 1.1a Setup program
schedules the renaming of the old Smss.exe, but does not copy the new
Smss.exe because it cannot find it in its compressed archive.
<P>
Upon restart, Windows NT cannot find Smss.exe, which is necessary for
startup, so it displays the STOP message, "SESSION3_INITIALIZATION_FAILED."
 
<PRE>Keywords          : DbwebInstall kberrmsg
Version           : 1.1
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
