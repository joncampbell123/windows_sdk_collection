

<HTML>
<HEAD>
<TITLE>ODE: Print Command Not Available in Run-Time Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173796">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1997/09/12">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you build a custom menu bar in Microsoft Access 97 and include the built-in File menu, some commands do not appear on the menu in the run-time environment. For example, the ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAF0,QANS,QBWS,QBJZ,QAOX,QA1S,QBV8,QAB9,QA01,QDN9,QANX,QAPN,QAVI,QDKX,QARW P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ODE: Print Command Not Available in Run-Time Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173796</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 Developer Edition Tools
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you build a custom menu bar in Microsoft Access 97 and include the
built-in File menu, some commands do not appear on the menu in the run-time
environment. For example, the Print command does not appear on the menu; as
a result, you cannot modify the printer settings or properties.
<P>
<P><h2>CAUSE</h2>
 
<P>
Some menu commands, such as the Print command from the default File menu,
are disabled in the run-time environment.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use either of the following two methods.
<P>
<P><h3>Method 1: Use the Command Bar Wizard</h3>
 
<P>
You can use the Command Bar Wizard to replace the default menu bar with a
custom menu bar; the Command Bar Wizard is available on the Microsoft World
Wide Web site. For more information about obtaining the Command Bar Wizard,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q172300.htm">Q172300</A></B>
   TITLE     : ACC97: Command Bar Wizard Available on MSL

</PRE>Follow these steps to create a custom menu bar using the Command Bar
Wizard:

<OL><P><LI>Open your database in Microsoft Access 97.

<P><LI>On the Tools menu, point to Add-ins, and then click Command Bar Wizard.

<P><LI>Under Select Type in the Command Bar Wizard dialog box, click New, and
   then click Next.

<P><LI>In the Select Template list, click Database, and then click Next.

<P><LI>Click Next, and then type a name for the menu in the Menu Name box.

<P><LI>Click Build.
<P>
   NOTE: The Command Bar Wizard will create a new menu and close any
   existing menus. You can dock the custom menu bar or move it to any
   location on the screen.

<P><LI>On the Tools menu, click Startup.

<P><LI>In the Startup dialog box, type or select your menu in the Menu Bar box.

<P><LI>Click OK.
<P>
</OL>Note that the Print command is available when you open this database in the
run-time environment, either by running a Microsoft Access application
installed from disk images created with the Microsoft Office 97 Developer
Edition or by running Microsoft Access using the /runtime switch. When you
click Print, the Print dialog box appears.
<P>
<P><h3>Method 2: Call a Custom Print Function</h3>
 
<P>
You can create a Microsoft Visual Basic for Applications function that
displays the Print dialog box and attach that function to a custom Menu
Bar. To do so, follow these steps:

<OL><P><LI>Open your database in Microsoft Access 97.

<P><LI>In the Database window, click the Modules tab, and then click New.

<P><LI>Type the following code in the module that you just created:
<P>
<P><PRE>      Public Function PrintOut()
<PRE></PRE>         ' Attached to a custom Print command on a custom menu bar.
         ' Use the RunCommand method to display the print dialog box.

         On Error GoTo ErrorTrap

         DoCmd.RunCommand acCmdPrint
         Exit Function

         ErrorTrap:
            ' Check whether the RunCommand method was canceled.
            ' If RunCommand is canceled, it generates a trappable
            ' run-time error (2501).
            If Err.Number = 2501 Then
               Exit Function
            Else
               MsgBox Err.Number &amp; vbCRLF &amp; Err.Description
            End If

      End Function

</PRE><P><LI>On the Debug menu, click Compile Loaded Modules.

<P><LI>Save the Module as basPrintFunction.
<P>
</OL>Follow these steps to create the custom menu bar:

<OL><P><LI>On the View menu, point to Toolbars, and then click Customize.

<P><LI>Click the Toolbars tab, and then click New.

<P><LI>In the New Toolbar dialog box, type a name in the Toolbar name box,
    and then click OK.

<P><LI>In the Customize dialog box, click Properties.

<P><LI>In the Toolbar Properties dialog box, click Menu Bar in the Type list,
    and then click Close.

<P><LI>In the Customize dialog box, click the Commands tab, and then click
    New Menu in the Categories list.

<P><LI>From the Commands box, drag New Menu to your custom menu bar.

<P><LI>On your custom menu bar, right-click New Menu and type a name for
    the menu in the Name box. Press ENTER.

<P><LI>In the Customize dialog box, click File in the Categories box, and drag
    Custom from the Commands box to your new menu.
<P>
    Note: When you drag the Custom command over the name of your new menu,
    it will create a blank menu. It is on this blank menu that you
    should place the Custom command.

<P><LI>On your custom menu bar, right-click the Custom command from step 9
    and type a command name, such as Print, in the Name box, and then click
    Properties.

<P><LI>In the &lt;menu name&gt; Control Properties dialog box, type "=PrintOut()"
    (without the quotation marks) in the On Action box, and then click
    Close.

<P><LI>Add any additional menu commands that you need in the same manner.

<P><LI>In the Customize dialog box, click Close.

<P><LI>On the Tools menu, click Startup.

<P><LI>In the Startup dialog box, type or select your menu in the Menu Bar
    box.

<P><LI>Click OK.
<P>
</OL>When you open your database in the run-time environment, either by running
a Microsoft Access application installed from disk images created with the
Microsoft Office 97 Developer Edition Tools or by running Microsoft Access
using the /runtime switch, note that the Print command is now available.
When you click Print, the Print dialog box appears.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: The following steps change the StartUpMenuBar property of the
Northwind sample database. You may want to back up the Northwind.mdb file
and perform these steps on a copy of the database.
<P>
<P><h3>Steps To Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access 97 and open the sample database Northwind.mdb.

<P><LI>On the View menu, point to Toolbars, and then click Customize.

<P><LI>In the Customize dialog box, click the Toolbars tab, and then click
    New.

<P><LI>In the New Toolbar dialog box, type a name in the Toolbar Name box, and
    then click OK.

<P><LI>In the Toolbars list, click the new toolbar, and then click Properties.

<P><LI>In the Toolbar Properties dialog box, click Menu Bar in the Type list,
    and then click Close.

<P><LI>In the Customize dialog box, click the Commands tab.

<P><LI>In the Categories list, click Built-in Menus.

<P><LI>From the Commands box, drag the File menu to the toolbar created in
    step 4.

<P><LI>In the Customize dialog box, click Close.

<P><LI>On the Tools menu, click Startup.

<P><LI>In the Startup dialog box, type or select your custom toolbar in the
    Menu Bar box, and then click OK.

<P><LI>Quit Microsoft Access and restart Northwind using the /runtime switch.
<P>
    For example, click Start on the taskbar, and then click Run. In the
    Open box, type the following command on a single line:
<P>
       "c:\Program Files\Microsoft Office\Office\msaccess.exe"
<PRE>        "c:\Program Files\Microsoft Office\Office\Samples\Northwind.mdb"
        /runtime

    Note that the custom menu bar appears when Northwind opens, but it does
    not show the Print command.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about changes in the run-time environment, search the
Microsoft ODE Tools Help Index for "disabled" or "disabled features in run-
time environment."
<P>
For additional information about differences between the retail and run-
time versions of Microsoft Access, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q162521.htm">Q162521</A></B>
   TITLE     : ACC97: Differences Between Retail and Run-Time Microsoft
               Access

</PRE>For additional information about getting help with Visual Basic for
Applications, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prb print dialog menubar runtime<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto kbprb kbinfo<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
