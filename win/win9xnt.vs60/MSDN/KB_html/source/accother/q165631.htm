

<HTML>
<HEAD>
<TITLE>ODE97: Creating Profiles for Custom Application in Setup Wizard </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165631">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1997/03/24">
<META NAME="Keywords" CONTENT="WzOthr kbusage">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   Advanced: Requ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKD,QAA1,QATX,QDJ2,QAJH,QAUJ,QBVP,QA2O,QABA,QDNG,QAMB,QAYY,QAKC,QAP2,QAH4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ODE97: Creating Profiles for Custom Application in Setup Wizard</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165631</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 Developer Edition Tools
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to create registry entries for a user profile
for your application that includes a Help file, and Clipboard and Report
formats.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you use the Setup Wizard to add registry entries to your custom Setup
program that will create user profiles for your custom application, you
must click to select the Profile check box on the Database Shortcut
Properties tab on the Add Shortcuts screen, and you must create registry
entries for your user profiles on the screen marked "Add the registry
values that you want your custom Setup program to create and then set
properties for each."
<P>
There are three steps involved in creating a custom application that
includes a user profile. They are as follows:

<OL><P><LI>Adding the necessary files to the List Of Files box.

<P><LI>Creating a shortcut that includes the /Profile switch.

<P><LI>Creating the registry entries that will be copied to the Windows
   registry on the computer on which you are installing the application.
<P>
</OL>For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.

<OL><P><LI>To add files to the List Of Files box, start the Setup Wizard program
   and in the List Of Files box, add the files that you are including in
   your custom application. This should include any .hlp and .cnt files
   that you may be adding for your Help file. For example, if you were
   adding a content page, a Help file and a database file to the List Of
   Files box, your screen would look similar to this:
<P>
<P><PRE>      List of Files:
</PRE><P>
<P><PRE>      C:\My Documents\Northwind.mdb
      C:\Program Files\Microsoft Office\Office\Samples\Nwind80.hlp
      C:\Program Files\Microsoft Office\Office\Samples\Nwind80.cnt
</PRE>
<P><LI>To create a shortcut that includes the /Profile switch, follow these
   steps:
<P>
<P><PRE>    a. On the Add The Shortcuts screen, click the Database Shortcut
       Properties tab, click Add, and type a description for your shortcut
       in the Description box.
</PRE><P>
<P><PRE>    b. Under the Database Command-Line Options, click to select the Profile
       and Run-time check boxes, and then click Next.
</PRE><P>
<P><PRE>    c. Click Yes and then OK to the Setup Wizard messages.
</PRE><P>
<P><PRE>       NOTE: The shortcut that is created will open your custom application
       as a run-time application with a profile. You may also want to add a
       shortcut that will open your Help file.
</PRE>
<P><LI>To add the registry entries for your custom application, follow these
   steps:
<P>
<P><PRE>    a. In the "List of Registry Values" box, click Add and complete the
       following information for each entry that needs to be added to the
       registry:
</PRE><P>
<P><PRE>       Top-Level for Key: $(Machine's Software Key for App)
       Path to Key: Clipboard Formats
       Value Name: Microsoft Excel (*.xls)
       Base Value Data on File: (none)
       Value Data: soa800.dll,8,xls,Biff5,MicrosoftExcel(*.xls),0
       Value Data Type: String
       Component Name: Application
</PRE><P>
<P><PRE>       NOTE: The "Top-Level for Key" entry has the same effect as manually
       navigating to the HKEY_LOCAL_MACHINE\Software\YourCompanyName\
       YourApplicationName\YourVersionNumber key.
</PRE><P>
<P><PRE>       NOTE: The Path To Key has the same effect as manually adding a new
       key under the HKEY_LOCAL_MACHINE\Software\YourCompanyName\
       YourApplicationName\YourVersionNumber key.
</PRE><P>
<P><PRE>       Top-Level for Key: $(Machine's Software Key for App)
       Path to Key: Clipboard Formats
       Value Name: MS-DOS Text (*.txt)
       Base Value Data on File: (none)
       Value Data: soa800.dll,10,txt,7,MS-DOSText(*.txt),0
       Value Data Type: String
       Component Name: Application
</PRE><P>
<P><PRE>       Top-Level for Key: $(Machine's Software Key for App)
       Path to Key: Clipboard Formats
       Value Name: Rich Text Format (*.rtf)
       Base Value Data on File: (none)
       Value Data: soa800.dll,9,rtf,Rich Text
       Format,RichTextFormat(*.rtf),0
       Value Data Type: String
       Component Name: Application
</PRE><P>
<P><PRE>       Top-Level for Key: $(Machine's Software Key for App)
       Path to Key: Report Formats
       Value Name: Microsoft Excel
       Base Value Data on File: (none)
       Value Data: xls,SOA_RptToBIFF, Biff5,Microsoft Excel (*.xls),0
       Value Data Type: String
       Component Name: Application
</PRE><P>
<P><PRE>       Top-Level for Key: $(Machine's Software Key for App)
       Path to Key: Report Formats
       Value Name: MS-DOS Text
       Base Value Data on File: (none)
       Value Data: txt,SOA_RptToAscii,1,MS-DOS Text (*.txt),0
       Value Data Type: String
       Component Name: Application
</PRE><P>
<P><PRE>       Top-Level for Key: $(Machine's Software Key for App)
       Path to Key: Report Formats
       Value Name: Rich Text Format
       Base Value Data on File: (none)
       Value Data: rtf,SOA_RptToRTF,Rich Text Format,Rich Text Format
       (*.rtf),0
       Value Data Type: String
       Component Name: Application
</PRE><P>
<P><PRE>       Top-Level for Key: $(Machine's Software Key for App)
       Path to Key: Run-Time Options
       Value Name: AppHelpFile
       Base Value Data on File: Nwind80.hlp
       Value Data Type: String
       Value Data:
       Component Name: Application
</PRE><P>
<P><PRE>       NOTE: Use the "Base Value Data on File" box if the value of the key
       or entry that you are adding is a file name that you are adding to
       the Setup Wizard program, as in the case of a Custom Help file.
       The Value Data box will automatically be populated with the
       path to your Help file when you supply the Base Value Data on File
       value.
</PRE><P>
<P><PRE>    b. When you are finish adding all of the entries, click Next.
</PRE>
<P><LI>Continue through the Setup Wizard, answering the questions to design
   your custom setup program the way you want it.

<P><LI>Run your custom Setup program on a computer that does not have Microsoft
   Access.

<P><LI>Start the Registry Editor and navigate to the following keys:
<P>
<P><PRE>    a. \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Access Runtime\Profiles
</PRE><P>
<P><PRE>       You should see an entry similar to the following:
</PRE><P>
<PRE>       Name            Data
       ----------------------------------------------------------------
       YourAppName     "SOFTWARE\Microsoft Corporation\YourAppName\1.0"


    b. \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft Corporation\YourAppName

       You should see entries similar to the following:

        Microsoft Corporation
          YourAppName
             1.0
                Clipboard Formats
                Jet
                Report Formats
                Run-Time Options

       Clipboard Formats
       -----------------

       Name                    Data
       ----------------------------

       Microsoft Excel(*.xls)  "soa800.dll,8,xls,Biff5,MicrosoftExcel
                               (*.xls) ,0"

       MS_DOS Text             "MS-DOS Text (*.txt)"

       Rich Text Format        "soa800.dll,9,rtf,Rich Text Format,
                               RichTextFormat(*.rtf),0"

       Report Formats
       --------------

       Name                    Data
       -------------------------------------------------------------------

       Microsoft Excel        "xls,SOA_RptToBIFF, Biff5,Microsoft Excel
                              (*.xls),0"

       MS-DOS Text            "txt,SOA_RptToAscii,1,MS-DOS Text (*.txt),0"

       Rich Text Format       "rtf,SOA_RptToRTF,Rich Text Format,Rich Text
                              Format(*.rtf),0"

       Run-Time Options
       ----------------

       Name                   Data
       ----------------------------------------------------------------

       AppHelpFile           "Nwind80.hlp"

</PRE><P><LI>Close the Registry Editor.
<P>
</OL>Your custom application will now have the added features of the Help file,
and the Report and Clipboard formats.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about creating user profiles, search the ODE Help
Index for "registry, adding keys in Setup Wizard."
 
<PRE>Keywords          : WzOthr kbusage
Version           : 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
