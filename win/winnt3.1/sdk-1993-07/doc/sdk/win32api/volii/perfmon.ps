%!PS-Adobe-3.0
%%Creator: Windows PSCRIPT
%%Title: Microsoft Word - PERFMON.DOC
%%BoundingBox: 14 9 597 784
%%DocumentNeededResources: (atend)
%%DocumentSuppliedResources: (atend)
%%Pages: (atend)
%%BeginResource: procset Win35Dict 3 1
/Win35Dict 290 dict def Win35Dict begin/bd{bind def}bind def/in{72
mul}bd/ed{exch def}bd/ld{load def}bd/tr/translate ld/gs/gsave ld/gr
/grestore ld/M/moveto ld/L/lineto ld/rmt/rmoveto ld/rlt/rlineto ld
/rct/rcurveto ld/st/stroke ld/n/newpath ld/sm/setmatrix ld/cm/currentmatrix
ld/cp/closepath ld/ARC/arcn ld/TR{65536 div}bd/lj/setlinejoin ld/lc
/setlinecap ld/ml/setmiterlimit ld/sl/setlinewidth ld/scignore false
def/sc{scignore{pop pop pop}{0 index 2 index eq 2 index 4 index eq
and{pop pop 255 div setgray}{3{255 div 3 1 roll}repeat setrgbcolor}ifelse}ifelse}bd
/FC{bR bG bB sc}bd/fC{/bB ed/bG ed/bR ed}bd/HC{hR hG hB sc}bd/hC{
/hB ed/hG ed/hR ed}bd/PC{pR pG pB sc}bd/pC{/pB ed/pG ed/pR ed}bd/sM
matrix def/PenW 1 def/iPen 5 def/mxF matrix def/mxE matrix def/mxUE
matrix def/mxUF matrix def/fBE false def/iDevRes 72 0 matrix defaultmatrix
dtransform dup mul exch dup mul add sqrt def/fPP false def/SS{fPP{
/SV save def}{gs}ifelse}bd/RS{fPP{SV restore}{gr}ifelse}bd/EJ{gsave
showpage grestore}bd/#C{userdict begin/#copies ed end}bd/FEbuf 2 string
def/FEglyph(G  )def/FE{1 exch{dup 16 FEbuf cvrs FEglyph exch 1 exch
putinterval 1 index exch FEglyph cvn put}for}bd/SM{/iRes ed/cyP ed
/cxPg ed/cyM ed/cxM ed 72 100 div dup scale dup 0 ne{90 eq{cyM exch
0 eq{cxM exch tr -90 rotate -1 1 scale}{cxM cxPg add exch tr +90 rotate}ifelse}{cyP
cyM sub exch 0 ne{cxM exch tr -90 rotate}{cxM cxPg add exch tr -90
rotate 1 -1 scale}ifelse}ifelse}{pop cyP cyM sub exch 0 ne{cxM cxPg
add exch tr 180 rotate}{cxM exch tr 1 -1 scale}ifelse}ifelse 100 iRes
div dup scale 0 0 transform .25 add round .25 sub exch .25 add round
.25 sub exch itransform translate}bd/SJ{1 index 0 eq{pop pop/fBE false
def}{1 index/Break ed div/dxBreak ed/fBE true def}ifelse}bd/ANSIVec[
16#0/grave 16#1/acute 16#2/circumflex 16#3/tilde 16#4/macron 16#5/breve
16#6/dotaccent 16#7/dieresis 16#8/ring 16#9/cedilla 16#A/hungarumlaut
16#B/ogonek 16#C/caron 16#D/dotlessi 16#27/quotesingle 16#60/grave
16#7C/bar 16#82/quotesinglbase 16#83/florin 16#84/quotedblbase 16#85
/ellipsis 16#86/dagger 16#87/daggerdbl 16#89/perthousand 16#8A/Scaron
16#8B/guilsinglleft 16#8C/OE 16#91/quoteleft 16#92/quoteright 16#93
/quotedblleft 16#94/quotedblright 16#95/bullet 16#96/endash 16#97
/emdash 16#99/trademark 16#9A/scaron 16#9B/guilsinglright 16#9C/oe
16#9F/Ydieresis 16#A0/space 16#A4/currency 16#A6/brokenbar 16#A7/section
16#A8/dieresis 16#A9/copyright 16#AA/ordfeminine 16#AB/guillemotleft
16#AC/logicalnot 16#AD/hyphen 16#AE/registered 16#AF/macron 16#B0/degree
16#B1/plusminus 16#B2/twosuperior 16#B3/threesuperior 16#B4/acute 16#B5
/mu 16#B6/paragraph 16#B7/periodcentered 16#B8/cedilla 16#B9/onesuperior
16#BA/ordmasculine 16#BB/guillemotright 16#BC/onequarter 16#BD/onehalf
16#BE/threequarters 16#BF/questiondown 16#C0/Agrave 16#C1/Aacute 16#C2
/Acircumflex 16#C3/Atilde 16#C4/Adieresis 16#C5/Aring 16#C6/AE 16#C7
/Ccedilla 16#C8/Egrave 16#C9/Eacute 16#CA/Ecircumflex 16#CB/Edieresis
16#CC/Igrave 16#CD/Iacute 16#CE/Icircumflex 16#CF/Idieresis 16#D0/Eth
16#D1/Ntilde 16#D2/Ograve 16#D3/Oacute 16#D4/Ocircumflex 16#D5/Otilde
16#D6/Odieresis 16#D7/multiply 16#D8/Oslash 16#D9/Ugrave 16#DA/Uacute
16#DB/Ucircumflex 16#DC/Udieresis 16#DD/Yacute 16#DE/Thorn 16#DF/germandbls
16#E0/agrave 16#E1/aacute 16#E2/acircumflex 16#E3/atilde 16#E4/adieresis
16#E5/aring 16#E6/ae 16#E7/ccedilla 16#E8/egrave 16#E9/eacute 16#EA
/ecircumflex 16#EB/edieresis 16#EC/igrave 16#ED/iacute 16#EE/icircumflex
16#EF/idieresis 16#F0/eth 16#F1/ntilde 16#F2/ograve 16#F3/oacute 16#F4
/ocircumflex 16#F5/otilde 16#F6/odieresis 16#F7/divide 16#F8/oslash
16#F9/ugrave 16#FA/uacute 16#FB/ucircumflex 16#FC/udieresis 16#FD/yacute
16#FE/thorn 16#FF/ydieresis ] def/reencdict 12 dict def/IsChar{basefontdict
/CharStrings get exch known}bd/MapCh{dup IsChar not{pop/bullet}if
newfont/Encoding get 3 1 roll put}bd/MapDegree{16#b0/degree IsChar{
/degree}{/ring}ifelse MapCh}bd/MapBB{16#a6/brokenbar IsChar{/brokenbar}{
/bar}ifelse MapCh}bd/ANSIFont{reencdict begin/newfontname ed/basefontname
ed FontDirectory newfontname known not{/basefontdict basefontname findfont
def/newfont basefontdict maxlength dict def basefontdict{exch dup/FID
ne{dup/Encoding eq{exch dup length array copy newfont 3 1 roll put}{exch
newfont 3 1 roll put}ifelse}{pop pop}ifelse}forall newfont/FontName
newfontname put 127 1 159{newfont/Encoding get exch/bullet put}for
ANSIVec aload pop ANSIVec length 2 idiv{MapCh}repeat MapDegree MapBB
newfontname newfont definefont pop}if newfontname end}bd/SB{FC/ULlen
ed/str ed str length fBE not{dup 1 gt{1 sub}if}if/cbStr ed/dxGdi ed
/y0 ed/x0 ed str stringwidth dup 0 ne{/y1 ed/x1 ed y1 y1 mul x1 x1
mul add sqrt dxGdi exch div 1 sub dup x1 mul cbStr div exch y1 mul
cbStr div}{exch abs neg dxGdi add cbStr div exch}ifelse/dyExtra ed
/dxExtra ed x0 y0 M fBE{dxBreak 0 BCh dxExtra dyExtra str awidthshow}{dxExtra
dyExtra str ashow}ifelse fUL{x0 y0 M dxUL dyUL rmt ULlen fBE{Break
add}if 0 mxUE transform gs rlt cyUL sl [] 0 setdash st gr}if fSO{x0
y0 M dxSO dySO rmt ULlen fBE{Break add}if 0 mxUE transform gs rlt cyUL
sl [] 0 setdash st gr}if n/fBE false def}bd/font{/name ed/Ascent ed
0 ne/fT3 ed 0 ne/fSO ed 0 ne/fUL ed/Sy ed/Sx ed 10.0 div/ori ed -10.0
div/esc ed/BCh ed name findfont/xAscent 0 def/yAscent Ascent def/ULesc
esc def ULesc mxUE rotate pop fT3{/esc 0 def xAscent yAscent mxUE transform
/yAscent ed/xAscent ed}if [Sx 0 0 Sy neg xAscent yAscent] esc mxE
rotate mxF concatmatrix makefont setfont [Sx 0 0 Sy neg 0 Ascent] mxUE
mxUF concatmatrix pop fUL{currentfont dup/FontInfo get/UnderlinePosition
known not{pop/Courier findfont}if/FontInfo get/UnderlinePosition get
1000 div 0 exch mxUF transform/dyUL ed/dxUL ed}if fSO{0 .3 mxUF transform
/dySO ed/dxSO ed}if fUL fSO or{currentfont dup/FontInfo get/UnderlineThickness
known not{pop/Courier findfont}if/FontInfo get/UnderlineThickness get
1000 div Sy mul/cyUL ed}if}bd/min{2 copy gt{exch}if pop}bd/max{2 copy
lt{exch}if pop}bd/CP{/ft ed{{ft 0 eq{clip}{eoclip}ifelse}stopped{currentflat
1 add setflat}{exit}ifelse}loop}bd/patfont 10 dict def patfont begin
/FontType 3 def/FontMatrix [1 0 0 -1 0 0] def/FontBBox [0 0 16 16]
def/Encoding StandardEncoding def/BuildChar{pop pop 16 0 0 0 16 16
setcachedevice 16 16 false [1 0 0 1 .25 .25]{pat}imagemask}bd end/p{
/pat 32 string def{}forall 0 1 7{dup 2 mul pat exch 3 index put dup
2 mul 1 add pat exch 3 index put dup 2 mul 16 add pat exch 3 index
put 2 mul 17 add pat exch 2 index put pop}for}bd/pfill{/PatFont patfont
definefont setfont/ch(AAAA)def X0 64 X1{Y1 -16 Y0{1 index exch M ch
show}for pop}for}bd/vert{X0 w X1{dup Y0 M Y1 L st}for}bd/horz{Y0 w
Y1{dup X0 exch M X1 exch L st}for}bd/fdiag{X0 w X1{Y0 M X1 X0 sub dup
rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup rlt st}for}bd/bdiag{X0 w
X1{Y1 M X1 X0 sub dup neg rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup
neg rlt st}for}bd/AU{1 add cvi 15 or}bd/AD{1 sub cvi -16 and}bd/SHR{pathbbox
AU/Y1 ed AU/X1 ed AD/Y0 ed AD/X0 ed}bd/hfill{/w iRes 37.5 div round
def 0.1 sl [] 0 setdash n dup 0 eq{horz}if dup 1 eq{vert}if dup 2 eq{fdiag}if
dup 3 eq{bdiag}if dup 4 eq{horz vert}if 5 eq{fdiag bdiag}if}bd/F{/ft
ed fm 256 and 0 ne{gs FC ft 0 eq{fill}{eofill}ifelse gr}if fm 1536
and 0 ne{SHR gs HC ft CP fm 1024 and 0 ne{/Tmp save def pfill Tmp restore}{fm
15 and hfill}ifelse gr}if}bd/S{PenW sl PC st}bd/m matrix def/GW{iRes
12 div PenW add cvi}bd/DoW{iRes 50 div PenW add cvi}bd/DW{iRes 8 div
PenW add cvi}bd/SP{/PenW ed/iPen ed iPen 0 eq iPen 6 eq or{[] 0 setdash}if
iPen 1 eq{[DW GW] 0 setdash}if iPen 2 eq{[DoW GW] 0 setdash}if iPen
3 eq{[DW GW DoW GW] 0 setdash}if iPen 4 eq{[DW GW DoW GW DoW GW] 0
setdash}if}bd/E{m cm pop tr scale 1 0 moveto 0 0 1 0 360 arc cp m sm}bd
/AG{/sy ed/sx ed sx div 4 1 roll sy div 4 1 roll sx div 4 1 roll sy
div 4 1 roll atan/a2 ed atan/a1 ed sx sy scale a1 a2 ARC}def/A{m cm
pop tr AG m sm}def/P{m cm pop tr 0 0 M AG cp m sm}def/RRect{n 4 copy
M 3 1 roll exch L 4 2 roll L L cp}bd/RRCC{/r ed/y1 ed/x1 ed/y0 ed/x0
ed x0 x1 add 2 div y0 M x1 y0 x1 y1 r arcto 4{pop}repeat x1 y1 x0 y1
r arcto 4{pop}repeat x0 y1 x0 y0 r arcto 4{pop}repeat x0 y0 x1 y0 r
arcto 4{pop}repeat cp}bd/RR{2 copy 0 eq exch 0 eq or{pop pop RRect}{2
copy eq{pop RRCC}{m cm pop/y2 ed/x2 ed/ys y2 x2 div 1 max def/xs x2
y2 div 1 max def/y1 exch ys div def/x1 exch xs div def/y0 exch ys div
def/x0 exch xs div def/r2 x2 y2 min def xs ys scale x0 x1 add 2 div
y0 M x1 y0 x1 y1 r2 arcto 4{pop}repeat x1 y1 x0 y1 r2 arcto 4{pop}repeat
x0 y1 x0 y0 r2 arcto 4{pop}repeat x0 y0 x1 y0 r2 arcto 4{pop}repeat
m sm cp}ifelse}ifelse}bd/PP{{rlt}repeat}bd/OB{gs 0 ne{7 3 roll/y ed
/x ed x y translate ULesc rotate x neg y neg translate x y 7 -3 roll}if
sc B fill gr}bd/B{M/dy ed/dx ed dx 0 rlt 0 dy rlt dx neg 0 rlt cp}bd
/CB{B clip n}bd/ErrHandler{errordict dup maxlength exch length gt
dup{errordict begin}if/errhelpdict 12 dict def errhelpdict begin/stackunderflow(operand stack underflow)def
/undefined(this name is not defined in a dictionary)def/VMerror(you have used up all the printer's memory)def
/typecheck(operator was expecting a different type of operand)def
/ioerror(input/output error occured)def end{end}if errordict begin
/handleerror{$error begin newerror{/newerror false def showpage 72
72 scale/x .25 def/y 9.6 def/Helvetica findfont .2 scalefont setfont
x y moveto(Offending Command = )show/command load{dup type/stringtype
ne{(max err string)cvs}if show}exec/y y .2 sub def x y moveto(Error = )show
errorname{dup type dup( max err string )cvs show( : )show/stringtype
ne{( max err string )cvs}if show}exec errordict begin errhelpdict errorname
known{x 1 add y .2 sub moveto errhelpdict errorname get show}if end
/y y .4 sub def x y moveto(Stack =)show ostack{/y y .2 sub def x 1
add y moveto dup type/stringtype ne{( max err string )cvs}if show}forall
showpage}if end}def end}bd end
%%EndResource
/SVDoc save def
%%EndProlog
%%BeginSetup
Win35Dict begin
ErrHandler
statusdict begin 0 setjobtimeout end
statusdict begin statusdict /jobname (Microsoft Word - PERFMON.DOC) put end
/oldDictCnt countdictstack def {}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
/oldDictCnt countdictstack def {letter
}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
[{ }
/exec load currenttransfer /exec load] cvx settransfer
/fPP true def
/setresolution where { pop 1200 1200 setresolution } if
%%EndSetup
%%Page: 1 1
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
8469 1517 216 (459) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 200 200 0 0 0 180 /Times-Roman /font32 ANSIFont font
0 0 0 fC
1385 1965 133 (C) 233 SB
1618 1965 144 (H) 244 SB
1862 1965 144 (A) 244 SB
2106 1965 111 (P) 211 SB
2317 1965 122 (T) 222 SB
2539 1965 122 (E) 222 SB
2761 1965 133 (R) 233 SB
2994 1965 50 ( ) 150 SB
3144 1965 100 (6) 200 SB
3344 1965 100 (6) 200 SB
32 0 0 400 400 0 0 0 373 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 5600 2050 1384 2419 CB
1384 2406 3787 (Performance Monitoring) 3787 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4473 2619 (66.1  About Performance Monitoring) 2619 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5561 4510 33 (.) 83 SB
5644 4510 33 (.) 83 SB
5727 4510 33 (.) 83 SB
5810 4510 33 (.) 83 SB
5893 4510 33 (.) 83 SB
5976 4510 33 (.) 83 SB
6059 4510 33 (.) 83 SB
6142 4510 33 (.) 83 SB
6225 4510 33 (.) 83 SB
6308 4510 33 (.) 83 SB
6391 4510 33 (.) 83 SB
6474 4510 33 (.) 83 SB
6557 4510 33 (.) 83 SB
6640 4510 33 (.) 83 SB
6723 4510 33 (.) 83 SB
6806 4510 33 (.) 83 SB
6889 4510 33 (.) 83 SB
6972 4510 33 (.) 83 SB
7055 4510 33 (.) 83 SB
7138 4510 33 (.) 83 SB
7221 4510 33 (.) 83 SB
7304 4510 33 (.) 83 SB
7387 4510 33 (.) 83 SB
7470 4510 33 (.) 83 SB
7553 4510 33 (.) 83 SB
7636 4510 33 (.) 83 SB
7719 4510 33 (.) 83 SB
7802 4510 33 (.) 83 SB
7885 4510 33 (.) 83 SB
7968 4510 33 (.) 83 SB
8051 4510 33 (.) 83 SB
8134 4510 33 (.) 83 SB
8217 4510 33 (.) 83 SB
8300 4510 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 4473 264 (460) 264 SB
3118 4706 2542 (66.1.1  Counters and Elapsed Times) 2542 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5727 4743 33 (.) 83 SB
5810 4743 33 (.) 83 SB
5893 4743 33 (.) 83 SB
5976 4743 33 (.) 83 SB
6059 4743 33 (.) 83 SB
6142 4743 33 (.) 83 SB
6225 4743 33 (.) 83 SB
6308 4743 33 (.) 83 SB
6391 4743 33 (.) 83 SB
6474 4743 33 (.) 83 SB
6557 4743 33 (.) 83 SB
6640 4743 33 (.) 83 SB
6723 4743 33 (.) 83 SB
6806 4743 33 (.) 83 SB
6889 4743 33 (.) 83 SB
6972 4743 33 (.) 83 SB
7055 4743 33 (.) 83 SB
7138 4743 33 (.) 83 SB
7221 4743 33 (.) 83 SB
7304 4743 33 (.) 83 SB
7387 4743 33 (.) 83 SB
7470 4743 33 (.) 83 SB
7553 4743 33 (.) 83 SB
7636 4743 33 (.) 83 SB
7719 4743 33 (.) 83 SB
7802 4743 33 (.) 83 SB
7885 4743 33 (.) 83 SB
7968 4743 33 (.) 83 SB
8051 4743 33 (.) 83 SB
8134 4743 33 (.) 83 SB
8217 4743 33 (.) 83 SB
8300 4743 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 4706 264 (460) 264 SB
3118 4939 1810 (66.1.2  Registry Database) 1810 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
4980 4976 33 (.) 83 SB
5063 4976 33 (.) 83 SB
5146 4976 33 (.) 83 SB
5229 4976 33 (.) 83 SB
5312 4976 33 (.) 83 SB
5395 4976 33 (.) 83 SB
5478 4976 33 (.) 83 SB
5561 4976 33 (.) 83 SB
5644 4976 33 (.) 83 SB
5727 4976 33 (.) 83 SB
5810 4976 33 (.) 83 SB
5893 4976 33 (.) 83 SB
5976 4976 33 (.) 83 SB
6059 4976 33 (.) 83 SB
6142 4976 33 (.) 83 SB
6225 4976 33 (.) 83 SB
6308 4976 33 (.) 83 SB
6391 4976 33 (.) 83 SB
6474 4976 33 (.) 83 SB
6557 4976 33 (.) 83 SB
6640 4976 33 (.) 83 SB
6723 4976 33 (.) 83 SB
6806 4976 33 (.) 83 SB
6889 4976 33 (.) 83 SB
6972 4976 33 (.) 83 SB
7055 4976 33 (.) 83 SB
7138 4976 33 (.) 83 SB
7221 4976 33 (.) 83 SB
7304 4976 33 (.) 83 SB
7387 4976 33 (.) 83 SB
7470 4976 33 (.) 83 SB
7553 4976 33 (.) 83 SB
7636 4976 33 (.) 83 SB
7719 4976 33 (.) 83 SB
7802 4976 33 (.) 83 SB
7885 4976 33 (.) 83 SB
7968 4976 33 (.) 83 SB
8051 4976 33 (.) 83 SB
8134 4976 33 (.) 83 SB
8217 4976 33 (.) 83 SB
8300 4976 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 4939 264 (461) 264 SB
3352 5172 2501 (66.1.2.1  Getting Performance Data) 2501 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5893 5209 33 (.) 83 SB
5976 5209 33 (.) 83 SB
6059 5209 33 (.) 83 SB
6142 5209 33 (.) 83 SB
6225 5209 33 (.) 83 SB
6308 5209 33 (.) 83 SB
6391 5209 33 (.) 83 SB
6474 5209 33 (.) 83 SB
6557 5209 33 (.) 83 SB
6640 5209 33 (.) 83 SB
6723 5209 33 (.) 83 SB
6806 5209 33 (.) 83 SB
6889 5209 33 (.) 83 SB
6972 5209 33 (.) 83 SB
7055 5209 33 (.) 83 SB
7138 5209 33 (.) 83 SB
7221 5209 33 (.) 83 SB
7304 5209 33 (.) 83 SB
7387 5209 33 (.) 83 SB
7470 5209 33 (.) 83 SB
7553 5209 33 (.) 83 SB
7636 5209 33 (.) 83 SB
7719 5209 33 (.) 83 SB
7802 5209 33 (.) 83 SB
7885 5209 33 (.) 83 SB
7968 5209 33 (.) 83 SB
8051 5209 33 (.) 83 SB
8134 5209 33 (.) 83 SB
8217 5209 33 (.) 83 SB
8300 5209 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5172 264 (461) 264 SB
3352 5405 2406 (66.1.2.2  Getting Descriptive Text) 2406 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5810 5442 33 (.) 83 SB
5893 5442 33 (.) 83 SB
5976 5442 33 (.) 83 SB
6059 5442 33 (.) 83 SB
6142 5442 33 (.) 83 SB
6225 5442 33 (.) 83 SB
6308 5442 33 (.) 83 SB
6391 5442 33 (.) 83 SB
6474 5442 33 (.) 83 SB
6557 5442 33 (.) 83 SB
6640 5442 33 (.) 83 SB
6723 5442 33 (.) 83 SB
6806 5442 33 (.) 83 SB
6889 5442 33 (.) 83 SB
6972 5442 33 (.) 83 SB
7055 5442 33 (.) 83 SB
7138 5442 33 (.) 83 SB
7221 5442 33 (.) 83 SB
7304 5442 33 (.) 83 SB
7387 5442 33 (.) 83 SB
7470 5442 33 (.) 83 SB
7553 5442 33 (.) 83 SB
7636 5442 33 (.) 83 SB
7719 5442 33 (.) 83 SB
7802 5442 33 (.) 83 SB
7885 5442 33 (.) 83 SB
7968 5442 33 (.) 83 SB
8051 5442 33 (.) 83 SB
8134 5442 33 (.) 83 SB
8217 5442 33 (.) 83 SB
8300 5442 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5405 264 (462) 264 SB
3352 5638 2201 (66.1.2.3  Getting Selected Data) 2201 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5561 5675 33 (.) 83 SB
5644 5675 33 (.) 83 SB
5727 5675 33 (.) 83 SB
5810 5675 33 (.) 83 SB
5893 5675 33 (.) 83 SB
5976 5675 33 (.) 83 SB
6059 5675 33 (.) 83 SB
6142 5675 33 (.) 83 SB
6225 5675 33 (.) 83 SB
6308 5675 33 (.) 83 SB
6391 5675 33 (.) 83 SB
6474 5675 33 (.) 83 SB
6557 5675 33 (.) 83 SB
6640 5675 33 (.) 83 SB
6723 5675 33 (.) 83 SB
6806 5675 33 (.) 83 SB
6889 5675 33 (.) 83 SB
6972 5675 33 (.) 83 SB
7055 5675 33 (.) 83 SB
7138 5675 33 (.) 83 SB
7221 5675 33 (.) 83 SB
7304 5675 33 (.) 83 SB
7387 5675 33 (.) 83 SB
7470 5675 33 (.) 83 SB
7553 5675 33 (.) 83 SB
7636 5675 33 (.) 83 SB
7719 5675 33 (.) 83 SB
7802 5675 33 (.) 83 SB
7885 5675 33 (.) 83 SB
7968 5675 33 (.) 83 SB
8051 5675 33 (.) 83 SB
8134 5675 33 (.) 83 SB
8217 5675 33 (.) 83 SB
8300 5675 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5638 264 (463) 264 SB
2885 5871 2599 (66.2  Using Performance Monitoring) 2599 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5561 5908 33 (.) 83 SB
5644 5908 33 (.) 83 SB
5727 5908 33 (.) 83 SB
5810 5908 33 (.) 83 SB
5893 5908 33 (.) 83 SB
5976 5908 33 (.) 83 SB
6059 5908 33 (.) 83 SB
6142 5908 33 (.) 83 SB
6225 5908 33 (.) 83 SB
6308 5908 33 (.) 83 SB
6391 5908 33 (.) 83 SB
6474 5908 33 (.) 83 SB
6557 5908 33 (.) 83 SB
6640 5908 33 (.) 83 SB
6723 5908 33 (.) 83 SB
6806 5908 33 (.) 83 SB
6889 5908 33 (.) 83 SB
6972 5908 33 (.) 83 SB
7055 5908 33 (.) 83 SB
7138 5908 33 (.) 83 SB
7221 5908 33 (.) 83 SB
7304 5908 33 (.) 83 SB
7387 5908 33 (.) 83 SB
7470 5908 33 (.) 83 SB
7553 5908 33 (.) 83 SB
7636 5908 33 (.) 83 SB
7719 5908 33 (.) 83 SB
7802 5908 33 (.) 83 SB
7885 5908 33 (.) 83 SB
7968 5908 33 (.) 83 SB
8051 5908 33 (.) 83 SB
8134 5908 33 (.) 83 SB
8217 5908 33 (.) 83 SB
8300 5908 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5871 264 (465) 264 SB
3118 6104 3966 (66.2.1  Displaying Object, Counter, and Instance Names) 3966 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
7138 6141 33 (.) 83 SB
7221 6141 33 (.) 83 SB
7304 6141 33 (.) 83 SB
7387 6141 33 (.) 83 SB
7470 6141 33 (.) 83 SB
7553 6141 33 (.) 83 SB
7636 6141 33 (.) 83 SB
7719 6141 33 (.) 83 SB
7802 6141 33 (.) 83 SB
7885 6141 33 (.) 83 SB
7968 6141 33 (.) 83 SB
8051 6141 33 (.) 83 SB
8134 6141 33 (.) 83 SB
8217 6141 33 (.) 83 SB
8300 6141 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6104 264 (465) 264 SB
3118 6337 2836 (66.2.2  Displaying Counter Title Indices) 2836 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5976 6374 33 (.) 83 SB
6059 6374 33 (.) 83 SB
6142 6374 33 (.) 83 SB
6225 6374 33 (.) 83 SB
6308 6374 33 (.) 83 SB
6391 6374 33 (.) 83 SB
6474 6374 33 (.) 83 SB
6557 6374 33 (.) 83 SB
6640 6374 33 (.) 83 SB
6723 6374 33 (.) 83 SB
6806 6374 33 (.) 83 SB
6889 6374 33 (.) 83 SB
6972 6374 33 (.) 83 SB
7055 6374 33 (.) 83 SB
7138 6374 33 (.) 83 SB
7221 6374 33 (.) 83 SB
7304 6374 33 (.) 83 SB
7387 6374 33 (.) 83 SB
7470 6374 33 (.) 83 SB
7553 6374 33 (.) 83 SB
7636 6374 33 (.) 83 SB
7719 6374 33 (.) 83 SB
7802 6374 33 (.) 83 SB
7885 6374 33 (.) 83 SB
7968 6374 33 (.) 83 SB
8051 6374 33 (.) 83 SB
8134 6374 33 (.) 83 SB
8217 6374 33 (.) 83 SB
8300 6374 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6337 264 (485) 264 SB
2885 6570 1089 (66.3  Functions) 1089 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
3984 6607 33 (.) 83 SB
4067 6607 33 (.) 83 SB
4150 6607 33 (.) 83 SB
4233 6607 33 (.) 83 SB
4316 6607 33 (.) 83 SB
4399 6607 33 (.) 83 SB
4482 6607 33 (.) 83 SB
4565 6607 33 (.) 83 SB
4648 6607 33 (.) 83 SB
4731 6607 33 (.) 83 SB
4814 6607 33 (.) 83 SB
4897 6607 33 (.) 83 SB
4980 6607 33 (.) 83 SB
5063 6607 33 (.) 83 SB
5146 6607 33 (.) 83 SB
5229 6607 33 (.) 83 SB
5312 6607 33 (.) 83 SB
5395 6607 33 (.) 83 SB
5478 6607 33 (.) 83 SB
5561 6607 33 (.) 83 SB
5644 6607 33 (.) 83 SB
5727 6607 33 (.) 83 SB
5810 6607 33 (.) 83 SB
5893 6607 33 (.) 83 SB
5976 6607 33 (.) 83 SB
6059 6607 33 (.) 83 SB
6142 6607 33 (.) 83 SB
6225 6607 33 (.) 83 SB
6308 6607 33 (.) 83 SB
6391 6607 33 (.) 83 SB
6474 6607 33 (.) 83 SB
6557 6607 33 (.) 83 SB
6640 6607 33 (.) 83 SB
6723 6607 33 (.) 83 SB
6806 6607 33 (.) 83 SB
6889 6607 33 (.) 83 SB
6972 6607 33 (.) 83 SB
7055 6607 33 (.) 83 SB
7138 6607 33 (.) 83 SB
7221 6607 33 (.) 83 SB
7304 6607 33 (.) 83 SB
7387 6607 33 (.) 83 SB
7470 6607 33 (.) 83 SB
7553 6607 33 (.) 83 SB
7636 6607 33 (.) 83 SB
7719 6607 33 (.) 83 SB
7802 6607 33 (.) 83 SB
7885 6607 33 (.) 83 SB
7968 6607 33 (.) 83 SB
8051 6607 33 (.) 83 SB
8134 6607 33 (.) 83 SB
8217 6607 33 (.) 83 SB
8300 6607 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6570 264 (487) 264 SB
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 21 ( ) 21 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 459 def
/wp$fpage (459) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1447 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1822 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2410 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 459 def
/wp$fpage (459) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%Page: 2 2
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (460) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 333 333 0 0 0 311 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1968 4706 (66.1  About Performance Monitoring) 4706 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2535 2423 1741 (Performance monitoring) 1741 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4276 2423 4048 ( refers to determining the system resources an application) 4048 SB
2535 2623 5028 (consumes, such as processor time and memory. Because the underlying) 5028 SB
2535 2823 1706 (architecture of Microsof) 1706 SB
4241 2823 49 (t) 78 SB
4319 2823 885 ( Windows N) 885 SB
5204 2823 107 (T) 136 SB
5340 2823 2901 ( is fundamentally different from previous) 2901 SB
2535 3023 5790 (versions of Windows, developers will probably want to examine their applications) 5790 SB
2535 3223 5322 (to ensure efficient use of their system resources and to fine-tune application) 5322 SB
2535 3423 5352 (performance. This is particularly true for applications ported from Windows) 5352 SB
2535 3623 761 (versions 3.) 761 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
3296 3623 78 (x) 78 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3374 3623 3866 (. Many coding practices recommended for Windows 3.) 3866 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
7240 3623 78 (x) 78 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7318 3623 527 ( are not) 527 SB
2535 3823 5587 (necessary or are not recommended for Windows NT. For example, in Windows) 5587 SB
2535 4023 132 (3.) 132 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2667 4023 78 (x) 78 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2745 4023 5156 (, developers were encouraged to keep files open only while the files were) 5156 SB
2535 4223 5651 (being used. With the increased size of the virtual address space in Windows NT,) 5651 SB
2535 4423 5605 (however, developers should avoid the practice of opening, using, and closing in) 5605 SB
2535 4623 3802 (favor of keeping files open while the application runs.) 3802 SB
2535 4956 5624 (The Win32 performance-monitoring functions can help in evaluating the effects) 5624 SB
2535 5156 3914 (of such changes as developers migrate to Windows NT.) 3914 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 5592 3964 (66.1.1  Counters and Elapsed Times) 3964 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 5973 170 (A ) 170 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2705 5973 537 (counter) 537 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3242 5973 4672 ( is a general term used in programming to refer to an incrementing) 4672 SB
2535 6173 2380 (variable. Some systems include a ) 2380 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
4915 6173 2606 (high-resolution performance counter) 2606 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7521 6173 308 ( that) 308 SB
2535 6373 5729 (provides high-resolution elapsed times. The elapsed time can be used to fine-tune) 5729 SB
2535 6573 5125 (sections of source code. Windows NT supports two functions that enable) 5125 SB
2535 6773 3863 (application developers to obtain the value of a counter.) 3863 SB
2535 7106 4614 (If a high-resolution performance counter exists on the system, the) 4614 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 7303 2249 (QueryPerformanceFrequency) 2249 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4784 7306 3431 ( function can be used to express the frequency in) 3431 SB
2535 7506 5289 (counts per second. The value of the count is processor dependent. On some) 5289 SB
2535 7706 5688 (processors, for example, the count might be the cycle rate of the processor clock.) 5688 SB
2535 8039 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2852 8036 2073 (QueryPerformanceCounter) 2073 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4925 8039 3367 ( function retrieves the current value of the high-) 3367 SB
2535 8239 5337 (resolution performance counter \(if one exists on the system\). By calling this) 5337 SB
2535 8439 5646 (function at the beginning and end of a section of code, an application essentially) 5646 SB
2535 8639 2244 (uses the counter as a stopwatch.) 2244 SB
2535 8972 970 (For example, ) 970 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3505 8969 2249 (QueryPerformanceFrequency) 2249 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5754 8972 2558 ( might indicate that the frequency of) 2558 SB
2535 9172 5304 (the high-resolution performance counter on the system is 50,000 counts per) 5304 SB
2535 9372 2187 (second. If the application calls ) 2187 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4722 9369 2073 (QueryPerformanceCounter) 2073 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6795 9372 1414 ( immediately before) 1414 SB
2535 9572 5774 (and immediately after the section of code to be timed, the counter values might be) 5774 SB
2535 9772 5684 (1500 counts and 3500 counts, respectively. This indicates that .04 seconds \(2000) 5684 SB
2535 9972 2870 (counts\) elapsed while the code executed.) 2870 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 460 def
/wp$fpage (460) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 460 def
/wp$fpage (460) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 3 3
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (461) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1385 1975 2800 (66.1.2  Registry Database) 2800 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 2356 5335 (Windows NT includes several tools that monitor the system. To present this) 5335 SB
2885 2556 5762 (information in a different format, to use information inside another application, or) 5762 SB
2885 2756 5326 (to create a performance monitor, your application must retrieve information) 5326 SB
2885 2956 5444 (through the registry. For more information about the registry, see Chapter 52,) 5444 SB
2885 3156 2420 (\223Registry and Initialization Files.\224) 2420 SB
32 0 0 250 250 0 0 0 233 /Helvetica-Narrow-Bold /font16 ANSIFont font
2885 3546 3383 (66.1.2.1  Getting Performance Data) 3383 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 3872 5064 (An application can obtain system-performance information by using the) 5064 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 4069 1412 (RegQueryValueEx) 1412 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4297 4072 1869 ( registry function, with the) 1869 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 4269 2565 (HKEY_PERFORMANCE_DATA) 2565 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5450 4272 2310 ( key. The application can use the) 2310 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 4469 1002 (RegOpenKey) 1002 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3887 4472 1500 ( function to open the ) 1500 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5387 4469 2565 (HKEY_PERFORMANCE_DATA) 2565 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7952 4472 557 ( handle,) 557 SB
2885 4672 1202 (but it should use ) 1202 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4087 4669 1003 (RegCloseKey) 1003 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5090 4672 3447 ( to close the handle when it has finished running.) 3447 SB
2885 4872 5527 (This allows monitored software to be to be removed or installed, which cannot) 5527 SB
2885 5072 5272 (happen while they are being monitored. Network transports and drivers are) 5272 SB
2885 5272 4090 (examples of monitored software you may wish to remove.) 4090 SB
2885 5605 4273 (The performance data is not stored in the registry. Using the ) 4273 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7158 5602 1412 (RegQueryValueEx) 1412 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 5805 1245 (function with the ) 1245 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4130 5802 2565 (HKEY_PERFORMANCE_DATA) 2565 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6695 5805 1771 ( key causes the system to) 1771 SB
2885 6005 4317 (collect the data from the appropriate system object managers.) 4317 SB
2885 6338 4322 (If an application is accessing a remote system, it must use the) 4322 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 6535 1547 (RegConnectRegistry) 1547 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4432 6538 3737 ( function with the name of the remote system and the) 3737 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 6735 2565 (HKEY_PERFORMANCE_DATA) 2565 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5450 6738 386 ( key. ) 386 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5836 6735 1547 (RegConnectRegistry) 1547 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7383 6738 1068 ( retrieves a key) 1068 SB
2885 6938 2007 (the application can use with ) 2007 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4892 6935 1412 (RegQueryValueEx) 1412 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6304 6938 2028 ( to retrieve performance data) 2028 SB
2885 7138 1705 (from the remote system.) 1705 SB
2885 7471 2880 (The basic layout of the data retrieved by ) 2880 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5765 7468 1412 (RegQueryValueEx) 1412 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7177 7471 283 ( is a) 283 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 7668 1760 (PERF_DATA_BLOCK) 1760 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4645 7671 1888 ( structure followed by one ) 1888 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6533 7668 1801 (PERF_OBJECT_TYPE) 1801 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 7871 5505 (structure and accompanying data for each type of object being monitored. The) 5505 SB
2885 8071 5779 (system being observed defines objects that can be monitored. Typical object types) 5779 SB
2885 8271 2765 (include processors, disks, and memory.) 2765 SB
2885 8604 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3202 8601 1760 (PERF_DATA_BLOCK) 1760 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4962 8604 3632 ( structure describes the system and the performance) 3632 SB
2885 8804 5545 (data. This includes the size of the data, the number of objects being monitored,) 5545 SB
2885 9004 5630 (the frequency and value of the high-resolution performance counter, an offset to) 5630 SB
2885 9204 1976 (the system name, and so on.) 1976 SB
2885 9537 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3202 9534 1801 (PERF_OBJECT_TYPE) 1801 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5003 9537 3427 ( structure describes the performance data for one) 3427 SB
2885 9737 5652 (type of object. This includes the size of the structure and the object-specific data) 5652 SB
2885 9937 5665 (that follows the structure, the number of counters defined for the object type, the) 5665 SB
2885 10137 5105 (number of instances of this object type, the level of informational details) 5105 SB
2885 10337 5569 (provided, the code page, indices to the object name and Explain title in the title) 5569 SB
2885 10537 1411 (database, and so on.) 1411 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 461 def
/wp$fpage (461) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 461 def
/wp$fpage (461) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 4 4
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (462) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2535 1989 1132 (Following each ) 1132 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3667 1986 1801 (PERF_OBJECT_TYPE) 1801 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5468 1989 1829 ( structure, there is a list of) 1829 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 2186 2566 (PERF_COUNTER_DEFINITION) 2566 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5101 2189 3072 ( structures, one for each counter defined for) 3072 SB
2535 2389 1094 (the object. The ) 1094 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3629 2386 2566 (PERF_COUNTER_DEFINITION) 2566 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6195 2389 1922 ( structure specifies the type) 1922 SB
2535 2589 5346 (and size of the counter, the offset to the counter, the detail level, the counter) 5346 SB
2535 2789 3457 (name, and Explain title in the registry, and so on.) 3457 SB
2535 3122 258 (An ) 258 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2793 3122 586 (instance) 586 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3379 3122 4793 ( is an instantiation \(the creation of an instance\) of a particular object) 4793 SB
2535 3322 5741 (type. The number of instances of a particular object type determines what follows) 5741 SB
2535 3522 5397 (the list of counter definitions. Not all object types have instances. A memory) 5397 SB
2535 3722 5746 (object, for example, has no instances because the system has only one memory. If) 5746 SB
2535 3922 5673 (the object type does not have instances, the counter definitions are followed by a) 5673 SB
2535 4122 464 (single ) 464 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2999 4119 2139 (PERF_COUNTER_BLOCK) 2139 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5138 4122 3102 ( structure. This structure is followed by data) 3102 SB
2535 4322 1546 (for each counter. The ) 1546 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4081 4319 2139 (PERF_COUNTER_BLOCK) 2139 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6220 4322 1904 ( structure contains the total) 1904 SB
2535 4522 4760 (length of the structure, in bytes, and the counter data that follows it.) 4760 SB
2535 4855 5334 (If the object type has one or more instances, the list of counter definitions is) 5334 SB
2535 5055 1010 (followed by a ) 1010 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3545 5052 2595 (PERF_INSTANCE_DEFINITION) 2595 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6140 5055 1078 ( structure and a) 1078 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 5252 2139 (PERF_COUNTER_BLOCK) 2139 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4674 5255 2253 ( structure for each instance. The) 2253 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 5452 2595 (PERF_INSTANCE_DEFINITION) 2595 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5130 5455 3045 ( structure includes the name, identifier, and) 3045 SB
2535 5655 5236 (name of the parent of the instance. For example, the thread object type has) 5236 SB
2535 5855 3548 (instances; each thread in the system is an instance.) 3548 SB
2535 6188 5029 (The number of object types, instances, and counters may vary from one) 5029 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 6385 1412 (RegQueryValueEx) 1412 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3947 6388 4243 ( call to another. Therefore, the number and size of structures) 4243 SB
2535 6588 5645 (included in the performance data as well as the size of the data that follows each) 5645 SB
2535 6788 5757 (structure may also vary. To ensure that it is receiving the appropriate information,) 5757 SB
2535 6988 5352 (an application must use the offsets included in the performance structures to) 5352 SB
2535 7188 5773 (navigate through the performance data. Every offset is relative to the beginning of) 5773 SB
2535 7388 1846 (the structure containing it.) 1846 SB
32 0 0 250 250 0 0 0 233 /Helvetica-Narrow-Bold /font16 ANSIFont font
2535 7778 3212 (66.1.2.2  Getting Descriptive Text) 3212 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 8104 5334 (The names of the objects and counters, as well as the text that explains their) 5334 SB
2535 8304 5707 (meaning, are not returned in the performance structures described in the previous) 5707 SB
2535 8504 5657 (section. Instead, the structures contain indices to a structure in the Configuration) 5657 SB
2535 8704 5640 (Registry where the Unicode multilingual names and descriptions for each object) 5640 SB
2535 8904 5661 (and counter are stored. To access this information, the application must open the) 5661 SB
2535 9104 1698 (following registry node:) 1698 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 9457 4960 (\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Perflib\\<langid>) 4960 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 9803 1440 (The language node \() 1440 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
3975 9803 450 (langid) 450 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4425 9803 2979 (\) is the ASCII representation of the 3-digit) 2979 SB
2535 10003 5518 (hexadecimal language identifier. For example, the U.S. English node is \223009\224.) 5518 SB
2535 10203 5689 (This node, once opened, can be queried for values of either \221Counters\222 or \221Help\222.) 5689 SB
2535 10403 5524 (The names of object types are included in the \221Counters\222 data. The \221Help\222 data) 5524 SB
2535 10603 1778 (supplies the Explain text.) 1778 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 462 def
/wp$fpage (462) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 462 def
/wp$fpage (462) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 5 5
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (463) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2885 1989 5793 (The \221Counters\222 and \221Help\222 data are stored in MULTI_SZ strings. This type of data) 5793 SB
2885 2189 5433 (is a list of Unicode strings, each terminated with UNICODE_NULL. The last) 5433 SB
2885 2389 3835 (string is followed by an additional UNICODE_NULL.) 3835 SB
2885 2722 5464 (The strings are listed in pairs. The first item is the Unicode string of the index) 5464 SB
2885 2922 4434 (contained in PERF_OBJECT_TYPE.ObjectNameTitleIndex or) 4434 SB
2885 3122 5579 (PERF_COUNTER_DEFINITION.CounterNameTitleIndex. The second item is) 5579 SB
2885 3322 5075 (the actual name of the index. Following is a fragment of the paired data:) 5075 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 3675 960 (2     System) 960 SB
2885 3858 960 (4     Memory) 960 SB
2885 4041 1760 (6     % Processor Time) 1760 SB
2885 4224 2000 (10    Read Operations/sec) 2000 SB
2885 4407 2080 (12    Write Operations/sec) 2080 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4753 5427 (To retrieve a name or the Explain text for an item, an application must do the) 5427 SB
2885 4953 732 (following:) 732 SB
2886 5286 132 (1.) 132 SB
3118 5286 1964 (If the system is remote, use ) 1964 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5082 5283 1547 (RegConnectRegistry) 1547 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6629 5286 44 (.) 44 SB
2886 5553 132 (2.) 132 SB
3118 5553 316 (Use ) 316 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3434 5550 1207 (RegOpenKeyEx) 1207 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4641 5553 3890 (, specifying the registry node described previously, and) 3890 SB
3118 5753 2168 (the appropriate language node.) 2168 SB
2886 6020 132 (3.) 132 SB
3118 6020 316 (Use ) 316 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3434 6017 1412 (RegQueryValueEx) 1412 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4846 6020 3814 (, specifying either \221Counters\222 or \221Help\222 as the name of) 3814 SB
3118 6220 5523 (the value to query. This provides MULTI_SZ data containing either the names) 5523 SB
3118 6420 5163 (of all the objects and counters, or Help information for all the objects and) 5163 SB
3118 6620 639 (counters.) 639 SB
2886 6887 132 (4.) 132 SB
3118 6887 2104 (Convert the appropriate index) 2104 SB
3118 7087 3437 (\(PERF_OBJECT_TYPE.ObjectNameTitleIndex,) 3437 SB
3118 7287 3302 (PERF_OBJECT_TYPE.ObjectHelpTitleIndex,) 3302 SB
3118 7487 4403 (PERF_COUNTER_DEFINITION.CounterNameTitleIndex, or) 4403 SB
3118 7687 5297 (PERF_COUNTER_DEFINITION.CounterHelpTitleIndex\) into Unicode or) 5297 SB
3118 7887 4725 (ASCII, depending on whether the application is Unicode or ASCII.) 4725 SB
2886 8154 132 (5.) 132 SB
3118 8154 3793 (Search the MULTI_SZ data for the appropriate index.) 3793 SB
2886 8421 132 (6.) 132 SB
3118 8421 5081 (Retrieve the string following the matching index as the object\222s name or) 5081 SB
3118 8621 1688 (descriptive information.) 1688 SB
32 0 0 250 250 0 0 0 233 /Helvetica-Narrow-Bold /font16 ANSIFont font
2885 8945 2973 (66.1.2.3  Getting Selected Data) 2973 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 9271 1146 (When using the ) 1146 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4031 9268 1412 (RegQueryValueEx) 1412 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5443 9271 2632 ( function, an application must use the) 2632 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2885 9471 654 (lpcbData) 654 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3539 9471 4733 ( parameter to specify a byte count of the amount of data to retrieve.) 4733 SB
2885 9671 5583 (Estimating this amount is difficult because the number of object types and their) 5583 SB
2885 9871 5402 (instances is determined by the system configuration and system activity. The) 5402 SB
2885 10071 5288 (amount may vary from one request to another. If the function does not pass) 5288 SB
2885 10271 5654 (enough space, the return value will be ERROR_MORE_DATA. Therefore, your) 5654 SB
2885 10471 5594 (application should include a retry loop in which it passes increasing amounts of) 5594 SB
2885 10671 5731 (buffer space until it no longer gets this error. The successful buffer size should be) 5731 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 463 def
/wp$fpage (463) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 463 def
/wp$fpage (463) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 6 6
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (464) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2535 1989 2856 (the starting point for subsequent calls to ) 2856 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5391 1986 1412 (RegQueryValueEx) 1412 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6803 1989 1289 (. This technique is) 1289 SB
2535 2189 3979 (illustrated in the example code at the end of this chapter.) 3979 SB
2535 2522 5601 (In some cases, the application may not need to retrieve all the performance data) 5601 SB
2535 2722 5359 (provided by the system. Retrieving all the performance data provided by the) 5359 SB
2535 2922 5166 (system may be costly in terms of processor or memory requirements. The) 5166 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2535 3122 1092 (lpszValueName) 1092 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3627 3122 979 ( parameter of ) 979 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4606 3119 1412 (RegQueryValueEx) 1412 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6018 3122 1689 ( indicates the amount of) 1689 SB
2535 3322 5511 (information to retrieve. This parameter can be in one of the following formats.) 5511 SB
2535 3522 5676 (The strings are case sensitive. If a string includes more than one word, the words) 5676 SB
2535 3722 2078 (must be separated by a space.) 2078 SB
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 1972 250 2535 4051 CB
2535 4071 422 (String) 422 SB
gr
gs 3826 250 4508 4051 CB
4708 4071 597 (Meaning) 597 SB
gr
5798 11 2535 4301 B
1 F
n
gs 1972 250 2535 4330 CB
2535 4350 457 (Global) 457 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 200 4508 4330 CB
4708 4353 3371 (The function returns all data for counters on the local) 3371 SB
gr
gs 3826 183 4508 4530 CB
4708 4536 2441 (computer except those included in the ) 2441 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 3826 183 4508 4530 CB
7149 4533 430 (Costly) 430 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 183 4508 4530 CB
7579 4536 624 ( category,) 624 SB
gr
gs 3826 233 4508 4713 CB
4708 4719 1744 (described later in this table.) 1744 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 1972 250 2535 4946 CB
2535 4966 739 (nnn xx yyy) 739 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 200 4508 4946 CB
4708 4969 3597 (Each of these strings is a Unicode string representing the) 3597 SB
gr
gs 3826 183 4508 5146 CB
4708 5152 1216 (decimal value for a) 1216 SB
gr
gs 3826 183 4508 5329 CB
4708 5335 3334 (PERF_OBJECT_TYPE.ObjectNameTitleIndex. The) 3334 SB
gr
gs 3826 183 4508 5512 CB
4708 5518 3291 (function returns data only about the specified object) 3291 SB
gr
gs 3826 233 4508 5695 CB
4708 5701 1787 (types on the local computer.) 1787 SB
gr
gs 3826 200 4508 5928 CB
4708 5951 3360 (Note that more object types may be returned than are) 3360 SB
gr
gs 3826 183 4508 6128 CB
4708 6134 3603 (requested. This occurs if other object types are needed to) 3603 SB
gr
gs 3826 183 4508 6311 CB
4708 6317 3531 (support the requested data, e.g., processes are needed to) 3531 SB
gr
gs 3826 183 4508 6494 CB
4708 6500 3526 (identify threads, so processes will also be returned even) 3526 SB
gr
gs 3826 233 4508 6677 CB
4708 6683 1832 (if only threads are requested.) 1832 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 1972 250 2535 6910 CB
2535 6930 811 (Foreign ssss) 811 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 200 4508 6910 CB
4708 6933 686 (The string ) 686 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 3826 200 4508 6910 CB
5394 6930 244 (ssss) 244 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 200 4508 6910 CB
5638 6933 2174 ( is the name of a foreign computer) 2174 SB
gr
gs 3826 200 4508 6910 CB
7812 6933 40 ( ) 11 SB
gr
gs 3826 200 4508 6910 CB
7823 6933 158 (\227) 158 SB
gr
gs 3826 200 4508 6910 CB
7981 6933 40 ( ) 11 SB
gr
gs 3826 200 4508 6910 CB
7992 6933 237 (that) 237 SB
gr
gs 3826 183 4508 7110 CB
4708 7116 3085 (is, one that does not support the registry calls for) 3085 SB
gr
gs 3826 183 4508 7293 CB
4708 7299 3582 (returning data remotely. The function returns all data for) 3582 SB
gr
gs 3826 183 4508 7476 CB
4708 7482 3228 (counters on the foreign computer, if your system is) 3228 SB
gr
gs 3826 183 4508 7659 CB
4708 7665 3562 (capable of collecting data from a foreign computer. You) 3562 SB
gr
gs 3826 183 4508 7842 CB
4708 7848 2061 (may want to try this approach if ) 2061 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 3826 183 4508 7842 CB
6769 7845 1395 (RegConnectRegistry) 1395 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 233 4508 8025 CB
4708 8031 2412 (fails to connect to a foreign computer.) 2412 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 1972 250 2535 8258 CB
2535 8278 1590 (Foreign ssss nnn xx yyy) 1590 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 200 4508 8258 CB
4708 8281 1426 (This format combines ) 1426 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 3826 200 4508 8258 CB
6134 8278 811 (Foreign ssss) 811 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 200 4508 8258 CB
6945 8281 308 ( and ) 308 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 3826 200 4508 8258 CB
7253 8278 739 (nnn xx yyy) 739 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 200 4508 8258 CB
7992 8281 40 (,) 40 SB
gr
gs 3826 183 4508 8458 CB
4708 8464 3352 (discussed above. The function returns all data for the) 3352 SB
gr
gs 3826 183 4508 8641 CB
4708 8647 3216 (specified counters on the foreign computer, if your) 3216 SB
gr
gs 3826 183 4508 8824 CB
4708 8830 3196 (system is capable of collecting data from a foreign) 3196 SB
gr
gs 3826 183 4508 9007 CB
4708 9013 3110 (computer. An application can try this approach if) 3110 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 3826 183 4508 9190 CB
4708 9193 1395 (RegConnectRegistry) 1395 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 183 4508 9190 CB
6103 9196 1776 ( fails to connect to a foreign) 1776 SB
gr
gs 3826 233 4508 9373 CB
4708 9379 3326 (computer, but you do not want all the available data.) 3326 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 1972 250 2535 9606 CB
2535 9626 430 (Costly) 430 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 3826 200 4508 9606 CB
4708 9629 3511 (The function returns data for object types whose data is) 3511 SB
gr
gs 3826 183 4508 9806 CB
4708 9812 3157 (expensive to collect, in terms of processor time or) 3157 SB
gr
gs 3826 183 4508 9989 CB
4708 9995 3625 (memory usage. You may wish to start a secondary thread) 3625 SB
gr
gs 3826 183 4508 10172 CB
4708 10178 3330 (to access this data, if you wish to respond to the user) 3330 SB
gr
gs 3826 233 4508 10355 CB
4708 10361 1419 (during data collection.) 1419 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 464 def
/wp$fpage (464) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 464 def
/wp$fpage (464) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 7 7
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (465) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 333 333 0 0 0 311 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1385 1968 4676 (66.2  Using Performance Monitoring) 4676 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 2423 5775 (This section includes examples of code that display objects, counters, and Explain) 5775 SB
2885 2623 1209 (text for a system.) 1209 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 3059 6133 (66.2.1  Displaying Object, Counter, and Instance Names) 6133 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 3440 5762 (The following example, PERFEX, includes code that illustrates how to display all) 5762 SB
2885 3640 2084 (counter indices in the system.) 2084 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
1385 3993 1360 (#define UNICODE 1) 1360 SB
1385 4176 1440 (#define _UNICODE 1) 1440 SB
1385 4359 160 (//) 160 SB
1385 4542 1680 (//  "C" Include files) 1680 SB
1385 4725 160 (//) 160 SB
1385 4908 1440 (#include <stdio.h>) 1440 SB
1385 5091 1520 (#include <stdlib.h>) 1520 SB
1385 5274 1520 (#include <string.h>) 1520 SB
1385 5457 1520 (#include <malloc.h>) 1520 SB
1385 5640 160 (//) 160 SB
1385 5823 2000 (//  Windows Include files) 2000 SB
1385 6006 160 (//) 160 SB
1385 6189 1600 (#include <windows.h>) 1600 SB
1385 6372 1600 (#include <winperf.h>) 1600 SB
1385 6555 1440 (#include <tchar.h>) 1440 SB
1385 6738 160 (//) 160 SB
1385 6921 1520 (//  Local constants) 1520 SB
1385 7104 160 (//) 160 SB
1385 7287 6160 (#define RESERVED        0L                  // reserved argument in fn. calls) 6160 SB
1385 7470 5920 (#define INITIAL_SIZE    40960L              // initial perf data buff size) 5920 SB
1385 7653 6080 (#define EXTEND_SIZE     4096L               // extend size of perf data buff) 6080 SB
1385 7836 5280 (#define LINE_LENGTH     80                  // display line length) 5280 SB
1385 8019 5920 (#define WRAP_POINT      LINE_LENGTH-12      // wrap point for explain text) 5920 SB
1385 8202 6080 (#define OBJECT_TEXT_INDENT 4                // indent of object explain text) 6080 SB
1385 8385 160 (//) 160 SB
1385 8568 2400 (//  Command line option values) 2400 SB
1385 8751 160 (//) 160 SB
1385 8934 2000 (#define COMMAND_ERROR   0) 2000 SB
1385 9117 2000 (#define COMMAND_HELP    1) 2000 SB
1385 9300 2000 (#define COMMAND_COUNTER 2) 2000 SB
1385 9483 160 (//) 160 SB
1385 9666 160 (//) 160 SB
1385 9849 2880 (//  Text string Constant definitions) 2880 SB
1385 10032 160 (//) 160 SB
1385 10215 7120 (const LPTSTR NamesKey = TEXT\("SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib"\);) 7120 SB
1385 10398 3280 (const LPTSTR DefaultLangId = TEXT\("409"\);) 3280 SB
1385 10581 3280 (const LPTSTR Counters = TEXT\("Counters"\);) 3280 SB
1385 10764 2640 (const LPTSTR Help = TEXT\("Help"\);) 2640 SB
1385 10947 3360 (const LPTSTR LastHelp = TEXT\("Last Help"\);) 3360 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 465 def
/wp$fpage (465) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 465 def
/wp$fpage (465) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 8 8
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (466) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2009 3840 (const LPTSTR LastCounter = TEXT\("Last Counter"\);) 3840 SB
1035 2192 2560 (const LPTSTR Slash = TEXT\("\\\\"\);) 2560 SB
1035 2375 2960 (const LPTSTR Global = TEXT\("Global"\);) 2960 SB
1035 2558 160 (//) 160 SB
1035 2741 1440 (//  Global Buffers) 1440 SB
1035 2924 160 (//) 160 SB
1035 3107 5680 (TCHAR   cValueName[LINE_LENGTH];  // used to store counter value string) 5680 SB
1035 3290 5440 (CHAR    cExeName[LINE_LENGTH*2];  // used in processing command line) 5440 SB
1035 3473 5440 (CHAR    cCtrName[LINE_LENGTH];    // used in processing command line) 5440 SB
1035 4022 320 (BOOL) 320 SB
1035 4205 1040 (StringToInt \() 1040 SB
1035 4388 1760 (    IN  LPTSTR  InStr,) 1760 SB
1035 4571 2000 (    OUT PDWORD  pdwOutInt) 2000 SB
1035 4754 80 (\)) 80 SB
1035 4937 320 (/*++) 320 SB
1035 5303 880 (StringToInt) 880 SB
1035 5669 5200 (    Returns the decimal interpretation of the string in the InStr) 5200 SB
1035 5852 4400 (    argument. Works for either Unicode or ANSI strings.) 4400 SB
1035 6218 800 (Arguments:) 800 SB
1035 6584 720 (    InStr) 720 SB
1035 6767 2160 (        string to translate) 2160 SB
1035 7133 1040 (    pdwOutInt) 1040 SB
1035 7316 4720 (        base 10 version of the number in the InStr argument) 4720 SB
1035 7682 1040 (Return Value:) 1040 SB
1035 8048 2960 (    TRUE if conversion was successful) 2960 SB
1035 8231 1280 (    FALSE if not) 1280 SB
1035 8597 320 (--*/) 320 SB
1035 8780 80 ({) 80 SB
1035 9146 3920 (    // check for NULL pointers passed to function) 3920 SB
1035 9512 2800 (    if \(\(!InStr\) || \(!pdwOutInt\)\) {) 2800 SB
1035 9695 3440 (        SetLastError \(ERROR_BAD_ARGUMENTS\);) 3440 SB
1035 9878 1680 (        return FALSE;) 1680 SB
1035 10061 400 (    }) 400 SB
1035 10427 4720 (    if \( \(_stscanf \(InStr, TEXT\(" %d"\), pdwOutInt\)\) == 1\) {) 4720 SB
1035 10610 1600 (        return TRUE;) 1600 SB
1035 10793 960 (    } else {) 960 SB
1035 10976 1680 (        return FALSE;) 1680 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 466 def
/wp$fpage (466) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 466 def
/wp$fpage (466) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 9 9
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (467) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2009 400 (    }) 400 SB
1385 2192 1280 (} // StringToInt) 1280 SB
1385 2741 320 (VOID) 320 SB
1385 2924 1600 (DisplayCommandHelp \() 1600 SB
1385 3107 80 (\)) 80 SB
1385 3290 320 (/*++) 320 SB
1385 3656 1440 (DisplayCommandHelp) 1440 SB
1385 4022 3520 (    displays usage of command line arguments) 3520 SB
1385 4388 720 (Arguments) 720 SB
1385 4754 640 (    NONE) 640 SB
1385 5120 960 (Return Value) 960 SB
1385 5486 640 (    NONE) 640 SB
1385 5852 320 (--*/) 320 SB
1385 6035 80 ({) 80 SB
1385 6218 2160 (    printf \("\\n\\nPERFEX:"\);) 2160 SB
1385 6401 5920 (    printf \("\\n    Sample program to demonstrate Win 32 Performance API"\);) 5920 SB
1385 6584 2080 (    printf \("\\n\\nUsage:"\);) 2080 SB
1385 6767 3680 (    printf \("\\n\\n     perfex [-? | counter]"\);) 3680 SB
1385 6950 6880 (    printf \("\\n\\n          -?  Displays a list of all counter objects in the system"\);) 6880 SB
1385 7133 5040 (    printf \("\\n     counter  is the name of a counter object"\);) 5040 SB
1385 7316 7120 (    printf \("\\n                  and displays the performance counters for that object"\);) 7120 SB
1385 7499 1440 (    printf \("\\n"\);) 1440 SB
1385 7682 1840 (} // DisplayCommandHelp) 1840 SB
1385 8048 480 (LPTSTR) 480 SB
1385 8231 1280 (*BuildNameTable\() 1280 SB
1385 8414 5920 (    IN HKEY    hKeyRegistry,   // handle to registry db with counter names) 5920 SB
1385 8597 5280 (    IN LPTSTR  lpszLangId,     // unicode value of Language subkey) 5280 SB
1385 8780 4720 (    OUT PDWORD  pdwLastItem    // size of array in elements) 4720 SB
1385 8963 80 (\)) 80 SB
1385 9146 320 (/*++) 320 SB
1385 9512 1120 (BuildNameTable) 1120 SB
1385 9878 5760 (    Caches the counter names and explain text to accelerate name lookups) 5760 SB
1385 10061 1280 (    for display.) 1280 SB
1385 10427 800 (Arguments:) 800 SB
1385 10793 1280 (    hKeyRegistry) 1280 SB
1385 10976 5840 (            Handle to an open registry \(this can be local or remote.\) and) 5840 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 467 def
/wp$fpage (467) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 467 def
/wp$fpage (467) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 10 10
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (468) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2009 5840 (            is the value returned by RegConnectRegistry or a default key.) 5840 SB
1035 2375 1120 (    lpszLangId) 1120 SB
1035 2558 5680 (            The unicode id of the language to look up. \(default is 409\)) 5680 SB
1035 2924 1200 (    pdwLastItem) 1200 SB
1035 3107 2720 (            The last array element) 2720 SB
1035 3473 1040 (Return Value:) 1040 SB
1035 3839 6000 (    pointer to an allocated table. \(the caller must free it when finished!\)) 6000 SB
1035 4022 5600 (    the table is an array of pointers to zero terminated TEXT strings.) 5600 SB
1035 4388 5360 (    A NULL pointer is returned if an error occured. \(error value is) 5360 SB
1035 4571 3760 (    available using the GetLastError function\).) 3760 SB
1035 4937 3520 (    The structure of the buffer returned is:) 3520 SB
1035 5303 5280 (        Array of pointers to zero terminated strings consisting of) 5280 SB
1035 5486 2560 (            pdwLastItem elements) 2560 SB
1035 5852 5680 (        MULTI_SZ string containing counter id's and names returned from) 5680 SB
1035 6035 3760 (            registry for the specified language) 3760 SB
1035 6401 6160 (        MULTI_SZ string containing explain text id's and explain text strings) 6160 SB
1035 6584 5280 (            as returned by the registry for the specified language) 5280 SB
1035 6950 5760 (    The structures listed above are contiguous so that they may be freed) 5760 SB
1035 7133 5520 (    by a single "free" call when finished with them, however only the) 5520 SB
1035 7316 3440 (    array elements are intended to be used.) 3440 SB
1035 7682 320 (--*/) 320 SB
1035 7865 80 ({) 80 SB
1035 8231 4880 (    LPTSTR  *lpReturnValue;     // returned pointer to buffer) 4880 SB
1035 8597 2720 (    LPTSTR  *lpCounterId;       //) 2720 SB
1035 8780 6000 (    LPTSTR  lpCounterNames;     // pointer to Names buffer returned by reg.) 6000 SB
1035 8963 6160 (    LPTSTR  lpHelpText ;        // pointet to exlpain buffer returned by reg.) 6160 SB
1035 9329 4000 (    LPTSTR  lpThisName;         // working pointer) 4000 SB
1035 9695 5920 (    BOOL    bStatus;            // return status from TRUE/FALSE fn. calls) 5920 SB
1035 9878 5040 (    LONG    lWin32Status;       // return status from fn. calls) 5040 SB
1035 10244 5040 (    DWORD   dwHelpItems;        // number of explain text items) 5040 SB
1035 10427 5040 (    DWORD   dwCounterItems;     // number of counter text items) 5040 SB
1035 10610 5760 (    DWORD   dwValueType;        // value type of buffer returned by reg.) 5760 SB
1035 10793 5200 (    DWORD   dwArraySize;        // size of pointer array in bytes) 5200 SB
1035 10976 5120 (    DWORD   dwBufferSize;       // size of total buffer in bytes) 5120 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 468 def
/wp$fpage (468) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 468 def
/wp$fpage (468) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 11 11
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (469) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2009 5680 (    DWORD   dwCounterSize;      // size of counter text buffer in bytes) 5680 SB
1385 2192 5440 (    DWORD   dwHelpSize;         // size of help text buffer in bytes) 5440 SB
1385 2375 4000 (    DWORD   dwThisCounter;      // working counter) 4000 SB
1385 2741 6400 (    DWORD   dwLastId;           // largest ID value used by explain/counter text) 6400 SB
1385 3107 5600 (    HKEY    hKeyValue;          // handle to Perflib entry in registry) 5600 SB
1385 3290 5520 (    HKEY    hKeyNames;          // handle to names subkey in registry) 5520 SB
1385 3656 6000 (    LPTSTR  lpValueNameString;  // pointer to buffer conatining subkey name) 6000 SB
1385 4022 2640 (    //initialize pointers to NULL) 2640 SB
1385 4388 2320 (    lpValueNameString = NULL;) 2320 SB
1385 4571 2000 (    lpReturnValue = NULL;) 2000 SB
1385 4754 1680 (    hKeyValue = NULL;) 1680 SB
1385 4937 1680 (    hKeyNames = NULL;) 1680 SB
1385 5303 5120 (    // check for null arguments and insert defaults if necessary) 5120 SB
1385 5669 1760 (    if \(!lpszLangId\) {) 1760 SB
1385 5852 2800 (        lpszLangId = DefaultLangId;) 2800 SB
1385 6035 400 (    }) 400 SB
1385 6401 5440 (    // open handle to Perflib key in registry to get number of items) 5440 SB
1385 6584 4320 (    // used in order to compute array and buffer sizes) 4320 SB
1385 6950 2640 (    lWin32Status = RegOpenKeyEx \() 2640 SB
1385 7133 1680 (        hKeyRegistry,) 1680 SB
1385 7316 1360 (        NamesKey,) 1360 SB
1385 7499 1360 (        RESERVED,) 1360 SB
1385 7682 1360 (        KEY_READ,) 1360 SB
1385 7865 1600 (        &hKeyValue\);) 1600 SB
1385 8231 5200 (    // on error, free buffers, close keys and return NULL pointer) 5200 SB
1385 8597 3200 (    if \(lWin32Status != ERROR_SUCCESS\) {) 3200 SB
1385 8780 2000 (        goto BNT_BAILOUT;) 2000 SB
1385 8963 400 (    }) 400 SB
1385 9329 4560 (    // query registry to get number of Explain text items) 4560 SB
1385 9695 3200 (    dwBufferSize = sizeof \(dwHelpItems\);) 3200 SB
1385 9878 2880 (    lWin32Status = RegQueryValueEx \() 2880 SB
1385 10061 1440 (        hKeyValue,) 1440 SB
1385 10244 1360 (        LastHelp,) 1360 SB
1385 10427 1360 (        RESERVED,) 1360 SB
1385 10610 1680 (        &dwValueType,) 1680 SB
1385 10793 2320 (        \(LPBYTE\)&dwHelpItems,) 2320 SB
1385 10976 1840 (        &dwBufferSize\);) 1840 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 469 def
/wp$fpage (469) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 469 def
/wp$fpage (469) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 12 12
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (470) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2192 5760 (    if \(\(lWin32Status != ERROR_SUCCESS\) || \(dwValueType != REG_DWORD\)\) {) 5760 SB
1035 2375 2000 (        goto BNT_BAILOUT;) 2000 SB
1035 2558 400 (    }) 400 SB
1035 2924 5440 (    // query registry to get number of counter and object name items) 5440 SB
1035 3290 3440 (    dwBufferSize = sizeof \(dwCounterItems\);) 3440 SB
1035 3473 2880 (    lWin32Status = RegQueryValueEx \() 2880 SB
1035 3656 1440 (        hKeyValue,) 1440 SB
1035 3839 1600 (        LastCounter,) 1600 SB
1035 4022 1360 (        RESERVED,) 1360 SB
1035 4205 1680 (        &dwValueType,) 1680 SB
1035 4388 2560 (        \(LPBYTE\)&dwCounterItems,) 2560 SB
1035 4571 1840 (        &dwBufferSize\);) 1840 SB
1035 4937 5760 (    if \(\(lWin32Status != ERROR_SUCCESS\) || \(dwValueType != REG_DWORD\)\) {) 5760 SB
1035 5120 2000 (        goto BNT_BAILOUT;) 2000 SB
1035 5303 400 (    }) 400 SB
1035 5669 5360 (    // use the greater of Help items or Counter Items to size array) 5360 SB
1035 6035 3200 (    if \(dwHelpItems >= dwCounterItems\) {) 3200 SB
1035 6218 2480 (        dwLastId = dwHelpItems;) 2480 SB
1035 6401 960 (    } else {) 960 SB
1035 6584 2720 (        dwLastId = dwCounterItems;) 2720 SB
1035 6767 400 (    }) 400 SB
1035 7133 5360 (    // array size is # of elements \(+ 1, since names are "1" based\)) 5360 SB
1035 7316 2720 (    // times the size of a pointer) 2720 SB
1035 7682 4000 (    dwArraySize = \(dwLastId + 1\) * sizeof\(LPTSTR\);) 4000 SB
1035 8048 4480 (    // allocate string buffer for language ID key string) 4480 SB
1035 8414 2560 (    lpValueNameString = malloc \() 2560 SB
1035 8597 3520 (        lstrlen\(NamesKey\) * sizeof \(TCHAR\) +) 3520 SB
1035 8780 3280 (        lstrlen\(Slash\) * sizeof \(TCHAR\) +) 3280 SB
1035 8963 3680 (        lstrlen\(lpszLangId\) * sizeof \(TCHAR\) +) 3680 SB
1035 9146 1920 (        sizeof \(TCHAR\)\);) 1920 SB
1035 9512 2320 (    if \(!lpValueNameString\) {) 2320 SB
1035 9695 3280 (        lWin32Status = ERROR_OUTOFMEMORY;) 3280 SB
1035 9878 2000 (        goto BNT_BAILOUT;) 2000 SB
1035 10061 400 (    }) 400 SB
1035 10427 4560 (    // build the key string for the specified language ID) 4560 SB
1035 10793 3360 (    lstrcpy \(lpValueNameString, NamesKey\);) 3360 SB
1035 10976 3120 (    lstrcat \(lpValueNameString, Slash\);) 3120 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 470 def
/wp$fpage (470) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 470 def
/wp$fpage (470) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 13 13
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (471) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2009 3520 (    lstrcat \(lpValueNameString, lpszLangId\);) 3520 SB
1385 2375 5440 (    lWin32Status = RegOpenKeyEx \(   // get handle to this key in the) 5440 SB
1385 2558 3760 (        hKeyRegistry,               // registry) 3760 SB
1385 2741 2080 (        lpValueNameString,) 2080 SB
1385 2924 1360 (        RESERVED,) 1360 SB
1385 3107 1360 (        KEY_READ,) 1360 SB
1385 3290 1600 (        &hKeyNames\);) 1600 SB
1385 3656 4480 (    if \(lWin32Status != ERROR_SUCCESS\) goto BNT_BAILOUT;) 4480 SB
1385 4022 2560 (    // get size of counter names) 2560 SB
1385 4388 1680 (    dwBufferSize = 0;) 1680 SB
1385 4571 2880 (    lWin32Status = RegQueryValueEx \() 2880 SB
1385 4754 1440 (        hKeyNames,) 1440 SB
1385 4937 1360 (        Counters,) 1360 SB
1385 5120 1360 (        RESERVED,) 1360 SB
1385 5303 1680 (        &dwValueType,) 1680 SB
1385 5486 1040 (        NULL,) 1040 SB
1385 5669 1840 (        &dwBufferSize\);) 1840 SB
1385 6035 4480 (    if \(lWin32Status != ERROR_SUCCESS\) goto BNT_BAILOUT;) 4480 SB
1385 6401 2640 (    dwCounterSize = dwBufferSize;) 2640 SB
1385 6767 2240 (    // get size of help text) 2240 SB
1385 7133 1680 (    dwBufferSize = 0;) 1680 SB
1385 7316 2880 (    lWin32Status = RegQueryValueEx \() 2880 SB
1385 7499 1440 (        hKeyNames,) 1440 SB
1385 7682 1040 (        Help,) 1040 SB
1385 7865 1360 (        RESERVED,) 1360 SB
1385 8048 1680 (        &dwValueType,) 1680 SB
1385 8231 1040 (        NULL,) 1040 SB
1385 8414 1840 (        &dwBufferSize\);) 1840 SB
1385 8780 4480 (    if \(lWin32Status != ERROR_SUCCESS\) goto BNT_BAILOUT;) 4480 SB
1385 9146 2400 (    dwHelpSize = dwBufferSize;) 2400 SB
1385 9512 5120 (    // allocate buffer with room for pointer array, counter name) 5120 SB
1385 9695 2880 (    // strings and help name strings) 2880 SB
1385 10061 5600 (    lpReturnValue = malloc \(dwArraySize + dwCounterSize + dwHelpSize\);) 5600 SB
1385 10427 2000 (    if \(!lpReturnValue\) {) 2000 SB
1385 10610 3280 (        lWin32Status = ERROR_OUTOFMEMORY;) 3280 SB
1385 10793 2000 (        goto BNT_BAILOUT;) 2000 SB
1385 10976 400 (    }) 400 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 471 def
/wp$fpage (471) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 471 def
/wp$fpage (471) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 14 14
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (472) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2192 3040 (    // initialize pointers into buffer) 3040 SB
1035 2558 2560 (    lpCounterId = lpReturnValue;) 2560 SB
1035 2741 5200 (    lpCounterNames = \(LPTSTR\)\(\(LPBYTE\)lpCounterId + dwArraySize\);) 5200 SB
1035 2924 5280 (    lpHelpText = \(LPTSTR\)\(\(LPBYTE\)lpCounterNames + dwCounterSize\);) 5280 SB
1035 3290 5600 (    // read counter names into buffer. Counter names will be stored as) 5600 SB
1035 3473 4320 (    // a MULTI_SZ string in the format of "###" "Name") 4320 SB
1035 3839 2640 (    dwBufferSize = dwCounterSize;) 2640 SB
1035 4022 2880 (    lWin32Status = RegQueryValueEx \() 2880 SB
1035 4205 1440 (        hKeyNames,) 1440 SB
1035 4388 1360 (        Counters,) 1360 SB
1035 4571 1360 (        RESERVED,) 1360 SB
1035 4754 1680 (        &dwValueType,) 1680 SB
1035 4937 2480 (        \(LPVOID\)lpCounterNames,) 2480 SB
1035 5120 1840 (        &dwBufferSize\);) 1840 SB
1035 5486 4480 (    if \(lWin32Status != ERROR_SUCCESS\) goto BNT_BAILOUT;) 4480 SB
1035 5852 5520 (    // read explain text into buffer. Counter names will be stored as) 5520 SB
1035 6035 4560 (    // a MULTI_SZ string in the format of "###" "Text...") 4560 SB
1035 6401 2400 (    dwBufferSize = dwHelpSize;) 2400 SB
1035 6584 2880 (    lWin32Status = RegQueryValueEx \() 2880 SB
1035 6767 1440 (        hKeyNames,) 1440 SB
1035 6950 1040 (        Help,) 1040 SB
1035 7133 1360 (        RESERVED,) 1360 SB
1035 7316 1680 (        &dwValueType,) 1680 SB
1035 7499 2160 (        \(LPVOID\)lpHelpText,) 2160 SB
1035 7682 1840 (        &dwBufferSize\);) 1840 SB
1035 8048 4480 (    if \(lWin32Status != ERROR_SUCCESS\) goto BNT_BAILOUT;) 4480 SB
1035 8414 4880 (    // load counter array items, by locating each text string) 4880 SB
1035 8597 3600 (    // in the returned buffer and loading the) 3600 SB
1035 8780 5120 (    // address of it in the corresponding pointer array element.) 5120 SB
1035 9146 2960 (    for \(lpThisName = lpCounterNames;) 2960 SB
1035 9329 1680 (         *lpThisName;) 1680 SB
1035 9512 4000 (         lpThisName += \(lstrlen\(lpThisName\)+1\) \) {) 4000 SB
1035 9878 5920 (        // first string should be an integer \(in decimal digit characters\)) 5920 SB
1035 10061 6160 (        // so translate to an integer for use in array element identification) 6160 SB
1035 10427 4720 (        bStatus = StringToInt \(lpThisName, &dwThisCounter\);) 4720 SB
1035 10793 1840 (        if \(!bStatus\) {) 1840 SB
1035 10976 3120 (            // error is in GetLastError) 3120 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 472 def
/wp$fpage (472) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 472 def
/wp$fpage (472) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 15 15
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (473) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2009 3440 (            goto BNT_BAILOUT;  // bad entry) 3440 SB
1385 2192 720 (        }) 720 SB
1385 2558 5920 (        // point to corresponding counter name which follows the id number) 5920 SB
1385 2741 1440 (        // string.) 1440 SB
1385 3107 3680 (        lpThisName += \(lstrlen\(lpThisName\)+1\);) 3680 SB
1385 3473 4480 (        // and load array element with pointer to string) 4480 SB
1385 3839 3840 (        lpCounterId[dwThisCounter] = lpThisName;) 3840 SB
1385 4205 400 (    }) 400 SB
1385 4571 4160 (    // repeat the above for the explain text strings) 4160 SB
1385 4937 2640 (    for \(lpThisName = lpHelpText;) 2640 SB
1385 5120 1680 (         *lpThisName;) 1680 SB
1385 5303 4000 (         lpThisName += \(lstrlen\(lpThisName\)+1\) \) {) 4000 SB
1385 5669 5760 (        // first string should be an integer \(in decimal unicode digits\)) 5760 SB
1385 6035 4720 (        bStatus = StringToInt \(lpThisName, &dwThisCounter\);) 4720 SB
1385 6401 1840 (        if \(!bStatus\) {) 1840 SB
1385 6584 3120 (            // error is in GetLastError) 3120 SB
1385 6767 3440 (            goto BNT_BAILOUT;  // bad entry) 3440 SB
1385 6950 720 (        }) 720 SB
1385 7316 3680 (        // point to corresponding counter name) 3680 SB
1385 7682 3680 (        lpThisName += \(lstrlen\(lpThisName\)+1\);) 3680 SB
1385 8048 2720 (        // and load array element;) 2720 SB
1385 8414 3840 (        lpCounterId[dwThisCounter] = lpThisName;) 3840 SB
1385 8780 400 (    }) 400 SB
1385 9146 6080 (    // if the last item arugment was used, then load the last ID value in it) 6080 SB
1385 9512 3600 (    if \(pdwLastItem\) *pdwLastItem = dwLastId;) 3600 SB
1385 9878 2960 (    // free the temporary buffer used) 2960 SB
1385 10244 2240 (    if \(lpValueNameString\) {) 2240 SB
1385 10427 3280 (        free \(\(LPVOID\)lpValueNameString\);) 3280 SB
1385 10610 400 (    }) 400 SB
1385 10976 2400 (    // close the registry keys) 2400 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 473 def
/wp$fpage (473) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 473 def
/wp$fpage (473) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 16 16
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (474) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2192 2240 (    RegCloseKey \(hKeyValue\);) 2240 SB
1035 2375 2240 (    RegCloseKey \(hKeyNames\);) 2240 SB
1035 2741 3760 (    // exit returning the pointer to the buffer) 3760 SB
1035 3107 2000 (    return lpReturnValue;) 2000 SB
1035 3473 960 (BNT_BAILOUT:) 960 SB
1035 3656 3200 (    if \(lWin32Status != ERROR_SUCCESS\) {) 3200 SB
1035 3839 5600 (        // if lWin32Status has error, then set last error value to it,) 5600 SB
1035 4022 5360 (        // otherwise assume that last error already has value in it) 5360 SB
1035 4205 2880 (        SetLastError \(lWin32Status\);) 2880 SB
1035 4388 400 (    }) 400 SB
1035 4754 3200 (    // free buffers used by this routine) 3200 SB
1035 5120 2240 (    if \(lpValueNameString\) {) 2240 SB
1035 5303 3280 (        free \(\(LPVOID\)lpValueNameString\);) 3280 SB
1035 5486 400 (    }) 400 SB
1035 5852 1920 (    if \(lpReturnValue\) {) 1920 SB
1035 6035 2960 (        free \(\(LPVOID\)lpReturnValue\);) 2960 SB
1035 6218 400 (    }) 400 SB
1035 6584 3440 (    if \(hKeyValue\) RegCloseKey \(hKeyValue\);) 3440 SB
1035 6767 3440 (    if \(hKeyNames\) RegCloseKey \(hKeyNames\);) 3440 SB
1035 7133 1280 (    return NULL;) 1280 SB
1035 7316 1520 (} // BuildNameTable) 1520 SB
1035 7682 400 (DWORD) 400 SB
1035 7865 1520 (GetSystemPerfData \() 1520 SB
1035 8048 1840 (    IN HKEY hKeySystem,) 1840 SB
1035 8231 1840 (    IN LPTSTR   pValue,) 1840 SB
1035 8414 2720 (    IN PPERF_DATA_BLOCK *pPerfData) 2720 SB
1035 8597 80 (\)) 80 SB
1035 8780 320 (/*++) 320 SB
1035 8963 1360 (GetSystemPerfData) 1360 SB
1035 9329 5280 (    Allocates data buffer as required and queries performance data) 5280 SB
1035 9512 3040 (    specified in pValue from registry.) 3040 SB
1035 9878 720 (Arguments) 720 SB
1035 10244 1120 (    hKeySystem) 1120 SB
1035 10427 3680 (        Handle to performance data in registry) 3680 SB
1035 10793 800 (    pValue) 800 SB
1035 10976 3520 (        Value string to return from registry) 3520 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 474 def
/wp$fpage (474) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 474 def
/wp$fpage (474) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 17 17
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (475) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2192 1040 (    pPerfData) 1040 SB
1385 2375 5040 (        address of pointer to allocated perf data block that is) 5040 SB
1385 2558 3440 (        filled in by call to RegQueryValue.) 3440 SB
1385 2924 960 (Return Value) 960 SB
1385 3290 2720 (    ERROR_SUCCESS if data returned) 2720 SB
1385 3473 2960 (    WIN 32 ERROR if error encountered) 2960 SB
1385 3656 320 (--*/) 320 SB
1385 3839 1840 ({  // GetSystemPerfData) 1840 SB
1385 4022 4880 (    LONG     lError ;   // Win 32 Error returned by fn. calls) 4880 SB
1385 4205 5200 (    DWORD    Size;      // size of data buffer passed to fn. call) 5200 SB
1385 4388 5360 (    DWORD    Type;      // type of data buffer returned by fn. call) 5360 SB
1385 4754 5520 (    // allocate initial buffer if one is not passed into this routine) 5520 SB
1385 5120 2320 (    if \(*pPerfData == NULL\) {) 2320 SB
1385 5303 3440 (        *pPerfData = malloc \(INITIAL_SIZE\);) 3440 SB
1385 5486 2640 (        if \(*pPerfData == NULL\) {) 2640 SB
1385 5669 2960 (            return ERROR_OUTOFMEMORY;) 2960 SB
1385 5852 720 (        }) 720 SB
1385 6035 400 (    }) 400 SB
1385 6401 1440 (    while \(TRUE\) {) 1440 SB
1385 6584 5760 (        Size = _msize \(*pPerfData\); // query the size of the data buffer) 5760 SB
1385 6950 5520 (        lError = RegQueryValueEx \(  // get performance data from reg.) 5520 SB
1385 7133 1840 (            hKeySystem,) 1840 SB
1385 7316 1520 (            pValue,) 1520 SB
1385 7499 1680 (            RESERVED,) 1680 SB
1385 7682 1440 (            &Type,) 1440 SB
1385 7865 2480 (            \(LPBYTE\)*pPerfData,) 2480 SB
1385 8048 1600 (            &Size\) ;) 1600 SB
1385 8414 5120 (        // check for success and valid perf data block signature) 5120 SB
1385 8780 1920 (        if \(\(!lError\) &&) 1920 SB
1385 8963 2000 (            \(Size > 0\) &&) 2000 SB
1385 9146 4400 (            \(*pPerfData\)->Signature[0] == \(WCHAR\)'P' &&) 4400 SB
1385 9329 4400 (            \(*pPerfData\)->Signature[1] == \(WCHAR\)'E' &&) 4400 SB
1385 9512 4400 (            \(*pPerfData\)->Signature[2] == \(WCHAR\)'R' &&) 4400 SB
1385 9695 4480 (            \(*pPerfData\)->Signature[3] == \(WCHAR\)'F' \) {) 4480 SB
1385 10061 2880 (            return \(ERROR_SUCCESS\) ;) 2880 SB
1385 10244 720 (        }) 720 SB
1385 10610 5120 (        // if buffer is not big enough, reallocate and try again) 5120 SB
1385 10976 3200 (        if \(lError == ERROR_MORE_DATA\) {) 3200 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 475 def
/wp$fpage (475) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 475 def
/wp$fpage (475) def
/wp$date (05/05/93) def
/wp$time (16:35) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 18 18
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (476) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2009 2720 (            *pPerfData = realloc \() 2720 SB
1035 2192 2160 (                *pPerfData,) 2160 SB
1035 2375 2960 (                _msize \(*pPerfData\) +) 2960 SB
1035 2558 2400 (                EXTEND_SIZE\) ;) 2400 SB
1035 2924 2400 (            if \(!*pPerfData\) {) 2400 SB
1035 3107 2640 (                return \(lError\) ;) 2640 SB
1035 3290 1040 (            }) 1040 SB
1035 3473 1280 (        } else {) 1280 SB
1035 3656 2320 (            return \(lError\) ;) 2320 SB
1035 3839 720 (        }) 720 SB
1035 4022 400 (    }) 400 SB
1035 4205 1840 (}  // GetSystemPerfData) 1840 SB
1035 4571 320 (/*++) 320 SB
1035 4937 1360 (Pointer Functions) 1360 SB
1035 5303 5120 (    These functions are used to walk down the various structures) 5120 SB
1035 5486 5280 (    in the perf data block returned by the call to RegQueryValueEx) 5280 SB
1035 5852 320 (--*/) 320 SB
1035 6035 1360 (PPERF_OBJECT_TYPE) 1360 SB
1035 6218 1040 (FirstObject \() 1040 SB
1035 6401 2400 (    PPERF_DATA_BLOCK pPerfData) 2400 SB
1035 6584 80 (\)) 80 SB
1035 6767 80 ({) 80 SB
1035 6950 6400 (    return \(\(PPERF_OBJECT_TYPE\) \(\(PBYTE\) pPerfData + pPerfData->HeaderLength\)\) ;) 6400 SB
1035 7133 80 (}) 80 SB
1035 7499 1360 (PPERF_OBJECT_TYPE) 1360 SB
1035 7682 960 (NextObject \() 960 SB
1035 7865 2320 (    PPERF_OBJECT_TYPE pObject) 2320 SB
1035 8048 80 (\)) 80 SB
1035 8231 1280 ({  // NextObject) 1280 SB
1035 8414 6320 (    return \(\(PPERF_OBJECT_TYPE\) \(\(PBYTE\) pObject + pObject->TotalByteLength\)\) ;) 6320 SB
1035 8597 1280 (}  // NextObject) 1280 SB
1035 8963 2000 (PERF_COUNTER_DEFINITION *) 2000 SB
1035 9146 1040 (FirstCounter\() 1040 SB
1035 9329 2560 (    PERF_OBJECT_TYPE *pObjectDef) 2560 SB
1035 9512 80 (\)) 80 SB
1035 9695 80 ({) 80 SB
1035 9878 3040 (    return \(PERF_COUNTER_DEFINITION *\)) 3040 SB
1035 10061 5040 (               \(\(PCHAR\) pObjectDef + pObjectDef->HeaderLength\);) 5040 SB
1035 10244 80 (}) 80 SB
1035 10610 2000 (PERF_COUNTER_DEFINITION *) 2000 SB
1035 10793 960 (NextCounter\() 960 SB
1035 10976 3200 (    PERF_COUNTER_DEFINITION *pCounterDef) 3200 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 476 def
/wp$fpage (476) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 476 def
/wp$fpage (476) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 19 19
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (477) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2009 80 (\)) 80 SB
1385 2192 80 ({) 80 SB
1385 2375 3040 (    return \(PERF_COUNTER_DEFINITION *\)) 3040 SB
1385 2558 5040 (               \(\(PCHAR\) pCounterDef + pCounterDef->ByteLength\);) 5040 SB
1385 2741 80 (}) 80 SB
1385 3107 2080 (PERF_INSTANCE_DEFINITION *) 2080 SB
1385 3290 1200 (FirstInstance \() 1200 SB
1385 3473 2560 (    PERF_OBJECT_TYPE    *pObject) 2560 SB
1385 3656 80 (\)) 80 SB
1385 3839 80 ({) 80 SB
1385 4022 3120 (    return \(PERF_INSTANCE_DEFINITION *\)) 3120 SB
1385 4205 4320 (        \(\(PBYTE\) pObject + pObject->DefinitionLength\);) 4320 SB
1385 4388 80 (}) 80 SB
1385 4754 2080 (PERF_INSTANCE_DEFINITION *) 2080 SB
1385 4937 1120 (NextInstance \() 1120 SB
1385 5120 3120 (    PERF_INSTANCE_DEFINITION *pInstance) 3120 SB
1385 5303 80 (\)) 80 SB
1385 5486 80 ({) 80 SB
1385 5669 5840 (    // next instance is after this instance + this instances counter data) 5840 SB
1385 5852 2640 (    PERF_COUNTER_BLOCK  *pCtrBlk;) 2640 SB
1385 6218 2880 (    pCtrBlk = \(PERF_COUNTER_BLOCK *\)) 2880 SB
1385 6401 4080 (        \(\(PBYTE\)pInstance + pInstance->ByteLength\);) 4080 SB
1385 6767 3120 (    return \(PERF_INSTANCE_DEFINITION *\)) 3120 SB
1385 6950 5840 (        \(\(PBYTE\)pInstance + pInstance->ByteLength + pCtrBlk->ByteLength\);) 5840 SB
1385 7133 80 (}) 80 SB
1385 7499 320 (LONG) 320 SB
1385 7682 1360 (PrintExplainText\() 1360 SB
1385 7865 1520 (    DWORD   Indent,) 1520 SB
1385 8048 1920 (    LPTSTR  szTextString) 1920 SB
1385 8231 80 (\)) 80 SB
1385 8414 320 (/*++) 320 SB
1385 8780 1280 (PrintExplainText) 1280 SB
1385 9146 5200 (    Prints Long strings in a wrapped format for display on screen) 5200 SB
1385 9512 720 (Arguments) 720 SB
1385 9878 800 (    Indent) 800 SB
1385 10061 4800 (        number of characters to indent text from left margin) 4800 SB
1385 10427 1280 (    szTextString) 1280 SB
1385 10610 2640 (        string to print on stdout) 2640 SB
1385 10976 880 (ReturnValue) 880 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 477 def
/wp$fpage (477) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 477 def
/wp$fpage (477) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 20 20
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (478) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2192 2800 (    number of lines of text printed) 2800 SB
1035 2558 320 (--*/) 320 SB
1035 2741 80 ({) 80 SB
1035 2924 1840 (    LPTSTR  szThisChar;) 1840 SB
1035 3107 1680 (    BOOL    bNewLine;) 1680 SB
1035 3473 1760 (    DWORD   dwThisPos;) 1760 SB
1035 3656 1920 (    DWORD   dwLinesUsed;) 1920 SB
1035 4022 2400 (    szThisChar = szTextString;) 2400 SB
1035 4205 1600 (    dwLinesUsed = 0;) 1600 SB
1035 4571 1760 (    // check arguments) 1760 SB
1035 4937 1920 (    if \(!szTextString\) {) 1920 SB
1035 5120 2160 (        return dwLinesUsed;) 2160 SB
1035 5303 400 (    }) 400 SB
1035 5669 2400 (    if \(Indent > WRAP_POINT\) {) 2400 SB
1035 5852 3520 (        return dwLinesUsed; // can't do this) 3520 SB
1035 6035 400 (    }) 400 SB
1035 6401 1600 (    bNewLine = TRUE;) 1600 SB
1035 6767 1360 (    // print text) 1360 SB
1035 7133 2000 (    while \(*szThisChar\) {) 2000 SB
1035 7499 1760 (        if \(bNewLine\){) 1760 SB
1035 7682 5280 (            for \(dwThisPos = 0; dwThisPos < Indent; dwThisPos++\) {) 5280 SB
1035 7865 2320 (                printf \(" "\);) 2320 SB
1035 8048 1040 (            }) 1040 SB
1035 8414 2320 (            bNewLine = FALSE;) 2320 SB
1035 8597 720 (        }) 720 SB
1035 8780 5120 (        if \(\(*szThisChar == ' '\) && \(dwThisPos >= WRAP_POINT\)\) {) 5120 SB
1035 8963 2080 (            printf \("\\n"\);) 2080 SB
1035 9146 2240 (            bNewLine = TRUE;) 2240 SB
1035 9329 3600 (            // go to next printable character) 3600 SB
1035 9512 3200 (            while \(*szThisChar <= ' '\) {) 3200 SB
1035 9695 2320 (                szThisChar++;) 2320 SB
1035 9878 1040 (            }) 1040 SB
1035 10061 2080 (            dwLinesUsed++;) 2080 SB
1035 10244 1280 (        } else {) 1280 SB
1035 10427 3120 (            printf \("%c", *szThisChar\);) 3120 SB
1035 10610 2000 (            szThisChar++;) 2000 SB
1035 10793 720 (        }) 720 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 478 def
/wp$fpage (478) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 478 def
/wp$fpage (478) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 21 21
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (479) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2009 1600 (        dwThisPos++;) 1600 SB
1385 2192 400 (    }) 400 SB
1385 2558 1440 (    printf \("\\n"\);) 1440 SB
1385 2741 1600 (    bNewLine = TRUE;) 1600 SB
1385 2924 1440 (    dwLinesUsed++;) 1440 SB
1385 3290 1840 (    return dwLinesUsed;) 1840 SB
1385 3473 1680 (} // PrintExplainText) 1680 SB
1385 3839 400 (DWORD) 400 SB
1385 4022 1600 (ProcessCommandLine \() 1600 SB
1385 4205 2000 (    IN LPTSTR  lpCmdLine,) 2000 SB
1385 4388 2560 (    IN LPTSTR  *lppCounterNames,) 2560 SB
1385 4571 2320 (    IN DWORD   dwLastCounter,) 2320 SB
1385 4754 2400 (    OUT LPTSTR  *lpValueString) 2400 SB
1385 4937 80 (\)) 80 SB
1385 5120 320 (/*++) 320 SB
1385 5486 1360 (ProcesCommandLine) 1360 SB
1385 5852 5920 (    Reads arguments in command line and determines what program should do.) 5920 SB
1385 6035 2160 (    Command line syntax is:) 2160 SB
1385 6401 2240 (        PERFEX [ ? | Object]) 2240 SB
1385 6767 5760 (    if "?" is in command line, then list of counter objects is displayed) 5760 SB
1385 7133 5440 (    if a text string \(other than "?"\) then string is translated to a) 5440 SB
1385 7316 5440 (    counter object id and the counters for that object are displayed) 5440 SB
1385 7682 720 (Arguments) 720 SB
1385 8048 1040 (    lpCmdLine) 1040 SB
1385 8414 5360 (        null terminated string that contains command line arguments) 5360 SB
1385 8780 1520 (    lppCounterNames) 1520 SB
1385 9146 4720 (        pointer to array of counter names \(used for lookup\)) 4720 SB
1385 9512 1360 (    dwLastCounter) 1360 SB
1385 9878 3840 (        number of elements in CounterNames array) 3840 SB
1385 10244 1360 (    lpValueString) 1360 SB
1385 10610 5760 (        value string to send to ReqQueryValue in order to return counter) 5760 SB
1385 10793 2720 (        data for specified counter) 2720 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 479 def
/wp$fpage (479) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 479 def
/wp$fpage (479) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 22 22
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (480) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2009 880 (ReturnValue) 880 SB
1035 2375 2960 (    TRUE    if valid data is returned) 2960 SB
1035 2558 5840 (    FALSE   if unable to process command line \(command syntax help should) 5840 SB
1035 2741 2080 (            be displayed\).) 2080 SB
1035 3107 320 (--*/) 320 SB
1035 3290 80 ({) 80 SB
1035 3473 2160 (    LPTSTR   lpLocalString;) 2160 SB
1035 3656 2080 (    DWORD   dwReturnValue;) 2080 SB
1035 3839 1520 (    DWORD   dwElem;) 1520 SB
1035 4205 5920 (    dwReturnValue = COMMAND_ERROR;  // assume error until proven otherwise) 5920 SB
1035 4571 2400 (    lpLocalString = lpCmdLine;) 2400 SB
1035 4937 2640 (    // move pointer past exe name) 2640 SB
1035 5303 5680 (    while \(\(*lpLocalString > ' '\) && \(*lpLocalString\)\) lpLocalString++;) 5680 SB
1035 5669 3440 (    // move pointer to next non-space char;) 3440 SB
1035 6035 5760 (    while \(\(*lpLocalString <= ' '\) && \(*lpLocalString\)\) lpLocalString++;) 5760 SB
1035 6401 2000 (    if \(*lpLocalString\) {) 2000 SB
1035 6584 3920 (        // check for "HELP" command line argument) 3920 SB
1035 6950 2880 (        if \(*lpLocalString == '-'\) {) 2880 SB
1035 7133 3360 (            if \(*++lpLocalString == '?'\) {) 3360 SB
1035 7316 3200 (                *lpValueString = Global;) 3200 SB
1035 7499 3600 (                dwReturnValue = COMMAND_HELP;) 3600 SB
1035 7682 1040 (            }) 1040 SB
1035 7865 6160 (        } else { // first arg is not preceded by a '-' so compare to counters) 6160 SB
1035 8048 4560 (            // see if command line matches a counter name) 4560 SB
1035 8231 5200 (            for \(dwElem = 0; dwElem <= dwLastCounter; dwElem++\) {) 5200 SB
1035 8414 4400 (                // compare counter name to command line) 4400 SB
1035 8780 6240 (                if \(\(lstrcmpi\(lppCounterNames[dwElem], lpLocalString\)\) == 0\) {) 6240 SB
1035 8963 2720 (                    // match found) 2720 SB
1035 9146 4800 (                    // make element Number a string and exit) 4800 SB
1035 9329 6000 (                    _stprintf \(\(LPTSTR\)&cValueName[0], TEXT\("%d"\), dwElem\);) 6000 SB
1035 9512 4800 (                    *lpValueString = \(LPTSTR\)&cValueName[0];) 4800 SB
1035 9695 4160 (                    dwReturnValue = COMMAND_COUNTER;) 4160 SB
1035 9878 3680 (                    break;  // out of for loop) 3680 SB
1035 10061 4320 (                } // endif command line matches string) 4320 SB
1035 10244 3920 (            } // end for loop that searches table) 3920 SB
1035 10427 1920 (        } // if not "-?") 1920 SB
1035 10610 960 (    } else {) 960 SB
1035 10793 3040 (        dwReturnValue = COMMAND_ERROR;) 3040 SB
1035 10976 400 (    }) 400 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 480 def
/wp$fpage (480) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 480 def
/wp$fpage (480) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 23 23
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (481) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2192 2000 (    return dwReturnValue;) 2000 SB
1385 2375 1840 (} // ProcessCommandLine) 1840 SB
1385 2741 320 (VOID) 320 SB
1385 2924 1600 (DisplayObjectNames \() 1600 SB
1385 3107 2400 (    PPERF_DATA_BLOCK    pPerf,) 2400 SB
1385 3290 2480 (    LPTSTR              *pNames) 2480 SB
1385 3473 80 (\)) 80 SB
1385 3656 320 (/*++) 320 SB
1385 4022 1440 (DisplayObjectNames) 1440 SB
1385 4388 5680 (    Scans the perf data and prints the name of each object found in the) 5680 SB
1385 4571 640 (    list) 640 SB
1385 4937 720 (Arguments) 720 SB
1385 5303 720 (    pPerf) 720 SB
1385 5486 4960 (        pointer to the perf data block returned by the call to) 4960 SB
1385 5669 1840 (        RegQueryValueEx) 1840 SB
1385 6035 800 (    pNames) 800 SB
1385 6218 5680 (        pointer to the name table containing the array of counter names) 5680 SB
1385 6401 2720 (        and explain text pointers.) 2720 SB
1385 6767 960 (Return Value) 960 SB
1385 7133 640 (    NONE) 640 SB
1385 7499 320 (--*/) 320 SB
1385 7682 80 ({) 80 SB
1385 7865 4080 (    DWORD       dwThisObject;   // count of objects) 4080 SB
1385 8048 5440 (    PPERF_OBJECT_TYPE pThisObject;    // pointer to object structure) 5440 SB
1385 8414 5120 (    printf \("\\nThe available performance counter objects are:"\);) 5120 SB
1385 8780 5120 (    // loop from first object in buffer returned and display the) 5120 SB
1385 8963 3040 (    // number of objects in the buffer) 3040 SB
1385 9329 4880 (    for \(dwThisObject = 0, pThisObject = FirstObject \(pPerf\);) 4880 SB
1385 9512 3600 (        dwThisObject < pPerf->NumObjectTypes;) 3600 SB
1385 9695 5120 (        dwThisObject++, pThisObject = NextObject\(pThisObject\)\) {) 5120 SB
1385 10061 2400 (        printf \("\\n\\"%ws\\"\\n",) 2400 SB
1385 10244 4400 (            pNames[pThisObject->ObjectNameTitleIndex]\);) 4400 SB
1385 10610 3600 (        PrintExplainText \(OBJECT_TEXT_INDENT,) 3600 SB
1385 10793 4400 (            pNames[pThisObject->ObjectHelpTitleIndex]\);) 4400 SB
1385 10976 400 (    }) 400 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 481 def
/wp$fpage (481) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 481 def
/wp$fpage (481) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 24 24
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (482) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2009 1840 (} // DisplayObjectNames) 1840 SB
1035 2375 320 (VOID) 320 SB
1035 2558 1600 (DisplayCounterData \() 1600 SB
1035 2741 2400 (    PPERF_DATA_BLOCK    pPerf,) 2400 SB
1035 2924 2480 (    LPTSTR              *pNames) 2480 SB
1035 3107 80 (\)) 80 SB
1035 3290 320 (/*++) 320 SB
1035 3656 1440 (DisplayCounterData) 1440 SB
1035 4022 5840 (    Scans the perf data and prints the name of counter and instance found) 5840 SB
1035 4205 1200 (    in the list) 1200 SB
1035 4571 720 (Arguments) 720 SB
1035 4937 720 (    pPerf) 720 SB
1035 5120 4960 (        pointer to the perf data block returned by the call to) 4960 SB
1035 5303 1840 (        RegQueryValueEx) 1840 SB
1035 5669 800 (    pNames) 800 SB
1035 5852 5680 (        pointer to the name table containing the array of counter names) 5680 SB
1035 6035 2720 (        and explain text pointers.) 2720 SB
1035 6401 960 (Return Value) 960 SB
1035 6767 640 (    NONE) 640 SB
1035 7133 320 (--*/) 320 SB
1035 7316 80 ({) 80 SB
1035 7499 4720 (    DWORD               dwThisObject;   // count of objects) 4720 SB
1035 7682 5600 (    PPERF_OBJECT_TYPE   pThisObject;    // pointer to object structure) 5600 SB
1035 8048 4800 (    DWORD               dwThisCounter;  // count of counters) 4800 SB
1035 8231 3600 (    PPERF_COUNTER_DEFINITION    pThisCounter;) 3600 SB
1035 8597 2960 (    LONG               lThisInstance;) 2960 SB
1035 8780 3680 (    PPERF_INSTANCE_DEFINITION   pThisInstance;) 3680 SB
1035 9146 5360 (    // for each object in buffer, display each counter and instance) 5360 SB
1035 9512 4880 (    for \(dwThisObject = 0, pThisObject = FirstObject \(pPerf\);) 4880 SB
1035 9695 3600 (        dwThisObject < pPerf->NumObjectTypes;) 3600 SB
1035 9878 5120 (        dwThisObject++, pThisObject = NextObject\(pThisObject\)\) {) 5120 SB
1035 10244 3440 (        printf \("\\n\\nThe object \\"%ws\\", ",) 3440 SB
1035 10427 4400 (            pNames[pThisObject->ObjectNameTitleIndex]\);) 4400 SB
1035 10793 5360 (        // if there are instnances, then loop through all instances) 5360 SB
1035 10976 2000 (        // of this object) 2000 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 482 def
/wp$fpage (482) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 482 def
/wp$fpage (482) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 25 25
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (483) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2192 4880 (        if \(pThisObject->NumInstances != PERF_NO_INSTANCES\) {) 4880 SB
1385 2375 4720 (            printf \(" which has the following instances:"\);) 4720 SB
1385 2741 6320 (            for \(lThisInstance = 0, pThisInstance = FirstInstance\(pThisObject\);) 6320 SB
1385 2924 4640 (                lThisInstance < pThisObject->NumInstances;) 4640 SB
1385 3107 6320 (                lThisInstance++, pThisInstance = NextInstance\(pThisInstance\)\) {) 6320 SB
1385 3473 3040 (                printf \("\\n\\t\\"%ws\\"",) 3040 SB
1385 3656 6400 (                    \(LPWSTR\)\(\(PBYTE\)pThisInstance + pThisInstance->NameOffset\)\);) 6400 SB
1385 3839 1040 (            }) 1040 SB
1385 4022 2080 (            printf \("\\n"\);) 2080 SB
1385 4205 1280 (        } else {) 1280 SB
1385 4388 4320 (            printf \(" which has only one occurance,"\);) 4320 SB
1385 4571 720 (        }) 720 SB
1385 4937 4800 (        // now display all counters described in this object) 4800 SB
1385 5303 4240 (        printf \("\\nand has the following counters:"\);) 4240 SB
1385 5486 5920 (        for \(dwThisCounter = 0, pThisCounter = FirstCounter \(pThisObject\);) 5920 SB
1385 5669 4240 (            dwThisCounter < pThisObject->NumCounters;) 4240 SB
1385 5852 5760 (            dwThisCounter++, pThisCounter = NextCounter\(pThisCounter\)\) {) 5760 SB
1385 6218 2880 (            printf \("\\n    \\"%ws\\"",) 2880 SB
1385 6401 5200 (                    pNames[pThisCounter->CounterNameTitleIndex]\);) 5200 SB
1385 6767 720 (        }) 720 SB
1385 6950 400 (    }) 400 SB
1385 7133 1840 (} // DisplayCounterData) 1840 SB
1385 7499 240 (int) 240 SB
1385 7682 1120 (_CRTAPI1 main\() 1120 SB
1385 7865 1040 (    int argc,) 1040 SB
1385 8048 1280 (    char *argv[]) 1280 SB
1385 8231 80 (\)) 80 SB
1385 8414 320 (/*++) 320 SB
1385 8780 320 (main) 320 SB
1385 9146 2000 (    entry point to perfex) 2000 SB
1385 9512 2880 (    This program illustrates how to:) 2880 SB
1385 9878 5760 (        get performance counter names and explain text from the registry) 5760 SB
1385 10061 5920 (        obtain counter object value strings for use in querying perf. data) 5920 SB
1385 10244 5520 (        walk the performance data structures returned by the registry) 5520 SB
1385 10610 3040 (    This program does not show how to:) 3040 SB
1385 10976 4080 (        format or process the counter data returned) 4080 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 483 def
/wp$fpage (483) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 483 def
/wp$fpage (483) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 26 26
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (484) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2009 5440 (            the counter data returned by the registry depends on the) 5440 SB
1035 2192 5600 (            counter type. This data must be processed and formatted by) 5600 SB
1035 2375 2880 (            the application program.) 2880 SB
1035 2924 720 (Arguments) 720 SB
1035 3290 640 (    argc) 640 SB
1035 3473 3440 (        # of command line arguments present) 3440 SB
1035 3839 640 (    argv) 640 SB
1035 4022 3920 (        array of pointers to command line strings) 3920 SB
1035 4388 5520 (    \(note that these are obtained from the GetCommandLine function in) 5520 SB
1035 4571 4320 (    order to work with both UNICODE and ANSI strings.\)) 4320 SB
1035 4937 880 (ReturnValue) 880 SB
1035 5303 3680 (    0 \(ERROR_SUCCESS\) if command was processed) 3680 SB
1035 5486 3440 (    Non-Zero if command error was detected.) 3440 SB
1035 5852 320 (--*/) 320 SB
1035 6035 80 ({) 80 SB
1035 6401 4800 (    LPTSTR  *lpCounterText; // array of counter name strings) 4800 SB
1035 6584 4880 (    LPTSTR  lpCommandLine;  // pointer to command line string) 4880 SB
1035 6767 5760 (    LPTSTR  lpValueString;  // value string to pass to registry for data) 5760 SB
1035 7133 5280 (    DWORD   dwLastElement;  // number of elements in lpCounterText) 5280 SB
1035 7499 4960 (    PPERF_DATA_BLOCK  pDataBlock; // pointer to perfdata block) 4960 SB
1035 7865 4560 (    DWORD   dwStatus;       // return status of fn. calls) 4560 SB
1035 8048 5520 (    DWORD   dwAction;       // display mode indicated by command line) 5520 SB
1035 8414 4800 (    // query counter names from registry and load into table) 4800 SB
1035 8780 2880 (    lpCounterText = BuildNameTable \() 2880 SB
1035 8963 2160 (        HKEY_LOCAL_MACHINE,) 2160 SB
1035 9146 1760 (        DefaultLangId,) 1760 SB
1035 9329 1920 (        &dwLastElement\);) 1920 SB
1035 9695 2000 (    if \(!lpCounterText\) {) 2000 SB
1035 9878 5600 (        printf \("ERROR: Unable to read counter names from registry."\);) 5600 SB
1035 10061 1760 (        return \(TRUE\);) 1760 SB
1035 10244 400 (    }) 400 SB
1035 10610 4560 (    lpCommandLine = GetCommandLine\(\); // get command line) 4560 SB
1035 10976 3840 (    // read command line to determine what to do) 3840 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 484 def
/wp$fpage (484) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 484 def
/wp$fpage (484) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 27 27
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (485) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2192 3920 (    dwAction = ProcessCommandLine \(lpCommandLine,) 3920 SB
1385 2375 1760 (        lpCounterText,) 1760 SB
1385 2558 1760 (        dwLastElement,) 1760 SB
1385 2741 1920 (        &lpValueString\);) 1920 SB
1385 3107 5600 (    if \(dwAction == COMMAND_ERROR\) { // if unable to read command line) 5600 SB
1385 3290 5280 (        DisplayCommandHelp\(\);        // display command line usage) 5280 SB
1385 3473 5440 (        free \(lpCounterText\);        // free buffer and return error) 5440 SB
1385 3656 1760 (        return \(TRUE\);) 1760 SB
1385 3839 960 (    } else {) 960 SB
1385 4022 5680 (        // of command requires processing, then get perf data from reg.) 5680 SB
1385 4205 2080 (        pDataBlock = NULL;) 2080 SB
1385 4388 3040 (        dwStatus = GetSystemPerfData \() 3040 SB
1385 4571 2720 (            HKEY_PERFORMANCE_DATA,) 2720 SB
1385 4754 2080 (            lpValueString,) 2080 SB
1385 4937 2000 (            &pDataBlock\);) 2000 SB
1385 5303 3200 (        if \(dwStatus != ERROR_SUCCESS\) {) 3200 SB
1385 5486 5680 (            printf \("\\nERROR: Unable to obtain data for that counter"\);) 5680 SB
1385 5669 2640 (            free \(lpCounterText\);) 2640 SB
1385 5852 2400 (            return \(dwStatus\);) 2400 SB
1385 6035 1280 (        } else {) 1280 SB
1385 6401 5760 (            // if data was returned, then display in format requested by) 5760 SB
1385 6584 2160 (            // command line) 2160 SB
1385 6950 3440 (            if \(dwAction == COMMAND_HELP\) {) 3440 SB
1385 7133 4960 (                // display object names returned from registry) 4960 SB
1385 7316 5040 (                DisplayObjectNames \(pDataBlock, lpCounterText\);) 5040 SB
1385 7499 1600 (            } else {) 1600 SB
1385 7682 4800 (                // display counter data for specified object) 4800 SB
1385 7865 5040 (                DisplayCounterData \(pDataBlock, lpCounterText\);) 5040 SB
1385 8048 1040 (            }) 1040 SB
1385 8231 720 (        }) 720 SB
1385 8597 2320 (        free \(lpCounterText\);) 2320 SB
1385 8780 3360 (        return \(ERROR_SUCCESS\); // success) 3360 SB
1385 8963 400 (    }) 400 SB
1385 9146 80 (}) 80 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 9595 4314 (66.2.2  Displaying Counter Title Indices) 4314 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 9976 5536 (This section includes example code that displays counter-title indices and their) 5536 SB
2885 10176 492 (names.) 492 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
1385 10529 1360 (#define UNICODE 1) 1360 SB
1385 10712 1440 (#define _UNICODE 1) 1440 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 485 def
/wp$fpage (485) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 485 def
/wp$fpage (485) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 28 28
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (486) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1035 2009 1440 (#include <stdio.h>) 1440 SB
1035 2192 1520 (#include <stdlib.h>) 1520 SB
1035 2375 1520 (#include <assert.h>) 1520 SB
1035 2558 1600 (#include <windows.h>) 1600 SB
1035 2741 1520 (#include <string.h>) 1520 SB
1035 2924 1520 (#include <memory.h>) 1520 SB
1035 3107 1600 (#include <process.h>) 1600 SB
1035 3290 1440 (#include <tchar.h>) 1440 SB
1035 3656 1520 (#define SZ_DUMMY 10) 1520 SB
1035 4022 2400 (int GetRegDataBound\(HKEY hkey\)) 2400 SB
1035 4205 80 ({) 80 SB
1035 4388 2240 (    TCHAR chDummy[SZ_DUMMY];) 2240 SB
1035 4571 1520 (    DWORD cSubKeys;) 1520 SB
1035 4754 1760 (    DWORD cbMaxSubkey;) 1760 SB
1035 4937 1680 (    DWORD cbMaxClass;) 1680 SB
1035 5120 1440 (    DWORD cValues;) 1440 SB
1035 5303 2000 (    DWORD cbMaxValueName;) 2000 SB
1035 5669 2000 (    DWORD cbMaxValueData;) 2000 SB
1035 5852 2480 (    DWORD cbSecurityDescriptor;) 2480 SB
1035 6035 2320 (    FILETIME ftLastWriteTime;) 2320 SB
1035 6218 1200 (    DWORD lErr;) 1200 SB
1035 6401 2640 (    DWORD cbClassSize = SZ_DUMMY;) 2640 SB
1035 6767 4400 (    lErr = RegQueryInfoKey\(hkey, chDummy, &cbClassSize,) 4400 SB
1035 6950 4080 (        NULL, &cSubKeys, &cbMaxSubkey, &cbMaxClass,) 4080 SB
1035 7133 4080 (        &cValues, &cbMaxValueName, &cbMaxValueData,) 4080 SB
1035 7316 3920 (        &cbSecurityDescriptor, &ftLastWriteTime\);) 3920 SB
1035 7682 2400 (    if \(lErr == ERROR_SUCCESS\)) 2400 SB
1035 8048 2400 (        return cbMaxValueData;) 2400 SB
1035 8231 640 (    else) 640 SB
1035 8414 1440 (        return -1;) 1440 SB
1035 8597 80 (}) 80 SB
1035 9146 240 (int) 240 SB
1035 9329 1120 (_CRTAPI1 main\() 1120 SB
1035 9512 80 (\)) 80 SB
1035 9695 80 ({) 80 SB
1035 9878 1440 (    HKEY hKeyData;) 1440 SB
1035 10061 1120 (    LONG lErr;) 1120 SB
1035 10244 1440 (    LPTSTR lptstr;) 1440 SB
1035 10427 1280 (    int   iSize;) 1280 SB
1035 10610 1360 (    DWORD dwType;) 1360 SB
1035 10793 1360 (    DWORD dwSize;) 1360 SB
1035 10976 1360 (    int   iIndex;) 1360 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 486 def
/wp$fpage (486) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 486 def
/wp$fpage (486) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 29 29
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5674 1517 669 (Chapter 66) 669 SB
6343 1517 144 (    ) 144 SB
6487 1517 1494 (Performance Monitoring) 1494 SB
7981 1517 36 ( ) 244 SB
8225 1517 36 ( ) 244 SB
8469 1517 216 (487) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
1385 2192 3440 (    lErr = RegOpenKeyEx\(HKEY_LOCAL_MACHINE,) 3440 SB
1385 2375 6240 (        TEXT\("Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib\\\\409"\),) 6240 SB
1385 2558 3040 (        0, KEY_ALL_ACCESS, &hKeyData\);) 3040 SB
1385 2924 2720 (    assert\(lErr == ERROR_SUCCESS\);) 2720 SB
1385 3473 3040 (    iSize = GetRegDataBound\(hKeyData\);) 3040 SB
1385 3839 1600 (    if \(iSize == -1\)) 1600 SB
1385 4022 1360 (        exit\(-1\);) 1360 SB
1385 4388 960 (    iSize++;) 960 SB
1385 4571 3440 (    lptstr = malloc\(iSize * sizeof\(TCHAR\)\);) 3440 SB
1385 4937 1520 (    dwSize = iSize;) 1520 SB
1385 5303 5280 (    lErr = RegQueryValueEx\(hKeyData, TEXT\("Counters"\), 0, &dwType,) 5280 SB
1385 5486 2720 (        \(LPBYTE\) lptstr, &dwSize\);) 2720 SB
1385 5852 2720 (    assert\(lErr == ERROR_SUCCESS\);) 2720 SB
1385 6218 1680 (    while \(*lptstr\) {) 1680 SB
1385 6401 3840 (        _stscanf \(lptstr, TEXT\(" %d"\), &iIndex\);) 3840 SB
1385 6584 2560 (//        iIndex = atoi\(lptstr\);) 2560 SB
1385 6767 3040 (        lptstr += lstrlen\(lptstr\) + 1;) 3040 SB
1385 6950 5120 (        printf\("#define CNTR_%.3d\\t \\"%ws\\"\\n", iIndex, lptstr\);) 5120 SB
1385 7316 3040 (        lptstr += lstrlen\(lptstr\) + 1;) 3040 SB
1385 7499 400 (    }) 400 SB
1385 7865 2640 (    lErr = RegCloseKey\(hKeyData\);) 2640 SB
1385 8048 2720 (    assert\(lErr == ERROR_SUCCESS\);) 2720 SB
1385 8231 1040 (    return 0;) 1040 SB
1385 8414 80 (}) 80 SB
32 0 0 333 333 0 0 0 311 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 8906 1990 (66.3  Functions) 1990 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 9361 4350 (Following are the functions used for performance monitoring.) 4350 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 9691 1547 (RegConnectRegistry) 1547 SB
2885 9891 1412 (RegQueryValueEx) 1412 SB
2885 10091 2073 (QueryPerformanceCounter) 2073 SB
2885 10291 2249 (QueryPerformanceFrequency) 2249 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 487 def
/wp$fpage (487) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 487 def
/wp$fpage (487) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 30 30
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (488) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3220 (Microsoft Win32 Programmer\222s Reference, Volume 2) 3220 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 250 250 1 0 0 232 /Helvetica-Bold /font13 ANSIFont font
0 0 0 fC
4607 2326 1655 (BLANK PAGE) 1655 SB
32 0 0 250 250 0 0 0 232 /Helvetica-Bold /font13 ANSIFont font
2535 3020 5344 (IMPORTANT: This text will appear on screen,) 5344 SB
2535 3314 4772 (but will not print on a PostScript printer.) 4772 SB
2535 3741 5411 (This page should be the last one in this file; it) 5411 SB
2535 4035 5346 (was inserted by running the InsertBlankPage) 5346 SB
2535 4329 819 (macro.) 819 SB
2535 4756 5261 (Do not type any additional text on this page!) 5261 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 488 def
/wp$fpage (488) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def
1 setgray 41.5 73 moveto 0 646 rlineto 529 0 rlineto 0 646 neg rlineto closepath fill
 grestore
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 488 def
/wp$fpage (488) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 588 (PERFMON.DOC) 588 SB
gr
gs 5800 351 1426 12120 CB
2389 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:35) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 488 def
/wp$fpage (488) def
/wp$date (05/05/93) def
/wp$time (16:36) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Bold
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%Trailer
SVDoc restore
end
%%Pages: 30
% TrueType font name key:
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT31c2a1 = 0ae7DArial NarrowF00000000000002bc0000
%    MSTT31c2ad = 0ae7DTimes New RomanF00000064000001900000
%    MSTT31c2ba = 0ae7DTimes New RomanF00000000000001900000
%    MSTT31c2c7 = 0ae7DTimes New RomanF00000053000001900000
%    MSTT31c2d4 = 0ae7DTimes New RomanF00000000000002bc0000
%    MSTT31c2e1 = 0ae7DTimes New RomanF00000043000001900000
%    MSTT31c2ee = 0ae7DArialF00000000000002bc0000
%    MSTT31c2f9 = 0ae7DTimes New RomanF00000000000001900001
%    MSTT31c306 = 0ae7DLucida Sans TypewriterF00000000000001900000
%%DocumentSuppliedResources: procset Win35Dict 3 1

%%DocumentNeededResources: font Helvetica-Bold
%%+ font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman

%%EOF
