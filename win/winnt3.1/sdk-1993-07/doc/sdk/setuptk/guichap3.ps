%!PS-Adobe-3.0
%%Creator: Windows PSCRIPT
%%Title: PageMaker 4.0 - GUICHAP3.PM4
%%BoundingBox: 12 12 600 996
%%DocumentNeededResources: (atend)
%%DocumentSuppliedResources: (atend)
%%Pages: (atend)
%%BeginResource: procset Win33Dict 3 1
/Win33Dict 290 dict def Win33Dict begin/bd{bind def}bind def/in{72
mul}bd/ed{exch def}bd/ld{load def}bd/tr/translate ld/gs/gsave ld/gr/grestore
ld/M/moveto ld/L/lineto ld/rmt/rmoveto ld/rlt/rlineto ld/rct/rcurveto
ld/st/stroke ld/n/newpath ld/sm/setmatrix ld/cm/currentmatrix ld/cp/closepath
ld/ARC/arcn ld/TR{65536 div}bd/lj/setlinejoin ld/lc/setlinecap ld/ml/setmiterlimit
ld/sl/setlinewidth ld/scignore false def/sc{scignore{pop pop pop}{0
index 2 index eq 2 index 4 index eq and{pop pop 255 div setgray}{3{255
div 3 1 roll}repeat setrgbcolor}ifelse}ifelse}bd/FC{bR bG bB sc}bd/fC{/bB
ed/bG ed/bR ed}bd/HC{hR hG hB sc}bd/hC{/hB ed/hG ed/hR ed}bd/PC{pR
pG pB sc}bd/pC{/pB ed/pG ed/pR ed}bd/sM matrix def/PenW 1 def/iPen
5 def/mxF matrix def/mxE matrix def/fBE false def/iDevRes 72 0 matrix
defaultmatrix dtransform dup mul exch dup mul add sqrt def/SS{/SV save
def}bd/RS{SV restore}bd/EJ{gsave showpage grestore}bd/#C{userdict begin/#copies
ed end}bd/SM{/iRes ed/cyP exch def/cxP exch def/cyM exch def/cxM exch
def 72 iRes div dup neg scale 0 ne{cyP cxP neg tr 90 rotate cxM cyM}{cxM
cyM cyP sub}ifelse tr 0 0 transform .25 add round .25 sub exch .25
add round .25 sub exch itransform translate}bd/SJ{1 index 0 eq{pop
pop/fBE false def}{1 index/Break ed div/dxBreak ed/fBE true def}ifelse}bd/ANSIVec[
16#0/grave 16#1/acute 16#2/circumflex 16#3/tilde 16#4/macron 16#5/breve
16#6/dotaccent 16#7/dieresis 16#8/ring 16#9/cedilla 16#A/hungarumlaut
16#B/ogonek 16#C/caron 16#D/dotlessi 16#27/quotesingle 16#60/grave
16#7C/bar 16#91/quoteleft 16#92/quoteright 16#93/quotedblleft 16#94/quotedblright
16#95/bullet 16#96/endash 16#97/emdash 16#A0/space 16#A4/currency 16#A6/brokenbar
16#A7/section 16#A8/dieresis 16#A9/copyright 16#AA/ordfeminine 16#AB/guillemotleft
16#AC/logicalnot 16#AD/hyphen 16#AE/registered 16#AF/macron 16#B0/degree
16#B1/plusminus 16#B2/twosuperior 16#B3/threesuperior 16#B4/acute 16#B5/mu
16#B6/paragraph 16#B7/periodcentered 16#B8/cedilla 16#B9/onesuperior
16#BA/ordmasculine 16#BB/guillemotright 16#BC/onequarter 16#BD/onehalf
16#BE/threequarters 16#BF/questiondown 16#C0/Agrave 16#C1/Aacute 16#C2/Acircumflex
16#C3/Atilde 16#C4/Adieresis 16#C5/Aring 16#C6/AE 16#C7/Ccedilla 16#C8/Egrave
16#C9/Eacute 16#CA/Ecircumflex 16#CB/Edieresis 16#CC/Igrave 16#CD/Iacute
16#CE/Icircumflex 16#CF/Idieresis 16#D0/Eth 16#D1/Ntilde 16#D2/Ograve
16#D3/Oacute 16#D4/Ocircumflex 16#D5/Otilde 16#D6/Odieresis 16#D7/multiply
16#D8/Oslash 16#D9/Ugrave 16#DA/Uacute 16#DB/Ucircumflex 16#DC/Udieresis
16#DD/Yacute 16#DE/Thorn 16#DF/germandbls 16#E0/agrave 16#E1/aacute
16#E2/acircumflex 16#E3/atilde 16#E4/adieresis 16#E5/aring 16#E6/ae
16#E7/ccedilla 16#E8/egrave 16#E9/eacute 16#EA/ecircumflex 16#EB/edieresis
16#EC/igrave 16#ED/iacute 16#EE/icircumflex 16#EF/idieresis 16#F0/eth
16#F1/ntilde 16#F2/ograve 16#F3/oacute 16#F4/ocircumflex 16#F5/otilde
16#F6/odieresis 16#F7/divide 16#F8/oslash 16#F9/ugrave 16#FA/uacute
16#FB/ucircumflex 16#FC/udieresis 16#FD/yacute 16#FE/thorn 16#FF/ydieresis
] def/reencdict 12 dict def/IsChar{basefontdict/CharStrings get exch
known}bd/MapCh{dup IsChar not{pop/bullet}if newfont/Encoding get 3
1 roll put}bd/MapDegree{16#b0/degree IsChar{/degree}{/ring}ifelse MapCh}bd/MapBB{16#a6/brokenbar
IsChar{/brokenbar}{/bar}ifelse MapCh}bd/ANSIFont{reencdict begin/newfontname
ed/basefontname ed FontDirectory newfontname known not{/basefontdict
basefontname findfont def/newfont basefontdict maxlength dict def basefontdict{exch
dup/FID ne{dup/Encoding eq{exch dup length array copy newfont 3 1 roll
put}{exch newfont 3 1 roll put}ifelse}{pop pop}ifelse}forall newfont/FontName
newfontname put 127 1 159{newfont/Encoding get exch/bullet put}for
ANSIVec aload pop ANSIVec length 2 idiv{MapCh}repeat MapDegree MapBB
newfontname newfont definefont pop}if newfontname end}bd/SB{FC/str
ed str length fBE not{dup 1 gt{1 sub}if}if/cbStr ed/dxGdi ed/y0 ed/x0
ed str stringwidth esc 0 ne{mxE itransform exch neg dxGdi add cbStr
div exch mxE transform}{exch neg dxGdi add cbStr div exch}ifelse/dyExtra
ed/dxExtra ed x0 y0 M fBE{dxBreak 0 BCh dxExtra dyExtra str awidthshow}{dxExtra
dyExtra str ashow}ifelse fUL{x0 y0 M dxUL dyUL rmt dxGdi fBE{Break
add}if 0 mxE transform rlt cyUL sl st}if fSO{x0 y0 M dxSO dySO rmt
dxGdi fBE{Break add}if 0 mxE transform rlt cyUL sl st}if n/fBE false
def}bd/font{/name ed/Ascent ed 0 ne/fSO ed 0 ne/fUL ed/Sy ed/Sx ed
10.0 div/ori ed -10.0 div/esc ed/BCh ed name findfont [Sx 0 0 Sy neg
0 Ascent] esc mxE rotate mxF concatmatrix makefont setfont fUL{currentfont
dup/FontInfo get/UnderlinePosition known not{pop/Courier findfont}if/FontInfo
get/UnderlinePosition get 1000 div 0 exch mxF transform/dyUL ed/dxUL
ed}if fSO{0 .3 mxF transform/dySO ed/dxSO ed}if fUL fSO or{currentfont
dup/FontInfo get/UnderlineThickness known not{pop/Courier findfont}if/FontInfo
get/UnderlineThickness get 1000 div Sy mul/cyUL ed}if}bd/min{2 copy
gt{exch}if pop}bd/max{2 copy lt{exch}if pop}bd/CP{/ft ed{{ft 0 eq{clip}{eoclip}ifelse}stopped{currentflat
1 add setflat}{exit}ifelse}loop}bd/patfont 10 dict def patfont begin/FontType
3 def/FontMatrix [1 0 0 1 0 0] def/FontBBox [0 0 32 32] def/Encoding
StandardEncoding def/BuildChar{pop pop 32 0 0 0 32 32 setcachedevice
2 2 scale 16 16 false [1 0 0 1 .25 .25]{pat}imagemask}bd end/p{/pat
32 string def{}forall 0 1 7{dup 2 mul pat exch 3 index put dup 2 mul
1 add pat exch 3 index put dup 2 mul 16 add pat exch 3 index put 2
mul 17 add pat exch 2 index put pop}for}bd/pfill{/PatFont patfont definefont
setfont/ch(AAAA)def X0 128 X1{Y0 32 Y1{1 index exch M ch show}for pop}for}bd/vert{X0
w X1{dup Y0 M Y1 L st}for}bd/horz{Y0 w Y1{dup X0 exch M X1 exch L st}for}bd/fdiag{X0
w X1{Y0 M X1 X0 sub dup rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup
rlt st}for}bd/bdiag{X0 w X1{Y1 M X1 X0 sub dup neg rlt st}for Y0 w
Y1{X0 exch M Y1 Y0 sub dup neg rlt st}for}bd/AU{1 add cvi 15 or}bd/AD{1
sub cvi -16 and}bd/SHR{pathbbox AU/Y1 ed AU/X1 ed AD/Y0 ed AD/X0 ed}bd/hfill{2
sl [] 0 setdash n/w iRes 20 div 8 div round 8 mul def dup 0 eq{horz}if
dup 1 eq{vert}if dup 2 eq{fdiag}if dup 3 eq{bdiag}if dup 4 eq{horz
vert}if 5 eq{fdiag bdiag}if}bd/F{/ft ed fm 256 and 0 ne{gs FC ft 0
eq{fill}{eofill}ifelse gr}if fm 1536 and 0 ne{SHR gs HC ft CP fm 1024
and 0 ne{/Tmp save def pfill Tmp restore}{fm 15 and hfill}ifelse gr}if}bd/S{PenW
sl PC st}bd/m matrix def/GW{iRes 12 div PenW add cvi}bd/DoW{iRes 50
div PenW add cvi}bd/DW{iRes 8 div PenW add cvi}bd/SP{/PenW ed/iPen
ed iPen 0 eq{[] 0 setdash}if iPen 1 eq{[DW GW] 0 setdash}if iPen 2
eq{[DoW GW] 0 setdash}if iPen 3 eq{[DW GW DoW GW] 0 setdash}if iPen
4 eq{[DW GW DoW GW DoW GW] 0 setdash}if}bd/E{m cm pop tr scale 0 0
1 0 360 arc cp m sm}bd/AG{/sy ed/sx ed sx div 4 1 roll sy div 4 1 roll
sx div 4 1 roll sy div 4 1 roll atan/a2 ed atan/a1 ed sx sy scale a1
a2 ARC}def/A{m cm pop tr AG m sm}def/P{m cm pop tr 0 0 M AG cp m sm}def/RRect{n
4 copy M 3 1 roll exch L 4 2 roll L L cp}bd/RRCC{/r ed/y1 ed/x1 ed/y0
ed/x0 ed x0 r add y0 M x1 y0 x1 y1 r arcto 4{pop}repeat x1 y1 x0 y1
r arcto 4{pop}repeat x0 y1 x0 y0 r arcto 4{pop}repeat x0 y0 x1 y0 r
arcto 4{pop}repeat cp}bd/RR{2 copy 0 eq exch 0 eq or{pop pop RRect}{2
copy eq{pop RRCC}{m cm pop/y2 ed/x2 ed/ys y2 x2 div 1 max def/xs x2
y2 div 1 max def/y1 exch ys div def/x1 exch xs div def/y0 exch ys div
def/x0 exch xs div def/r2 x2 y2 min def xs ys scale x0 r2 add y0 M
x1 y0 x1 y1 r2 arcto 4{pop}repeat x1 y1 x0 y1 r2 arcto 4{pop}repeat
x0 y1 x0 y0 r2 arcto 4{pop}repeat x0 y0 x1 y0 r2 arcto 4{pop}repeat
m sm cp}ifelse}ifelse}bd/PP{{rlt}repeat}bd/OB{gs sc B fill gr}bd/B{M/dy
ed/dx ed dx 0 rlt 0 dy rlt dx neg 0 rlt cp}bd/CB{B clip n}bd
%%EndResource
%%EndProlog
%%BeginSetup
statusdict begin 0 setjobtimeout end
statusdict begin statusdict /jobname (PageMaker 4.0 - GUICHAP3.PM4) put end
{statusdict begin 2 setpapertray end
}stopped pop
{statusdict begin 2 setoutputtray end
}stopped pop
{statusdict begin false setduplexmode false settumble end
}stopped pop
{statusdict begin legal end
}stopped pop
[{ }
/exec load currenttransfer /exec load] cvx settransfer
%%EndSetup
%%Page: 1 1
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
302 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
1165 871 129 (Chapter) SB
gr
gs 2454 3278 0 413 CB
1305 871 19 (3) SB
gr
gs 2454 3278 0 413 CB
1492 871 139 (Creating) SB
gr
gs 2454 3278 0 413 CB
1642 871 19 (a) SB
gr
gs 2454 3278 0 413 CB
1672 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1778 871 97 (Script) SB
gr
gs 2454 3278 0 413 CB
2043 871 38 (19) SB
gr
32 0 0 98 100 0 0 94 /Helvetica-Narrow-Bold /font26 ANSIFont font
302 988 1309 (Chapter 3: Creating a Setup Script) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 1390 1407 (Once you\222ve identified the list of installable files and used the Windows Dialog) SB
652 1438 1369 (Editor to design dialog boxes and message boxes, you\222re ready to create your) SB
652 1486 1386 (installation script file. A script file contains the procedure calls that Setup uses) SB
652 1534 771 (to install your product on the user\222s system.) SB
652 1636 1376 (The Setup toolkit comes with three sets of sample files that you can modify to) SB
652 1684 1301 (create your own installation script. You\222ll also want to modify the sample) SB
652 1732 1346 (SETUP.LST file so that the Setup driver can find the appropriate .DLLs and) SB
652 1780 1391 (other supporting files that are needed to run your installation. This chapter will) SB
652 1828 1400 (walk you through the process of creating your own script and SETUP.LST file.) SB
652 1930 1388 (Start by reviewing the files that make up the Setup toolkit. The following table) SB
652 1978 925 (lists the name and purpose of each file in the toolkit.) SB
4 94 652 2081 B
1 F
n
454 4 652 2081 B
1 F
n
4 94 1102 2081 B
1 F
n
454 3 652 2172 B
1 F
n
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
gs 1355 1048 652 2081 CB
670 2098 174 (Filename) SB
gr
904 4 1102 2081 B
1 F
n
4 94 2002 2081 B
1 F
n
904 3 1102 2172 B
1 F
n
gs 1355 1048 652 2081 CB
1120 2098 218 (Description) SB
gr
4 416 652 2172 B
1 F
n
4 416 1102 2172 B
1 F
n
454 3 652 2585 B
1 F
n
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
gs 1355 1048 652 2081 CB
670 2189 231 (SETUP.EXE) SB
gr
gs 1355 1048 652 2081 CB
670 2237 178 (\(required\)) SB
gr
4 416 2002 2172 B
1 F
n
904 3 1102 2585 B
1 F
n
gs 1355 1048 652 2081 CB
1120 2189 815 (The bootstrapper program that copies the files) SB
gr
gs 1355 1048 652 2081 CB
1120 2237 751 (identified in SETUP.LST into a temporary) SB
gr
gs 1355 1048 652 2081 CB
1120 2285 849 (directory on the user's hard disk. These files run) SB
gr
gs 1355 1048 652 2081 CB
1120 2333 785 (the installation and include _MSTEST.EXE,) SB
gr
gs 1355 1048 652 2081 CB
1120 2381 770 (_MSSETUP.EXE, and any .DLL files. You) SB
gr
gs 1355 1048 652 2081 CB
1120 2429 836 (should always include SETUP.EXE on the first) SB
gr
gs 1355 1048 652 2081 CB
1120 2477 780 (installation disk. SETUP.EXE should not be) SB
gr
gs 1355 1048 652 2081 CB
1120 2524 220 (compressed.) SB
gr
4 273 652 2585 B
1 F
n
4 273 1102 2585 B
1 F
n
454 3 652 2855 B
1 F
n
gs 1355 1048 652 2081 CB
670 2602 223 (SETUP.LST) SB
gr
gs 1355 1048 652 2081 CB
670 2650 178 (\(required\)) SB
gr
4 273 2002 2585 B
1 F
n
904 3 1102 2855 B
1 F
n
gs 1355 1048 652 2081 CB
1120 2602 678 (A text file that contains the list of files) SB
gr
gs 1355 1048 652 2081 CB
1120 2650 863 (SETUP.EXE copies into the temporary directory) SB
gr
gs 1355 1048 652 2081 CB
1120 2698 753 (on the user's hard disk. You should always) SB
gr
gs 1355 1048 652 2081 CB
1120 2746 867 (include SETUP.LST on the first installation disk.) SB
gr
gs 1355 1048 652 2081 CB
1120 2794 702 (SETUP.LST should not be compressed.) SB
gr
4 273 652 2855 B
1 F
n
4 273 1102 2855 B
1 F
n
454 4 652 3124 B
1 F
n
gs 1355 1048 652 2081 CB
670 2872 287 (_MSTEST.EXE) SB
gr
gs 1355 1048 652 2081 CB
670 2920 178 (\(required\)) SB
gr
4 273 2002 2855 B
1 F
n
904 4 1102 3124 B
1 F
n
gs 1355 1048 652 2081 CB
1120 2872 802 (A limited, run-time version of Microsoft Test) SB
gr
gs 1355 1048 652 2081 CB
1120 2920 830 (that Setup uses as its driver. _MSTEST.EXE is) SB
gr
gs 1355 1048 652 2081 CB
1120 2968 803 (the interpreter of your installation script. You) SB
gr
gs 1355 1048 652 2081 CB
1120 3016 810 (should always include _MSTEST.EXE on the) SB
gr
gs 1355 1048 652 2081 CB
1120 3064 372 (first installation disk.) SB
gr
255 255 255 fC
1329 88 840 835 B
1 F
n
1 lc
1 lj
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%+ font Times-Bold
%%Page: 2 2
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
377 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
377 871 38 (20) SB
gr
gs 2454 3278 0 413 CB
583 871 154 (Microsoft) SB
gr
gs 2454 3278 0 413 CB
748 871 152 (Windows) SB
gr
gs 2454 3278 0 413 CB
911 871 126 (Version) SB
gr
gs 2454 3278 0 413 CB
1048 871 48 (3.1) SB
gr
gs 2454 3278 0 413 CB
1107 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1213 871 113 (Toolkit) SB
gr
4 527 735 1002 B
1 F
n
454 2 735 1002 B
1 F
n
4 527 1185 1002 B
1 F
n
454 4 735 1525 B
1 F
n
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
gs 1355 2025 735 1002 CB
753 1017 316 (_MSSETUP.EXE) SB
gr
gs 1355 2025 735 1002 CB
753 1065 174 (\(optional\)) SB
gr
904 2 1185 1002 B
1 F
n
4 527 2085 1002 B
1 F
n
904 4 1185 1525 B
1 F
n
gs 1355 2025 735 1002 CB
1203 1017 639 (An MS-DOS program that reads the) SB
gr
gs 1355 2025 735 1002 CB
1203 1065 807 (MSSETUP.BAT file and updates system files) SB
gr
gs 1355 2025 735 1002 CB
1203 1113 798 (\(that is, files that have the SYSTEM attribute) SB
gr
gs 1355 2025 735 1002 CB
1203 1161 820 (and may be in use when Windows is running\).) SB
gr
gs 1355 2025 735 1002 CB
1203 1209 846 (The Setup ExitExecRestart function shuts down) SB
gr
gs 1355 2025 735 1002 CB
1203 1257 855 (Windows, runs _MSSETUP.EXE to update files) SB
gr
gs 1355 2025 735 1002 CB
1203 1305 863 (listed in MSSETUP.BAT, and restarts Windows.) SB
gr
gs 1355 2025 735 1002 CB
1203 1353 840 (If you plan to install or update any system files,) SB
gr
gs 1355 2025 735 1002 CB
1203 1401 832 (you must include _MSSETUP.EXE on the first) SB
gr
gs 1355 2025 735 1002 CB
1203 1449 290 (installation disk.) SB
gr
4 223 735 1525 B
1 F
n
4 223 1185 1525 B
1 F
n
gs 1355 2025 735 1002 CB
753 1543 307 (Setup .DLL files:) SB
gr
gs 1355 2025 735 1002 CB
753 1590 178 (\(required\)) SB
gr
4 223 2085 1525 B
1 F
n
gs 1355 2025 735 1002 CB
1203 1543 841 (These .DLL files contain the code for the Setup) SB
gr
gs 1355 2025 735 1002 CB
1203 1590 803 (procedures that you call from your script file.) SB
gr
gs 1355 2025 735 1002 CB
1203 1638 856 (You should list them in the SETUP.LST file and) SB
gr
gs 1355 2025 735 1002 CB
1203 1686 732 (include them on the first installation disk.) SB
gr
4 134 735 1749 B
1 F
n
4 134 1185 1749 B
1 F
n
gs 1355 2025 735 1002 CB
753 1764 368 (   MSCOMSTF.DLL) SB
gr
4 134 2085 1749 B
1 F
n
gs 1355 2025 735 1002 CB
1203 1764 850 (The common library, which contains supporting) SB
gr
gs 1355 2025 735 1002 CB
1203 1812 578 (routines for the other .DLL files.) SB
gr
4 269 735 1884 B
1 F
n
4 269 1185 1884 B
1 F
n
gs 1355 2025 735 1002 CB
753 1899 344 (   MSCUISTF.DLL) SB
gr
4 269 2085 1884 B
1 F
n
gs 1355 2025 735 1002 CB
1203 1899 760 (The customized user interface library. You) SB
gr
gs 1355 2025 735 1002 CB
1203 1947 802 (modify this .DLL file when you create dialog) SB
gr
gs 1355 2025 735 1002 CB
1203 1995 857 (boxes and message boxes. For more information) SB
gr
gs 1355 2025 735 1002 CB
1203 2043 800 (about this process, see Chapter 2, "Designing) SB
gr
gs 1355 2025 735 1002 CB
1203 2091 270 (Dialog Boxes.") SB
gr
4 187 735 2154 B
1 F
n
4 187 1185 2154 B
1 F
n
gs 1355 2025 735 1002 CB
753 2169 354 (   MSDETSTF.DLL) SB
gr
4 187 2085 2154 B
1 F
n
gs 1355 2025 735 1002 CB
1203 2169 865 (The detection library, which contains procedures) SB
gr
gs 1355 2025 735 1002 CB
1203 2217 830 (that return information about the user's system,) SB
gr
gs 1355 2025 735 1002 CB
1203 2265 574 (such as the version of Windows.) SB
gr
4 134 735 2342 B
1 F
n
4 134 1185 2342 B
1 F
n
gs 1355 2025 735 1002 CB
753 2357 339 (   MSINSSTF.DLL) SB
gr
4 134 2085 2342 B
1 F
n
gs 1355 2025 735 1002 CB
1203 2357 810 (The install library, which contains procedures) SB
gr
gs 1355 2025 735 1002 CB
1203 2405 686 (that install files on the user's hard disk.) SB
gr
4 224 735 2477 B
1 F
n
4 224 1185 2477 B
1 F
n
gs 1355 2025 735 1002 CB
753 2492 342 (   MSUILSTF.DLL) SB
gr
4 224 2085 2477 B
1 F
n
gs 1355 2025 735 1002 CB
1203 2492 738 (The user interface library, which contains) SB
gr
gs 1355 2025 735 1002 CB
1203 2540 807 (procedures that manipulate the user interface,) SB
gr
gs 1355 2025 735 1002 CB
1203 2588 784 (such as displaying a dialog box or deleting a) SB
gr
gs 1355 2025 735 1002 CB
1203 2636 583 (dialog box from the dialog stack.) SB
gr
4 134 735 2702 B
1 F
n
4 134 1185 2702 B
1 F
n
gs 1355 2025 735 1002 CB
753 2717 351 (   MSSHLSTF.DLL) SB
gr
4 134 2085 2702 B
1 F
n
gs 1355 2025 735 1002 CB
1203 2717 798 (The shell library, which contains the routines) SB
gr
gs 1355 2025 735 1002 CB
1203 2765 559 (that manage the frame window.) SB
gr
4 189 735 2837 B
1 F
n
4 189 1185 2837 B
1 F
n
454 4 735 3022 B
1 F
n
gs 1355 2025 735 1002 CB
753 2852 218 (   VER.DLL) SB
gr
4 189 2085 2837 B
1 F
n
904 4 1185 3022 B
1 F
n
gs 1355 2025 735 1002 CB
1203 2852 835 (The version checking .DLL file that is required) SB
gr
gs 1355 2025 735 1002 CB
1203 2900 845 (if the user can install the product on a Windows) SB
gr
gs 1355 2025 735 1002 CB
1203 2948 340 (version 3.0 system.) SB
gr
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%Page: 3 3
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
302 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
1165 871 129 (Chapter) SB
gr
gs 2454 3278 0 413 CB
1305 871 19 (3) SB
gr
gs 2454 3278 0 413 CB
1492 871 139 (Creating) SB
gr
gs 2454 3278 0 413 CB
1642 871 19 (a) SB
gr
gs 2454 3278 0 413 CB
1672 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1778 871 97 (Script) SB
gr
gs 2454 3278 0 413 CB
2043 871 38 (21) SB
gr
4 511 652 1002 B
1 F
n
454 4 652 1002 B
1 F
n
4 511 1102 1002 B
1 F
n
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
gs 1355 2137 652 1002 CB
670 1019 340 (Setup include files:) SB
gr
904 4 1102 1002 B
1 F
n
4 511 2002 1002 B
1 F
n
gs 1355 2137 652 1002 CB
1120 1019 827 (The .INC files define variables and declare the) SB
gr
gs 1355 2137 652 1002 CB
1120 1067 779 (subroutines and functions that you call from) SB
gr
gs 1355 2137 652 1002 CB
1120 1115 864 (your script. You include these files in your script) SB
gr
gs 1355 2137 652 1002 CB
1120 1163 867 (\(.MST\) file as necessary. Any files that you have) SB
gr
gs 1355 2137 652 1002 CB
1120 1211 836 (listed in the .MST file must also be included on) SB
gr
gs 1355 2137 652 1002 CB
1120 1259 437 (the first installation disk.) SB
gr
gs 1355 2137 652 1002 CB
1120 1307 858 (Note: If you include both MSSHARED.INC and) SB
gr
gs 1355 2137 652 1002 CB
1120 1355 653 (MSREGDB.INC, you must place the) SB
gr
gs 1355 2137 652 1002 CB
1120 1403 777 ('$INCLUDE statement for MSREGDB.INC) SB
gr
gs 1355 2137 652 1002 CB
1120 1451 770 (before the statement for MSSHARED.INC.) SB
gr
4 268 652 1514 B
1 F
n
4 268 1102 1514 B
1 F
n
gs 1355 2137 652 1002 CB
670 1529 325 (   SETUPAPI.INC) SB
gr
gs 1355 2137 652 1002 CB
670 1577 211 (   \(required\)) SB
gr
4 268 2002 1514 B
1 F
n
gs 1355 2137 652 1002 CB
1120 1529 815 (The common API include file, which contains) SB
gr
gs 1355 2137 652 1002 CB
1120 1577 744 (definitions of constants used by Setup and) SB
gr
gs 1355 2137 652 1002 CB
1120 1624 840 (declarations for the most commonly used Setup) SB
gr
gs 1355 2137 652 1002 CB
1120 1672 833 (procedures. You must include SETUPAPI.INC) SB
gr
gs 1355 2137 652 1002 CB
1120 1720 813 (in your script and on the first installation disk.) SB
gr
4 460 652 1783 B
1 F
n
4 460 1102 1783 B
1 F
n
gs 1355 2137 652 1002 CB
670 1798 352 (   MSDETECT.INC) SB
gr
gs 1355 2137 652 1002 CB
670 1846 207 (   \(optional\)) SB
gr
4 460 2002 1783 B
1 F
n
gs 1355 2137 652 1002 CB
1120 1798 823 (The detection API include file, which contains) SB
gr
gs 1355 2137 652 1002 CB
1120 1846 850 (declarations of functions that return information) SB
gr
gs 1355 2137 652 1002 CB
1120 1894 816 (about the user's system, such as the number of) SB
gr
gs 1355 2137 652 1002 CB
1120 1942 856 (disk drives and so on. The more commonly used) SB
gr
gs 1355 2137 652 1002 CB
1120 1990 812 (detection routines, such as the ones that query) SB
gr
gs 1355 2137 652 1002 CB
1120 2038 722 (for the Windows version, are declared in) SB
gr
gs 1355 2137 652 1002 CB
1120 2086 822 (SETUPAPI.INC. Include MSDETECT.INC in) SB
gr
gs 1355 2137 652 1002 CB
1120 2134 729 (your script if you intend to use any of the) SB
gr
gs 1355 2137 652 1002 CB
1120 2182 367 (functions it declares.) SB
gr
4 319 652 2244 B
1 F
n
4 319 1102 2244 B
1 F
n
454 3 652 2560 B
1 F
n
gs 1355 2137 652 1002 CB
670 2259 332 (   MSREGDB.INC) SB
gr
gs 1355 2137 652 1002 CB
670 2307 207 (   \(optional\)) SB
gr
4 319 2002 2244 B
1 F
n
904 3 1102 2560 B
1 F
n
gs 1355 2137 652 1002 CB
1120 2259 773 (The Registration Database API include file,) SB
gr
gs 1355 2137 652 1002 CB
1120 2307 730 (which contains declarations for the Setup) SB
gr
gs 1355 2137 652 1002 CB
1120 2355 647 (procedures that read and write to the) SB
gr
gs 1355 2137 652 1002 CB
1120 2403 854 (Registration Database. Include MSREGDB.INC) SB
gr
gs 1355 2137 652 1002 CB
1120 2451 774 (in your script if you intend to use any of the) SB
gr
gs 1355 2137 652 1002 CB
1120 2499 367 (functions it declares.) SB
gr
4 273 652 2560 B
1 F
n
4 273 1102 2560 B
1 F
n
454 4 652 2829 B
1 F
n
gs 1355 2137 652 1002 CB
670 2577 359 (   MSSHARED.INC) SB
gr
gs 1355 2137 652 1002 CB
670 2625 207 (   \(optional\)) SB
gr
4 273 2002 2560 B
1 F
n
904 4 1102 2829 B
1 F
n
gs 1355 2137 652 1002 CB
1120 2577 864 (The shared files API include file, which contains) SB
gr
gs 1355 2137 652 1002 CB
1120 2625 855 (declarations for procedures that install or update) SB
gr
gs 1355 2137 652 1002 CB
1120 2673 832 (shared files. Include MSSHARED.INC in your) SB
gr
gs 1355 2137 652 1002 CB
1120 2721 847 (script if you intend to use any of the functions it) SB
gr
gs 1355 2137 652 1002 CB
1120 2769 157 (declares.) SB
gr
4 309 652 2829 B
1 F
n
4 309 1102 2829 B
1 F
n
454 4 652 3134 B
1 F
n
gs 1355 2137 652 1002 CB
670 2847 340 (Sample script files:) SB
gr
4 309 2002 2829 B
1 F
n
904 4 1102 3134 B
1 F
n
gs 1355 2137 652 1002 CB
1120 2847 856 (The script \(.MST\) files contain sample code that) SB
gr
gs 1355 2137 652 1002 CB
1120 2892 826 (you can modify to create your own script. You) SB
gr
gs 1355 2137 652 1002 CB
1120 2938 742 (must list both your .MST and .INF files in) SB
gr
gs 1355 2137 652 1002 CB
1120 2984 842 (SETUP.LST, and you must include them on the) SB
gr
gs 1355 2137 652 1002 CB
1120 3030 372 (first installation disk.) SB
gr
gs 1355 2137 652 1002 CB
1120 3076 386 (\(continued next page\)) SB
gr
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%Page: 4 4
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
377 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
377 871 38 (22) SB
gr
gs 2454 3278 0 413 CB
583 871 154 (Microsoft) SB
gr
gs 2454 3278 0 413 CB
748 871 152 (Windows) SB
gr
gs 2454 3278 0 413 CB
911 871 126 (Version) SB
gr
gs 2454 3278 0 413 CB
1048 871 48 (3.1) SB
gr
gs 2454 3278 0 413 CB
1107 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1213 871 113 (Toolkit) SB
gr
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
727 2986 537 (Table 3.1 Setup Toolkit Files) SB
4 407 727 1002 B
1 F
n
454 4 727 1002 B
1 F
n
4 407 1177 1002 B
1 F
n
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
gs 1355 1935 727 1002 CB
745 1020 340 (Sample script files:) SB
gr
gs 1355 1935 727 1002 CB
745 1065 204 (\(continued\)) SB
gr
904 4 1177 1002 B
1 F
n
4 407 2077 1002 B
1 F
n
gs 1355 1935 727 1002 CB
1195 1020 837 (To create your script, choose the .MST file that) SB
gr
gs 1355 1935 727 1002 CB
1195 1065 782 (most closely resembles your installation and) SB
gr
gs 1355 1935 727 1002 CB
1195 1111 835 (modify it. Or, combine sample code from more) SB
gr
gs 1355 1935 727 1002 CB
1195 1157 822 (than one file. The corresponding .INF files are) SB
gr
gs 1355 1935 727 1002 CB
1195 1203 769 (provided for information only; use the Disk) SB
gr
gs 1355 1935 727 1002 CB
1195 1249 823 (Layout Utilities to create the .INF file for your) SB
gr
gs 1355 1935 727 1002 CB
1195 1295 787 (installation script. For more information, see) SB
gr
gs 1355 1935 727 1002 CB
1195 1340 794 (Chapter 4, "Using the Disk Layout Utilities.") SB
gr
4 212 727 1410 B
1 F
n
4 212 1177 1410 B
1 F
n
gs 1355 1935 727 1002 CB
745 1425 340 (    SAMPLE1.MST) SB
gr
4 212 2077 1410 B
1 F
n
gs 1355 1935 727 1002 CB
1195 1425 617 (The sample script file for a simple,) SB
gr
gs 1355 1935 727 1002 CB
1195 1470 812 (straightforward installation. This file provides) SB
gr
gs 1355 1935 727 1002 CB
1195 1516 838 (sample Microsoft Test debug code and asks the) SB
gr
gs 1355 1935 727 1002 CB
1195 1562 762 (user to choose which files will be installed.) SB
gr
4 350 727 1623 B
1 F
n
4 350 1177 1623 B
1 F
n
gs 1355 1935 727 1002 CB
745 1638 340 (    SAMPLE2.MST) SB
gr
4 350 2077 1623 B
1 F
n
gs 1355 1935 727 1002 CB
1195 1638 851 (The sample script file for a moderately complex) SB
gr
gs 1355 1935 727 1002 CB
1195 1684 869 (installation. The file asks the user to choose from) SB
gr
gs 1355 1935 727 1002 CB
1195 1730 823 (two sets of optional files for the installation, to) SB
gr
gs 1355 1935 727 1002 CB
1195 1775 837 (enter the name of the installation directory, and) SB
gr
gs 1355 1935 727 1002 CB
1195 1821 828 (so on. The script also checks the available disk) SB
gr
gs 1355 1935 727 1002 CB
1195 1867 805 (space on the user's hard disk for installing the) SB
gr
gs 1355 1935 727 1002 CB
1195 1913 87 (files.) SB
gr
4 397 727 1974 B
1 F
n
4 397 1177 1974 B
1 F
n
454 3 727 2368 B
1 F
n
gs 1355 1935 727 1002 CB
745 1989 340 (    SAMPLE3.MST) SB
gr
4 397 2077 1974 B
1 F
n
904 3 1177 2368 B
1 F
n
gs 1355 1935 727 1002 CB
1195 1989 749 (The same script file for an installation that) SB
gr
gs 1355 1935 727 1002 CB
1195 2035 844 (contains shared files. The script checks to see if) SB
gr
gs 1355 1935 727 1002 CB
1195 2080 865 (the shared file is a newer version than the one on) SB
gr
gs 1355 1935 727 1002 CB
1195 2126 830 (the user's system and then adds it, if necessary,) SB
gr
gs 1355 1935 727 1002 CB
1195 2172 809 (to the global copy list. The script also updates) SB
gr
gs 1355 1935 727 1002 CB
1195 2218 858 (the Registration Database. For more information) SB
gr
gs 1355 1935 727 1002 CB
1195 2264 864 (about shared files, see "Installing Shared Files or) SB
gr
gs 1355 1935 727 1002 CB
1195 2310 588 (System File," later in this chapter) SB
gr
4 308 727 2368 B
1 F
n
4 308 1177 2368 B
1 F
n
454 3 727 2673 B
1 F
n
gs 1355 1935 727 1002 CB
745 2385 321 (TESTDRVR.HLP) SB
gr
4 308 2077 2368 B
1 F
n
904 3 1177 2673 B
1 F
n
gs 1355 1935 727 1002 CB
1195 2385 725 (A Windows online help file that contains) SB
gr
gs 1355 1935 727 1002 CB
1195 2431 869 (information about Microsoft Test. Use this file to) SB
gr
gs 1355 1935 727 1002 CB
1195 2477 819 (understand the function of the Test commands) SB
gr
gs 1355 1935 727 1002 CB
1195 2523 835 (that are included in the sample script files. You) SB
gr
gs 1355 1935 727 1002 CB
1195 2569 822 (should not include this file on your installation) SB
gr
gs 1355 1935 727 1002 CB
1195 2615 101 (disks.) SB
gr
4 263 727 2673 B
1 F
n
4 263 1177 2673 B
1 F
n
454 4 727 2932 B
1 F
n
gs 1355 1935 727 1002 CB
745 2690 283 (README.TXT) SB
gr
4 263 2077 2673 B
1 F
n
904 4 1177 2932 B
1 F
n
gs 1355 1935 727 1002 CB
1195 2690 853 (A text file that contains information about Setup) SB
gr
gs 1355 1935 727 1002 CB
1195 2736 816 (that could not be included in this manual. You) SB
gr
gs 1355 1935 727 1002 CB
1195 2782 681 (should read this file before creating an) SB
gr
gs 1355 1935 727 1002 CB
1195 2828 859 (installation script. Do not inlude this file on your) SB
gr
gs 1355 1935 727 1002 CB
1195 2874 307 (installation disks.) SB
gr
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 5 5
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
302 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
1165 871 129 (Chapter) SB
gr
gs 2454 3278 0 413 CB
1305 871 19 (3) SB
gr
gs 2454 3278 0 413 CB
1492 871 139 (Creating) SB
gr
gs 2454 3278 0 413 CB
1642 871 19 (a) SB
gr
gs 2454 3278 0 413 CB
1672 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1778 871 97 (Script) SB
gr
gs 2454 3278 0 413 CB
2043 871 38 (23) SB
gr
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 995 1351 (To run the sample files and see them from the user\222s perspective, choose the) SB
652 1043 1385 (Run command from the File menu. Type the name of the Microsoft Test inter-) SB
652 1091 1327 (preter and the sample filename in the command line, and click OK. For ex-) SB
652 1139 1054 (ample, the command line to run SAMPLE1.MST would be:) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
652 1238 461 (_mstest.exe sample1.mst) SB
652 1341 104 (Note:) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
756 1344 1302 ( Make sure that you have VER.DLL in your path. If not, you may want to) SB
652 1392 1358 (put a copy of it in the Setup toolkit directory. If you allow your product to be) SB
652 1440 1206 (run under Windows version 3.0, you must also include VER.DLL in) SB
652 1487 801 (SETUP.LST and on the first installation disk.) SB
652 1590 1420 (The rest of this chapter explains the process of creating an installation script and) SB
652 1638 1214 (defining which files you need to include on the first installation disk.) SB
32 0 0 72 75 0 0 70 /Helvetica-Narrow-Bold /font26 ANSIFont font
302 1804 1261 (Choosing and Modifying a Sample Script File) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 1951 1391 (Up to this point, you have defined the list of files you will be installing and de-) SB
652 1999 1375 (signed the dialog boxes you will need. Your focus has been on identifying the) SB
652 2047 1421 (choices you will ask the user to make\226for example, to determine the directory in) SB
652 2095 631 (which you will install your product.) SB
652 2198 1389 (To create a script file, your focus must now shift slightly. When you create the) SB
652 2245 1374 (code that handles the dialog boxes and installs the product files, you must pay) SB
652 2293 1413 (attention to designing a safe and efficient installation process. Therefore, before) SB
652 2341 1417 (you start modifying one of the Setup sample script files, answer these questions:) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2459 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
-1 14 SJ
702 2444 1364 (How much disk space will the installation use? Is it a significant amount? If so,) SB
702 2492 1328 (you will need to ensure that the user\222s hard disk has enough disk space avail-) SB
702 2540 1350 (able. Also, if your product includes optional files that the user has chosen, you) SB
702 2588 1334 (may want to inform the user how much disk space each optional file will use.) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2705 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 2690 1306 (Does your product have minimum hardware and system software require-) SB
702 2738 1366 (ments? If so, you may want to check the version of MS-DOS or Windows, or) SB
702 2786 1371 (check for the existence of, for example, a math coprocessor. If the user\222s sys-) SB
702 2834 1265 (tem falls below your minimum requirements, you will want to display a) SB
702 2882 317 (warning message.) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2999 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 2984 1375 (Will you be installing shareable files? For example, does your product require a) SB
-1 11 SJ
702 3032 1345 (spelling dictionary that the user already may have installed with another prod-) SB
702 3080 1151 (uct? If so, you will need to take some special steps to handle these ) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1853 3080 87 (files.) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%+ font Times-Bold
%%+ font ZapfDingbats
%%Page: 6 6
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
377 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
377 871 38 (24) SB
gr
gs 2454 3278 0 413 CB
583 871 154 (Microsoft) SB
gr
gs 2454 3278 0 413 CB
748 871 152 (Windows) SB
gr
gs 2454 3278 0 413 CB
911 871 126 (Version) SB
gr
gs 2454 3278 0 413 CB
1048 871 48 (3.1) SB
gr
gs 2454 3278 0 413 CB
1107 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1213 871 113 (Toolkit) SB
gr
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 1010 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 995 1307 (Will you be installing any system files? If so, you may need to use special) SB
777 1043 1343 (Setup functions to exit Windows and update files that would be in use while) SB
777 1091 368 (Windows is running.) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 1208 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 1193 1336 (Will your installation need to update WIN.INI or AUTOEXEC.BAT? If so,) SB
777 1241 1355 (you will want to let the user decide whether to have these files updated auto-) SB
777 1289 175 (matically.) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 1407 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 1392 1325 (What other parts of your installation have associated risks? Do you need to) SB
777 1440 1346 (post warnings of any kind for the user? Do you need to check the validity of) SB
777 1487 638 (paths and filenames the user enters?) SB
727 1590 1385 (The answers to these questions provide the information you need to design the) SB
727 1638 1349 (code for your script file. You should design the installation script just as you) SB
727 1686 1358 (would any other program: Identify the types of routines you will need, deter-) SB
727 1734 1352 (mine the logical order in which those routines should occur, and then draw a) SB
727 1782 1361 (flowchart of the installation process. The answers to the above questions will) SB
727 1830 997 (also help you choose which sample script file to modify.) SB
32 0 0 72 75 0 0 70 /Helvetica-Narrow-Bold /font26 ANSIFont font
377 1995 1302 (The Basic Components of a Sample Script File) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 2143 1383 (Each sample file contains several basic components that, once understood, are) SB
727 2191 1384 (easy to modify to match your installation\222s needs. This section describes those) SB
727 2239 1089 (components, using SAMPLE1.MST for the code illustrations.) SB
727 2341 1348 (To execute a sample file, choose the Run command from the File menu, and) SB
727 2389 76 (type) SB
727 2492 11 ( ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
738 2489 342 (_mtest.exe sample) SB
32 0 0 44 44 0 0 39 /Times-BoldItalic /font40 ANSIFont font
1080 2492 24 (n) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
1104 2489 80 (.mst) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 2594 120 (where ) SB
32 0 0 44 44 0 0 41 /Times-Italic /font41 ANSIFont font
847 2592 22 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
869 2594 1282 ( is the number of the sample file. \(You may have to copy VER.DLL into) SB
727 2642 1180 (the Setup toolkit directory for the sample files to run successfully.\)) SB
32 0 0 51 54 0 0 51 /Helvetica-Narrow-Bold /font26 ANSIFont font
727 2797 248 (Debug Code) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 2865 1392 (At the beginning of each sample, you can define a DEBUG flag that Microsoft) SB
727 2913 1358 (Test recognizes. You can then use the DEBUG flag to include debug code in) SB
727 2960 1362 (your script for testing purposes. SAMPLE1.MST defines the DEBUG flag as) SB
727 3008 144 (follows:) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font ZapfDingbats
%%+ font Times-Roman
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Italic
%%Page: 7 7
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
302 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
1165 871 129 (Chapter) SB
gr
gs 2454 3278 0 413 CB
1305 871 19 (3) SB
gr
gs 2454 3278 0 413 CB
1492 871 139 (Creating) SB
gr
gs 2454 3278 0 413 CB
1642 871 19 (a) SB
gr
gs 2454 3278 0 413 CB
1672 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1778 871 97 (Script) SB
gr
gs 2454 3278 0 413 CB
2043 871 38 (25) SB
gr
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
827 1002 350 (\221$DEFINE DEBUG) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 1070 814 (The following code appears later in the script:) SB
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
827 1204 325 (\221$IFDEF DEBUG) SB
827 1254 25 (.) SB
827 1304 25 (.) SB
827 1354 25 (.) SB
827 1404 350 (\222$ENDIF \221DEBUG) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 1472 1377 (These are Microsoft Test metacommands. You do not have to include them in) SB
652 1520 1407 (your script, but they can be very useful. For more information about these com-) SB
652 1568 1398 (mands and their uses, refer to the Windows online help file, TESTDRVR.HLP,) SB
652 1616 591 (that comes with the Setup toolkit.) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
652 1716 104 (Note:) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
756 1719 435 ( You should remove the ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
1191 1716 367 ('$DEFINE DEBUG) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1558 1719 517 ( line from your script \(.MST\)) SB
652 1767 594 (file before you ship your product.) SB
32 0 0 51 54 0 0 51 /Helvetica-Narrow-Bold /font26 ANSIFont font
652 1921 256 (Include Files) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 1989 1172 (The appropriate .INC files are listed at the top of each sample file.) SB
652 2037 1396 (SAMPLE1.MST uses the following commands to include SETUPAPI.INC and) SB
652 2085 331 (MSDETECT.INC:) SB
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
827 2220 600 (\221$INCLUDE \221setupapi.inc\222) SB
827 2270 600 (\222$INCLUDE \221msdetect.inc\222) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 2338 1352 (These are Microsoft Test commands. Edit these lines to include the files that) SB
652 2385 1402 (your installation will need, based on the types of Setup procedures that you call) SB
652 2433 246 (in your script.) SB
652 2536 1378 (For a description of each .INC file, see Table 3.1. For more information about) SB
652 2584 1203 (the syntax of Test commands, refer to the Windows online help file,) SB
652 2632 852 (TESTDRVR.HLP, included in the Setup toolkit.) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
652 2731 104 (Note:) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
756 2734 452 ( If you have included the ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
1208 2731 378 ('$DEFINE DEBUG ) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1586 2734 458 (line in your script file, the) SB
652 2782 857 (.INC files will have argument checking enabled.) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Courier
%%+ font Times-Roman
%%+ font Times-Bold
%%Page: 8 8
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
377 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
377 871 38 (26) SB
gr
gs 2454 3278 0 413 CB
583 871 154 (Microsoft) SB
gr
gs 2454 3278 0 413 CB
748 871 152 (Windows) SB
gr
gs 2454 3278 0 413 CB
911 871 126 (Version) SB
gr
gs 2454 3278 0 413 CB
1048 871 48 (3.1) SB
gr
gs 2454 3278 0 413 CB
1107 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1213 871 113 (Toolkit) SB
gr
32 0 0 51 54 0 0 51 /Helvetica-Narrow-Bold /font26 ANSIFont font
727 993 437 (Dialog Box Constants) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 1061 1423 (Each sample file declares constants for the dialog boxes it will use. The code for) SB
727 1109 565 (SAMPLE1.MST looks like this:) SB
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
902 1243 325 (CONST WELCOME) SB
1427 1243 125 (= 100) SB
902 1293 325 (CONST ASKQUIT) SB
1427 1293 125 (= 200) SB
902 1343 350 (CONST DESTPATH) SB
1427 1343 125 (= 300) SB
902 1393 425 (CONST EXITFAILURE) SB
1427 1393 125 (= 400) SB
902 1443 350 (CONST EXITQUIT) SB
1427 1443 125 (= 600) SB
902 1493 425 (CONST EXITSUCCESS) SB
1427 1493 125 (= 700) SB
902 1543 325 (CONST OPTIONS) SB
1427 1543 125 (= 800) SB
902 1593 325 (CONST APPHELP) SB
1427 1593 125 (= 900) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 1661 1340 (These constants represent the resource identification numbers for the dialog) SB
727 1709 1369 (boxes you will use in your installation. Edit this list to match the dialog boxes) SB
727 1757 848 (you designed using the Windows Dialog Editor.) SB
32 0 0 51 54 0 0 51 /Helvetica-Narrow-Bold /font26 ANSIFont font
727 1912 245 (Initialization) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 1980 1364 (The initialization section of each sample sets the background bitmap and title) SB
727 2027 1392 (for the Setup frame \(or main\) window. It also initializes variables, retrieves in-) SB
727 2075 1424 (formation from the Symbol Table, and reads the .INF file. Edit this section to in-) SB
727 2123 355 (clude the following:) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 2241 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 2226 1314 (The name of the bitmap logo file to appear in the background of the frame) SB
777 2274 142 (window) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 2391 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 2376 701 (The title to appear in the frame window) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 2494 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 2479 1363 (The name of the .DLL file that contains the procedures for your dialog boxes) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 2596 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 2581 641 (The path and name of your .INF file) SB
32 0 0 51 54 0 0 51 /Helvetica-Narrow-Bold /font26 ANSIFont font
727 2736 39 (W) SB
765 2736 633 (elcome and Other Dialog Boxes) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 2804 1401 (The next sections of the sample files provide code that display the dialog boxes) SB
727 2852 1171 (that ask the user to make choices for the installation. For example,) SB
727 2900 1364 (SAMPLE1.MST uses the following code to display the Welcome dialog box:) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%+ font Courier
%%+ font ZapfDingbats
%%Page: 9 9
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
302 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
1165 871 129 (Chapter) SB
gr
gs 2454 3278 0 413 CB
1305 871 19 (3) SB
gr
gs 2454 3278 0 413 CB
1492 871 139 (Creating) SB
gr
gs 2454 3278 0 413 CB
1642 871 19 (a) SB
gr
gs 2454 3278 0 413 CB
1672 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1778 871 97 (Script) SB
gr
gs 2454 3278 0 413 CB
2043 871 38 (27) SB
gr
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
827 1002 200 (WELCOME:) SB
827 1052 1250 (  sz$ = UIStartDlg\(CUIDLL$,WELCOME,\223FInfoDlgProc\224,) SB
902 1102 475 (APPHELP, HELPPROC$\)) SB
827 1152 650 (  IF sz$ = \223CONTINUE\224 THEN) SB
902 1202 225 (  UIPop 1) SB
827 1252 150 (  ELSE) SB
902 1302 375 (  GOSUB ASKQUIT) SB
902 1352 350 (  GOTO WELCOME) SB
827 1402 175 (  ENDIF) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 1470 1404 (Edit these sections of the script as necessary to include the code for your dialog) SB
652 1518 114 (boxes.) SB
32 0 0 51 54 0 0 51 /Helvetica-Narrow-Bold /font26 ANSIFont font
652 1673 357 (Install Subroutine) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 1740 517 (SAMPLE1.MST declares an ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
1169 1737 119 (Install) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1288 1740 766 ( subroutine at the beginning of the file. The) SB
652 1788 1378 (purpose of this routine is to build the global copy list and perform the installa-) SB
652 1836 269 (tion tasks. The ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
921 1833 119 (Install) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1040 1836 985 ( subroutine for SAMPLE1.MST performs the following) SB
652 1884 100 (tasks:) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2002 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 1987 760 (Opens and writes to the installation log file) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2104 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 2089 1299 (Builds the global copy list based on the files listed in the .INF file and the) SB
702 2137 460 (choices the user has made) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2255 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 2240 690 (Installs the files on the user\222s hard disk) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2357 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 2342 318 (Updates WIN.INI) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2460 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 2445 1048 (Creates a Program Manager group and item for the product) SB
652 2547 1225 (Edit this routine to include the code necessary to install your product.) SB
652 2595 1358 (SAMPLE2.MST and SAMPLE3.MST handle these tasks differently because) SB
652 2643 1409 (they represent more sophisticated installations. Depending on the complexity of) SB
652 2691 374 (your installation, the ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
1026 2688 119 (Install) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1145 2691 823 ( subroutine can be the bulk of your installation) SB
652 2739 1327 (script. Therefore, you may want to break this subroutine into smaller, more) SB
652 2787 1403 (manageable chunks. For an example of a more complicated installation, see the) SB
652 2835 612 (Install section of SAMPLE2.MST.) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Courier
%%+ font Times-Roman
%%+ font Times-Bold
%%+ font ZapfDingbats
%%Page: 10 10
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
377 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
377 871 38 (28) SB
gr
gs 2454 3278 0 413 CB
583 871 154 (Microsoft) SB
gr
gs 2454 3278 0 413 CB
748 871 152 (Windows) SB
gr
gs 2454 3278 0 413 CB
911 871 126 (Version) SB
gr
gs 2454 3278 0 413 CB
1048 871 48 (3.1) SB
gr
gs 2454 3278 0 413 CB
1107 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1213 871 113 (Toolkit) SB
gr
32 0 0 72 75 0 0 70 /Helvetica-Narrow-Bold /font26 ANSIFont font
377 992 490 (Modifying SETUP) SB
858 992 402 (.LST to Match ) SB
1259 992 39 (Y) SB
1293 992 395 (our Script File) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 1140 1316 (When you have modified a sample script file, you must create a version of) SB
727 1187 1381 (SETUP.LST that matches your script. SETUP.LST must contain two sections:) SB
727 1235 938 (Params and Files. The Params section looks like this:) SB
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
902 1370 200 ([Params]) SB
902 1420 750 (  WndTitle   = Microsoft Setup) SB
902 1470 900 (  WndMess    = Initializing Setup...) SB
902 1520 450 (  TmpDirSize = 500) SB
902 1570 625 (  TmpDirName = ms-setup.t) SB
902 1620 1200 (  CmdLine    = _mstest sample1.mst /C "/S %s %s") SB
902 1670 525 (  DrvModName = DSHELL) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
727 1735 1203 (To edit the Params section of SETUP.LST to match your script:) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 1840 33 (1.) SB
777 1840 583 (If you want, change the value of ) SB
32 0 0 44 44 0 0 41 /Times-Italic /font41 ANSIFont font
1360 1838 161 (WndTitle) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1521 1840 11 (.) SB
777 1968 1286 (This text displays in the title bar of the Setup initialization window while) SB
777 2016 1321 (SETUP.EXE is copying the files into the temporary directory on the user\222s) SB
777 2064 174 (hard disk.) SB
727 2166 33 (2.) SB
777 2166 583 (If you want, change the value of ) SB
32 0 0 44 44 0 0 41 /Times-Italic /font41 ANSIFont font
1360 2164 172 (WndMess) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1532 2166 11 (.) SB
777 2294 1336 (This message displays in the center of the client area of the Setup initializa-) SB
777 2342 232 (tion window.) SB
727 2444 33 (3.) SB
777 2444 287 (Set the value of ) SB
32 0 0 44 44 0 0 41 /Times-Italic /font41 ANSIFont font
1064 2442 210 (TmpDirSize) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1274 2444 842 ( to an amount \(in kilobytes\) that will accommo-) SB
777 2492 1111 (date the files SETUP.EXE copies into the temporary directory.) SB
777 2620 1359 (You can calculate this value by adding the sizes of the files listed in the Files) SB
777 2668 1270 (section of SETUP.LST, dividing the result by 1024, and rounding it to a) SB
777 2715 265 (whole number.) SB
727 2818 33 (4.) SB
777 2818 583 (If you want, change the value of ) SB
32 0 0 44 44 0 0 41 /Times-Italic /font41 ANSIFont font
1360 2816 242 (TmpDirName) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1602 2818 502 ( to the desired temporary di-) SB
777 2866 244 (rectory name.) SB
777 2993 1310 (The name you choose must accept one character and still be a valid name.) SB
727 3096 33 (5.) SB
777 3096 304 (Edit the value of ) SB
32 0 0 44 44 0 0 41 /Times-Italic /font41 ANSIFont font
1081 3094 161 (CmdLine) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1242 3096 830 ( to include the name of your script \(.MST\) file.) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%+ font Courier
%%+ font Times-Bold
%%+ font Times-Italic
%%Page: 11 11
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
302 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
1165 871 129 (Chapter) SB
gr
gs 2454 3278 0 413 CB
1305 871 19 (3) SB
gr
gs 2454 3278 0 413 CB
1492 871 139 (Creating) SB
gr
gs 2454 3278 0 413 CB
1642 871 19 (a) SB
gr
gs 2454 3278 0 413 CB
1672 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1778 871 97 (Script) SB
gr
gs 2454 3278 0 413 CB
2043 871 38 (29) SB
gr
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
702 992 89 (Note) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
791 995 880 (: Do not change the last line that sets the value of ) SB
32 0 0 44 44 0 0 41 /Times-Italic /font41 ANSIFont font
1671 993 253 (DrvModName) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1924 995 11 (.) SB
652 1097 1355 (The Files section of SETUP.LST contains a list of the files that SETUP.EXE) SB
652 1145 1386 (should copy into the temporary directory. At a minimum, this list must include) SB
652 1193 335 (the following files:) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 1311 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 1296 412 (Your script \(.MST\) file) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 1413 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 1398 254 (Your .INF file) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 1516 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 1501 292 (SETUPAPI.INC) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 1618 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 1603 750 (All .DLL files including MSCUISTF.DLL) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 1721 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 1706 287 (_MSTEST.EXE) SB
652 1808 441 (The list can also include:) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 1926 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 1911 1011 (Any additional .INC files that you included in your script) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2028 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 2013 1351 (Any additional custom .DLL files that include procedures you called in your) SB
702 2061 98 (script) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
652 2179 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
702 2164 1334 (_MSSETUP.EXE, the MS-DOS program that you can use to update system) SB
702 2212 76 (files) SB
652 2314 852 (The Files section of SETUP.LST looks like this:) SB
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
827 2449 175 ([Files]) SB
827 2499 700 (  sample1.mst  = sample1.mst) SB
827 2549 700 (  sample1.inf  = sample1.inf) SB
827 2599 725 (  setupapi.inc = setupapi.inc) SB
827 2649 725 (  msdetect.inc = msdetect.inc) SB
827 2699 725 (  mscomstf.dll = mscomstf.dll) SB
827 2749 725 (  msinsstf.dll = msinsstf.dll) SB
827 2799 725 (  msuilstf.dll = msuilstf.dll) SB
827 2849 725 (  msshlstf.dll = msshlstf.dll) SB
827 2899 725 (  mscuistf.dll = mscuistf.dll) SB
827 2949 725 (  msdetstf.dll = msdetstf.dll) SB
827 2999 700 (  _mstest.exe  = _mstest.exe) SB
827 3049 725 (  _mssetup.exe = _mssetup.exe) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%+ font Times-Italic
%%+ font ZapfDingbats
%%+ font Courier
%%Page: 12 12
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
377 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
377 871 38 (30) SB
gr
gs 2454 3278 0 413 CB
583 871 154 (Microsoft) SB
gr
gs 2454 3278 0 413 CB
748 871 152 (Windows) SB
gr
gs 2454 3278 0 413 CB
911 871 126 (Version) SB
gr
gs 2454 3278 0 413 CB
1048 871 48 (3.1) SB
gr
gs 2454 3278 0 413 CB
1107 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1213 871 113 (Toolkit) SB
gr
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 995 1349 (The filenames on the left side of the equal sign \(=\) are the names of the files) SB
727 1043 1371 (that appear on the first installation disk. The filenames on the right side of the) SB
727 1091 1375 (equal sign are the names to which the files will be copied in the temporary di-) SB
727 1139 1401 (rectory on the user\222s hard disk. \(Typically, the filenames will differ if you have) SB
727 1187 1378 (compressed the files for distribution. Compression is recommended for all but) SB
727 1235 566 (SETUP.EXE and SETUP.LST.\)) SB
727 1337 1355 (Edit the filenames \(potentially, on both sides\) to match the files you need for) SB
727 1385 1398 (your installation. For more information about each of the Setup .DLL and .INC) SB
727 1433 344 (files, see Table 3.1.) SB
32 0 0 72 75 0 0 70 /Helvetica-Narrow-Bold /font26 ANSIFont font
377 1599 549 (Using the Symbol T) SB
921 1599 118 (able) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 1746 1406 (Whether your installation is simple or complex, you will probably use the Sym-) SB
727 1794 1318 (bol Table to store values. The Symbol Table is a temporary storage area in) SB
727 1842 1364 (memory that contains a table of text symbols and their associated text values.) SB
727 1890 1382 (Setup uses the Symbol Table to store information such as directory names and) SB
727 1938 999 (data that is passed between the script and the .DLL files.) SB
727 2040 1204 (Setup automatically creates and sets three symbols that you can use:) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 2158 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 2143 788 (STF_SRCDIR, which is the source directory) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 2260 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 2245 1343 (STF_CWDDIR, which is the current working directory or the temporary di-) SB
777 2293 300 (rectory for Setup) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 2411 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 2396 1333 (STF_SRCINFPATH, which is the path for the .INF file \(usually empty, un-) SB
777 2444 1296 (less you or the user supplied it as part of the SETUP.EXE command line\)) SB
727 2546 1200 (For example, before reading the .INF file, SAMPLE1.MST uses the) SB
727 2594 1275 (STF_CWDDIR symbol to create the path and filename for the .INF file:) SB
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
902 2729 975 (szInf$ = GetSymbolValue\(\223STF_CWDDIR\224\) +) SB
902 2779 325 (\223SAMPLE1.INF\224) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 2847 1382 (The procedures in MSCUISTF.DLL \(the customized dialog box routines\) also) SB
727 2895 1145 (use the Symbol Table to store the user\222s responses. For example,) SB
727 2943 1409 (SAMPLE1.MST uses the following line of code to retrieve the value of the but-) SB
727 2990 604 (ton the user chose in a dialog box:) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%+ font ZapfDingbats
%%+ font Courier
%%Page: 13 13
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
302 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
1165 871 129 (Chapter) SB
gr
gs 2454 3278 0 413 CB
1305 871 19 (3) SB
gr
gs 2454 3278 0 413 CB
1492 871 139 (Creating) SB
gr
gs 2454 3278 0 413 CB
1642 871 19 (a) SB
gr
gs 2454 3278 0 413 CB
1672 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1778 871 97 (Script) SB
gr
gs 2454 3278 0 413 CB
2043 871 38 (31) SB
gr
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
827 1002 1025 (OPTCUR$ = GetSymbolValue\(\223ButtonChecked\224\)) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 1070 1374 (You\222ll see other uses of the Symbol Table interspersed throughout the sample) SB
652 1118 1422 (code. Use the Symbol Table to pass data between your script and the .DLL files.) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
652 1217 104 (Note:) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
756 1220 1288 ( To conserve memory, clear all Symbol Table strings after you use them.) SB
32 0 0 72 75 0 0 70 /Helvetica-Narrow-Bold /font26 ANSIFont font
302 1386 888 (Creating Customized .DLL Files) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 1534 1341 (Depending on the special needs of your installation, you may want to create) SB
652 1582 1372 (your own customized routines in a special .DLL file. Setup can easily accom-) SB
652 1630 1425 (modate these routines. Simply create the .DLL file as you would any other .DLL) SB
652 1677 1190 (file. Then include it in the list of .DLL files in the SETUP.LST file.) SB
652 1780 1383 (To access functions in your custom .DLL files, you must declare the functions) SB
652 1828 1294 (in your script \(.MST\) file or in an include file. For example, to access the) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
652 1873 170 (MyFunc ) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
822 1876 709 (function, you must declare it as follows:) SB
32 0 0 42 42 0 0 33 /Courier /font0 ANSIFont font
827 2010 1100 (DECLARE FUNCTION MyFunc LIB \223My.dll\224 \(arg1%,) SB
827 2060 425 (arg2%\) AS INTEGER) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 2128 1340 (For more information about defining your own library functions, look at the) SB
652 2176 1163 (declarations in the Setup .INC files or refer to the online help file,) SB
652 2224 934 (TESTDRVR.HLP, that comes with the Setup toolkit.) SB
32 0 0 72 75 0 0 70 /Helvetica-Narrow-Bold /font26 ANSIFont font
302 2390 1075 (Installing Shared Files or System Files) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 2538 1373 (If you are planning to install shared files or system files, you must handle that) SB
652 2585 1408 (part of the installation with extra care. This section describes some of the issues) SB
652 2633 1318 (involved with installing shared files or system files and how Setup handles) SB
652 2681 99 (them.) SB
32 0 0 51 54 0 0 51 /Helvetica-Narrow-Bold /font26 ANSIFont font
652 2836 250 (Shared Files) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
652 2904 1325 (A shared file is a file that may be used by more than one application on the) SB
652 2952 1393 (user\222s system. For example, your company may have two products that use the) SB
652 3000 1367 (same spelling dictionary. If the user has already installed one of the products,) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Courier
%%+ font Times-Roman
%%+ font Times-Bold
%%Page: 14 14
%%PageResources: (atend)
SS
0 48 48 2550 4200 300 SM
0 0 0 fC
/fm 256 def
377 927 M 0 -3 -1774 0 0 3 1774 0 4 PP
1 F
n
32 0 0 42 42 0 0 39 /Helvetica-Narrow-Bold /font26 ANSIFont font
gs 2454 3278 0 413 CB
377 871 38 (32) SB
gr
gs 2454 3278 0 413 CB
583 871 154 (Microsoft) SB
gr
gs 2454 3278 0 413 CB
748 871 152 (Windows) SB
gr
gs 2454 3278 0 413 CB
911 871 126 (Version) SB
gr
gs 2454 3278 0 413 CB
1048 871 48 (3.1) SB
gr
gs 2454 3278 0 413 CB
1107 871 95 (Setup) SB
gr
gs 2454 3278 0 413 CB
1213 871 113 (Toolkit) SB
gr
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 995 1357 (that dictionary file may already be installed. Furthermore, if the user has that) SB
727 1043 1415 (product running during the installation process, the dictionary file may be in use) SB
727 1091 379 (and can\222t be updated.) SB
727 1193 497 (To handle this problem, the ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
1224 1190 402 (CopyFilesInCopyList) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1626 1193 484 ( procedure checks each file) SB
727 1241 1387 (listed in your .INF file with the SHARED attribute to see if the file is in use. If) SB
727 1289 1227 (so, Setup displays an error message. The user can fix the problem by:) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 1407 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 1392 1294 (Switching out of Setup, closing the other application, switching back into) SB
777 1440 751 (Setup, and then choosing the Retry button.) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 1557 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 1542 1276 (Exiting Setup and rerunning the installation after the other application is) SB
777 1590 124 (closed.) SB
32 0 0 24 24 0 0 20 /ZapfDingbats font
727 1707 18 (n) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
777 1692 1369 (Ignoring the message. If the file is marked as vital, Setup will display another) SB
777 1740 1278 (error message. If the file is not vital, Setup skips it but continues to copy) SB
777 1788 363 (other files in the list.) SB
32 0 0 51 54 0 0 51 /Helvetica-Narrow-Bold /font26 ANSIFont font
727 1943 256 (System Files) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
727 2011 1355 (A system file is a file that may be in use by Windows when Windows is run-) SB
727 2059 180 (ning. The ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
907 2056 402 (CopyFilesInCopyList) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1309 2059 820 ( procedure checks each file listed in your .INF) SB
727 2107 1363 (file with the SYSTEM attribute to see if the file is in use. If so, the procedure) SB
727 2155 1358 (copies the file to a temporary location \(the restart directory\) and adds a com-) SB
727 2203 618 (mand to the _MSSETUP.BAT file.) SB
727 2305 1077 (Toward the end of the installation, your script should call the) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
727 2350 341 (RestartListEmpty) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1068 2353 1052 ( function. If the function returns zero, there are system files) SB
727 2401 1397 (that need to be updated. You should inform the user about this and then use the) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
727 2446 310 (ExitExecRestart) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1037 2449 1076 ( function to shut down Windows, update the files, and restart) SB
727 2497 271 (Windows. The ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
998 2494 310 (ExitExecRestart) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1308 2497 764 ( function uses the MS-DOS-based program) SB
727 2545 1391 (_MSSETUP.EXE to copy the files listed in _MSSETUP.BAT. If you use these) SB
727 2593 1400 (procedures, you must list _MSSETUP.EXE in the SETUP.LST file and include) SB
727 2640 527 (it on the first installation disk.) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
727 2740 104 (Note:) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
831 2743 765 ( Windows version 3.0 does not support the ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
1596 2740 310 (ExitExecRestart) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1906 2743 169 ( function.) SB
727 2845 567 (For more information about the ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
1294 2842 402 (CopyFilesInCopyList) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1696 2845 22 (, ) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
1718 2842 341 (RestartListEmpty) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
2059 2845 86 (, and) SB
32 0 0 44 44 0 0 42 /Times-Bold /font39 ANSIFont font
727 2890 310 (ExitExecRestart) SB
32 0 0 44 44 0 0 39 /Times-Roman /font42 ANSIFont font
1037 2893 966 ( procedures, see Chapter 5, \223Setup Script Procedures.\224) SB
0 0 0 pC
0 2 SP
-119 777 M 208 0 1 PP
S
n
152 506 M 0 208 1 PP
S
n
2365 777 M 208 0 1 PP
S
n
2302 506 M 0 208 1 PP
S
n
2365 3327 M 208 0 1 PP
S
n
2302 3390 M 0 208 1 PP
S
n
-119 3327 M 208 0 1 PP
S
n
152 3390 M 0 208 1 PP
S
n
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%+ font Times-Bold
%%+ font ZapfDingbats
%%Trailer
%%Pages: 14
%%DocumentSuppliedResources: procset Win33Dict 3 1

%%DocumentNeededResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%+ font Times-Bold
%%+ font ZapfDingbats
%%+ font Times-BoldItalic
%%+ font Times-Italic
%%+ font Courier

end
%%EOF
