;===========================================================================
; MODULE:   AVIManl.Txt
; AUTHOR:   JohnMil
; DATE:     2/1/93
;
; This data file is meant to act as a sanity check for the MCI AVIVideo
; driver. It attempts to run a representative set of commands on known
; AVI files, and asks the user whether or not the results were as expected.
; It is IMPERATIVE that all questions be phrased in a manner such that 'Yes'
; indicates the correct behaviour, and 'No' indicates an error.
;
; Rules for construction of this data file can be found in MCI\MCIGen\TestLoop.
;
;===========================================================================
;
;
;
;=====================
TestCase TC_AVI_SANITY
;=====================
;
close %alias%
*

open %element% alias %alias%
0
=%DevNum%
play %alias% repeat
0
?Is %element% playing?
stop %alias%
0
?Select 'Yes'. A configure dialog should come up, which you should close.
configure %alias%
0
?Did the 'Configure' dialog come up?
seek %alias% to start wait
0

play %alias% repeat
0

; This is to buy some time for the play command to start
status %alias% file
*
*
pause %alias%
0
?Did %element% stop playing in the middle somewhere?
resume %alias%
0
?Did %element% resume from where it left off?
seek %alias% to start
0

play %alias% fullscreen
*
?Did %element% play in fullscreen mode? (Select 'Yes' if fullscreen mode is not supported)
seek %alias% to start wait
0
?Press 'Yes.' A short segment of %element% will play.
play %alias% from 40 to 60 wait
0
?Did %element% play in the middle for a few seconds?
play %alias% to 40
0
?Did %element% play backwards over the same section?
seek %alias% to 40
0
?Press 'Yes.' The playback window should skip forward through four frames of %element%.
step %alias% by 5
0

step %alias% by 5
0

step %alias% by 5
0

step %alias% by 5
0
? Were four frames from %element% shown in forward order?
status %alias% position
0
?Press 'Yes.' Approximately the same four frames should be shown in reverse order.
step %alias% by 5 reverse
0

step %alias% by 5 reverse
0

step %alias% by -5
0

step %alias% by -5
0
? Were the frames shown in reverse order?
play %alias% repeat
0

put %alias% window at 0 0 300 300
0
? Is %element% now a 300x300 pixel window at the upper left of your screen?
put %alias% destination at 0 0 150 150
0
? Is all of %element% in the upper left 1/4 of the playback window?
put %alias% source at 20 20 50 50
0
? Is a magnified part of %element% visible in the upper left 1/4 of the playback window?
put %alias% destination
0

put %alias% source at 0 0 10 10
0
? Is %element% stretched so that a small portion of the source fills the whole playback window?
put %alias% source
0

close %alias%
0

open %element% alias %alias%
0
*
set %alias% speed 1000
0

play %alias% repeat
0
?Press 'Yes' after noting how quickly %element% is being played.
set %alias% speed 500 wait
0

status %alias% position
0
?Is %element% playing about half as fast as it was at first?
set %alias% speed 2000 wait
0
?Is %element% playing about twice as fast as it originally was?
set %alias% speed 1000
0

seek %alias% to start
0
?Press 'Yes' and listen to the audio track as %element% plays. It should cut in and out several times.
play %alias% repeat
0

setaudio %alias% off
0

setaudio %alias% on
0

setaudio %alias% off
0

setaudio %alias% on
0

setaudio %alias% off
0

setaudio %alias% on
0

setaudio %alias% off
0

setaudio %alias% on
0
?Did the audio cut in and out several times?
status %alias% position
0
?Press 'Yes' and watch the video as %element% plays. It should freeze at several different points.
setvideo %alias% off
0

setvideo %alias% on
0

setvideo %alias% off
0

setvideo %alias% on
0

setvideo %alias% off
0

setvideo %alias% on
0

setvideo %alias% off
0

setvideo %alias% on
0
?Did the video cut in and out (pause, then skip) several times?
status %alias% position
0
?Press 'Yes', and listen to the volume as %element% plays. It should slowly fade out, then back in.
setaudio %alias% volume to 1000
0

setaudio %alias% volume to 900
0

setaudio %alias% volume to 800
0

setaudio %alias% volume to 700
0

setaudio %alias% volume to 600
0

setaudio %alias% volume to 500
0

setaudio %alias% volume to 400
0

setaudio %alias% volume to 300
0

setaudio %alias% volume to 200
0

setaudio %alias% volume to 100
0

setaudio %alias% volume to 0
0

setaudio %alias% volume to 100
0

setaudio %alias% volume to 200
0

setaudio %alias% volume to 300
0

setaudio %alias% volume to 400
0

setaudio %alias% volume to 500
0

setaudio %alias% volume to 600
0

setaudio %alias% volume to 700
0

setaudio %alias% volume to 800
0

setaudio %alias% volume to 900
0

setaudio %alias% volume to 1000
0
?Did the volume gradually fade out, then back in again?
put %alias% window at 0 0 100 100
0

open %element% alias alias2
0
=%devnum%
play alias2 reverse repeat
0

put alias2 window at 200 0 100 100 wait
0
? Is %element% playing forward on the left, and backward on the right?
put %alias% destination at 0 0 50 100
0

status %alias% window handle
0
=%WndHnd%
window alias2 handle %WndHnd%
0

put alias2 destination at 50 0 100 100 wait
0
?Is %element% playing backwards in the left half of the window, and forward in the right half?
window alias2 handle default
0

put %alias% destination
0

close alias2
0
?Is %element% back to playing normally (forward) in a single window?
put %alias% window at 0 0 320 320 wait
0

;window %alias% state minimized
;0
;?Is %element% playing minimized?
;window %alias% restore
;0
;?Is %element% back to normal size?
;window %alias% state show na
;0
;?Is %element% still playing audio, but not video?
;window %alias% show normal
;0
;? Press 'yes'. %element% will be maximized. After it is, switch focus to find the next question.
;window %alias% show maximized
;0
;? Was %element% maximized?
;window %alias% show normal
;0
;
window %alias% text "Just Another Spud-Boy" wait
0
?Does the caption on the title bar of %element%'s play window read 'Just Another Spud-Boy'?
close %alias%
*
*
