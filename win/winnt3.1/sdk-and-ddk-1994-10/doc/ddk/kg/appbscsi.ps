%!PS-Adobe-2.0 
PSp 15840 SFL 
1920 2440 P 8 18 F B (Appendix) S 100 J ( B) S E 
1920 2840 P B (SCSI) S 100 J ( Drivers) S E 
1920 3600 P 0 12 F 24 12 F (This) S 60 J ( appendix) S 60 J ( provides) S 60 J ( guidelines) S 60 J ( for) S 60 J ( designing) S 60 J ( the) S 60 J ( following) S 60 J ( kinds) S 60 J ( of) S 60 J ( SCSI) S 60 J ( drivers:) S 
1920 3920 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( class) S 60 J ( driver) S 60 J ( for) S 60 J ( a) S 60 J ( new) S 60 J ( type) S 60 J ( of) S 60 J ( peripheral) S 60 J ( device) S 
1920 4240 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( filter) S 60 J ( driver) S 60 J ( for) S 60 J ( a) S 60 J ( peripheral) S 60 J ( device) S 60 J ( of) S 60 J ( a) S 60 J ( type) S 60 J ( that) S 60 J ( already) S 60 J ( has) S 60 J ( a) S 60 J ( class) S 60 J ( driver) S 
1920 4560 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( tape) S 60 J ( subclass) S 60 J ( driver) S 60 J ( for) S 60 J ( a) S 60 J ( vendor-specific) S 60 J ( tape) S 60 J ( device) S 
1920 4880 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( host) S 60 J ( bus) S 60 J ( adapter) S 60 J ( \(HBA\)) S 60 J ( miniport) S 60 J ( driver) S 
1920 5260 P (Class) S 60 J ( and) S 60 J ( filter) S 60 J ( drivers) S 60 J ( for) S 60 J ( SCSI) S 60 J ( peripheral) S 60 J ( devices) S 60 J ( act) S 60 J ( as) S 60 J ( an) S 60 J ( interface) S 60 J ( between) S 60 J ( any) S 
1920 5520 P (intermediate) S 60 J ( or) S 60 J ( highest-level) S 60 J ( drivers) S 60 J ( layered) S 60 J ( above) S 60 J ( the) S 60 J ( class) S 60 J ( or) S 60 J ( filter) S 60 J ( driver) S 60 J ( and) S 60 J ( the) S 60 J ( NT-) S 
1920 5780 P (supplied) S 60 J ( SCSI) S 60 J ( port) S 60 J ( driver.) S 60 J ( That) S 60 J ( is,) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( translate) S 60 J ( the) S 60 J ( standard) S 60 J ( IRPs) S 60 J ( they) S 60 J ( get) S 60 J ( into) S 
1920 6040 P (IRPs) S 60 J ( with) S 60 J ( system-defined) S 60 J ( SCSI) S 60 J ( request) S 60 J ( blocks) S 60 J ( \(SRBs\)) S 60 J ( before) S 60 J ( sending) S 60 J ( each) S 60 J ( IRP) S 60 J ( on) S 60 J ( to) S 60 J ( the) S 60 J ( NT) S 
1920 6300 P (SCSI) S 60 J ( port) S 60 J ( driver.) S 60 J ( Each) S 60 J ( SRB) S 60 J ( contains) S 60 J ( a) S 60 J ( SCSI-II) S 60 J ( command) S 60 J ( descriptor) S 60 J ( block) S 60 J ( \(CDB\),) S 60 J ( as) S 60 J ( well) S 60 J ( as) S 
1920 6560 P (fields) S 60 J ( that) S 60 J ( identify) S 60 J ( the) S 60 J ( target) S 60 J ( device) S 60 J ( for) S 60 J ( the) S 60 J ( requested) S 60 J ( operation.) S 
1920 6940 P (In) S 60 J ( turn,) S 60 J ( the) S 60 J ( system-supplied,) S 60 J ( NT-dependent) S 60 J ( port) S 60 J ( driver) S 60 J ( passes) S 60 J ( SRBs) S 60 J ( with) S 60 J ( CDBs) S 60 J ( on) S 60 J ( to) S 60 J ( OS-) S 
1920 7200 P (independent,) S 60 J ( HBA-specific) S 60 J ( miniport) S 60 J ( drivers.) S 60 J ( The) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( port) S 60 J ( driver) S 60 J ( acts) S 60 J ( as) S 60 J ( an) S 60 J ( interface) S 
1920 7460 P (between) S 60 J ( all) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( and) S 60 J ( all) S 60 J ( HBA-specific) S 60 J ( miniport) S 60 J ( drivers.) S 
1920 7840 P (For) S 60 J ( more) S 60 J ( detailed) S 60 J ( information) S 60 J ( about) S 60 J ( SRBs,) S 60 J ( see) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (Kernel-mode) S 60 J ( Driver) S 60 J ( Reference) S E 0 12 F 24 12 F (.) S 60 J ( For) S 
1920 8100 P (device-type-specific) S 60 J ( information) S 60 J ( about) S 60 J ( CDBs,) S 60 J ( consult) S 60 J ( the) S 60 J ( ANSI) S 60 J ( X3.131-199X) S 60 J ( SCSI-II) S 
1920 8360 P (standard.) S 60 J ( Note) S 60 J ( that) S 60 J ( the) S 60 J ( system-supplied) S 60 J ( SCSI) S 60 J ( drivers) S 60 J ( include) S 60 J ( the) S 60 J ( header) S 60 J ( file,) S 60 J ( ) S 0 12 F 24 12 F I (scsi.h) S E 0 12 F 24 12 F (,) S 60 J ( which) S 
1920 8620 P (contains) S 60 J ( SCSI-II-compliant) S 60 J ( definitions) S 60 J ( for) S 60 J ( CDBs) S 60 J ( and) S 60 J ( other) S 60 J ( structures) S 60 J ( used) S 60 J ( by) S 60 J ( most) S 60 J ( SCSI-II-) S 
1920 8827 P 0 12 F 24 8 F 3543 J ( ) S (TM) S 
1920 8880 P 0 12 F 24 12 F (compliant) S 60 J ( drivers.) S 60 J ( The) S 60 J ( Windows) S 60 J ( NT) S 240 J ( ) S () S 60 J ( Device) S 60 J ( Driver) S 60 J ( Kit) S 60 J ( \(DDK\)) S 60 J ( supplies) S 60 J ( ) S 0 12 F 24 12 F I (scsi.h) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( be) S 
1920 9140 P (included) S 60 J ( in) S 60 J ( or) S 60 J ( modified) S 60 J ( for) S 60 J ( new) S 60 J ( SCSI) S 60 J ( drivers.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (2) S E B () S 1003 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2120 P 0 12 F 8 14 F B (B.1) S 78 J ( ) S 78 J ( ) S 78 J ( ) S 78 J ( Designing) S 78 J ( a) S 78 J ( SCSI) S 78 J ( Class) S 78 J ( Driver) S E 
1200 2740 P 0 12 F 24 12 F (To) S 60 J ( the) S 60 J ( NT) S 60 J ( I/O) S 60 J ( Manager) S 60 J ( and) S 60 J ( any) S 60 J ( higher-level) S 60 J ( drivers) S 60 J ( layered) S 60 J ( over) S 60 J ( it,) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( is) S 60 J ( a) S 
1200 3000 P (standard) S 60 J ( NT) S 60 J ( intermediate) S 60 J ( driver.) S 60 J ( It) S 60 J ( must) S 60 J ( supply) S 60 J ( a) S 60 J ( set) S 60 J ( of) S 60 J ( Dispatch) S 60 J ( routines) S 60 J ( to) S 60 J ( which) S 60 J ( the) S 60 J ( I/O) S 
1200 3260 P (Manager) S 60 J ( and/or) S 60 J ( still) S 60 J ( higher-level) S 60 J ( drivers,) S 60 J ( such) S 60 J ( as) S 60 J ( FSDs,) S 60 J ( can) S 60 J ( send) S 60 J ( IRPs) S 60 J ( for) S 60 J ( appropriate) S 60 J ( I/O) S 
1200 3520 P (operations.) S 60 J ( That) S 60 J ( is,) S 60 J ( a) S 60 J ( new) S 60 J ( class) S 60 J ( driver) S 60 J ( is) S 60 J ( required) S 60 J ( to) S 60 J ( support) S 60 J ( the) S 60 J ( same) S 60 J ( set) S 60 J ( of) S 60 J ( IRP_MJ_) S 0 12 F 24 12 F I (xxx) S E 0 12 F 24 12 F () S 60 J ( as) S 60 J ( a) S 
1200 3780 P (nonSCSI) S 60 J ( driver) S 60 J ( for) S 60 J ( the) S 60 J ( same) S 60 J ( type) S 60 J ( of) S 60 J ( device.) S 60 J ( For) S 60 J ( specific) S 60 J ( information) S 60 J ( about) S 60 J ( which) S 60 J ( requests) S 
1200 4040 P (drivers) S 60 J ( of) S 60 J ( the) S 60 J ( most) S 60 J ( common) S 60 J ( types) S 60 J ( of) S 60 J ( devices) S 60 J ( must) S 60 J ( handle,) S 60 J ( see) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (Kernel-mode) S 60 J ( Driver) S E 
1200 4300 P I (Reference) S E 0 12 F 24 12 F (.) S 
1200 4680 P (The) S 60 J ( designer) S 60 J ( of) S 60 J ( a) S 60 J ( class) S 60 J ( driver) S 60 J ( for) S 60 J ( an) S 60 J ( entirely) S 60 J ( new) S 60 J ( type) S 60 J ( of) S 60 J ( SCSI) S 60 J ( device) S 60 J ( must) S 60 J ( determine) S 60 J ( an) S 
1200 4940 P (appropriate) S 60 J ( set) S 60 J ( of) S 60 J ( requests) S 60 J ( for) S 60 J ( the) S 60 J ( driver) S 60 J ( to) S 60 J ( support,) S 60 J ( depending) S 60 J ( on) S 60 J ( the) S 60 J ( nature) S 60 J ( of) S 60 J ( the) S 60 J ( device.) S 60 J ( The) S 
1200 5200 P (set) S 60 J ( of) S 60 J ( requests) S 60 J ( to) S 60 J ( be) S 60 J ( supported) S 60 J ( generally) S 60 J ( includes) S 60 J ( at) S 60 J ( least) S 60 J ( IRP_MJ_CREATE) S 60 J ( \(and,) S 60 J ( for) S 60 J ( some) S 
1200 5460 P (device) S 60 J ( types) S 60 J ( or) S 60 J ( for) S 60 J ( symmetry,) S 60 J ( IRP_MJ_CLOSE\),) S 60 J ( IRP_MJ_DEVICE_CONTROL,) S 60 J ( and) S 
1200 5720 P (IRP_MJ_READ,) S 60 J ( IRP_MJ_WRITE,) S 60 J ( or) S 60 J ( both.) S 
1200 6100 P (In) S 60 J ( addition,) S 60 J ( every) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( have) S 60 J ( a) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( and) S 60 J ( one) S 60 J ( or) S 60 J ( more) S 60 J ( IoCompletion) S 
1200 6360 P (routines.) S 60 J ( A) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( also) S 60 J ( can) S 60 J ( have) S 60 J ( any) S 60 J ( other) S 60 J ( NT) S 60 J ( standard) S 60 J ( higher-level) S 60 J ( driver) S 60 J ( routine,) S 
1200 6620 P (such) S 60 J ( as) S 60 J ( an) S 60 J ( Unload) S 60 J ( routine,) S 60 J ( as) S 60 J ( necessary) S 60 J ( \(see) S 60 J ( Chapter) S 60 J ( 4\).) S 
1200 7000 P (To) S 60 J ( the) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( port) S 60 J ( driver,) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( is) S 60 J ( a) S 60 J ( higher-level) S 60 J ( driver) S 60 J ( with) S 60 J ( built-in,) S 60 J ( SCSI-) S 
1200 7260 P (specific) S 60 J ( functionality.) S 60 J ( In) S 60 J ( general,) S 60 J ( every) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( is) S 60 J ( responsible) S 60 J ( for) S 60 J ( the) S 60 J ( following:) S 
1200 7580 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Connecting) S 60 J ( itself) S 60 J ( to) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( so) S 60 J ( that) S 60 J ( requests) S 60 J ( can) S 60 J ( be) S 60 J ( routed) S 60 J ( to) S 60 J ( the) S 60 J ( correct) S 60 J ( target\(s\)) S 
1200 7900 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Creating) S 60 J ( device) S 60 J ( objects) S 60 J ( to) S 60 J ( represent) S 60 J ( its) S 60 J ( devices) S 60 J ( on) S 60 J ( each) S 60 J ( SCSI) S 60 J ( bus) S 60 J ( in) S 60 J ( the) S 60 J ( machine) S 
1200 8220 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Initializing) S 60 J ( the) S 60 J ( appropriate) S 60 J ( controllers) S 60 J ( \(TIDs\)) S 60 J ( and) S 60 J ( devices) S 60 J ( \(LUs\)) S 60 J ( on) S 60 J ( the) S 60 J ( SCSI) S 60 J ( bus\(es\)) S 
1200 8540 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( Interpreting) S 60 J ( system) S 60 J ( I/O) S 60 J ( requests) S 60 J ( \(IRPs\)) S 
1200 8860 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Mapping) S 60 J ( IRPs) S 60 J ( to) S 60 J ( SCSI) S 60 J ( class/port) S 60 J ( interface) S 60 J ( requests) S 60 J ( \(SRBs) S 60 J ( with) S 60 J ( SCSI-II) S 60 J ( CDBs\)) S 
1200 9180 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Establishing) S 60 J ( time-out) S 60 J ( values) S 60 J ( for) S 60 J ( requests) S 
1200 9500 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Limiting) S 60 J ( the) S 60 J ( size) S 60 J ( of) S 60 J ( data) S 60 J ( transfers) S 60 J ( to) S 60 J ( suit) S 60 J ( the) S 60 J ( limits) S 60 J ( of) S 60 J ( the) S 60 J ( HBA) S 
1200 9820 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( Handling) S 60 J ( error) S 60 J ( conditions) S 60 J ( that) S 60 J ( are) S 60 J ( not) S 60 J ( already) S 60 J ( handled) S 60 J ( by) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( or) S 60 J ( the) S 60 J ( HBA,) S 
1680 10080 P (such) S 60 J ( as) S 60 J ( check-condition) S 60 J ( status) S 60 J ( or) S 60 J ( bus) S 60 J ( resets) S 
1200 10460 P (The) S 60 J ( following) S 60 J ( subsections) S 60 J ( describe) S 60 J ( how) S 60 J ( class) S 60 J ( drivers) S 60 J ( provide) S 60 J ( this) S 60 J ( SCSI-specific) S 60 J ( functionality) S 
1200 10720 P (in) S 60 J ( the) S 60 J ( context) S 60 J ( of) S 60 J ( each) S 60 J ( standard) S 60 J ( routine) S 60 J ( that) S 60 J ( class) S 60 J ( drivers) S 60 J ( commonly) S 60 J ( have.) S 
1200 11100 P (Note) S 60 J ( that) S 60 J ( the) S 60 J ( system-supplied) S 60 J ( class) S 60 J ( drivers) S 60 J ( include) S 60 J ( the) S 60 J ( header) S 60 J ( file) S 60 J ( ) S 0 12 F 24 12 F I (class.h) S E 0 12 F 24 12 F () S 60 J ( so) S 60 J ( they) S 60 J ( can) S 60 J ( call) S 60 J ( the) S 
1200 11360 P (ScsiClass) S 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines) S 60 J ( provided) S 60 J ( by) S 60 J ( ) S 0 12 F 24 12 F I (class.c) S E 0 12 F 24 12 F (.) S 60 J ( The) S 60 J ( Windows) S 60 J ( NT) S 60 J ( DDK) S 60 J ( provides) S 60 J ( ) S 0 12 F 24 12 F I (class.h) S E 0 12 F 24 12 F () S 60 J ( and) S 
1200 11620 P 0 12 F 24 12 F I (class.c) S E 0 12 F 24 12 F () S 60 J ( as) S 60 J ( sample) S 60 J ( source) S 60 J ( code.) S 60 J ( However,) S 60 J ( ) S 0 12 F 24 12 F I (class.c) S E 0 12 F 24 12 F () S 60 J ( should) S 60 J ( not) S 60 J ( be) S 60 J ( considered) S 60 J ( a) S 60 J ( system-supplied) S 
1200 11880 P (library) S 60 J ( for) S 60 J ( all) S 60 J ( future) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers;) S 60 J ( both) S 60 J ( ) S 0 12 F 24 12 F I (class.h) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F I (class.c) S E 0 12 F 24 12 F () S 60 J ( are) S 60 J ( subject) S 60 J ( to) S 60 J ( change) S 60 J ( without) S 
1200 12140 P (notice.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 883 J ( B-) S E B (3) S E 
1920 2080 P 0 12 F 8 12 F B (B.1.1) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( DriverEntry) S 67 J ( Routine) S E 
1920 2700 P 0 12 F 24 12 F (Like) S 60 J ( any) S 60 J ( other) S 60 J ( NT) S 60 J ( intermediate) S 60 J ( driver,) S 60 J ( the) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( of) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 
1920 2960 P (define) S 60 J ( its) S 60 J ( Dispatch) S 60 J ( entry) S 60 J ( points) S 60 J ( in) S 60 J ( the) S 60 J ( input) S 60 J ( driver) S 60 J ( object.) S 60 J ( Then,) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( layer) S 
1920 3220 P (itself) S 60 J ( over) S 60 J ( the) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( port) S 60 J ( driver) S 60 J ( by) S 60 J ( calling) S 60 J ( ) S 0 12 F 24 12 F B (IoGetDeviceObjectPointer) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( must) S 60 J ( locate) S 60 J ( its) S 
1920 3480 P (device\(s\),) S 60 J ( if) S 60 J ( any) S 60 J ( are) S 60 J ( present) S 60 J ( in) S 60 J ( the) S 60 J ( machine.) S 60 J ( The) S 60 J ( class) S 60 J ( driver's) S 60 J ( initial) S 60 J ( call) S 60 J ( to) S 
1920 3740 P 0 12 F 24 12 F B (IoGetDeviceObjectPointer) S E 0 12 F 24 12 F () S 60 J ( returns) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( a) S 60 J ( generic) S 60 J ( device) S 60 J ( object) S 60 J ( created) S 60 J ( by) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 
1920 4000 P (driver,) S 60 J ( rather) S 60 J ( than) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( a) S 60 J ( device) S 60 J ( object) S 60 J ( that) S 60 J ( represents) S 60 J ( a) S 60 J ( particular) S 60 J ( HBA.) S 60 J ( The) S 60 J ( class) S 
1920 4260 P (driver) S 60 J ( uses) S 60 J ( this) S 60 J ( generic) S 60 J ( device) S 60 J ( object) S 60 J ( pointer) S 60 J ( to) S 60 J ( find) S 60 J ( its) S 60 J ( device\(s\)) S 60 J ( on) S 60 J ( each) S 60 J ( bus) S 60 J ( driven) S 60 J ( by) S 60 J ( one) S 60 J ( or) S 
1920 4520 P (more) S 60 J ( HBAs) S 60 J ( in) S 60 J ( the) S 60 J ( machine.) S 
1920 5040 P 0 12 F 8 12 F B (B.1.1.1) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( GetInquiryData) S 67 J ( Routines) S E 
1920 5660 P 0 12 F 24 12 F (To) S 60 J ( find) S 60 J ( its) S 60 J ( device\(s\),) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( either) S 60 J ( calls) S 60 J ( a) S 60 J ( GetInquiryData) S 60 J ( routine) S 60 J ( or) S 60 J ( implements) S 60 J ( the) S 
1920 5920 P (same) S 60 J ( functionality) S 60 J ( in) S 60 J ( its) S 60 J ( DriverEntry) S 60 J ( routine.) S 60 J ( A) S 60 J ( GetInquiryData) S 60 J ( routine) S 60 J ( allocates) S 60 J ( an) S 
1920 6180 P (INQUIRY_DATA_SIZE) S 60 J ( buffer) S 60 J ( for) S 60 J ( SCSI_ADAPTER_BUS_INFO-type) S 60 J ( data.) S 60 J ( Next,) S 60 J ( it) S 
1920 6440 P (allocates) S 60 J ( an) S 60 J ( IRP) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (IoBuildDeviceIoControlRequest) S E 0 12 F 24 12 F (,) S 60 J ( sets) S 60 J ( the) S 60 J ( port) S 60 J ( driver's) S 60 J ( I/O) S 60 J ( stack) S 
1920 6700 P (location) S 60 J ( up) S 60 J ( with) S 60 J ( the) S 60 J ( I/O) S 60 J ( control) S 60 J ( code) S 60 J ( IOCTL_SCSI_GET_INQUIRY_DATA,) S 60 J ( and) S 60 J ( passes) S 60 J ( the) S 
1920 6960 P (IRP) S 60 J ( on) S 60 J ( to) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (IoCallDriver) S E 0 12 F 24 12 F (.) S 
1920 7340 P (The) S 60 J ( class) S 60 J ( driver) S 60 J ( uses) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (InquiryDataOffset) S E 0 12 F 24 12 F () S 60 J ( in) S 60 J ( the) S 60 J ( SCSI_ADAPTER_BUS_INFO) S 60 J ( buffer) S 60 J ( to) S 
1920 7600 P (inspect) S 60 J ( the) S 60 J ( SCSI) S 60 J ( inquiry) S 60 J ( data) S 60 J ( and) S 60 J ( find) S 60 J ( device\(s\)) S 60 J ( of) S 60 J ( its) S 60 J ( type.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( the) S 
1920 7860 P (SCSI_ADAPTER_BUS_INFO) S 60 J ( structure) S 60 J ( and) S 60 J ( IOCTLs) S 60 J ( supported) S 60 J ( by) S 60 J ( the) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( port) S 60 J ( driver,) S 
1920 8120 P (see) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (Kernel-mode) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F I (Driver) S 60 J ( Reference) S E 0 12 F 24 12 F (.) S 
1920 8500 P (Like) S 60 J ( any) S 60 J ( other) S 60 J ( NT) S 60 J ( driver,) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( set) S 60 J ( up) S 60 J ( a) S 60 J ( device) S 60 J ( object) S 60 J ( to) S 60 J ( represent) S 60 J ( each) S 
1920 8760 P (physical,) S 60 J ( logical,) S 60 J ( and/or) S 60 J ( virtual) S 60 J ( device) S 60 J ( for) S 60 J ( which) S 60 J ( it) S 60 J ( handles) S 60 J ( I/O) S 60 J ( requests.) S 60 J ( The) S 60 J ( class) S 60 J ( driver) S 60 J ( also) S 
1920 9020 P (must) S 60 J ( establish) S 60 J ( a) S 60 J ( claim) S 60 J ( on) S 60 J ( each) S 60 J ( of) S 60 J ( the) S 60 J ( physical) S 60 J ( devices) S 60 J ( for) S 60 J ( which) S 60 J ( it) S 60 J ( creates) S 60 J ( a) S 60 J ( device) S 60 J ( object) S 60 J ( with) S 
1920 9280 P 0 12 F 24 12 F B (IoCreateDevice) S E 0 12 F 24 12 F (.) S 60 J ( Subsequently) S 60 J ( loaded) S 60 J ( drivers) S 60 J ( for) S 60 J ( the) S 60 J ( same) S 60 J ( type) S 60 J ( of) S 60 J ( device) S 60 J ( can) S 60 J ( determine) S 
1920 9540 P (whether) S 60 J ( a) S 60 J ( particular) S 60 J ( device) S 60 J ( has) S 60 J ( already) S 60 J ( been) S 60 J ( claimed) S 60 J ( by) S 60 J ( inspecting) S 60 J ( the) S 60 J ( inquiry) S 60 J ( data) S 60 J ( for) S 60 J ( each) S 
1920 9800 P (HBA) S 60 J ( and) S 60 J ( SCSI) S 60 J ( bus) S 60 J ( in) S 60 J ( the) S 60 J ( machine.) S 60 J ( A) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( not) S 60 J ( attempt) S 60 J ( to) S 60 J ( claim) S 60 J ( an) S 60 J ( already) S 
1920 10060 P (claimed) S 60 J ( device.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (4) S E B () S 1003 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2080 P 0 12 F 8 12 F B (B.1.1.2) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( ClaimDevice) S 67 J ( Routines) S E 
1200 2700 P 0 12 F 24 12 F (To) S 60 J ( claim) S 60 J ( a) S 60 J ( device,) S 60 J ( a) S 60 J ( class) S 60 J ( driver) S 60 J ( either) S 60 J ( calls) S 60 J ( a) S 60 J ( ClaimDevice) S 60 J ( routine) S 60 J ( or) S 60 J ( implements) S 60 J ( the) S 60 J ( same) S 
1200 2960 P (functionality) S 60 J ( in) S 60 J ( its) S 60 J ( DriverEntry) S 60 J ( routine.) S 60 J ( A) S 60 J ( ClaimDevice) S 60 J ( routine) S 60 J ( sets) S 60 J ( up) S 60 J ( an) S 60 J ( SRB) S 60 J ( for) S 60 J ( the) S 60 J ( target) S 
1200 3220 P (device) S 60 J ( \(designated) S 60 J ( by) S 60 J ( ) S 0 12 F 24 12 F B (PathId) S E 0 12 F 24 12 F (,) S 60 J ( ) S 0 12 F 24 12 F B (TargetId) S E 0 12 F 24 12 F (,) S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (Lun) S E 0 12 F 24 12 F () S 60 J ( in) S 60 J ( the) S 60 J ( SRB\)) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( value) S 
1200 3480 P (SRB_FUNCTION_CLAIM_DEVICE.) S 
1200 3860 P (The) S 60 J ( ClaimDevice) S 60 J ( routine) S 60 J ( allocates) S 60 J ( an) S 60 J ( IRP) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (IoBuildDeviceIoControlRequest) S E 0 12 F 24 12 F (,) S 60 J ( setting) S 60 J ( up) S 
1200 4120 P (the) S 60 J ( port) S 60 J ( driver's) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 60 J ( with) S 60 J ( the) S 60 J ( I/O) S 60 J ( control) S 60 J ( code) S 
1200 4380 P (IOCTL_SCSI_EXECUTE_NONE) S 60 J ( and) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( SRB) S 60 J ( at) S 60 J ( ) S 0 12 F 24 12 F B (Parameters.Scsi.Srb) S E 0 12 F 24 12 F (.) S 
1200 4640 P (ClaimDevice) S 60 J ( sets) S 60 J ( up) S 60 J ( an) S 60 J ( event) S 60 J ( object) S 60 J ( so) S 60 J ( it) S 60 J ( can) S 60 J ( wait) S 60 J ( on) S 60 J ( the) S 60 J ( completion) S 60 J ( of) S 60 J ( the) S 60 J ( IRP) S 60 J ( and) S 60 J ( sends) S 60 J ( the) S 
1200 4900 P (IRP) S 60 J ( on) S 60 J ( to) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (IoCallDriver) S E 0 12 F 24 12 F (.) S 60 J ( On) S 60 J ( return) S 60 J ( from) S 60 J ( a) S 60 J ( successful) S 60 J ( call) S 60 J ( to) S 60 J ( the) S 60 J ( NT) S 
1200 5160 P (port) S 60 J ( driver,) S 60 J ( the) S 60 J ( ClaimDevice) S 60 J ( routine) S 60 J ( checks) S 60 J ( the) S 60 J ( SRB's) S 60 J ( ) S 0 12 F 24 12 F B (DataBuffer) S E 0 12 F 24 12 F () S 60 J ( for) S 60 J ( a) S 60 J ( nonNULL) S 60 J ( pointer) S 60 J ( to) S 
1200 5420 P (the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver's) S 60 J ( device) S 60 J ( object) S 60 J ( for) S 60 J ( the) S 60 J ( HBA.) S 
1200 5800 P (The) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( store) S 60 J ( such) S 60 J ( a) S 60 J ( returned) S 60 J ( pointer) S 60 J ( in) S 60 J ( the) S 60 J ( device) S 60 J ( extension) S 60 J ( of) S 60 J ( its) S 60 J ( own) S 60 J ( device) S 
1200 6060 P (object) S 60 J ( that) S 60 J ( represents) S 60 J ( the) S 60 J ( newly) S 60 J ( claimed) S 60 J ( device.) S 60 J ( The) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( use) S 60 J ( this) S 60 J ( HBA-specific) S 
1200 6320 P (device) S 60 J ( object) S 60 J ( pointer) S 60 J ( in) S 60 J ( all) S 60 J ( subsequent) S 60 J ( requests) S 60 J ( that) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( sends) S 60 J ( down) S 60 J ( to) S 60 J ( the) S 60 J ( port-) S 
1200 6580 P (miniport) S 60 J ( driver) S 60 J ( pair.) S 60 J ( Consequently,) S 60 J ( the) S 60 J ( ClaimDevice) S 60 J ( routine) S 60 J ( must) S 60 J ( call) S 
1200 6840 P 0 12 F 24 12 F B (ObReferenceObjectByPointer) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( pointer) S 60 J ( returned) S 60 J ( in) S 60 J ( the) S 60 J ( SRB's) S 60 J ( ) S 0 12 F 24 12 F B (DataBuffer) S E 0 12 F 24 12 F (,) S 60 J ( thereby) S 
1200 7100 P (bumping) S 60 J ( the) S 60 J ( reference) S 60 J ( count) S 60 J ( for) S 60 J ( the) S 60 J ( pointer) S 60 J ( so) S 60 J ( it) S 60 J ( cannot) S 60 J ( be) S 60 J ( deleted) S 60 J ( when) S 60 J ( ClaimDevice) S 60 J ( returns) S 
1200 7360 P (control) S 60 J ( to) S 60 J ( the) S 60 J ( DriverEntry) S 60 J ( routine.) S 
1200 7740 P (A) S 60 J ( ClaimDevice) S 60 J ( routine) S 60 J ( can) S 60 J ( serve) S 60 J ( double) S 60 J ( duty) S 60 J ( as) S 60 J ( a) S 60 J ( routine) S 60 J ( to) S 60 J ( be) S 60 J ( called) S 60 J ( from) S 60 J ( a) S 60 J ( class) S 60 J ( driver's) S 
1200 8000 P (Unload) S 60 J ( routine) S 60 J ( by) S 60 J ( also) S 60 J ( sending) S 60 J ( SRBs) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( value) S 
1200 8260 P (SRB_FUNCTION_RELEASE_DEVICE.) S 60 J ( If) S 60 J ( the) S 60 J ( driver) S 60 J ( can) S 60 J ( be) S 60 J ( unloaded,) S 60 J ( its) S 60 J ( Unload) S 60 J ( or) S 
1200 8520 P (ClaimDevice) S 60 J ( routine) S 60 J ( must) S 60 J ( dereference) S 60 J ( the) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( HBA-specific) S 60 J ( device) S 60 J ( object) S 60 J ( by) S 
1200 8780 P (calling) S 60 J ( ) S 0 12 F 24 12 F B (ObDereferenceObject) S E 0 12 F 24 12 F (.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 883 J ( B-) S E B (5) S E 
1920 2080 P 0 12 F 8 12 F B (B.1.1.3) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( Setting) S 67 J ( up) S 67 J ( Device) S 67 J ( Extensions) S E 
1920 2700 P 0 12 F 24 12 F (In) S 60 J ( the) S 60 J ( device) S 60 J ( extension) S 60 J ( of) S 60 J ( each) S 60 J ( device) S 60 J ( object,) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( provides) S 60 J ( storage) S 60 J ( for) S 60 J ( whatever) S 
1920 2960 P (driver-determined) S 60 J ( data) S 60 J ( it) S 60 J ( uses) S 60 J ( to) S 60 J ( manage) S 60 J ( I/O) S 60 J ( requests) S 60 J ( for) S 60 J ( the) S 60 J ( device,) S 60 J ( such) S 60 J ( as) S 60 J ( the) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 
1920 3220 P (NT) S 60 J ( port) S 60 J ( driver's) S 60 J ( HBA-specific) S 60 J ( device) S 60 J ( object,) S 60 J ( a) S 60 J ( back) S 60 J ( pointer) S 60 J ( to) S 60 J ( its) S 60 J ( own) S 60 J ( device) S 60 J ( object,) S 60 J ( and) S 60 J ( so) S 
1920 3480 P (forth.) S 60 J ( Most) S 60 J ( class) S 60 J ( drivers) S 60 J ( also) S 60 J ( provide) S 60 J ( storage) S 60 J ( for) S 60 J ( the) S 60 J ( following) S 60 J ( SCSI-specific) S 60 J ( information:) S 
1920 3800 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( device-type-specific) S 60 J ( time-out) S 60 J ( value) S 
1920 4120 P () S 224 J ( ) S 256 J ( The) S 60 J ( class) S 60 J ( driver) S 60 J ( can) S 60 J ( pass) S 60 J ( the) S 60 J ( time-out) S 60 J ( value) S 60 J ( in) S 60 J ( SRBs) S 60 J ( it) S 60 J ( sends) S 60 J ( to) S 60 J ( the) S 60 J ( port) S 60 J ( driver,) S 60 J ( which) S 
2400 4380 P (optionally) S 60 J ( times) S 60 J ( requests) S 60 J ( on) S 60 J ( behalf) S 60 J ( of) S 60 J ( each) S 60 J ( class) S 60 J ( driver.) S 60 J ( The) S 60 J ( port) S 60 J ( driver) S 60 J ( returns) S 60 J ( an) S 60 J ( SRB) S 
2400 4640 P (with) S 60 J ( its) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( set) S 60 J ( to) S 60 J ( SRB_STATUS_TIMEOUT) S 60 J ( if) S 60 J ( the) S 60 J ( interval) S 60 J ( between) S 60 J ( when) S 
2400 4900 P (the) S 60 J ( port) S 60 J ( driver) S 60 J ( sends) S 60 J ( the) S 60 J ( request) S 60 J ( to) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( and) S 60 J ( when) S 60 J ( the) S 60 J ( request) S 60 J ( completes) S 
2400 5160 P (exceeds) S 60 J ( the) S 60 J ( specified) S 60 J ( time-out) S 60 J ( value.) S 
1920 5480 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( class) S 60 J ( driver's) S 60 J ( error-handling) S 60 J ( routine) S 
1920 5800 P () S 224 J ( ) S 256 J ( See) S 60 J ( Section) S 60 J ( B.1.3) S 60 J ( for) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( error-handling) S 60 J ( in) S 60 J ( class) S 60 J ( drivers.) S 
1920 6120 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( count) S 60 J ( that) S 60 J ( the) S 60 J ( driver) S 60 J ( maintains) S 60 J ( of) S 60 J ( SCSI) S 60 J ( protocol) S 60 J ( errors) S 60 J ( on) S 60 J ( the) S 60 J ( device) S 
1920 6440 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( The) S 60 J ( ) S 0 12 F 24 12 F B (PathId) S E 0 12 F 24 12 F () S 60 J ( value) S 
1920 6760 P () S 224 J ( ) S 256 J ( This) S 60 J ( identifies) S 60 J ( the) S 60 J ( SCSI) S 60 J ( bus) S 60 J ( on) S 60 J ( which) S 60 J ( the) S 60 J ( device) S 60 J ( is) S 60 J ( attached) S 60 J ( and) S 60 J ( is) S 60 J ( a) S 60 J ( required) S 60 J ( value) S 60 J ( in) S 
2400 7020 P (SRBs.) S 
1920 7340 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( The) S 60 J ( ) S 0 12 F 24 12 F B (TargetId) S E 0 12 F 24 12 F () S 60 J ( value) S 
1920 7660 P () S 224 J ( ) S 256 J ( This) S 60 J ( identifies) S 60 J ( the) S 60 J ( TID) S 60 J ( and) S 60 J ( is) S 60 J ( a) S 60 J ( required) S 60 J ( value) S 60 J ( in) S 60 J ( SRBs.) S 
1920 7980 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( The) S 60 J ( ) S 0 12 F 24 12 F B (Lun) S E 0 12 F 24 12 F () S 60 J ( value) S 
1920 8300 P () S 224 J ( ) S 256 J ( This) S 60 J ( identifies) S 60 J ( the) S 60 J ( logical) S 60 J ( unit) S 60 J ( for) S 60 J ( the) S 60 J ( device) S 60 J ( and) S 60 J ( is) S 60 J ( a) S 60 J ( required) S 60 J ( value) S 60 J ( in) S 60 J ( SRBs.) S 
1920 8620 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( pointer) S 60 J ( to) S 60 J ( a) S 60 J ( driver-allocated) S 60 J ( buffer) S 60 J ( for) S 60 J ( SCSI) S 60 J ( request-sense) S 60 J ( data) S 
2400 8940 P (A) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( allocate) S 60 J ( memory) S 60 J ( for) S 60 J ( returned) S 60 J ( request-sense) S 60 J ( data) S 60 J ( from) S 60 J ( cache-aligned,) S 
2400 9200 P (nonpaged) S 60 J ( pool.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( allocating) S 60 J ( memory) S 60 J ( for) S 60 J ( driver) S 60 J ( buffers,) S 60 J ( see) S 
2400 9460 P (Chapter) S 60 J ( 16.) S 
1920 9780 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( driver-determined) S 60 J ( default) S 60 J ( value) S 60 J ( for) S 60 J ( ) S 0 12 F 24 12 F B (SrbFlags) S E 0 12 F 24 12 F () S 60 J ( that) S 60 J ( the) S 60 J ( driver) S 60 J ( sets) S 60 J ( in) S 60 J ( SRBs) S 
1920 10100 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( pointer) S 60 J ( to) S 60 J ( a) S 60 J ( zone) S 60 J ( header) S 60 J ( if) S 60 J ( the) S 60 J ( driver) S 60 J ( sets) S 60 J ( up) S 60 J ( a) S 60 J ( zone) S 60 J ( buffer) S 60 J ( for) S 60 J ( the) S 60 J ( SRBs) S 60 J ( it) S 60 J ( allocates) S 
1920 10420 P () S 224 J ( ) S 256 J ( If) S 60 J ( the) S 60 J ( driver) S 60 J ( calls) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (ExInterlocked..Zone) S E 0 12 F 24 12 F () S 60 J ( routines) S 60 J ( for) S 60 J ( its) S 60 J ( SRBs,) S 60 J ( it) S 60 J ( also) S 60 J ( must) S 60 J ( provide) S 
2400 10680 P (storage) S 60 J ( for) S 60 J ( and) S 60 J ( initialize) S 60 J ( a) S 60 J ( spin) S 60 J ( lock) S 60 J ( that) S 60 J ( protects) S 60 J ( the) S 60 J ( zone's) S 60 J ( free) S 60 J ( list.) S 60 J ( For) S 60 J ( more) S 
2400 10940 P (information) S 60 J ( about) S 60 J ( using) S 60 J ( zones) S 60 J ( and) S 60 J ( spin) S 60 J ( locks,) S 60 J ( see) S 60 J ( Chapter) S 60 J ( 16.) S 
1920 11260 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( spin) S 60 J ( lock) S 60 J ( used) S 60 J ( to) S 60 J ( guarantee) S 60 J ( multiprocessor-safe) S 60 J ( access) S 60 J ( to) S 60 J ( a) S 60 J ( count) S 60 J ( of) S 60 J ( driver-allocated) S 
2400 11520 P (IRPs) S 60 J ( for) S 60 J ( partial) S 60 J ( transfer) S 60 J ( requests) S 
1920 11840 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( IO_SCSI_CAPABILITIES-type) S 60 J ( data) S 60 J ( that) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( collected) S 60 J ( from) S 
2400 12100 P (the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( of) S 60 J ( the) S 60 J ( HBA) S 
1920 12420 P () S 224 J ( ) S 256 J ( How) S 60 J ( class) S 60 J ( drivers) S 60 J ( get) S 60 J ( and) S 60 J ( use) S 60 J ( this) S 60 J ( data) S 60 J ( is) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.1.1.4,) S 60 J ( next.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (6) S E B () S 1003 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2060 P 0 12 F 24 12 F (Note) S 60 J ( that) S 60 J ( the) S 60 J ( class) S 60 J ( driver's) S 60 J ( original) S 60 J ( call) S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (IoGetDeviceObjectPointer) S E 0 12 F 24 12 F () S 60 J ( creates) S 60 J ( a) S 60 J ( reference) S 60 J ( to) S 
1200 2320 P (the) S 60 J ( handle) S 60 J ( of) S 60 J ( the) S 60 J ( file) S 60 J ( object) S 60 J ( associated) S 60 J ( with) S 60 J ( the) S 60 J ( port) S 60 J ( driver's) S 60 J ( generic) S 60 J ( device) S 60 J ( object.) S 60 J ( The) S 60 J ( class) S 
1200 2580 P (driver) S 60 J ( must) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (ObDereferenceObject) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( release) S 60 J ( this) S 60 J ( reference) S 60 J ( after) S 60 J ( the) S 60 J ( driver) S 60 J ( has) S 60 J ( created) S 60 J ( all) S 
1200 2840 P (its) S 60 J ( device) S 60 J ( objects.) S 60 J ( A) S 60 J ( class) S 60 J ( driver) S 60 J ( cannot) S 60 J ( send) S 60 J ( requests) S 60 J ( through) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( to) S 60 J ( its) S 60 J ( device) S 
1200 3100 P (without) S 60 J ( using) S 60 J ( the) S 60 J ( port) S 60 J ( driver's) S 60 J ( HBA-specific) S 60 J ( device) S 60 J ( object) S 60 J ( pointer) S 60 J ( that) S 60 J ( was) S 60 J ( stored) S 60 J ( in) S 60 J ( the) S 
1200 3360 P (device) S 60 J ( extension) S 60 J ( by) S 60 J ( the) S 60 J ( ClaimDevice) S 60 J ( routine.) S 
1200 3880 P 0 12 F 8 12 F B (B.1.1.4) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( GetCapabilities) S 67 J ( Routines) S E 
1200 4500 P 0 12 F 24 12 F (For) S 60 J ( data) S 60 J ( transfer) S 60 J ( operations,) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( need) S 60 J ( configuration) S 60 J ( information) S 60 J ( about) S 60 J ( each) S 
1200 4760 P (HBA) S 60 J ( driving) S 60 J ( a) S 60 J ( bus) S 60 J ( to) S 60 J ( which) S 60 J ( their) S 60 J ( devices) S 60 J ( are) S 60 J ( attached.) S 60 J ( Consequently,) S 60 J ( a) S 60 J ( class) S 60 J ( driver) S 60 J ( either) S 
1200 5020 P (calls) S 60 J ( a) S 60 J ( GetCapabilities) S 60 J ( routine) S 60 J ( or) S 60 J ( implements) S 60 J ( the) S 60 J ( same) S 60 J ( functionality) S 60 J ( in) S 60 J ( the) S 60 J ( DriverEntry) S 
1200 5280 P (routine.) S 
1200 5660 P (A) S 60 J ( GetCapabilities) S 60 J ( routine) S 60 J ( builds) S 60 J ( and) S 60 J ( sets) S 60 J ( up) S 60 J ( an) S 60 J ( IRP_MJ_DEVICE_CONTROL) S 60 J ( request) S 60 J ( with) S 
1200 5920 P (the) S 60 J ( I/O) S 60 J ( control) S 60 J ( code) S 60 J ( IOCTL_SCSI_GET_CAPABILITIES) S 60 J ( for) S 60 J ( the) S 60 J ( port) S 60 J ( driver.) S 60 J ( The) S 60 J ( class) S 60 J ( driver) S 
1200 6180 P (inspects) S 60 J ( the) S 60 J ( returned) S 60 J ( IO_SCSI_CAPABILITIES-type) S 60 J ( information) S 60 J ( to) S 60 J ( determine) S 60 J ( the) S 60 J ( following:) S 
1200 6500 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( The) S 60 J ( maximum) S 60 J ( number) S 60 J ( of) S 60 J ( bytes) S 60 J ( a) S 60 J ( particular) S 60 J ( HBA) S 60 J ( can) S 60 J ( transfer) S 60 J ( in) S 60 J ( a) S 60 J ( single) S 60 J ( operation) S 
1200 6820 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( If) S 60 J ( the) S 60 J ( HBA) S 60 J ( can) S 60 J ( transfer) S 60 J ( buffered) S 60 J ( data) S 60 J ( backed) S 60 J ( by) S 60 J ( discontiguous) S 60 J ( physical) S 60 J ( pages,) S 60 J ( how) S 60 J ( many) S 
1680 7080 P (discontiguities) S 60 J ( per) S 60 J ( buffer) S 60 J ( it) S 60 J ( can) S 60 J ( manage) S 
1200 7400 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( The) S 60 J ( HBA's) S 60 J ( alignment) S 60 J ( requirements) S 60 J ( for) S 60 J ( transfers) S 60 J ( so) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( can) S 60 J ( properly) S 60 J ( set) S 60 J ( the) S 
1680 7660 P 0 12 F 24 12 F B (AlignmentRequirement) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( in) S 60 J ( its) S 60 J ( device) S 60 J ( objects) S 60 J ( \(see) S 60 J ( Chapter) S 60 J ( 3\)) S 
1200 7980 P () S 224 J ( ) S 256 J ( Applications) S 60 J ( that) S 60 J ( send) S 60 J ( IOCTL_SCSI_PASS_THROUGH) S 60 J ( requests) S 60 J ( also) S 60 J ( might) S 60 J ( use) S 60 J ( this) S 
1680 8240 P (field.) S 
1200 8560 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Whether) S 60 J ( the) S 60 J ( HBA) S 60 J ( uses) S 60 J ( PIO) S 60 J ( and) S 60 J ( requires) S 60 J ( the) S 60 J ( use) S 60 J ( of) S 60 J ( system-space) S 60 J ( virtual) S 60 J ( addresses) S 
1680 8820 P (mapped) S 60 J ( to) S 60 J ( physical) S 60 J ( memory) S 60 J ( for) S 60 J ( data) S 60 J ( buffers) S 
1200 9140 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( Whether) S 60 J ( the) S 60 J ( HBA) S 60 J ( supports) S 60 J ( SCSI-II) S 60 J ( tagged) S 60 J ( queueing) S 60 J ( and/or) S 60 J ( per-logical-unit) S 60 J ( internal) S 
1680 9400 P (queues) S 60 J ( \() S 0 12 F 24 12 F B (MultipleRequestsPerLu) S E 0 12 F 24 12 F (\)) S 
1200 9720 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Whether) S 60 J ( the) S 60 J ( HBA) S 60 J ( supports) S 60 J ( asynchronous) S 60 J ( event) S 60 J ( notifications) S 
1200 10040 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Whether) S 60 J ( the) S 60 J ( HBA) S 60 J ( scans) S 60 J ( down) S 
1200 10420 P (The) S 60 J ( class) S 60 J ( driver) S 60 J ( should) S 60 J ( store) S 60 J ( this) S 60 J ( information) S 60 J ( so) S 60 J ( the) S 60 J ( class) S 60 J ( driver's) S 60 J ( Dispatch) S 60 J ( routines) S 60 J ( can) S 60 J ( ensure) S 
1200 10680 P (that) S 60 J ( all) S 60 J ( requests) S 60 J ( sent) S 60 J ( to) S 60 J ( the) S 60 J ( NT) S 60 J ( port/miniport) S 60 J ( drivers) S 60 J ( conform) S 60 J ( to) S 60 J ( the) S 60 J ( size,) S 60 J ( alignment,) S 60 J ( and) S 60 J ( PIO) S 
1200 10940 P (requirements) S 60 J ( of) S 60 J ( the) S 60 J ( underlying) S 60 J ( HBA.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( class) S 60 J ( driver) S 60 J ( Dispatch) S 
1200 11200 P (routines,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.1.2,) S 60 J ( next.) S 
1200 11580 P (For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( general) S 60 J ( requirements) S 60 J ( for) S 60 J ( DriverEntry) S 60 J ( routines,) S 60 J ( see) S 60 J ( Chapter) S 60 J ( 5.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 883 J ( B-) S E B (7) S E 
1920 2080 P 0 12 F 8 12 F B (B.1.2) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( Dispatch) S 67 J ( Routines) S E 
1920 2700 P 0 12 F 24 12 F (Class) S 60 J ( driver) S 60 J ( Dispatch) S 60 J ( routines) S 60 J ( for) S 60 J ( IRP_MJ_CREATE) S 60 J ( and) S 60 J ( IRP_MJ_CLOSE) S 60 J ( requests) S 60 J ( usually) S 
1920 2960 P (have) S 60 J ( no) S 60 J ( SCSI-specific) S 60 J ( requirements.) S 60 J ( Most) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( are) S 60 J ( intermediate) S 60 J ( drivers;) S 60 J ( their) S 
1920 3220 P (Dispatch) S 60 J ( routines) S 60 J ( just) S 60 J ( return) S 60 J ( STATUS_SUCCESS) S 60 J ( to) S 60 J ( indicate) S 60 J ( that) S 60 J ( a) S 60 J ( given) S 60 J ( device) S 60 J ( object) S 60 J ( exists) S 
1920 3480 P (so) S 60 J ( that) S 60 J ( higher-level) S 60 J ( drivers) S 60 J ( and,) S 60 J ( indirectly,) S 60 J ( user-mode) S 60 J ( applications) S 60 J ( can) S 60 J ( open) S 60 J ( the) S 60 J ( device) S 60 J ( for) S 60 J ( I/O) S 
1920 3740 P (and) S 60 J ( close) S 60 J ( the) S 60 J ( device) S 60 J ( afterward.) S 
1920 4120 P (A) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( have) S 60 J ( a) S 60 J ( Dispatch) S 60 J ( routine) S 60 J ( for) S 60 J ( IRP_MJ_SHUTDOWN) S 60 J ( requests) S 60 J ( and,) S 60 J ( possibly) S 
1920 4380 P (for) S 60 J ( IRP_MJ_FLUSH_BUFFERS) S 60 J ( requests) S 60 J ( if) S 60 J ( its) S 60 J ( device) S 60 J ( caches) S 60 J ( data) S 60 J ( internally) S 60 J ( or) S 60 J ( if) S 60 J ( its) S 60 J ( device) S 
1920 4640 P (might) S 60 J ( be) S 60 J ( attached) S 60 J ( to) S 60 J ( a) S 60 J ( bus) S 60 J ( driven) S 60 J ( by) S 60 J ( an) S 60 J ( HBA) S 60 J ( that) S 60 J ( caches) S 60 J ( data) S 60 J ( internally.) S 60 J ( To) S 60 J ( maintain) S 60 J ( data) S 
1920 4900 P (integrity,) S 60 J ( such) S 60 J ( a) S 60 J ( cache) S 60 J ( should) S 60 J ( be) S 60 J ( flushed) S 60 J ( to) S 60 J ( the) S 60 J ( device) S 60 J ( before) S 60 J ( the) S 60 J ( system) S 60 J ( is) S 60 J ( shut) S 60 J ( down.) S 
1920 5280 P (For) S 60 J ( all) S 60 J ( requests) S 60 J ( that) S 60 J ( require) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( to) S 60 J ( execute) S 60 J ( a) S 60 J ( request) S 60 J ( on) S 60 J ( the) S 60 J ( SCSI) S 60 J ( bus,) S 60 J ( the) S 60 J ( class) S 
1920 5540 P (driver) S 60 J ( must) S 60 J ( set) S 60 J ( up) S 60 J ( an) S 60 J ( IRP) S 60 J ( with) S 60 J ( an) S 60 J ( SRB) S 60 J ( containing) S 60 J ( a) S 60 J ( CDB.) S 60 J ( Consequently,) S 60 J ( most) S 60 J ( class) S 60 J ( drivers) S 
1920 5800 P (have) S 60 J ( one) S 60 J ( or) S 60 J ( more) S 60 J ( internal) S 60 J ( routines) S 60 J ( to) S 60 J ( build) S 60 J ( SRBs.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( BuildSrb) S 
1920 6060 P (routines,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.1.2.1.) S 
1920 6440 P (Note) S 60 J ( that) S 60 J ( a) S 60 J ( class) S 60 J ( driver) S 60 J ( does) S 60 J ( not) S 60 J ( necessarily) S 60 J ( set) S 60 J ( up) S 60 J ( an) S 60 J ( SRB) S 60 J ( when) S 60 J ( it) S 60 J ( sets) S 60 J ( up) S 60 J ( an) S 
1920 6700 P (IRP_MJ_DEVICE_CONTROL) S 60 J ( request) S 60 J ( for) S 60 J ( an) S 60 J ( I/O) S 60 J ( control) S 60 J ( code) S 60 J ( supported) S 60 J ( by) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 
1920 6960 P (driver,) S 60 J ( such) S 60 J ( as) S 60 J ( SCSI_IOCTL_GET_CAPABILITIES) S 60 J ( or) S 60 J ( SCSI_IOCTL_PASS_THROUGH.) S 
1920 7220 P (The) S 60 J ( class) S 60 J ( driver's) S 60 J ( DispatchDeviceControl) S 60 J ( routine) S 60 J ( is) S 60 J ( responsible) S 60 J ( for) S 60 J ( the) S 60 J ( following) S 60 J ( on) S 60 J ( receipt) S 60 J ( of) S 
1920 7480 P (a) S 60 J ( SCSI_IOCTL_PASS_THROUGH) S 60 J ( request:) S 
1920 7800 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Checking) S 60 J ( that) S 60 J ( the) S 60 J ( length) S 60 J ( of) S 60 J ( the) S 60 J ( user) S 60 J ( buffer) S 60 J ( at) S 
2400 8060 P 0 12 F 24 12 F B (Parameters.DeviceIoControl.InputBufferLength) S E 0 12 F 24 12 F () S 60 J ( is) S 60 J ( at) S 60 J ( least) S 
2400 8320 P 0 12 F 24 12 F B (sizeof) S E 0 12 F 24 12 F (\(SCSI_PASS_THROUGH\)) S 60 J ( and) S 60 J ( failing) S 60 J ( the) S 60 J ( IRP) S 60 J ( with) S 
2400 8580 P (STATUS_INVALID_PARAMETER) S 60 J ( if) S 60 J ( is) S 60 J ( not) S 
1920 8900 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Ensuring) S 60 J ( that) S 60 J ( certain) S 60 J ( fields) S 60 J ( in) S 60 J ( the) S 60 J ( SCSI_PASS_THROUGH) S 60 J ( structure) S 60 J ( contain) S 60 J ( correct) S 
2400 9160 P (values) S 60 J ( by) S 60 J ( setting) S 60 J ( the) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( structure) S 60 J ( itself) S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (Irp->AssociatedIrp.SystemBuffer) S E 0 12 F 24 12 F (,) S 
2400 9420 P (and) S 60 J ( setting) S 60 J ( its) S 60 J ( ) S 0 12 F 24 12 F B (PathId) S E 0 12 F 24 12 F (,) S 60 J ( ) S 0 12 F 24 12 F B (TargetId) S E 0 12 F 24 12 F (,) S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (Lun) S E 0 12 F 24 12 F () S 60 J ( fields) S 60 J ( to) S 60 J ( the) S 60 J ( corresponding) S 60 J ( values) S 60 J ( from) S 60 J ( the) S 
2400 9680 P (driver's) S 60 J ( device) S 60 J ( extension) S 
1920 10000 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Setting) S 60 J ( up) S 60 J ( the) S 60 J ( port) S 60 J ( driver's) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 60 J ( as) S 60 J ( usual) S 60 J ( and) S 60 J ( also) S 60 J ( setting) S 60 J ( the) S 
2400 10260 P 0 12 F 24 12 F B (MinorFunction) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( to) S 60 J ( IRP_MN_SCSI_CLASS,) S 60 J ( which) S 60 J ( marks) S 60 J ( the) S 60 J ( request) S 60 J ( as) S 60 J ( having) S 
2400 10520 P (been) S 60 J ( processed) S 60 J ( by) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 
1920 10900 P (If) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver's) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 60 J ( for) S 60 J ( an) S 60 J ( IOCTL_SCSI_PASS_THROUGH) S 60 J ( request) S 
1920 11160 P (does) S 60 J ( not) S 60 J ( have) S 60 J ( its) S 60 J ( ) S 0 12 F 24 12 F B (MinorFunction) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( set) S 60 J ( with) S 60 J ( IRP_MN_SCSI_CLASS,) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 
1920 11420 P (assumes) S 60 J ( the) S 60 J ( request) S 60 J ( came) S 60 J ( directly) S 60 J ( from) S 60 J ( an) S 60 J ( application) S 60 J ( and) S 60 J ( that) S 60 J ( no) S 60 J ( class) S 60 J ( driver) S 60 J ( exists) S 60 J ( for) S 60 J ( the) S 
1920 11680 P (target) S 60 J ( device) S 60 J ( type.) S 60 J ( It) S 60 J ( is) S 60 J ( an) S 60 J ( application) S 60 J ( error) S 60 J ( to) S 60 J ( send) S 60 J ( such) S 60 J ( a) S 60 J ( request) S 60 J ( directly) S 60 J ( to) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 
1920 11940 P (for) S 60 J ( a) S 60 J ( device) S 60 J ( that) S 60 J ( has) S 60 J ( been) S 60 J ( claimed) S 60 J ( by) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (8) S E B () S 1003 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2060 P 0 12 F 24 12 F (SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( also) S 60 J ( pass) S 60 J ( on) S 60 J ( IRP_MJ_INTERNAL_DEVICE_CONTROL) S 60 J ( requests) S 60 J ( to) S 60 J ( the) S 
1200 2320 P (NT) S 60 J ( port) S 60 J ( driver.) S 60 J ( Such) S 60 J ( a) S 60 J ( request) S 60 J ( can) S 60 J ( originate) S 60 J ( from) S 60 J ( a) S 60 J ( SCSI) S 60 J ( filter) S 60 J ( driver,) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 
1200 2580 P (B.2.) S 60 J ( As) S 60 J ( for) S 60 J ( IOCTL_SCSI_PASS_THROUGH) S 60 J ( requests,) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( is) S 60 J ( responsible) S 60 J ( for) S 
1200 2840 P (setting) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (PathId) S E 0 12 F 24 12 F (,) S 60 J ( ) S 0 12 F 24 12 F B (TargetId) S E 0 12 F 24 12 F (,) S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (Lun) S E 0 12 F 24 12 F () S 60 J ( fields) S 60 J ( in) S 60 J ( the) S 60 J ( SRB,) S 60 J ( and) S 60 J ( setting) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (MinorFunction) S E 
1200 3100 P 0 12 F 24 12 F (code) S 60 J ( to) S 60 J ( IRP_MN_SCSI_CLASS) S 60 J ( in) S 60 J ( the) S 60 J ( port) S 60 J ( driver's) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 60 J ( before) S 60 J ( passing) S 60 J ( the) S 60 J ( IRP) S 
1200 3360 P (on) S 60 J ( to) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver.) S 
1200 3740 P (Every) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( is) S 60 J ( responsible) S 60 J ( for) S 60 J ( splitting) S 60 J ( up) S 60 J ( transfer) S 60 J ( \(IRP_MJ_READ) S 60 J ( and/or) S 
1200 4000 P (IRP_MJ_WRITE\)) S 60 J ( requests) S 60 J ( that) S 60 J ( exceed) S 60 J ( the) S 60 J ( HBA's) S 60 J ( capabilities.) S 60 J ( Consequently,) S 60 J ( most) S 60 J ( class) S 
1200 4260 P (drivers) S 60 J ( also) S 60 J ( call) S 60 J ( an) S 60 J ( internal) S 60 J ( SplitTransferRequest) S 60 J ( routine,) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.1.2.2,) S 60 J ( or) S 
1200 4520 P (implement) S 60 J ( the) S 60 J ( same) S 60 J ( functionality) S 60 J ( in) S 60 J ( their) S 60 J ( Dispatch) S 60 J ( routine\(s\)) S 60 J ( for) S 60 J ( read) S 60 J ( and) S 60 J ( write) S 60 J ( requests.) S 
1200 4900 P (While) S 60 J ( it) S 60 J ( is) S 60 J ( possible) S 60 J ( for) S 60 J ( a) S 60 J ( class) S 60 J ( driver) S 60 J ( to) S 60 J ( set) S 60 J ( up) S 60 J ( internal) S 60 J ( queues) S 60 J ( for) S 60 J ( IRPs,) S 60 J ( it) S 60 J ( is) S 60 J ( seldom) S 60 J ( necessary) S 
1200 5160 P (to) S 60 J ( do) S 60 J ( so) S 60 J ( and) S 60 J ( likely) S 60 J ( to) S 60 J ( degrade) S 60 J ( the) S 60 J ( driver's) S 60 J ( performance) S 60 J ( as) S 60 J ( well.) S 60 J ( As) S 60 J ( mentioned) S 60 J ( in) S 60 J ( Chapter) S 60 J ( 3,) S 60 J ( the) S 
1200 5420 P (NT) S 60 J ( SCSI) S 60 J ( port) S 60 J ( driver) S 60 J ( sets) S 60 J ( up) S 60 J ( and) S 60 J ( maintains) S 60 J ( LU-specific) S 60 J ( device) S 60 J ( queues) S 60 J ( for) S 60 J ( IRPs.) S 60 J ( Whether) S 60 J ( a) S 
1200 5680 P (particular) S 60 J ( HBA) S 60 J ( supports) S 60 J ( SCSI-II) S 60 J ( tagged) S 60 J ( queueing) S 60 J ( or) S 60 J ( not,) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( can) S 60 J ( send) S 60 J ( every) S 
1200 5940 P (request) S 60 J ( to) S 60 J ( their) S 60 J ( devices) S 60 J ( as) S 60 J ( each) S 60 J ( IRP) S 60 J ( comes) S 60 J ( in) S 60 J ( and) S 60 J ( rely) S 60 J ( on) S 60 J ( the) S 60 J ( NT-supplied) S 60 J ( port) S 60 J ( driver) S 60 J ( or) S 60 J ( the) S 
1200 6200 P (HBA) S 60 J ( to) S 60 J ( handle) S 60 J ( queued) S 60 J ( requests) S 60 J ( expeditiously.) S 
1200 6580 P (If) S 60 J ( an) S 60 J ( HBA) S 60 J ( supports) S 60 J ( tagged) S 60 J ( queueing,) S 60 J ( as) S 60 J ( indicated) S 60 J ( in) S 60 J ( the) S 60 J ( IO_SCSI_CAPABILITIES) S 60 J ( data,) S 60 J ( the) S 
1200 6840 P (class) S 60 J ( driver) S 60 J ( uses) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (QueueAction) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( of) S 60 J ( the) S 60 J ( SRBs) S 60 J ( it) S 60 J ( creates) S 60 J ( to) S 60 J ( control) S 60 J ( how) S 60 J ( its) S 60 J ( requests) S 60 J ( are) S 
1200 7100 P (queued.) S 
1200 7480 P (When) S 60 J ( certain) S 60 J ( SCSI) S 60 J ( errors) S 60 J ( occur,) S 60 J ( the) S 60 J ( queue) S 60 J ( for) S 60 J ( a) S 60 J ( particular) S 60 J ( logical) S 60 J ( unit) S 60 J ( is) S 60 J ( frozen.) S 60 J ( For) S 60 J ( more) S 
1200 7740 P (information) S 60 J ( about) S 60 J ( handling) S 60 J ( errors) S 60 J ( and) S 60 J ( releasing) S 60 J ( frozen) S 60 J ( request) S 60 J ( queues,) S 60 J ( see) S 60 J ( Sections) S 60 J ( B.1.3.1) S 
1200 8000 P (and) S 60 J ( B.1.3.3.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( general) S 60 J ( requirements) S 60 J ( for) S 60 J ( Dispatch) S 60 J ( routines,) S 60 J ( see) S 
1200 8260 P (Chapter) S 60 J ( 6.) S 
1200 8780 P 0 12 F 8 12 F B (B.1.2.1) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( BuildSrb) S 67 J ( Routines) S E 
1200 9400 P 0 12 F 24 12 F (Like) S 60 J ( all) S 60 J ( higher-level) S 60 J ( NT) S 60 J ( drivers,) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( set) S 60 J ( up) S 60 J ( the) S 60 J ( IRP) S 60 J ( stack) S 60 J ( location) S 60 J ( for) S 60 J ( the) S 
1200 9660 P (next-lower-level) S 60 J ( driver.) S 60 J ( In) S 60 J ( IRPs) S 60 J ( that) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( sets) S 60 J ( up) S 60 J ( with) S 60 J ( SRBs) S 60 J ( for) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver,) S 
1200 9920 P (the) S 60 J ( port) S 60 J ( driver's) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 60 J ( is) S 60 J ( set) S 60 J ( with) S 60 J ( the) S 60 J ( following:) S 
1200 10240 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( IRP_MJ_SCSI) S 60 J ( is) S 60 J ( the) S 60 J ( major) S 60 J ( function) S 60 J ( code.) S 
1200 10560 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (Parameters.Scsi.Srb) S E 0 12 F 24 12 F () S 60 J ( contains) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( SRB.) S 
1200 10940 P (Each) S 60 J ( class) S 60 J ( driver) S 60 J ( is) S 60 J ( responsible) S 60 J ( for) S 60 J ( allocating) S 60 J ( memory) S 60 J ( for) S 60 J ( SRBs) S 60 J ( as) S 60 J ( well) S 60 J ( as) S 60 J ( setting) S 60 J ( them) S 60 J ( up) S 
1200 11200 P (with) S 60 J ( CDBs) S 60 J ( for) S 60 J ( the) S 60 J ( paired) S 60 J ( NT) S 60 J ( port) S 60 J ( and) S 60 J ( HBA) S 60 J ( miniport) S 60 J ( drivers.) S 60 J ( The) S 60 J ( class) S 60 J ( driver) S 60 J ( can) S 60 J ( either) S 60 J ( call) S 
1200 11460 P 0 12 F 24 12 F B (ExAllocatePool) S E 0 12 F 24 12 F () S 60 J ( for) S 60 J ( nonpaged) S 60 J ( memory) S 60 J ( or) S 60 J ( can) S 60 J ( set) S 60 J ( up) S 60 J ( a) S 60 J ( resident) S 60 J ( zone) S 60 J ( buffer) S 60 J ( for) S 60 J ( its) S 60 J ( SRBs.) S 60 J ( For) S 
1200 11720 P (more) S 60 J ( information) S 60 J ( about) S 60 J ( using) S 60 J ( nonpaged) S 60 J ( pool) S 60 J ( and) S 60 J ( zones,) S 60 J ( see) S 60 J ( Chapter) S 60 J ( 16.) S 60 J ( Note) S 60 J ( that) S 60 J ( the) S 60 J ( class) S 
1200 11980 P (driver) S 60 J ( is) S 60 J ( also) S 60 J ( responsible) S 60 J ( for) S 60 J ( freeing) S 60 J ( the) S 60 J ( memory) S 60 J ( it) S 60 J ( allocates) S 60 J ( for) S 60 J ( SRBs.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 883 J ( B-) S E B (9) S E 
1920 2060 P 0 12 F 24 12 F (A) S 60 J ( class) S 60 J ( driver's) S 60 J ( BuildSrb) S 60 J ( routine) S 60 J ( must) S 60 J ( set) S 60 J ( appropriate) S 60 J ( values) S 60 J ( in) S 60 J ( the) S 60 J ( SRB) S 60 J ( fields,) S 60 J ( including) S 60 J ( the) S 
1920 2320 P (length) S 60 J ( of) S 60 J ( the) S 60 J ( CDB) S 60 J ( it) S 60 J ( has) S 60 J ( set) S 60 J ( up) S 60 J ( to) S 60 J ( communicate) S 60 J ( with) S 60 J ( its) S 60 J ( device.) S 60 J ( For) S 60 J ( requests) S 60 J ( that) S 60 J ( return) S 
1920 2580 P (request-sense) S 60 J ( information) S 60 J ( and/or) S 60 J ( that) S 60 J ( the) S 60 J ( driver) S 60 J ( might) S 60 J ( need) S 60 J ( to) S 60 J ( retry,) S 60 J ( it) S 60 J ( sets) S 60 J ( an) S 60 J ( IoCompletion) S 
1920 2840 P (routine) S 60 J ( in) S 60 J ( the) S 60 J ( IRP.) S 60 J ( For) S 60 J ( read) S 60 J ( or) S 60 J ( write) S 60 J ( requests,) S 60 J ( it) S 60 J ( ORs) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbFlags) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( appropriate) S 
1920 3100 P (transfer) S 60 J ( direction,) S 60 J ( SRB_FLAGS_DATA_IN) S 60 J ( or) S 60 J ( SRB_FLAGS_DATA_OUT,) S 60 J ( respectively.) S 
1920 3480 P (After) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( has) S 60 J ( loaded,) S 60 J ( it) S 60 J ( sets) S 60 J ( up) S 60 J ( most) S 60 J ( SRBs) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( set) S 60 J ( to) S 
1920 3740 P (SRB_FUNCTION_EXECUTE,) S 60 J ( indicating) S 60 J ( a) S 60 J ( device) S 60 J ( I/O) S 60 J ( request) S 60 J ( to) S 60 J ( be) S 60 J ( sent) S 60 J ( over) S 60 J ( the) S 60 J ( bus.) S 60 J ( A) S 60 J ( class) S 
1920 4000 P (driver) S 60 J ( can) S 60 J ( request) S 60 J ( that) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( perform) S 60 J ( a) S 60 J ( SCSI-II) S 60 J ( request-sense) S 60 J ( operation) S 60 J ( when) S 60 J ( the) S 
1920 4260 P (target) S 60 J ( controller) S 60 J ( returns) S 60 J ( a) S 60 J ( check) S 60 J ( condition.) S 60 J ( To) S 60 J ( do) S 60 J ( this,) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( sets) S 60 J ( up) S 60 J ( the) S 
1920 4520 P 0 12 F 24 12 F B (SenseInfoBuffer) S E 0 12 F 24 12 F () S 60 J ( pointer) S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (SenseInfoBufferLength) S E 0 12 F 24 12 F () S 60 J ( in) S 60 J ( the) S 60 J ( SRB,) S 60 J ( so) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( can) S 
1920 4780 P (return) S 60 J ( the) S 60 J ( request-sense) S 60 J ( information) S 60 J ( if) S 60 J ( a) S 60 J ( check) S 60 J ( condition) S 60 J ( occurs,) S 60 J ( which) S 60 J ( it) S 60 J ( indicates) S 60 J ( in) S 60 J ( the) S 
1920 5040 P 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( with) S 60 J ( SRB_STATUS_AUTOSENSE_VALID) S 60 J ( when) S 60 J ( it) S 60 J ( returns) S 60 J ( the) S 60 J ( IRP.) S 60 J ( For) S 
1920 5300 P (more) S 60 J ( information) S 60 J ( about) S 60 J ( InterpretRequestSense) S 60 J ( routines,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.1.3.1.) S 
1920 5680 P (SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( are) S 60 J ( responsible) S 60 J ( for) S 60 J ( retrying) S 60 J ( requests) S 60 J ( that) S 60 J ( fail) S 60 J ( due) S 60 J ( to) S 60 J ( target) S 60 J ( controller) S 60 J ( errors,) S 
1920 5940 P (bus) S 60 J ( resets,) S 60 J ( or) S 60 J ( request) S 60 J ( time-outs,) S 60 J ( so) S 60 J ( many) S 60 J ( class) S 60 J ( drivers) S 60 J ( maintain) S 60 J ( a) S 60 J ( retry) S 60 J ( count) S 60 J ( in) S 60 J ( their) S 60 J ( own) S 60 J ( I/O) S 
1920 6200 P (stack) S 60 J ( location) S 60 J ( of) S 60 J ( the) S 60 J ( IRP.) S 60 J ( Such) S 60 J ( a) S 60 J ( class) S 60 J ( driver's) S 60 J ( BuildSrb) S 60 J ( routine) S 60 J ( also) S 60 J ( might) S 60 J ( initialize) S 60 J ( the) S 60 J ( retry) S 
1920 6460 P (limit) S 60 J ( for) S 60 J ( a) S 60 J ( given) S 60 J ( request) S 60 J ( before) S 60 J ( it) S 60 J ( sends) S 60 J ( the) S 60 J ( IRP) S 60 J ( to) S 60 J ( the) S 60 J ( port) S 60 J ( driver.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 
1920 6720 P (RetryRequest) S 60 J ( routines,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.1.3.2.) S 
1920 7100 P (A) S 60 J ( BuildSrb) S 60 J ( routine) S 60 J ( might) S 60 J ( split) S 60 J ( the) S 60 J ( responsibility) S 60 J ( for) S 60 J ( setting) S 60 J ( up) S 60 J ( an) S 60 J ( SRB) S 60 J ( with) S 60 J ( a) S 60 J ( pair) S 60 J ( of) S 
1920 7360 P (SendSrbSynchronous) S 60 J ( and) S 60 J ( SendSrbAsynchronous) S 60 J ( routines.) S 60 J ( That) S 60 J ( is,) S 60 J ( the) S 60 J ( BuildSrb) S 60 J ( routine) S 60 J ( could) S 
1920 7620 P (set) S 60 J ( up) S 60 J ( the) S 60 J ( SRB) S 60 J ( fields) S 60 J ( that) S 60 J ( are) S 60 J ( commonly) S 60 J ( set) S 60 J ( up) S 60 J ( for) S 60 J ( all) S 60 J ( requests,) S 60 J ( while) S 60 J ( the) S 60 J ( SendSrb) S 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines) S 
1920 7880 P (each) S 60 J ( set) S 60 J ( SRB) S 60 J ( values) S 60 J ( pertinent) S 60 J ( only) S 60 J ( to) S 60 J ( each) S 60 J ( type) S 60 J ( of) S 60 J ( SCSI) S 60 J ( request.) S 60 J ( When) S 60 J ( an) S 60 J ( IRP) S 60 J ( is) S 60 J ( passed) S 60 J ( down) S 
1920 8140 P (to) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( from) S 60 J ( a) S 60 J ( SendSrbAsynchronous) S 60 J ( routine,) S 60 J ( the) S 60 J ( IRP) S 60 J ( must) S 60 J ( be) S 60 J ( set) S 60 J ( up) S 60 J ( with) S 60 J ( a) S 60 J ( driver-) S 
1920 8400 P (supplied) S 60 J ( IoCompletion) S 60 J ( routine.) S 
1920 8780 P (For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( the) S 60 J ( system-defined) S 60 J ( SRB) S 60 J ( fields) S 60 J ( and) S 60 J ( their) S 60 J ( values,) S 60 J ( see) S 60 J ( the) S 
1920 9040 P 0 12 F 24 12 F I (Kernel-mode) S 60 J ( Driver) S 60 J ( Reference) S E 0 12 F 24 12 F (.) S 
1920 9560 P 0 12 F 8 12 F B (B.1.2.2) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( SplitTransferRequest) S 67 J ( Routine) S E 
1920 10180 P 0 12 F 24 12 F (The) S 60 J ( IO_SCSI_CAPABILITIES-type) S 60 J ( data) S 60 J ( returned) S 60 J ( to) S 60 J ( the) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( indicates) S 60 J ( the) S 
1920 10440 P (transfer) S 60 J ( capabilities) S 60 J ( of) S 60 J ( a) S 60 J ( given) S 60 J ( HBA) S 60 J ( to) S 60 J ( the) S 60 J ( class) S 60 J ( driver.) S 60 J ( In) S 60 J ( particular,) S 60 J ( this) S 60 J ( data) S 60 J ( indicates) S 60 J ( the) S 
1920 10700 P (HBA's) S 60 J ( ) S 0 12 F 24 12 F B (MaximumTransferLength) S E 0 12 F 24 12 F () S 60 J ( in) S 60 J ( bytes) S 60 J ( and) S 60 J ( the) S 60 J ( HBA's) S 60 J ( ) S 0 12 F 24 12 F B (MaximumPhysicalPages) S E 0 12 F 24 12 F (:) S 60 J ( that) S 60 J ( is,) S 
1920 10960 P (how) S 60 J ( many) S 60 J ( discontiguites) S 60 J ( in) S 60 J ( the) S 60 J ( physical) S 60 J ( memory) S 60 J ( backing) S 60 J ( a) S 60 J ( system) S 60 J ( buffer) S 60 J ( the) S 60 J ( HBA) S 60 J ( can) S 
1920 11220 P (manage.) S 
1920 11600 P (Most) S 60 J ( class) S 60 J ( drivers) S 60 J ( store) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( this) S 60 J ( configuration) S 60 J ( data) S 60 J ( in) S 60 J ( the) S 60 J ( device) S 60 J ( extension) S 60 J ( of) S 60 J ( each) S 
1920 11860 P (device) S 60 J ( object) S 60 J ( because) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( are) S 60 J ( responsible) S 60 J ( for) S 60 J ( splitting) S 60 J ( up) S 60 J ( all) S 60 J ( transfer) S 60 J ( requests) S 
1920 12120 P (that) S 60 J ( exceed) S 60 J ( the) S 60 J ( HBA's) S 60 J ( capability) S 60 J ( to) S 60 J ( transfer) S 60 J ( data.) S 60 J ( In) S 60 J ( other) S 60 J ( words,) S 60 J ( a) S 60 J ( class) S 60 J ( driver's) S 
1920 12380 P (DispatchReadWrite) S 60 J ( routine) S 60 J ( must) S 60 J ( determine) S 60 J ( whether) S 60 J ( each) S 60 J ( IRP) S 60 J ( requests) S 60 J ( a) S 60 J ( transfer) S 60 J ( that) S 60 J ( is) S 60 J ( more) S 
1920 12640 P (than) S 60 J ( the) S 60 J ( HBA) S 60 J ( can) S 60 J ( handle) S 60 J ( in) S 60 J ( a) S 60 J ( single) S 60 J ( operation.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (10) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2060 P 0 12 F 24 12 F (For) S 60 J ( example,) S 60 J ( such) S 60 J ( a) S 60 J ( DispatchReadWrite) S 60 J ( routine) S 60 J ( could) S 60 J ( have) S 60 J ( code) S 60 J ( similar) S 60 J ( to) S 60 J ( the) S 60 J ( following:) S 
1680 2580 P 0 12 F 0 12 F (maxTransferLength) S 144 J ( =) S 
1680 2840 P () S 480 J ( deviceExtension->PortCapabilities->) S 
1680 3100 P () S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( MaximumTransferLength;) S 
1680 3360 P (maxPhysicalPages) S 144 J ( =) S 
1680 3620 P () S 480 J ( deviceExtension->PortCapabilities->) S 
1680 3880 P () S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( MaximumPhysicalPages;) S 
1680 4140 P (currentIrpStack) S 144 J ( =) S 144 J ( IoGetCurrentIrpStackLocation\(Irp\);) S 
1680 4400 P (transferLengthRequested) S 144 J ( =) S 144 J ( currentIrpStack->) S 
1680 4660 P () S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( Parameters.Read.Length;) S 
1680 4920 P () S 480 J ( ) S 480 J ( :) S 336 J ( ) S 480 J ( :) S 
1680 5180 P (//) S 
1680 5440 P (//) S 144 J ( Calculate) S 144 J ( number) S 144 J ( of) S 144 J ( pages) S 144 J ( in) S 144 J ( this) S 144 J ( transfer) S 
1680 5700 P (//) S 
1680 5960 P (transferPages) S 144 J ( =) S 144 J ( ADDRESS_AND_SIZE_TO_SPAN_PAGES\() S 
1680 6220 P () S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( MmGetMdlVirtualAddress\(Irp->MdlAddress\),) S 
1680 6480 P () S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( transferLengthRequested\);) S 
1680 6740 P (//) S 
1680 7000 P (//) S 144 J ( Check) S 144 J ( whether) S 144 J ( requested) S 144 J ( length) S 144 J ( is) S 144 J ( greater) S 144 J ( than) S 144 J ( maximum) S 
1680 7260 P (//) S 144 J ( HBA) S 144 J ( can) S 144 J ( transfer) S 144 J ( in) S 144 J ( a) S 144 J ( single) S 144 J ( operation) S 
1680 7520 P (//) S 
1680 7780 P (if) S 144 J ( \(transferLengthRequested) S 144 J ( >) S 144 J ( maxTransferLength) S 144 J ( ||) S 
1680 8040 P () S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( transferPages) S 144 J ( >) S 144 J ( maxPhysicalPages\)) S 144 J ( {) S 
1680 8300 P () S 480 J ( transferPages) S 144 J ( =) S 144 J ( maxPhysicalPages) S 144 J ( -) S 144 J ( 1;) S 
1680 8560 P () S 480 J ( if) S 144 J ( \(maxTransferLength) S 144 J ( >) S 144 J ( transferPages) S 144 J ( <<) S 144 J ( PAGE_SHIFT\)) S 144 J ( {) S 
1680 8820 P () S 480 J ( ) S 480 J ( maxTransferLength) S 144 J ( =) S 144 J ( transferPages) S 144 J ( <<) S 144 J ( PAGE_SHIFT;) S 
1680 9080 P () S 480 J ( }) S 
1680 9340 P () S 480 J ( IoMarkIrpPending\(Irp\);) S 
1680 9600 P () S 480 J ( SplitTransferRequest\(DeviceObject,) S 
1680 9860 P () S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( Irp,) S 
1680 10120 P () S 144 J ( ) S 336 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( ) S 480 J ( maxTransferLength\);) S 
1680 10380 P () S 480 J ( return) S 144 J ( STATUS_PENDING) S 
1680 10640 P (}) S 
1680 10900 P () S 480 J ( ) S 480 J ( :) S 336 J ( ) S 480 J ( :) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (11) S E 
1920 2060 P 0 12 F 24 12 F (To) S 60 J ( carry) S 60 J ( out) S 60 J ( the) S 60 J ( original) S 60 J ( transfer) S 60 J ( request,) S 60 J ( the) S 60 J ( driver's) S 60 J ( SplitTransferRequest) S 60 J ( routine) S 60 J ( creates) S 60 J ( one) S 
1920 2320 P (or) S 60 J ( more) S 60 J ( IRPs) S 60 J ( to) S 60 J ( handle) S 60 J ( sub-buffers) S 60 J ( that) S 60 J ( are) S 60 J ( sized) S 60 J ( to) S 60 J ( suit) S 60 J ( the) S 60 J ( HBA's) S 60 J ( capabilities.) S 60 J ( For) S 60 J ( each) S 60 J ( such) S 
1920 2580 P (IRP,) S 60 J ( the) S 60 J ( SplitTransferRequest) S 60 J ( routine) S 60 J ( sets) S 60 J ( up) S 60 J ( an) S 60 J ( SRB,) S 60 J ( usually) S 60 J ( by) S 60 J ( calling) S 60 J ( a) S 60 J ( BuildSrb) S 60 J ( routine) S 
1920 2840 P (\(see) S 60 J ( Section) S 60 J ( B.1.2.1\)) S 60 J ( before) S 60 J ( sending) S 60 J ( the) S 60 J ( IRP) S 60 J ( on) S 60 J ( to) S 60 J ( the) S 60 J ( port) S 60 J ( driver.) S 
1920 3220 P (Note) S 60 J ( that) S 60 J ( the) S 60 J ( Dispatch) S 60 J ( routine) S 60 J ( returns) S 60 J ( STATUS_PENDING) S 60 J ( immediately) S 60 J ( after) S 60 J ( a) S 60 J ( call) S 60 J ( to) S 
1920 3480 P (SplitTransferRequest) S 60 J ( with) S 60 J ( the) S 60 J ( original) S 60 J ( IRP.) S 60 J ( To) S 60 J ( track) S 60 J ( each) S 60 J ( piece) S 60 J ( of) S 60 J ( the) S 60 J ( transfer,) S 
1920 3740 P (SplitTransferRequest) S 60 J ( registers) S 60 J ( an) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( for) S 60 J ( each) S 60 J ( driver-allocated) S 60 J ( IRP) S 60 J ( it) S 60 J ( sends) S 
1920 4000 P (down) S 60 J ( to) S 60 J ( the) S 60 J ( port) S 60 J ( driver.) S 60 J ( The) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( maintains) S 60 J ( a) S 60 J ( count) S 60 J ( of) S 60 J ( completed) S 60 J ( partial) S 
1920 4260 P (transfer) S 60 J ( requests) S 60 J ( in) S 60 J ( the) S 60 J ( original) S 60 J ( IRP) S 60 J ( and) S 60 J ( protects) S 60 J ( the) S 60 J ( count) S 60 J ( with) S 60 J ( a) S 60 J ( spin) S 60 J ( lock) S 60 J ( \(see) S 60 J ( Section) S 
1920 4520 P (B.1.1.3\).) S 
1920 4900 P (Note) S 60 J ( that) S 60 J ( such) S 60 J ( an) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( must) S 60 J ( free) S 60 J ( any) S 60 J ( IRPs) S 60 J ( and/or) S 60 J ( SRBs) S 60 J ( the) S 60 J ( driver) S 60 J ( has) S 
1920 5160 P (allocated) S 60 J ( and) S 60 J ( must) S 60 J ( complete) S 60 J ( the) S 60 J ( original) S 60 J ( IRP) S 60 J ( when) S 60 J ( all) S 60 J ( requested) S 60 J ( data) S 60 J ( has) S 60 J ( been) S 60 J ( transferred) S 60 J ( or) S 
1920 5420 P (when) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( has) S 60 J ( exhausted) S 60 J ( retries) S 60 J ( of) S 60 J ( the) S 60 J ( IRP) S 60 J ( and) S 60 J ( must) S 60 J ( fail) S 60 J ( it) S 60 J ( due) S 60 J ( device) S 60 J ( transfer) S 
1920 5680 P (errors.) S 
1920 6320 P 0 12 F 8 12 F B (B.1.3) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( IoCompletion) S 67 J ( Routines) S E 
1920 6940 P 0 12 F 24 12 F (As) S 60 J ( mentioned) S 60 J ( previously) S 60 J ( in) S 60 J ( Section) S 60 J ( B.1.2.1,) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( are) S 60 J ( responsible) S 60 J ( for) S 60 J ( releasing) S 
1920 7200 P (the) S 60 J ( memory) S 60 J ( they) S 60 J ( allocate) S 60 J ( for) S 60 J ( SRBs.) S 60 J ( Like) S 60 J ( any) S 60 J ( other) S 60 J ( higher-level) S 60 J ( NT) S 60 J ( driver,) S 60 J ( they) S 60 J ( are) S 60 J ( also) S 
1920 7460 P (responsible) S 60 J ( for) S 60 J ( releasing) S 60 J ( any) S 60 J ( IRPs) S 60 J ( that) S 60 J ( they) S 60 J ( allocate,) S 60 J ( such) S 60 J ( as) S 60 J ( an) S 60 J ( IRP) S 60 J ( to) S 60 J ( split) S 60 J ( up) S 60 J ( a) S 60 J ( transfer) S 
1920 7720 P (request) S 60 J ( as) S 60 J ( described) S 60 J ( in) S 60 J ( the) S 60 J ( preceding) S 60 J ( section.) S 60 J ( A) S 60 J ( class) S 60 J ( driver's) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( is) S 
1920 7980 P (ultimately) S 60 J ( responsible) S 60 J ( for) S 60 J ( ensuring) S 60 J ( that) S 60 J ( the) S 60 J ( I/O) S 60 J ( status) S 60 J ( block) S 60 J ( is) S 60 J ( set) S 60 J ( and) S 60 J ( completing) S 60 J ( the) S 60 J ( original) S 
1920 8240 P (IRP.) S 60 J ( Note) S 60 J ( that) S 60 J ( completing) S 60 J ( an) S 60 J ( IRP) S 60 J ( can) S 60 J ( include) S 60 J ( translating) S 60 J ( an) S 60 J ( error) S 60 J ( returned) S 60 J ( in) S 60 J ( the) S 60 J ( SRB's) S 
1920 8500 P 0 12 F 24 12 F B (ScsiStatus) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( or) S 60 J ( ) S 0 12 F 24 12 F B (SrbSenseInfoBuffer) S E 0 12 F 24 12 F () S 60 J ( into) S 60 J ( an) S 60 J ( NTSTATUS-type) S 60 J ( value) S 60 J ( and/or) S 60 J ( logging) S 60 J ( an) S 
1920 8760 P (error,) S 60 J ( as) S 60 J ( described) S 60 J ( in) S 60 J ( Chapter) S 60 J ( 16.) S 
1920 9140 P (SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( must) S 60 J ( have) S 60 J ( one) S 60 J ( or) S 60 J ( more) S 60 J ( IoCompletion) S 60 J ( routines,) S 60 J ( unless) S 60 J ( a) S 60 J ( particular) S 60 J ( driver) S 
1920 9400 P (waits) S 60 J ( on) S 60 J ( the) S 60 J ( completion) S 60 J ( of) S 60 J ( every) S 60 J ( IRP) S 60 J ( it) S 60 J ( sends) S 60 J ( to) S 60 J ( the) S 60 J ( port) S 60 J ( driver,) S 60 J ( retries) S 60 J ( requests) S 60 J ( as) S 60 J ( necessary,) S 
1920 9660 P (and) S 60 J ( releases) S 60 J ( memory) S 60 J ( for) S 60 J ( SRBs) S 60 J ( from) S 60 J ( a) S 60 J ( Dispatch) S 60 J ( or) S 60 J ( BuildSrb) S 60 J ( routine.) S 60 J ( Note) S 60 J ( that) S 60 J ( handling) S 60 J ( every) S 
1920 9920 P (IRP) S 60 J ( as) S 60 J ( a) S 60 J ( synchronous) S 60 J ( request) S 60 J ( would) S 60 J ( degrade) S 60 J ( the) S 60 J ( performance) S 60 J ( of) S 60 J ( any) S 60 J ( class) S 60 J ( driver.) S 
1920 10300 P (Furthermore,) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( for) S 60 J ( devices) S 60 J ( that) S 60 J ( might) S 60 J ( hold) S 60 J ( the) S 60 J ( system) S 60 J ( page) S 60 J ( file) S 60 J ( must) S 60 J ( handle) S 
1920 10560 P (all) S 60 J ( transfer) S 60 J ( requests) S 60 J ( asynchronously.) S 60 J ( Such) S 60 J ( a) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( have) S 60 J ( an) S 60 J ( IoCompletion) S 60 J ( routine) S 
1920 10820 P (for) S 60 J ( read/write) S 60 J ( requests.) S 
1920 11200 P (When) S 60 J ( certain) S 60 J ( kinds) S 60 J ( of) S 60 J ( errors) S 60 J ( occur) S 60 J ( in) S 60 J ( processing) S 60 J ( a) S 60 J ( request,) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( freezes) S 60 J ( the) S 
1920 11460 P (request) S 60 J ( queue) S 60 J ( for) S 60 J ( the) S 60 J ( target) S 60 J ( LU.) S 60 J ( Consequently,) S 60 J ( class) S 60 J ( drivers) S 60 J ( usually) S 60 J ( have) S 60 J ( internal) S 60 J ( routines) S 60 J ( to) S 
1920 11720 P (change) S 60 J ( the) S 60 J ( status) S 60 J ( of) S 60 J ( the) S 60 J ( queue) S 60 J ( for) S 60 J ( their) S 60 J ( device) S 60 J ( I/O) S 60 J ( requests.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( class) S 
1920 11980 P (drivers') S 60 J ( ReleaseQueue) S 60 J ( routines,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.1.3.1.) S 
1920 12360 P (If) S 60 J ( the) S 60 J ( driver's) S 60 J ( BuildSrb) S 60 J ( routine) S 60 J ( requested) S 60 J ( that) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( return) S 60 J ( request-sense) S 60 J ( information) S 
1920 12620 P (for) S 60 J ( a) S 60 J ( request,) S 60 J ( its) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( either) S 60 J ( calls) S 60 J ( an) S 60 J ( InterpretRequestSense) S 60 J ( routine) S 60 J ( or) S 
1920 12880 P (implements) S 60 J ( the) S 60 J ( same) S 60 J ( functionality) S 60 J ( inline.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( InterpretRequestSense) S 
1920 13140 P (routines,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.1.3.2.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (12) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2180 P 0 12 F 24 12 F (As) S 60 J ( mentioned) S 60 J ( in) S 60 J ( Section) S 60 J ( B.1.2.1,) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( are) S 60 J ( responsible) S 60 J ( for) S 60 J ( retrying) S 60 J ( requests) S 60 J ( that) S 
1200 2440 P (fail) S 60 J ( due) S 60 J ( to) S 60 J ( target) S 60 J ( controller) S 60 J ( errors,) S 60 J ( bus) S 60 J ( resets,) S 60 J ( or) S 60 J ( request) S 60 J ( time-outs.) S 60 J ( When) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 
1200 2700 P (returns) S 60 J ( a) S 60 J ( particular) S 60 J ( request) S 60 J ( with) S 60 J ( its) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( set) S 60 J ( to) S 60 J ( indicate) S 60 J ( such) S 60 J ( an) S 60 J ( error,) S 60 J ( the) S 60 J ( driver) S 60 J ( can) S 60 J ( call) S 
1200 2960 P (a) S 60 J ( RetryRequest) S 60 J ( routine) S 60 J ( from) S 60 J ( its) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( or,) S 60 J ( possibly,) S 60 J ( from) S 60 J ( the) S 
1200 3220 P (InterpretRequestSense) S 60 J ( routine.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( RetryRequest) S 60 J ( routines,) S 60 J ( see) S 60 J ( Section) S 
1200 3480 P (B.1.3.3.) S 
1200 3860 P (For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( general) S 60 J ( requirements) S 60 J ( for) S 60 J ( IoCompletion) S 60 J ( routines,) S 60 J ( see) S 60 J ( Chapter) S 60 J ( 13.) S 
1200 4380 P 0 12 F 8 12 F B (B.1.3.1) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( ReleaseQueue) S 67 J ( Routines) S E 
1200 5000 P 0 12 F 24 12 F (Unless) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( ORs) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbFlags) S E 0 12 F 24 12 F () S 60 J ( for) S 60 J ( a) S 60 J ( given) S 60 J ( request) S 60 J ( with) S 
1200 5260 P (SRB_FLAGS_NO_QUEUE_FREEZE,) S 60 J ( the) S 60 J ( port) S 60 J ( \(and/or) S 60 J ( miniport\)) S 60 J ( driver) S 60 J ( freezes) S 60 J ( a) S 60 J ( queue) S 60 J ( for) S 60 J ( a) S 
1200 5520 P (given) S 60 J ( logical) S 60 J ( unit) S 60 J ( after) S 60 J ( any) S 60 J ( of) S 60 J ( the) S 60 J ( following:) S 
1200 5840 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( bus) S 60 J ( reset) S 60 J ( occurred) S 60 J ( while) S 60 J ( the) S 60 J ( logical) S 60 J ( unit) S 60 J ( was) S 60 J ( executing) S 60 J ( a) S 60 J ( request.) S 
1200 6160 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( The) S 60 J ( logical) S 60 J ( unit) S 60 J ( returned) S 60 J ( SCSISTAT_CHECK_CONDITION) S 60 J ( or) S 
1680 6420 P (SCSISTAT_COMMAND_TERMINATED,) S 60 J ( which) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( can) S 60 J ( find) S 60 J ( in) S 60 J ( the) S 60 J ( SRB's) S 
1680 6680 P 0 12 F 24 12 F B (ScsiStatus) S E 0 12 F 24 12 F () S 60 J ( field.) S 
1200 7000 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( request) S 60 J ( was) S 60 J ( timed) S 60 J ( out.) S 
1200 7320 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( request) S 60 J ( was) S 60 J ( terminated) S 60 J ( by) S 60 J ( a) S 60 J ( bus) S 60 J ( message) S 60 J ( command) S 60 J ( such) S 60 J ( as) S 60 J ( SCSIMESS_ABORT.) S 
1200 7700 P (The) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( indicates) S 60 J ( that) S 60 J ( the) S 60 J ( queue) S 60 J ( has) S 60 J ( been) S 60 J ( frozen) S 60 J ( by) S 60 J ( returning) S 60 J ( a) S 60 J ( request) S 60 J ( with) S 
1200 7960 P (SRB_STATUS_QUEUE_FROZEN) S 60 J ( in) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( field.) S 60 J ( New) S 60 J ( requests) S 60 J ( from) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 
1200 8220 P (can) S 60 J ( be) S 60 J ( inserted) S 60 J ( into) S 60 J ( the) S 60 J ( queue,) S 60 J ( but) S 60 J ( no) S 60 J ( requests) S 60 J ( are) S 60 J ( sent) S 60 J ( to) S 60 J ( the) S 60 J ( logical) S 60 J ( unit) S 60 J ( except) S 60 J ( autosense) S 
1200 8480 P (requests.) S 60 J ( Freezing) S 60 J ( the) S 60 J ( queue) S 60 J ( under) S 60 J ( these) S 60 J ( conditions) S 60 J ( gives) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( an) S 60 J ( opportunity) S 60 J ( to) S 
1200 8740 P (analyze) S 60 J ( an) S 60 J ( error) S 60 J ( before) S 60 J ( other) S 60 J ( queued) S 60 J ( jobs) S 60 J ( are) S 60 J ( executed.) S 60 J ( For) S 60 J ( example,) S 60 J ( a) S 60 J ( class) S 60 J ( driver) S 60 J ( might) S 60 J ( need) S 
1200 9000 P (to) S 60 J ( reinitialize) S 60 J ( the) S 60 J ( TID) S 60 J ( after) S 60 J ( the) S 60 J ( controller) S 60 J ( has) S 60 J ( been) S 60 J ( reset,) S 60 J ( or) S 60 J ( queued) S 60 J ( jobs) S 60 J ( might) S 60 J ( need) S 60 J ( to) S 60 J ( be) S 
1200 9260 P (cancelled) S 60 J ( if) S 60 J ( the) S 60 J ( media) S 60 J ( has) S 60 J ( changed.) S 60 J ( To) S 60 J ( reinitialize) S 60 J ( a) S 60 J ( TID,) S 60 J ( the) S 60 J ( driver) S 60 J ( can) S 60 J ( send) S 60 J ( a) S 60 J ( request) S 60 J ( with) S 
1200 9520 P (the) S 60 J ( ) S 0 12 F 24 12 F B (SrbFlags) S E 0 12 F 24 12 F () S 60 J ( ORed) S 60 J ( with) S 60 J ( SRB_FLAGS_BYPASS_FROZEN_QUEUE.) S 
1200 9900 P (A) S 60 J ( ReleaseQueue) S 60 J ( routine) S 60 J ( allocates) S 60 J ( and) S 60 J ( sets) S 60 J ( up) S 60 J ( an) S 60 J ( IRP) S 60 J ( and) S 60 J ( an) S 60 J ( SRB) S 60 J ( to) S 60 J ( flush) S 60 J ( or) S 60 J ( release) S 60 J ( a) S 60 J ( frozen) S 
1200 10160 P (queue.) S 60 J ( The) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( of) S 60 J ( the) S 60 J ( SRB) S 60 J ( must) S 60 J ( be) S 60 J ( set) S 60 J ( to) S 60 J ( SRB_FUNCTION_RELEASE_QUEUE) S 
1200 10420 P (or) S 60 J ( SRB_FUNCTION_FLUSH_QUEUE,) S 60 J ( which) S 60 J ( also) S 60 J ( releases) S 60 J ( a) S 60 J ( frozen) S 60 J ( queue) S 60 J ( and) S 60 J ( cancels) S 60 J ( all) S 
1200 10680 P (currently) S 60 J ( queued) S 60 J ( requests.) S 60 J ( The) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( completes) S 60 J ( all) S 60 J ( requests) S 60 J ( in) S 60 J ( a) S 60 J ( flushed) S 60 J ( queue) S 60 J ( with) S 
1200 10940 P (their) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( fields) S 60 J ( set) S 60 J ( to) S 60 J ( SRB_STATUS_FLUSHED.) S 
1200 11320 P (Note) S 60 J ( that) S 60 J ( a) S 60 J ( ReleaseQueue) S 60 J ( routine) S 60 J ( is) S 60 J ( called) S 60 J ( asynchronously,) S 60 J ( generally) S 60 J ( from) S 60 J ( an) S 60 J ( IoCompletion) S 
1200 11580 P (routine.) S 60 J ( A) S 60 J ( class) S 60 J ( driver's) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( cannot) S 60 J ( call) S 60 J ( ReleaseQueue) S 60 J ( to) S 60 J ( flush) S 60 J ( a) S 60 J ( queue) S 60 J ( that) S 
1200 11840 P (is) S 60 J ( not) S 60 J ( frozen.) S 60 J ( However,) S 60 J ( it) S 60 J ( can) S 60 J ( call) S 60 J ( ReleaseQueue) S 60 J ( on) S 60 J ( an) S 60 J ( unfrozen) S 60 J ( queue,) S 60 J ( and) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 
1200 12100 P (simply) S 60 J ( ignores) S 60 J ( such) S 60 J ( a) S 60 J ( request.) S 
1200 12480 P (A) S 60 J ( ReleaseQueue) S 60 J ( routine) S 60 J ( should) S 60 J ( allocate) S 60 J ( memory) S 60 J ( for) S 60 J ( an) S 60 J ( SRB) S 60 J ( by) S 60 J ( calling) S 60 J ( ) S 0 12 F 24 12 F B (ExAllocatePool) S E 0 12 F 24 12 F () S 60 J ( with) S 
1200 12740 P (the) S 60 J ( memory) S 60 J ( type) S 60 J ( ) S 0 12 F 24 12 F B (NonPagedPoolMustSucceed) S E 0 12 F 24 12 F () S 60 J ( since) S 60 J ( failing) S 60 J ( to) S 60 J ( release) S 60 J ( a) S 60 J ( frozen) S 60 J ( queue) S 60 J ( makes) S 
1200 13000 P (the) S 60 J ( device) S 60 J ( inaccessible.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (13) S E 
1920 2080 P 0 12 F 8 12 F B (B.1.3.2) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( InterpretRequestSense) S 67 J ( Routines) S E 
1920 2700 P 0 12 F 24 12 F (An) S 60 J ( InterpretRequestSense) S 60 J ( routine) S 60 J ( interprets) S 60 J ( the) S 60 J ( data) S 60 J ( returned) S 60 J ( in) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbSenseInfoBuffer) S E 0 12 F 24 12 F (,) S 
1920 2960 P (maps) S 60 J ( the) S 60 J ( error) S 60 J ( to) S 60 J ( an) S 60 J ( NTSTATUS) S 60 J ( value) S 60 J ( for) S 60 J ( the) S 60 J ( IRP's) S 60 J ( I/O) S 60 J ( status) S 60 J ( block,) S 60 J ( and) S 60 J ( determines) S 60 J ( whether) S 
1920 3220 P (the) S 60 J ( request) S 60 J ( should) S 60 J ( be) S 60 J ( retried.) S 60 J ( The) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( indicates) S 60 J ( whether) S 60 J ( request-sense) S 60 J ( information) S 
1920 3480 P (is) S 60 J ( available) S 60 J ( by) S 60 J ( setting) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( with) S 60 J ( SRB_STATUS_AUTOSENSE_VALID) S 60 J ( \(or) S 
1920 3740 P (SRB_STATUS_REQUEST_SENSE_FAILED\).) S 
1920 4120 P (If) S 60 J ( no) S 60 J ( request-sense) S 60 J ( information) S 60 J ( is) S 60 J ( available,) S 60 J ( this) S 60 J ( routine) S 60 J ( should) S 60 J ( check) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( value) S 60 J ( to) S 
1920 4380 P (determine) S 60 J ( an) S 60 J ( appropriate) S 60 J ( mapping) S 60 J ( to) S 60 J ( an) S 60 J ( NTSTATUS) S 60 J ( value) S 60 J ( and) S 60 J ( whether) S 60 J ( to) S 60 J ( retry) S 60 J ( a) S 60 J ( given) S 
1920 4640 P (request.) S 60 J ( Note) S 60 J ( that) S 60 J ( an) S 60 J ( InterpretRequestSense) S 60 J ( routine) S 60 J ( might) S 60 J ( call) S 60 J ( a) S 60 J ( driver-supplied) S 60 J ( error-logging) S 
1920 4900 P (routine,) S 60 J ( as) S 60 J ( well.) S 60 J ( When) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( logs) S 60 J ( an) S 60 J ( I/O) S 60 J ( error,) S 60 J ( it) S 60 J ( should) S 60 J ( include) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (PathId) S E 0 12 F 24 12 F (,) S 
1920 5160 P 0 12 F 24 12 F B (TargetId) S E 0 12 F 24 12 F (,) S 60 J ( ) S 0 12 F 24 12 F B (Lun) S E 0 12 F 24 12 F (,) S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( values) S 60 J ( from) S 60 J ( the) S 60 J ( SRB,) S 60 J ( and,) S 60 J ( if) S 60 J ( possible,) S 60 J ( pertinent) S 60 J ( request-sense) S 
1920 5420 P (information) S 60 J ( as) S 60 J ( part) S 60 J ( of) S 60 J ( the) S 60 J ( error) S 60 J ( log) S 60 J ( entry's) S 60 J ( ) S 0 12 F 24 12 F B (DumpData) S E 0 12 F 24 12 F (.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( logging) S 
1920 5680 P (I/O) S 60 J ( errors,) S 60 J ( see) S 60 J ( also) S 60 J ( Chapter) S 60 J ( 16.) S 
1920 6200 P 0 12 F 8 12 F B (B.1.3.3) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( RetryRequest) S 67 J ( Routines) S E 
1920 6820 P 0 12 F 24 12 F (The) S 60 J ( port-miniport) S 60 J ( driver) S 60 J ( pair) S 60 J ( is) S 60 J ( responsible) S 60 J ( for) S 60 J ( retrying) S 60 J ( requests) S 60 J ( if) S 60 J ( certain) S 60 J ( SCSI) S 60 J ( errors) S 60 J ( occur,) S 
1920 7080 P (including) S 60 J ( bus) S 60 J ( parity) S 60 J ( errors,) S 60 J ( selection) S 60 J ( time-outs,) S 60 J ( and) S 60 J ( target) S 60 J ( controller) S 60 J ( busy) S 60 J ( errors.) S 60 J ( If) S 60 J ( their) S 60 J ( retry) S 
1920 7340 P (attempts) S 60 J ( fail,) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( completes) S 60 J ( the) S 60 J ( request) S 60 J ( with) S 60 J ( an) S 60 J ( appropriate) S 60 J ( error) S 60 J ( and) S 60 J ( logs) S 60 J ( the) S 
1920 7600 P (I/O) S 60 J ( error,) S 60 J ( as) S 60 J ( well.) S 60 J ( Class) S 60 J ( drivers) S 60 J ( should) S 60 J ( never) S 60 J ( attempt) S 60 J ( to) S 60 J ( retry) S 60 J ( a) S 60 J ( request) S 60 J ( that) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( has) S 
1920 7860 P (already) S 60 J ( failed) S 60 J ( due) S 60 J ( to) S 60 J ( such) S 60 J ( an) S 60 J ( error.) S 
1920 8240 P (However,) S 60 J ( class) S 60 J ( drivers) S 60 J ( are) S 60 J ( required) S 60 J ( to) S 60 J ( retry) S 60 J ( requests) S 60 J ( that) S 60 J ( fail) S 60 J ( due) S 60 J ( to) S 60 J ( target) S 60 J ( controller) S 60 J ( errors,) S 
1920 8500 P (SCSI) S 60 J ( bus) S 60 J ( resets,) S 60 J ( or) S 60 J ( time-outs.) S 60 J ( In) S 60 J ( general,) S 60 J ( a) S 60 J ( RetryRequest) S 60 J ( routine) S 60 J ( can) S 60 J ( resubmit) S 60 J ( such) S 60 J ( an) S 60 J ( IRP) S 60 J ( to) S 
1920 8760 P (the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( and) S 60 J ( direct) S 60 J ( that) S 60 J ( the) S 60 J ( SRB) S 60 J ( be) S 60 J ( placed) S 60 J ( at) S 60 J ( the) S 60 J ( head) S 60 J ( of) S 60 J ( the) S 60 J ( queue.) S 
1920 9140 P (In) S 60 J ( particular,) S 60 J ( a) S 60 J ( RetryRequest) S 60 J ( routine) S 60 J ( should) S 60 J ( do) S 60 J ( the) S 60 J ( following:) S 
1920 9460 P () S 104 J ( 1) S 256 J ( Ensure) S 60 J ( that) S 60 J ( a) S 60 J ( partial) S 60 J ( transfer) S 60 J ( request) S 60 J ( has) S 60 J ( the) S 60 J ( correct) S 60 J ( values) S 60 J ( set) S 60 J ( for) S 60 J ( the) S 60 J ( starting) S 60 J ( address) S 60 J ( and) S 
2400 9720 P (length.) S 
1920 10040 P () S 104 J ( 2) S 256 J ( Zero) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (ScsiStatus) S E 0 12 F 24 12 F () S 60 J ( fields) S 60 J ( of) S 60 J ( the) S 60 J ( SRB.) S 
1920 10360 P () S 104 J ( 3) S 256 J ( Set) S 60 J ( up) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbFlags) S E 0 12 F 24 12 F () S 60 J ( field,) S 60 J ( as) S 60 J ( necessary) S 60 J ( for) S 60 J ( the) S 60 J ( device.) S 
1920 10680 P () S 104 J ( 4) S 256 J ( Set) S 60 J ( up) S 60 J ( the) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 60 J ( for) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( in) S 60 J ( the) S 60 J ( IRP) S 60 J ( as) S 60 J ( already) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 
2400 10940 P (B.1.2.1.) S 
1920 11260 P () S 104 J ( 5) S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (IoSetCompletionRoutine) S E 0 12 F 24 12 F () S 60 J ( for) S 60 J ( the) S 60 J ( IRP,) S 60 J ( because) S 60 J ( the) S 60 J ( driver's) S 60 J ( IoCompletion) S 60 J ( routine) S 
2400 11520 P (might) S 60 J ( need) S 60 J ( to) S 60 J ( retry) S 60 J ( the) S 60 J ( request) S 60 J ( more) S 60 J ( than) S 60 J ( once.) S 
1920 11840 P () S 104 J ( 6) S 256 J ( Pass) S 60 J ( the) S 60 J ( request) S 60 J ( on) S 60 J ( to) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (IoCallDriver) S E 0 12 F 24 12 F (.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (14) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2080 P 0 12 F 8 12 F B (B.2) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( Designing) S 67 J ( a) S 67 J ( SCSI) S 67 J ( Filter) S 67 J ( Driver) S E 
1200 2700 P 0 12 F 24 12 F (If) S 60 J ( a) S 60 J ( system-supplied) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( already) S 60 J ( exists) S 60 J ( for) S 60 J ( a) S 60 J ( particular) S 60 J ( type) S 60 J ( of) S 60 J ( device,) S 60 J ( it) S 60 J ( might) S 
1200 2960 P (be) S 60 J ( unnecessary) S 60 J ( to) S 60 J ( write) S 60 J ( a) S 60 J ( driver) S 60 J ( for) S 60 J ( a) S 60 J ( new) S 60 J ( device) S 60 J ( of) S 60 J ( the) S 60 J ( same) S 60 J ( type.) S 60 J ( Each) S 60 J ( NT-supplied) S 60 J ( SCSI) S 
1200 3220 P (class) S 60 J ( driver) S 60 J ( was) S 60 J ( designed) S 60 J ( to) S 60 J ( support) S 60 J ( SCSI-II-compliant) S 60 J ( peripheral) S 60 J ( devices) S 60 J ( of) S 60 J ( a) S 60 J ( given) S 60 J ( type) S 60 J ( and) S 
1200 3480 P (was) S 60 J ( tested) S 60 J ( against) S 60 J ( a) S 60 J ( number) S 60 J ( of) S 60 J ( vendors') S 60 J ( devices.) S 60 J ( Thus,) S 60 J ( any) S 60 J ( system-supplied) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 
1200 3740 P (might) S 60 J ( provide) S 60 J ( all) S 60 J ( the) S 60 J ( support) S 60 J ( another) S 60 J ( SCSI-II-compliant) S 60 J ( device) S 60 J ( of) S 60 J ( its) S 60 J ( type) S 60 J ( needs.) S 
1200 4120 P (If) S 60 J ( an) S 60 J ( existing) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( does) S 60 J ( not) S 60 J ( fully) S 60 J ( support) S 60 J ( a) S 60 J ( new) S 60 J ( device) S 60 J ( of) S 60 J ( its) S 60 J ( type,) S 60 J ( a) S 60 J ( new) S 60 J ( driver) S 
1200 4380 P (must) S 60 J ( be) S 60 J ( written) S 60 J ( as) S 60 J ( either) S 60 J ( of) S 60 J ( the) S 60 J ( following:) S 
1200 4700 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( A) S 60 J ( new) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( for) S 60 J ( the) S 60 J ( device,) S 60 J ( which,) S 60 J ( in) S 60 J ( most) S 60 J ( cases,) S 60 J ( is) S 60 J ( also) S 60 J ( unnecessary) S 
1200 5020 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Or,) S 60 J ( an) S 60 J ( SFD) S 60 J ( layered) S 60 J ( over) S 60 J ( an) S 60 J ( existing) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 
1200 5400 P (An) S 60 J ( SFD) S 60 J ( supplies) S 60 J ( device-specific) S 60 J ( support) S 60 J ( for) S 60 J ( requests) S 60 J ( that) S 60 J ( require) S 60 J ( special) S 60 J ( handling,) S 60 J ( such) S 60 J ( as) S 
1200 5660 P (translating) S 60 J ( data) S 60 J ( sent) S 60 J ( to) S 60 J ( or) S 60 J ( returned) S 60 J ( from) S 60 J ( the) S 60 J ( device) S 60 J ( in) S 60 J ( a) S 60 J ( nonstandard) S 60 J ( format,) S 60 J ( or) S 60 J ( programming) S 
1200 5920 P (the) S 60 J ( device) S 60 J ( in) S 60 J ( response) S 60 J ( to) S 60 J ( an) S 60 J ( IRP_MJ_DEVICE_CONTROL) S 60 J ( request.) S 60 J ( Such) S 60 J ( an) S 60 J ( SFD) S 60 J ( can) S 60 J ( let) S 60 J ( the) S 
1200 6180 P (appropriate) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( process) S 60 J ( all) S 60 J ( requests) S 60 J ( that) S 60 J ( require) S 60 J ( no) S 60 J ( special) S 60 J ( handling.) S 60 J ( Unless) S 
1200 6440 P (a) S 60 J ( new) S 60 J ( device) S 60 J ( requires) S 60 J ( that) S 60 J ( every) S 60 J ( request) S 60 J ( be) S 60 J ( handled) S 60 J ( in) S 60 J ( a) S 60 J ( device-specific) S 60 J ( manner,) S 60 J ( writing) S 60 J ( an) S 
1200 6700 P (SFD) S 60 J ( takes) S 60 J ( far) S 60 J ( less) S 60 J ( development) S 60 J ( time) S 60 J ( than) S 60 J ( writing) S 60 J ( a) S 60 J ( new) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver.) S 
1200 7080 P (Like) S 60 J ( any) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver,) S 60 J ( an) S 60 J ( SFD) S 60 J ( is) S 60 J ( a) S 60 J ( standard) S 60 J ( NT) S 60 J ( higher-level) S 60 J ( driver) S 60 J ( with) S 60 J ( the) S 60 J ( following) S 
1200 7340 P (requirements) S 60 J ( common) S 60 J ( to) S 60 J ( all) S 60 J ( higher-level) S 60 J ( drivers:) S 
1200 7660 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( It) S 60 J ( must) S 60 J ( supply) S 60 J ( a) S 60 J ( set) S 60 J ( of) S 60 J ( Dispatch) S 60 J ( routines) S 60 J ( to) S 60 J ( which) S 60 J ( the) S 60 J ( I/O) S 60 J ( Manager) S 60 J ( and/or) S 60 J ( still) S 60 J ( higher-) S 
1680 7920 P (level) S 60 J ( drivers) S 60 J ( can) S 60 J ( send) S 60 J ( IRPs) S 60 J ( for) S 60 J ( appropriate) S 60 J ( I/O) S 60 J ( operations.) S 60 J ( An) S 60 J ( SFD) S 60 J ( must) S 60 J ( support) S 60 J ( the) S 
1680 8180 P (same) S 60 J ( set) S 60 J ( of) S 60 J ( IRP_MJ_) S 0 12 F 24 12 F I (xxx) S E 0 12 F 24 12 F () S 60 J ( as) S 60 J ( the) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( for) S 60 J ( its) S 60 J ( type) S 60 J ( of) S 60 J ( device.) S 
1200 8500 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( For) S 60 J ( IRP_MJ_DEVICE_CONTROL) S 60 J ( requests,) S 60 J ( it) S 60 J ( must) S 60 J ( support) S 60 J ( as) S 60 J ( many) S 60 J ( of) S 60 J ( the) S 60 J ( class-driver-) S 
1680 8760 P (supported) S 60 J ( I/O) S 60 J ( control) S 60 J ( codes) S 60 J ( as) S 60 J ( its) S 60 J ( physical) S 60 J ( device) S 60 J ( can) S 60 J ( handle,) S 60 J ( and,) S 60 J ( if) S 60 J ( possible,) S 60 J ( emulate) S 
1680 9020 P (support) S 60 J ( for) S 60 J ( any) S 60 J ( remaining) S 60 J ( I/O) S 60 J ( control) S 60 J ( codes) S 60 J ( in) S 60 J ( the) S 60 J ( driver.) S 
1200 9340 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( It) S 60 J ( must) S 60 J ( have) S 60 J ( a) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( and) S 60 J ( can) S 60 J ( have) S 60 J ( any) S 60 J ( other) S 60 J ( NT) S 60 J ( standard) S 60 J ( higher-level) S 
1680 9600 P (driver) S 60 J ( routine,) S 60 J ( such) S 60 J ( as) S 60 J ( Unload) S 60 J ( or) S 60 J ( IoCompletion) S 60 J ( routines,) S 60 J ( as) S 60 J ( necessary.) S 
1200 9980 P (If) S 60 J ( its) S 60 J ( device) S 60 J ( has) S 60 J ( special) S 60 J ( features,) S 60 J ( an) S 60 J ( SFD) S 60 J ( can) S 60 J ( support) S 60 J ( a) S 60 J ( set) S 60 J ( of) S 60 J ( driver-defined) S 60 J ( I/O) S 60 J ( control) S 60 J ( codes) S 
1200 10240 P (in) S 60 J ( addition) S 60 J ( to) S 60 J ( the) S 60 J ( required) S 60 J ( set) S 60 J ( of) S 60 J ( device-type-specific) S 60 J ( I/O) S 60 J ( control) S 60 J ( codes) S 60 J ( for) S 
1200 10500 P (IRP_MJ_DEVICE_CONTROL) S 60 J ( requests.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( required) S 60 J ( device-type-) S 
1200 10760 P (specific) S 60 J ( requests,) S 60 J ( including) S 60 J ( the) S 60 J ( IRP_MJ_DEVICE_CONTROL) S 60 J ( request) S 60 J ( and) S 60 J ( I/O) S 60 J ( control) S 60 J ( codes,) S 
1200 11020 P (see) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (Kernel-mode) S 60 J ( Driver) S 60 J ( Reference) S E 0 12 F 24 12 F (.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (15) S E 
1920 2060 P 0 12 F 24 12 F (Depending) S 60 J ( on) S 60 J ( the) S 60 J ( nature) S 60 J ( of) S 60 J ( its) S 60 J ( device,) S 60 J ( an) S 60 J ( SFD) S 60 J ( also) S 60 J ( might) S 60 J ( \(or) S 60 J ( must\)) S 60 J ( be) S 60 J ( responsible) S 60 J ( for) S 60 J ( the) S 
1920 2320 P (following) S 60 J ( SCSI-specific) S 60 J ( functionality:) S 
1920 2640 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Translating) S 60 J ( data) S 60 J ( from) S 60 J ( or) S 60 J ( into) S 60 J ( a) S 60 J ( device-specific) S 60 J ( format) S 60 J ( before) S 60 J ( or) S 60 J ( after) S 60 J ( sending) S 60 J ( a) S 60 J ( transfer) S 
2400 2900 P (request) S 60 J ( to) S 60 J ( lower) S 60 J ( driver\(s\)) S 60 J ( if) S 60 J ( the) S 60 J ( device) S 60 J ( processes) S 60 J ( data) S 60 J ( in) S 60 J ( a) S 60 J ( nonstandard) S 60 J ( format) S 
1920 3220 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Setting) S 60 J ( up) S 60 J ( IRPs) S 60 J ( with) S 60 J ( SRBs) S 60 J ( for) S 60 J ( internal) S 60 J ( device) S 60 J ( control) S 60 J ( or) S 60 J ( pass-through) S 60 J ( requests,) S 60 J ( as) S 
2400 3480 P (necessary) S 60 J ( for) S 60 J ( its) S 60 J ( device) S 60 J ( and) S 60 J ( sending) S 60 J ( those) S 60 J ( IRPs) S 60 J ( through) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( \(see) S 60 J ( Section) S 
2400 3740 P (B.1.2\)) S 60 J ( to) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 
1920 4060 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Establishing) S 60 J ( time-out) S 60 J ( values) S 60 J ( for) S 60 J ( requests) S 
1920 4380 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Supplying) S 60 J ( one) S 60 J ( or) S 60 J ( more) S 60 J ( IoCompletion) S 60 J ( routines) S 60 J ( and,) S 60 J ( like) S 60 J ( the) S 60 J ( class) S 60 J ( driver,) S 60 J ( handling) S 60 J ( certain) S 
2400 4640 P (SCSI) S 60 J ( error) S 60 J ( conditions) S 60 J ( and) S 60 J ( retries) S 60 J ( for) S 60 J ( device-specific) S 60 J ( requests) S 60 J ( that) S 60 J ( require) S 60 J ( special) S 
2400 4900 P (handling) S 
1920 5280 P (In) S 60 J ( general,) S 60 J ( an) S 60 J ( SFD) S 60 J ( has) S 60 J ( the) S 60 J ( same) S 60 J ( responsibilities) S 60 J ( as) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( for) S 60 J ( those) S 60 J ( requests) S 60 J ( that) S 
1920 5540 P (require) S 60 J ( device-specific) S 60 J ( handling.) S 60 J ( For) S 60 J ( a) S 60 J ( discussion) S 60 J ( of) S 60 J ( the) S 60 J ( functionality) S 60 J ( required) S 60 J ( of) S 60 J ( SCSI) S 60 J ( class) S 
1920 5800 P (drivers,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.1.) S 
1920 6180 P (The) S 60 J ( following) S 60 J ( subsections) S 60 J ( describe) S 60 J ( how) S 60 J ( SFDs) S 60 J ( provide) S 60 J ( this) S 60 J ( SCSI-specific) S 60 J ( functionality) S 60 J ( in) S 60 J ( the) S 
1920 6440 P (context) S 60 J ( of) S 60 J ( each) S 60 J ( standard) S 60 J ( routine) S 60 J ( that) S 60 J ( a) S 60 J ( SCSI) S 60 J ( filter) S 60 J ( driver) S 60 J ( commonly) S 60 J ( has.) S 
1920 7080 P 0 12 F 8 12 F B (B.2.1) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( DriverEntry) S 67 J ( Routine) S E 
1920 7700 P 0 12 F 24 12 F (Like) S 60 J ( any) S 60 J ( other) S 60 J ( NT) S 60 J ( driver,) S 60 J ( the) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( of) S 60 J ( an) S 60 J ( SFD) S 60 J ( must) S 60 J ( define) S 60 J ( its) S 60 J ( Dispatch) S 60 J ( \(and) S 
1920 7960 P (Unload,) S 60 J ( if) S 60 J ( any\)) S 60 J ( entry) S 60 J ( points) S 60 J ( in) S 60 J ( the) S 60 J ( input) S 60 J ( driver) S 60 J ( object.) S 60 J ( Then,) S 60 J ( the) S 60 J ( SFD) S 60 J ( must) S 60 J ( create) S 60 J ( one) S 60 J ( or) S 60 J ( more) S 
1920 8220 P (device) S 60 J ( objects) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (IoCreateDevice) S E 0 12 F 24 12 F (,) S 60 J ( layer) S 60 J ( itself) S 60 J ( over) S 60 J ( the) S 60 J ( appropriate) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( with) S 
1920 8480 P 0 12 F 24 12 F B (IoAttachDevice) S E 0 12 F 24 12 F (,) S 60 J ( and) S 60 J ( set) S 60 J ( up) S 60 J ( one) S 60 J ( or) S 60 J ( more) S 60 J ( requests) S 60 J ( to) S 60 J ( find) S 60 J ( its) S 60 J ( device\(s\),) S 60 J ( if) S 60 J ( any,) S 60 J ( on) S 60 J ( a) S 60 J ( SCSI) S 60 J ( bus) S 60 J ( in) S 
1920 8740 P (the) S 60 J ( machine.) S 
1920 9120 P (SFDs) S 60 J ( for) S 60 J ( certain) S 60 J ( kinds) S 60 J ( of) S 60 J ( devices) S 60 J ( might) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (IoGetConfigurationInformation) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( determine) S 
1920 9380 P (how) S 60 J ( many) S 60 J ( devices) S 60 J ( of) S 60 J ( their) S 60 J ( respective) S 60 J ( types) S 60 J ( are) S 60 J ( already) S 60 J ( represented) S 60 J ( by) S 60 J ( named) S 60 J ( device) S 60 J ( objects.) S 
1920 9640 P (The) S 60 J ( count) S 60 J ( of) S 60 J ( named) S 60 J ( device) S 60 J ( objects) S 60 J ( in) S 60 J ( the) S 60 J ( I/O) S 60 J ( Manager's) S 
1920 9900 P (CONFIGURATION_INFORMATION-type) S 60 J ( structure) S 60 J ( places) S 60 J ( an) S 60 J ( upper) S 60 J ( bound) S 60 J ( on) S 60 J ( the) S 60 J ( number) S 60 J ( of) S 
1920 10160 P (device) S 60 J ( objects) S 60 J ( such) S 60 J ( an) S 60 J ( SFD) S 60 J ( might) S 60 J ( need) S 60 J ( to) S 60 J ( create.) S 60 J ( If) S 60 J ( this) S 60 J ( system-defined) S 60 J ( structure) S 60 J ( does) S 60 J ( not) S 
1920 10420 P (have) S 60 J ( a) S 60 J ( count) S 60 J ( for) S 60 J ( the) S 60 J ( driver's) S 60 J ( type) S 60 J ( of) S 60 J ( device,) S 60 J ( an) S 60 J ( SFD) S 60 J ( can) S 60 J ( examine) S 60 J ( the) S 60 J ( registry) S 60 J ( for) S 60 J ( devices) S 60 J ( of) S 60 J ( its) S 
1920 10680 P (type.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( using) S 60 J ( the) S 60 J ( I/O) S 60 J ( Manager's) S 60 J ( configuration) S 60 J ( information) S 60 J ( and/or) S 
1920 10940 P (the) S 60 J ( registry,) S 60 J ( see) S 60 J ( Chapter) S 60 J ( 16.) S 
1920 11320 P (Note) S 60 J ( that) S 60 J ( a) S 60 J ( configuration) S 60 J ( information) S 60 J ( count) S 60 J ( or) S 60 J ( the) S 60 J ( registry) S 60 J ( keys) S 60 J ( for) S 60 J ( a) S 60 J ( given) S 60 J ( type) S 60 J ( of) S 60 J ( device) S 60 J ( also) S 
1920 11580 P (could) S 60 J ( include) S 60 J ( device) S 60 J ( objects) S 60 J ( for) S 60 J ( nonSCSI) S 60 J ( devices) S 60 J ( and/or) S 60 J ( other) S 60 J ( hardware) S 60 J ( vendors') S 60 J ( SCSI) S 
1920 11840 P (devices) S 60 J ( of) S 60 J ( the) S 60 J ( filter) S 60 J ( driver's) S 60 J ( type.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( GetInquiryData) S 60 J ( routines,) S 60 J ( see) S 
1920 12100 P (Section) S 60 J ( B.1.1.1.) S 60 J ( An) S 60 J ( SFD's) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( must) S 60 J ( determine) S 60 J ( whether) S 60 J ( any) S 60 J ( particular) S 60 J ( device) S 
1920 12360 P (object\(s\)) S 60 J ( created) S 60 J ( by) S 60 J ( another) S 60 J ( driver) S 60 J ( actually) S 60 J ( represent) S 60 J ( a) S 60 J ( SCSI) S 60 J ( device) S 60 J ( that) S 60 J ( the) S 60 J ( driver) S 60 J ( supports.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (16) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2060 P 0 12 F 24 12 F (After) S 60 J ( the) S 60 J ( SFD) S 60 J ( has) S 60 J ( layered) S 60 J ( itself) S 60 J ( over) S 60 J ( the) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( \(or) S 60 J ( over) S 60 J ( another) S 60 J ( driver) S 60 J ( for) S 60 J ( its) S 60 J ( type) S 
1200 2320 P (of) S 60 J ( device\),) S 60 J ( the) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( must) S 60 J ( allocate) S 60 J ( a) S 60 J ( buffer) S 60 J ( and) S 60 J ( set) S 60 J ( up) S 60 J ( a) S 60 J ( request) S 60 J ( for) S 60 J ( SCSI-II) S 
1200 2580 P (inquiry) S 60 J ( data) S 60 J ( about) S 60 J ( the) S 60 J ( underlying) S 60 J ( device\(s\).) S 60 J ( On) S 60 J ( a) S 60 J ( successful) S 60 J ( return) S 60 J ( from) S 60 J ( this) S 60 J ( request,) S 60 J ( the) S 60 J ( SFD) S 
1200 2840 P (must) S 60 J ( inspect) S 60 J ( the) S 60 J ( buffered) S 60 J ( inquiry) S 60 J ( data) S 60 J ( for) S 60 J ( the) S 60 J ( vendor) S 60 J ( name) S 60 J ( \(and,) S 60 J ( possibly,) S 60 J ( model) S 60 J ( designation\)) S 
1200 3100 P (to) S 60 J ( determine) S 60 J ( whether) S 60 J ( the) S 60 J ( device) S 60 J ( is) S 60 J ( one) S 60 J ( the) S 60 J ( driver) S 60 J ( supports.) S 60 J ( If) S 60 J ( so,) S 60 J ( the) S 60 J ( SFD) S 60 J ( should) S 60 J ( set) S 60 J ( up) S 60 J ( the) S 
1200 3360 P (device) S 60 J ( extension) S 60 J ( in) S 60 J ( its) S 60 J ( device) S 60 J ( object.) S 
1200 3740 P (Note) S 60 J ( that) S 60 J ( every) S 60 J ( driver) S 60 J ( must) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (IoAttachDevice) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( a) S 60 J ( driver-created) S 60 J ( device) S 60 J ( object.) S 
1200 4000 P (Therefore,) S 60 J ( an) S 60 J ( SFD) S 60 J ( must) S 60 J ( create) S 60 J ( a) S 60 J ( device) S 60 J ( object) S 60 J ( ) S 0 12 F 24 12 F I (before) S E 0 12 F 24 12 F () S 60 J ( it) S 60 J ( can) S 60 J ( determine) S 60 J ( whether) S 60 J ( the) S 60 J ( underlying) S 
1200 4260 P (device) S 60 J ( is) S 60 J ( one) S 60 J ( that) S 60 J ( it) S 60 J ( supports.) S 60 J ( Its) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( must) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (IoDetachDevice) S E 0 12 F 24 12 F () S 60 J ( and,) S 60 J ( then,) S 
1200 4520 P 0 12 F 24 12 F B (IoDeleteDevice) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( release) S 60 J ( any) S 60 J ( device) S 60 J ( objects) S 60 J ( it) S 60 J ( creates) S 60 J ( for) S 60 J ( unsupported) S 60 J ( devices.) S 60 J ( The) S 
1200 4780 P (DriverEntry) S 60 J ( routine) S 60 J ( also) S 60 J ( must) S 60 J ( free) S 60 J ( the) S 60 J ( memory) S 60 J ( it) S 60 J ( allocated) S 60 J ( for) S 60 J ( SCSI-II) S 60 J ( inquiry) S 60 J ( data) S 60 J ( before) S 60 J ( it) S 
1200 5040 P (returns) S 60 J ( control.) S 
1200 5420 P (Assuming) S 60 J ( it) S 60 J ( finds) S 60 J ( a) S 60 J ( device) S 60 J ( it) S 60 J ( supports,) S 60 J ( the) S 60 J ( SFD) S 60 J ( must) S 60 J ( save) S 60 J ( the) S 60 J ( pointer) S 60 J ( \(returned) S 60 J ( from) S 
1200 5680 P 0 12 F 24 12 F B (IoAttachDevice) S E 0 12 F 24 12 F (\)) S 60 J ( to) S 60 J ( the) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver's) S 60 J ( device) S 60 J ( object) S 60 J ( in) S 60 J ( its) S 60 J ( own) S 60 J ( device) S 60 J ( extension) S 60 J ( so) S 60 J ( the) S 
1200 5940 P (SFD) S 60 J ( can) S 60 J ( send) S 60 J ( IRPs) S 60 J ( on) S 60 J ( to) S 60 J ( the) S 60 J ( class) S 60 J ( driver.) S 60 J ( If) S 60 J ( the) S 60 J ( SFD) S 60 J ( sends) S 60 J ( device-specific) S 60 J ( requests) S 60 J ( through) S 
1200 6200 P (the) S 60 J ( class) S 60 J ( driver,) S 60 J ( it) S 60 J ( might) S 60 J ( need) S 60 J ( to) S 60 J ( set) S 60 J ( up) S 60 J ( SCSI-specific) S 60 J ( data) S 60 J ( in) S 60 J ( the) S 60 J ( device) S 60 J ( extension) S 60 J ( of) S 60 J ( its) S 60 J ( device) S 
1200 6460 P (object\(s\).) S 60 J ( In) S 60 J ( other) S 60 J ( words,) S 60 J ( such) S 60 J ( an) S 60 J ( SFD's) S 60 J ( device) S 60 J ( extension) S 60 J ( should) S 60 J ( include) S 60 J ( any) S 60 J ( SCSI-specific) S 
1200 6720 P (data) S 60 J ( necessary) S 60 J ( to) S 60 J ( manage) S 60 J ( its) S 60 J ( device-specific) S 60 J ( requests.) S 
1200 7100 P (For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( setting) S 60 J ( up) S 60 J ( a) S 60 J ( higher-level) S 60 J ( driver's) S 60 J ( device) S 60 J ( extension) S 60 J ( with) S 60 J ( SCSI-) S 
1200 7360 P (specific) S 60 J ( data,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.1.1.3.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( the) S 60 J ( general) S 60 J ( requirements) S 60 J ( for) S 
1200 7620 P (DriverEntry) S 60 J ( routines,) S 60 J ( see) S 60 J ( Chapter) S 60 J ( 5.) S 
1200 8260 P 0 12 F 8 12 F B (B.2.2) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( Dispatch) S 67 J ( Routines) S E 
1200 8880 P 0 12 F 24 12 F (Like) S 60 J ( any) S 60 J ( other) S 60 J ( higher-level) S 60 J ( NT) S 60 J ( driver,) S 60 J ( a) S 60 J ( SCSI) S 60 J ( filter) S 60 J ( driver) S 60 J ( must) S 60 J ( have) S 60 J ( one) S 60 J ( or) S 60 J ( more) S 60 J ( Dispatch) S 
1200 9140 P (routines) S 60 J ( to) S 60 J ( handle) S 60 J ( every) S 60 J ( IRP_MJ_) S 0 12 F 24 12 F I (xxx) S E 0 12 F 24 12 F () S 60 J ( request) S 60 J ( for) S 60 J ( which) S 60 J ( the) S 60 J ( underlying) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 
1200 9400 P (supplies) S 60 J ( a) S 60 J ( Dispatch) S 60 J ( entry) S 60 J ( point.) S 60 J ( Depending) S 60 J ( on) S 60 J ( the) S 60 J ( nature) S 60 J ( of) S 60 J ( its) S 60 J ( device,) S 60 J ( an) S 60 J ( SFD's) S 60 J ( Dispatch) S 
1200 9660 P (entry) S 60 J ( point) S 60 J ( for) S 60 J ( any) S 60 J ( given) S 60 J ( request) S 60 J ( might) S 60 J ( do) S 60 J ( either) S 60 J ( of) S 60 J ( the) S 60 J ( following:) S 
1200 9980 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( For) S 60 J ( a) S 60 J ( request) S 60 J ( that) S 60 J ( requires) S 60 J ( no) S 60 J ( special) S 60 J ( handling,) S 60 J ( set) S 60 J ( up) S 60 J ( the) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 60 J ( in) S 60 J ( the) S 60 J ( IRP) S 60 J ( for) S 
1680 10240 P (the) S 60 J ( next-lower-level) S 60 J ( class) S 60 J ( driver,) S 60 J ( possibly) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (IoSetCompletionRoutine) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( set) S 60 J ( up) S 60 J ( its) S 
1680 10500 P (IoCompletion) S 60 J ( routine) S 60 J ( for) S 60 J ( the) S 60 J ( IRP,) S 60 J ( and) S 60 J ( pass) S 60 J ( the) S 60 J ( IRP) S 60 J ( on) S 60 J ( for) S 60 J ( further) S 60 J ( processing) S 60 J ( by) S 60 J ( lower) S 
1680 10760 P (drivers) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (IoCallDriver) S E 
1200 11080 P 0 12 F 24 12 F () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Or,) S 60 J ( set) S 60 J ( up) S 60 J ( a) S 60 J ( new) S 60 J ( IRP) S 60 J ( with) S 60 J ( an) S 60 J ( SRB) S 60 J ( and) S 60 J ( CDB) S 60 J ( for) S 60 J ( its) S 60 J ( device,) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (IoSetCompletionRoutine) S E 
1680 11340 P 0 12 F 24 12 F (so) S 60 J ( the) S 60 J ( SRB) S 60 J ( \(and) S 60 J ( the) S 60 J ( IRP) S 60 J ( if) S 60 J ( the) S 60 J ( driver) S 60 J ( calls) S 60 J ( ) S 0 12 F 24 12 F B (IoAllocateIrp) S E 0 12 F 24 12 F () S 60 J ( or) S 
1680 11600 P 0 12 F 24 12 F B (IoBuildAsynchronousFsdRequest) S E 0 12 F 24 12 F (\)) S 60 J ( can) S 60 J ( be) S 60 J ( freed,) S 60 J ( and) S 60 J ( pass) S 60 J ( the) S 60 J ( IRP) S 60 J ( on) S 60 J ( with) S 
1680 11860 P 0 12 F 24 12 F B (IoCallDriver) S E 
1200 12180 P 0 12 F 24 12 F () S 224 J ( ) S 256 J ( An) S 60 J ( SFD) S 60 J ( is) S 60 J ( most) S 60 J ( likely) S 60 J ( to) S 60 J ( set) S 60 J ( up) S 60 J ( new) S 60 J ( IRPs) S 60 J ( with) S 60 J ( the) S 60 J ( major) S 60 J ( function) S 60 J ( code) S 
1680 12440 P (IRP_MJ_INTERNAL_DEVICE_CONTROL.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (17) S E 
1920 2060 P 0 12 F 24 12 F (For) S 60 J ( requests) S 60 J ( that) S 60 J ( require) S 60 J ( no) S 60 J ( special) S 60 J ( handling,) S 60 J ( an) S 60 J ( SFD's) S 60 J ( Dispatch) S 60 J ( routine) S 60 J ( usually) S 60 J ( calls) S 
1920 2320 P 0 12 F 24 12 F B (IoGetNextIrpStackLocation) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( an) S 60 J ( input) S 60 J ( IRP,) S 60 J ( sets) S 60 J ( up) S 60 J ( the) S 60 J ( class) S 60 J ( driver's) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 
1920 2580 P (and,) S 60 J ( then,) S 60 J ( calls) S 60 J ( ) S 0 12 F 24 12 F B (IoCallDriver) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( pointers) S 60 J ( to) S 60 J ( the) S 60 J ( class) S 60 J ( driver's) S 60 J ( device) S 60 J ( object) S 60 J ( and) S 60 J ( the) S 60 J ( IRP.) S 
1920 2840 P (Note) S 60 J ( that) S 60 J ( an) S 60 J ( SFD) S 60 J ( seldom) S 60 J ( sets) S 60 J ( its) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( in) S 60 J ( IRPs) S 60 J ( that) S 60 J ( require) S 60 J ( no) S 60 J ( special) S 
1920 3100 P (handling) S 60 J ( both) S 60 J ( because) S 60 J ( a) S 60 J ( call) S 60 J ( to) S 60 J ( the) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( is) S 60 J ( unnecessary) S 60 J ( and) S 60 J ( because) S 60 J ( it) S 
1920 3360 P (degrades) S 60 J ( I/O) S 60 J ( throughput) S 60 J ( for) S 60 J ( the) S 60 J ( SFD's) S 60 J ( device\(s\).) S 
1920 3740 P (For) S 60 J ( requests) S 60 J ( that) S 60 J ( do) S 60 J ( require) S 60 J ( special) S 60 J ( handling,) S 60 J ( the) S 60 J ( SFD) S 60 J ( can) S 60 J ( do) S 60 J ( the) S 60 J ( following:) S 
1920 4060 P () S 104 J ( 1) S 256 J ( Create) S 60 J ( a) S 60 J ( new) S 60 J ( IRP) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (IoBuildDeviceIoControlRequest) S E 0 12 F 24 12 F (,) S 60 J ( ) S 0 12 F 24 12 F B (IoAllocateIrp) S E 0 12 F 24 12 F (,) S 
2400 4320 P 0 12 F 24 12 F B (IoBuildSynchronousFsdRequest) S E 0 12 F 24 12 F (,) S 60 J ( or) S 60 J ( ) S 0 12 F 24 12 F B (IoBuildAsynchronousFsdRequest) S E 0 12 F 24 12 F (.) S 
1920 4640 P () S 104 J ( 2) S 256 J ( Check) S 60 J ( the) S 60 J ( returned) S 60 J ( IRP) S 60 J ( pointer) S 60 J ( for) S 60 J ( NULL) S 60 J ( and) S 60 J ( return) S 
2400 4900 P (STATUS_INSUFFICIENT_RESOURCES) S 60 J ( if) S 60 J ( an) S 60 J ( IRP) S 60 J ( could) S 60 J ( not) S 60 J ( be) S 60 J ( allocated.) S 
1920 5220 P () S 104 J ( 3) S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (IoSetNextIrpStackLocation) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( get) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( its) S 60 J ( own) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 60 J ( in) S 60 J ( the) S 
2400 5480 P (driver-created) S 60 J ( IRP) S 60 J ( and,) S 60 J ( possibly,) S 60 J ( set) S 60 J ( up) S 60 J ( it) S 60 J ( up) S 60 J ( with) S 60 J ( state) S 60 J ( to) S 60 J ( be) S 60 J ( used) S 60 J ( by) S 60 J ( its) S 60 J ( own) S 
2400 5740 P (IoCompletion) S 60 J ( routine.) S 
1920 6060 P () S 104 J ( 4) S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (IoGetNextIrpStackLocation) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( get) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( class) S 60 J ( driver's) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 
2400 6320 P (in) S 60 J ( the) S 60 J ( driver-created) S 60 J ( IRP) S 60 J ( and) S 60 J ( set) S 60 J ( it) S 60 J ( up) S 60 J ( with) S 60 J ( the) S 60 J ( major) S 60 J ( function) S 60 J ( code) S 60 J ( IRP_MJ_SCSI) S 60 J ( and) S 60 J ( an) S 
2400 6580 P (SRB) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1.2.1\).) S 
1920 6900 P () S 104 J ( 5) S 256 J ( Translate) S 60 J ( data) S 60 J ( to) S 60 J ( be) S 60 J ( transferred) S 60 J ( to) S 60 J ( the) S 60 J ( device) S 60 J ( into) S 60 J ( a) S 60 J ( device-specific,) S 60 J ( nonstandard) S 60 J ( format) S 60 J ( if) S 
2400 7160 P (necessary.) S 
1920 7480 P () S 104 J ( 6) S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (IoSetCompletionRoutine) S E 0 12 F 24 12 F () S 60 J ( if) S 60 J ( the) S 60 J ( driver) S 60 J ( allocated) S 60 J ( any) S 60 J ( memory,) S 60 J ( such) S 60 J ( as) S 60 J ( memory) S 60 J ( for) S 
2400 7740 P (an) S 60 J ( SRB,) S 60 J ( SCSI) S 60 J ( request-sense) S 60 J ( buffer,) S 60 J ( MDL,) S 60 J ( and/or) S 60 J ( with) S 60 J ( a) S 60 J ( call) S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (IoAllocateIrp) S E 0 12 F 24 12 F () S 60 J ( or) S 
2400 8000 P 0 12 F 24 12 F B (IoBuildAsynchronousFsdRequest) S E 0 12 F 24 12 F (,) S 60 J ( or) S 60 J ( if) S 60 J ( the) S 60 J ( driver) S 60 J ( must) S 60 J ( translate) S 60 J ( data) S 60 J ( transferred) S 60 J ( from) S 
2400 8260 P (the) S 60 J ( device) S 60 J ( in) S 60 J ( a) S 60 J ( device-specific,) S 60 J ( nonstandard) S 60 J ( format.) S 
1920 8580 P () S 104 J ( 7) S 256 J ( Pass) S 60 J ( the) S 60 J ( driver-created) S 60 J ( IRP) S 60 J ( to) S 60 J ( \(and) S 60 J ( through\)) S 60 J ( the) S 60 J ( class) S 60 J ( driver) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (IoCallDriver) S E 0 12 F 24 12 F (.) S 
1920 8960 P (Like) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver,) S 60 J ( an) S 60 J ( SFD) S 60 J ( might) S 60 J ( have) S 60 J ( SCSI-specific) S 60 J ( BuildSrb) S 60 J ( or) S 60 J ( SplitTransferRequest) S 
1920 9220 P (routines) S 60 J ( to) S 60 J ( be) S 60 J ( called) S 60 J ( from) S 60 J ( the) S 60 J ( driver's) S 60 J ( Dispatch) S 60 J ( routine\(s\),) S 60 J ( or) S 60 J ( might) S 60 J ( implement) S 60 J ( the) S 60 J ( same) S 
1920 9480 P (functionality) S 60 J ( inline.) S 
1920 9860 P (For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( BuildSrb) S 60 J ( and) S 60 J ( SplitTransferRequest) S 60 J ( routines,) S 60 J ( see) S 60 J ( Sections) S 60 J ( B.1.2.1) S 
1920 10120 P (and) S 60 J ( B.1.2.2.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( general) S 60 J ( requirements) S 60 J ( for) S 60 J ( Dispatch) S 60 J ( routines,) S 60 J ( see) S 
1920 10380 P (Chapter) S 60 J ( 6.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (18) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2080 P 0 12 F 8 12 F B (B.2.3) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( IoCompletion) S 67 J ( Routines) S E 
1200 2700 P 0 12 F 24 12 F (A) S 60 J ( SCSI) S 60 J ( filter) S 60 J ( driver's) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( is) S 60 J ( called) S 60 J ( when) S 60 J ( lower) S 60 J ( \(class) S 60 J ( and) S 60 J ( port\)) S 60 J ( drivers) S 60 J ( have) S 
1200 2960 P (called) S 60 J ( ) S 0 12 F 24 12 F B (IoCompleteRequest) S E 0 12 F 24 12 F (.) S 60 J ( The) S 60 J ( SFD's) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( should) S 60 J ( return) S 
1200 3220 P (STATUS_MORE_PROCESSING_REQUIRED) S 60 J ( to) S 60 J ( prevent) S 60 J ( completion) S 60 J ( processing) S 60 J ( of) S 60 J ( a) S 60 J ( driver-) S 
1200 3480 P (allocated) S 60 J ( IRP) S 60 J ( or) S 60 J ( the) S 60 J ( original) S 60 J ( IRP) S 60 J ( if) S 60 J ( the) S 60 J ( SFD) S 60 J ( will) S 60 J ( reuse) S 60 J ( it) S 60 J ( before) S 60 J ( it) S 60 J ( completes) S 60 J ( the) S 60 J ( original) S 
1200 3740 P (request.) S 60 J ( Like) S 60 J ( any) S 60 J ( other) S 60 J ( higher-level) S 60 J ( NT) S 60 J ( driver,) S 60 J ( an) S 60 J ( SFD's) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( is) S 60 J ( responsible) S 
1200 4000 P (for) S 60 J ( calling) S 60 J ( ) S 0 12 F 24 12 F B (IoFreeIrp) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( release) S 60 J ( any) S 60 J ( IRP) S 60 J ( the) S 60 J ( driver's) S 60 J ( Dispatch) S 60 J ( routine\(s\)) S 60 J ( created) S 60 J ( with) S 
1200 4260 P 0 12 F 24 12 F B (IoAllocateIrp) S E 0 12 F 24 12 F () S 60 J ( or) S 60 J ( ) S 0 12 F 24 12 F B (IoBuildAsynchronousFsdRequest) S E 0 12 F 24 12 F (.) S 
1200 4640 P (Depending) S 60 J ( on) S 60 J ( its) S 60 J ( device,) S 60 J ( an) S 60 J ( SFD) S 60 J ( might) S 60 J ( supply) S 60 J ( an) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( for) S 60 J ( IRPs) S 60 J ( it) S 60 J ( sends) S 60 J ( to) S 
1200 4900 P (the) S 60 J ( class) S 60 J ( driver) S 60 J ( from) S 60 J ( its) S 60 J ( Dispatch) S 60 J ( routines.) S 60 J ( In) S 60 J ( particular,) S 60 J ( a) S 60 J ( device) S 60 J ( that) S 60 J ( retrieves) S 60 J ( and) S 60 J ( processes) S 
1200 5160 P (data) S 60 J ( in) S 60 J ( a) S 60 J ( nonstandard) S 60 J ( format) S 60 J ( might) S 60 J ( require) S 60 J ( the) S 60 J ( SFD) S 60 J ( to) S 60 J ( have) S 60 J ( a) S 60 J ( TranslateDataIn) S 60 J ( routine) S 60 J ( called) S 
1200 5420 P (from) S 60 J ( its) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( for) S 60 J ( transfer) S 60 J ( requests) S 60 J ( from) S 60 J ( such) S 60 J ( a) S 60 J ( device) S 60 J ( to) S 60 J ( system) S 60 J ( memory.) S 
1200 5680 P (Note) S 60 J ( that) S 60 J ( such) S 60 J ( a) S 60 J ( TranslateDataIn) S 60 J ( routine) S 60 J ( would) S 60 J ( be) S 60 J ( called) S 60 J ( at) S 60 J ( IRQL) S 60 J ( DISPATCH_LEVEL) S 60 J ( and) S 60 J ( in) S 
1200 5940 P (an) S 60 J ( arbitrary) S 60 J ( thread) S 60 J ( context.) S 60 J ( Therefore,) S 60 J ( the) S 60 J ( buffer) S 60 J ( into) S 60 J ( which) S 60 J ( the) S 60 J ( driver) S 60 J ( returns) S 60 J ( data) S 60 J ( either) S 60 J ( must) S 
1200 6200 P (be) S 60 J ( located) S 60 J ( in) S 60 J ( nonpaged) S 60 J ( pool) S 60 J ( or) S 60 J ( must) S 60 J ( be) S 60 J ( locked) S 60 J ( down) S 60 J ( and) S 60 J ( accessible) S 60 J ( using) S 60 J ( mapped,) S 60 J ( nonpaged) S 
1200 6460 P (system-space) S 60 J ( virtual) S 60 J ( addresses.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( accessing) S 60 J ( user-supplied) S 60 J ( buffers) S 60 J ( at) S 
1200 6720 P (raised) S 60 J ( IRQL) S 60 J ( safely,) S 60 J ( see) S 60 J ( Chapter) S 60 J ( 16.) S 
1200 7100 P (In) S 60 J ( general,) S 60 J ( a) S 60 J ( SCSI) S 60 J ( filter) S 60 J ( driver) S 60 J ( should) S 60 J ( supply) S 60 J ( an) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( with) S 60 J ( the) S 60 J ( same) S 
1200 7360 P (functionality) S 60 J ( as) S 60 J ( a) S 60 J ( class) S 60 J ( driver's) S 60 J ( IoCompletion) S 60 J ( routine) S 60 J ( for) S 60 J ( IRPs) S 60 J ( that) S 60 J ( the) S 60 J ( filter) S 60 J ( driver) S 60 J ( sets) S 60 J ( up) S 60 J ( with) S 
1200 7620 P (SRBs) S 60 J ( and) S 60 J ( CDBs.) S 60 J ( Consequently,) S 60 J ( a) S 60 J ( SCSI) S 60 J ( filter) S 60 J ( driver) S 60 J ( might) S 60 J ( have) S 60 J ( any) S 60 J ( or) S 60 J ( all) S 60 J ( of) S 60 J ( the) S 
1200 7880 P (ReleaseQueue,) S 60 J ( InterpretRequestSense,) S 60 J ( or) S 60 J ( RetryRequest) S 60 J ( routines) S 60 J ( that) S 60 J ( can) S 60 J ( be) S 60 J ( called) S 60 J ( from) S 60 J ( a) S 
1200 8140 P (SCSI) S 60 J ( class) S 60 J ( driver's) S 60 J ( IoCompletion) S 60 J ( routine\(s\).) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 
1200 8400 P (InterpretRequestSense,) S 60 J ( RetryRequest,) S 60 J ( and) S 60 J ( ReleaseQueue) S 60 J ( routines,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.1.3.) S 60 J ( For) S 
1200 8660 P (more) S 60 J ( information) S 60 J ( about) S 60 J ( general) S 60 J ( requirements) S 60 J ( for) S 60 J ( IoCompletion) S 60 J ( routines,) S 60 J ( see) S 60 J ( Chapter) S 60 J ( 13.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (19) S E 
1920 2120 P 0 12 F 8 14 F B (B.3) S 78 J ( ) S 78 J ( ) S 78 J ( ) S 78 J ( Designing) S 78 J ( a) S 78 J ( SCSI) S 78 J ( Tape) S 78 J ( Subclass) S 78 J ( Driver) S E 
1920 2740 P 0 12 F 24 12 F (NT) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( for) S 60 J ( tape) S 60 J ( devices) S 60 J ( have) S 60 J ( two) S 60 J ( pieces:) S 
1920 3060 P () S 104 J ( 1) S 256 J ( The) S 60 J ( system-supplied) S 60 J ( generic) S 60 J ( tape) S 60 J ( driver,) S 60 J ( ) S 0 12 F 24 12 F I (tape.c) S E 0 12 F 24 12 F (,) S 60 J ( which) S 60 J ( provides) S 60 J ( functionality) S 60 J ( common) S 60 J ( to) S 
2400 3320 P (all) S 60 J ( SCSI) S 60 J ( tape) S 60 J ( drivers) S 
1920 3640 P () S 104 J ( 2) S 256 J ( A) S 60 J ( device-specific) S 60 J ( ) S 0 12 F 24 12 F I (tape) S 60 J ( subclass) S 60 J ( driver) S E 0 12 F 24 12 F (,) S 60 J ( which) S 60 J ( supports) S 60 J ( a) S 60 J ( particular) S 60 J ( type) S 60 J ( of) S 60 J ( tape) S 60 J ( device) S 
2400 3900 P (and) S 60 J ( which) S 60 J ( is) S 60 J ( linked) S 60 J ( with) S 60 J ( the) S 60 J ( generic) S 60 J ( tape) S 60 J ( driver) S 
1920 4280 P (Each) S 60 J ( of) S 60 J ( these) S 60 J ( pieces) S 60 J ( has) S 60 J ( specific) S 60 J ( responsibilities.) S 60 J ( The) S 60 J ( generic) S 60 J ( tape) S 60 J ( driver) S 60 J ( is) S 60 J ( responsible) S 60 J ( for) S 60 J ( the) S 
1920 4540 P (following:) S 
1920 4860 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Providing) S 60 J ( a) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( that) S 60 J ( does) S 60 J ( everything) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( must) S 60 J ( to) S 60 J ( be) S 
2400 5120 P (loaded) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1.1\)) S 
1920 5440 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Providing) S 60 J ( a) S 60 J ( set) S 60 J ( of) S 60 J ( Dispatch) S 60 J ( routines) S 60 J ( to) S 60 J ( accept) S 60 J ( I/O) S 60 J ( requests) S 60 J ( bound) S 60 J ( for) S 60 J ( the) S 60 J ( tape) S 60 J ( device) S 60 J ( from) S 
2400 5700 P (the) S 60 J ( system) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1.2\)) S 
1920 6020 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Enforcing) S 60 J ( the) S 60 J ( HBA's) S 60 J ( limits) S 60 J ( on) S 60 J ( large) S 60 J ( transfer) S 60 J ( requests,) S 60 J ( as) S 60 J ( necessary) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1.2.2\)) S 
1920 6340 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Calling) S 60 J ( the) S 60 J ( subclass) S 60 J ( driver's) S 60 J ( system-defined) S 60 J ( ) S 0 12 F 24 12 F B (Tape) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines) S 60 J ( to) S 60 J ( process) S 60 J ( incoming) S 60 J ( I/O) S 
2400 6600 P (requests) S 
1920 6980 P (Consequently,) S 60 J ( only) S 60 J ( a) S 60 J ( new) S 60 J ( tape) S 60 J ( subclass) S 60 J ( driver) S 60 J ( must) S 60 J ( be) S 60 J ( written) S 60 J ( to) S 60 J ( support) S 60 J ( a) S 60 J ( SCSI) S 60 J ( tape) S 60 J ( device) S 
1920 7240 P (for) S 60 J ( which) S 60 J ( the) S 60 J ( system) S 60 J ( does) S 60 J ( not) S 60 J ( already) S 60 J ( provide) S 60 J ( a) S 60 J ( driver.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (20) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2060 P 0 12 F 24 12 F (A) S 60 J ( tape) S 60 J ( subclass) S 60 J ( driver) S 60 J ( is) S 60 J ( generally) S 60 J ( responsible) S 60 J ( for) S 60 J ( the) S 60 J ( following:) S 
1200 2380 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Determining) S 60 J ( if) S 60 J ( a) S 60 J ( given) S 60 J ( device) S 60 J ( is) S 60 J ( of) S 60 J ( a) S 60 J ( type) S 60 J ( it) S 60 J ( can) S 60 J ( support) S 
1200 2700 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Building) S 60 J ( SRBs) S 60 J ( with) S 60 J ( CDBs) S 60 J ( for) S 60 J ( its) S 60 J ( device\(s\)) S 
1200 3020 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Providing) S 60 J ( the) S 60 J ( following) S 60 J ( system-required) S 60 J ( set) S 60 J ( of) S 60 J ( ) S 0 12 F 24 12 F B (Tape) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines:) S 
1200 3340 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( ) S 0 12 F 24 12 F B (TapeVerifyInquiry) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( return) S 60 J ( a) S 60 J ( Boolean) S 60 J ( indicating) S 60 J ( whether) S 60 J ( the) S 60 J ( input) S 
2160 3600 P (SCSI_INQUIRY_DATA-type) S 60 J ( buffer) S 60 J ( contains) S 60 J ( ) S 0 12 F 24 12 F B (VendorId) S E 0 12 F 24 12 F () S 60 J ( and/or) S 60 J ( ) S 0 12 F 24 12 F B (ProductId) S E 0 12 F 24 12 F () S 60 J ( values) S 
2160 3860 P (for) S 60 J ( a) S 60 J ( device) S 60 J ( the) S 60 J ( subclass) S 60 J ( driver) S 60 J ( supports) S 
1200 4180 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( ) S 0 12 F 24 12 F B (TapeReadWrite) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( set) S 60 J ( up) S 60 J ( an) S 60 J ( SRB) S 60 J ( with) S 60 J ( a) S 60 J ( CDB) S 60 J ( for) S 60 J ( a) S 60 J ( transfer) S 60 J ( from) S 60 J ( its) S 60 J ( device) S 60 J ( to) S 60 J ( the) S 
2160 4440 P (system) S 60 J ( or) S 60 J ( vice) S 60 J ( versa,) S 60 J ( to) S 60 J ( set) S 60 J ( up) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver's) S 60 J ( I/O) S 60 J ( stack) S 60 J ( location) S 60 J ( in) S 60 J ( the) S 60 J ( input) S 
2160 4700 P (IRP) S 60 J ( \(see) S 60 J ( Sections) S 60 J ( B.1.2) S 60 J ( and) S 60 J ( B.1.2.1\),) S 60 J ( and) S 60 J ( to) S 60 J ( return) S 60 J ( control) S 60 J ( with) S 
2160 4960 P (STATUS_PENDING) S 
1200 5280 P () S 664 J ( ) S 296 J ( Note) S 60 J ( that) S 60 J ( the) S 60 J ( IRP) S 60 J ( input) S 60 J ( to) S 60 J ( a) S 60 J ( ) S 0 12 F 24 12 F B (TapeReadWrite) S E 0 12 F 24 12 F () S 60 J ( routine) S 60 J ( ) S 0 12 F 24 12 F I (never) S E 0 12 F 24 12 F () S 60 J ( requests) S 60 J ( a) S 60 J ( transfer) S 60 J ( too) S 
2160 5540 P (large) S 60 J ( for) S 60 J ( the) S 60 J ( underlying) S 60 J ( HBA) S 60 J ( because) S 60 J ( the) S 60 J ( generic) S 60 J ( tape) S 60 J ( driver's) S 60 J ( DispatchReadWrite) S 
2160 5800 P (routine) S 60 J ( pre-splits) S 60 J ( large) S 60 J ( tranfer) S 60 J ( requests) S 60 J ( before) S 60 J ( it) S 60 J ( calls) S 60 J ( ) S 0 12 F 24 12 F B (TapeReadWrite) S E 0 12 F 24 12 F (.) S 60 J ( The) S 60 J ( generic) S 
2160 6060 P (tape) S 60 J ( driver's) S 60 J ( DispatchReadWrite) S 60 J ( routine) S 60 J ( also) S 60 J ( passes) S 60 J ( the) S 60 J ( IRP) S 60 J ( on) S 60 J ( to) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 
2160 6320 P (with) S 60 J ( ) S 0 12 F 24 12 F B (IoCallDriver) S E 0 12 F 24 12 F (.) S 
1200 6640 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( ) S 0 12 F 24 12 F B (TapeError) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( interpret) S 60 J ( returned) S 60 J ( request-sense) S 60 J ( information) S 60 J ( or) S 60 J ( status) S 60 J ( for) S 60 J ( a) S 60 J ( request,) S 
2160 6900 P (set) S 60 J ( appropriate) S 60 J ( status) S 60 J ( in) S 60 J ( the) S 60 J ( input) S 60 J ( IRP's) S 60 J ( I/O) S 60 J ( status) S 60 J ( block,) S 60 J ( and) S 60 J ( determine) S 60 J ( whether) S 60 J ( to) S 
2160 7160 P (retry) S 60 J ( the) S 60 J ( request) S 
1200 7480 P () S 664 J ( ) S 296 J ( Note) S 60 J ( that) S 60 J ( ) S 0 12 F 24 12 F B (TapeError) S E 0 12 F 24 12 F () S 60 J ( is) S 60 J ( called) S 60 J ( from) S 60 J ( the) S 60 J ( generic) S 60 J ( tape) S 60 J ( driver's) S 60 J ( InterpretRequestSense) S 
2160 7740 P (routine) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1.3.2\).) S 
1200 8060 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( A) S 60 J ( set) S 60 J ( of) S 60 J ( ) S 0 12 F 24 12 F B (Tape) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines,) S 60 J ( each) S 60 J ( to) S 60 J ( set) S 60 J ( up) S 60 J ( an) S 60 J ( SRB) S 60 J ( with) S 60 J ( a) S 60 J ( CDB) S 60 J ( for) S 60 J ( a) S 60 J ( particular) S 60 J ( \(and) S 
2160 8320 P (required\)) S 60 J ( device) S 60 J ( control) S 60 J ( request,) S 60 J ( and,) S 60 J ( then,) S 60 J ( to) S 60 J ( send) S 60 J ( the) S 60 J ( request) S 60 J ( to) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 
2160 8580 P (and) S 60 J ( return) S 60 J ( status) S 60 J ( about) S 60 J ( the) S 60 J ( requested) S 60 J ( operation) S 
1200 8900 P () S 664 J ( ) S 296 J ( Note) S 60 J ( that) S 60 J ( the) S 60 J ( return) S 60 J ( status) S 60 J ( should) S 60 J ( be) S 60 J ( STATUS_VERIFY_REQUIRED) S 60 J ( if) S 60 J ( the) S 
2160 9160 P (subclass) S 60 J ( driver) S 60 J ( detects) S 60 J ( \(or) S 60 J ( suspects\)) S 60 J ( that) S 60 J ( the) S 60 J ( media) S 60 J ( in) S 60 J ( the) S 60 J ( device) S 60 J ( might) S 60 J ( have) S 
2160 9420 P (changed.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( handling) S 60 J ( removable) S 60 J ( media,) S 60 J ( see) S 60 J ( also) S 60 J ( Chapter) S 
2160 9680 P (16.) S 
1200 10060 P (The) S 60 J ( system-supplied) S 60 J ( generic) S 60 J ( tape) S 60 J ( driver) S 60 J ( calls) S 60 J ( the) S 60 J ( ScsiClass) S 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines) S 60 J ( implemented) S 60 J ( in) S 
1200 10320 P 0 12 F 24 12 F I (class.c) S E 0 12 F 24 12 F () S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1\)) S 60 J ( and) S 60 J ( included) S 60 J ( with) S 60 J ( the) S 60 J ( Windows) S 60 J ( NT) S 60 J ( DDK.) S 60 J ( A) S 60 J ( new) S 60 J ( tape) S 60 J ( subclass) S 
1200 10580 P (driver) S 60 J ( also) S 60 J ( can) S 60 J ( call) S 60 J ( these) S 60 J ( routines,) S 60 J ( or) S 60 J ( it) S 60 J ( can) S 60 J ( implement) S 60 J ( the) S 60 J ( same) S 60 J ( functionality) S 60 J ( as) S 60 J ( a) S 
1200 10840 P (ScsiClass) S 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( inline.) S 
1200 11220 P (For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( the) S 60 J ( required) S 60 J ( ) S 0 12 F 24 12 F B (Tape) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines) S 60 J ( for) S 60 J ( subclass) S 60 J ( drivers) S 60 J ( or) S 60 J ( about) S 60 J ( the) S 
1200 11480 P (required) S 60 J ( tape-specific) S 60 J ( I/O) S 60 J ( control) S 60 J ( codes) S 60 J ( for) S 60 J ( device) S 60 J ( control) S 60 J ( requests,) S 60 J ( see) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (Kernel-mode) S E 
1200 11740 P I (Driver) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F I (Reference) S E 0 12 F 24 12 F (.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (21) S E 
1920 2120 P 0 12 F 8 14 F B (B.4) S 78 J ( ) S 78 J ( ) S 78 J ( ) S 78 J ( Designing) S 78 J ( a) S 78 J ( SCSI) S 78 J ( Miniport) S 78 J ( Driver) S E 
1920 2740 P 0 12 F 24 12 F (Windows) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( miniport) S 60 J ( drivers) S 60 J ( are) S 60 J ( HBA-specific) S 60 J ( but) S 60 J ( OS-independent.) S 60 J ( That) S 60 J ( is,) S 60 J ( each) S 
1920 3000 P (miniport) S 60 J ( driver) S 60 J ( links) S 60 J ( itself) S 60 J ( against) S 60 J ( the) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( port) S 60 J ( driver,) S 60 J ( which) S 60 J ( is) S 60 J ( a) S 60 J ( dynamic-link) S 60 J ( library) S 
1920 3260 P (\(DLL\),) S 60 J ( and) S 60 J ( calls) S 60 J ( only) S 60 J ( the) S 60 J ( port) S 60 J ( driver's) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPort) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines) S 60 J ( to) S 60 J ( communicate) S 60 J ( with) S 60 J ( the) S 60 J ( system.) S 
1920 3467 P 0 12 F 24 8 F 8565 J ( ) S (TM) S 
1920 3520 P 0 12 F 24 12 F (In) S 60 J ( future,) S 60 J ( HBA) S 60 J ( miniport) S 60 J ( drivers) S 60 J ( can) S 60 J ( be) S 60 J ( recompiled) S 60 J ( to) S 60 J ( run) S 60 J ( on) S 60 J ( machines) S 60 J ( running) S 60 J ( MS-DOS) S 240 J ( ) S (,) S 
1920 3780 P (which) S 60 J ( will) S 60 J ( provide) S 60 J ( an) S 60 J ( OS-dependent) S 60 J ( port) S 60 J ( driver) S 60 J ( that) S 60 J ( also) S 60 J ( exports) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPort) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines.) S 
1920 4160 P (Every) S 60 J ( SCSI) S 60 J ( miniport) S 60 J ( driver) S 60 J ( must) S 60 J ( have) S 60 J ( at) S 60 J ( least) S 60 J ( the) S 60 J ( following) S 60 J ( system-defined) S 60 J ( routines:) S 
1920 4480 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( DriverEntry) S 60 J ( to) S 60 J ( initialize) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 
1920 4800 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( HwFindAdapter) S 60 J ( to) S 60 J ( determine) S 60 J ( how) S 60 J ( \(or) S 60 J ( whether\)) S 60 J ( driver-supported) S 60 J ( HBA\(s\)) S 60 J ( are) S 60 J ( configured) S 
2400 5060 P (in) S 60 J ( the) S 60 J ( machine) S 
1920 5380 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( HwInitialize) S 60 J ( to) S 60 J ( initialize) S 60 J ( the) S 60 J ( HBA\(s\)) S 
1920 5700 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( HwStartIo) S 60 J ( to) S 60 J ( start) S 60 J ( operations) S 60 J ( on) S 60 J ( the) S 60 J ( HBA) S 60 J ( for) S 60 J ( an) S 60 J ( incoming) S 60 J ( request) S 
1920 6020 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( HwResetBus) S 60 J ( to) S 60 J ( handle) S 60 J ( bus-reset) S 60 J ( requests) S 
1920 6400 P (Depending) S 60 J ( on) S 60 J ( the) S 60 J ( HBA) S 60 J ( and) S 60 J ( the) S 60 J ( driver) S 60 J ( designer,) S 60 J ( SCSI) S 60 J ( miniport) S 60 J ( drivers) S 60 J ( also) S 60 J ( can) S 60 J ( have) S 60 J ( any) S 60 J ( or) S 60 J ( all) S 
1920 6660 P (of) S 60 J ( the) S 60 J ( following) S 60 J ( system-defined) S 60 J ( routines:) S 
1920 6980 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( HwInterrupt) S 60 J ( to) S 60 J ( handle) S 60 J ( HBA-generated) S 60 J ( interrupts,) S 60 J ( which) S 60 J ( is) S 60 J ( optional) S 60 J ( if) S 60 J ( and) S 60 J ( only) S 60 J ( if) S 60 J ( the) S 
2400 7240 P (miniport) S 60 J ( manages) S 60 J ( all) S 60 J ( I/O) S 60 J ( operations) S 60 J ( on) S 60 J ( its) S 60 J ( HBA) S 60 J ( by) S 60 J ( polling) S 
2400 7560 P (However,) S 60 J ( using) S 60 J ( polling) S 60 J ( exclusively) S 60 J ( has) S 60 J ( an) S 60 J ( adverse) S 60 J ( effect) S 60 J ( on) S 60 J ( a) S 60 J ( miniport's) S 60 J ( performance) S 
2400 7820 P (and) S 60 J ( on) S 60 J ( its) S 60 J ( HBA's) S 60 J ( I/O) S 60 J ( throughput.) S 
1920 8140 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( HwDmaStarted) S 60 J ( to) S 60 J ( set) S 60 J ( up) S 60 J ( an) S 60 J ( HBA) S 60 J ( transfer) S 60 J ( after) S 60 J ( the) S 60 J ( system) S 60 J ( DMA) S 60 J ( controller) S 60 J ( has) S 60 J ( been) S 
2400 8400 P (programmed) S 60 J ( by) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 
1920 8720 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( HwDisableInterruptsCallback) S 60 J ( and) S 60 J ( HwEnableInterruptsCallback) S 60 J ( to) S 60 J ( handle) S 60 J ( deferred) S 60 J ( I/O) S 
2400 8980 P (processing) S 60 J ( if) S 60 J ( a) S 60 J ( particular) S 60 J ( operation) S 60 J ( takes) S 60 J ( a) S 60 J ( long) S 60 J ( time) S 
1920 9300 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( HwTimer) S 60 J ( to) S 60 J ( time) S 60 J ( operations) S 60 J ( on) S 60 J ( the) S 60 J ( HBA) S 60 J ( that) S 60 J ( require) S 60 J ( long) S 60 J ( delays) S 
2400 9620 P (A) S 60 J ( miniport) S 60 J ( should) S 60 J ( have) S 60 J ( a) S 60 J ( HwTimer) S 60 J ( routine) S 60 J ( if) S 60 J ( it) S 60 J ( has) S 60 J ( no) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( so) S 60 J ( it) S 60 J ( can) S 60 J ( use) S 
2400 9880 P (the) S 60 J ( HwTimer) S 60 J ( routine) S 60 J ( for) S 60 J ( efficient) S 60 J ( polling) S 60 J ( of) S 60 J ( the) S 60 J ( HBA.) S 
1920 10200 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( HwAdapterState,) S 60 J ( defined) S 60 J ( for) S 60 J ( compatibility) S 60 J ( with) S 60 J ( future) S 60 J ( MS-DOS) S 60 J ( versions) S 
1920 10580 P (The) S 60 J ( following) S 60 J ( subsections) S 60 J ( describe) S 60 J ( the) S 60 J ( requirements) S 60 J ( for) S 60 J ( and) S 60 J ( functionality) S 60 J ( of) S 60 J ( each) S 60 J ( of) S 60 J ( these) S 
1920 10840 P (miniport) S 60 J ( driver) S 60 J ( routines.) S 60 J ( See) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (Kernel-mode) S 60 J ( Driver) S 60 J ( Reference) S E 0 12 F 24 12 F () S 60 J ( for) S 60 J ( their) S 60 J ( formal) S 60 J ( definitions) S 
1920 11100 P (and) S 60 J ( descriptions) S 60 J ( of) S 60 J ( their) S 60 J ( parameters.) S 
1920 11480 P (Section) S 60 J ( B.4.8) S 60 J ( describes) S 60 J ( error-handling) S 60 J ( requirements) S 60 J ( for) S 60 J ( SCSI) S 60 J ( miniport) S 60 J ( drivers.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (22) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2080 P 0 12 F 8 12 F B (B.4.1) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( DriverEntry) S 67 J ( Routine) S E 
1200 2700 P 0 12 F 24 12 F (A) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( is) S 60 J ( the) S 60 J ( initial) S 60 J ( entry) S 60 J ( point) S 60 J ( for) S 60 J ( each) S 60 J ( NT) S 60 J ( driver,) S 60 J ( including) S 60 J ( each) S 60 J ( SCSI) S 
1200 2960 P (miniport) S 60 J ( driver.) S 60 J ( A) S 60 J ( miniport's) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( is) S 60 J ( called) S 60 J ( with) S 60 J ( two) S 60 J ( input) S 60 J ( arguments) S 60 J ( \(of) S 60 J ( type) S 
1200 3220 P (PVOID\)) S 60 J ( and) S 60 J ( must) S 60 J ( do) S 60 J ( the) S 60 J ( following:) S 
1200 3540 P () S 104 J ( 1) S 256 J ( Initialize) S 60 J ( a) S 60 J ( HW_INITIALIZATION_DATA) S 60 J ( structure) S 60 J ( \(on) S 60 J ( the) S 60 J ( stack\)) S 60 J ( with) S 60 J ( zeros.) S 
1200 3860 P () S 104 J ( 2) S 256 J ( Set) S 60 J ( driver-specific) S 60 J ( and) S 60 J ( HBA-specific) S 60 J ( values) S 60 J ( in) S 60 J ( the) S 60 J ( HW_INITIALIZATION_DATA) S 
1680 4120 P (fields,) S 60 J ( including) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver's) S 60 J ( entry) S 60 J ( points.) S 60 J ( The) S 60 J ( following) S 60 J ( entry) S 60 J ( points) S 60 J ( must) S 60 J ( be) S 
1680 4380 P (set:) S 
1200 4700 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( HwFindAdapter) S 
1200 5020 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( HwInitialize) S 
1200 5340 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( HwStartIo) S 
1200 5660 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( HwResetBus) S 
1200 5980 P () S 224 J ( ) S 256 J ( The) S 60 J ( following) S 60 J ( entry) S 60 J ( points) S 60 J ( can) S 60 J ( be) S 60 J ( set) S 60 J ( to) S 60 J ( a) S 60 J ( driver-supplied) S 60 J ( routine) S 60 J ( or) S 60 J ( must) S 60 J ( be) S 60 J ( set) S 60 J ( to) S 
1680 6240 P (NULL:) S 
1200 6560 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( HwInterrupt) S 60 J ( \(NULL) S 60 J ( if) S 60 J ( the) S 60 J ( miniport) S 60 J ( uses) S 60 J ( polling) S 60 J ( exclusively\)) S 
1200 6880 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( HwDmaStarted) S 
1200 7200 P () S 512 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 296 J ( HwAdapterState) S 60 J ( \(NULL\)) S 
1200 7520 P () S 104 J ( 3) S 256 J ( Set) S 60 J ( up) S 60 J ( any) S 60 J ( driver-determined) S 60 J ( context) S 60 J ( data) S 60 J ( that) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwFindAdapter) S 60 J ( routine) S 
1680 7780 P (uses.) S 
1200 8100 P () S 104 J ( 4) S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( pointers) S 60 J ( that) S 60 J ( were) S 60 J ( input) S 60 J ( to) S 60 J ( the) S 60 J ( DriverEntry) S 60 J ( routine,) S 60 J ( the) S 
1680 8360 P (address) S 60 J ( of) S 60 J ( the) S 60 J ( filled-in) S 60 J ( HW_INITIALIZATION_DATA,) S 60 J ( and) S 60 J ( the) S 60 J ( address) S 60 J ( of) S 60 J ( the) S 60 J ( context) S 
1680 8620 P (data,) S 60 J ( if) S 60 J ( any.) S 
1200 9000 P (A) S 60 J ( miniport) S 60 J ( driver) S 60 J ( can) S 60 J ( have) S 60 J ( a) S 60 J ( set) S 60 J ( of) S 60 J ( bus-type-specific) S 60 J ( HwFindAdapter) S 60 J ( routines) S 60 J ( if) S 60 J ( its) S 60 J ( HBA) S 60 J ( can) S 
1200 9260 P (be) S 60 J ( connected) S 60 J ( on) S 60 J ( various) S 60 J ( types) S 60 J ( of) S 60 J ( I/O) S 60 J ( bus.) S 60 J ( Such) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( must) S 60 J ( modify) S 60 J ( the) S 
1200 9520 P 0 12 F 24 12 F B (AdapterInterfaceType) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (HwFindAdapter) S E 0 12 F 24 12 F () S 60 J ( fields) S 60 J ( in) S 60 J ( the) S 60 J ( HW_INITIALIZATION_DATA) S 
1200 9780 P (after) S 60 J ( each) S 60 J ( call) S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F (,) S 60 J ( possibly) S 60 J ( modify) S 60 J ( the) S 60 J ( context) S 60 J ( data) S 60 J ( for) S 60 J ( the) S 60 J ( new) S 60 J ( bus) S 60 J ( type,) S 
1200 10040 P (and) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( for) S 60 J ( each) S 60 J ( type) S 60 J ( of) S 60 J ( bus) S 60 J ( on) S 60 J ( which) S 60 J ( a) S 60 J ( supported) S 60 J ( HBA) S 60 J ( might) S 60 J ( be) S 
1200 10300 P (connected.) S 
1200 10680 P 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( checks) S 60 J ( the) S 60 J ( validity) S 60 J ( of) S 60 J ( the) S 60 J ( HW_INITIALIZATION_DATA,) S 60 J ( collects) S 60 J ( and) S 
1200 10940 P (stores) S 60 J ( pertinent) S 60 J ( information) S 60 J ( in) S 60 J ( the) S 60 J ( device) S 60 J ( extension) S 60 J ( of) S 60 J ( a) S 60 J ( device) S 60 J ( object) S 60 J ( that) S 60 J ( it) S 60 J ( creates) S 60 J ( to) S 
1200 11200 P (represent) S 60 J ( the) S 60 J ( HBA,) S 60 J ( allocates) S 60 J ( memory) S 60 J ( for) S 60 J ( a) S 60 J ( PORT_CONFIGURATION_INFORMATION-) S 
1200 11460 P (type) S 60 J ( buffer,) S 60 J ( fills) S 60 J ( in) S 60 J ( as) S 60 J ( much) S 60 J ( configuration) S 60 J ( information) S 60 J ( as) S 60 J ( it) S 60 J ( can,) S 60 J ( and) S 60 J ( calls) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver's) S 
1200 11720 P (HwFindAdapter) S 60 J ( routine,) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.4.1.1,) S 60 J ( next.) S 
1200 12100 P (If) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( sets) S 60 J ( a) S 60 J ( particular) S 60 J ( ) S 0 12 F 24 12 F B (AdapterInterfaceType) S E 0 12 F 24 12 F () S 60 J ( value) S 60 J ( in) S 60 J ( the) S 
1200 12360 P (HW_INITIALIZATION_DATA) S 60 J ( but) S 60 J ( there) S 60 J ( is) S 60 J ( no) S 60 J ( bus) S 60 J ( of) S 60 J ( that) S 60 J ( type) S 60 J ( in) S 60 J ( the) S 60 J ( machine,) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 
1200 12620 P (driver) S 60 J ( returns) S 60 J ( STATUS_DEVICE_DOES_NOT_EXIST.) S 60 J ( It) S 60 J ( does) S 60 J ( not) S 60 J ( call) S 60 J ( the) S 60 J ( driver-supplied) S 
1200 12880 P (HwFindAdapter) S 60 J ( routine) S 60 J ( for) S 60 J ( that) S 60 J ( bus) S 60 J ( type.) S 60 J ( The) S 60 J ( miniport) S 60 J ( driver) S 60 J ( does) S 60 J ( not) S 60 J ( remain) S 60 J ( loaded) S 60 J ( if) S 60 J ( its) S 
1200 13140 P (HBA) S 60 J ( can) S 60 J ( be) S 60 J ( connected) S 60 J ( only) S 60 J ( to) S 60 J ( one) S 60 J ( or) S 60 J ( more) S 60 J ( types) S 60 J ( of) S 60 J ( bus) S 60 J ( that) S 60 J ( are) S 60 J ( not) S 60 J ( present) S 60 J ( in) S 60 J ( the) S 60 J ( machine.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (23) S E 
1920 2180 P 0 12 F 24 12 F (Note) S 60 J ( that) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( is) S 60 J ( responsible) S 60 J ( for) S 60 J ( the) S 60 J ( following) S 60 J ( before) S 60 J ( it) S 60 J ( returns) S 60 J ( control) S 60 J ( to) S 60 J ( the) S 
1920 2440 P (miniport's) S 60 J ( DriverEntry) S 60 J ( routine:) S 
1920 2760 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Setting) S 60 J ( up) S 60 J ( all) S 60 J ( necessary) S 60 J ( system) S 60 J ( objects) S 
1920 3080 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Getting) S 60 J ( configuration) S 60 J ( information) S 60 J ( from) S 60 J ( and) S 60 J ( setting) S 60 J ( configuration) S 60 J ( information) S 60 J ( in) S 60 J ( the) S 
2400 3340 P (registry) S 
1920 3660 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Allocating) S 60 J ( system) S 60 J ( resources) S 60 J ( on) S 60 J ( behalf) S 60 J ( of) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver,) S 60 J ( including) S 60 J ( memory) S 60 J ( for) S 60 J ( the) S 
2400 3920 P (miniport-specified) S 60 J ( ) S 0 12 F 24 12 F B (DeviceExtensionSize) S E 0 12 F 24 12 F (,) S 60 J ( ) S 0 12 F 24 12 F B (SpecificLuExtensionSize) S E 0 12 F 24 12 F (,) S 60 J ( and/or) S 
2400 4180 P 0 12 F 24 12 F B (SrbExtensionSize) S E 0 12 F 24 12 F () S 60 J ( in) S 60 J ( which) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( can) S 60 J ( maintain) S 60 J ( HBA-specific) S 60 J ( state,) S 60 J ( per-) S 
2400 4440 P (logical-unit) S 60 J ( state,) S 60 J ( and/or) S 60 J ( per-request) S 60 J ( state,) S 60 J ( respectively) S 
1920 4820 P (The) S 60 J ( miniport) S 60 J ( driver) S 60 J ( defines) S 60 J ( the) S 60 J ( internal) S 60 J ( structure) S 60 J ( and) S 60 J ( contents) S 60 J ( of) S 60 J ( its) S 60 J ( device) S 60 J ( extension,) S 60 J ( logical) S 
1920 5080 P (unit) S 60 J ( extensions) S 60 J ( \(if) S 60 J ( any\),) S 60 J ( and) S 60 J ( SRB) S 60 J ( extensions) S 60 J ( \(if) S 60 J ( any\).) S 60 J ( A) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( device) S 60 J ( extension) S 60 J ( is) S 60 J ( an) S 
1920 5340 P (input) S 60 J ( argument) S 60 J ( to) S 60 J ( every) S 60 J ( system-defined) S 60 J ( miniport) S 60 J ( driver) S 60 J ( routine) S 60 J ( except) S 60 J ( DriverEntry.) S 60 J ( Many) S 
1920 5600 P 0 12 F 24 12 F B (ScsiPort) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines) S 60 J ( require) S 60 J ( this) S 60 J ( pointer) S 60 J ( as) S 60 J ( an) S 60 J ( argument.) S 
1920 5980 P (When) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( returns) S 60 J ( control,) S 60 J ( the) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( propagates) S 60 J ( the) S 60 J ( return) S 60 J ( value) S 
1920 6240 P (of) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( when) S 60 J ( DriverEntry) S 60 J ( itself) S 60 J ( returns) S 60 J ( control.) S 60 J ( If) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( calls) S 
1920 6500 P 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( more) S 60 J ( than) S 60 J ( once,) S 60 J ( its) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( should) S 60 J ( propagate) S 60 J ( the) S 60 J ( lowest) S 60 J ( return) S 
1920 6760 P (value.) S 
1920 7140 P 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( can) S 60 J ( be) S 60 J ( called) S 60 J ( only) S 60 J ( from) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver's) S 60 J ( DriverEntry) S 60 J ( routine.) S 60 J ( For) S 60 J ( more) S 
1920 7400 P (information) S 60 J ( about) S 60 J ( the) S 60 J ( HW_INITIALIZATION_DATA) S 60 J ( structure) S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F (,) S 60 J ( see) S 
1920 7660 P (the) S 60 J ( ) S 0 12 F 24 12 F I (Kernel-mode) S 60 J ( Driver) S 60 J ( Reference) S E 0 12 F 24 12 F (.) S 
1920 8180 P 0 12 F 8 12 F B (B.4.1.1) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwFindAdapter) S 67 J ( Routines) S E 
1920 8800 P 0 12 F 24 12 F (The) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( fills) S 60 J ( in) S 60 J ( as) S 60 J ( much) S 60 J ( PORT_CONFIGURATION_INFORMATION) S 60 J ( as) S 60 J ( it) S 60 J ( can) S 
1920 9060 P (from) S 60 J ( the) S 60 J ( miniport's) S 60 J ( returned) S 60 J ( HW_INITIALIZATION_DATA) S 60 J ( and) S 60 J ( from) S 60 J ( the) S 60 J ( registry) S 60 J ( before) S 
1920 9320 P (calling) S 60 J ( a) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( with) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( configuration) S 60 J ( information) S 60 J ( buffer.) S 60 J ( In) S 
1920 9580 P (particular,) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 60 J ( always) S 60 J ( sets) S 60 J ( the) S 60 J ( following:) S 
1920 9900 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (Length) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (sizeof) S E 0 12 F 24 12 F (\(PORT_CONFIGURATION_INFORMATION\)) S 
1920 10220 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (AdapterInterfaceType) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HW_INITIALIZATION_DATA) S 60 J ( specification) S 
1920 10540 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (InterruptMode) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (LevelSensitive) S E 0 12 F 24 12 F () S 60 J ( if) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (AdapterInterfaceType) S E 0 12 F 24 12 F () S 60 J ( is) S 60 J ( set) S 60 J ( to) S 
2400 10800 P 0 12 F 24 12 F B (MicroChannel) S E 0 12 F 24 12 F (;) S 60 J ( otherwise,) S 60 J ( set) S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (Latched) S E 
2400 11120 P 0 12 F 24 12 F (If) S 60 J ( the) S 60 J ( miniport) S 60 J ( has) S 60 J ( no) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( and,) S 60 J ( therefore,) S 60 J ( set) S 60 J ( this) S 60 J ( entry) S 60 J ( point) S 60 J ( to) S 60 J ( NULL) S 60 J ( in) S 
2400 11380 P (the) S 60 J ( HW_INITIALIZATION_DATA,) S 60 J ( this) S 60 J ( field) S 60 J ( is) S 60 J ( irrelevant.) S 
1920 11700 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (AtdiskPrimaryClaimed) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( TRUE) S 60 J ( if) S 60 J ( a) S 60 J ( previously) S 60 J ( loaded) S 60 J ( driver) S 60 J ( is) S 60 J ( using) S 60 J ( the) S 60 J ( I/O) S 60 J ( port) S 
2400 11960 P (range) S 60 J ( 0x1F0) S 60 J ( to) S 60 J ( 0x1FF) S 
1920 12280 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (AtdiskSecondaryClaimed) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( TRUE) S 60 J ( if) S 60 J ( a) S 60 J ( previously) S 60 J ( loaded) S 60 J ( driver) S 60 J ( is) S 60 J ( using) S 60 J ( the) S 60 J ( I/O) S 60 J ( port) S 
2400 12540 P (range) S 60 J ( 0x170) S 60 J ( to) S 60 J ( 0x17F) S 
1920 12860 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (NumberOfAccessRanges) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HW_INITIALIZATION_DATA) S 
2400 13120 P (specification) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (24) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2060 P 0 12 F 24 12 F (The) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( also) S 60 J ( attempts) S 60 J ( to) S 60 J ( fill) S 60 J ( in) S 60 J ( the) S 60 J ( following) S 60 J ( fields) S 60 J ( with) S 60 J ( values) S 60 J ( from) S 60 J ( the) S 60 J ( registry:) S 
1200 2380 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (SystemIoBusNumber) S E 0 12 F 24 12 F () S 60 J ( set) S 60 J ( to) S 60 J ( zero) S 60 J ( if) S 60 J ( there) S 60 J ( is) S 60 J ( only) S 60 J ( one) S 60 J ( bus) S 60 J ( of) S 60 J ( a) S 60 J ( particular) S 60 J ( type) S 60 J ( in) S 60 J ( the) S 
1680 2640 P (machine) S 
1200 2960 P () S 224 J ( ) S 256 J ( Otherwise,) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( can) S 60 J ( be) S 60 J ( called) S 60 J ( for) S 60 J ( each) S 60 J ( bus) S 60 J ( of) S 60 J ( the) S 60 J ( given) S 
1680 3220 P 0 12 F 24 12 F B (AdapterInterfaceType) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( an) S 60 J ( updated) S 60 J ( value) S 60 J ( for) S 60 J ( ) S 0 12 F 24 12 F B (SystemIoBusNumber) S E 0 12 F 24 12 F (,) S 60 J ( or) S 60 J ( this) S 60 J ( value) S 
1680 3480 P (can) S 60 J ( be) S 60 J ( set) S 60 J ( to) S 60 J ( a) S 60 J ( value) S 60 J ( from) S 60 J ( the) S 60 J ( registry) S 60 J ( if) S 60 J ( the) S 60 J ( system) S 60 J ( detects) S 60 J ( an) S 60 J ( HBA) S 60 J ( on) S 60 J ( a) S 60 J ( particular) S 60 J ( bus.) S 
1200 3800 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (AccessRanges) S E 0 12 F 24 12 F () S 60 J ( elements,) S 60 J ( set) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (RangeStart) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (RangeLength) S E 0 12 F 24 12 F () S 60 J ( of) S 60 J ( each) S 60 J ( element,) S 60 J ( as) S 
1680 4060 P (well) S 60 J ( as) S 60 J ( whether) S 60 J ( each) S 60 J ( element) S 60 J ( is) S 60 J ( a) S 60 J ( ) S 0 12 F 24 12 F B (RangeInMemory) S E 
1200 4380 P 0 12 F 24 12 F () S 224 J ( ) S 256 J ( ) S 0 12 F 24 12 F B (RangeInMemory) S E 0 12 F 24 12 F () S 60 J ( set) S 60 J ( to) S 60 J ( FALSE) S 60 J ( indicates) S 60 J ( a) S 60 J ( range) S 60 J ( of) S 60 J ( ports) S 60 J ( in) S 60 J ( I/O) S 60 J ( space,) S 60 J ( rather) S 60 J ( than) S 60 J ( a) S 
1680 4640 P (memory-mapped) S 60 J ( range.) S 
1200 4960 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (BusInterruptLevel) S E 0 12 F 24 12 F () S 60 J ( or) S 60 J ( ) S 0 12 F 24 12 F B (BusInterruptVector) S E 
1680 5280 P 0 12 F 24 12 F (This) S 60 J ( field) S 60 J ( is) S 60 J ( irrelevant) S 60 J ( if) S 60 J ( the) S 60 J ( miniport) S 60 J ( has) S 60 J ( no) S 60 J ( HwInterrupt) S 60 J ( routine.) S 
1200 5600 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (DmaChannel) S E 0 12 F 24 12 F () S 60 J ( or) S 60 J ( ) S 0 12 F 24 12 F B (DmaPort) S E 0 12 F 24 12 F () S 60 J ( if) S 60 J ( the) S 60 J ( HBA) S 60 J ( uses) S 60 J ( system) S 60 J ( DMA) S 
1200 5920 P () S 224 J ( ) S 256 J ( If) S 60 J ( the) S 60 J ( HBA) S 60 J ( is) S 60 J ( a) S 60 J ( busmaster) S 60 J ( or) S 60 J ( uses) S 60 J ( PIO,) S 60 J ( these) S 60 J ( fields) S 60 J ( in) S 60 J ( the) S 
1680 6180 P (PORT_CONFIGURATION_INFORMATION) S 60 J ( are) S 60 J ( irrelevant.) S 
1200 6500 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (InitiatorBusId) S E 
1200 6880 P 0 12 F 24 12 F (A) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( calls) S 60 J ( ) S 0 12 F 24 12 F B (ScsiGetBusData) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( examines) S 60 J ( the) S 60 J ( returned) S 60 J ( bus-type-specific) S 
1200 7140 P (configuration) S 60 J ( information,) S 60 J ( such) S 60 J ( as) S 60 J ( POS) S 60 J ( data) S 60 J ( or) S 60 J ( EISA) S 60 J ( configuration) S 60 J ( data,) S 60 J ( for) S 60 J ( a) S 60 J ( supported) S 
1200 7400 P (HBA.) S 60 J ( If) S 60 J ( the) S 60 J ( input) S 60 J ( PORT_CONFIGURATION_INFORMATION) S 60 J ( ) S 0 12 F 24 12 F B (AccessRanges) S E 0 12 F 24 12 F () S 60 J ( elements) S 
1200 7660 P (have) S 60 J ( been) S 60 J ( filled) S 60 J ( in) S 60 J ( from) S 60 J ( the) S 60 J ( registry,) S 60 J ( the) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( should) S 60 J ( use) S 60 J ( these) S 60 J ( addresses) S 
1200 7920 P (and) S 60 J ( should) S 60 J ( not) S 60 J ( scan) S 60 J ( for) S 60 J ( adapters) S 60 J ( at) S 60 J ( other) S 60 J ( locations.) S 
1200 8300 P (If) S 60 J ( HwFindAdapter) S 60 J ( cannot) S 60 J ( find) S 60 J ( an) S 60 J ( HBA) S 60 J ( it) S 60 J ( supports,) S 60 J ( it) S 60 J ( should) S 60 J ( set) S 60 J ( ) S 0 12 F 24 12 F I (Again) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( FALSE) S 60 J ( and) S 60 J ( return) S 
1200 8560 P (SP_RETURN_NOT_FOUND.) S 60 J ( If) S 60 J ( the) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( finds) S 60 J ( a) S 60 J ( supported) S 60 J ( HBA) S 60 J ( but) S 60 J ( the) S 
1200 8820 P (input) S 60 J ( PORT_CONFIGURATION_INFORMATION) S 60 J ( has) S 60 J ( invalid) S 60 J ( data) S 60 J ( \(such) S 60 J ( as) S 60 J ( an) S 60 J ( invalid) S 
1200 9080 P 0 12 F 24 12 F B (DmaChannel) S E 0 12 F 24 12 F () S 60 J ( or) S 60 J ( ) S 0 12 F 24 12 F B (BusInterruptLevel) S E 0 12 F 24 12 F () S 60 J ( on) S 60 J ( an) S 60 J ( EISA) S 60 J ( bus\),) S 60 J ( it) S 60 J ( should) S 60 J ( set) S 60 J ( ) S 0 12 F 24 12 F I (Again) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( FALSE) S 60 J ( and) S 
1200 9340 P (return) S 60 J ( SP_RETURN_BAD_CONFIG.) S 
1200 9720 P (Note) S 60 J ( that) S 60 J ( setting) S 60 J ( ) S 0 12 F 24 12 F I (Again) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( FALSE) S 60 J ( and) S 60 J ( returning) S 60 J ( control) S 60 J ( with) S 60 J ( SP_RETURN_NOT_FOUND) S 60 J ( or) S 
1200 9980 P (SP_RETURN_BAD_CONFIG) S 60 J ( indicates) S 60 J ( that) S 60 J ( a) S 60 J ( given) S 60 J ( I/O) S 60 J ( bus,) S 60 J ( identified) S 60 J ( by) S 60 J ( the) S 
1200 10240 P 0 12 F 24 12 F B (SystemIoBusNumber) S E 0 12 F 24 12 F () S 60 J ( in) S 60 J ( the) S 60 J ( input) S 60 J ( PORT_CONFIGURATION_INFORMATION) S 60 J ( buffer,) S 60 J ( has) S 
1200 10500 P (no) S 60 J ( HBAs) S 60 J ( connected) S 60 J ( that) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( can) S 60 J ( support.) S 60 J ( It) S 60 J ( does) S 60 J ( not) S 60 J ( prevent) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 
1200 10760 P (driver) S 60 J ( from) S 60 J ( calling) S 60 J ( HwFindAdapter) S 60 J ( again) S 60 J ( with) S 60 J ( updated) S 
1200 11020 P (PORT_CONFIGURATION_INFORMATION) S 60 J ( to) S 60 J ( scan) S 60 J ( another) S 60 J ( I/O) S 60 J ( bus) S 60 J ( for) S 60 J ( HBA\(s\)) S 60 J ( if) S 60 J ( the) S 
1200 11280 P (machine) S 60 J ( has) S 60 J ( additional) S 60 J ( buses) S 60 J ( of) S 60 J ( the) S 60 J ( same) S 60 J ( ) S 0 12 F 24 12 F B (AdapterInterfaceType) S E 0 12 F 24 12 F (.) S 
1200 11660 P (When) S 60 J ( the) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( finds) S 60 J ( an) S 60 J ( HBA) S 60 J ( it) S 60 J ( can) S 60 J ( support,) S 60 J ( this) S 60 J ( routine) S 60 J ( must) S 60 J ( fill) S 60 J ( in) S 
1200 11920 P (pertinent) S 60 J ( fields,) S 60 J ( as) S 60 J ( appropriate) S 60 J ( for) S 60 J ( its) S 60 J ( HBA) S 60 J ( and) S 60 J ( the) S 60 J ( given) S 60 J ( ) S 0 12 F 24 12 F B (AdapterInterfaceType) S E 0 12 F 24 12 F (,) S 60 J ( in) S 60 J ( the) S 60 J ( input) S 
1200 12180 P (PORT_CONFIGURATION_INFORMATION) S 60 J ( buffer.) S 60 J ( Every) S 60 J ( miniport) S 60 J ( driver) S 60 J ( must) S 60 J ( fill) S 60 J ( in) S 60 J ( the) S 
1200 12440 P 0 12 F 24 12 F B (AccessRanges) S E 0 12 F 24 12 F () S 60 J ( information,) S 60 J ( converting) S 60 J ( each) S 60 J ( ) S 0 12 F 24 12 F B (AccessRanges) S E 0 12 F 24 12 F () S 60 J ( element's) S 60 J ( ) S 0 12 F 24 12 F B (RangeStart) S E 0 12 F 24 12 F () S 60 J ( value) S 60 J ( with) S 
1200 12700 P 0 12 F 24 12 F B (ScsiPortConvertUlongToPhysicalAddress) S E 0 12 F 24 12 F (.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (25) S E 
1920 2060 P 0 12 F 24 12 F (For) S 60 J ( an) S 60 J ( "AT-compatible") S 60 J ( HBA,) S 60 J ( the) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( should) S 60 J ( check) S 60 J ( the) S 60 J ( input) S 
1920 2320 P 0 12 F 24 12 F B (Atdisk..Claimed) S E 0 12 F 24 12 F () S 60 J ( fields) S 60 J ( and) S 60 J ( attempt) S 60 J ( to) S 60 J ( claim) S 60 J ( an) S 60 J ( "AT") S 60 J ( range) S 60 J ( by) S 60 J ( resetting) S 60 J ( the) S 60 J ( value) S 60 J ( to) S 60 J ( TRUE.) S 
1920 2700 P (The) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( can) S 60 J ( set) S 60 J ( ) S 0 12 F 24 12 F I (Again) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( TRUE) S 60 J ( to) S 60 J ( indicate) S 60 J ( it) S 60 J ( should) S 60 J ( be) S 60 J ( called) S 60 J ( again) S 60 J ( ) S 0 12 F 24 12 F I (with) S E 
1920 2960 P I (exactly) S 60 J ( the) S 60 J ( same) S 60 J ( configuration) S 60 J ( information) S E 0 12 F 24 12 F () S 60 J ( if) S 60 J ( another) S 60 J ( of) S 60 J ( its) S 60 J ( HBAs) S 60 J ( might) S 60 J ( be) S 60 J ( connected) S 60 J ( on) S 60 J ( the) S 
1920 3220 P (same) S 60 J ( I/O) S 60 J ( bus.) S 60 J ( For) S 60 J ( a) S 60 J ( supported) S 60 J ( HBA,) S 60 J ( the) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( returns) S 
1920 3480 P (SP_RETURN_FOUND.) S 
1920 3860 P (If) S 60 J ( the) S 60 J ( PORT_CONFIGURATION_INFORMATION) S 60 J ( buffer) S 60 J ( input) S 60 J ( to) S 60 J ( the) S 60 J ( HwFindAdapter) S 
1920 4120 P (routine) S 60 J ( has) S 60 J ( no) S 60 J ( configuration) S 60 J ( information) S 60 J ( from) S 60 J ( the) S 60 J ( registry,) S 60 J ( HwFindAdapter) S 60 J ( can) S 60 J ( set) S 60 J ( driver-) S 
1920 4380 P (defined) S 60 J ( default) S 60 J ( values) S 60 J ( for) S 60 J ( ) S 0 12 F 24 12 F B (AccessRanges) S E 0 12 F 24 12 F () S 60 J ( elements,) S 60 J ( ) S 0 12 F 24 12 F B (InterruptLevel) S E 0 12 F 24 12 F () S 60 J ( or) S 60 J ( ) S 0 12 F 24 12 F B (BusInterruptVector) S E 0 12 F 24 12 F (,) S 
1920 4640 P 0 12 F 24 12 F B (DmaChannel) S E 0 12 F 24 12 F () S 60 J ( or) S 60 J ( ) S 0 12 F 24 12 F B (DmaPort) S E 0 12 F 24 12 F () S 60 J ( if) S 60 J ( the) S 60 J ( HBA) S 60 J ( uses) S 60 J ( system) S 60 J ( DMA,) S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (InitiatorBusId) S E 0 12 F 24 12 F (,) S 60 J ( and,) S 60 J ( then,) S 60 J ( call) S 
1920 4900 P 0 12 F 24 12 F B (ScsiPortGetBusData) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( examine) S 60 J ( the) S 60 J ( returned) S 60 J ( configuration) S 60 J ( information) S 60 J ( for) S 60 J ( a) S 60 J ( supported) S 
1920 5160 P (HBA) S 60 J ( on) S 60 J ( the) S 60 J ( I/O) S 60 J ( bus.) S 
1920 5540 P (Certain) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPort) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines) S 60 J ( can) S 60 J ( be) S 60 J ( called) S 60 J ( ) S 0 12 F 24 12 F I (only) S E 0 12 F 24 12 F () S 60 J ( from) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver's) S 60 J ( HwFindAdapter) S 
1920 5800 P (routine\(s\),) S 60 J ( in) S 60 J ( particular,) S 60 J ( the) S 60 J ( following:) S 
1920 6120 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (ScsiPortGetBusData) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( get) S 60 J ( BUS_DATA_TYPE-specific) S 60 J ( configuration) S 60 J ( information) S 
1920 6440 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (ScsiPortGetDeviceBase) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( map) S 60 J ( the) S 60 J ( \(bus-relative\)) S 60 J ( base) S 60 J ( physical) S 60 J ( address) S 60 J ( range) S 60 J ( for) S 60 J ( an) S 
2400 6700 P (HBA) S 60 J ( to) S 60 J ( a) S 60 J ( system) S 60 J ( address) S 60 J ( range) S 60 J ( that) S 60 J ( the) S 60 J ( driver) S 60 J ( can) S 60 J ( use) S 60 J ( to) S 60 J ( communicate) S 60 J ( with) S 60 J ( the) S 60 J ( HBA) S 60 J ( by) S 
2400 6960 P (calling) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortRead) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortWrite) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines) S 
1920 7280 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (ScsiPortFreeDeviceBase) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( release) S 60 J ( such) S 60 J ( a) S 60 J ( mapped) S 60 J ( range) S 60 J ( if) S 60 J ( HwFindAdapter) S 60 J ( does) S 60 J ( not) S 
2400 7540 P (find) S 60 J ( an) S 60 J ( HBA) S 60 J ( it) S 60 J ( can) S 60 J ( support) S 60 J ( on) S 60 J ( a) S 60 J ( given) S 60 J ( I/O) S 60 J ( bus) S 60 J ( \(as) S 60 J ( indicated) S 60 J ( by) S 60 J ( the) S 
2400 7800 P (PORT_CONFIGURATION_INFORMATION) S 60 J ( ) S 0 12 F 24 12 F B (SystemIoBusNumber) S E 0 12 F 24 12 F () S 60 J ( value\)) S 
1920 8120 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( ) S 0 12 F 24 12 F B (ScsiPortGetUncachedExtension) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( allocate) S 60 J ( a) S 60 J ( DMA) S 60 J ( buffer) S 60 J ( shared) S 60 J ( between) S 60 J ( the) S 60 J ( system) S 
2400 8380 P (and) S 60 J ( a) S 60 J ( busmaster) S 60 J ( HBA) S 
1920 8760 P (For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( the) S 60 J ( PORT_CONFIGURATION_INFORMATION) S 60 J ( structure) S 60 J ( and) S 
1920 9020 P (these) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPort) S E 0 12 F 24 12 F I (Xxx) S E 0 12 F 24 12 F () S 60 J ( routines,) S 60 J ( see) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (Kernel-mode) S 60 J ( Driver) S 60 J ( Reference) S E 0 12 F 24 12 F (.) S 
1920 9400 P (When) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver's) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( returns) S 60 J ( control,) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( returns) S 60 J ( to) S 
1920 9660 P (the) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( if) S 60 J ( the) S 60 J ( call\(s\)) S 60 J ( to) S 60 J ( HwFindAdapter) S 60 J ( indicated) S 60 J ( that) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 
1920 9920 P (could) S 60 J ( not) S 60 J ( support) S 60 J ( an) S 60 J ( HBA.) S 60 J ( Otherwise,) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( claims) S 60 J ( resources) S 60 J ( in) S 60 J ( the) S 60 J ( registry,) S 60 J ( sets) S 
1920 10180 P (up) S 60 J ( necessary) S 60 J ( system) S 60 J ( objects) S 60 J ( \(such) S 60 J ( as) S 60 J ( interrupt) S 60 J ( and) S 60 J ( adapter) S 60 J ( objects\)) S 60 J ( on) S 60 J ( behalf) S 60 J ( of) S 60 J ( the) S 60 J ( miniport) S 
1920 10440 P (driver,) S 60 J ( and) S 60 J ( calls) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwInitialize) S 60 J ( routine,) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.4.1.2,) S 60 J ( next.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (26) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2060 P 0 12 F 24 12 F (In) S 60 J ( addition) S 60 J ( to) S 60 J ( the) S 60 J ( values) S 60 J ( it) S 60 J ( sets) S 60 J ( in) S 60 J ( the) S 60 J ( PORT_CONFIGURATION_INFORMATION) S 60 J ( buffer,) S 
1200 2320 P 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( also) S 60 J ( checks) S 60 J ( the) S 60 J ( registry) S 60 J ( for) S 60 J ( user-set) S 60 J ( values) S 60 J ( that) S 60 J ( disable) S 60 J ( any) S 60 J ( or) S 60 J ( all) S 60 J ( of) S 60 J ( the) S 
1200 2580 P (following:) S 
1200 2900 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Synchronous) S 60 J ( transfers) S 60 J ( on) S 60 J ( the) S 60 J ( HBA) S 
1680 3220 P (The) S 60 J ( port) S 60 J ( driver) S 60 J ( ORs) S 60 J ( the) S 60 J ( default) S 60 J ( ) S 0 12 F 24 12 F B (SrbFlags) S E 0 12 F 24 12 F () S 60 J ( that) S 60 J ( it) S 60 J ( maintains) S 60 J ( for) S 60 J ( the) S 60 J ( HBA) S 60 J ( with) S 
1680 3480 P (SRB_FLAGS_DISABLE_SYNCH_TRANSFER.) S 
1200 3800 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Bus-disconnect) S 60 J ( operations) S 60 J ( on) S 60 J ( the) S 60 J ( HBA) S 
1680 4120 P (The) S 60 J ( port) S 60 J ( driver) S 60 J ( ORs) S 60 J ( the) S 60 J ( default) S 60 J ( ) S 0 12 F 24 12 F B (SrbFlags) S E 0 12 F 24 12 F () S 60 J ( with) S 
1680 4380 P (SRB_FLAGS_DISABLE_DISCONNECT.) S 
1200 4700 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Tagged) S 60 J ( queueing) S 
1680 5020 P (The) S 60 J ( port) S 60 J ( driver) S 60 J ( sets) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (TaggedQueuing) S E 0 12 F 24 12 F () S 60 J ( Boolean) S 60 J ( that) S 60 J ( it) S 60 J ( maintains) S 60 J ( for) S 60 J ( the) S 60 J ( HBA) S 60 J ( to) S 
1680 5280 P (FALSE.) S 
1200 5600 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Internal) S 60 J ( queueing) S 60 J ( of) S 60 J ( requests) S 60 J ( on) S 60 J ( the) S 60 J ( HBA) S 
1680 5920 P (The) S 60 J ( port) S 60 J ( driver) S 60 J ( sets) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (MultipleRequestPerLu) S E 0 12 F 24 12 F () S 60 J ( Boolean) S 60 J ( that) S 60 J ( it) S 60 J ( maintains) S 60 J ( about) S 60 J ( the) S 60 J ( HBA) S 
1680 6180 P (to) S 60 J ( FALSE.) S 
1200 6560 P (If) S 60 J ( any) S 60 J ( of) S 60 J ( the) S 60 J ( immediately) S 60 J ( preceding) S 60 J ( "disable") S 60 J ( values) S 60 J ( are) S 60 J ( in) S 60 J ( the) S 60 J ( registry,) S 60 J ( it) S 60 J ( overrides) S 60 J ( whatever) S 
1200 6820 P (the) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( sets) S 60 J ( in) S 60 J ( the) S 60 J ( PORT_CONFIGURATION_INFORMATION) S 60 J ( buffer.) S 
1200 7080 P (Note) S 60 J ( that) S 60 J ( temporarily) S 60 J ( disabling) S 60 J ( synchronous) S 60 J ( transfers,) S 60 J ( bus-disconnect) S 60 J ( operations,) S 60 J ( tagged) S 
1200 7340 P (queueing,) S 60 J ( and) S 60 J ( HBA) S 60 J ( internal) S 60 J ( request) S 60 J ( queueing) S 60 J ( can) S 60 J ( simplify) S 60 J ( using) S 60 J ( a) S 60 J ( debugger) S 60 J ( to) S 60 J ( trace) S 60 J ( request) S 
1200 7600 P (handling) S 60 J ( in) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( that) S 60 J ( is) S 60 J ( under) S 60 J ( development.) S 
1200 7980 P (Note) S 60 J ( also) S 60 J ( that) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( uses) S 60 J ( the) S 60 J ( PORT_CONFIGURATION_INFORMATION) S 
1200 8240 P (values) S 60 J ( provided) S 60 J ( by) S 60 J ( a) S 60 J ( miniport's) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( and/or) S 60 J ( in) S 60 J ( the) S 60 J ( registry) S 60 J ( to) S 60 J ( fill) S 60 J ( in) S 60 J ( the) S 
1200 8500 P (IO_SCSI_CAPABILITIES) S 60 J ( data) S 60 J ( for) S 60 J ( use) S 60 J ( by) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers,) S 60 J ( as) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.1.1.4.) S 
1200 9020 P 0 12 F 8 12 F B (B.4.1.2) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwInitialize) S 67 J ( Routine) S E 
1200 9640 P 0 12 F 24 12 F (For) S 60 J ( each) S 60 J ( HBA) S 60 J ( found) S 60 J ( by) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver,) S 60 J ( its) S 60 J ( HwInitialize) S 60 J ( routine) S 60 J ( is) S 60 J ( called) S 60 J ( to) S 60 J ( set) S 60 J ( up) S 60 J ( the) S 
1200 9900 P (HBA's) S 60 J ( registers) S 60 J ( and) S 60 J ( initial) S 60 J ( protocol) S 60 J ( state,) S 60 J ( if) S 60 J ( any.) S 
1200 10280 P (If) S 60 J ( the) S 60 J ( HwInitialize) S 60 J ( routine) S 60 J ( enables) S 60 J ( interrupts) S 60 J ( on) S 60 J ( the) S 60 J ( HBA,) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwInterrupt) S 60 J ( routine) S 
1200 10540 P (will) S 60 J ( be) S 60 J ( called) S 60 J ( to) S 60 J ( handle) S 60 J ( any) S 60 J ( interrupts) S 60 J ( the) S 60 J ( device) S 60 J ( generates) S 60 J ( during) S 60 J ( the) S 60 J ( initialization.) S 
1200 10920 P (If) S 60 J ( initializing) S 60 J ( the) S 60 J ( HBA) S 60 J ( causes) S 60 J ( a) S 60 J ( bus) S 60 J ( reset,) S 60 J ( the) S 60 J ( HwInitialize) S 60 J ( routine) S 60 J ( must) S 60 J ( call) S 
1200 11180 P 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( value) S 60 J ( ) S 0 12 F 24 12 F B (ResetDetected) S E 0 12 F 24 12 F (.) S 
1200 11560 P (When) S 60 J ( the) S 60 J ( HwInitialize) S 60 J ( routine) S 60 J ( returns) S 60 J ( control,) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortInitialize) S E 0 12 F 24 12 F () S 60 J ( sends) S 60 J ( SCSIOP_INQUIRY) S 
1200 11820 P (requests) S 60 J ( to) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver,) S 60 J ( collecting) S 60 J ( the) S 60 J ( SCSI-II) S 60 J ( INQUIRYDATA) S 60 J ( about) S 60 J ( the) S 60 J ( devices) S 60 J ( on) S 
1200 12080 P (each) S 60 J ( bus) S 60 J ( and) S 60 J ( storing) S 60 J ( it) S 60 J ( for) S 60 J ( subsequent) S 60 J ( examination) S 60 J ( by) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers,) S 60 J ( as) S 60 J ( described) S 60 J ( in) S 
1200 12340 P (Section) S 60 J ( B.1.1.1.) S 60 J ( Each) S 60 J ( request) S 60 J ( to) S 60 J ( scan) S 60 J ( a) S 60 J ( SCSI) S 60 J ( bus) S 60 J ( for) S 60 J ( the) S 60 J ( INQUIRY) S 60 J ( data) S 60 J ( is) S 60 J ( sent) S 60 J ( to) S 60 J ( the) S 
1200 12600 P (miniport's) S 60 J ( HwStartIo) S 60 J ( routine,) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.4.2,) S 60 J ( next.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (27) S E 
1920 2080 P 0 12 F 8 12 F B (B.4.2) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwStartIo) S 67 J ( Routine) S E 
1920 2700 P 0 12 F 24 12 F (As) S 60 J ( its) S 60 J ( name) S 60 J ( suggests,) S 60 J ( a) S 60 J ( HwStartIo) S 60 J ( routine) S 60 J ( is) S 60 J ( the) S 60 J ( entry) S 60 J ( point) S 60 J ( for) S 60 J ( incoming) S 60 J ( requests) S 60 J ( to) S 
1920 2960 P (peripheral) S 60 J ( devices) S 60 J ( on) S 60 J ( the) S 60 J ( HBA-driven) S 60 J ( bus\(es\).) S 60 J ( HwStartIo) S 60 J ( is) S 60 J ( called) S 60 J ( with) S 60 J ( pointers) S 60 J ( to) S 60 J ( an) S 60 J ( SRB) S 
1920 3220 P (and) S 60 J ( to) S 60 J ( the) S 60 J ( miniport's) S 60 J ( device) S 60 J ( extension) S 60 J ( for) S 60 J ( per-HBA) S 60 J ( state.) S 
1920 3600 P (If) S 60 J ( the) S 60 J ( miniport's) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( also) S 60 J ( requested) S 60 J ( that) S 60 J ( memory) S 60 J ( be) S 60 J ( allocated) S 60 J ( for) S 60 J ( logical) S 60 J ( unit) S 
1920 3860 P (extensions) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.4.1\),) S 60 J ( the) S 60 J ( HwStartIo) S 60 J ( routine) S 60 J ( calls) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortGetLogicalUnit) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 
1920 4120 P (input) S 60 J ( device) S 60 J ( extension) S 60 J ( pointer) S 60 J ( and) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (PathId) S E 0 12 F 24 12 F (,) S 60 J ( ) S 0 12 F 24 12 F B (TargetId) S E 0 12 F 24 12 F (,) S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (Lun) S E 0 12 F 24 12 F () S 60 J ( values) S 60 J ( from) S 60 J ( the) S 60 J ( input) S 60 J ( SRB.) S 
1920 4500 P (If) S 60 J ( the) S 60 J ( DriverEntry) S 60 J ( routine) S 60 J ( requested) S 60 J ( that) S 60 J ( memory) S 60 J ( be) S 60 J ( allocated) S 60 J ( for) S 60 J ( SRB) S 60 J ( extensions,) S 60 J ( the) S 
1920 4760 P 0 12 F 24 12 F B (SrbExtension) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( in) S 60 J ( each) S 60 J ( SRB) S 60 J ( contains) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( miniport's) S 60 J ( per-request) S 60 J ( storage) S 60 J ( area.) S 
1920 5020 P (Note) S 60 J ( that) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( must) S 60 J ( request) S 60 J ( that) S 60 J ( memory) S 60 J ( be) S 60 J ( allocated) S 60 J ( for) S 60 J ( ) S 0 12 F 24 12 F B (SrbExtension) S E 0 12 F 24 12 F (s) S 60 J ( if) S 60 J ( it) S 
1920 5280 P (maintains) S 60 J ( per-request) S 60 J ( state) S 60 J ( information.) S 60 J ( It) S 60 J ( cannot) S 60 J ( use) S 60 J ( an) S 60 J ( SRB) S 60 J ( for) S 60 J ( this) S 60 J ( purpose.) S 60 J ( In) S 60 J ( particular,) S 60 J ( a) S 
1920 5540 P (miniport) S 60 J ( driver) S 60 J ( can) S 60 J ( write) S 60 J ( values) S 60 J ( into) S 60 J ( SRBs) S 60 J ( ) S 0 12 F 24 12 F I (only) S E 0 12 F 24 12 F () S 60 J ( for) S 60 J ( the) S 60 J ( following) S 60 J ( purposes) S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F I (only) S E 0 12 F 24 12 F () S 60 J ( in) S 60 J ( the) S 
1920 5800 P (following) S 60 J ( fields:) S 
1920 6120 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( To) S 60 J ( return) S 60 J ( required) S 60 J ( status) S 60 J ( about) S 60 J ( each) S 60 J ( operation) S 60 J ( in) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (ScsiStatus) S E 0 12 F 24 12 F () S 60 J ( fields) S 
1920 6440 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( If) S 60 J ( an) S 60 J ( underrun) S 60 J ( occurs,) S 60 J ( to) S 60 J ( update) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (DataTransferLength) S E 0 12 F 24 12 F () S 60 J ( field) S 
1920 6760 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( If) S 60 J ( it) S 60 J ( supports) S 60 J ( auto) S 60 J ( request) S 60 J ( sense) S 60 J ( and) S 60 J ( transfers) S 60 J ( request-sense) S 60 J ( information,) S 60 J ( to) S 60 J ( update) S 60 J ( the) S 
2400 7020 P 0 12 F 24 12 F B (SenseInfoBufferLength) S E 
1920 7400 P 0 12 F 24 12 F (After) S 60 J ( the) S 60 J ( higher-level) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( have) S 60 J ( loaded,) S 60 J ( most) S 60 J ( of) S 60 J ( the) S 60 J ( SRBs) S 60 J ( sent) S 60 J ( to) S 60 J ( the) S 60 J ( HwStartIo) S 
1920 7660 P (routine) S 60 J ( have) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( set) S 60 J ( to) S 60 J ( SRB_FUNCTION_EXECUTE_SCSI.) S 60 J ( On) S 60 J ( receipt) S 60 J ( of) S 
1920 7920 P (such) S 60 J ( a) S 60 J ( request,) S 60 J ( the) S 60 J ( StartIo) S 60 J ( routine) S 60 J ( does) S 60 J ( the) S 60 J ( following:) S 
1920 8240 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Gets) S 60 J ( and/or) S 60 J ( sets) S 60 J ( up) S 60 J ( whatever) S 60 J ( context) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( maintains) S 60 J ( in) S 60 J ( its) S 60 J ( device,) S 60 J ( logical) S 
2400 8500 P (unit,) S 60 J ( and/or) S 60 J ( SRB) S 60 J ( extensions) S 
1920 8820 P () S 224 J ( ) S 256 J ( For) S 60 J ( example,) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( might) S 60 J ( set) S 60 J ( up) S 60 J ( a) S 60 J ( logical) S 60 J ( unit) S 60 J ( extension) S 60 J ( with) S 60 J ( pointers) S 60 J ( to) S 60 J ( the) S 
2400 9080 P (SRB) S 60 J ( itself) S 60 J ( and) S 60 J ( the) S 60 J ( SRB) S 60 J ( ) S 0 12 F 24 12 F B (DataBuffer) S E 0 12 F 24 12 F () S 60 J ( pointer,) S 60 J ( the) S 60 J ( SRB) S 60 J ( ) S 0 12 F 24 12 F B (DataTransferLength) S E 0 12 F 24 12 F () S 60 J ( value,) S 60 J ( and) S 60 J ( a) S 
2400 9340 P (driver-defined) S 60 J ( value) S 60 J ( \(or) S 60 J ( CDB) S 60 J ( SCSIOP_) S 0 12 F 24 12 F I (xxx) S E 0 12 F 24 12 F () S 60 J ( value\)) S 60 J ( indicating) S 60 J ( the) S 60 J ( operation) S 60 J ( to) S 60 J ( be) S 60 J ( carried) S 
2400 9600 P (out) S 60 J ( on) S 60 J ( the) S 60 J ( HBA.) S 
1920 9920 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Calls) S 60 J ( an) S 60 J ( internal) S 60 J ( routine) S 60 J ( to) S 60 J ( program) S 60 J ( the) S 60 J ( HBA,) S 60 J ( as) S 60 J ( partially) S 60 J ( directed) S 60 J ( by) S 60 J ( the) S 60 J ( SRB) S 60 J ( ) S 0 12 F 24 12 F B (Flags) S E 0 12 F 24 12 F (,) S 60 J ( for) S 
2400 10180 P (the) S 60 J ( requested) S 60 J ( operation) S 
1920 10500 P () S 224 J ( ) S 256 J ( For) S 60 J ( a) S 60 J ( device) S 60 J ( I/O) S 60 J ( operation,) S 60 J ( such) S 60 J ( an) S 60 J ( internal) S 60 J ( routine) S 60 J ( generally) S 60 J ( selects) S 60 J ( the) S 60 J ( target) S 60 J ( device) S 60 J ( and) S 
2400 10760 P (sends) S 60 J ( the) S 60 J ( CDB) S 60 J ( over) S 60 J ( the) S 60 J ( bus) S 60 J ( to) S 60 J ( the) S 60 J ( target) S 60 J ( logical) S 60 J ( unit.) S 
1920 11140 P (If) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( uses) S 60 J ( system) S 60 J ( DMA,) S 60 J ( it) S 60 J ( must) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortIoMapTransfer) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F I (before) S E 
1920 11400 P 0 12 F 24 12 F (programming) S 60 J ( the) S 60 J ( HBA) S 60 J ( to) S 60 J ( transfer) S 60 J ( data.) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortIoMapTransfer) S E 0 12 F 24 12 F () S 60 J ( sets) S 60 J ( up) S 60 J ( the) S 60 J ( system) S 60 J ( DMA) S 
1920 11660 P (controller) S 60 J ( and) S 60 J ( calls) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwDmaStarted) S 60 J ( routine,) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.4.3,) S 60 J ( next.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (28) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2060 P 0 12 F 24 12 F (A) S 60 J ( HwStartIo) S 60 J ( routine) S 60 J ( is) S 60 J ( also) S 60 J ( responsible) S 60 J ( for) S 60 J ( handling) S 60 J ( incoming) S 60 J ( SRBs) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( field) S 
1200 2320 P (set) S 60 J ( to) S 60 J ( SRB_FUNCTION_ABORT_COMMAND.) S 60 J ( For) S 60 J ( an) S 60 J ( abort) S 60 J ( request,) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 
1200 2580 P (might) S 60 J ( need) S 60 J ( to) S 60 J ( verify) S 60 J ( that) S 60 J ( the) S 60 J ( given) S 60 J ( SRB) S 60 J ( has) S 60 J ( not) S 60 J ( been) S 60 J ( aborted) S 60 J ( already) S 60 J ( by) S 60 J ( calling) S 
1200 2840 P 0 12 F 24 12 F B (ScsiPortGetSrb) S E 0 12 F 24 12 F () S 60 J ( for) S 60 J ( the) S 60 J ( target) S 60 J ( logical) S 60 J ( unit) S 60 J ( and) S 60 J ( comparing) S 60 J ( the) S 60 J ( returned) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( current) S 
1200 3100 P (SRB's) S 60 J ( ) S 0 12 F 24 12 F B (NextSrb) S E 0 12 F 24 12 F () S 60 J ( value.) S 60 J ( If) S 60 J ( they) S 60 J ( are) S 60 J ( unequal,) S 60 J ( the) S 60 J ( current) S 60 J ( SRB) S 60 J ( has) S 60 J ( already) S 60 J ( been) S 60 J ( aborted,) S 60 J ( and) S 60 J ( the) S 
1200 3360 P (miniport) S 60 J ( driver) S 60 J ( should) S 60 J ( do) S 60 J ( the) S 60 J ( following:) S 
1200 3680 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Set) S 60 J ( the) S 60 J ( input) S 60 J ( SRB's) S 60 J ( ) S 0 12 F 24 12 F B (ScsiStatus) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( SRB_STATUS_ABORT_FAILED.) S 
1200 4000 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (RequestComplete) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( with) S 60 J ( the) S 
1680 4260 P (input) S 60 J ( SRB.) S 
1200 4580 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( again) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (NextRequest) S E 0 12 F 24 12 F (,) S 60 J ( or) S 60 J ( with) S 
1680 4840 P 0 12 F 24 12 F B (NextLuRequest) S E 0 12 F 24 12 F () S 60 J ( if) S 60 J ( the) S 60 J ( HBA) S 60 J ( supports) S 60 J ( tagged) S 60 J ( queueing) S 60 J ( or) S 60 J ( multiple) S 60 J ( requests) S 60 J ( per) S 60 J ( logical) S 
1680 5100 P (unit.) S 
1200 5480 P (Otherwise,) S 60 J ( the) S 60 J ( HwStartIo) S 60 J ( routine) S 60 J ( does) S 60 J ( the) S 60 J ( following:) S 
1200 5800 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Sets) S 60 J ( up) S 60 J ( context) S 60 J ( for) S 60 J ( the) S 60 J ( request) S 60 J ( in) S 60 J ( its) S 60 J ( device,) S 60 J ( logical) S 60 J ( unit,) S 60 J ( and/or) S 60 J ( SRB) S 60 J ( extensions) S 
1200 6120 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Programs) S 60 J ( the) S 60 J ( HBA) S 60 J ( to) S 60 J ( abort) S 60 J ( the) S 60 J ( given) S 60 J ( request) S 
1200 6500 P (The) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( always) S 60 J ( sends) S 60 J ( its) S 60 J ( own) S 60 J ( reset-bus) S 60 J ( requests) S 60 J ( directly) S 60 J ( to) S 60 J ( the) S 60 J ( miniport's) S 
1200 6760 P (HwResetBus) S 60 J ( routine,) S 60 J ( described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.4.4.) S 60 J ( However,) S 60 J ( it) S 60 J ( is) S 60 J ( possible) S 60 J ( for) S 60 J ( the) S 60 J ( HwStartIo) S 
1200 7020 P (routine) S 60 J ( to) S 60 J ( be) S 60 J ( called) S 60 J ( with) S 60 J ( an) S 60 J ( SRB) S 60 J ( in) S 60 J ( which) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( is) S 60 J ( set) S 60 J ( to) S 
1200 7280 P (SRB_FUNCTION_RESET_BUS) S 60 J ( if) S 60 J ( a) S 60 J ( SCSI) S 60 J ( class) S 60 J ( driver) S 60 J ( requests) S 60 J ( this) S 60 J ( operation.) S 60 J ( The) S 60 J ( StartIo) S 
1200 7540 P (routine) S 60 J ( can) S 60 J ( simply) S 60 J ( call) S 60 J ( the) S 60 J ( HwResetBus) S 60 J ( routine) S 60 J ( to) S 60 J ( satisfy) S 60 J ( an) S 60 J ( incoming) S 60 J ( reset) S 60 J ( request.) S 
1200 7920 P (If) S 60 J ( the) S 60 J ( HBA) S 60 J ( caches) S 60 J ( data) S 60 J ( internally,) S 60 J ( as) S 60 J ( indicated) S 60 J ( when) S 60 J ( the) S 60 J ( HwFindAdapter) S 60 J ( routine) S 60 J ( \(see) S 60 J ( Section) S 
1200 8180 P (B.4.1.1\)) S 60 J ( set) S 60 J ( up) S 60 J ( the) S 60 J ( PORT_CONFIGURATION_INFORMATION,) S 60 J ( the) S 60 J ( HwStartIo) S 60 J ( routine) S 60 J ( must) S 
1200 8440 P (support) S 60 J ( the) S 60 J ( SRB_FUNCTION_FLUSH) S 60 J ( and) S 60 J ( SRB_FUNCTION_SHUTDOWN) S 60 J ( requests.) S 60 J ( An) S 
1200 8700 P (SRB) S 60 J ( with) S 60 J ( its) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( set) S 60 J ( to) S 60 J ( SRB_FUNCTION_FLUSH) S 60 J ( tells) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( to) S 
1200 8960 P (transfer) S 60 J ( data) S 60 J ( cached) S 60 J ( in) S 60 J ( the) S 60 J ( HBA,) S 60 J ( usually) S 60 J ( to) S 60 J ( a) S 60 J ( disk.) S 60 J ( The) S 60 J ( miniport) S 60 J ( should) S 60 J ( hold) S 60 J ( on) S 60 J ( to) S 60 J ( the) S 60 J ( flush) S 
1200 9220 P (request) S 60 J ( until) S 60 J ( all) S 60 J ( cached) S 60 J ( data) S 60 J ( has) S 60 J ( been) S 60 J ( transferred) S 60 J ( and,) S 60 J ( then,) S 60 J ( complete) S 60 J ( the) S 60 J ( flush) S 60 J ( request.) S 60 J ( \(Such) S 60 J ( a) S 
1200 9480 P (flush) S 60 J ( request) S 60 J ( might) S 60 J ( originate) S 60 J ( when) S 60 J ( an) S 60 J ( application) S 60 J ( closes) S 60 J ( a) S 60 J ( file) S 60 J ( or) S 60 J ( the) S 60 J ( application) S 60 J ( itself) S 60 J ( is) S 
1200 9740 P (terminated.\)) S 
1200 10120 P (An) S 60 J ( SRB) S 60 J ( with) S 60 J ( its) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( set) S 60 J ( to) S 60 J ( SRB_FUNCTION_SHUTDOWN) S 60 J ( tells) S 60 J ( the) S 60 J ( miniport) S 
1200 10380 P (driver) S 60 J ( to) S 60 J ( complete) S 60 J ( transferring) S 60 J ( data,) S 60 J ( including) S 60 J ( flushing) S 60 J ( all) S 60 J ( cached) S 60 J ( data,) S 60 J ( out) S 60 J ( to) S 60 J ( the) S 60 J ( target) S 
1200 10640 P (device.) S 60 J ( The) S 60 J ( miniport) S 60 J ( driver) S 60 J ( should) S 60 J ( hold) S 60 J ( on) S 60 J ( to) S 60 J ( the) S 60 J ( shutdown) S 60 J ( request) S 60 J ( until) S 60 J ( no) S 60 J ( data) S 60 J ( remains) S 60 J ( in) S 
1200 10900 P (the) S 60 J ( HBA's) S 60 J ( internal) S 60 J ( cache) S 60 J ( for) S 60 J ( the) S 60 J ( target) S 60 J ( logical) S 60 J ( unit) S 60 J ( and,) S 60 J ( then,) S 60 J ( complete) S 60 J ( the) S 60 J ( shutdown) S 60 J ( request.) S 
1200 11160 P (Note) S 60 J ( that) S 60 J ( the) S 60 J ( miniport) S 60 J ( can) S 60 J ( be) S 60 J ( called) S 60 J ( with) S 60 J ( more) S 60 J ( than) S 60 J ( one) S 60 J ( shutdown) S 60 J ( request,) S 60 J ( possibly) S 60 J ( for) S 60 J ( the) S 
1200 11420 P (same) S 60 J ( LU) S 60 J ( or) S 60 J ( with) S 60 J ( several) S 60 J ( shutdown) S 60 J ( requests) S 60 J ( for) S 60 J ( different) S 60 J ( LUs,) S 60 J ( before) S 60 J ( the) S 60 J ( system) S 60 J ( itself) S 60 J ( is) S 
1200 11680 P (actually) S 60 J ( shut) S 60 J ( down.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (29) S E 
1920 2060 P 0 12 F 24 12 F (Whether) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( handles) S 60 J ( SRB_FUNCTION_IO_CONTROL) S 60 J ( requests) S 60 J ( depends) S 60 J ( on) S 
1920 2320 P (whether) S 60 J ( the) S 60 J ( HBA) S 60 J ( is) S 60 J ( to) S 60 J ( provide) S 60 J ( dedicated) S 60 J ( support) S 60 J ( for) S 60 J ( an) S 60 J ( application.) S 60 J ( Supporting) S 60 J ( this) S 60 J ( request) S 
1920 2580 P (allows) S 60 J ( a) S 60 J ( set) S 60 J ( of) S 60 J ( privately) S 60 J ( defined) S 60 J ( device) S 60 J ( I/O) S 60 J ( control) S 60 J ( requests) S 60 J ( to) S 60 J ( be) S 60 J ( sent) S 60 J ( directly) S 60 J ( to) S 60 J ( the) S 60 J ( miniport) S 
1920 2840 P (driver.) S 60 J ( For) S 60 J ( SRBs) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( set) S 60 J ( to) S 60 J ( SRB_FUNCTION_IO_CONTROL,) S 60 J ( the) S 
1920 3100 P 0 12 F 24 12 F B (DataBuffer) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( contains) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( a) S 60 J ( system-defined) S 60 J ( SRB_IO_CONTROL) S 60 J ( structure) S 
1920 3360 P (containing) S 60 J ( the) S 60 J ( driver-defined) S 60 J ( and) S 60 J ( application-specified) S 60 J ( ) S 0 12 F 24 12 F B (ControlCode) S E 0 12 F 24 12 F (.) S 60 J ( Note) S 60 J ( that) S 60 J ( system-) S 
1920 3620 P (defined) S 60 J ( device) S 60 J ( I/O) S 60 J ( control) S 60 J ( requests) S 60 J ( sent) S 60 J ( to) S 60 J ( SCSI) S 60 J ( class) S 60 J ( drivers) S 60 J ( are) S 60 J ( mapped) S 60 J ( to) S 60 J ( SRBs) S 60 J ( with) S 60 J ( the) S 
1920 3880 P 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( set) S 60 J ( to) S 60 J ( SRB_FUNCTION_EXECUTE_SCSI.) S 
1920 4260 P (Every) S 60 J ( HwStartIo) S 60 J ( routine) S 60 J ( must) S 60 J ( handle) S 60 J ( the) S 60 J ( receipt) S 60 J ( of) S 60 J ( an) S 60 J ( unsupported) S 60 J ( SRB_FUNCTION_) S 0 12 F 24 12 F I (xxx) S E 0 12 F 24 12 F (,) S 60 J ( as) S 
1920 4520 P (follows:) S 
1920 4840 P () S 104 J ( 1) S 256 J ( Set) S 60 J ( the) S 60 J ( input) S 60 J ( SRB's) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( SRB_STATUS_INVALID_REQUEST.) S 
1920 5160 P () S 104 J ( 2) S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (RequestComplete) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( with) S 60 J ( the) S 
2400 5420 P (input) S 60 J ( SRB.) S 
1920 5740 P () S 104 J ( 3) S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( again) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (NextRequest) S E 0 12 F 24 12 F (,) S 60 J ( or) S 60 J ( with) S 
2400 6000 P 0 12 F 24 12 F B (NextLuRequest) S E 0 12 F 24 12 F () S 60 J ( if) S 60 J ( the) S 60 J ( HBA) S 60 J ( supports) S 60 J ( tagged) S 60 J ( queueing) S 60 J ( or) S 60 J ( multiple) S 60 J ( requests) S 60 J ( per) S 60 J ( logical) S 
2400 6260 P (unit.) S 
1920 6640 P (Every) S 60 J ( HwStartIo) S 60 J ( routine) S 60 J ( must) S 60 J ( return) S 60 J ( a) S 60 J ( Boolean) S 60 J ( value,) S 60 J ( indicating) S 60 J ( whether) S 60 J ( the) S 60 J ( input) S 60 J ( request) S 
1920 6900 P (was) S 60 J ( processed) S 60 J ( or) S 60 J ( should) S 60 J ( be) S 60 J ( resubmitted) S 60 J ( later) S 60 J ( \(FALSE\).) S 60 J ( However,) S 60 J ( the) S 60 J ( miniport) S 60 J ( eventually) S 
1920 7160 P (must) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( twice) S 60 J ( for) S 60 J ( each) S 60 J ( SRB) S 60 J ( input) S 60 J ( to) S 60 J ( its) S 60 J ( StartIo) S 60 J ( routine:) S 60 J ( first,) S 60 J ( to) S 
1920 7420 P (complete) S 60 J ( the) S 60 J ( request) S 60 J ( \() S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (RequestComplete) S E 0 12 F 24 12 F (\)) S 60 J ( and,) S 60 J ( second,) S 60 J ( to) S 60 J ( tell) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 
1920 7680 P (driver) S 60 J ( to) S 60 J ( call) S 60 J ( the) S 60 J ( StartIo) S 60 J ( routine) S 60 J ( again) S 60 J ( with) S 60 J ( the) S 60 J ( next) S 60 J ( SRB) S 60 J ( \() S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (NextRequest) S E 0 12 F 24 12 F () S 60 J ( or) S 
1920 7940 P 0 12 F 24 12 F B (NextLuRequest) S E 0 12 F 24 12 F (\).) S 
1920 8320 P (The) S 60 J ( HwStartIo) S 60 J ( routine) S 60 J ( of) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( that) S 60 J ( manages) S 60 J ( its) S 60 J ( HBA) S 60 J ( exclusively) S 60 J ( by) S 60 J ( polling) S 60 J ( calls) S 
1920 8580 P 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (RequestTimerCall) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( its) S 
1920 8840 P (HwTimer) S 60 J ( routine.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( the) S 60 J ( HwTimer) S 60 J ( routine,) S 60 J ( see) S 60 J ( Section) S 60 J ( B.4.7) S 60 J ( later) S 60 J ( in) S 
1920 9100 P (this) S 60 J ( appendix.) S 
1920 9480 P (The) S 60 J ( following) S 60 J ( SRB) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( values) S 60 J ( are) S 60 J ( defined) S 60 J ( for) S 60 J ( use) S 60 J ( in) S 60 J ( future) S 60 J ( versions) S 60 J ( of) S 60 J ( Windows) S 60 J ( NT:) S 
1920 9800 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_FUNCTION_RECEIVE_EVENT) S 
1920 10120 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_FUNCTION_RELEASE_RECOVERY) S 
1920 10440 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_FUNCTION_RESET_DEVICE) S 
1920 10760 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_FUNCTION_TERMINATE_IO) S 
1920 11140 P (The) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( processes) S 60 J ( requests) S 60 J ( with) S 60 J ( the) S 60 J ( following) S 60 J ( SRB) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( values) S 60 J ( without) S 
1920 11400 P (calling) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver:) S 
1920 11720 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_FUNCTION_CLAIM_DEVICE) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1.1.2\)) S 
1920 12040 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_FUNCTION_RELEASE_QUEUE) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1.3.1\)) S 
1920 12360 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_FUNCTION_FLUSH_QUEUE) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1.3.1\)) S 
1920 12680 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_FUNCTION_ATTACH_DEVICE) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.2.1\)) S 
1920 13000 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_FUNCTION_RELEASE_DEVICE) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.2.1\)) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (30) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2060 P 0 12 F 24 12 F (Miniport) S 60 J ( driver) S 60 J ( designers) S 60 J ( can) S 60 J ( assume) S 60 J ( that) S 60 J ( their) S 60 J ( miniports) S 60 J ( will) S 60 J ( ) S 0 12 F 24 12 F I (never) S E 0 12 F 24 12 F () S 60 J ( be) S 60 J ( sent) S 60 J ( an) S 60 J ( SRB) S 60 J ( with) S 60 J ( any) S 
1200 2320 P (of) S 60 J ( the) S 60 J ( immediately) S 60 J ( preceding) S 60 J ( ) S 0 12 F 24 12 F B (Function) S E 0 12 F 24 12 F () S 60 J ( values.) S 60 J ( The) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( handles) S 60 J ( these) S 60 J ( requests) S 
1200 2580 P (from) S 60 J ( SCSI) S 60 J ( class) S 60 J ( and) S 60 J ( filter) S 60 J ( drivers) S 60 J ( to) S 60 J ( protect) S 60 J ( these) S 60 J ( higher-level) S 60 J ( SCSI) S 60 J ( drivers) S 60 J ( from) S 60 J ( having) S 60 J ( to) S 
1200 2840 P (access) S 60 J ( any) S 60 J ( HBA-specific) S 60 J ( \(or) S 60 J ( miniport-specific\)) S 60 J ( state) S 60 J ( information) S 60 J ( in) S 60 J ( order) S 60 J ( to) S 60 J ( find) S 60 J ( their) S 60 J ( devices) S 
1200 3100 P (or) S 60 J ( cancel) S 60 J ( queued) S 60 J ( requests.) S 60 J ( This) S 60 J ( ensures) S 60 J ( that) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( class) S 60 J ( and) S 60 J ( filter) S 60 J ( drivers) S 60 J ( have) S 60 J ( no) S 
1200 3360 P (dependencies) S 60 J ( on) S 60 J ( any) S 60 J ( particular) S 60 J ( model) S 60 J ( of) S 60 J ( HBA.) S 
1200 3740 P (For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( SRBs) S 60 J ( and) S 60 J ( the) S 60 J ( set) S 60 J ( of) S 60 J ( system-defined) S 60 J ( SRB_FUNCTION_) S 0 12 F 24 12 F I (xxx) S E 
1200 4000 P 0 12 F 24 12 F (values,) S 60 J ( see) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (Kernel-mode) S 60 J ( Driver) S 60 J ( Reference) S E 0 12 F 24 12 F (.) S 
1200 4640 P 0 12 F 8 12 F B (B.4.3) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwDmaStarted) S 67 J ( Routine) S E 
1200 5260 P 0 12 F 24 12 F (A) S 60 J ( miniport) S 60 J ( driver) S 60 J ( whose) S 60 J ( HBA) S 60 J ( uses) S 60 J ( the) S 60 J ( system) S 60 J ( DMA) S 60 J ( controller) S 60 J ( must) S 60 J ( have) S 60 J ( a) S 60 J ( HwDmaStarted) S 
1200 5520 P (routine.) S 
1200 5900 P (For) S 60 J ( a) S 60 J ( data) S 60 J ( transfer) S 60 J ( operation,) S 60 J ( such) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( must) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortIoMapTransfer) S E 0 12 F 24 12 F (,) S 
1200 6160 P (passing) S 60 J ( in) S 60 J ( the) S 60 J ( pointers) S 60 J ( to) S 60 J ( its) S 60 J ( device) S 60 J ( extension) S 60 J ( for) S 60 J ( per-HBA) S 60 J ( data) S 60 J ( and) S 60 J ( the) S 60 J ( SRB) S 60 J ( requesting) S 60 J ( the) S 
1200 6420 P (transfer,) S 60 J ( along) S 60 J ( with) S 60 J ( a) S 60 J ( range) S 60 J ( of) S 60 J ( logical) S 60 J ( addresses) S 60 J ( for) S 60 J ( the) S 60 J ( buffer) S 60 J ( from) S 60 J ( which) S 60 J ( or) S 60 J ( into) S 60 J ( which) S 60 J ( the) S 
1200 6680 P (data) S 60 J ( will) S 60 J ( be) S 60 J ( transferred.) S 
1200 7060 P (Note) S 60 J ( that) S 60 J ( the) S 60 J ( logical) S 60 J ( address) S 60 J ( range) S 60 J ( passed) S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortIoMapTransfer) S E 0 12 F 24 12 F () S 60 J ( either) S 60 J ( must) S 60 J ( be) S 60 J ( the) S 
1200 7320 P (mapped) S 60 J ( values) S 60 J ( for) S 60 J ( the) S 60 J ( input) S 60 J ( SRB's) S 60 J ( ) S 0 12 F 24 12 F B (DataBuffer) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (DataTransferLength) S E 0 12 F 24 12 F () S 60 J ( or) S 60 J ( a) S 60 J ( proper) S 60 J ( subset) S 
1200 7580 P (of) S 60 J ( this) S 60 J ( range.) S 60 J ( For) S 60 J ( most) S 60 J ( transfer) S 60 J ( requests,) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( designer) S 60 J ( can) S 60 J ( assume) S 60 J ( that) S 60 J ( all) S 60 J ( data) S 
1200 7840 P (specified) S 60 J ( in) S 60 J ( the) S 60 J ( input) S 60 J ( SRB) S 60 J ( can) S 60 J ( be) S 60 J ( transferred) S 60 J ( in) S 60 J ( a) S 60 J ( single) S 60 J ( DMA) S 60 J ( operation.) S 60 J ( That) S 60 J ( is,) S 60 J ( the) S 60 J ( miniport) S 
1200 8100 P (driver) S 60 J ( might) S 60 J ( have) S 60 J ( to) S 60 J ( carry) S 60 J ( out) S 60 J ( more) S 60 J ( than) S 60 J ( one) S 60 J ( transfer) S 60 J ( operation) S 60 J ( to) S 60 J ( satisfy) S 60 J ( a) S 60 J ( given) S 60 J ( SRB) S 60 J ( only) S 60 J ( if) S 
1200 8360 P (the) S 60 J ( HBA) S 60 J ( provides) S 60 J ( application-dedicated) S 60 J ( support) S 60 J ( and) S 60 J ( the) S 60 J ( application) S 60 J ( sends) S 60 J ( large) S 60 J ( transfer) S 
1200 8620 P (requests) S 60 J ( directly) S 60 J ( to) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver.) S 60 J ( Otherwise,) S 60 J ( it) S 60 J ( is) S 60 J ( the) S 60 J ( responsibility) S 60 J ( of) S 60 J ( NT) S 60 J ( SCSI) S 60 J ( class) S 
1200 8880 P (drivers) S 60 J ( to) S 60 J ( split) S 60 J ( up) S 60 J ( large) S 60 J ( transfer) S 60 J ( requests) S 60 J ( into) S 60 J ( a) S 60 J ( set) S 60 J ( of) S 60 J ( partial) S 60 J ( transfer) S 60 J ( requests,) S 60 J ( each) S 60 J ( sized) S 60 J ( to) S 
1200 9140 P (suit) S 60 J ( the) S 60 J ( capabilities) S 60 J ( of) S 60 J ( the) S 60 J ( HBA) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.1.2.2\).) S 
1200 9520 P 0 12 F 24 12 F B (ScsiPortIoMapTransfer) S E 0 12 F 24 12 F () S 60 J ( calls) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwDmaStarted) S 60 J ( routine) S 60 J ( when) S 60 J ( the) S 60 J ( system) S 60 J ( DMA) S 
1200 9780 P (controller) S 60 J ( is) S 60 J ( ready) S 60 J ( to) S 60 J ( transfer) S 60 J ( data) S 60 J ( between) S 60 J ( system) S 60 J ( memory) S 60 J ( and) S 60 J ( the) S 60 J ( HBA.) S 60 J ( HwDmaStarted) S 
1200 10040 P (must) S 60 J ( set) S 60 J ( up) S 60 J ( the) S 60 J ( HBA) S 60 J ( for) S 60 J ( the) S 60 J ( transfer) S 60 J ( operation.) S 
1200 10420 P (When) S 60 J ( a) S 60 J ( transfer) S 60 J ( operation) S 60 J ( is) S 60 J ( complete,) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( must) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortFlushDma) S E 
1200 10680 P 0 12 F 24 12 F (before) S 60 J ( it) S 60 J ( calls) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( SRB) S 60 J ( and/or) S 60 J ( calls) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortIoMapTransfer) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( set) S 
1200 10940 P (up) S 60 J ( the) S 60 J ( DMA) S 60 J ( controller) S 60 J ( again) S 60 J ( for) S 60 J ( a) S 60 J ( subrange) S 60 J ( in) S 60 J ( the) S 60 J ( buffer.) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortFlushDma) S E 0 12 F 24 12 F () S 60 J ( flushes) S 60 J ( any) S 
1200 11200 P (remaining) S 60 J ( data) S 60 J ( cached) S 60 J ( in) S 60 J ( the) S 60 J ( DMA) S 60 J ( controller.) S 60 J ( Note) S 60 J ( that) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortFlushDma) S E 0 12 F 24 12 F () S 60 J ( also) S 60 J ( can) S 60 J ( be) S 
1200 11460 P (called) S 60 J ( to) S 60 J ( cancel) S 60 J ( a) S 60 J ( system) S 60 J ( DMA) S 60 J ( transfer,) S 60 J ( even) S 60 J ( if) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwDmaStarted) S 60 J ( routine) S 60 J ( has) S 60 J ( not) S 
1200 11720 P (yet) S 60 J ( been) S 60 J ( called.) S 
1200 12100 P (For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortIoMapTransfer) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortFlushDma) S E 0 12 F 24 12 F (,) S 60 J ( see) S 60 J ( the) S 
1200 12360 P 0 12 F 24 12 F I (Kernel-mode) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F I (Driver) S 60 J ( Reference) S E 0 12 F 24 12 F (.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (31) S E 
1920 2080 P 0 12 F 8 12 F B (B.4.4) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwResetBus) S 67 J ( Routine) S E 
1920 2700 P 0 12 F 24 12 F (Every) S 60 J ( miniport) S 60 J ( driver) S 60 J ( must) S 60 J ( have) S 60 J ( a) S 60 J ( HwResetBus) S 60 J ( routine,) S 60 J ( which) S 60 J ( is) S 60 J ( called) S 60 J ( with) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 
1920 2960 P (miniport's) S 60 J ( device) S 60 J ( extension) S 60 J ( for) S 60 J ( HBA) S 60 J ( state) S 60 J ( and) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (PathId) S E 0 12 F 24 12 F () S 60 J ( of) S 60 J ( the) S 60 J ( bus) S 60 J ( to) S 60 J ( be) S 60 J ( reset.) S 60 J ( If) S 60 J ( an) S 
1920 3220 P (attempted) S 60 J ( bus-reset) S 60 J ( operation) S 60 J ( fails) S 60 J ( \(or) S 60 J ( times) S 60 J ( out\),) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( should) S 60 J ( call) S 
1920 3480 P 0 12 F 24 12 F B (ScsiPortLogError) S E 0 12 F 24 12 F () S 60 J ( and,) S 60 J ( then,) S 60 J ( program) S 60 J ( the) S 60 J ( HBA) S 60 J ( for) S 60 J ( a) S 60 J ( hard) S 60 J ( reset.) S 
1920 3860 P (A) S 60 J ( bus-reset) S 60 J ( operation) S 60 J ( might) S 60 J ( require) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( to) S 60 J ( clean) S 60 J ( up) S 60 J ( state) S 60 J ( it) S 60 J ( maintains) S 60 J ( in) S 60 J ( the) S 
1920 4120 P (device) S 60 J ( extension) S 60 J ( and/or) S 60 J ( logical) S 60 J ( unit) S 60 J ( extensions) S 60 J ( for) S 60 J ( devices) S 60 J ( on) S 60 J ( the) S 60 J ( bus.) S 60 J ( HwResetBus) S 60 J ( must) S 
1920 4380 P (complete) S 60 J ( any) S 60 J ( outstanding) S 60 J ( requests) S 60 J ( by) S 60 J ( calling) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortCompleteRequest) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 
1920 4640 P 0 12 F 24 12 F (value) S 60 J ( SRB_STATUS_BUS_RESET) S 60 J ( or,) S 60 J ( for) S 60 J ( individual) S 60 J ( SRBs,) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( this) S 
1920 4900 P (status.) S 
1920 5280 P (After) S 60 J ( completing) S 60 J ( the) S 60 J ( bus-reset) S 60 J ( request) S 60 J ( and) S 60 J ( any) S 60 J ( outstanding) S 60 J ( requests,) S 60 J ( the) S 60 J ( miniport) S 60 J ( must) S 60 J ( call) S 
1920 5540 P 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( \(if) S 60 J ( it) S 60 J ( has) S 60 J ( not) S 60 J ( already) S 60 J ( done) S 60 J ( so\)) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (NextRequest) S E 0 12 F 24 12 F (,) S 
1920 5800 P (or) S 60 J ( ) S 0 12 F 24 12 F B (NextLuRequest) S E 0 12 F 24 12 F () S 60 J ( if) S 60 J ( the) S 60 J ( HBA) S 60 J ( supports) S 60 J ( tagged) S 60 J ( queueing) S 60 J ( or) S 60 J ( multiple) S 60 J ( requests) S 60 J ( per) S 60 J ( logical) S 60 J ( unit.) S 
1920 6440 P 0 12 F 8 12 F B (B.4.5) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwInterrupt) S 67 J ( Routine) S E 
1920 7060 P 0 12 F 24 12 F (On) S 60 J ( entry,) S 60 J ( a) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( should) S 60 J ( determine) S 60 J ( if) S 60 J ( its) S 60 J ( HBA) S 60 J ( actually) S 60 J ( generated) S 60 J ( an) S 60 J ( interrupt.) S 
1920 7320 P (HwInterrupt) S 60 J ( must) S 60 J ( return) S 60 J ( FALSE) S 60 J ( as) S 60 J ( soon) S 60 J ( as) S 60 J ( possible) S 60 J ( if) S 60 J ( it) S 60 J ( detects) S 60 J ( a) S 60 J ( spurious) S 60 J ( interrupt) S 60 J ( so) S 60 J ( the) S 
1920 7580 P (interrupt) S 60 J ( service) S 60 J ( routine) S 60 J ( for) S 60 J ( the) S 60 J ( device) S 60 J ( that) S 60 J ( generated) S 60 J ( the) S 60 J ( interrupt) S 60 J ( can) S 60 J ( be) S 60 J ( called) S 60 J ( quickly.) S 
1920 7960 P (Otherwise,) S 60 J ( a) S 60 J ( miniport's) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( is) S 60 J ( generally) S 60 J ( responsible) S 60 J ( for) S 60 J ( completing) S 60 J ( the) S 60 J ( I/O) S 
1920 8220 P (operation) S 60 J ( that) S 60 J ( caused) S 60 J ( the) S 60 J ( interrupt.) S 60 J ( Depending) S 60 J ( on) S 60 J ( the) S 60 J ( HBA) S 60 J ( and) S 60 J ( the) S 60 J ( design) S 60 J ( of) S 60 J ( the) S 60 J ( miniport,) S 60 J ( a) S 
1920 8480 P (HwInterrupt) S 60 J ( routine) S 60 J ( does) S 60 J ( some) S 60 J ( or) S 60 J ( all) S 60 J ( of) S 60 J ( the) S 60 J ( following:) S 
1920 8800 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Dismisses) S 60 J ( the) S 60 J ( interrupt) S 60 J ( on) S 60 J ( the) S 60 J ( HBA) S 
1920 9120 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Notifies) S 60 J ( \(by) S 60 J ( calling) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( or) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortCompleteRequest) S E 0 12 F 24 12 F (\)) S 60 J ( the) S 60 J ( port) S 60 J ( driver) S 
2400 9380 P (if) S 60 J ( the) S 60 J ( HBA) S 60 J ( indicates) S 60 J ( that) S 60 J ( certain) S 60 J ( SCSI) S 60 J ( error) S 60 J ( conditions) S 60 J ( occurred) S 60 J ( during) S 60 J ( the) S 60 J ( operation) S 60 J ( and) S 
2400 9640 P (logging) S 60 J ( the) S 60 J ( error) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.4.8\)) S 
1920 9960 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( Completing) S 60 J ( the) S 60 J ( requested) S 60 J ( operation) S 60 J ( that) S 60 J ( caused) S 60 J ( the) S 60 J ( interrupt,) S 60 J ( such) S 60 J ( as) S 60 J ( calling) S 
2400 10220 P 0 12 F 24 12 F B (ScsiPortIoMapTransfer) S E 0 12 F 24 12 F () S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.4.3\)) S 60 J ( if) S 60 J ( the) S 60 J ( interrupt) S 60 J ( came) S 60 J ( in) S 60 J ( from) S 60 J ( a) S 60 J ( previously) S 
2400 10480 P (selected) S 60 J ( target) S 60 J ( TID) S 60 J ( and) S 60 J ( LU) S 60 J ( indicating) S 60 J ( a) S 60 J ( readiness) S 60 J ( to) S 60 J ( transfer) S 60 J ( data) S 
1920 10860 P (When) S 60 J ( the) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( \(or) S 60 J ( an) S 60 J ( internal) S 60 J ( miniport) S 60 J ( routine\)) S 60 J ( completes) S 60 J ( an) S 60 J ( SRB,) S 60 J ( it) S 60 J ( calls) S 
1920 11120 P 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( twice:) S 
1920 11440 P () S 104 J ( 1) S 256 J ( First,) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (RequestComplete) S E 0 12 F 24 12 F () S 60 J ( and) S 60 J ( the) S 60 J ( just) S 60 J ( satisfied) S 60 J ( request) S 
1920 11760 P () S 104 J ( 2) S 256 J ( Next,) S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (NextRequest) S E 0 12 F 24 12 F (,) S 60 J ( or) S 60 J ( with) S 60 J ( ) S 0 12 F 24 12 F B (NextLuRequest) S E 0 12 F 24 12 F () S 60 J ( if) S 60 J ( the) S 60 J ( HBA) S 
2400 12020 P (supports) S 60 J ( tagged) S 60 J ( queueing) S 60 J ( or) S 60 J ( multiple) S 60 J ( requests) S 60 J ( per) S 60 J ( logical) S 60 J ( unit) S 
1920 12400 P (For) S 60 J ( better) S 60 J ( overall) S 60 J ( system) S 60 J ( performance,) S 60 J ( a) S 60 J ( miniport's) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( should) S 60 J ( do) S 60 J ( only) S 60 J ( the) S 
1920 12660 P (minimum) S 60 J ( necessary) S 60 J ( to) S 60 J ( process) S 60 J ( I/O) S 60 J ( requests.) S 60 J ( That) S 60 J ( is,) S 60 J ( the) S 60 J ( miniport) S 60 J ( should) S 60 J ( be) S 60 J ( designed) S 60 J ( to) S 60 J ( return) S 
1920 12920 P (control) S 60 J ( from) S 60 J ( the) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( as) S 60 J ( quickly) S 60 J ( as) S 60 J ( possible,) S 60 J ( rather) S 60 J ( than) S 60 J ( tying) S 60 J ( up) S 60 J ( a) S 60 J ( processor) S 
1920 13180 P (and) S 60 J ( preventing) S 60 J ( other) S 60 J ( drivers) S 60 J ( from) S 60 J ( servicing) S 60 J ( device) S 60 J ( interrupts.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (32) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2180 P 0 12 F 24 12 F (If) S 60 J ( interrupt-driven) S 60 J ( I/O) S 60 J ( operations) S 60 J ( take) S 60 J ( a) S 60 J ( long) S 60 J ( time) S 60 J ( to) S 60 J ( complete,) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( should) S 60 J ( have) S 60 J ( a) S 
1200 2440 P (pair) S 60 J ( of) S 60 J ( HwEnableInterruptsCallback) S 60 J ( and) S 60 J ( HwDisableInterruptsCallback) S 60 J ( routines.) S 60 J ( For) S 60 J ( example,) S 
1200 2700 P (if) S 60 J ( a) S 60 J ( miniport) S 60 J ( must) S 60 J ( poll) S 60 J ( for) S 60 J ( longer) S 60 J ( than) S 60 J ( 50) S 60 J ( microseconds) S 60 J ( doing) S 60 J ( PIO,) S 60 J ( its) S 60 J ( HwInterrupt) S 60 J ( routine) S 
1200 2960 P (should) S 60 J ( ) S 0 12 F 24 12 F I (not) S E 0 12 F 24 12 F () S 60 J ( retain) S 60 J ( control) S 60 J ( of) S 60 J ( the) S 60 J ( CPU) S 60 J ( for) S 60 J ( the) S 60 J ( full) S 60 J ( polling) S 60 J ( interval) S 60 J ( in) S 60 J ( order) S 60 J ( to) S 60 J ( complete) S 60 J ( a) S 
1200 3220 P (requested) S 60 J ( operation.) S 60 J ( Instead,) S 60 J ( its) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( should) S 60 J ( do) S 60 J ( the) S 60 J ( following:) S 
1200 3540 P () S 104 J ( 1) S 256 J ( Disable) S 60 J ( interrupts) S 60 J ( from) S 60 J ( the) S 60 J ( HBA.) S 
1200 3860 P () S 104 J ( 2) S 256 J ( Set) S 60 J ( up) S 60 J ( the) S 60 J ( device) S 60 J ( extension) S 60 J ( with) S 60 J ( any) S 60 J ( context) S 60 J ( necessary) S 60 J ( to) S 60 J ( complete) S 60 J ( the) S 60 J ( operation.) S 
1200 4180 P () S 104 J ( 3) S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( device) S 60 J ( extension,) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 
1680 4440 P 0 12 F 24 12 F B (CallEnableInterrupts) S E 0 12 F 24 12 F (,) S 60 J ( and) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwEnableInterruptsCallback) S 60 J ( routine,) S 
1680 4700 P (described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.4.5.1,) S 60 J ( next.) S 
1200 5020 P () S 104 J ( 4) S 256 J ( Return) S 60 J ( control.) S 
1200 5400 P 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( calls) S 60 J ( the) S 60 J ( HwEnableInterruptsCallback) S 60 J ( routine) S 60 J ( as) S 60 J ( an) S 60 J ( NT) S 60 J ( DPC) S 60 J ( \(see) S 
1200 5660 P (Chapter) S 60 J ( 3\).) S 
1200 6180 P 0 12 F 8 12 F B (B.4.5.1) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwEnableInterruptsCallback) S 67 J ( Routine) S E 
1200 6800 P 0 12 F 24 12 F (A) S 60 J ( HwEnableInterruptsCallback) S 60 J ( routine) S 60 J ( finishes) S 60 J ( processing) S 60 J ( a) S 60 J ( polled) S 60 J ( I/O) S 60 J ( operation) S 60 J ( without) S 
1200 7060 P (inhibiting) S 60 J ( I/O) S 60 J ( operations) S 60 J ( for) S 60 J ( other) S 60 J ( devices) S 60 J ( in) S 60 J ( the) S 60 J ( machine.) S 60 J ( When) S 60 J ( the) S 
1200 7320 P (HwEnableInterruptsCallback) S 60 J ( routine) S 60 J ( gets) S 60 J ( control,) S 60 J ( all) S 60 J ( system) S 60 J ( device) S 60 J ( interrupts) S 60 J ( are) S 60 J ( enabled) S 
1200 7580 P (except) S 60 J ( from) S 60 J ( the) S 60 J ( HBA.) S 60 J ( In) S 60 J ( other) S 60 J ( words,) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( cannot) S 60 J ( be) S 60 J ( called) S 60 J ( and) S 
1200 7840 P (cannot) S 60 J ( disturb) S 60 J ( the) S 60 J ( context) S 60 J ( data) S 60 J ( it) S 60 J ( set) S 60 J ( up) S 60 J ( about) S 60 J ( the) S 60 J ( current) S 60 J ( operation) S 60 J ( while) S 60 J ( the) S 
1200 8100 P (HwEnableInterruptsCallback) S 60 J ( routine) S 60 J ( is) S 60 J ( running.) S 
1200 8480 P (A) S 60 J ( HwEnableInterruptsCallback) S 60 J ( routine) S 60 J ( should) S 60 J ( do) S 60 J ( the) S 60 J ( following:) S 
1200 8800 P () S 104 J ( 1) S 256 J ( Use) S 60 J ( the) S 60 J ( context) S 60 J ( that) S 60 J ( was) S 60 J ( set) S 60 J ( up) S 60 J ( for) S 60 J ( the) S 60 J ( operation) S 60 J ( in) S 60 J ( the) S 60 J ( input) S 60 J ( device) S 60 J ( extension) S 60 J ( to) S 
1680 9060 P (complete) S 60 J ( processing) S 60 J ( of) S 60 J ( the) S 60 J ( request) S 60 J ( that) S 60 J ( caused) S 60 J ( the) S 60 J ( interrupt.) S 
1200 9380 P () S 104 J ( 2) S 256 J ( Call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( device) S 60 J ( extension,) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 
1680 9640 P 0 12 F 24 12 F B (CallDisableInterrupts) S E 0 12 F 24 12 F (,) S 60 J ( and) S 60 J ( the) S 60 J ( miniport's) S 60 J ( HwDisableInterruptsCallback) S 60 J ( routine,) S 
1680 9900 P (described) S 60 J ( in) S 60 J ( Section) S 60 J ( B.4.5.2,) S 60 J ( next.) S 
1200 10220 P () S 104 J ( 3) S 256 J ( Return) S 60 J ( control.) S 
1200 10600 P 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( calls) S 60 J ( the) S 60 J ( HwDisableInterruptsCallback) S 60 J ( routine) S 60 J ( with) S 60 J ( a) S 60 J ( subset) S 60 J ( of) S 60 J ( the) S 
1200 10860 P (system) S 60 J ( device) S 60 J ( interrupts) S 60 J ( disabled:) S 60 J ( that) S 60 J ( is,) S 60 J ( no) S 60 J ( device) S 60 J ( interrupt) S 60 J ( with) S 60 J ( a) S 60 J ( system-assigned) S 60 J ( hardware) S 
1200 11120 P (priority) S 60 J ( \(IRQL\)) S 60 J ( less) S 60 J ( than) S 60 J ( or) S 60 J ( equal) S 60 J ( to) S 60 J ( the) S 60 J ( HBA's) S 60 J ( can) S 60 J ( interrupt.) S 60 J ( For) S 60 J ( more) S 60 J ( information) S 60 J ( about) S 
1200 11380 P (IRQLs,) S 60 J ( see) S 60 J ( Chapter) S 60 J ( 16.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (33) S E 
1920 2080 P 0 12 F 8 12 F B (B.4.5.2) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwDisableInterruptsCallback) S 67 J ( Routine) S E 
1920 2700 P 0 12 F 24 12 F (A) S 60 J ( HwDisableInterruptsCallback) S 60 J ( routine) S 60 J ( should) S 60 J ( do) S 60 J ( the) S 60 J ( following:) S 
1920 3020 P () S 104 J ( 1) S 256 J ( Reenable) S 60 J ( interrupts) S 60 J ( from) S 60 J ( the) S 60 J ( HBA.) S 
1920 3340 P () S 104 J ( 2) S 256 J ( Return) S 60 J ( control.) S 
1920 3720 P (Note) S 60 J ( that) S 60 J ( this) S 60 J ( routine) S 60 J ( must) S 60 J ( execute) S 60 J ( as) S 60 J ( quickly) S 60 J ( as) S 60 J ( possible) S 60 J ( to) S 60 J ( avoid) S 60 J ( tying) S 60 J ( up) S 60 J ( I/O) S 60 J ( operations) S 60 J ( for) S 
1920 3980 P (other) S 60 J ( devices) S 60 J ( in) S 60 J ( the) S 60 J ( machine.) S 60 J ( Consequently,) S 60 J ( a) S 60 J ( HwEnableInterruptsCallback) S 60 J ( must) S 60 J ( do) S 60 J ( no) S 60 J ( more) S 
1920 4240 P (than) S 60 J ( reenable) S 60 J ( interrupts) S 60 J ( on) S 60 J ( the) S 60 J ( HBA) S 60 J ( before) S 60 J ( it) S 60 J ( returns) S 60 J ( control.) S 
1920 4880 P 0 12 F 8 12 F B (B.4.6) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwTimer) S 67 J ( Routine) S E 
1920 5500 P 0 12 F 24 12 F (A) S 60 J ( miniport) S 60 J ( driver) S 60 J ( that) S 60 J ( does) S 60 J ( not) S 60 J ( have) S 60 J ( a) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( because) S 60 J ( it) S 60 J ( manages) S 60 J ( all) S 60 J ( HBA) S 60 J ( I/O) S 
1920 5760 P (operations) S 60 J ( by) S 60 J ( polling) S 60 J ( should) S 60 J ( have) S 60 J ( a) S 60 J ( HwTimer) S 60 J ( routine.) S 60 J ( However,) S 60 J ( miniport) S 60 J ( drivers) S 60 J ( with) S 
1920 6020 P (HwInterrupt) S 60 J ( routines) S 60 J ( frequently) S 60 J ( have) S 60 J ( HwTimer) S 60 J ( routines) S 60 J ( as) S 60 J ( well.) S 
1920 6400 P (While) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( can) S 60 J ( call) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortStallExecution) S E 0 12 F 24 12 F () S 60 J ( to) S 60 J ( wait) S 60 J ( for) S 60 J ( a) S 60 J ( state) S 60 J ( change) S 60 J ( on) S 60 J ( the) S 
1920 6660 P (HBA,) S 60 J ( miniport) S 60 J ( drivers) S 60 J ( should) S 60 J ( ) S 0 12 F 24 12 F I (never) S E 0 12 F 24 12 F () S 60 J ( call) S 60 J ( this) S 60 J ( routine) S 60 J ( to) S 60 J ( wait) S 60 J ( for) S 60 J ( longer) S 60 J ( than) S 60 J ( one) S 60 J ( millisecond) S 
1920 6920 P (except,) S 60 J ( possibly,) S 60 J ( for) S 60 J ( an) S 60 J ( operation) S 60 J ( performed) S 60 J ( only) S 60 J ( when) S 60 J ( a) S 60 J ( miniport) S 60 J ( is) S 60 J ( initializing.) S 
1920 7180 P 0 12 F 24 12 F B (ScsiPortStallExecution) S E 0 12 F 24 12 F () S 60 J ( ties) S 60 J ( up) S 60 J ( the) S 60 J ( processor) S 60 J ( for) S 60 J ( the) S 60 J ( given) S 60 J ( interval,) S 60 J ( preventing) S 60 J ( other) S 60 J ( code) S 60 J ( in) S 
1920 7440 P (the) S 60 J ( system) S 60 J ( from) S 60 J ( doing) S 60 J ( useful) S 60 J ( work.) S 
1920 7820 P (Instead) S 60 J ( of) S 60 J ( calling) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortStallExecution) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( large) S 60 J ( input) S 60 J ( intervals) S 60 J ( and) S 60 J ( wasting) S 60 J ( many) S 60 J ( CPU) S 
1920 8080 P (cycles,) S 60 J ( a) S 60 J ( miniport) S 60 J ( driver) S 60 J ( should) S 60 J ( have) S 60 J ( a) S 60 J ( HwTimer) S 60 J ( routine.) S 60 J ( One) S 60 J ( or) S 60 J ( more) S 60 J ( HwTimer) S 60 J ( routines) S 60 J ( are) S 
1920 8340 P (particularly) S 60 J ( useful) S 60 J ( if) S 60 J ( the) S 60 J ( HBA) S 60 J ( does) S 60 J ( not) S 60 J ( generate) S 60 J ( a) S 60 J ( completion) S 60 J ( interrupt) S 60 J ( for) S 60 J ( every) S 60 J ( operation) S 60 J ( or) S 
1920 8600 P (if) S 60 J ( any) S 60 J ( commonly) S 60 J ( requested) S 60 J ( operation,) S 60 J ( such) S 60 J ( as) S 60 J ( a) S 60 J ( bus) S 60 J ( reset,) S 60 J ( takes) S 60 J ( longer) S 60 J ( than) S 60 J ( a) S 60 J ( millisecond.) S 
1920 8980 P (After) S 60 J ( the) S 60 J ( HBA) S 60 J ( has) S 60 J ( been) S 60 J ( programmed) S 60 J ( for) S 60 J ( such) S 60 J ( an) S 60 J ( operation,) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( calls) S 
1920 9240 P 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (RequestTimerCall) S E 0 12 F 24 12 F (,) S 60 J ( a) S 60 J ( pointer) S 60 J ( to) S 60 J ( the) S 60 J ( device) S 
1920 9500 P (extension) S 60 J ( containing) S 60 J ( context) S 60 J ( about) S 60 J ( the) S 60 J ( operation,) S 60 J ( its) S 60 J ( HwTimer) S 60 J ( routine,) S 60 J ( and) S 60 J ( a) S 60 J ( driver-) S 
1920 9760 P (determined) S 60 J ( interval.) S 
1920 10140 P (HwTimer) S 60 J ( is) S 60 J ( called) S 60 J ( once) S 60 J ( for) S 60 J ( each) S 60 J ( such) S 60 J ( call) S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F (,) S 60 J ( which) S 60 J ( can) S 60 J ( be) S 60 J ( called) S 60 J ( from) S 
1920 10400 P (the) S 60 J ( HwTimer) S 60 J ( routine) S 60 J ( itself.) S 60 J ( However,) S 60 J ( any) S 60 J ( call) S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( the) S 
1920 10660 P 0 12 F 24 12 F I (NotificationType) S E 0 12 F 24 12 F () S 60 J ( ) S 0 12 F 24 12 F B (RequestTimerCall) S E 0 12 F 24 12 F () S 60 J ( overrides) S 60 J ( a) S 60 J ( preceding) S 60 J ( call) S 60 J ( for) S 60 J ( which) S 60 J ( the) S 60 J ( specified) S 
1920 10920 P (interval) S 60 J ( has) S 60 J ( not) S 60 J ( expired.) S 60 J ( That) S 60 J ( is,) S 60 J ( there) S 60 J ( is) S 60 J ( only) S 60 J ( one) S 60 J ( outstanding) S 60 J ( request) S 60 J ( to) S 60 J ( call) S 60 J ( a) S 60 J ( miniport's) S 
1920 11180 P (HwTimer) S 60 J ( routine) S 60 J ( at) S 60 J ( any) S 60 J ( given) S 60 J ( moment.) S 
1920 11560 P (The) S 60 J ( interval) S 60 J ( passed) S 60 J ( in) S 60 J ( to) S 60 J ( ) S 0 12 F 24 12 F B (ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( is) S 60 J ( in) S 60 J ( microseconds) S 60 J ( but) S 60 J ( the) S 60 J ( minimum) S 60 J ( resolution) S 
1920 11820 P (for) S 60 J ( each) S 60 J ( call) S 60 J ( is) S 60 J ( approximately) S 60 J ( ten) S 60 J ( milliseconds.) S 60 J ( An) S 60 J ( input) S 60 J ( interval) S 60 J ( of) S 60 J ( zero) S 60 J ( cancels) S 60 J ( the) S 60 J ( preceding) S 
1920 12080 P (request) S 60 J ( to) S 60 J ( call) S 60 J ( the) S 60 J ( HwTimer) S 60 J ( routine,) S 60 J ( provided) S 60 J ( it) S 60 J ( has) S 60 J ( not) S 60 J ( been) S 60 J ( called) S 60 J ( or) S 60 J ( dispatched) S 60 J ( for) S 
1920 12340 P (execution) S 60 J ( on) S 60 J ( another) S 60 J ( processor) S 60 J ( already.) S 0 12 F 24 12 F B () S 60 J ( ScsiPortNotification) S E 0 12 F 24 12 F () S 60 J ( calls) S 60 J ( the) S 60 J ( HwTimer) S 60 J ( routine) S 
1920 12600 P (either) S 60 J ( as) S 60 J ( a) S 60 J ( DPC) S 60 J ( \(see) S 60 J ( Chapter) S 60 J ( 3\)) S 60 J ( or) S 60 J ( synchronized) S 60 J ( with) S 60 J ( the) S 60 J ( HwInterrupt) S 60 J ( routine) S 60 J ( so) S 60 J ( that) S 60 J ( it) S 60 J ( cannot) S 
1920 12860 P (execute) S 60 J ( concurrently) S 60 J ( while) S 60 J ( the) S 60 J ( HwTimer) S 60 J ( routine) S 60 J ( is) S 60 J ( running.) S 0 12 F 
PE 
1200 1220 P 10 12 F B (B-) S E B (34) S E B () S 894 J ( Kernel-mode) S 55 J ( Driver) S 55 J ( Design) S 55 J ( Guide) S E 
1200 2080 P 0 12 F 8 12 F B (B.4.7) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( HwAdapterState) S 67 J ( Routine) S E 
1200 2700 P 0 12 F 24 12 F (Windows) S 60 J ( NT) S 60 J ( miniport) S 60 J ( drivers) S 60 J ( should) S 60 J ( set) S 60 J ( this) S 60 J ( entry) S 60 J ( point) S 60 J ( to) S 60 J ( NULL) S 60 J ( in) S 60 J ( the) S 
1200 2960 P (HW_INITIALIZATION_DATA) S 60 J ( \(see) S 60 J ( Section) S 60 J ( B.4.1\).) S 60 J ( The) S 60 J ( ) S 0 12 F 24 12 F B (HwAdapterState) S E 0 12 F 24 12 F () S 60 J ( prototype) S 60 J ( is) S 
1200 3220 P (defined) S 60 J ( for) S 60 J ( compatibility) S 60 J ( with) S 60 J ( future) S 60 J ( versions) S 60 J ( of) S 60 J ( MS-DOS.) S 
1200 3860 P 0 12 F 8 12 F B (B.4.8) S 67 J ( ) S 67 J ( ) S 67 J ( ) S 67 J ( Error) S 67 J ( Handling) S E 
1200 4480 P 0 12 F 24 12 F (A) S 60 J ( SCSI) S 60 J ( miniport) S 60 J ( driver) S 60 J ( is) S 60 J ( responsible) S 60 J ( for) S 60 J ( handling) S 60 J ( and) S 60 J ( for) S 60 J ( notifying) S 60 J ( the) S 60 J ( NT) S 60 J ( port) S 60 J ( driver) S 60 J ( of) S 60 J ( the) S 
1200 4740 P (following) S 60 J ( kinds) S 60 J ( of) S 60 J ( SCSI) S 60 J ( errors,) S 60 J ( which) S 60 J ( should) S 60 J ( be) S 60 J ( set) S 60 J ( in) S 60 J ( the) S 60 J ( ) S 0 12 F 24 12 F B (SrbStatus) S E 0 12 F 24 12 F () S 60 J ( field) S 60 J ( before) S 60 J ( the) S 60 J ( driver) S 
1200 5000 P (completes) S 60 J ( the) S 60 J ( SRB) S 60 J ( it) S 60 J ( was) S 60 J ( processing) S 60 J ( when) S 60 J ( the) S 60 J ( error) S 60 J ( occurred:) S 
1200 5320 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_ERROR) S 60 J ( \(if) S 60 J ( the) S 60 J ( HBA) S 60 J ( returns) S 60 J ( a) S 60 J ( nonspecific) S 60 J ( bus) S 60 J ( error\)) S 
1200 5640 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_PARITY_ERROR) S 
1200 5960 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_UNEXPECTED_BUS_FREE) S 
1200 6280 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_SELECTION_TIMEOUT) S 
1200 6600 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_COMMAND_TIMEOUT) S 
1200 6920 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_MESSAGE_REJECTED) S 
1200 7240 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_NO_DEVICE) S 
1200 7560 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_NO_HBA) S 
1200 7880 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_DATA_OVERRUN) S 60 J ( \(also) S 60 J ( returned) S 60 J ( for) S 60 J ( underruns\)) S 
1200 8200 P 0 12 F 60 10 F B () S 72 J ( n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_PHASE_SEQUENCE_FAILURE) S 
1200 8520 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SRB_STATUS_BUSY) S 60 J ( \(TID) S 60 J ( busy\)) S 
1200 8900 P (For) S 60 J ( a) S 60 J ( data) S 60 J ( underrun,) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( must) S 60 J ( update) S 60 J ( the) S 60 J ( SRB's) S 60 J ( ) S 0 12 F 24 12 F B (DataTransferLength) S E 0 12 F 24 12 F () S 60 J ( to) S 
1200 9160 P (indicate) S 60 J ( how) S 60 J ( much) S 60 J ( data) S 60 J ( actually) S 60 J ( was) S 60 J ( transferred.) S 0 12 F 
PE 
1920 1220 P 10 12 F B () S 5408 J ( SCSI) S 55 J ( Drivers) S 774 J ( B-) S E B (35) S E 
1920 2060 P 0 12 F 24 12 F (Whenever) S 60 J ( the) S 60 J ( miniport) S 60 J ( driver) S 60 J ( encounters) S 60 J ( an) S 60 J ( HBA) S 60 J ( or) S 60 J ( bus) S 60 J ( error,) S 60 J ( it) S 60 J ( should) S 60 J ( call) S 
1920 2320 P 0 12 F 24 12 F B (ScsiPortLogError) S E 0 12 F 24 12 F () S 60 J ( with) S 60 J ( one) S 60 J ( of) S 60 J ( the) S 60 J ( following) S 60 J ( system-defined) S 60 J ( error) S 60 J ( codes:) S 
1920 2640 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_BUS_PARITY_ERROR) S 
1920 2960 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_UNEXPECTED_DISCONNECT) S 60 J ( \(by) S 60 J ( the) S 60 J ( target) S 60 J ( LU\)) S 
1920 3280 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_INVALID_RESELECTION) S 
1920 3600 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_BUS_TIME_OUT) S 
1920 3920 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_REQUEST_TIMEOUT) S 
1920 4240 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_PROTOCOL_ERROR) S 
1920 4560 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_INTERNAL_ADAPTER_ERROR) S 
1920 4880 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_IRQ_NOT_RESPONDING) S 60 J ( \(if) S 60 J ( the) S 60 J ( miniport) S 60 J ( detects) S 60 J ( that) S 60 J ( the) S 60 J ( HBA) S 60 J ( is) S 60 J ( no) S 60 J ( longer) S 
2400 5140 P (generating) S 60 J ( interrupts\)) S 
1920 5460 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_BAD_FW_ERROR) S 60 J ( \("FW") S 60 J ( stands) S 60 J ( for) S 60 J ( "firmware"\)) S 
1920 5780 P () S 72 J ( ) S 0 12 F 60 10 F B (n) S E 0 12 F 24 12 F () S 256 J ( SP_BAD_FW_WARNING) S 
1920 6160 P 0 12 F 24 12 F B (ScsiPortLogError) S E 0 12 F 24 12 F () S 60 J ( allocates) S 60 J ( an) S 60 J ( error-log) S 60 J ( packet,) S 60 J ( sets) S 60 J ( it) S 60 J ( up,) S 60 J ( and) S 60 J ( logs) S 60 J ( the) S 60 J ( I/O) S 60 J ( error) S 60 J ( on) S 60 J ( behalf) S 60 J ( of) S 
1920 6420 P (the) S 60 J ( miniport) S 60 J ( driver,) S 60 J ( as) S 60 J ( described) S 60 J ( in) S 60 J ( Chapter) S 60 J ( 16,) S 60 J ( to) S 60 J ( help) S 60 J ( users) S 60 J ( or) S 60 J ( system) S 60 J ( administrators) S 60 J ( monitor) S 
1920 6680 P (the) S 60 J ( condition) S 60 J ( of) S 60 J ( the) S 60 J ( HBA.) S 0 12 F 
PE PSe
