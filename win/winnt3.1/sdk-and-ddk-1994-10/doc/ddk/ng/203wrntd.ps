%!PS-Adobe-3.0
%%Creator: Windows PSCRIPT
%%Title: Microsoft Word - 203WRNTD.DOC
%%BoundingBox: 14 9 597 784
%%DocumentNeededResources: (atend)
%%DocumentSuppliedResources: (atend)
%%Pages: (atend)
%%BeginResource: procset Win35Dict 3 1
/Win35Dict 290 dict def Win35Dict begin/bd{bind def}bind def/in{72
mul}bd/ed{exch def}bd/ld{load def}bd/tr/translate ld/gs/gsave ld/gr
/grestore ld/M/moveto ld/L/lineto ld/rmt/rmoveto ld/rlt/rlineto ld
/rct/rcurveto ld/st/stroke ld/n/newpath ld/sm/setmatrix ld/cm/currentmatrix
ld/cp/closepath ld/ARC/arcn ld/TR{65536 div}bd/lj/setlinejoin ld/lc
/setlinecap ld/ml/setmiterlimit ld/sl/setlinewidth ld/scignore false
def/sc{scignore{pop pop pop}{0 index 2 index eq 2 index 4 index eq
and{pop pop 255 div setgray}{3{255 div 3 1 roll}repeat setrgbcolor}ifelse}ifelse}bd
/FC{bR bG bB sc}bd/fC{/bB ed/bG ed/bR ed}bd/HC{hR hG hB sc}bd/hC{
/hB ed/hG ed/hR ed}bd/PC{pR pG pB sc}bd/pC{/pB ed/pG ed/pR ed}bd/sM
matrix def/PenW 1 def/iPen 5 def/mxF matrix def/mxE matrix def/mxUE
matrix def/mxUF matrix def/fBE false def/iDevRes 72 0 matrix defaultmatrix
dtransform dup mul exch dup mul add sqrt def/fPP false def/SS{fPP{
/SV save def}{gs}ifelse}bd/RS{fPP{SV restore}{gr}ifelse}bd/EJ{gsave
showpage grestore}bd/#C{userdict begin/#copies ed end}bd/FEbuf 2 string
def/FEglyph(G  )def/FE{1 exch{dup 16 FEbuf cvrs FEglyph exch 1 exch
putinterval 1 index exch FEglyph cvn put}for}bd/SM{/iRes ed/cyP ed
/cxPg ed/cyM ed/cxM ed 72 100 div dup scale dup 0 ne{90 eq{cyM exch
0 eq{cxM exch tr -90 rotate -1 1 scale}{cxM cxPg add exch tr +90 rotate}ifelse}{cyP
cyM sub exch 0 ne{cxM exch tr -90 rotate}{cxM cxPg add exch tr -90
rotate 1 -1 scale}ifelse}ifelse}{pop cyP cyM sub exch 0 ne{cxM cxPg
add exch tr 180 rotate}{cxM exch tr 1 -1 scale}ifelse}ifelse 100 iRes
div dup scale 0 0 transform .25 add round .25 sub exch .25 add round
.25 sub exch itransform translate}bd/SJ{1 index 0 eq{pop pop/fBE false
def}{1 index/Break ed div/dxBreak ed/fBE true def}ifelse}bd/ANSIVec[
16#0/grave 16#1/acute 16#2/circumflex 16#3/tilde 16#4/macron 16#5/breve
16#6/dotaccent 16#7/dieresis 16#8/ring 16#9/cedilla 16#A/hungarumlaut
16#B/ogonek 16#C/caron 16#D/dotlessi 16#27/quotesingle 16#60/grave
16#7C/bar 16#82/quotesinglbase 16#83/florin 16#84/quotedblbase 16#85
/ellipsis 16#86/dagger 16#87/daggerdbl 16#88/circumflex 16#89/perthousand
16#8A/Scaron 16#8B/guilsinglleft 16#8C/OE 16#91/quoteleft 16#92/quoteright
16#93/quotedblleft 16#94/quotedblright 16#95/bullet 16#96/endash 16#97
/emdash 16#98/tilde 16#99/trademark 16#9A/scaron 16#9B/guilsinglright
16#9C/oe 16#9F/Ydieresis 16#A0/space 16#A1/exclamdown 16#A4/currency
16#A5/yen 16#A6/brokenbar 16#A7/section 16#A8/dieresis 16#A9/copyright
16#AA/ordfeminine 16#AB/guillemotleft 16#AC/logicalnot 16#AD/hyphen
16#AE/registered 16#AF/macron 16#B0/degree 16#B1/plusminus 16#B2/twosuperior
16#B3/threesuperior 16#B4/acute 16#B5/mu 16#B6/paragraph 16#B7/periodcentered
16#B8/cedilla 16#B9/onesuperior 16#BA/ordmasculine 16#BB/guillemotright
16#BC/onequarter 16#BD/onehalf 16#BE/threequarters 16#BF/questiondown
16#C0/Agrave 16#C1/Aacute 16#C2/Acircumflex 16#C3/Atilde 16#C4/Adieresis
16#C5/Aring 16#C6/AE 16#C7/Ccedilla 16#C8/Egrave 16#C9/Eacute 16#CA
/Ecircumflex 16#CB/Edieresis 16#CC/Igrave 16#CD/Iacute 16#CE/Icircumflex
16#CF/Idieresis 16#D0/Eth 16#D1/Ntilde 16#D2/Ograve 16#D3/Oacute 16#D4
/Ocircumflex 16#D5/Otilde 16#D6/Odieresis 16#D7/multiply 16#D8/Oslash
16#D9/Ugrave 16#DA/Uacute 16#DB/Ucircumflex 16#DC/Udieresis 16#DD/Yacute
16#DE/Thorn 16#DF/germandbls 16#E0/agrave 16#E1/aacute 16#E2/acircumflex
16#E3/atilde 16#E4/adieresis 16#E5/aring 16#E6/ae 16#E7/ccedilla 16#E8
/egrave 16#E9/eacute 16#EA/ecircumflex 16#EB/edieresis 16#EC/igrave
16#ED/iacute 16#EE/icircumflex 16#EF/idieresis 16#F0/eth 16#F1/ntilde
16#F2/ograve 16#F3/oacute 16#F4/ocircumflex 16#F5/otilde 16#F6/odieresis
16#F7/divide 16#F8/oslash 16#F9/ugrave 16#FA/uacute 16#FB/ucircumflex
16#FC/udieresis 16#FD/yacute 16#FE/thorn 16#FF/ydieresis ] def/reencdict
12 dict def/IsChar{basefontdict/CharStrings get exch known}bd/MapCh{dup
IsChar not{pop/bullet}if newfont/Encoding get 3 1 roll put}bd/MapDegree{16#b0
/degree IsChar{/degree}{/ring}ifelse MapCh}bd/MapBB{16#a6/brokenbar
IsChar{/brokenbar}{/bar}ifelse MapCh}bd/ANSIFont{reencdict begin/newfontname
ed/basefontname ed FontDirectory newfontname known not{/basefontdict
basefontname findfont def/newfont basefontdict maxlength dict def basefontdict{exch
dup/FID ne{dup/Encoding eq{exch dup length array copy newfont 3 1 roll
put}{exch newfont 3 1 roll put}ifelse}{pop pop}ifelse}forall newfont
/FontName newfontname put 127 1 159{newfont/Encoding get exch/bullet
put}for ANSIVec aload pop ANSIVec length 2 idiv{MapCh}repeat MapDegree
MapBB newfontname newfont definefont pop}if newfontname end}bd/SB{FC
/ULlen ed/str ed str length fBE not{dup 1 gt{1 sub}if}if/cbStr ed
/dxGdi ed/y0 ed/x0 ed str stringwidth dup 0 ne{/y1 ed/x1 ed y1 y1
mul x1 x1 mul add sqrt dxGdi exch div 1 sub dup x1 mul cbStr div exch
y1 mul cbStr div}{exch abs neg dxGdi add cbStr div exch}ifelse/dyExtra
ed/dxExtra ed x0 y0 M fBE{dxBreak 0 BCh dxExtra dyExtra str awidthshow}{dxExtra
dyExtra str ashow}ifelse fUL{x0 y0 M dxUL dyUL rmt ULlen fBE{Break
add}if 0 mxUE transform gs rlt cyUL sl [] 0 setdash st gr}if fSO{x0
y0 M dxSO dySO rmt ULlen fBE{Break add}if 0 mxUE transform gs rlt cyUL
sl [] 0 setdash st gr}if n/fBE false def}bd/font{/name ed/Ascent ed
0 ne/fT3 ed 0 ne/fSO ed 0 ne/fUL ed/Sy ed/Sx ed 10.0 div/ori ed -10.0
div/esc ed/BCh ed name findfont/xAscent 0 def/yAscent Ascent def/ULesc
esc def ULesc mxUE rotate pop fT3{/esc 0 def xAscent yAscent mxUE transform
/yAscent ed/xAscent ed}if [Sx 0 0 Sy neg xAscent yAscent] esc mxE
rotate mxF concatmatrix makefont setfont [Sx 0 0 Sy neg 0 Ascent] mxUE
mxUF concatmatrix pop fUL{currentfont dup/FontInfo get/UnderlinePosition
known not{pop/Courier findfont}if/FontInfo get/UnderlinePosition get
1000 div 0 exch mxUF transform/dyUL ed/dxUL ed}if fSO{0 .3 mxUF transform
/dySO ed/dxSO ed}if fUL fSO or{currentfont dup/FontInfo get/UnderlineThickness
known not{pop/Courier findfont}if/FontInfo get/UnderlineThickness get
1000 div Sy mul/cyUL ed}if}bd/min{2 copy gt{exch}if pop}bd/max{2 copy
lt{exch}if pop}bd/CP{/ft ed{{ft 0 eq{clip}{eoclip}ifelse}stopped{currentflat
1 add setflat}{exit}ifelse}loop}bd/patfont 10 dict def patfont begin
/FontType 3 def/FontMatrix [1 0 0 -1 0 0] def/FontBBox [0 0 16 16]
def/Encoding StandardEncoding def/BuildChar{pop pop 16 0 0 0 16 16
setcachedevice 16 16 false [1 0 0 1 .25 .25]{pat}imagemask}bd end/p{
/pat 32 string def{}forall 0 1 7{dup 2 mul pat exch 3 index put dup
2 mul 1 add pat exch 3 index put dup 2 mul 16 add pat exch 3 index
put 2 mul 17 add pat exch 2 index put pop}for}bd/pfill{/PatFont patfont
definefont setfont/ch(AAAA)def X0 64 X1{Y1 -16 Y0{1 index exch M ch
show}for pop}for}bd/vert{X0 w X1{dup Y0 M Y1 L st}for}bd/horz{Y0 w
Y1{dup X0 exch M X1 exch L st}for}bd/fdiag{X0 w X1{Y0 M X1 X0 sub dup
rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup rlt st}for}bd/bdiag{X0 w
X1{Y1 M X1 X0 sub dup neg rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup
neg rlt st}for}bd/AU{1 add cvi 15 or}bd/AD{1 sub cvi -16 and}bd/SHR{pathbbox
AU/Y1 ed AU/X1 ed AD/Y0 ed AD/X0 ed}bd/hfill{/w iRes 37.5 div round
def 0.1 sl [] 0 setdash n dup 0 eq{horz}if dup 1 eq{vert}if dup 2 eq{fdiag}if
dup 3 eq{bdiag}if dup 4 eq{horz vert}if 5 eq{fdiag bdiag}if}bd/F{/ft
ed fm 256 and 0 ne{gs FC ft 0 eq{fill}{eofill}ifelse gr}if fm 1536
and 0 ne{SHR gs HC ft CP fm 1024 and 0 ne{/Tmp save def pfill Tmp restore}{fm
15 and hfill}ifelse gr}if}bd/S{PenW sl PC st}bd/m matrix def/GW{iRes
12 div PenW add cvi}bd/DoW{iRes 50 div PenW add cvi}bd/DW{iRes 8 div
PenW add cvi}bd/SP{/PenW ed/iPen ed iPen 0 eq iPen 6 eq or{[] 0 setdash}if
iPen 1 eq{[DW GW] 0 setdash}if iPen 2 eq{[DoW GW] 0 setdash}if iPen
3 eq{[DW GW DoW GW] 0 setdash}if iPen 4 eq{[DW GW DoW GW DoW GW] 0
setdash}if}bd/E{m cm pop tr scale 1 0 moveto 0 0 1 0 360 arc cp m sm}bd
/AG{/sy ed/sx ed sx div 4 1 roll sy div 4 1 roll sx div 4 1 roll sy
div 4 1 roll atan/a2 ed atan/a1 ed sx sy scale a1 a2 ARC}def/A{m cm
pop tr AG m sm}def/P{m cm pop tr 0 0 M AG cp m sm}def/RRect{n 4 copy
M 3 1 roll exch L 4 2 roll L L cp}bd/RRCC{/r ed/y1 ed/x1 ed/y0 ed/x0
ed x0 x1 add 2 div y0 M x1 y0 x1 y1 r arcto 4{pop}repeat x1 y1 x0 y1
r arcto 4{pop}repeat x0 y1 x0 y0 r arcto 4{pop}repeat x0 y0 x1 y0 r
arcto 4{pop}repeat cp}bd/RR{2 copy 0 eq exch 0 eq or{pop pop RRect}{2
copy eq{pop RRCC}{m cm pop/y2 ed/x2 ed/ys y2 x2 div 1 max def/xs x2
y2 div 1 max def/y1 exch ys div def/x1 exch xs div def/y0 exch ys div
def/x0 exch xs div def/r2 x2 y2 min def xs ys scale x0 x1 add 2 div
y0 M x1 y0 x1 y1 r2 arcto 4{pop}repeat x1 y1 x0 y1 r2 arcto 4{pop}repeat
x0 y1 x0 y0 r2 arcto 4{pop}repeat x0 y0 x1 y0 r2 arcto 4{pop}repeat
m sm cp}ifelse}ifelse}bd/PP{{rlt}repeat}bd/OB{gs 0 ne{7 3 roll/y ed
/x ed x y translate ULesc rotate x neg y neg translate x y 7 -3 roll}if
sc B fill gr}bd/B{M/dy ed/dx ed dx 0 rlt 0 dy rlt dx neg 0 rlt cp}bd
/CB{B clip n}bd/ErrHandler{errordict dup maxlength exch length gt
dup{errordict begin}if/errhelpdict 12 dict def errhelpdict begin/stackunderflow(operand stack underflow)def
/undefined(this name is not defined in a dictionary)def/VMerror(you have used up all the printer's memory)def
/typecheck(operator was expecting a different type of operand)def
/ioerror(input/output error occured)def end{end}if errordict begin
/handleerror{$error begin newerror{/newerror false def showpage 72
72 scale/x .25 def/y 9.6 def/Helvetica findfont .2 scalefont setfont
x y moveto(Offending Command = )show/command load{dup type/stringtype
ne{(max err string)cvs}if show}exec/y y .2 sub def x y moveto(Error = )show
errorname{dup type dup( max err string )cvs show( : )show/stringtype
ne{( max err string )cvs}if show}exec errordict begin errhelpdict errorname
known{x 1 add y .2 sub moveto errhelpdict errorname get show}if end
/y y .4 sub def x y moveto(Stack =)show ostack{/y y .2 sub def x 1
add y moveto dup type/stringtype ne{( max err string )cvs}if show}forall
showpage}if end}def end}bd end
%%EndResource
/SVDoc save def
%%EndProlog
%%BeginSetup
Win35Dict begin
ErrHandler
statusdict begin 0 setjobtimeout end
statusdict begin statusdict /jobname (Microsoft Word - 203WRNTD.DOC) put end
/oldDictCnt countdictstack def {}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
/oldDictCnt countdictstack def {letter
}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
[{ }
/exec load currenttransfer /exec load] cvx settransfer
%%EndSetup
%%Page: 1 1
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 50 50 0 0 0 45 /Times-Roman /font32 ANSIFont font
0 0 0 fC
346 491 33 (C) 58 SB
404 491 36 (H) 61 SB
465 491 35 (A) 60 SB
525 491 28 (P) 53 SB
578 491 31 (T) 56 SB
634 491 31 (E) 56 SB
690 491 33 (R) 58 SB
748 491 13 ( ) 38 SB
786 491 25 (3) 50 SB
32 0 0 100 100 0 0 0 93 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 1400 513 346 604 CB
346 602 941 (Writing a Netcard Driver) 941 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1117 1298 (The DDK contains several sample NDIS 3.0 netcard drivers you can use in) 1298 SB
721 1167 1397 (developing your own driver. Although driver requirements vary depending on the) 1397 SB
721 1217 1407 (netcard driver controls, many basic functions \(such as initialization, sending data,) 1407 SB
721 1267 1356 (receiving data, interrupt handling, and deactivation\) are common to all drivers.) 1356 SB
721 1317 1296 (Writing a driver from scratch can be very difficult and time-consuming. By) 1296 SB
721 1367 1346 (modifying an existing driver you can take advantage of the development effort) 1346 SB
721 1417 1374 (invested in a working product. Most of your programming endeavor can then be) 1374 SB
721 1467 1061 (spent in code modifications instead of full-scale development.) 1061 SB
721 1550 1402 (This section examines the SONIC Ethernet driver in detail and offers suggestions) 1402 SB
721 1600 1315 (for adapting the code to your netcard. It includes some general programming) 1315 SB
721 1650 883 (considerations to note before you begin. The DDK ) 883 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1604 1650 249 (Release Notes) 249 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1853 1650 294 ( provide building) 294 SB
721 1700 1392 (and loading instructions to accompany these details of sample code modification.) 1392 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1820 1094 (3.1  Programming Considerations) 1094 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1934 1403 (Most NDIS 2.0 netcard drivers are written in 80x86 assembly language. Because) 1403 SB
721 1984 1417 (these drivers have specific knowledge of interrupts, memory management, and I/O) 1417 SB
721 2034 1413 (programming models for Windows MS-DOS, they do not operate under Windows) 1413 SB
721 2084 1413 (NT, even for an 80x86-based processor. Similarly, you cannot easily adapt such a) 1413 SB
721 2134 1384 (driver to run on operating systems based on other processors that are not 80x86-) 1384 SB
721 2184 201 (compatible.) 201 SB
721 2267 1441 (For these reasons, you need to develop your driver in a high-level language, such as) 1441 SB
721 2317 1332 (C. You can use other languages, but they must allow you to express the exact) 1332 SB
721 2367 1445 (semantics of a C interface. The list of semantics is large and includes such basics as) 1445 SB
721 2417 1275 (parameter passing conventions, stack cleanup conventions, register saving) 1275 SB
721 2467 684 (conventions, and return value locations.) 684 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 1 def
/wp$fpage (1) def
/wp$date (07/18/93) def
/wp$time (04:35 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 2 2
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 18 (2) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1450 (The NDIS interface library is in a format that is compatible with assembly language) 1450 SB
634 546 1417 (drivers. You can write portions of your driver in assembly language, but parts that) 1417 SB
634 596 1376 (call NDIS interface library functions must be written in C. Do not use assembly) 1376 SB
634 646 1365 (language to attempt to mimic C calling conventions, since some of the interface) 1365 SB
634 696 1298 (library functions are actually C macros. In addition, a function of the NDIS) 1298 SB
634 746 1427 (interface library may easily change to a macro in a future version of Windows NT,) 1427 SB
634 796 232 (or vice versa.) 232 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 904 813 (3.1.1  Handling Transmit Data) 813 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1000 1328 (When writing a netcard driver, ensure that any data the card reads is actually) 1328 SB
634 1050 1409 (present in physical memory before the read begins. Have your driver flush cached) 1409 SB
634 1100 630 (memory for transmit data by calling ) 630 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1264 1099 307 (NdisFlushBuffer) 307 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1571 1100 452 (. The cache is divided into) 452 SB
634 1150 1359 (blocks of a fixed cache fill size, and the driver should flush an entire block at a) 1359 SB
634 1200 1426 (time. The driver does not need to flush all cached data immediately after writing it,) 1426 SB
634 1250 1412 (but should flush it before netcard access. Since cache line tearing is not a problem) 1412 SB
634 1300 1396 (for transmit data, the driver can flush the data without concern for cache fill size.) 1396 SB
634 1383 1404 (For example, the netcard driver usually gives a busmastering netcard the physical) 1404 SB
634 1433 1150 (addresses of packet segments. Most of these segments are from the) 1150 SB
634 1483 1018 (NDIS_PACKET structure that a transport driver passes to ) 1018 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1652 1482 175 (MacSend) 175 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1827 1483 245 ( in the netcard) 245 SB
634 1533 1409 (driver. The netcard driver describes the segments to the netcard, and then releases) 1409 SB
634 1583 1378 (the packet to the card for transmission on the network. The driver must flush the) 1378 SB
634 1633 1356 (data at some point before it relinquishes the packet, but the actual timing is not) 1356 SB
634 1683 1136 (important. The netcard driver can flush cached data upon entry to ) 1136 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1770 1682 175 (MacSend) 175 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1945 1683 58 (, or) 58 SB
634 1733 714 (immediately before it releases the packet.) 714 SB
634 1816 1347 (When using noncached memory for transmit data, make sure that your netcard) 1347 SB
634 1866 205 (driver calls ) 205 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
839 1865 354 (NdisWriteRegister) 354 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1193 1866 851 (. This function ensures that the data is in physical) 851 SB
634 1916 1413 (memory before it returns. Calling the function allows sequential writes to memory) 1413 SB
634 1966 1306 (in the order in which they occur and consecutive writes to the same memory) 1306 SB
634 2016 1376 (location, resulting in two distinct writes to memory. This is especially important) 1376 SB
634 2066 1352 (when the driver is accessing memory that corresponds to netcard registers. For) 1352 SB
634 2116 1433 (example, if the reset register requires the netcard driver to write first a 0 and then a) 1433 SB
634 2166 1032 (1 before a reset, the driver must not merge these two writes.) 1032 SB
255 255 255 fC
1449 3 634 2266 B
1 F
n
0 0 0 fC
1449 2 634 2270 B
1 F
n
32 0 0 44 44 0 0 0 42 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 144 58 607 2273 CB
634 2279 80 (Note) 80 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
751 2281 1311 (Generally it is preferable to allocate cached memory for transmit data, since) 1311 SB
634 2331 1329 (the operating system can have trouble allocating noncached memory. Always) 1329 SB
634 2381 1437 (assume that memory passed in from a transport driver is cached. Have your netcard) 1437 SB
634 2431 1393 (driver use cached memory as memory to which it writes only rarely and flush the) 1393 SB
634 2481 1431 (memory when writing. To simplify its logic, the driver may use noncached memory) 1431 SB
634 2531 608 (as memory to which it writes often.) 608 SB
255 255 255 fC
1449 3 634 2601 B
1 F
n
0 0 0 fC
1449 2 634 2598 B
1 F
n
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 2 def
/wp$fpage (2) def
/wp$date (07/18/93) def
/wp$time (04:35 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 3 3
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1440 378 133 (Chapter ) 133 SB
1573 378 18 (3) 18 SB
1591 378 411 (    Writing a Netcard Driver) 411 SB
2002 378 9 ( ) 61 SB
2063 378 9 ( ) 61 SB
2124 378 18 (3) 18 SB
2142 378 11 (-) 11 SB
2153 378 18 (3) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 492 785 (3.1.2  Handling Receive Data) 785 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 588 1301 (When handling receive data in your netcard driver, ensure that any memory) 1301 SB
721 638 1404 (receiving data from the netcard is not present in the cache before a read begins. If) 1404 SB
721 688 1407 (the memory is in the cache at the time of the read, the driver obtains the old cache) 1407 SB
721 738 1325 (data instead of the new data in physical memory. In addition, if the processor) 1325 SB
721 788 1420 (flushes the cache at the wrong time, it overwrites the new data with the old values.) 1420 SB
721 871 971 (Write your driver to flush cached memory with a call to ) 971 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1692 870 307 (NdisFlushBuffer) 307 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1999 871 82 (. For) 82 SB
721 921 1369 (receive data, set the direction parameter used in the call to FALSE, indicating a) 1369 SB
721 971 1440 (read operation. It is critical that you flush cached memory before the netcard begins) 1440 SB
721 1021 1442 (writing data into it. Be sure that the driver does not access memory in any way until) 1442 SB
721 1071 1395 (the netcard has completed its write. This ensures that memory is not in the cache,) 1395 SB
721 1121 1405 (and forces subsequent reads to go to physical memory, which contains the current) 1405 SB
721 1171 84 (data.) 84 SB
255 255 255 fC
1449 3 721 1271 B
1 F
n
0 0 0 fC
1449 2 721 1275 B
1 F
n
32 0 0 44 44 0 0 0 42 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 144 58 694 1278 CB
721 1284 80 (Note) 80 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
838 1286 1279 (For a buffer that does not begin and end on an address that is a multiple of) 1279 SB
721 1336 810 (the cache fill size, do not have your driver call ) 810 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1531 1335 307 (NdisFlushBuffer) 307 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1838 1336 313 ( with the write-to-) 313 SB
721 1386 552 (device parameter set to FALSE.) 552 SB
255 255 255 fC
1449 3 721 1456 B
1 F
n
0 0 0 fC
1449 2 721 1453 B
1 F
n
721 1497 1383 (Cache line tearing can occur during the flushing of data that covers one part of a) 1383 SB
721 1547 1346 (cache block while another process in the operating system owns the rest of the) 1346 SB
721 1597 1426 (block. Tearing is a problem with receive data in cached memory. Remember that it) 1426 SB
721 1647 1359 (is illegal to make a DMA into memory that is on a cache block that the netcard) 1359 SB
721 1697 1388 (driver does not completely own. If the driver makes such an access, the owner of) 1388 SB
721 1747 1397 (the rest of the cache block can flush it while the DMA is in progress, overwriting) 1397 SB
721 1797 756 (the new data with stale data from the cache.) 756 SB
721 1880 1325 (You can generally avoid cache line tearing, since the netcard driver allocates) 1325 SB
721 1930 1399 (memory that the netcard uses to receive data. The driver also ensures that receive) 1399 SB
721 1980 1329 (buffers do not cross cache lines. Memory the NDIS interface library wrapper) 1329 SB
721 2030 1356 (allocates with the NDIS_MEMORY_CACHE_ALIGNED flag does not share) 1356 SB
721 2080 1415 (cache blocks with any other memory. If your driver divides allocated memory, use) 1415 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 2129 408 (NdisGetCacheFillSize) 408 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1129 2130 1011 ( to ensure that each piece does not share cache blocks. The) 1011 SB
721 2180 1428 (driver can obtain the cache fill size using this function, and then examine virtual or) 1428 SB
721 2230 1354 (physical addresses of the memory with the assumption that relevant low bits in) 1354 SB
721 2280 967 (memory are the same for virtual and physical addresses.) 967 SB
721 2363 1391 (You must be careful that a netcard performs DMA as a slave device. For receive) 1391 SB
721 2413 453 (data, DMA occurs during ) 453 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1174 2412 340 (MacTransferData) 340 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1514 2413 534 ( processing. The netcard driver) 534 SB
721 2463 1397 (cannot control the alignment of the buffers that a transport driver passes in. If the) 1397 SB
721 2513 1430 (netcard driver discovers that the beginning or end of a buffer is not on a cache line,) 1430 SB
721 2563 1433 (it must DMA-transfer these pieces into a private buffer and then copy them. This is) 1433 SB
721 2613 1197 (the only way to guarantee that the netcard driver reads data correctly.) 1197 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 3 def
/wp$fpage (3) def
/wp$date (07/18/93) def
/wp$time (04:35 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 4 4
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 18 (4) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1418 (When using noncached memory for receive data, make sure that the netcard driver) 1418 SB
634 546 362 (calls the appropriate ) 362 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
996 545 363 (NdisReadRegister*) 363 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1359 546 633 ( function for the data type \(UCHAR,) 633 SB
634 596 1437 (ULONG, USHORT\). These functions ensure the data is in physical memory before) 1437 SB
634 646 1436 (they return. They also ensure sequential reads to memory in the order in which they) 1436 SB
634 696 1415 (occur and consecutive reads to the same memory, resulting in two distinct reads to) 1415 SB
634 746 1303 (memory. This is especially important when the driver accesses memory that) 1303 SB
634 796 558 (corresponds to netcard registers.) 558 SB
634 879 1336 (Your driver should allocate as cached any receive data that multiple transport) 1336 SB
634 929 1411 (drivers can read several times during indications. In general, ownership of receive) 1411 SB
634 979 1444 (buffers is clear. The netcard driver can use cached buffers as long as it flushes them) 1444 SB
634 1029 1351 (just before releasing them. This does not work if releasing the buffers involves) 1351 SB
634 1079 1389 (writing to them, unless the ownership bits are not on the same cache block as the) 1389 SB
634 1129 1405 (received data. A driver reads other receive data \(such as receive descriptors\) only) 1405 SB
634 1179 1265 (once; so the netcard driver can allocate associated memory as noncached.) 1265 SB
634 1262 1415 (The netcard driver must flush receive data in multiples of the cache fill size. Some) 1415 SB
634 1312 1443 (netcards receive consecutive packets into immediately adjacent memory. The end of) 1443 SB
634 1362 1275 (one packet may occupy the same cache block as the beginning of the next.) 1275 SB
634 1412 1390 (Therefore, the driver must allocate such memory as noncached, since reading the) 1390 SB
634 1462 1200 (first packet may cause stale cache data for the start of the second one.) 1200 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1570 1299 (3.1.3  Memory Mapping for Physical Addresses) 1299 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1666 1436 (Memory mapping allows the NDIS interface library to associate the virtual address) 1436 SB
634 1716 1363 (of a buffer with the addresses of the physical segments that make up the buffer.) 1363 SB
634 1766 1333 (Your netcard driver must specify at initialization the number of map registers) 1333 SB
634 1816 885 (needed and, for each mapping, the map register for ) 885 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1519 1815 400 (NdisRegisterAdapter) 400 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1919 1816 123 ( to use.) 123 SB
634 1866 837 (For memory mapping, the driver should first call) 837 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1915 625 (NdisStartBufferPhysicalMapping) 625 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1259 1916 720 (. The physical addresses that this function) 720 SB
634 1966 1435 (writes are valid for netcard use only until the driver finishes the mapping by calling) 1435 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 2015 710 (NdisCompleteBufferPhysicalMapping) 710 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1344 2016 684 (. Through the virtual address, the driver) 684 SB
634 2066 1357 (can only access data the netcard copies into operating system memory after the) 1357 SB
634 2116 365 (mapping is complete.) 365 SB
255 255 255 fC
1449 3 634 2216 B
1 F
n
0 0 0 fC
1449 2 634 2220 B
1 F
n
32 0 0 44 44 0 0 0 42 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 144 58 607 2223 CB
634 2229 80 (Note) 80 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
751 2231 1282 (An NDIS 3.0 netcard driver cannot allocate memory from its ISR or DPR.) 1282 SB
255 255 255 fC
1449 3 634 2301 B
1 F
n
0 0 0 fC
1449 2 634 2298 B
1 F
n
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 4 def
/wp$fpage (4) def
/wp$date (07/18/93) def
/wp$time (04:35 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 5 5
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1440 378 133 (Chapter ) 133 SB
1573 378 18 (3) 18 SB
1591 378 411 (    Writing a Netcard Driver) 411 SB
2002 378 9 ( ) 61 SB
2063 378 9 ( ) 61 SB
2124 378 18 (3) 18 SB
2142 378 11 (-) 11 SB
2153 378 18 (5) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 492 776 (3.1.4  Using Shared Memory) 776 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 588 1334 (Use of cached memory that is shared between a netcard driver and its netcard) 1334 SB
721 638 1412 (requires special precautions. Windows NT does not ensure execution of the NDIS) 1412 SB
721 688 1384 (interface library with an I/O-coherent cache, since a netcard can access physical) 1384 SB
721 738 1425 (memory directly while the netcard driver accesses memory through the cache. This) 1425 SB
721 788 1405 (can cause differences in what the driver and the netcard detect in memory, even if) 1405 SB
721 838 524 (they look at the same location.) 524 SB
721 921 1326 (Use of noncached shared memory avoids most of the problems mentioned for) 1326 SB
721 971 1446 (cached shared memory. However, when data written to physical memory must use a) 1446 SB
721 1021 1310 (small write queue, even noncached data may not appear in physical memory) 1310 SB
721 1071 1381 (immediately. Additionally, there are cases when using noncached memory is not) 1381 SB
721 1121 1294 (recommended or is not possible. For example, data the netcard driver reads) 1294 SB
721 1171 1380 (repeatedly should always be cached to improve performance. The netcard driver) 1380 SB
721 1221 1324 (should also use cached memory for any data that a transport driver passes in.) 1324 SB
721 1304 888 (To help eliminate shared memory problems, use an ) 888 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1609 1303 535 (NdisAllocateSharedMemory) 535 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1354 1396 (call in your netcard driver to allocate memory for permanent sharing between the) 1396 SB
721 1404 1439 (netcard and the driver. This function writes a virtual address and a physical address) 1439 SB
721 1454 1146 (for the shared memory. The physical address is valid until a call to) 1146 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1503 466 (NdisFreeSharedMemory) 466 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1187 1504 938 ( frees the memory. To access the shared memory, your) 938 SB
721 1554 281 (driver must call ) 281 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1002 1553 517 (NdisUpdateSharedMemory) 517 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1519 1554 11 (.) 11 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1662 666 (3.1.5  Interrupt Handling) 666 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1758 1419 (A combination of spin lock use and interrupt synchronization ensures your netcard) 1419 SB
721 1808 1018 (driver can run safely on a multiprocessor operating system.) 1018 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1857 584 (NdisSynchronizeWithInterrupt) 584 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1305 1858 431 ( has more overhead than ) 431 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1736 1857 414 (NdisAcquireSpinLock) 414 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1908 73 (and ) 73 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
794 1907 406 (NdisReleaseSpinLock) 406 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1200 1908 960 (. Therefore, to minimize the number of variables for the) 960 SB
721 1958 193 (driver, use ) 193 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
914 1957 414 (NdisAcquireSpinLock) 414 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1328 1958 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1412 1957 406 (NdisReleaseSpinLock) 406 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1818 1958 346 ( for synchronization) 346 SB
721 2008 73 (and ) 73 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
794 2007 584 (NdisSynchronizeWithInterrupt) 584 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1378 2008 753 ( for any data that a non-ISR function shares) 753 SB
721 2058 228 (with the ISR.) 228 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 2178 930 (3.2  About the Sample Driver) 930 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2292 1335 (The SONIC driver code described in Table 3.1 is designed to interface with a) 1335 SB
721 2342 1422 (single-chip Ethernet controller, the SONIC IC, which is manufactured by National) 1422 SB
721 2392 1436 (Semiconductor as part number DP83932. The combination of the DP83932 and the) 1436 SB
721 2442 1349 (National DP8392 Coaxial Transceiver Interface or the DP83922 Twisted Pair) 1349 SB
721 2492 908 (Interface IC comprises a complete Ethernet package.) 908 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 5 def
/wp$fpage (5) def
/wp$date (07/18/93) def
/wp$time (04:35 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 6 6
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 18 (6) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1419 (The SONIC IC includes many Ethernet features that are traditionally implemented) 1419 SB
634 546 1356 (in software, including a linked list buffer management mechanism for handling) 1356 SB
634 596 1427 (receive and transmit packets in system memory. Other features include: DMA data) 1427 SB
634 646 1437 (transfer, a single interrupt, independent transmit and receive FIFO buffers, transmit) 1437 SB
634 696 1393 (data serializer, receive data deserializer, integrated IEEE 802.3 encoder-decoder) 1393 SB
634 746 1265 (\(ENDEC\), receive data address filtering, and packet loopback capability.) 1265 SB
634 829 1348 (The SONIC driver uses both the NDIS interface library and the Ethernet filter) 1348 SB
634 879 1124 (library. The code accesses library functions by including the files) 1124 SB
1758 879 11 ( ) 11 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1769 879 106 (ndis.h) 106 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1875 879 73 ( and) 73 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
634 929 138 (efilter.h) 138 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
772 929 240 (, respectively.) 240 SB
634 1012 1397 (The SONIC driver contains all the NDIS 3.0 netcard driver upper-edge functions) 1397 SB
634 1062 1367 (the NDIS interface library requires. For more information about the upper edge) 1367 SB
634 1112 1352 (functions, see Chapter 1. The driver also implements the three action functions) 1352 SB
634 1162 1386 (required by the Ethernet filter library. You can trace driver operation by starting) 1386 SB
634 1212 552 (with these entry point functions.) 552 SB
634 1295 874 (For interrupt handling, the SONIC driver contains ) 874 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1508 1294 416 (SonicInterruptService) 416 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1924 1295 100 ( as its) 100 SB
634 1345 89 (ISR. ) 89 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
723 1344 470 (SonicDeferredProcessing) 470 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1193 1345 837 ( is the DPR that runs automatically after the ISR) 837 SB
634 1395 1407 (returns. It performs interrupt-related processing running at an IRQL below that of) 1407 SB
634 1445 141 (the ISR.) 141 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
634 1533 540 (Table 3.1    SONIC Driver Files) 540 SB
1461 2 628 1591 B
1 F
n
gs 282 63 634 1598 CB
634 1603 65 (File) 65 SB
gr
gs 1166 63 917 1598 CB
967 1603 168 (Definition) 168 SB
gr
1448 2 634 1661 B
1 F
n
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 634 1668 CB
634 1672 171 (sonichrd.h) 171 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 50 917 1668 CB
967 1673 1106 (Defines constants, macros, data types, and global variables associated) 1106 SB
gr
gs 1166 59 917 1718 CB
967 1719 395 (with the SONIC netcard.) 395 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 634 1777 CB
634 1781 154 (sonicsft.h) 154 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 50 917 1777 CB
967 1782 1083 (Defines constants, macros, data types, global variables, and function) 1083 SB
gr
gs 1166 59 917 1827 CB
967 1828 747 (prototypes included when compiling the driver ) 747 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 1166 59 917 1827 CB
1714 1827 60 (Xxx) 60 SB
gr
gs 1166 59 917 1827 CB
1774 1827 10 (.) 10 SB
gr
gs 1166 59 917 1827 CB
1784 1827 18 (c) 18 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 59 917 1827 CB
1802 1828 10 ( ) 10 SB
gr
gs 1166 59 917 1827 CB
1812 1828 77 (files.) 77 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 634 1886 CB
634 1890 164 (sonicdet.h) 164 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 50 917 1886 CB
967 1891 1102 (Contains detailed processor definitions for an 80386, 80486, or MIPS) 1102 SB
gr
gs 1166 59 917 1936 CB
967 1937 588 (processor, the platform for the driver.) 588 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 634 1995 CB
634 1999 113 (sonic.c) 113 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 50 917 1995 CB
967 2000 1072 (As the main driver file, contains functions for initializing the driver,) 1072 SB
gr
gs 1166 46 917 2045 CB
967 2046 1104 (registering the netcard, opening and closing the netcard, removing the) 1104 SB
gr
gs 1166 59 917 2091 CB
967 2092 534 (netcard, and unloading the driver.) 534 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 634 2150 CB
634 2154 102 (send.c) 102 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 50 917 2150 CB
967 2155 1070 (Contains code for sending a packet over the network using a simple) 1070 SB
gr
gs 1166 46 917 2200 CB
967 2201 1012 (resource allocation strategy. The driver can either acquire all the) 1012 SB
gr
gs 1166 46 917 2246 CB
967 2247 1091 (resources a packet needs and then submit the packet to the netcard or) 1091 SB
gr
gs 1166 46 917 2292 CB
967 2293 991 (queue the send request and wait until packet resources become) 991 SB
gr
gs 1166 59 917 2338 CB
967 2339 153 (available.) 153 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 634 2397 CB
634 2401 157 (transfer.c) 157 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 63 917 2397 CB
967 2402 1064 (Contains a function that transfers received data to transport drivers.) 1064 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 634 2460 CB
634 2464 147 (request.c) 147 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 50 917 2460 CB
967 2465 1103 (Contains functions that query and set driver capabilities for a netcard-) 1103 SB
gr
gs 1166 46 917 2510 CB
967 2511 1077 (transport driver binding. Additional functions query global statistics) 1077 SB
gr
gs 1166 46 917 2556 CB
967 2557 1100 (associated with the netcard and complete processing for binding open) 1100 SB
gr
gs 1166 46 917 2602 CB
967 2603 1055 (and close requests. This file includes the netcard driver upper-edge) 1055 SB
gr
gs 1166 46 917 2648 CB
967 2649 156 (functions ) 156 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 1166 46 917 2648 CB
1123 2649 228 (SonicRequest) 228 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 46 917 2648 CB
1351 2649 78 ( and ) 78 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 1166 46 917 2648 CB
1429 2649 465 (SonicQueryGlobalStatistics) 465 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 46 917 2648 CB
1894 2649 68 ( and) 68 SB
gr
gs 1166 46 917 2694 CB
967 2695 1070 (associated functions. It also contains netcard driver action functions) 1070 SB
gr
gs 1166 59 917 2740 CB
967 2741 549 (that the Ethernet filter library uses.) 549 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 6 def
/wp$fpage (6) def
/wp$date (07/18/93) def
/wp$time (04:35 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 7 7
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1440 378 133 (Chapter ) 133 SB
1573 378 18 (3) 18 SB
1591 378 411 (    Writing a Netcard Driver) 411 SB
2002 378 9 ( ) 61 SB
2063 378 9 ( ) 61 SB
2124 378 18 (3) 18 SB
2142 378 11 (-) 11 SB
2153 378 18 (7) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
0 0 0 fC
721 497 181 (Table 3.1 \() 181 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
902 496 164 (continued) 164 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
1066 497 395 (\)    SONIC Driver Files) 395 SB
1448 2 721 555 B
1 F
n
gs 282 63 721 562 CB
721 567 65 (File) 65 SB
gr
gs 1166 63 1004 562 CB
1054 567 168 (Definition) 168 SB
gr
281 2 721 625 B
1 F
n
1165 2 1004 625 B
1 F
n
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 721 632 CB
721 636 133 (packet.c) 133 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 50 1004 632 CB
1054 637 1109 (Contains functions that copy from a packet to a buffer or from a buffer) 1109 SB
gr
gs 1166 59 1004 682 CB
1054 683 181 (to a packet.) 181 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 721 741 CB
721 745 108 (alloc.c) 108 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 50 1004 741 CB
1054 746 1110 (Contains code for allocating and freeing netcard memory resources for) 1110 SB
gr
gs 1166 59 1004 791 CB
1054 792 161 (the driver.) 161 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 721 850 CB
721 854 175 (loopback.c) 175 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 50 1004 850 CB
1054 855 1083 (Contains functions for indicating packets on the loopback queue and) 1083 SB
gr
gs 1166 46 1004 900 CB
1054 901 1099 (for inserting and removing packets from both the loopback queue and) 1099 SB
gr
gs 1166 59 1004 946 CB
1054 947 396 (the send finishing queue.) 396 SB
gr
32 0 0 40 40 0 0 0 37 /Times-Italic /font31 ANSIFont font
gs 282 63 721 1005 CB
721 1009 160 (interrup.c) 160 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 1166 63 1004 1005 CB
1054 1010 814 (Contains code associated with interrupt processing.) 814 SB
gr
255 255 255 fC
1449 3 721 1088 B
1 F
n
0 0 0 fC
1449 2 721 1085 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1147 1301 (The most significant SONIC driver structure is the logical adapter structure) 1301 SB
721 1197 1305 (SONIC_ADAPTER, which holds information necessary for controlling and) 1305 SB
721 1247 1322 (monitoring a netcard. It is important to note that an Ethernet circuit using the) 1322 SB
721 1297 1372 (SONIC IC can be small and a designer can implement it on an IBM-compatible) 1372 SB
721 1347 1417 (motherboard as part of the basic computer. However, NDIS 3.0 still uses a logical) 1417 SB
721 1397 536 (adapter to represent the circuit.) 536 SB
721 1480 1322 (The SONIC driver can support several netcards and therefore can implement) 1322 SB
721 1530 1233 (several netcard structures \(NDIS_ADAPTER_INFORMATION\), each) 1233 SB
721 1580 1416 (representing a logical adapter. The driver links these structures in a global netcard) 1416 SB
721 1630 1320 (list. To maintain data integrity, the driver defines one spin lock to protect the) 1320 SB
721 1680 931 (netcard list and one spin lock for each logical adapter.) 931 SB
721 1763 1256 (Another important SONIC driver structure is SONIC_OPEN, containing) 1256 SB
721 1813 829 (information related to the binding. The function ) 829 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1550 1812 359 (SonicOpenAdapter) 359 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1909 1813 26 ( \() 26 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1935 1813 124 (sonic.c) 124 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2059 1813 15 (\)) 15 SB
721 1863 1424 (creates one structure of this type for each transport driver that binds to the netcard.) 1424 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1983 1056 (3.3  Modifying the Sample Driver) 1056 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2097 1376 (The following sections offer advice for modifying the SONIC driver files to suit) 1376 SB
721 2147 1171 (your netcard. You can use much of the code with little modification.) 1171 SB
255 255 255 fC
1449 3 721 2247 B
1 F
n
0 0 0 fC
1449 2 721 2251 B
1 F
n
32 0 0 44 44 0 0 0 42 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 144 58 694 2254 CB
721 2260 80 (Note) 80 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
838 2262 1326 (The files and their functions refer to the sample SONIC driver using the term) 1326 SB
721 2312 1423 (Sonic. When you modify the code, replace this term with the name of your specific) 1423 SB
721 2362 114 (driver.) 114 SB
255 255 255 fC
1449 3 721 2432 B
1 F
n
0 0 0 fC
1449 2 721 2429 B
1 F
n
721 2473 1383 (When writing your driver, maintain the basic groups of items in the sample code) 1383 SB
721 2523 1344 (and modify them with specific details to match your netcard. For each SONIC) 1344 SB
721 2573 1380 (driver file, be sure to change the names of all identifiers that refer to the SONIC) 1380 SB
721 2623 1356 (netcard as appropriate for your specific card. After your changes are complete,) 1356 SB
721 2673 1074 (modify the header information for the file and all its functions.) 1074 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 7 def
/wp$fpage (7) def
/wp$date (07/18/93) def
/wp$time (04:35 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 8 8
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 18 (8) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1400 (For more information on the netcard driver upper-edge functions, transport driver) 1400 SB
634 546 1409 (lower-edge functions, NDIS interface library functions, and Ethernet filter library) 1409 SB
634 596 617 (functions, see Appendixes C and D.) 617 SB
255 255 255 fC
1449 3 634 696 B
1 F
n
0 0 0 fC
1449 2 634 700 B
1 F
n
32 0 0 44 44 0 0 0 42 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 144 58 607 703 CB
634 709 80 (Note) 80 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
751 711 145 (The file ) 145 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
896 711 167 (sonicsft.h) 167 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1063 711 912 ( includes prototypes for functions used in the SONIC) 912 SB
634 761 1105 (driver, grouped by source file. As you modify the sample driver ) 1105 SB
1739 761 40 (.C) 40 SB
1779 761 272 ( files, substitute) 272 SB
634 811 44 (in ) 44 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
678 811 167 (sonicsft.h) 167 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
845 811 1238 ( the functions and associated parameters that are specific to your driver.) 1238 SB
255 255 255 fC
1449 3 634 881 B
1 F
n
0 0 0 fC
1449 2 634 878 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 959 990 (3.4  Modification of sonichrd.h) 990 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1073 33 (1.) 33 SB
692 1073 1286 (Locate the defines for the SONIC IC register address offsets from the base) 1286 SB
692 1123 1378 (address of the netcard. Substitute the register names and offsets that are specific) 1378 SB
692 1173 271 (to your netcard.) 271 SB
634 1240 33 (2.) 33 SB
692 1240 1377 (Locate the defines for constant values that the driver can write to the SONIC IC) 1377 SB
692 1290 1389 (registers. Substitute names and values particular to the registers on your netcard.) 1389 SB
634 1357 33 (3.) 33 SB
692 1357 891 (Modify, add, or delete other constants as necessary.) 891 SB
634 1424 33 (4.) 33 SB
692 1424 1333 (If you can use the global structures associated with receive and transmit data,) 1333 SB
692 1474 1008 (modify them as needed. Otherwise, delete or replace them.) 1008 SB
634 1541 33 (5.) 33 SB
692 1541 1373 (The code defining global structures associated with SONIC IC CAM is specific) 1373 SB
692 1591 1317 (to the SONIC IC and may not apply to your netcard. If it does not, delete the) 1317 SB
692 1641 308 (related structures.) 308 SB
634 1708 33 (6.) 33 SB
692 1708 1388 (The structures that are defined to match SONIC netcard transmit descriptors and) 1388 SB
692 1758 1384 (receive descriptors are SONIC-specific. When modifying them for your netcard,) 1384 SB
692 1808 798 (ensure that structure element sizes are correct.) 798 SB
634 1875 33 (7.) 33 SB
692 1875 1383 (You can use some of the macros defined for reading to and writing from SONIC) 1383 SB
692 1925 1320 (IC registers, but most are netcard-specific and need modification or deletion.) 1320 SB
692 1975 533 (Add any macros that you need.) 533 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 2112 964 (3.5  Modification of sonicsft.h) 964 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 2226 959 (This section discusses the recommended changes to the ) 959 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1593 2226 150 (sonicft.h) 150 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1743 2226 79 ( file.) 79 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 2334 444 (3.5.1  Constants) 444 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
634 2430 183 (Sonicsft.h ) 183 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
817 2430 1231 (defines constants for major and minor versions of the SONIC driver for) 1231 SB
634 2480 1447 (later placement in the characteristics array used to register the driver with the NDIS) 1447 SB
634 2530 1334 (interface library. The SONIC_INDICATE_MAXIMUM constant defines the) 1334 SB
634 2580 1310 (maximum number of bytes for receive data indications. The file also defines) 1310 SB
634 2630 1240 (constants the driver uses for parsing OIDs that point to data in the MIB.) 1240 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 8 def
/wp$fpage (8) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 9 9
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1440 378 133 (Chapter ) 133 SB
1573 378 18 (3) 18 SB
1591 378 411 (    Writing a Netcard Driver) 411 SB
2002 378 9 ( ) 61 SB
2063 378 9 ( ) 61 SB
2124 378 18 (3) 18 SB
2142 378 11 (-) 11 SB
2153 378 18 (9) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
721 493 624 (Recommended Changes:) 624 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 569 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 575 1330 (Change the names of the constants for the major and minor driver versions as) 1330 SB
779 625 1277 (appropriate for your netcard, and initialize the values to 0. For each minor) 1277 SB
779 675 1285 (release of the driver, increment the minor version constant. For each major) 1285 SB
779 725 1376 (release, increment the major version constant and set the minor version constant) 1376 SB
779 775 77 (to 0.) 77 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 836 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 842 1326 (The SONIC driver is specific to Ethernet \(802.3\) media. If this is compatible) 1326 SB
779 892 1367 (with your netcard, no modifications to the media mandatory and media optional) 1367 SB
779 942 1251 (arrays are necessary. Consult Appendix B for OIDs appropriate for your) 1251 SB
779 992 299 (network medium.) 299 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1101 364 (3.5.2  Macros) 364 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1197 26 (T) 26 SB
747 1197 40 (he) 40 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
787 1197 11 ( ) 11 SB
798 1197 167 (sonicsft.h) 167 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
965 1197 1038 ( file defines a number of macros. The main ones are used to:) 1038 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1274 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1280 1333 (Redirect contiguous/noncontiguous and cached/noncached memory allocation) 1333 SB
779 1330 1350 (and deallocation function calls to appropriate NDIS interface library functions) 1350 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1391 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1397 1315 (Redirect function calls for moving and clearing memory to the Windows NT) 1315 SB
779 1447 260 (runtime library) 260 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1508 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1514 1335 (Conditionally invoke deferred processing for resetting the netcard, processing) 1335 SB
779 1564 1388 (the logical adapter loopback queue, closing bindings, deregistering netcards, and) 1388 SB
779 1614 373 (unloading the driver \() 373 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1152 1613 490 (SONIC_DO_DEFERRED) 490 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1642 1614 444 (, epilog macro used by all) 444 SB
779 1664 628 (netcard driver upper-edge functions\)) 628 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 1778 624 (Recommended Changes:) 624 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1860 935 (If you do not need the counter associated with macros ) 935 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1656 1859 442 (SonicZeroLargeInteger) 442 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2098 1860 73 ( and) 73 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1909 593 (SonicAddUlongToLargeInteger) 593 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1314 1910 415 (, delete associated code.) 415 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 2018 469 (3.5.3  Data Types) 469 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2114 66 (The) 66 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
787 2114 189 ( sonicsft.h ) 189 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
976 2114 1093 (file defines several kinds of data types, including structures and) 1093 SB
721 2164 659 (enumerations. Structure types include:) 659 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2241 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2247 1174 (LIST_ENTRY defines list entries the Windows NT replacement list) 1174 SB
779 2297 439 (manipulation macros use.) 439 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2358 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2364 1077 (SONIC_LARGE_INTEGER implements a 64-bit counter that) 1077 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 2413 442 (SonicZeroLargeInteger) 442 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1221 2414 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1305 2413 593 (SonicAddUlongToLargeInteger) 593 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1898 2414 79 ( use.) 79 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 9 def
/wp$fpage (9) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 10 10
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 36 (10) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 40 40 0 0 0 46 /MSIcons2 font
0 0 0 fC
gs 653 3231 0 0 CB
634 490 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 496 1391 (SONIC_PACKET_RESERVED defines the netcard driver-reserved portion of a) 1391 SB
692 546 1323 (packet header used for allocation of buffer memory prior to being sent on the) 1323 SB
692 596 151 (network.) 151 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 657 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 663 1353 (SONIC_REQUEST_ RESERVED defines the netcard driver-reserved field of) 1353 SB
692 713 407 (an NDIS request block.) 407 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 774 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 780 1317 (SONIC_DESCRIPTOR_TO_PACKET maps ring descriptor entries back to) 1317 SB
692 830 339 (originating packets.) 339 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 891 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 897 1302 (SONIC_BUFFER_DESCRIPTOR contains descriptors for netcard buffers.) 1302 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 958 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 964 1305 (SONIC_ADAPTER contains information about the netcard logical adapter.) 1305 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1025 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1031 956 (SONIC_OPEN contains information about the binding.) 956 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
634 1131 172 (Sonicsft.h) 172 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
806 1131 1219 ( defines the SONIC_PROC_ID enumeration, which lists functions that) 1219 SB
634 1181 979 (report errors. The driver uses this enumeration in calls to) 979 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1230 489 (NdisWriteErrorLogEntry) 489 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1123 1231 11 (.) 11 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 1328 624 (Recommended Changes:) 624 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1410 1346 (For the SONIC_ADAPTER structure, most of the sample code is usable as is.) 1346 SB
634 1460 1254 (However, it does contain some netcard-specific information. Change this) 1254 SB
634 1510 1083 (information and other structures as appropriate for your driver.) 1083 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1630 983 (3.6  Modification of sonicdet.h) 983 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1744 1378 (Use a header file that defines the hardware values for your netcard or optionally) 1378 SB
634 1794 411 (hard-code the values in ) 411 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1045 1794 180 (sonicdet.h) 180 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1225 1794 11 (.) 11 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 10 def
/wp$fpage (10) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 11 11
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1422 378 133 (Chapter ) 133 SB
1555 378 18 (3) 18 SB
1573 378 411 (    Writing a Netcard Driver) 411 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 18 (3) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (11) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 491 876 (3.7  Modification of sonic.c) 876 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 605 697 (This section describes modifications for ) 697 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1418 605 124 (sonic.c) 124 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1542 605 542 (. The file contains the functions) 542 SB
721 655 324 (listed in Table 3.2.) 324 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 743 198 (Table 3.2    ) 198 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
919 742 115 (sonic.c) 115 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
1034 743 175 ( Functions) 175 SB
1461 2 715 801 B
1 F
n
gs 568 63 721 808 CB
721 813 149 (Function) 149 SB
gr
gs 880 63 1290 808 CB
1340 813 168 (Definition) 168 SB
gr
1448 2 721 871 B
1 F
n
gs 568 63 721 878 CB
721 883 212 (DriverEntry) 212 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1290 878 CB
1340 883 716 (Serves as the main entry point used for initial) 716 SB
gr
gs 880 46 1290 928 CB
1340 929 677 (loading of the netcard driver. This function) 677 SB
gr
gs 880 46 1290 974 CB
1340 975 752 (initializes the wrapper and registers the SONIC) 752 SB
gr
gs 880 59 1290 1020 CB
1340 1021 103 (driver.) 103 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 721 1079 CB
721 1084 252 (SetupForReset) 252 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1290 1079 CB
1340 1084 798 (Prepares a netcard and its logical adapter for reset.) 798 SB
gr
gs 880 46 1290 1129 CB
1340 1130 697 (Preparation includes halting the netcard and) 697 SB
gr
gs 880 59 1290 1175 CB
1340 1176 420 (resolving queued requests.) 420 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 721 1234 CB
721 1239 388 (SetupRegistersAndInit) 388 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1290 1234 CB
1340 1239 622 (Programs netcard registers and invokes) 622 SB
gr
gs 880 46 1290 1284 CB
1340 1285 791 (initialization. This function leaves the netcard in a) 791 SB
gr
gs 880 46 1290 1330 CB
1340 1331 813 (condition to be started following a load-CAM-done) 813 SB
gr
gs 880 59 1290 1376 CB
1340 1377 146 (interrupt.) 146 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 721 1435 CB
721 1440 306 (SonicAddAdapter) 306 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1290 1435 CB
1340 1440 730 (Adds a netcard to the group the SONIC driver) 730 SB
gr
gs 880 46 1290 1485 CB
1340 1486 716 (controls and registers the card with the NDIS) 716 SB
gr
gs 880 59 1290 1531 CB
1340 1532 260 (interface library.) 260 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 721 1590 CB
721 1595 326 (SonicCloseAdapter) 326 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1290 1590 CB
1340 1595 785 (Closes a binding between a transport driver and a) 785 SB
gr
gs 880 46 1290 1640 CB
1340 1641 702 (netcard. This function queues the request for) 702 SB
gr
gs 880 59 1290 1686 CB
1340 1687 784 (postprocessing and returns a pending status code.) 784 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 721 1745 CB
721 1750 470 (SonicHardwareGetAddress) 470 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1290 1745 CB
1340 1750 748 (Retrieves the network address from the SONIC) 748 SB
gr
gs 880 46 1290 1795 CB
1340 1796 760 (NVRAM and stores it in the logical adapter. As) 760 SB
gr
gs 880 46 1290 1841 CB
1340 1842 771 (part of its processing, this function creates a new) 771 SB
gr
gs 880 46 1290 1887 CB
1340 1888 815 (mapping for the SONIC register ports in the logical) 815 SB
gr
gs 880 59 1290 1933 CB
1340 1934 127 (adapter.) 127 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 721 1992 CB
721 1997 447 (SonicHardwareGetDetails) 447 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1290 1992 CB
1340 1997 648 (Retrieves netcard Configuration Registry) 648 SB
gr
gs 880 59 1290 2042 CB
1340 2043 195 (information.) 195 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 721 2101 CB
721 2106 553 (SonicHardwareSaveInformation) 553 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1290 2101 CB
1340 2106 728 (Accepts registry information in response to an) 728 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 880 59 1290 2151 CB
1340 2152 419 (RtlQueryRegistryValues) 419 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 59 1290 2151 CB
1759 2152 77 ( call.) 77 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 11 def
/wp$fpage (11) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 12 12
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 36 (12) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
0 0 0 fC
634 497 181 (Table 3.2 \() 181 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
815 496 164 (continued) 164 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
979 497 43 (\)   ) 43 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
1022 496 125 ( sonic.c) 125 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
1147 497 175 ( Functions) 175 SB
1448 2 634 555 B
1 F
n
gs 568 63 634 562 CB
634 567 149 (Function) 149 SB
gr
gs 880 63 1203 562 CB
1253 567 168 (Definition) 168 SB
gr
1448 2 634 625 B
1 F
n
gs 568 63 634 632 CB
634 637 556 (SonicHardwareVerifyChecksum) 556 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1203 632 CB
1253 637 764 (Verifies checksum field of the SONIC NVRAM) 764 SB
gr
gs 880 46 1203 682 CB
1253 683 732 (against the network address retrieved from the) 732 SB
gr
gs 880 59 1203 728 CB
1253 729 160 (NVRAM.) 160 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 787 CB
634 792 255 (SonicInitialInit) 255 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 63 1203 787 CB
1253 792 672 (Initializes a netcard following registration.) 672 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 850 CB
634 855 325 (SonicOpenAdapter) 325 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1203 850 CB
1253 855 798 (Creates a binding between a transport driver and a) 798 SB
gr
gs 880 46 1203 900 CB
1253 901 702 (netcard. This function queues the request for) 702 SB
gr
gs 880 59 1203 946 CB
1253 947 784 (postprocessing and returns a pending status code.) 784 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 1005 CB
634 1010 376 (SonicRegisterAdapter) 376 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1203 1005 CB
1253 1010 804 (Registers a netcard with the NDIS interface library) 804 SB
gr
gs 880 46 1203 1055 CB
1253 1056 769 (and allocates memory for the logical adapter, the) 769 SB
gr
gs 880 46 1203 1101 CB
1253 1102 714 (netcard buffers, and the Ethernet filter library) 714 SB
gr
gs 880 59 1203 1147 CB
1253 1148 148 (database.) 148 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 1206 CB
634 1211 371 (SonicRemoveAdapter) 371 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 63 1203 1206 CB
1253 1211 461 (Revokes netcard registration.) 461 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 1269 CB
634 1274 185 (SonicReset) 185 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 63 1203 1269 CB
1253 1274 801 (Resets a netcard and its associated logical adapter.) 801 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 1332 CB
634 1337 379 (SonicStartCamReload) 379 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1203 1332 CB
1253 1337 738 (Starts a reload of the SONIC IC CAM. The IC) 738 SB
gr
gs 880 59 1203 1382 CB
1253 1383 747 (generates an interrupt when reload is complete.) 747 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 1441 CB
634 1446 260 (SonicStartChip) 260 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 63 1203 1441 CB
1253 1446 583 (Starts the initialized SONIC netcard.) 583 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 1504 CB
634 1509 250 (SonicStopChip) 250 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 63 1203 1504 CB
1253 1509 408 (Halts the SONIC netcard.) 408 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 1567 CB
634 1572 338 (SonicSynchClearIsr) 338 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1203 1567 CB
1253 1572 823 (Clears all bits in the SONIC netcard interrupt status) 823 SB
gr
gs 880 46 1203 1617 CB
1253 1618 814 (register to prevent further interrupts and ensure that) 814 SB
gr
gs 880 46 1203 1663 CB
1253 1664 763 (other functions find no bits set when reading the) 763 SB
gr
gs 880 46 1203 1709 CB
1253 1710 177 (register. A ) 177 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 880 46 1203 1709 CB
1430 1710 252 (SetupForReset) 252 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 46 1203 1709 CB
1682 1710 107 ( call to) 107 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 880 46 1203 1755 CB
1253 1756 528 (NdisSynchronizeWithInterrupt) 528 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 46 1203 1755 CB
1781 1756 200 ( invokes this) 200 SB
gr
gs 880 59 1203 1801 CB
1253 1802 140 (function.) 140 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 1860 CB
634 1865 213 (SonicUnload) 213 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 50 1203 1860 CB
1253 1865 744 (Unloads the SONIC driver at the request of the) 744 SB
gr
gs 880 46 1203 1910 CB
1253 1911 737 (operating system. This function deregisters the) 737 SB
gr
gs 880 59 1203 1956 CB
1253 1957 544 (driver and terminates the wrapper.) 544 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 568 63 634 2015 CB
634 2020 322 (StartAdapterReset) 322 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 880 63 1203 2015 CB
1253 2020 756 (Provides the first phase of netcard initialization.) 756 SB
gr
255 255 255 fC
1449 3 634 2098 B
1 F
n
0 0 0 fC
1449 2 634 2095 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 2171 624 (Recommended Changes:) 624 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 2247 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
692 2252 416 (SonicRegisterAdapter) 416 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1108 2253 973 ( contains many hardware dependencies, especially in the) 973 SB
692 2303 1305 (initialization code for the fields of the logical adapter structure and the code) 1305 SB
692 2353 1338 (allocating storage for associated structures and buffers. Modify these areas of) 1338 SB
692 2403 1378 (the code as necessary for the logical adapter that you construct for your netcard.) 1378 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 2464 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
692 2469 427 (SonicRegisterAdapter ) 427 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1119 2470 840 (uses the Ethernet filter library. If you are using a) 840 SB
692 2520 1366 (different filter library, change library references as necessary. If an appropriate) 1366 SB
692 2570 1328 (filter library is not available as part of the operating system, you may need to) 1328 SB
692 2620 615 (create one specific to your network.) 615 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 12 def
/wp$fpage (12) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Roman
%%Page: 13 13
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1422 378 133 (Chapter ) 133 SB
1555 378 18 (3) 18 SB
1573 378 411 (    Writing a Netcard Driver) 411 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 18 (3) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (13) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 40 40 0 0 0 46 /MSIcons2 font
0 0 0 fC
gs 740 3231 0 0 CB
721 490 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 496 71 (For ) 71 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
850 495 281 (SonicInitialInit) 281 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1131 496 984 ( adjust the initialization timeout period as appropriate for) 984 SB
779 546 1144 (your netcard. If the timeout loop is not needed, simply eliminate it.) 1144 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 607 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 613 139 (Modify ) 139 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
918 612 373 (SonicSynchClearIsr) 373 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1291 613 872 ( as necessary to disable interrupts on your netcard.) 872 SB
779 663 732 (Remove this function if you do not need it.) 732 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 724 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 729 288 (SonicStartChip) 288 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1067 730 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1151 729 277 (SonicStopChip) 277 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1428 730 572 ( are netcard-dependent functions.) 572 SB
779 780 1386 (Carefully modify applicable code to match your netcard. Remove this function if) 1386 SB
779 830 318 (you do not need it.) 318 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 891 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 897 658 (If the netcard contains CAM,  modify ) 658 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1437 896 419 (SonicStartCamReload) 419 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1856 897 248 ( to match your) 248 SB
779 947 1366 (netcard. If the card does not contain CAM, or a similar circuit, you can entirely) 1366 SB
779 997 395 (eliminate this function.) 395 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1058 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1064 71 (For ) 71 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
850 1063 359 (SonicOpenAdapter) 359 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1209 1064 888 ( modify the supported media search loop to look for) 888 SB
779 1114 651 (media types that your driver supports.) 651 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1175 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1181 244 (Add or delete ) 244 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1023 1180 338 (SonicAddAdapter) 338 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1361 1181 758 ( code as necessary to handle the registration) 758 SB
779 1231 874 (keywords and values associated with your netcard.) 874 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1292 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 1297 410 (SonicRemoveAdapter) 410 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1189 1298 851 ( uses the Ethernet filter library. If you are using a) 851 SB
779 1348 1366 (different filter library, change library references as necessary. If an appropriate) 1366 SB
779 1398 1328 (filter library is not available as part of the operating system, you may need to) 1328 SB
779 1448 615 (create one specific to your network.) 615 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1509 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 1514 357 (StartAdapterReset) 357 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1136 1515 980 ( is somewhat netcard-dependent, but you can use most of) 980 SB
779 1565 1261 (the code if you are allocating send resources and if your driver or netcard) 1261 SB
779 1615 1367 (requires management of receive buffers. Replace code as necessary to suit your) 1367 SB
779 1665 749 (netcard capabilities and software approach.) 749 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1726 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 1731 427 (SetupRegistersAndInit) 427 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1206 1732 858 ( is netcard-dependent, but you can use the general) 858 SB
779 1782 1327 (SONIC driver coding approach for your driver. Replace code as necessary to) 1327 SB
779 1832 1190 (program registers and invoke initialization activities on your netcard.) 1190 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1893 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1899 171 (Note that ) 171 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
950 1898 516 (SonicHardwareGetAddress) 516 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1466 1899 22 (, ) 22 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1488 1898 492 (SonicHardwareGetDetails) 492 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1980 1899 11 (,) 11 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 1948 607 (SonicHardwareSaveInformation) 607 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1386 1949 95 (, and ) 95 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1481 1948 607 (SonicHardwareVerifyChecksum) 607 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2088 1949 65 ( are) 65 SB
779 1999 1143 (netcard-dependent. Modify applicable code to match your netcard.) 1143 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 2136 857 (3.8  Modification of send.c) 857 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2250 426 (The macros/functions in ) 426 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1147 2250 112 (send.c) 112 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1259 2250 885 ( determine what the driver needs to do to transmit a) 885 SB
721 2300 1429 (packet, allocate buffers and copy data to them, allocate ring entries for the packets,) 1429 SB
721 2350 1361 (and relinquish the ring entries to the netcard. Many of the functions/macros are) 1361 SB
721 2400 1440 (closely tied to the Ethernet network. Some require extensive modification if you are) 1440 SB
721 2450 1444 (writing a driver for another type of network. These functions are listed in Table 3.3.) 1444 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 13 def
/wp$fpage (13) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 14 14
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 36 (14) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
0 0 0 fC
634 501 188 (Table 3.3   ) 188 SB
822 501 10 ( ) 10 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
832 500 104 (send.c) 104 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
936 501 315 ( Macros/Functions) 315 SB
1461 2 628 559 B
1 F
n
gs 547 63 634 566 CB
634 571 273 (Macro/Function) 273 SB
gr
gs 901 63 1182 566 CB
1232 571 168 (Definition) 168 SB
gr
1448 2 634 629 B
1 F
n
gs 547 63 634 636 CB
634 641 479 (AcquireTransmitDescriptor) 479 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 50 1182 636 CB
1232 641 773 (Retrieves the index of the next available transmit) 773 SB
gr
gs 901 46 1182 686 CB
1232 687 840 (descriptor. If the function locates only one descriptor,) 840 SB
gr
gs 901 46 1182 732 CB
1232 733 797 (it does not take this descriptor to avoid creating an) 797 SB
gr
gs 901 46 1182 778 CB
1232 779 793 (ambiguity in the descriptor ring. Note the ring is a) 793 SB
gr
gs 901 46 1182 824 CB
1232 825 815 (circular list, and there is no way to tell if it is empty) 815 SB
gr
gs 901 46 1182 870 CB
1232 871 818 (or full. If a ring descriptor is available, this function) 818 SB
gr
gs 901 46 1182 916 CB
1232 917 745 (calculates the index by subtracting the transmit) 745 SB
gr
gs 901 46 1182 962 CB
1232 963 816 (descriptor area base address from the address of the) 816 SB
gr
gs 901 59 1182 1008 CB
1232 1009 461 (available transmit descriptor.) 461 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 547 63 634 1067 CB
634 1072 458 (AssignPacketToDescriptor) 458 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 50 1182 1067 CB
1232 1072 830 (Assigns all buffers in a transmit packet to a transmit) 830 SB
gr
gs 901 46 1182 1117 CB
1232 1118 753 (descriptor. This function divides the packet into) 753 SB
gr
gs 901 59 1182 1163 CB
1232 1164 680 (fragments for transmission on the network.) 680 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 547 63 634 1222 CB
634 1227 475 (CalculatePacketConstraints) 475 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 50 1182 1222 CB
1232 1227 738 (Determines buffer size requirements for a send) 738 SB
gr
gs 901 46 1182 1272 CB
1232 1273 791 (packet, based on netcard constraints. The function) 791 SB
gr
gs 901 46 1182 1318 CB
1232 1319 842 (retrieves packet information and places a code for the) 842 SB
gr
gs 901 46 1182 1364 CB
1232 1365 805 (type of buffer needed in the netcard driver-reserved) 805 SB
gr
gs 901 59 1182 1410 CB
1232 1411 335 (portion of the packet.) 335 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 547 63 634 1469 CB
634 1474 285 (ConstrainPacket) 285 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 50 1182 1469 CB
1232 1474 788 (Copies an entire send packet to a SONIC buffer if) 788 SB
gr
gs 901 46 1182 1519 CB
1232 1520 834 (necessary. If the packet is smaller than the minimum) 834 SB
gr
gs 901 46 1182 1565 CB
1232 1566 216 (size allowed, ) 216 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 901 46 1182 1565 CB
1448 1566 295 (ConstrainPacket ) 295 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 46 1182 1565 CB
1743 1566 317 (pads the buffer with) 317 SB
gr
gs 901 59 1182 1611 CB
1232 1612 506 (zeros before copying the packet.) 506 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 547 63 634 1670 CB
634 1675 490 (DeterminePacketAddressing) 490 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 50 1182 1670 CB
1232 1675 757 (Determines the type of send operation \(directed,) 757 SB
gr
gs 901 46 1182 1720 CB
1232 1721 849 (multicast, broadcast, or loopback\) and determines if a) 849 SB
gr
gs 901 59 1182 1766 CB
1232 1767 742 (packet actually needs to go out on the network.) 742 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 547 63 634 1825 CB
634 1830 298 (RelinquishPacket) 298 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 50 1182 1825 CB
1232 1830 780 (Relinquishes packet-owned entries to the SONIC) 780 SB
gr
gs 901 59 1182 1875 CB
1232 1876 629 (netcard ring, then enables transmission.) 629 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 547 63 634 1934 CB
634 1939 174 (SonicSend) 174 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 50 1182 1934 CB
1232 1939 715 (Transmits a packet through the netcard to the) 715 SB
gr
gs 901 59 1182 1984 CB
1232 1985 139 (network.) 139 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 547 63 634 2043 CB
634 2048 378 (SonicStagedAllocation) 378 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 50 1182 2043 CB
1232 2048 798 (Attempts to move a packet to enable transmission.) 798 SB
gr
gs 901 46 1182 2093 CB
1232 2094 810 (Initializes the netcard driver-reserved portion of the) 810 SB
gr
gs 901 59 1182 2139 CB
1232 2140 113 (packet.) 113 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 547 63 634 2198 CB
634 2203 371 (START_TRANSMIT) 371 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 901 50 1182 2198 CB
1232 2203 742 (Commands the SONIC IC to start transmitting) 742 SB
gr
gs 901 46 1182 2248 CB
1232 2249 830 (packets as set up in its transmit descriptor area. This) 830 SB
gr
gs 901 59 1182 2294 CB
1232 2295 446 (macro is netcard-dependent.) 446 SB
gr
255 255 255 fC
1449 3 634 2373 B
1 F
n
0 0 0 fC
1449 2 634 2370 B
1 F
n
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 14 def
/wp$fpage (14) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Roman
%%Page: 15 15
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1422 378 133 (Chapter ) 133 SB
1555 378 18 (3) 18 SB
1573 378 411 (    Writing a Netcard Driver) 411 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 18 (3) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (15) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
721 493 624 (Recommended Changes:) 624 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 569 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 574 536 (DeterminePacketAddressing) 536 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1315 575 838 ( is tied to the Ethernet network. You can use this) 838 SB
779 625 1363 (function with minor modification if you are working on this network. If you are) 1363 SB
779 675 1175 (writing a driver for a network other than Ethernet, make appropriate) 1175 SB
779 725 909 (modifications to the packet addressing classification.) 909 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 786 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 791 324 (ConstrainPacket ) 324 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1103 792 1068 (is netcard-dependent. However, the driver handles most of the) 1068 SB
779 842 284 (dependencies in ) 284 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1063 842 187 (sonichrd.h) 187 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1250 842 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1334 842 167 (sonicsft.h) 167 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1501 842 645 (. If your buffer allocation approach is) 645 SB
779 892 1253 (similar to that of the SONIC driver, you can use this function with minor) 1253 SB
779 942 245 (modifications.) 245 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1003 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 1008 523 (CalculatePacketConstraints) 523 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1302 1009 867 ( checks are netcard-dependent. Modify the code to) 867 SB
779 1059 1167 (match your netcard, which may have different checks or none at all.) 1167 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1120 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 1125 503 (AssignPacketToDescriptor) 503 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1282 1126 867 ( is netcard-dependent. Note the sample driver uses) 867 SB
779 1176 1310 (the programmable transmit interrupt feature of the SONIC IC, which allows) 1310 SB
779 1226 1324 (generation of transmit interrupts under software control. If your driver uses a) 1324 SB
779 1276 1205 (similar approach to fragmenting packets for transmission, you can use) 1205 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 1325 503 (AssignPacketToDescriptor) 503 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1282 1326 455 ( with minor modifications.) 455 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1387 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 1392 325 (RelinquishPacket) 325 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1104 1393 851 ( is very netcard-dependent and requires extensive) 851 SB
779 1443 1339 (modification to match the requirements of your netcard. Be sure to modify the) 1339 SB
779 1493 1367 (part of the code turning off the EOL bit and signalling the SONIC IC command) 1367 SB
779 1543 1370 (register to start transmitting. Also adjust the code that updates the pointer to the) 1370 SB
779 1593 791 (first uncommitted SONIC transmit descriptor.) 791 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1654 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1660 208 (The area of ) 208 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
987 1659 527 (AcquireTransmitDescriptor) 527 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1514 1660 574 ( that starts with adjustment of the) 574 SB
779 1710 1365 (transmit descriptor is netcard-dependent. Modify this function for your netcard.) 1365 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1831 951 (3.9  Modification of transfer.c) 951 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
721 1945 193 (Transfer.c ) 193 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
914 1945 688 (contains one main upper-edge function, ) 688 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1602 1944 357 (SonicTransferData) 357 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1959 1945 126 (, which) 126 SB
721 1995 1437 (transfers received data from the netcard driver to a transport driver. Note that, for a) 1437 SB
721 2045 1314 (loopback transfer, the netcard driver copies the entire contents of the current) 1314 SB
721 2095 1440 (loopback packet to a transport driver-specified packet. For a non-loopback transfer,) 1440 SB
721 2145 1244 (the driver copies buffer contents to the transport driver-specified packet.) 1244 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 2242 595 (Recommended Change:) 595 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2324 1389 (The SONIC driver receives packets in a single contiguous area, which simplifies) 1389 SB
721 2374 1440 (the design. You can modify your driver to handle packets that are more fragmented.) 1440 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 15 def
/wp$fpage (15) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 16 16
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 36 (16) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 491 982 (3.10  Modification of request.c) 982 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 605 66 (The) 66 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
700 605 172 ( request.c) 172 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
872 605 1083 ( file defines two arrays and several macros/functions, the latter) 1083 SB
634 655 1321 (defined in Table 3.4. When you check the code, note that one of the arrays is) 1321 SB
634 705 1387 (initialized to contain the MIB OIDs that the driver supports for queries of global) 1387 SB
634 755 1399 (statistics, including general operational characteristics and statistics and Ethernet) 1399 SB
634 805 1310 (media-specific operational characteristics and statistics. The second array is) 1310 SB
634 855 1277 (initialized to contain a subset of the first, and the driver uses it for binding) 1277 SB
634 905 348 (information queries.) 348 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
634 993 198 (Table 3.4    ) 198 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
832 992 149 (request.c) 149 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
981 993 315 ( Macros/Functions) 315 SB
1461 2 628 1051 B
1 F
n
gs 670 63 634 1058 CB
634 1063 273 (Macro/Function) 273 SB
gr
gs 778 63 1305 1058 CB
1355 1063 168 (Definition) 168 SB
gr
1448 2 634 1121 B
1 F
n
gs 670 63 634 1128 CB
634 1133 618 (CAM_DIRECTED_SIGNIFICANT) 618 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1305 1128 CB
1355 1133 700 (Determines if directed addresses need CAM) 700 SB
gr
gs 778 59 1305 1178 CB
1355 1179 605 (filtering \(receiver is not promiscuous\).) 605 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 634 1237 CB
634 1242 649 (CAM_MULTICAST_SIGNIFICANT) 649 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1305 1237 CB
1355 1242 650 (Determines if CAM filtering of multicast) 650 SB
gr
gs 778 46 1305 1287 CB
1355 1288 686 (addresses is necessary. Multicast addresses) 686 SB
gr
gs 778 46 1305 1333 CB
1355 1334 663 (require filtering if the receiver is not set to) 663 SB
gr
gs 778 46 1305 1379 CB
1355 1380 694 (receive all multicast and directed addresses,) 694 SB
gr
gs 778 59 1305 1425 CB
1355 1426 377 (and is not promiscuous.) 377 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 634 1484 CB
634 1489 420 (ChangeAddressDispatch) 420 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1305 1484 CB
1355 1489 91 (Does ) 91 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 778 50 1305 1484 CB
1446 1489 361 (SonicChangeAddress) 361 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1305 1484 CB
1807 1489 120 (-related) 120 SB
gr
gs 778 46 1305 1534 CB
1355 1535 612 (processing related to multicast address) 612 SB
gr
gs 778 46 1305 1580 CB
1355 1581 693 (changes for a binding. This function tests to) 693 SB
gr
gs 778 46 1305 1626 CB
1355 1627 696 (see if the netcard driver must reload SONIC) 696 SB
gr
gs 778 59 1305 1672 CB
1355 1673 670 (CAM, and initiates reloading if necessary.) 670 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 634 1731 CB
634 1736 371 (ChangeClassDispatch) 371 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1305 1731 CB
1355 1736 722 (Performs netcard-specific processing initiated) 722 SB
gr
gs 778 46 1305 1781 CB
1355 1782 48 (by ) 48 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 778 46 1305 1781 CB
1403 1782 312 (SonicChangeClass) 312 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 46 1305 1781 CB
1715 1782 368 ( and related to Ethernet) 368 SB
gr
gs 778 46 1305 1827 CB
1355 1828 712 (filter class changes. This function tests to see) 712 SB
gr
gs 778 46 1305 1873 CB
1355 1874 636 (if the netcard driver must reload SONIC) 636 SB
gr
gs 778 46 1305 1919 CB
1355 1920 670 (CAM, and initiates reloading if necessary.) 670 SB
gr
gs 778 46 1305 1965 CB
1355 1966 689 (This is necessary if a filter class change has) 689 SB
gr
gs 778 46 1305 2011 CB
1355 2012 701 (altered directed address or multicast address) 701 SB
gr
gs 778 59 1305 2057 CB
1355 2058 268 (receive enabling.) 268 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 634 2116 CB
634 2121 361 (SonicChangeAddress) 361 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1305 2116 CB
1355 2121 623 (Changes the multicast address list for a) 623 SB
gr
gs 778 59 1305 2166 CB
1355 2167 132 (binding.) 132 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 634 2225 CB
634 2230 312 (SonicChangeClass) 312 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1305 2225 CB
1355 2230 693 (Performs processing when a particular filter) 693 SB
gr
gs 778 59 1305 2275 CB
1355 2276 512 (class is first used or last cleared.) 512 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 634 2334 CB
634 2339 295 (SonicCloseAction) 295 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1305 2334 CB
1355 2339 685 (Processes a binding close while the netcard) 685 SB
gr
gs 778 46 1305 2384 CB
1355 2385 649 (driver is indicating a received packet to a) 649 SB
gr
gs 778 59 1305 2430 CB
1355 2431 363 (bound transport driver.) 363 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 634 2489 CB
634 2494 467 (SonicProcessRequestQueue) 467 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1305 2489 CB
1355 2494 611 (Processes requests queued on a logical) 611 SB
gr
gs 778 46 1305 2539 CB
1355 2540 706 (adapter. This function processes the requests) 706 SB
gr
gs 778 46 1305 2585 CB
1355 2586 727 (in order until it exhausts the queue, or reaches) 727 SB
gr
gs 778 59 1305 2631 CB
1355 2632 413 (a request that has to pend.) 413 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 16 def
/wp$fpage (16) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 17 17
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1422 378 133 (Chapter ) 133 SB
1555 378 18 (3) 18 SB
1573 378 411 (    Writing a Netcard Driver) 411 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 18 (3) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (17) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
0 0 0 fC
721 497 181 (Table 3.4 \() 181 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
902 496 164 (continued) 164 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
1066 497 53 (\)    ) 53 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
1119 496 149 (request.c) 149 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
1268 497 315 ( Macros/Functions) 315 SB
1448 2 721 555 B
1 F
n
gs 670 63 721 562 CB
721 567 273 (Macro/Function) 273 SB
gr
gs 778 63 1392 562 CB
1442 567 168 (Definition) 168 SB
gr
1448 2 721 625 B
1 F
n
gs 670 63 721 632 CB
721 637 465 (SonicQueryGlobalStatistics) 465 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1392 632 CB
1442 637 686 (Handles operating system requests to query) 686 SB
gr
gs 778 46 1392 682 CB
1442 683 661 (general MIB statistics associated with the) 661 SB
gr
gs 778 59 1392 728 CB
1442 729 126 (netcard.) 126 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 721 787 CB
721 792 404 (SonicQueryInformation) 404 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1392 787 CB
1442 792 685 (Queries MIB information associated with a) 685 SB
gr
gs 778 59 1392 837 CB
1442 838 258 (netcard binding.) 258 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 721 896 CB
721 901 337 (SonicQueueRequest) 337 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1392 896 CB
1442 901 673 (Adds a request to a logical adapter request) 673 SB
gr
gs 778 46 1392 946 CB
1442 947 678 (queue, and invokes queue processing if the) 678 SB
gr
gs 778 59 1392 992 CB
1442 993 359 (queue has been empty.) 359 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 721 1051 CB
721 1056 228 (SonicRequest) 228 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1392 1051 CB
1442 1056 592 (Serves as a netcard driver upper-edge) 592 SB
gr
gs 778 46 1392 1101 CB
1442 1102 711 (function that handles general requests from a) 711 SB
gr
gs 778 46 1392 1147 CB
1442 1148 563 (transport driver to set or query MIB) 563 SB
gr
gs 778 46 1392 1193 CB
1442 1194 593 (information associated with a netcard) 593 SB
gr
gs 778 59 1392 1239 CB
1442 1240 132 (binding.) 132 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 670 63 721 1298 CB
721 1303 350 (SonicSetInformation) 350 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 778 50 1392 1298 CB
1442 1303 628 (Sets MIB information associated with a) 628 SB
gr
gs 778 59 1392 1348 CB
1442 1349 258 (netcard binding.) 258 SB
gr
255 255 255 fC
1449 3 721 1427 B
1 F
n
0 0 0 fC
1449 2 721 1424 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 1500 624 (Recommended Changes:) 624 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1576 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1582 1279 (As appropriate for your media type, modify the media-specific operational) 1279 SB
779 1632 995 (characteristics and statistics OIDs in the global variables.) 995 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1693 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1699 211 (Throughout ) 211 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
990 1698 515 (SonicProcessRequestQueue) 515 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1505 1699 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1589 1698 447 (SonicQueryInformation) 447 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2036 1699 11 (,) 11 SB
779 1749 1294 (change the names of all identifiers that refer to the Ethernet filter library as) 1294 SB
779 1799 1340 (appropriate for the filter library that you are using. If an appropriate library is) 1340 SB
779 1849 1364 (not available as part of the operating system, you may need to create your own.) 1364 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1910 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1916 397 (Modify the sections of ) 397 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1176 1915 447 (SonicQueryInformation) 447 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1623 1916 479 ( that decode Ethernet media) 479 SB
779 1966 1360 (OIDs to reflect your media type. The sections that decode general OIDs should) 1360 SB
779 2016 1363 (require minor modification, since all drivers are required to support the general) 1363 SB
779 2066 1292 (mandatory OIDs. Provide support for the general optional OIDs as needed.) 1292 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2127 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2133 71 (For ) 71 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
850 2132 386 (SonicSetInformation) 386 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1236 2133 792 (, include code to handle OIDs that your driver) 792 SB
779 2183 156 (supports.) 156 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2244 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2250 1388 (If your driver is not written for Ethernet, change the filter library function names) 1388 SB
779 2300 44 (in ) 44 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
823 2299 386 (SonicSetInformation) 386 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1209 2300 892 ( as appropriate for your medium. If system-supplied) 892 SB
779 2350 1281 (filter libraries do not support your medium, prepare your own filter library) 1281 SB
779 2400 169 (functions.) 169 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2461 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2467 344 (Most of the code in ) 344 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1123 2466 407 (ChangeClassDispatch) 407 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1530 2467 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1614 2466 461 (ChangeAddressDispatch) 461 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2517 1368 (needs modification, especially for non-Ethernet drivers and netcards that do not) 1368 SB
779 2567 1376 (contain CAM. Modify the SONIC driver code as needed for your netcard. If the) 1376 SB
779 2617 1374 (netcard does not contain CAM or perform basic address filtering, your software) 1374 SB
779 2667 486 (may need to do these things.) 486 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 17 def
/wp$fpage (17) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Roman
%%Page: 18 18
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 36 (18) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 491 659 (3.11  Modification of) 659 SB
918 491 19 ( ) 19 SB
937 491 274 (packet.c) 274 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 605 390 (This section discusses ) 390 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1024 605 147 (packet.c) 147 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1171 605 847 (, which contains the functions listed in Table 3.5.) 847 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
634 693 188 (Table 3.5   ) 188 SB
822 693 10 ( ) 10 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
832 692 135 (packet.c) 135 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
967 693 10 ( ) 10 SB
977 693 165 (Functions) 165 SB
1461 2 628 751 B
1 F
n
gs 595 63 634 758 CB
634 763 149 (Function) 149 SB
gr
gs 853 63 1230 758 CB
1280 763 168 (Definition) 168 SB
gr
1448 2 634 821 B
1 F
n
gs 595 63 634 828 CB
634 833 551 (SonicCopyFromBufferToPacket) 551 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 853 50 1230 828 CB
1280 833 699 (Copies data from a buffer into an NDIS 3.0-) 699 SB
gr
gs 853 59 1230 878 CB
1280 879 240 (defined packet.) 240 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 595 63 634 937 CB
634 942 551 (SonicCopyFromPacketToBuffer) 551 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 853 50 1230 937 CB
1280 942 797 (Copies data from an NDIS 3.0-defined packet into) 797 SB
gr
gs 853 59 1230 987 CB
1280 988 132 (a buffer.) 132 SB
gr
255 255 255 fC
1449 3 634 1066 B
1 F
n
0 0 0 fC
1449 2 634 1063 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 1139 624 (Recommended Changes:) 624 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1221 796 (No specific changes are recommended for the ) 796 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1430 1221 147 (packet.c) 147 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1577 1221 11 ( ) 11 SB
1588 1221 463 (functions. You can remove) 463 SB
634 1271 848 (these functions if your driver does not need them.) 848 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1391 891 (3.12  Modification of alloc.c) 891 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1505 828 (This section describes modifications for the file ) 828 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1462 1505 119 (alloc.c) 119 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1581 1505 22 (. ) 22 SB
1603 1505 468 (Table 3.6 describes the file) 468 SB
634 1555 169 (functions.) 169 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
634 1643 198 (Table 3.6    ) 198 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
832 1642 118 (alloc.c ) 118 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
950 1643 165 (Functions) 165 SB
1461 2 628 1701 B
1 F
n
gs 459 63 634 1708 CB
634 1713 149 (Function) 149 SB
gr
gs 989 63 1094 1708 CB
1144 1713 168 (Definition) 168 SB
gr
1448 2 634 1771 B
1 F
n
gs 459 63 634 1778 CB
634 1783 427 (AllocateAdapterMemory) 427 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 989 50 1094 1778 CB
1144 1783 846 (Allocates and initializes memory used for receive and) 846 SB
gr
gs 989 59 1094 1828 CB
1144 1829 512 (transmit descriptors and buffers.) 512 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 459 63 634 1887 CB
634 1892 345 (AllocateFlushBuffer) 345 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 989 50 1094 1887 CB
1144 1892 921 (Allocates NDIS 3.0-defined buffer memory used for cache) 921 SB
gr
gs 989 59 1094 1937 CB
1144 1938 140 (flushing.) 140 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 459 63 634 1996 CB
634 2001 395 (DeleteAdapterMemory) 395 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 989 50 1094 1996 CB
1144 2001 874 (Frees memory used for receive and transmit descriptors) 874 SB
gr
gs 989 59 1094 2046 CB
1144 2047 188 (and buffers.) 188 SB
gr
255 255 255 fC
1449 3 634 2125 B
1 F
n
0 0 0 fC
1449 2 634 2122 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 2198 624 (Recommended Changes:) 624 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 2274 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 2280 139 (Modify ) 139 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
831 2279 474 (AllocateAdapterMemory) 474 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1305 2280 729 ( to allocate and initialize the memory your) 729 SB
692 2330 849 (driver needs for buffers, descriptors, and the like.) 849 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 2391 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 2397 1347 (If your logical adapter does not implement CAM descriptor area flush buffers,) 1347 SB
692 2447 377 (delete related code in ) 377 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1069 2446 474 (AllocateAdapterMemory) 474 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1543 2447 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1627 2446 438 (DeleteAdapterMemory) 438 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2065 2447 11 (.) 11 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 2508 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 2514 360 (The areas of code in ) 360 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1052 2513 474 (AllocateAdapterMemory) 474 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1526 2514 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1610 2513 438 (DeleteAdapterMemory) 438 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 2564 1321 (that deal with allocating and deleting logical adapter data buffers, associated) 1321 SB
692 2614 1337 (descriptors, and flush buffers is netcard-dependent. Modify these areas to suit) 1337 SB
692 2664 227 (your netcard.) 227 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 18 def
/wp$fpage (18) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 19 19
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1422 378 133 (Chapter ) 133 SB
1555 378 18 (3) 18 SB
1573 378 411 (    Writing a Netcard Driver) 411 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 18 (3) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (19) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 491 659 (3.13  Modification of) 659 SB
1005 491 19 ( ) 19 SB
1024 491 358 (loopback.c) 358 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 605 686 (This section describes modifications for) 686 SB
1407 605 11 ( ) 11 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1418 605 193 (loopback.c) 193 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1611 605 519 (. Functions in this file manage) 519 SB
721 655 1329 (the loopback queue and the finish transmit queue, and indicate packets on the) 1329 SB
721 705 963 (loopback queue. These functions are listed in Table 3.7.) 963 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 793 168 (Table 3.7 ) 168 SB
889 793 30 (   ) 30 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
919 792 177 (loopback.c) 177 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
1096 793 175 ( Functions) 175 SB
1461 2 715 851 B
1 F
n
gs 629 63 721 858 CB
721 863 149 (Function) 149 SB
gr
gs 819 63 1351 858 CB
1401 863 168 (Definition) 168 SB
gr
1448 2 721 921 B
1 F
n
gs 629 63 721 928 CB
721 933 391 (SonicProcessLoopback) 391 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 819 50 1351 928 CB
1401 933 625 (Indicates reception of one packet on the) 625 SB
gr
gs 819 46 1351 978 CB
1401 979 724 (loopback queue. The netcard driver declares a) 724 SB
gr
gs 819 59 1351 1024 CB
1401 1025 690 (local character array as the loopback buffer.) 690 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 629 63 721 1083 CB
721 1088 526 (SonicPutPacketOnFinishTrans) 526 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 819 50 1351 1083 CB
1401 1088 719 (Places a packet at the end of a logical adapter) 719 SB
gr
gs 819 46 1351 1133 CB
1401 1134 750 (finish transmit queue. By definition, any packet) 750 SB
gr
gs 819 59 1351 1179 CB
1401 1180 671 (this function receives is ready to complete.) 671 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 629 63 721 1238 CB
721 1243 489 (SonicPutPacketOnLoopback) 489 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 819 50 1351 1238 CB
1401 1243 715 (Puts a packet on the logical adapter loopback) 715 SB
gr
gs 819 46 1351 1288 CB
1401 1289 721 (list. The netcard driver must call this function) 721 SB
gr
gs 819 59 1351 1334 CB
1401 1335 737 (before it relinquishes the packet to the netcard.) 737 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 629 63 721 1393 CB
721 1398 612 (SonicRemovePacketFromLoopback) 612 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 819 50 1351 1393 CB
1401 1398 741 (Removes the first packet on the logical adapter) 741 SB
gr
gs 819 59 1351 1443 CB
1401 1444 213 (loopback list.) 213 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 629 63 721 1502 CB
721 1507 605 (SonicRemovePacketOnFinishTrans) 605 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 819 50 1351 1502 CB
1401 1507 674 (Removes a packet from the logical adapter) 674 SB
gr
gs 819 59 1351 1552 CB
1401 1553 345 (finish transmit queue.) 345 SB
gr
255 255 255 fC
1449 3 721 1631 B
1 F
n
0 0 0 fC
1449 2 721 1628 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 1704 624 (Recommended Changes:) 624 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1786 363 (You can use most of ) 363 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1084 1786 193 (loopback.c) 193 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1277 1786 11 ( ) 11 SB
1288 1786 871 (with minor modification. However, if your netcard) 871 SB
721 1836 900 (supports loopback, much of the code is unnecessary.) 900 SB
721 1919 1399 (If you are using a network other than Ethernet, be sure to change the names of all) 1399 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1968 430 (SonicProcessLoopback) 430 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1151 1969 943 ( identifiers that refer to the Ethernet filter library. If an) 943 SB
721 2019 1441 (appropriate library is not available as part of the operating system, you may need to) 1441 SB
721 2069 288 (create your own.) 288 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 19 def
/wp$fpage (19) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 20 20
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 36 (20) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 491 993 (3.14  Modification of interrup.c) 993 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
634 605 15 (I) 15 SB
649 605 163 (nterrup.c) 163 SB
812 605 11 ( ) 11 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
823 605 1072 (is netcard-dependent. However, you can use its basic interrupt) 1072 SB
634 655 1248 (processing approach in your driver. The Interrup.c functions are listed in) 1248 SB
634 705 176 (Table 3.8.) 176 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
634 793 198 (Table 3.8    ) 198 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
832 792 174 (interrup.c ) 174 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
1006 793 165 (Functions) 165 SB
1461 2 628 851 B
1 F
n
gs 545 63 634 858 CB
634 863 149 (Function) 149 SB
gr
gs 903 63 1180 858 CB
1230 863 168 (Definition) 168 SB
gr
1448 2 634 921 B
1 F
n
gs 545 63 634 928 CB
634 933 438 (ProcessReceiveInterrupts) 438 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 50 1180 928 CB
1230 933 832 (Indicates received packets to bound transport drivers) 832 SB
gr
gs 903 59 1180 978 CB
1230 979 647 (and updates associated netcard statistics.) 647 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 545 63 634 1037 CB
634 1042 466 (ProcessTransmitInterrupts) 466 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 50 1180 1037 CB
1230 1042 798 (Completes processing for transmitted packets, and) 798 SB
gr
gs 903 59 1180 1087 CB
1230 1088 579 (updates associated netcard statistics.) 579 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 545 63 634 1146 CB
634 1151 428 (SonicDeferredProcessing) 428 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 50 1180 1146 CB
1230 1151 802 (Serves as the DPR for the SONIC driver. Performs) 802 SB
gr
gs 903 46 1180 1196 CB
1230 1197 841 (processing associated with general, load-CAM-done,) 841 SB
gr
gs 903 46 1180 1242 CB
1230 1243 795 (netcard counter overflow, and packet transmission) 795 SB
gr
gs 903 46 1180 1288 CB
1230 1289 850 (interrupts. The operating system invokes this function) 850 SB
gr
gs 903 46 1180 1334 CB
1230 1335 81 (after ) 81 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 46 1180 1334 CB
1311 1335 386 (SonicInterruptService ) 386 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 46 1180 1334 CB
1697 1335 322 (executes and returns) 322 SB
gr
gs 903 46 1180 1380 CB
1230 1381 704 (TRUE. The operating system queues calls to) 704 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 59 1180 1426 CB
1230 1427 428 (SonicDeferredProcessing) 428 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 59 1180 1426 CB
1658 1427 10 (.) 10 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 545 63 634 1485 CB
634 1490 376 (SonicInterruptService) 376 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 50 1180 1485 CB
1230 1490 791 (Serves as the hardware ISR for the SONIC driver.) 791 SB
gr
gs 903 46 1180 1535 CB
1230 1536 800 (This function retrieves a value from the SONIC IC) 800 SB
gr
gs 903 46 1180 1581 CB
1230 1582 853 (interrupt status register; clears bits that are set \(except) 853 SB
gr
gs 903 46 1180 1627 CB
1230 1628 782 (for the receive-descriptors-exhausted and receive-) 782 SB
gr
gs 903 46 1180 1673 CB
1230 1674 748 (buffers-exhausted bits\); and updates the logical) 748 SB
gr
gs 903 46 1180 1719 CB
1230 1720 836 (adapter bitmap of interrupt conditions. If the receive-) 836 SB
gr
gs 903 46 1180 1765 CB
1230 1766 853 (descriptors-exhausted bit or receive-buffers-exhausted) 853 SB
gr
gs 903 46 1180 1811 CB
1230 1812 791 (bit is set, the function marks the logical adapter to) 791 SB
gr
gs 903 46 1180 1857 CB
1230 1858 708 (attend to the condition and masks out further) 708 SB
gr
gs 903 46 1180 1903 CB
1230 1904 791 (interrupts of the indicated type. The netcard driver) 791 SB
gr
gs 903 46 1180 1949 CB
1230 1950 822 (clears these bits in the interrupt status register when) 822 SB
gr
gs 903 59 1180 1995 CB
1230 1996 532 (more resources become available.) 532 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 545 63 634 2054 CB
634 2059 329 (SonicTimerProcess) 329 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 50 1180 2054 CB
1230 2059 727 (Performs timer-deferred processing, including) 727 SB
gr
gs 903 46 1180 2104 CB
1230 2105 777 (resetting the netcard, loopback queue processing,) 777 SB
gr
gs 903 46 1180 2150 CB
1230 2151 834 (closing netcard bindings, deregistering netcards, and) 834 SB
gr
gs 903 46 1180 2196 CB
1230 2197 508 (unloading the driver. The macro) 508 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 46 1180 2242 CB
1230 2243 459 (SONIC_DO_DEFERRED,) 459 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 46 1180 2242 CB
1689 2243 295 ( defined in Section) 295 SB
gr
gs 903 59 1180 2288 CB
1230 2289 321 (3.5.2, sets the timer.) 321 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 545 63 634 2347 CB
634 2352 304 (SonicSynchGetIsr) 304 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 50 1180 2347 CB
1230 2352 772 (Checks the logical adapter to determine interrupt) 772 SB
gr
gs 903 46 1180 2397 CB
1230 2398 835 (conditions that need processing. It then conditionally) 835 SB
gr
gs 903 46 1180 2443 CB
1230 2444 776 (sets them up for processing based on an interrupt) 776 SB
gr
gs 903 46 1180 2489 CB
1230 2490 825 (mask value, and removes reference to them from the) 825 SB
gr
gs 903 46 1180 2535 CB
1230 2536 293 (logical adapter. A ) 293 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 46 1180 2535 CB
1523 2536 428 (SonicDeferredProcessing) 428 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 46 1180 2535 CB
1951 2536 107 ( call to) 107 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 46 1180 2581 CB
1230 2582 528 (NdisSynchronizeWithInterrupt) 528 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 46 1180 2581 CB
1758 2582 200 ( invokes this) 200 SB
gr
gs 903 59 1180 2627 CB
1230 2628 140 (function.) 140 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 20 def
/wp$fpage (20) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 21 21
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1422 378 133 (Chapter ) 133 SB
1555 378 18 (3) 18 SB
1573 378 411 (    Writing a Netcard Driver) 411 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 18 (3) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (21) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
0 0 0 fC
721 497 198 (Table 3.8    ) 198 SB
32 0 0 40 40 0 0 0 37 /Times-BoldItalic /font30 ANSIFont font
919 496 174 (interrup.c ) 174 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
1093 497 165 (Functions) 165 SB
1448 2 721 555 B
1 F
n
gs 545 63 721 562 CB
721 567 149 (Function) 149 SB
gr
gs 903 63 1267 562 CB
1317 567 168 (Definition) 168 SB
gr
1448 2 721 625 B
1 F
n
gs 545 63 721 632 CB
721 637 387 (SonicSynchRemoveEol) 387 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 50 1267 632 CB
1317 637 742 (Resets the EOL bit in the link field of a receive) 742 SB
gr
gs 903 46 1267 682 CB
1317 683 770 (descriptor and performs processing related to the) 770 SB
gr
gs 903 46 1267 728 CB
1317 729 819 (receive-descriptors-exhausted interrupt if necessary.) 819 SB
gr
gs 903 46 1267 774 CB
1317 775 479 (This function is invoked when) 479 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 46 1267 820 CB
1317 821 438 (ProcessReceiveInterrupts) 438 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 46 1267 820 CB
1755 821 83 ( calls) 83 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 46 1267 866 CB
1317 867 538 (NdisSynchronizeWithInterrupt ) 538 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 46 1267 866 CB
1855 867 266 (after clearing the) 266 SB
gr
gs 903 59 1267 912 CB
1317 913 468 (receive-descriptors-exhausted) 468 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 59 1267 912 CB
1785 913 10 ( ) 10 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 59 1267 912 CB
1795 913 52 (bit.) 52 SB
gr
gs 545 63 721 971 CB
721 976 10 ( ) 10 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 545 63 721 971 CB
731 976 372 (SonicSynchWriteRwp) 372 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 50 1267 971 CB
1317 976 786 (Writes the lower 16 bits of the address of the next) 786 SB
gr
gs 903 46 1267 1021 CB
1317 1022 782 (available receive buffer into the SONIC resource-) 782 SB
gr
gs 903 46 1267 1067 CB
1317 1068 792 (write-pointer register. This function then performs) 792 SB
gr
gs 903 46 1267 1113 CB
1317 1114 799 (processing related to the receive-buffers-exhausted) 799 SB
gr
gs 903 46 1267 1159 CB
1317 1160 830 (interrupt if necessary. This function is invoked when) 830 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 46 1267 1205 CB
1317 1206 438 (ProcessReceiveInterrupts) 438 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 46 1267 1205 CB
1755 1206 83 ( calls) 83 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 46 1267 1251 CB
1317 1252 528 (NdisSynchronizeWithInterrupt) 528 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 46 1267 1251 CB
1845 1252 276 ( after clearing the) 276 SB
gr
gs 903 59 1267 1297 CB
1317 1298 457 (receive-buffers-exhausted bit) 457 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 903 59 1267 1297 CB
1774 1298 10 (.) 10 SB
gr
gs 545 63 721 1356 CB
721 1361 221 (WakeUpDpc) 221 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 903 50 1267 1356 CB
1317 1361 845 (Serves as a wakeup function that runs once every five) 845 SB
gr
gs 903 46 1267 1406 CB
1317 1407 718 (seconds. If the DPR finds an operation that is) 718 SB
gr
gs 903 46 1267 1452 CB
1317 1453 789 (pending, it sets a flag in the netcard structure. If it) 789 SB
gr
gs 903 46 1267 1498 CB
1317 1499 844 (finds the flag set the next time it runs, it assumes that) 844 SB
gr
gs 903 46 1267 1544 CB
1317 1545 744 (the netcard is not responding and completes all) 744 SB
gr
gs 903 59 1267 1590 CB
1317 1591 370 (outstanding operations.) 370 SB
gr
255 255 255 fC
1449 3 721 1669 B
1 F
n
0 0 0 fC
1449 2 721 1666 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 1742 624 (Recommended Changes:) 624 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1818 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1824 1289 (As required for your netcard, modify the parts of the code concerning DPR) 1289 SB
779 1874 287 (context creation.) 287 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1935 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1941 1326 (Although the number and nature of interrupts are netcard-dependent, you can) 1326 SB
779 1991 484 (use the general approach of ) 484 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1263 1990 336 (SonicSynchGetIsr) 336 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1599 1991 430 ( if your driver records its) 430 SB
779 2041 1347 (interrupts in a bitmask and acknowledges interrupts by writing individual bits.) 1347 SB
779 2091 1380 (The size of the bitmask required may be different for your netcard. If so, modify) 1380 SB
779 2141 367 (the code accordingly.) 367 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2202 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 2207 428 (SonicSynchRemoveEol) 428 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1207 2208 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1291 2207 410 (SonicSynchWriteRwp) 410 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1701 2208 403 ( are netcard-dependent.) 403 SB
779 2258 1371 (However, they may be of help in writing functions that handle specific interrupt) 1371 SB
779 2308 1268 (conditions. Modify the code to perform desired DPR interrupt processing.) 1268 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2369 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 2374 416 (SonicInterruptService) 416 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1195 2375 931 ( is netcard-specific. However, you can use the general) 931 SB
779 2425 1332 (approach in your driver if your interrupt handling approach is similar. Add or) 1332 SB
779 2475 504 (change variables as required.) 504 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2536 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2542 71 (For ) 71 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
850 2541 416 (SonicInterruptService) 416 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1266 2542 842 (, you may need to modify the code that reads and) 842 SB
779 2592 1381 (tests the interrupt status register on the SONIC IC to match the polarity and size) 1381 SB
779 2642 799 (of the interrupt status register on your netcard.) 799 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 21 def
/wp$fpage (21) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Roman
%%Page: 22 22
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (3) 18 SB
277 378 11 (-) 11 SB
288 378 36 (22) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 621 (Part II    NDIS 3.0 Network Driver Design) 621 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
255 255 255 fC
1390 3 693 513 B
1 F
n
0 0 0 fC
1390 2 693 517 B
1 F
n
32 0 0 44 44 0 0 0 42 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 192 58 607 520 CB
692 526 80 (Note) 80 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
799 528 327 (For Windows NT, ) 327 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1126 527 470 (SonicDeferredProcessing) 470 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1596 528 285 ( does not use the) 285 SB
692 578 477 (SystemSpecific parameters.) 477 SB
255 255 255 fC
1390 3 693 648 B
1 F
n
0 0 0 fC
1390 2 693 645 B
1 F
n
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 675 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
692 680 481 (SonicDeferredProcessing ) 481 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1173 681 73 (and ) 73 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1246 680 482 (ProcessReceiveInterrupts) 482 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1728 681 218 ( are netcard-) 218 SB
692 731 376 (dependent. However, ) 376 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1068 731 187 (sonichrd.h) 187 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1255 731 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1339 731 167 (sonicsft.h) 167 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1506 731 578 ( handle most of the dependencies.) 578 SB
692 781 1356 (If your approach to interrupt handling and buffer allocation is similar to that of) 1356 SB
692 831 1388 (the SONIC driver, you can use both of these functions with minor modifications.) 1388 SB
692 881 1207 (Some areas related more closely to the netcard require major changes,) 1207 SB
692 931 426 (replacement, or deletion.) 426 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 992 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 998 850 (Modify for your network media type the areas of ) 850 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1542 997 470 (SonicDeferredProcessing) 470 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1048 73 (and ) 73 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
765 1047 482 (ProcessReceiveInterrupts) 482 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1247 1048 690 ( that update MIB statistics in the logical) 690 SB
692 1098 139 (adapter.) 139 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1159 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1165 211 (Throughout ) 211 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
903 1164 482 (ProcessReceiveInterrupts) 482 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1385 1165 688 (, change the names of all identifiers that) 688 SB
692 1215 1387 (refer to the Ethernet filter library as appropriate for the filter library that you are) 1387 SB
692 1265 851 (using. Create your own filter library if necessary.) 851 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1326 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
692 1331 521 (ProcessTransmitInterrupts ) 521 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1213 1332 558 (is netcard-dependent. However, ) 558 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1771 1332 187 (sonichrd.h) 187 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1958 1332 73 ( and) 73 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
692 1382 167 (sonicsft.h) 167 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
859 1382 11 ( ) 11 SB
870 1382 1136 (handle most dependencies. If your approach to buffer allocation is) 1136 SB
692 1432 1253 (similar to that of the SONIC driver, you can use this function with minor) 1253 SB
692 1482 245 (modifications.) 245 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1543 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1549 962 (As appropriate for your network media type, modfiy the) 962 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
692 1598 510 (ProcessTransmitInterrupts) 510 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1202 1599 835 ( areas that update MIB logical adapter statistics.) 835 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 22 def
/wp$fpage (22) def
/wp$date (07/18/93) def
/wp$time (04:36 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Trailer
SVDoc restore
end
%%Pages: 22
% TrueType font name key:
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT31c1c5 = 1defDTimes New RomanF00000015000001900000
%    MSTT31c1e2 = 1defDTimes New RomanF00000000000001900000
%    MSTT31c1ef = 1defDTimes New RomanF00000026000001900000
%    MSTT31c1fc = 1defDArial NarrowF00000064000002bc0000
%    MSTT31c208 = 1defDArial NarrowF00000032000002bc0000
%    MSTT31c214 = 1defDTimes New RomanF00000019000001900000
%    MSTT31c221 = 1defDTimes New RomanF00000023000001900000
%    MSTT31c22e = 1defDTimes New RomanF0000001d000001900000
%    MSTT31c23b = 1defDArial NarrowF00000028000002bc0000
%    MSTT31c247 = 1defDArial NarrowF0000003f000002bc0000
%    MSTT31c1d2 = 1defDTimes New RomanF00000032000001900000
%    MSTT31c253 = 1defDTimes New RomanF0000002c000001900000
%    MSTT31c260 = 1defDTimes New RomanF0000002c000001900001
%    MSTT31c26d = 1defDArial NarrowF00000053000002bc0000
%    MSTT31c287 = 1defDArialF00000032000001900000
%    MSTT31c292 = 1defDArial NarrowF00000047000002bc0000
%    MSTT31c29e = 1defDTimes New RomanF0000002c000002bc0000
%    MSTT31c2ab = 1defDArial NarrowF0000002c000002bc0000
%    MSTT31c2b7 = 1defDTimes New RomanF00000028000002bc0000
%    MSTT31c2c4 = 1defDTimes New RomanF00000011000001900000
%    MSTT31c2d1 = 1defDTimes New RomanF00000028000001900001
%    MSTT31c2de = 1defDTimes New RomanF00000028000001900000
%    MSTT31c2eb = 1defDTimes New RomanF00000028000002bc0001
%    MSTT31c2f8 = 1defDTimes New RomanF00000021000001900000
%    MSTT31c305 = 1defDArial NarrowF00000053000002bc0001
%    MSTT31c311 = 1defDMSIconsF00000028000001900000
%    MSTT31c31c = 1defDTimes New RomanF00000011000002bc0000
%%DocumentSuppliedResources: procset Win35Dict 3 1

%%DocumentNeededResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-BoldItalic
%%+ font Times-Italic
%%+ font Times-Roman

%%EOF
