%!PS-Adobe-3.0
%%Creator: Windows PSCRIPT
%%Title: Microsoft Word - 302TDTOP.DOC
%%BoundingBox: 14 9 597 784
%%DocumentNeededResources: (atend)
%%DocumentSuppliedResources: (atend)
%%Pages: (atend)
%%BeginResource: procset Win35Dict 3 1
/Win35Dict 290 dict def Win35Dict begin/bd{bind def}bind def/in{72
mul}bd/ed{exch def}bd/ld{load def}bd/tr/translate ld/gs/gsave ld/gr
/grestore ld/M/moveto ld/L/lineto ld/rmt/rmoveto ld/rlt/rlineto ld
/rct/rcurveto ld/st/stroke ld/n/newpath ld/sm/setmatrix ld/cm/currentmatrix
ld/cp/closepath ld/ARC/arcn ld/TR{65536 div}bd/lj/setlinejoin ld/lc
/setlinecap ld/ml/setmiterlimit ld/sl/setlinewidth ld/scignore false
def/sc{scignore{pop pop pop}{0 index 2 index eq 2 index 4 index eq
and{pop pop 255 div setgray}{3{255 div 3 1 roll}repeat setrgbcolor}ifelse}ifelse}bd
/FC{bR bG bB sc}bd/fC{/bB ed/bG ed/bR ed}bd/HC{hR hG hB sc}bd/hC{
/hB ed/hG ed/hR ed}bd/PC{pR pG pB sc}bd/pC{/pB ed/pG ed/pR ed}bd/sM
matrix def/PenW 1 def/iPen 5 def/mxF matrix def/mxE matrix def/mxUE
matrix def/mxUF matrix def/fBE false def/iDevRes 72 0 matrix defaultmatrix
dtransform dup mul exch dup mul add sqrt def/fPP false def/SS{fPP{
/SV save def}{gs}ifelse}bd/RS{fPP{SV restore}{gr}ifelse}bd/EJ{gsave
showpage grestore}bd/#C{userdict begin/#copies ed end}bd/FEbuf 2 string
def/FEglyph(G  )def/FE{1 exch{dup 16 FEbuf cvrs FEglyph exch 1 exch
putinterval 1 index exch FEglyph cvn put}for}bd/SM{/iRes ed/cyP ed
/cxPg ed/cyM ed/cxM ed 72 100 div dup scale dup 0 ne{90 eq{cyM exch
0 eq{cxM exch tr -90 rotate -1 1 scale}{cxM cxPg add exch tr +90 rotate}ifelse}{cyP
cyM sub exch 0 ne{cxM exch tr -90 rotate}{cxM cxPg add exch tr -90
rotate 1 -1 scale}ifelse}ifelse}{pop cyP cyM sub exch 0 ne{cxM cxPg
add exch tr 180 rotate}{cxM exch tr 1 -1 scale}ifelse}ifelse 100 iRes
div dup scale 0 0 transform .25 add round .25 sub exch .25 add round
.25 sub exch itransform translate}bd/SJ{1 index 0 eq{pop pop/fBE false
def}{1 index/Break ed div/dxBreak ed/fBE true def}ifelse}bd/ANSIVec[
16#0/grave 16#1/acute 16#2/circumflex 16#3/tilde 16#4/macron 16#5/breve
16#6/dotaccent 16#7/dieresis 16#8/ring 16#9/cedilla 16#A/hungarumlaut
16#B/ogonek 16#C/caron 16#D/dotlessi 16#27/quotesingle 16#60/grave
16#7C/bar 16#82/quotesinglbase 16#83/florin 16#84/quotedblbase 16#85
/ellipsis 16#86/dagger 16#87/daggerdbl 16#88/circumflex 16#89/perthousand
16#8A/Scaron 16#8B/guilsinglleft 16#8C/OE 16#91/quoteleft 16#92/quoteright
16#93/quotedblleft 16#94/quotedblright 16#95/bullet 16#96/endash 16#97
/emdash 16#98/tilde 16#99/trademark 16#9A/scaron 16#9B/guilsinglright
16#9C/oe 16#9F/Ydieresis 16#A0/space 16#A1/exclamdown 16#A4/currency
16#A5/yen 16#A6/brokenbar 16#A7/section 16#A8/dieresis 16#A9/copyright
16#AA/ordfeminine 16#AB/guillemotleft 16#AC/logicalnot 16#AD/hyphen
16#AE/registered 16#AF/macron 16#B0/degree 16#B1/plusminus 16#B2/twosuperior
16#B3/threesuperior 16#B4/acute 16#B5/mu 16#B6/paragraph 16#B7/periodcentered
16#B8/cedilla 16#B9/onesuperior 16#BA/ordmasculine 16#BB/guillemotright
16#BC/onequarter 16#BD/onehalf 16#BE/threequarters 16#BF/questiondown
16#C0/Agrave 16#C1/Aacute 16#C2/Acircumflex 16#C3/Atilde 16#C4/Adieresis
16#C5/Aring 16#C6/AE 16#C7/Ccedilla 16#C8/Egrave 16#C9/Eacute 16#CA
/Ecircumflex 16#CB/Edieresis 16#CC/Igrave 16#CD/Iacute 16#CE/Icircumflex
16#CF/Idieresis 16#D0/Eth 16#D1/Ntilde 16#D2/Ograve 16#D3/Oacute 16#D4
/Ocircumflex 16#D5/Otilde 16#D6/Odieresis 16#D7/multiply 16#D8/Oslash
16#D9/Ugrave 16#DA/Uacute 16#DB/Ucircumflex 16#DC/Udieresis 16#DD/Yacute
16#DE/Thorn 16#DF/germandbls 16#E0/agrave 16#E1/aacute 16#E2/acircumflex
16#E3/atilde 16#E4/adieresis 16#E5/aring 16#E6/ae 16#E7/ccedilla 16#E8
/egrave 16#E9/eacute 16#EA/ecircumflex 16#EB/edieresis 16#EC/igrave
16#ED/iacute 16#EE/icircumflex 16#EF/idieresis 16#F0/eth 16#F1/ntilde
16#F2/ograve 16#F3/oacute 16#F4/ocircumflex 16#F5/otilde 16#F6/odieresis
16#F7/divide 16#F8/oslash 16#F9/ugrave 16#FA/uacute 16#FB/ucircumflex
16#FC/udieresis 16#FD/yacute 16#FE/thorn 16#FF/ydieresis ] def/reencdict
12 dict def/IsChar{basefontdict/CharStrings get exch known}bd/MapCh{dup
IsChar not{pop/bullet}if newfont/Encoding get 3 1 roll put}bd/MapDegree{16#b0
/degree IsChar{/degree}{/ring}ifelse MapCh}bd/MapBB{16#a6/brokenbar
IsChar{/brokenbar}{/bar}ifelse MapCh}bd/ANSIFont{reencdict begin/newfontname
ed/basefontname ed FontDirectory newfontname known not{/basefontdict
basefontname findfont def/newfont basefontdict maxlength dict def basefontdict{exch
dup/FID ne{dup/Encoding eq{exch dup length array copy newfont 3 1 roll
put}{exch newfont 3 1 roll put}ifelse}{pop pop}ifelse}forall newfont
/FontName newfontname put 127 1 159{newfont/Encoding get exch/bullet
put}for ANSIVec aload pop ANSIVec length 2 idiv{MapCh}repeat MapDegree
MapBB newfontname newfont definefont pop}if newfontname end}bd/SB{FC
/ULlen ed/str ed str length fBE not{dup 1 gt{1 sub}if}if/cbStr ed
/dxGdi ed/y0 ed/x0 ed str stringwidth dup 0 ne{/y1 ed/x1 ed y1 y1
mul x1 x1 mul add sqrt dxGdi exch div 1 sub dup x1 mul cbStr div exch
y1 mul cbStr div}{exch abs neg dxGdi add cbStr div exch}ifelse/dyExtra
ed/dxExtra ed x0 y0 M fBE{dxBreak 0 BCh dxExtra dyExtra str awidthshow}{dxExtra
dyExtra str ashow}ifelse fUL{x0 y0 M dxUL dyUL rmt ULlen fBE{Break
add}if 0 mxUE transform gs rlt cyUL sl [] 0 setdash st gr}if fSO{x0
y0 M dxSO dySO rmt ULlen fBE{Break add}if 0 mxUE transform gs rlt cyUL
sl [] 0 setdash st gr}if n/fBE false def}bd/font{/name ed/Ascent ed
0 ne/fT3 ed 0 ne/fSO ed 0 ne/fUL ed/Sy ed/Sx ed 10.0 div/ori ed -10.0
div/esc ed/BCh ed name findfont/xAscent 0 def/yAscent Ascent def/ULesc
esc def ULesc mxUE rotate pop fT3{/esc 0 def xAscent yAscent mxUE transform
/yAscent ed/xAscent ed}if [Sx 0 0 Sy neg xAscent yAscent] esc mxE
rotate mxF concatmatrix makefont setfont [Sx 0 0 Sy neg 0 Ascent] mxUE
mxUF concatmatrix pop fUL{currentfont dup/FontInfo get/UnderlinePosition
known not{pop/Courier findfont}if/FontInfo get/UnderlinePosition get
1000 div 0 exch mxUF transform/dyUL ed/dxUL ed}if fSO{0 .3 mxUF transform
/dySO ed/dxSO ed}if fUL fSO or{currentfont dup/FontInfo get/UnderlineThickness
known not{pop/Courier findfont}if/FontInfo get/UnderlineThickness get
1000 div Sy mul/cyUL ed}if}bd/min{2 copy gt{exch}if pop}bd/max{2 copy
lt{exch}if pop}bd/CP{/ft ed{{ft 0 eq{clip}{eoclip}ifelse}stopped{currentflat
1 add setflat}{exit}ifelse}loop}bd/patfont 10 dict def patfont begin
/FontType 3 def/FontMatrix [1 0 0 -1 0 0] def/FontBBox [0 0 16 16]
def/Encoding StandardEncoding def/BuildChar{pop pop 16 0 0 0 16 16
setcachedevice 16 16 false [1 0 0 1 .25 .25]{pat}imagemask}bd end/p{
/pat 32 string def{}forall 0 1 7{dup 2 mul pat exch 3 index put dup
2 mul 1 add pat exch 3 index put dup 2 mul 16 add pat exch 3 index
put 2 mul 17 add pat exch 2 index put pop}for}bd/pfill{/PatFont patfont
definefont setfont/ch(AAAA)def X0 64 X1{Y1 -16 Y0{1 index exch M ch
show}for pop}for}bd/vert{X0 w X1{dup Y0 M Y1 L st}for}bd/horz{Y0 w
Y1{dup X0 exch M X1 exch L st}for}bd/fdiag{X0 w X1{Y0 M X1 X0 sub dup
rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup rlt st}for}bd/bdiag{X0 w
X1{Y1 M X1 X0 sub dup neg rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup
neg rlt st}for}bd/AU{1 add cvi 15 or}bd/AD{1 sub cvi -16 and}bd/SHR{pathbbox
AU/Y1 ed AU/X1 ed AD/Y0 ed AD/X0 ed}bd/hfill{/w iRes 37.5 div round
def 0.1 sl [] 0 setdash n dup 0 eq{horz}if dup 1 eq{vert}if dup 2 eq{fdiag}if
dup 3 eq{bdiag}if dup 4 eq{horz vert}if 5 eq{fdiag bdiag}if}bd/F{/ft
ed fm 256 and 0 ne{gs FC ft 0 eq{fill}{eofill}ifelse gr}if fm 1536
and 0 ne{SHR gs HC ft CP fm 1024 and 0 ne{/Tmp save def pfill Tmp restore}{fm
15 and hfill}ifelse gr}if}bd/S{PenW sl PC st}bd/m matrix def/GW{iRes
12 div PenW add cvi}bd/DoW{iRes 50 div PenW add cvi}bd/DW{iRes 8 div
PenW add cvi}bd/SP{/PenW ed/iPen ed iPen 0 eq iPen 6 eq or{[] 0 setdash}if
iPen 1 eq{[DW GW] 0 setdash}if iPen 2 eq{[DoW GW] 0 setdash}if iPen
3 eq{[DW GW DoW GW] 0 setdash}if iPen 4 eq{[DW GW DoW GW DoW GW] 0
setdash}if}bd/E{m cm pop tr scale 1 0 moveto 0 0 1 0 360 arc cp m sm}bd
/AG{/sy ed/sx ed sx div 4 1 roll sy div 4 1 roll sx div 4 1 roll sy
div 4 1 roll atan/a2 ed atan/a1 ed sx sy scale a1 a2 ARC}def/A{m cm
pop tr AG m sm}def/P{m cm pop tr 0 0 M AG cp m sm}def/RRect{n 4 copy
M 3 1 roll exch L 4 2 roll L L cp}bd/RRCC{/r ed/y1 ed/x1 ed/y0 ed/x0
ed x0 x1 add 2 div y0 M x1 y0 x1 y1 r arcto 4{pop}repeat x1 y1 x0 y1
r arcto 4{pop}repeat x0 y1 x0 y0 r arcto 4{pop}repeat x0 y0 x1 y0 r
arcto 4{pop}repeat cp}bd/RR{2 copy 0 eq exch 0 eq or{pop pop RRect}{2
copy eq{pop RRCC}{m cm pop/y2 ed/x2 ed/ys y2 x2 div 1 max def/xs x2
y2 div 1 max def/y1 exch ys div def/x1 exch xs div def/y0 exch ys div
def/x0 exch xs div def/r2 x2 y2 min def xs ys scale x0 x1 add 2 div
y0 M x1 y0 x1 y1 r2 arcto 4{pop}repeat x1 y1 x0 y1 r2 arcto 4{pop}repeat
x0 y1 x0 y0 r2 arcto 4{pop}repeat x0 y0 x1 y0 r2 arcto 4{pop}repeat
m sm cp}ifelse}ifelse}bd/PP{{rlt}repeat}bd/OB{gs 0 ne{7 3 roll/y ed
/x ed x y translate ULesc rotate x neg y neg translate x y 7 -3 roll}if
sc B fill gr}bd/B{M/dy ed/dx ed dx 0 rlt 0 dy rlt dx neg 0 rlt cp}bd
/CB{B clip n}bd/ErrHandler{errordict dup maxlength exch length gt
dup{errordict begin}if/errhelpdict 12 dict def errhelpdict begin/stackunderflow(operand stack underflow)def
/undefined(this name is not defined in a dictionary)def/VMerror(you have used up all the printer's memory)def
/typecheck(operator was expecting a different type of operand)def
/ioerror(input/output error occured)def end{end}if errordict begin
/handleerror{$error begin newerror{/newerror false def showpage 72
72 scale/x .25 def/y 9.6 def/Helvetica findfont .2 scalefont setfont
x y moveto(Offending Command = )show/command load{dup type/stringtype
ne{(max err string)cvs}if show}exec/y y .2 sub def x y moveto(Error = )show
errorname{dup type dup( max err string )cvs show( : )show/stringtype
ne{( max err string )cvs}if show}exec errordict begin errhelpdict errorname
known{x 1 add y .2 sub moveto errhelpdict errorname get show}if end
/y y .4 sub def x y moveto(Stack =)show ostack{/y y .2 sub def x 1
add y moveto dup type/stringtype ne{( max err string )cvs}if show}forall
showpage}if end}def end}bd end
%%EndResource
/SVDoc save def
%%EndProlog
%%BeginSetup
Win35Dict begin
ErrHandler
statusdict begin 0 setjobtimeout end
statusdict begin statusdict /jobname (Microsoft Word - 302TDTOP.DOC) put end
/oldDictCnt countdictstack def {}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
/oldDictCnt countdictstack def {letter
}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
[{ }
/exec load currenttransfer /exec load] cvx settransfer
%%EndSetup
%%Page: 1 1
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 50 50 0 0 0 45 /Times-Roman /font32 ANSIFont font
0 0 0 fC
346 491 33 (C) 58 SB
404 491 36 (H) 61 SB
465 491 35 (A) 60 SB
525 491 28 (P) 53 SB
578 491 31 (T) 56 SB
634 491 31 (E) 56 SB
690 491 33 (R) 58 SB
748 491 13 ( ) 38 SB
786 491 25 (2) 50 SB
32 0 0 100 100 0 0 0 93 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 1400 513 346 604 CB
346 602 1201 (TDI Driver Theory of Operation) 1201 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1117 1440 (TDI maintains a driver object for each driver that registers itself on a network. This) 1440 SB
721 1167 1407 (object contains the addresses of the driver dispatch functions, along with standard) 1407 SB
721 1217 1372 (driver information for Windows NT. TDI driver processing can occur at IRQLs) 1372 SB
721 1267 709 (0,1,2 \(normal, APC level, or DPC level\).) 709 SB
721 1350 1407 (Many TDI operations require a connection between a local node client and one or) 1407 SB
721 1400 1319 (more remote node clients. This book refers to such operations as connection-) 1319 SB
721 1450 602 (oriented. These operations include:) 602 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1527 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1533 722 (Opening a local node connection endpoint) 722 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1594 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1600 421 (Requesting a connection) 421 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1661 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1667 403 (Accepting a connection) 403 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1728 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1734 575 (Sending connection-oriented data) 575 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1795 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1801 609 (Receiving connection-oriented data) 609 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1862 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1868 247 (Disconnecting) 247 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1929 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1935 708 (Closing a local node connection endpoint) 708 SB
721 2035 1272 (In certain cases, TDI also permits connectionless communication using an) 1272 SB
721 2085 1288 (unfragmentable datagram. This type of operation does not require the local) 1288 SB
721 2135 1350 (node client to establish a connection with a remote node client. It is faster than) 1350 SB
721 2185 1354 (connection-oriented communication, but can be unreliable and requires special) 1354 SB
721 2235 819 (precautions. Connectionless operations include:) 819 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2312 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2318 342 (Sending a datagram) 342 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2379 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2385 376 (Receiving a datagram) 376 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 1 def
/wp$fpage (1) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Roman
%%Page: 2 2
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 18 (2) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 411 (Part III    TDI Driver Design) 411 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1354 (Certain TDI operations are common to connection-oriented and connectionless) 1354 SB
634 546 708 (communication. Common operations are:) 708 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 623 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 629 612 (Packaging and submitting a request) 612 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 690 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 696 458 (Registering the TDI driver) 458 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 757 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 763 456 (Opening an address object) 456 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 824 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 830 569 (Setting and querying information) 569 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 891 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 897 491 (Requesting client extensions) 491 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 958 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 964 477 (Receiving error notification) 477 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1025 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1031 453 (Closing the address object) 453 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1092 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1098 748 (Unloading and deregistering the TDI driver) 748 SB
634 1198 1402 (This chapter describes the main TDI operations and attempts to sequence them as) 1402 SB
634 1248 1351 (much as possible. See the appendixes for more information about the theory of) 1351 SB
634 1298 1383 (operation. Appendix A defines TDI status codes; Appendix B details TDI object) 1383 SB
634 1348 1353 (attribute identifiers; Appendix E defines related functions/macros; Appendix F) 1353 SB
634 1398 1356 (defines types, structures, and enumerations; and Appendix G describes IOCTL) 1356 SB
634 1448 356 (or request messages.) 356 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1568 975 (2.1  Registering the TDI Driver) 975 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1682 1331 (Upon initialization of TDI, Windows NT ensures the Registry has a database) 1331 SB
634 1732 1367 (for each TDI driver and client operating on a particular network. Using binding) 1367 SB
634 1782 1444 (information in the registry database, the operating system loads each netcard driver.) 1444 SB
634 1832 906 (It then creates a transport driver object and calls the ) 906 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1540 1831 235 (DriverEntry) 235 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1775 1832 229 ( function of a) 229 SB
634 1882 1388 (TDI driver. The operating system repeats this procedure until all TDI drivers are) 1388 SB
634 1932 1376 (registered for the network. For more information about network binding, see the) 1376 SB
634 1982 107 (DDK ) 107 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
741 1982 378 (Programmer\222s Guide) 378 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1119 1982 11 (.) 11 SB
634 2065 1440 (TDI maintains a driver object for each driver that registers itself on a network. This) 1440 SB
634 2115 1407 (object contains the addresses of the driver dispatch functions, along with standard) 1407 SB
634 2165 1408 (driver information for Windows NT. Each TDI driver must register itself with the) 1408 SB
634 2215 1362 (NDIS interface library so it can bind to an appropriate netcard for the network.) 1362 SB
634 2265 1381 (When the driver is bound to the netcard, it is ready for a registered TDI client to) 1381 SB
634 2315 1217 (package a request. It then opens an address object, and begins network) 1217 SB
634 2365 1402 (communication. For more information about packaging a request, see section 2.2.) 1402 SB
634 2415 1103 (For more information about opening an address, see section 2.3.) 1103 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 2 def
/wp$fpage (2) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 3 3
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1336 378 666 (Chapter 2    TDI Driver Theory of Operation) 666 SB
2002 378 9 ( ) 61 SB
2063 378 9 ( ) 61 SB
2124 378 29 (2-) 29 SB
2153 378 18 (3) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 491 1339 (2.2  Packaging and Submitting a Request) 1339 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 605 989 (As Figure 2.1 shows, a user-mode client calls the Win32 ) 989 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1710 604 311 (DeviceIoControl) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 655 1189 (function . The I/O Manager then constructs an IRP, using the IOCTL) 1189 SB
721 705 1156 (message in the IOCTL field and assigning a major function code of) 1156 SB
721 755 897 (IRP_MJ_DEVICE_CONTROL. The IRP is sent to ) 897 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1618 754 502 (TdiDispatchDeviceControl) 502 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2120 755 44 ( in) 44 SB
721 805 1426 (the driver. The dispatch function receives the IRP, interprets it, and then passes the) 1426 SB
721 855 1210 (client request to an appropriate internal driver function for processing.) 1210 SB
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
274 749 725 1434 B
1 F
S
n
274 350 1876 1434 B
1 F
S
n
274 350 1876 1835 B
1 F
S
n
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
1980 1551 68 (TDI) 68 SB
1951 1593 127 (Library) 127 SB
1990 1963 57 (I/O) 57 SB
1910 2001 207 (Subsystem) 207 SB
1 lc
1 lj
gs 877 1 1000 1706 CB
1000 1706 M 876 0 1 PP
S
n
gr
1035 1607 616 (2. Build macro for client request *) 616 SB
gs 877 1 1000 2009 CB
1000 2009 M 876 0 1 PP
S
n
gr
gs 877 1 1000 1534 CB
1000 1534 M 876 0 1 PP
S
n
gr
1032 1482 674 (1. TdiBuildInternalDeviceControlIrp *) 674 SB
gs 26 13 1851 1522 CB
1876 1534 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 1534 CB
1876 1534 M -25 13 1 PP
S
n
gr
gs 26 13 1851 1694 CB
1876 1706 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 1706 CB
1876 1706 M -25 13 1 PP
S
n
gr
gs 26 13 1851 1997 CB
1876 2009 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 2009 CB
1876 2009 M -25 13 1 PP
S
n
gr
1034 1908 264 (3. IoCallDriver) 264 SB
0 lc
0 lj
255 255 255 fC
274 349 725 959 B
1 F
S
n
274 349 1876 959 B
1 F
S
n
1 lc
1 lj
gs 877 1 1000 1134 CB
1000 1134 M 876 0 1 PP
S
n
gr
gs 26 13 1851 1122 CB
1876 1134 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 1134 CB
1876 1134 M -25 13 1 PP
S
n
gr
0 0 0 fC
1027 1036 343 (1. DeviceIoControl) 343 SB
1895 1088 237 (Windows NT) 237 SB
1953 1126 120 (Kernel) 120 SB
1068 1083 735 (\(IOCTL message and IRP components\)) 735 SB
759 1093 206 (User-Mode) 206 SB
809 1131 106 (Client) 106 SB
1085 1654 750 (\(request message and IRP components\)) 750 SB
743 1770 238 (Kernel-Mode) 238 SB
810 1807 106 (Client) 106 SB
1071 1958 631 (\(IRP containing request message\)) 631 SB
1037 2136 171 (*Optional) 171 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 2241 517 (Figure 2.1    Preparing an IRP) 517 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2336 1428 (A kernel-mode TDI client prepares its own IRP for communication with the driver,) 1428 SB
721 2386 1357 (using one of the request messages described in Chapter 1. The client can either) 1357 SB
721 2436 1397 (obtain an IRP structure from a higher layer of the network or call the TDI library) 1397 SB
721 2486 1247 (build macro appropriate for the request. If the client wants to use a build) 1247 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 3 def
/wp$fpage (3) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 4 4
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 18 (4) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 411 (Part III    TDI Driver Design) 411 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1187 (macro, it may first allocate the IRP structure, if necessary, by calling) 1187 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 545 651 (TdiBuildInternalDeviceControlIrp) 651 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1285 546 775 (. The client places the request message in the) 775 SB
634 596 1364 (minor function code field of the IRP and fills the major function code field with) 1364 SB
634 646 806 (IRP_MJ_INTERNAL_DEVICE_CONTROL.) 806 SB
634 729 899 (When the IRP is ready, the kernel-mode client calls ) 899 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1533 728 243 (IoCallDriver) 243 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1776 729 44 ( in) 44 SB
634 779 1141 (the I/O subsystem to submit the request to the driver. The function) 1141 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 828 654 (TdiDispatchInternalDeviceControl) 654 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1288 829 58 ( or ) 58 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1346 828 582 (TdiDispatchFastDeviceControl) 582 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 879 382 (receives the call from ) 382 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1016 878 243 (IoCallDriver) 243 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1259 879 637 ( and presents the client request to the) 637 SB
634 929 617 (appropriate internal driver function.) 617 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1049 1034 (2.3  Opening an Address Object) 1034 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1163 1403 (A registered TDI client must start communicating with the TDI driver by opening) 1403 SB
634 1213 1386 (an address object to represent its transport address, as Figure 2.2 shows. A user-) 1386 SB
634 1263 494 (mode client calls the Win32 ) 494 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1128 1262 199 (CreateFile) 199 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1327 1263 707 ( function for association with the address) 707 SB
634 1313 747 (object. In turn, the driver dispatch function ) 747 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1381 1312 359 (TdiDispatchCreate) 359 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1740 1313 297 ( calls the internal) 297 SB
634 1363 1420 (driver open address object function. The client can specify the address object to be) 1420 SB
634 1413 1322 (either shared with other clients or exclusive. If it wants to use connectionless) 1322 SB
634 1463 1394 (communication over the network, it can specify the TDI driver broadcast address) 1394 SB
634 1513 381 (for the address object.) 381 SB
634 1596 1256 (After opening the address object, a user-mode client is ready for network) 1256 SB
634 1646 1396 (communication using requests to the driver by means of IOCTL messages, called) 1396 SB
634 1696 1352 (normal operation. A kernel-mode client must first decide if it also wants to use) 1352 SB
634 1746 1415 (event handling, in which it receives indications from the TDI driver when network) 1415 SB
634 1796 226 (events occur.) 226 SB
634 1879 1247 (If the kernel-mode client wants to receive events, it can register an event) 1247 SB
634 1929 1008 (handler function at this time by making a request using the) 1008 SB
634 1979 1340 (TDI_SET_EVENT_HANDLER request message. The request is packaged in) 1340 SB
634 2029 1378 (an IRP and submitted to the TDI driver \(kernel-mode request packaging can use) 1378 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 2078 489 (TdiBuildSetEventHandler) 489 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1123 2079 843 (, if applicable\). Then the internal driver set event) 843 SB
634 2129 1321 (handler function registers the event handler function for the client. The client) 1321 SB
634 2179 1347 (repeats the set event handler request as many times as necessary to register all) 1347 SB
634 2229 1361 (the event handler functions that it requires. For more information about request) 1361 SB
634 2279 469 (packaging, see Section 2.2.) 469 SB
634 2362 1425 (After optional event handling is initiated, the client \(user- or kernel-mode\) is ready) 1425 SB
634 2412 1373 (to make further preparations for connection-oriented communication or to begin) 1373 SB
634 2462 1205 (connectionless communication. When the client completes its network) 1205 SB
634 2512 1142 (communication processes, the client must close the address object.) 1142 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 4 def
/wp$fpage (4) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 5 5
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1336 378 666 (Chapter 2    TDI Driver Theory of Operation) 666 SB
2002 378 9 ( ) 61 SB
2063 378 9 ( ) 61 SB
2124 378 29 (2-) 29 SB
2153 378 18 (5) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
199 599 725 500 B
1 F
S
n
199 274 1876 500 B
1 F
S
n
199 273 1876 825 B
1 F
S
n
1 lc
1 lj
gs 952 1 925 700 CB
925 700 M 951 0 1 PP
S
n
gr
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
972 651 725 (3. TdiBuildSetEventHandler \(optional\) *) 725 SB
gs 952 1 925 1025 CB
925 1025 M 951 0 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1022 984 461 (\(TDI_SET_EVENT_HANDLER\)) 461 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
751 763 149 (CLIENT) 149 SB
1937 919 68 (TDI) 68 SB
1897 976 158 (DRIVER) 158 SB
1940 576 68 (TDI) 68 SB
1886 626 179 (LIBRARY) 179 SB
gs 952 1 925 575 CB
925 575 M 951 0 1 PP
S
n
gr
972 526 859 (2. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
972 1076 463 (* Kernel-mode client only) 463 SB
gs 952 1 925 900 CB
925 900 M 951 0 1 PP
S
n
gr
972 851 392 (1. TdiDispatchCreate) 392 SB
gs 26 13 1851 1013 CB
1876 1025 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 1025 CB
1876 1025 M -25 13 1 PP
S
n
gr
gs 26 13 1851 888 CB
1876 900 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 900 CB
1876 900 M -25 13 1 PP
S
n
gr
gs 26 13 1851 688 CB
1876 700 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 700 CB
1876 700 M -25 13 1 PP
S
n
gr
gs 26 13 1851 563 CB
1876 575 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 575 CB
1876 575 M -25 13 1 PP
S
n
gr
971 938 880 (4. TdiDispatchInternalDeviceControl \(optional\) *) 880 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 1176 684 (Figure 2.2    Opening an Address Object) 684 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1308 1568 (2.4  Opening a Local Node Connection Endpoint) 1568 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1422 1426 (If the local node client requires connection-oriented communication with the driver) 1426 SB
721 1472 1435 (and its remote node peer, it must first open a connection endpoint to set up the local) 1435 SB
721 1522 1350 (node end of the network connection. The client assumes the remote node client) 1350 SB
721 1572 1415 (opens a corresponding endpoint for its end of the connection. Figure 2.3 illustrates) 1415 SB
721 1622 1081 (the request sequence for a connection endpoint open operation.) 1081 SB
0 lc
0 lj
255 255 255 fC
199 675 725 1726 B
1 F
S
n
199 274 1876 1726 B
1 F
S
n
199 350 1876 2051 B
1 F
S
n
1 lc
1 lj
gs 952 1 925 2101 CB
925 2101 M 951 0 1 PP
S
n
gr
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
972 2052 392 (1. TdiDispatchCreate) 392 SB
gs 952 1 925 2226 CB
925 2226 M 951 0 1 PP
S
n
gr
751 2039 149 (CLIENT) 149 SB
1937 2145 68 (TDI) 68 SB
1897 2202 158 (DRIVER) 158 SB
1940 1802 68 (TDI) 68 SB
1886 1852 179 (LIBRARY) 179 SB
972 2402 463 (* Kernel-mode client only) 463 SB
gs 952 1 925 1926 CB
925 1926 M 951 0 1 PP
S
n
gr
972 1877 559 (3. TdiBuildAssociateAddress *) 559 SB
gs 952 1 925 1801 CB
925 1801 M 951 0 1 PP
S
n
gr
972 1752 859 (2. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
gs 26 13 1851 2214 CB
1876 2226 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 2226 CB
1876 2226 M -25 13 1 PP
S
n
gr
gs 26 13 1851 2089 CB
1876 2101 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 2101 CB
1876 2101 M -25 13 1 PP
S
n
gr
gs 26 13 1851 1914 CB
1876 1926 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 1926 CB
1876 1926 M -25 13 1 PP
S
n
gr
gs 26 13 1851 1789 CB
1876 1801 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 1801 CB
1876 1801 M -25 13 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1022 2185 575 (\(IOCTL_TDI_ASSOCIATE_ADDRESS\)) 575 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
971 2139 528 (4. TdiDispatchDeviceControl) 528 SB
gs 952 1 925 2351 CB
925 2351 M 951 0 1 PP
S
n
gr
gs 26 13 1851 2339 CB
1876 2351 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 2351 CB
1876 2351 M -25 13 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1022 2310 460 (\(TDI_ASSOCIATE_ADDRESS\)) 460 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
971 2264 695 (4. TdiDispatchInternalDeviceControl *) 695 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 2502 956 (Figure 2.3    Opening a Local Node Connection Endpoint) 956 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2597 430 (A user-mode client calls ) 430 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1151 2596 199 (CreateFile) 199 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1350 2597 707 ( with a connection context the driver will) 707 SB
721 2647 1296 (use in all future operations. The I/O Manager forwards the client request to) 1296 SB
721 2697 1169 (the internal driver open connection endpoint object function through) 1169 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 5 def
/wp$fpage (5) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 6 6
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 18 (6) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 411 (Part III    TDI Driver Design) 411 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
0 0 0 fC
634 495 359 (TdiDispatchCreate) 359 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
993 496 951 (. Then the internal driver function opens the connection) 951 SB
634 546 421 (endpoint in an idle state.) 421 SB
634 629 1439 (With the connection open, the client must associate the connection endpoint with its) 1439 SB
634 679 1314 (address object by issuing an associate address request, using the appropriate) 1314 SB
634 729 1436 (IOCTL or request message. The request is packaged in an IRP and submitted to the) 1436 SB
634 779 900 (TDI driver \(kernel-mode request packaging can use ) 900 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1534 778 508 (TdiBuildAssociateAddress,) 508 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2042 779 37 ( if) 37 SB
634 829 1335 (applicable\). After the internal driver associate address function associates the) 1335 SB
634 879 1367 (connection endpoint with the address object, the client can make any requests it) 1367 SB
634 929 1263 (requires except associate address requests, on the established connection.) 1263 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1049 959 (2.5  Requesting a Connection) 959 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1163 1440 (To request a connection from the local node connection endpoint to the remote node) 1440 SB
634 1213 1392 (connection endpoint, the local node TDI client makes a connect request using the) 1392 SB
634 1263 1341 (appropriate IOCTL or request message as shown in Figure 2.4. The request is) 1341 SB
634 1313 1269 (packaged in an IRP and submitted to the TDI driver \(kernel-mode request) 1269 SB
634 1363 326 (packaging can use ) 326 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
960 1362 321 (TdiBuildConnect) 321 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1281 1363 263 (, if applicable\).) 263 SB
634 1446 1315 (The internal driver connect function processes the client connect request and) 1315 SB
634 1496 1366 (establishes the connection. This function fails if the remote node client does not) 1366 SB
634 1546 715 (have a listen request open or a registered ) 715 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1349 1545 378 (ClientEventConnect) 378 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1727 1546 355 ( function on which it) 355 SB
634 1596 739 (can receive connect events from the driver.) 739 SB
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
199 623 638 1700 B
1 F
S
n
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
667 1963 149 (CLIENT) 149 SB
255 255 255 fC
199 249 1789 1700 B
1 F
S
n
199 273 1789 2050 B
1 F
S
n
0 0 0 fC
1850 1773 68 (TDI) 68 SB
1799 1826 179 (LIBRARY) 179 SB
1850 2129 68 (TDI) 68 SB
1807 2179 158 (DRIVER) 158 SB
1 lc
1 lj
gs 952 1 838 1875 CB
838 1875 M 951 0 1 PP
S
n
gr
885 1826 380 (2. TdiBuildConnect *) 380 SB
gs 952 1 838 2100 CB
838 2100 M 951 0 1 PP
S
n
gr
gs 952 1 838 1775 CB
838 1775 M 951 0 1 PP
S
n
gr
885 1726 859 (1. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
885 2301 463 (* Kernel-mode client only) 463 SB
gs 26 13 1764 1763 CB
1789 1775 M -25 -12 1 PP
S
n
gr
gs 26 14 1764 1775 CB
1789 1775 M -25 13 1 PP
S
n
gr
gs 26 13 1764 1863 CB
1789 1875 M -25 -12 1 PP
S
n
gr
gs 26 14 1764 1875 CB
1789 1875 M -25 13 1 PP
S
n
gr
gs 26 13 1764 2088 CB
1789 2100 M -25 -12 1 PP
S
n
gr
gs 26 14 1764 2100 CB
1789 2100 M -25 13 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
935 2060 372 (\(IOCTL_TDI_CONNECT\)) 372 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
884 2013 528 (3. TdiDispatchDeviceControl) 528 SB
gs 952 1 838 2225 CB
838 2225 M 951 0 1 PP
S
n
gr
gs 26 13 1764 2213 CB
1789 2225 M -25 -12 1 PP
S
n
gr
gs 26 14 1764 2225 CB
1789 2225 M -25 13 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
935 2185 257 (\(TDI_CONNECT\)) 257 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
884 2138 695 (3. TdiDispatchInternalDeviceControl *) 695 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
634 2401 632 (Figure 2.4    Requesting a Connection) 632 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 6 def
/wp$fpage (6) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 7 7
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1336 378 666 (Chapter 2    TDI Driver Theory of Operation) 666 SB
2002 378 9 ( ) 61 SB
2063 378 9 ( ) 61 SB
2124 378 29 (2-) 29 SB
2153 378 18 (7) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 491 917 (2.6  Accepting a Connection) 917 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 605 1332 (For connection-oriented data transfer, a local node TDI client must be able to) 1332 SB
721 655 1348 (accept a request to connect from a remote node client. Figure 2.5 illustrates an) 1348 SB
721 705 495 (accept-connection operation.) 495 SB
721 788 1411 (In normal operation, the local node client must first make a listen request so it can) 1411 SB
721 838 1174 (passively listen for a request to connect from the remote node client.) 1174 SB
721 888 1439 (IOCTL_TDI_LISTEN or TDI_LISTEN is packaged in an IRP and submitted to the) 1439 SB
721 938 900 (TDI driver \(kernel-mode request packaging can use ) 900 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1621 937 293 (TdiBuildListen,) 293 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1914 938 252 ( if applicable\).) 252 SB
721 988 1439 (When it receives the listen request, the internal driver listen function processes it. It) 1439 SB
721 1038 1380 (can either accept the remote node client request to connect on behalf of the local) 1380 SB
721 1088 1363 (node client or defer acceptance to this client. The latter option is called delayed) 1363 SB
721 1138 397 (connection acceptance.) 397 SB
721 1221 1409 (If the internal driver listen function accepts the connection for the client, it returns) 1409 SB
721 1271 1436 (after making connection with the remote node client. Otherwise, it notifies the local) 1436 SB
721 1321 1354 (node client of the request to connect, and the client either accepts or rejects the) 1354 SB
721 1371 1126 (request by issuing IOCTL_TDI_ACCEPT \(or TDI_ACCEPT\) or) 1126 SB
721 1421 1332 (IOCTL_TDI_DISCONNECT \(or TDI_DISCONNECT\), respectively. These) 1332 SB
721 1471 602 (requests require client IRPs, using ) 602 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1323 1470 297 (TdiBuildAccept) 297 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1620 1471 58 ( or ) 58 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1678 1470 370 (TdiBuildDisconnect) 370 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2048 1471 48 (, if) 48 SB
721 1521 179 (necessary.) 179 SB
721 1604 1341 (The accept operation is less complicated if a kernel-mode client is using event) 1341 SB
721 1654 1393 (handling to communicate with the TDI driver. When the driver receives a remote) 1393 SB
721 1704 1244 (node client request to connect at its internal connect function, it calls the) 1244 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1753 378 (ClientEventConnect) 378 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1099 1754 978 ( event handler function in the local node client, passing a) 978 SB
721 1804 1355 (TDI_EVENT_CONNECT event. The client then accepts or rejects the request) 1355 SB
721 1854 223 (immediately.) 223 SB
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
199 646 725 1958 B
1 F
S
n
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
754 2274 149 (CLIENT) 149 SB
255 255 255 fC
199 325 1901 1958 B
1 F
S
n
199 305 1901 2308 B
1 F
S
n
1 lc
1 lj
gs 977 1 925 2558 CB
925 2558 M 976 0 1 PP
S
n
gr
gs 977 1 925 2083 CB
925 2083 M 976 0 1 PP
S
n
gr
0 0 0 fC
944 2034 336 (2. TdiBuildListen *) 336 SB
gs 977 1 922 2402 CB
922 2402 M 976 0 1 PP
S
n
gr
gs 977 1 925 2233 CB
925 2233 M 976 0 1 PP
S
n
gr
950 2187 770 (5. TdiBuildAccept or TdiBuildDisconnect *) 770 SB
1965 2403 68 (TDI) 68 SB
1925 2459 158 (DRIVER) 158 SB
1968 2077 68 (TDI) 68 SB
1914 2127 179 (LIBRARY) 179 SB
960 2600 463 (* Kernel-mode client only) 463 SB
gs 977 1 925 2158 CB
925 2158 M 976 0 1 PP
S
n
gr
947 2112 859 (4. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
gs 977 1 925 2008 CB
925 2008 M 976 0 1 PP
S
n
gr
944 1959 859 (1. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
gs 26 13 1876 1996 CB
1901 2008 M -25 -12 1 PP
S
n
gr
gs 26 14 1876 2008 CB
1901 2008 M -25 13 1 PP
S
n
gr
gs 26 13 1876 2071 CB
1901 2083 M -25 -12 1 PP
S
n
gr
gs 26 14 1876 2083 CB
1901 2083 M -25 13 1 PP
S
n
gr
gs 26 13 1876 2146 CB
1901 2158 M -25 -12 1 PP
S
n
gr
gs 26 14 1876 2158 CB
1901 2158 M -25 13 1 PP
S
n
gr
gs 26 13 1876 2221 CB
1901 2233 M -25 -12 1 PP
S
n
gr
gs 26 14 1876 2233 CB
1901 2233 M -25 13 1 PP
S
n
gr
gs 26 13 1873 2390 CB
1898 2402 M -25 -12 1 PP
S
n
gr
gs 26 14 1873 2402 CB
1898 2402 M -25 13 1 PP
S
n
gr
gs 26 13 1876 2546 CB
1901 2558 M -25 -12 1 PP
S
n
gr
gs 26 14 1876 2558 CB
1901 2558 M -25 13 1 PP
S
n
gr
946 2309 577 (3. TdiDispatchDeviceControl or) 577 SB
952 2465 586 (6. TdiDispatchlDeviceControl or) 586 SB
992 2353 757 (TdiDispatchInternalDeviceControl \(listen\)) 757 SB
996 2509 909 (TdiDispatchInternalDeviceControl \(accept/reject \)) 909 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 2700 963 (Figure 2.5    Accepting a Connection \(Normal Operation\)) 963 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 7 def
/wp$fpage (7) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 8 8
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 18 (8) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 411 (Part III    TDI Driver Design) 411 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 491 570 (2.7  Sending Data) 570 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 630 1127 (2.7.1  Sending Connection-Oriented Data) 1127 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 726 1400 (A local node TDI client issues a send request to transmit data from its connection) 1400 SB
634 776 1343 (endpoint to a remote node client connection endpoint , as shown in Figure 2.6.) 1343 SB
634 826 1325 (During normal operation, the local node client issues IOCTL_TDI_SEND or) 1325 SB
634 876 1425 (TDI_SEND and a buffer containing a stream-oriented or message-oriented TSDU.) 1425 SB
634 926 1431 (This buffer can be any size, up to the maximum the TDI driver allows. If the driver) 1431 SB
634 976 1116 (supports internal buffering, the client can send nonblocking data.) 1116 SB
634 1059 1382 (The send request is packaged in an IRP and submitted to the TDI driver \(kernel-) 1382 SB
634 1109 566 (mode request packaging can use ) 566 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1200 1108 257 (TdiBuildSend) 257 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1457 1109 583 (, if applicable\). An internal driver) 583 SB
634 1159 1439 (send function receives the send request and sends the specified data on the network.) 1439 SB
634 1242 1431 (If a nonblocking send has previously failed, the send operation begins with a driver) 1431 SB
634 1292 118 (call to ) 118 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
752 1291 464 (ClientEventSendPossible) 464 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1216 1292 863 ( in a kernel-mode client. This function informs the) 863 SB
634 1342 1400 (client that it has buffers available for the send operation. After this, the client can) 1400 SB
634 1392 840 (make a normal send request, as described above.) 840 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1500 723 (2.7.2  Sending a Datagram) 723 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1596 1422 (As Figure 2.6 shows, sending a datagram is similar to sending connection-oriented) 1422 SB
634 1646 1424 (data. However, the local node client issues IOCTL_TDI_SEND_DATAGRAM or) 1424 SB
634 1696 1384 (TDI_SEND_DATAGRAM instead of a send request and uses an address object) 1384 SB
634 1746 1428 (instead of an active connection endpoint object. The send datagram request transits) 1428 SB
634 1796 1281 (a datagram to one or more remote node clients without using a connection.) 1281 SB
634 1879 1439 (Normal operation requires the client to package the datagram request in an IRP and) 1439 SB
634 1929 1158 (submit it to the TDI driver \(kernel-mode request packaging can use) 1158 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1978 459 (TdiBuildSendDatagram,) 459 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1093 1979 835 ( if applicable\). Along with the request, the client) 835 SB
634 2029 1393 (provides a buffer that can be any size, up to the maximum the TDI driver allows.) 1393 SB
0 0 0 fC
1449 2 634 2137 B
1 F
n
1449 2 634 2143 B
1 F
n
32 0 0 44 44 0 0 0 42 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
gs 200 58 607 2146 CB
634 2152 146 (Caution:) 146 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
807 2154 1267 (A datagram send operation can be unreliable, and the TDI driver can lose) 1267 SB
634 2204 418 (or duplicate a datagram.) 418 SB
255 255 255 fC
1449 3 634 2280 B
1 F
n
0 0 0 fC
1449 2 634 2271 B
1 F
n
1449 2 634 2277 B
1 F
n
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 8 def
/wp$fpage (8) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 9 9
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1336 378 666 (Chapter 2    TDI Driver Theory of Operation) 666 SB
2002 378 9 ( ) 61 SB
2063 378 9 ( ) 61 SB
2124 378 29 (2-) 29 SB
2153 378 18 (9) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
199 249 1876 1487 B
1 F
S
n
199 599 725 1487 B
1 F
S
n
199 249 1876 1837 B
1 F
S
n
1 lc
1 lj
gs 952 1 925 2037 CB
925 2037 M 951 0 1 PP
S
n
gr
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
1940 1562 68 (TDI) 68 SB
1886 1612 179 (LIBRARY) 179 SB
1937 1881 68 (TDI) 68 SB
1897 1937 158 (DRIVER) 158 SB
972 1837 542 (1. ClientEventSendPossible *) 542 SB
gs 952 1 925 1887 CB
925 1887 M 951 0 1 PP
S
n
gr
0 lc
0 lj
255 255 255 fC
199 599 725 612 B
1 F
S
n
0 0 0 fC
751 875 149 (CLIENT) 149 SB
255 255 255 fC
199 249 1876 612 B
1 F
S
n
199 248 1876 962 B
1 F
S
n
1 lc
1 lj
gs 952 1 925 787 CB
925 787 M 951 0 1 PP
S
n
gr
0 0 0 fC
972 737 813 (2. TdiBuildSend or TdiBuildSendDatagram *) 813 SB
gs 952 1 925 987 CB
925 987 M 951 0 1 PP
S
n
gr
971 1372 860 (EVENT HANDLING, KERNEL-MODE CLIENT) 860 SB
1165 497 439 (NORMAL OPERATION) 439 SB
751 1750 149 (CLIENT) 149 SB
1937 1031 68 (TDI) 68 SB
1897 1087 158 (DRIVER) 158 SB
1940 687 68 (TDI) 68 SB
1886 737 179 (LIBRARY) 179 SB
gs 952 1 925 1662 CB
925 1662 M 951 0 1 PP
S
n
gr
972 1612 785 (3. TdiBuildSend or TdiBuildSendDatagram) 785 SB
972 1162 463 (* Kernel-mode client only) 463 SB
gs 952 1 925 687 CB
925 687 M 951 0 1 PP
S
n
gr
972 637 859 (1. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
gs 952 1 925 1562 CB
925 1562 M 951 0 1 PP
S
n
gr
972 1512 843 (2. TdiBuildInternalDeviceControlIrp \(optional\) ) 843 SB
gs 26 14 1851 674 CB
1876 687 M -25 -13 1 PP
S
n
gr
gs 26 13 1851 687 CB
1876 687 M -25 12 1 PP
S
n
gr
gs 26 14 926 1874 CB
926 1887 M 25 -13 1 PP
S
n
gr
gs 26 13 926 1887 CB
926 1887 M 25 12 1 PP
S
n
gr
gs 26 14 1851 774 CB
1876 787 M -25 -13 1 PP
S
n
gr
gs 26 13 1851 787 CB
1876 787 M -25 12 1 PP
S
n
gr
gs 26 14 1851 974 CB
1876 987 M -25 -13 1 PP
S
n
gr
gs 26 13 1851 987 CB
1876 987 M -25 12 1 PP
S
n
gr
gs 26 14 1851 1549 CB
1876 1562 M -25 -13 1 PP
S
n
gr
gs 26 13 1851 1562 CB
1876 1562 M -25 12 1 PP
S
n
gr
gs 26 14 1851 1649 CB
1876 1662 M -25 -13 1 PP
S
n
gr
gs 26 13 1851 1662 CB
1876 1662 M -25 12 1 PP
S
n
gr
gs 26 14 1851 2024 CB
1876 2037 M -25 -13 1 PP
S
n
gr
gs 26 13 1851 2037 CB
1876 2037 M -25 12 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1022 947 830 (\(IOCTL_TDI_SEND or IOCTL_TDI_SEND_DATAGRAM\)) 830 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
971 900 528 (3. TdiDispatchDeviceControl) 528 SB
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1022 1997 600 (\(TDI_SEND or TDI_SEND_DATAGRAM\)) 600 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
971 1950 667 (4. TdiDispatchInternalDeviceControl) 667 SB
gs 952 1 925 1137 CB
925 1137 M 951 0 1 PP
S
n
gr
gs 26 14 1851 1124 CB
1876 1137 M -25 -13 1 PP
S
n
gr
gs 26 13 1851 1137 CB
1876 1137 M -25 12 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1022 1097 600 (\(TDI_SEND or TDI_SEND_DATAGRAM\)) 600 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
971 1050 695 (3. TdiDispatchInternalDeviceControl *) 695 SB
972 2088 364 (* Send request only) 364 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 2188 440 (Figure 2.6    Sending Data) 440 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 9 def
/wp$fpage (9) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%Page: 10 10
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (10) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 411 (Part III    TDI Driver Design) 411 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 491 623 (2.8  Receiving Data) 623 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 630 1170 (2.8.1  Receiving Connection-Oriented Data) 1170 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 726 1257 (A local node client can receive a TSDU, either normal or expedited, on a) 1257 SB
634 776 1308 (connection by making a receive request, as shown in Figure 2.7. For normal) 1308 SB
634 826 1404 (operation, the client issues IOCTL_TDI_RECEIVE or TDI_RECEIVE in an IRP) 1404 SB
634 876 103 (using ) 103 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
737 875 312 (TdiBuildReceive) 312 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1049 876 1011 (, if necessary. The internal driver receive function receives) 1011 SB
634 926 1414 (the client data until its receive buffer is full. Expedited data takes precedence over) 1414 SB
634 976 709 (normal data during the receive operation.) 709 SB
634 1059 1338 (A kernel-mode client can also receive data by event notification from the TDI) 1338 SB
634 1109 1394 (driver. In this case, the driver removes the transport layer header from the TSDU) 1394 SB
634 1159 805 (that it receives from the remote node and calls ) 805 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1439 1158 369 (ClientEventReceive) 369 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1808 1159 47 ( or) 47 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1208 558 (ClientEventReceiveExpedited) 558 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1192 1209 840 ( in the requesting client. The client event handler) 840 SB
634 1259 1445 (may then copy as much of the data as possible. If it does not receive all the data, the) 1445 SB
634 1309 588 (client can do one of the following:) 588 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1386 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1392 608 (return a receive buffer immediately) 608 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1453 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1459 635 (make another normal receive request) 635 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1520 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1526 1176 (rely on subsequent driver events to receive the remainder of the data) 1176 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1618 766 (2.8.2  Receiving a Datagram) 766 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1714 1431 (As Figure 2.7 indicates, a local node client receives a datagram much as it receives) 1431 SB
634 1764 1416 (a connection-oriented TSDU, but without using a connection. Normal operation in) 1416 SB
634 1814 1367 (this case requires the client to issue IOCTL_TDI_RECEIVE_DATAGRAM or) 1367 SB
634 1864 676 (TDI_RECEIVE_DATAGRAM, using ) 676 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1310 1863 503 (TdiBuildReceiveDatagram) 503 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1813 1864 238 (, if necessary.) 238 SB
634 1914 906 (With its request, the client provides a receive buffer.) 906 SB
634 1997 1424 (Because TDI does not fragment datagrams, the local node client issues one receive) 1424 SB
634 2047 1358 (datagram request to accept one datagram. The internal driver receive datagram) 1358 SB
634 2097 1393 (function passes the datagram to the client, along with the transport address of the) 1393 SB
634 2147 1384 (remote node client. The local node client then copies as much of the datagram as) 1384 SB
634 2197 1341 (possible into its receive buffer. If the data is too large for the buffer, the client) 1341 SB
634 2247 759 (truncates it and discards the remaining data.) 759 SB
0 0 0 fC
1449 2 634 2355 B
1 F
n
1449 2 634 2361 B
1 F
n
32 0 0 44 44 0 0 0 42 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
gs 188 58 607 2364 CB
634 2370 134 (Caution) 134 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
795 2372 1233 (A datagram receive operation can be unreliable, and the TDI driver can) 1233 SB
634 2422 498 (lose or duplicate a datagram.) 498 SB
255 255 255 fC
1449 3 634 2498 B
1 F
n
0 0 0 fC
1449 2 634 2489 B
1 F
n
1449 2 634 2495 B
1 F
n
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 10 def
/wp$fpage (10) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 11 11
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1318 378 666 (Chapter 2    TDI Driver Theory of Operation) 666 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 29 (2-) 29 SB
2135 378 36 (11) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 909 (For receive datagram event handling, the driver calls) 909 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 545 560 (ClientEventReceiveDatagram) 560 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1281 546 878 ( in the local node client when it obtains a datagram) 878 SB
721 596 1315 (from a remote node client. This event handler function copies as much of the) 1315 SB
721 646 1345 (datagram as it can into its receive buffer. If it does not receive all the data, the) 1345 SB
721 696 1318 (client can obtain the remainder either by returning a receive datagram buffer) 1318 SB
721 746 1390 (immediately or by making another normal receive datagram request as described) 1390 SB
721 796 1325 (above. Nonbuffering drivers may discard data after a receive datagram event) 1325 SB
721 846 1427 (indication if the client does not copy it or return a buffer. Buffering drivers retain a) 1427 SB
721 896 1420 (certain amount of datagram information that the client can retrieve later by normal) 1420 SB
721 946 460 (receive datagram requests.) 460 SB
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
179 224 1850 1941 B
1 F
S
n
179 539 725 1941 B
1 F
S
n
179 224 1850 2256 B
1 F
S
n
32 0 0 38 38 0 0 0 36 /Helvetica /font12 ANSIFont font
0 0 0 fC
1908 2009 61 (TDI) 61 SB
1860 2054 161 (LIBRARY) 161 SB
1906 2296 61 (TDI) 61 SB
1869 2346 142 (DRIVER) 142 SB
983 2276 496 (ClientEventReceiveDatagram) 496 SB
255 255 255 fC
179 539 725 1153 B
1 F
S
n
0 0 0 fC
748 1390 134 (CLIENT) 134 SB
255 255 255 fC
179 224 1850 1153 B
1 F
S
n
179 224 1850 1468 B
1 F
S
n
0 0 0 fC
925 1263 834 (2. TdiBuildReceive or TdiBuildReceiveDatagram *) 834 SB
945 1840 775 (EVENT HANDLING, KERNEL-MODE CLIENT) 775 SB
1126 1046 396 (NORMAL OPERATION) 396 SB
748 2178 134 (CLIENT) 134 SB
1906 1530 61 (TDI) 61 SB
1869 1581 142 (DRIVER) 142 SB
1908 1221 61 (TDI) 61 SB
1860 1266 161 (LIBRARY) 161 SB
925 1694 422 (* Kernel-mode client only) 422 SB
922 1176 782 (1. TdiBuildInternalDeviceControlIrp \(optional\) *) 782 SB
983 2233 553 (ClientEventReceiveExpedited, or) 553 SB
1 lc
1 lj
gs 946 1 905 1310 CB
905 1310 M 945 0 1 PP
S
n
gr
gs 946 1 905 1220 CB
905 1220 M 945 0 1 PP
S
n
gr
gs 947 2 904 1512 CB
904 1512 M 946 1 1 PP
S
n
gr
gs 25 13 1826 1501 CB
1850 1513 M -24 -12 1 PP
S
n
gr
gs 25 12 1826 1513 CB
1850 1513 M -24 11 1 PP
S
n
gr
gs 24 12 1828 1209 CB
1851 1220 M -23 -11 1 PP
S
n
gr
gs 24 13 1828 1220 CB
1851 1220 M -23 12 1 PP
S
n
gr
gs 24 12 1828 1299 CB
1851 1310 M -23 -11 1 PP
S
n
gr
gs 24 13 1828 1310 CB
1851 1310 M -23 12 1 PP
S
n
gr
gs 947 2 904 2435 CB
904 2435 M 946 1 1 PP
S
n
gr
gs 25 12 1826 2424 CB
1850 2435 M -24 -11 1 PP
S
n
gr
gs 25 13 1826 2435 CB
1850 2435 M -24 12 1 PP
S
n
gr
gs 947 1 904 2323 CB
904 2323 M 946 0 1 PP
S
n
gr
gs 25 13 904 2311 CB
904 2323 M 24 -12 1 PP
S
n
gr
gs 25 12 904 2323 CB
904 2323 M 24 11 1 PP
S
n
gr
32 0 0 30 30 0 0 0 28 /Helvetica /font12 ANSIFont font
967 1476 854 (\(IOCTL_TDI_RECEIVE or IOCTL_TDI_RECEIVE_DATAGRAM\)) 854 SB
32 0 0 38 38 0 0 0 36 /Helvetica /font12 ANSIFont font
920 1435 479 (3. TdiDispatchDeviceControl) 479 SB
32 0 0 30 30 0 0 0 28 /Helvetica /font12 ANSIFont font
989 2399 664 (\(TDI_RECEIVE or TDI_RECEIVE_DATAGRAM\) *) 664 SB
32 0 0 38 38 0 0 0 36 /Helvetica /font12 ANSIFont font
943 2358 606 (2. TdiDispatchInternalDeviceControl) 606 SB
941 2192 383 (1. ClientEventReceive,) 383 SB
947 2481 167 (* Optional) 167 SB
gs 947 2 904 1647 CB
904 1647 M 946 1 1 PP
S
n
gr
gs 25 13 1826 1636 CB
1850 1648 M -24 -12 1 PP
S
n
gr
gs 25 12 1826 1648 CB
1850 1648 M -24 11 1 PP
S
n
gr
32 0 0 30 30 0 0 0 28 /Helvetica /font12 ANSIFont font
967 1612 644 (\(TDI_RECEIVE or TDI_RECEIVE_DATAGRAM\)) 644 SB
32 0 0 38 38 0 0 0 36 /Helvetica /font12 ANSIFont font
920 1570 606 (3. TdiDispatchInternalDeviceControl) 606 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 2577 471 (Figure 2.7    Receiving Data) 471 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 11 def
/wp$fpage (11) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 12 12
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (12) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 411 (Part III    TDI Driver Design) 411 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 491 1221 (2.9  Setting and Querying Information) 1221 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 605 1413 (A TDI client must be able to query or set driver information, including connection) 1413 SB
634 655 1446 (status information, broadcast address, driver statistics, and local and remote netcard) 1446 SB
634 705 1372 (status. If the client wants to query or set information concerning an address or a) 1372 SB
634 755 1299 (connection endpoint, it issues IOCTL_TDI_QUERY_INFORMATION \(or) 1299 SB
634 805 846 (TDI_QUERY_INFORMATION\) for a query, or) 846 SB
634 855 1395 (IOCTL_TDI_SET_INFORMATION \(or TDI_SET_INFORMATION\) for a set.) 1395 SB
634 905 810 (These messages are packaged into IRPs, using ) 810 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1444 904 512 (TdiBuildQueryInformation) 512 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1956 905 47 ( or) 47 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 954 451 (TdiBuildSetInformation) 451 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1085 955 967 (, if applicable. Then, they are submitted to the driver for) 967 SB
634 1005 803 (processing by an appropriate internal function.) 803 SB
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
196 624 638 1109 B
1 F
S
n
199 225 1814 1109 B
1 F
S
n
193 380 1814 1359 B
1 F
S
n
1 lc
1 lj
gs 976 1 832 1597 CB
832 1597 M 975 0 1 PP
S
n
gr
gs 977 1 838 1284 CB
838 1284 M 976 0 1 PP
S
n
gr
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
884 1235 498 (    TdiBuildSetInformation *) 498 SB
gs 977 1 838 1409 CB
838 1409 M 976 0 1 PP
S
n
gr
885 1360 436 (1. TdiDispatchCreate **) 436 SB
gs 977 1 835 1697 CB
835 1697 M 976 0 1 PP
S
n
gr
664 1373 149 (CLIENT) 149 SB
1875 1479 68 (TDI) 68 SB
1835 1535 158 (DRIVER) 158 SB
1878 1176 68 (TDI) 68 SB
1824 1226 179 (LIBRARY) 179 SB
885 1185 569 (3. TdiBuildQueryInformation or) 569 SB
868 1779 707 (** For control channel information only) 707 SB
885 1729 463 (* Kernel-mode client only) 463 SB
gs 977 1 838 1159 CB
838 1159 M 976 0 1 PP
S
n
gr
885 1110 859 (2. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
gs 26 14 1783 1584 CB
1808 1597 M -25 -13 1 PP
S
n
gr
gs 26 13 1783 1597 CB
1808 1597 M -25 12 1 PP
S
n
gr
gs 26 14 1786 1684 CB
1811 1697 M -25 -13 1 PP
S
n
gr
gs 26 13 1786 1697 CB
1811 1697 M -25 12 1 PP
S
n
gr
gs 26 13 1789 1397 CB
1814 1409 M -25 -12 1 PP
S
n
gr
gs 26 14 1789 1409 CB
1814 1409 M -25 13 1 PP
S
n
gr
gs 26 13 1789 1272 CB
1814 1284 M -25 -12 1 PP
S
n
gr
gs 26 14 1789 1284 CB
1814 1284 M -25 13 1 PP
S
n
gr
gs 26 13 1789 1147 CB
1814 1159 M -25 -12 1 PP
S
n
gr
gs 26 14 1789 1159 CB
1814 1159 M -25 13 1 PP
S
n
gr
884 1454 577 (4. TdiDispatchDeviceControl or) 577 SB
878 1645 852 (5. TdiDispatchClose or TdiDispatchCleanup **) 852 SB
930 1498 799 (TdiDispatchInternalDeviceControl \(query or) 799 SB
934 1542 469 (set information message\)) 469 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
634 1879 789 (Figure 2.8    Setting and Querying Information) 789 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1974 1381 (If a client needs to query or set information that does not specifically concern an) 1381 SB
634 2024 1407 (address or a connection endpoint, it must open a control channel to the TDI driver) 1407 SB
634 2074 1403 (before submitting a request. For example, a client querying or setting information) 1403 SB
634 2124 1103 (for connectionless data transmission must use a control channel.) 1103 SB
634 2207 888 (To open a control channel, a user-mode client calls ) 888 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1522 2206 199 (CreateFile) 199 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1721 2207 232 ( with an open) 232 SB
634 2257 1447 (control channel object request \(no message\). The I/O Manager packages the request) 1447 SB
634 2307 579 (in an IRP and delivers the IRP to ) 579 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1213 2306 359 (TdiDispatchCreate) 359 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1572 2307 291 (, which forwards) 291 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 12 def
/wp$fpage (12) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 13 13
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1318 378 666 (Chapter 2    TDI Driver Theory of Operation) 666 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 29 (2-) 29 SB
2135 378 36 (13) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1420 (the client request to the internal driver open control channel object function. When) 1420 SB
721 546 1230 (the query or set information operation is complete, the client must close) 1230 SB
721 596 1359 (the control channel. The I/O Manager submits an IRP passing the close control) 1359 SB
721 646 760 (channel object request to the driver through ) 760 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1481 645 359 (TdiDispatchCreate) 359 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1840 646 47 ( or) 47 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 695 386 (TdiDispatchCleanup) 386 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1107 696 11 (.) 11 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 816 1137 (2.10  Requesting Client Extensions) 1137 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 930 1442 (As Figure 2.9 illustrates, a TDI client can make special or proprietary extensions or) 1442 SB
721 980 1274 (both to the TDI driver. These extensions, which can concern an address, a) 1274 SB
721 1030 1414 (connection endpoint, or a control channel \(if open\), apply only to the calling client) 1414 SB
721 1080 738 (and not to any other TDI clients or drivers.) 738 SB
721 1163 1449 (To request extensions, the client either issues its IOCTL or request message directly) 1449 SB
721 1213 1449 (or opens a control channel first and then issues its action request. The action request) 1449 SB
721 1263 1309 (is packaged in an IRP and submitted to the TDI driver \(kernel-mode request) 1309 SB
721 1313 326 (packaging can use ) 326 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1047 1312 290 (TdiBuildAction) 290 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1337 1313 263 (, if applicable\).) 263 SB
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
196 684 725 1417 B
1 F
S
n
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
754 1680 149 (CLIENT) 149 SB
255 255 255 fC
199 249 1876 1417 B
1 F
S
n
193 397 1876 1717 B
1 F
S
n
0 0 0 fC
1937 1490 68 (TDI) 68 SB
1886 1543 179 (LIBRARY) 179 SB
1937 1846 68 (TDI) 68 SB
1894 1896 158 (DRIVER) 158 SB
1 lc
1 lj
gs 952 1 925 1592 CB
925 1592 M 951 0 1 PP
S
n
gr
972 1543 341 (3. TdiBuildAction *) 341 SB
gs 952 1 925 1861 CB
925 1861 M 951 0 1 PP
S
n
gr
gs 952 1 925 1492 CB
925 1492 M 951 0 1 PP
S
n
gr
972 1443 859 (2. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
975 2128 463 (* Kernel-mode client only) 463 SB
gs 26 13 1851 1849 CB
1876 1861 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 1861 CB
1876 1861 M -25 13 1 PP
S
n
gr
gs 26 13 1851 1480 CB
1876 1492 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 1492 CB
1876 1492 M -25 13 1 PP
S
n
gr
gs 26 13 1851 1580 CB
1876 1592 M -25 -12 1 PP
S
n
gr
gs 26 14 1851 1592 CB
1876 1592 M -25 13 1 PP
S
n
gr
gs 952 1 922 1733 CB
922 1733 M 951 0 1 PP
S
n
gr
969 1684 436 (1. TdiDispatchCreate **) 436 SB
gs 952 1 922 2071 CB
922 2071 M 951 0 1 PP
S
n
gr
955 2174 707 (** For control channel information only) 707 SB
gs 26 14 1848 2058 CB
1873 2071 M -25 -13 1 PP
S
n
gr
gs 26 13 1848 2071 CB
1873 2071 M -25 12 1 PP
S
n
gr
gs 26 13 1845 1721 CB
1870 1733 M -25 -12 1 PP
S
n
gr
gs 26 14 1845 1733 CB
1870 1733 M -25 13 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1022 1821 333 (\(IOCTL_TDI_ACTION\)) 333 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
971 1774 528 (4. TdiDispatchDeviceControl) 528 SB
969 2021 852 (5. TdiDispatchClose or TdiDispatchCleanup **) 852 SB
gs 951 1 919 1980 CB
919 1980 M 950 0 1 PP
S
n
gr
gs 26 13 1845 1968 CB
1870 1980 M -25 -12 1 PP
S
n
gr
gs 26 14 1845 1980 CB
1870 1980 M -25 13 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1016 1940 218 (\(TDI_ACTION\)) 218 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
964 1893 667 (4. TdiDispatchInternalDeviceControl) 667 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 2275 707 (Figure 2.9    Requesting Client Extensions) 707 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 13 def
/wp$fpage (13) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 14 14
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (14) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 411 (Part III    TDI Driver Design) 411 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 491 1074 (2.11  Receiving Error Notification) 1074 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 605 1446 (For normal operation \(no client event handlers\), the TDI driver notifies a user-mode) 1446 SB
634 655 1403 (or kernel-mode TDI client of error conditions in the status codes that its functions) 1403 SB
634 705 1237 (return. During event handling \(kernel-mode client only\), the driver calls) 1237 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 754 334 (ClientEventError) 334 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
968 755 795 ( with an error event \(TDI_EVENT_ERROR\).) 795 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 875 643 (2.12  Disconnecting) 643 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 989 1409 (When a connection-oriented TDI client initiates a disconnect between nodes, both) 1409 SB
634 1039 1410 (nodes must participate. One client initiates the disconnect and another responds to) 1410 SB
634 1089 1416 (it. During a disconnect operation, the TDI driver refuses incoming requests for the) 1416 SB
634 1139 1159 (connection and stops all activity at a specified connection endpoint.) 1159 SB
634 1222 1427 (As Figure 2.10 shows, for normal operation the initiating client issues a disconnect) 1427 SB
634 1272 1423 (request using the appropriate IOCTL or request message. This request is packaged) 1423 SB
634 1322 1422 (in an IRP and submitted to the TDI driver \(kernel-mode request packaging can use) 1422 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1371 370 (TdiBuildDisconnect) 370 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1004 1372 1042 (, if applicable\). When the internal driver disconnect function) 1042 SB
634 1422 1339 (finishes processing the initiating client request, it notifies the responding node) 1339 SB
634 1472 1374 (driver of the disconnect and this driver returns an appropriate status code to any) 1374 SB
634 1522 459 (responding client requests.) 459 SB
634 1605 1430 (If the responding client uses event handlers, the TDI driver notifies the client of the) 1430 SB
634 1655 375 (disconnect by calling ) 375 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1009 1654 438 (ClientEventDisconnect ) 438 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1447 1655 107 (with a) 107 SB
634 1705 1279 (TDI_EVENT_DISCONNECT indication. Then the client makes a normal) 1279 SB
634 1755 678 (disconnect request, as described above.) 678 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 14 def
/wp$fpage (14) def
/wp$date (07/18/93) def
/wp$time (04:39 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 15 15
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1318 378 666 (Chapter 2    TDI Driver Theory of Operation) 666 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 29 (2-) 29 SB
2135 378 36 (15) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
199 249 1901 1587 B
1 F
S
n
199 599 725 1587 B
1 F
S
n
199 249 1901 1937 B
1 F
S
n
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
1965 1662 68 (TDI) 68 SB
1911 1712 179 (LIBRARY) 179 SB
1962 1981 68 (TDI) 68 SB
1922 2037 158 (DRIVER) 158 SB
991 1715 403 (3. TdiBuildDisconnect) 403 SB
997 1962 466 (1. ClientEventDisconnect) 466 SB
255 255 255 fC
199 599 725 612 B
1 F
S
n
0 0 0 fC
751 875 149 (CLIENT) 149 SB
255 255 255 fC
199 248 1904 615 B
1 F
S
n
199 248 1904 959 B
1 F
S
n
0 0 0 fC
833 1472 1154 (EVENT HANDLING, RESPONDING KERNEL-MODE CLIENT) 1154 SB
818 497 1214 (NORMAL OPERATION, INITIATING OR RESPONDING CLIENT) 1214 SB
751 1850 149 (CLIENT) 149 SB
1962 1031 68 (TDI) 68 SB
1928 1087 158 (DRIVER) 158 SB
1965 687 68 (TDI) 68 SB
1911 737 179 (LIBRARY) 179 SB
991 1619 831 (2. TdiBuildInternalDeviceControlIrp \(optional\)) 831 SB
997 1187 463 (* Kernel-mode client only) 463 SB
1 lc
1 lj
gs 977 1 925 787 CB
925 787 M 976 0 1 PP
S
n
gr
gs 26 15 1876 774 CB
1901 788 M -25 -14 1 PP
S
n
gr
gs 26 15 1876 788 CB
1901 788 M -25 14 1 PP
S
n
gr
997 637 859 (1. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
997 737 431 (2. TdiBuildDisconnect *) 431 SB
gs 977 1 928 993 CB
928 993 M 976 0 1 PP
S
n
gr
gs 26 15 1879 980 CB
1904 994 M -25 -14 1 PP
S
n
gr
gs 26 15 1879 994 CB
1904 994 M -25 14 1 PP
S
n
gr
gs 977 1 928 693 CB
928 693 M 976 0 1 PP
S
n
gr
gs 26 15 1879 680 CB
1904 694 M -25 -14 1 PP
S
n
gr
gs 26 15 1879 694 CB
1904 694 M -25 14 1 PP
S
n
gr
gs 977 1 925 1671 CB
925 1671 M 976 0 1 PP
S
n
gr
gs 26 14 1876 1659 CB
1901 1672 M -25 -13 1 PP
S
n
gr
gs 26 15 1876 1672 CB
1901 1672 M -25 14 1 PP
S
n
gr
gs 977 1 922 1768 CB
922 1768 M 976 0 1 PP
S
n
gr
gs 27 14 1872 1756 CB
1898 1769 M -26 -13 1 PP
S
n
gr
gs 27 15 1872 1769 CB
1898 1769 M -26 14 1 PP
S
n
gr
gs 977 1 925 2012 CB
1901 2012 M -976 0 1 PP
S
n
gr
gs 26 15 925 1999 CB
925 2013 M 25 -14 1 PP
S
n
gr
gs 26 15 925 2013 CB
925 2013 M 25 14 1 PP
S
n
gr
gs 977 1 925 2124 CB
925 2124 M 976 0 1 PP
S
n
gr
gs 26 14 1876 2112 CB
1901 2125 M -25 -13 1 PP
S
n
gr
gs 26 15 1876 2125 CB
1901 2125 M -25 14 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1047 947 427 (\(IOCTL_TDI_DISCONNECT\)) 427 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
996 900 528 (3. TdiDispatchDeviceControl) 528 SB
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1047 2083 312 (\(TDI_DISCONNECT\)) 312 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
996 2036 667 (4. TdiDispatchInternalDeviceControl) 667 SB
gs 977 1 928 1143 CB
928 1143 M 976 0 1 PP
S
n
gr
gs 26 15 1879 1130 CB
1904 1144 M -25 -14 1 PP
S
n
gr
gs 26 15 1879 1144 CB
1904 1144 M -25 14 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
1047 1097 312 (\(TDI_DISCONNECT\)) 312 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
996 1050 667 (3. TdiDispatchInternalDeviceControl) 667 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
721 2242 469 (Figure 2.10    Disconnecting) 469 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 15 def
/wp$fpage (15) def
/wp$date (07/18/93) def
/wp$time (04:40 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%Page: 16 16
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (16) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 411 (Part III    TDI Driver Design) 411 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 491 1579 (2.13  Closing a Local Node Connection Endpoint) 1579 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 605 1365 (To close its local node connection endpoint, a user-mode client calls the Win32) 1365 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 654 238 (CloseHandle) 238 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
872 655 1208 ( \(no message\). The I/O Manager then prepares an IRP and passes it to) 1208 SB
634 705 63 (the ) 63 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
697 704 333 (TdiDispatchClose) 333 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1030 705 58 ( or ) 58 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1088 704 386 (TdiDispatchCleanup) 386 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1474 705 546 ( function of the TDI driver. The) 546 SB
634 755 1339 (dispatch function interprets the IRP and gives the client request to the internal) 1339 SB
634 805 1415 (driver close connection endpoint object function. This function immediately closes) 1415 SB
634 855 1445 (the connection endpoint and frees associated driver resources. It also terminates any) 1445 SB
634 905 779 (active connection involved with the endpoint.) 779 SB
634 988 1449 (It is not necessary for the TDI client to disassociate the connection endpoint from its) 1449 SB
634 1038 1443 (associated address object before making a close connection endpoint object request.) 1443 SB
634 1088 1434 (If necessary, the internal driver close connection endpoint object function simulates) 1434 SB
634 1138 1425 (the effects of a disassociation. However, if the client wants to actively disassociate) 1425 SB
634 1188 1326 (the endpoint before closing it, the client can first make a disassociate address) 1326 SB
634 1238 1423 (request using the appropriate IOCTL or request message. This request is packaged) 1423 SB
634 1288 1422 (in an IRP and submitted to the TDI driver \(kernel-mode request packaging can use) 1422 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1337 548 (TdiBuildDisassociateAddress) 548 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1182 1338 263 (, if applicable\).) 263 SB
0 lc
0 lj
0 0 0 pC
6 1 SP
255 255 255 fC
196 637 638 1442 B
1 F
S
n
199 249 1789 1442 B
1 F
S
n
193 293 1789 1792 B
1 F
S
n
1 lc
1 lj
gs 952 1 835 2039 CB
835 2039 M 951 0 1 PP
S
n
gr
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
0 0 0 fC
664 1705 149 (CLIENT) 149 SB
1850 1862 68 (TDI) 68 SB
1810 1918 158 (DRIVER) 158 SB
1853 1518 68 (TDI) 68 SB
1799 1568 179 (LIBRARY) 179 SB
gs 952 1 838 1517 CB
838 1517 M 951 0 1 PP
S
n
gr
885 1468 859 (1. TdiBuildInternalDeviceControlIrp \(optional\) *) 859 SB
885 2084 463 (* Kernel-mode client only) 463 SB
gs 952 1 838 1811 CB
838 1811 M 951 0 1 PP
S
n
gr
gs 952 1 838 1617 CB
838 1617 M 951 0 1 PP
S
n
gr
885 1568 799 (2. TdiBuildDisassociateAddress \(optional\) *) 799 SB
gs 26 13 1761 2027 CB
1786 2039 M -25 -12 1 PP
S
n
gr
gs 26 14 1761 2039 CB
1786 2039 M -25 13 1 PP
S
n
gr
gs 26 13 1764 1799 CB
1789 1811 M -25 -12 1 PP
S
n
gr
gs 26 14 1764 1811 CB
1789 1811 M -25 13 1 PP
S
n
gr
gs 26 13 1764 1605 CB
1789 1617 M -25 -12 1 PP
S
n
gr
gs 26 14 1764 1617 CB
1789 1617 M -25 13 1 PP
S
n
gr
gs 26 13 1764 1505 CB
1789 1517 M -25 -12 1 PP
S
n
gr
gs 26 14 1764 1517 CB
1789 1517 M -25 13 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
935 1771 630 (\(IOCTL_TDI_DISASSOCIATE_ADDRESS\)) 630 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
884 1724 713 (3. TdiDispatchDeviceControl \(optional\)) 713 SB
882 1983 808 (4. TdiDispatchClose or TdiDispatchCleanup) 808 SB
gs 952 1 835 1936 CB
835 1936 M 951 0 1 PP
S
n
gr
gs 26 13 1761 1924 CB
1786 1936 M -25 -12 1 PP
S
n
gr
gs 26 14 1761 1936 CB
1786 1936 M -25 13 1 PP
S
n
gr
32 0 0 33 33 0 0 0 31 /Helvetica /font12 ANSIFont font
932 1896 515 (\(TDI_DISASSOCIATE_ADDRESS\)) 515 SB
32 0 0 42 42 0 0 0 40 /Helvetica /font12 ANSIFont font
880 1849 852 (3. TdiDispatchInternalDeviceControl \(optional\)) 852 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
634 2184 959 (Figure 2.11    Closing a Local Node Connection Endpoint) 959 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 16 def
/wp$fpage (16) def
/wp$date (07/18/93) def
/wp$time (04:40 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 17 17
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1318 378 666 (Chapter 2    TDI Driver Theory of Operation) 666 SB
1984 378 9 ( ) 61 SB
2045 378 9 ( ) 61 SB
2106 378 29 (2-) 29 SB
2135 378 36 (17) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 491 1045 (2.14  Closing an Address Object) 1045 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 605 1365 (After shutting down any related connections, the TDI client is ready to close its) 1365 SB
721 655 1421 (address object. No message is needed for this operation. Again, a user-mode client) 1421 SB
721 705 91 (calls ) 91 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
812 704 238 (CloseHandle) 238 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1050 705 1034 (, and the I/O Manager prepares an IRP for the close address) 1034 SB
721 755 526 (object request and passes it to ) 526 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1247 754 321 (TdiDispatchclose) 321 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1568 755 58 ( or ) 58 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1626 754 386 (TdiDispatchCleanup) 386 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2012 755 88 (. The) 88 SB
721 805 1424 (dispatch function then directs the request to the internal driver close address object) 1424 SB
721 855 1430 (function, which completes any pending requests with an appropriate error code and) 1430 SB
721 905 1425 (deregisters any kernel-mode client event handlers registered for the address object.) 1425 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1025 1572 (2.15  Unloading and Deregistering the TDI Driver) 1572 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1139 1394 (After the operating system unloads a netcard driver, it may unload and deregister) 1394 SB
721 1189 1031 (the associated TDI drivers. To accomplish this task, it calls ) 1031 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1752 1188 261 (DriverUnload) 261 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2013 1189 135 ( located) 135 SB
721 1239 1412 (in the driver. This function frees allocated resources and adjusts the device object.) 1412 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1288 261 (DriverUnload) 261 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
982 1289 186 ( then calls ) 186 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1168 1288 442 (NdisDeregisterProtocol) 442 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1610 1289 554 ( in the NDIS interface library to) 554 SB
721 1339 1378 (remove the TDI driver from the NDIS interface library wrapper connection. For) 1378 SB
721 1389 417 (more information about ) 417 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1138 1388 442 (NdisDeregisterProtocol) 442 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1580 1389 307 (, see Appendix C.) 307 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 17 def
/wp$fpage (17) def
/wp$date (07/18/93) def
/wp$time (04:40 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 18 18
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (18) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 411 (Part III    TDI Driver Design) 411 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 63 63 1 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1189 579 339 (BLANK PAGE) 339 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 752 1391 (IMPORTANT: This text will appear on screen, but will not) 1391 SB
634 825 700 (print on a PostScript printer.) 700 SB
634 931 1449 (This page should be the last one in this file; it was inserted) 1449 SB
634 1004 965 (by running the InsertBlankPage macro.) 965 SB
634 1110 1091 (Do not type any additional text on this page!) 1091 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 18 def
/wp$fpage (18) def
/wp$date (07/18/93) def
/wp$time (04:40 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def
1 setgray 41.5 73 moveto 0 646 rlineto 529 0 rlineto 0 646 neg rlineto closepath fill
 grestore
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 18 def
/wp$fpage (18) def
/wp$date (07/18/93) def
/wp$time (04:40 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%Trailer
SVDoc restore
end
%%Pages: 18
% TrueType font name key:
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT31c1c5 = 1defDTimes New RomanF00000015000001900000
%    MSTT31c1e2 = 1defDTimes New RomanF00000000000001900000
%    MSTT31c1ef = 1defDTimes New RomanF00000026000001900000
%    MSTT31c1fc = 1defDArial NarrowF00000064000002bc0000
%    MSTT31c208 = 1defDArial NarrowF00000032000002bc0000
%    MSTT31c214 = 1defDTimes New RomanF00000019000001900000
%    MSTT31c221 = 1defDTimes New RomanF00000023000001900000
%    MSTT31c22e = 1defDTimes New RomanF0000001d000001900000
%    MSTT31c23b = 1defDArial NarrowF00000028000002bc0000
%    MSTT31c247 = 1defDArial NarrowF0000003f000002bc0000
%    MSTT31c1d2 = 1defDTimes New RomanF00000032000001900000
%    MSTT31c253 = 1defDTimes New RomanF0000002c000001900000
%    MSTT31c260 = 1defDTimes New RomanF0000002c000001900001
%    MSTT31c26d = 1defDArial NarrowF00000053000002bc0000
%    MSTT31c287 = 1defDArialF00000032000001900000
%    MSTT31c292 = 1defDArial NarrowF00000047000002bc0000
%    MSTT31c29e = 1defDTimes New RomanF0000002c000002bc0000
%    MSTT31c2ab = 1defDArial NarrowF0000002c000002bc0000
%    MSTT31c2b7 = 1defDTimes New RomanF00000028000002bc0000
%    MSTT31c2c4 = 1defDTimes New RomanF00000011000001900000
%    MSTT31c2d1 = 1defDTimes New RomanF00000028000001900001
%    MSTT31c2de = 1defDTimes New RomanF00000028000001900000
%    MSTT31c2eb = 1defDTimes New RomanF00000028000002bc0001
%    MSTT31c2f8 = 1defDTimes New RomanF00000021000001900000
%    MSTT31c305 = 1defDArial NarrowF00000053000002bc0001
%    MSTT31c311 = 1defDMSIconsF00000028000001900000
%    MSTT31c31c = 1defDTimes New RomanF00000011000002bc0000
%    MSTT31c329 = 1defDTimes New RomanF0000003f000002bc0000
%    MSTT31c336 = 1defDArial NarrowF0000002c000001900000
%    MSTT31c279 = 1defDArial NarrowF00000021000002bc0000
%    MSTT31c34c = 1defDTimes New RomanF0000003a000001900000
%    MSTT31c359 = 1defDTimes New RomanF0000001e000001900000
%    MSTT31c366 = 1defDTimes New RomanF0000001b000001900000
%%DocumentSuppliedResources: procset Win35Dict 3 1

%%DocumentNeededResources: font Helvetica
%%+ font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman

%%EOF
