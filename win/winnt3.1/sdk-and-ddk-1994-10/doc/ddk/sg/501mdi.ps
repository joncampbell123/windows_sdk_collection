%!PS-Adobe-3.0
%%Creator: Windows PSCRIPT
%%Title: Microsoft Word - 501MDI.DOC
%%BoundingBox: 14 9 597 784
%%DocumentNeededResources: (atend)
%%DocumentSuppliedResources: (atend)
%%Pages: (atend)
%%BeginResource: procset Win35Dict 3 1
/Win35Dict 290 dict def Win35Dict begin/bd{bind def}bind def/in{72
mul}bd/ed{exch def}bd/ld{load def}bd/tr/translate ld/gs/gsave ld/gr
/grestore ld/M/moveto ld/L/lineto ld/rmt/rmoveto ld/rlt/rlineto ld
/rct/rcurveto ld/st/stroke ld/n/newpath ld/sm/setmatrix ld/cm/currentmatrix
ld/cp/closepath ld/ARC/arcn ld/TR{65536 div}bd/lj/setlinejoin ld/lc
/setlinecap ld/ml/setmiterlimit ld/sl/setlinewidth ld/scignore false
def/sc{scignore{pop pop pop}{0 index 2 index eq 2 index 4 index eq
and{pop pop 255 div setgray}{3{255 div 3 1 roll}repeat setrgbcolor}ifelse}ifelse}bd
/FC{bR bG bB sc}bd/fC{/bB ed/bG ed/bR ed}bd/HC{hR hG hB sc}bd/hC{
/hB ed/hG ed/hR ed}bd/PC{pR pG pB sc}bd/pC{/pB ed/pG ed/pR ed}bd/sM
matrix def/PenW 1 def/iPen 5 def/mxF matrix def/mxE matrix def/mxUE
matrix def/mxUF matrix def/fBE false def/iDevRes 72 0 matrix defaultmatrix
dtransform dup mul exch dup mul add sqrt def/fPP false def/SS{fPP{
/SV save def}{gs}ifelse}bd/RS{fPP{SV restore}{gr}ifelse}bd/EJ{gsave
showpage grestore}bd/#C{userdict begin/#copies ed end}bd/FEbuf 2 string
def/FEglyph(G  )def/FE{1 exch{dup 16 FEbuf cvrs FEglyph exch 1 exch
putinterval 1 index exch FEglyph cvn put}for}bd/SM{/iRes ed/cyP ed
/cxPg ed/cyM ed/cxM ed 72 100 div dup scale dup 0 ne{90 eq{cyM exch
0 eq{cxM exch tr -90 rotate -1 1 scale}{cxM cxPg add exch tr +90 rotate}ifelse}{cyP
cyM sub exch 0 ne{cxM exch tr -90 rotate}{cxM cxPg add exch tr -90
rotate 1 -1 scale}ifelse}ifelse}{pop cyP cyM sub exch 0 ne{cxM cxPg
add exch tr 180 rotate}{cxM exch tr 1 -1 scale}ifelse}ifelse 100 iRes
div dup scale 0 0 transform .25 add round .25 sub exch .25 add round
.25 sub exch itransform translate}bd/SJ{1 index 0 eq{pop pop/fBE false
def}{1 index/Break ed div/dxBreak ed/fBE true def}ifelse}bd/ANSIVec[
16#0/grave 16#1/acute 16#2/circumflex 16#3/tilde 16#4/macron 16#5/breve
16#6/dotaccent 16#7/dieresis 16#8/ring 16#9/cedilla 16#A/hungarumlaut
16#B/ogonek 16#C/caron 16#D/dotlessi 16#27/quotesingle 16#60/grave
16#7C/bar 16#82/quotesinglbase 16#83/florin 16#84/quotedblbase 16#85
/ellipsis 16#86/dagger 16#87/daggerdbl 16#88/circumflex 16#89/perthousand
16#8A/Scaron 16#8B/guilsinglleft 16#8C/OE 16#91/quoteleft 16#92/quoteright
16#93/quotedblleft 16#94/quotedblright 16#95/bullet 16#96/endash 16#97
/emdash 16#98/tilde 16#99/trademark 16#9A/scaron 16#9B/guilsinglright
16#9C/oe 16#9F/Ydieresis 16#A0/space 16#A1/exclamdown 16#A4/currency
16#A5/yen 16#A6/brokenbar 16#A7/section 16#A8/dieresis 16#A9/copyright
16#AA/ordfeminine 16#AB/guillemotleft 16#AC/logicalnot 16#AD/hyphen
16#AE/registered 16#AF/macron 16#B0/degree 16#B1/plusminus 16#B2/twosuperior
16#B3/threesuperior 16#B4/acute 16#B5/mu 16#B6/paragraph 16#B7/periodcentered
16#B8/cedilla 16#B9/onesuperior 16#BA/ordmasculine 16#BB/guillemotright
16#BC/onequarter 16#BD/onehalf 16#BE/threequarters 16#BF/questiondown
16#C0/Agrave 16#C1/Aacute 16#C2/Acircumflex 16#C3/Atilde 16#C4/Adieresis
16#C5/Aring 16#C6/AE 16#C7/Ccedilla 16#C8/Egrave 16#C9/Eacute 16#CA
/Ecircumflex 16#CB/Edieresis 16#CC/Igrave 16#CD/Iacute 16#CE/Icircumflex
16#CF/Idieresis 16#D0/Eth 16#D1/Ntilde 16#D2/Ograve 16#D3/Oacute 16#D4
/Ocircumflex 16#D5/Otilde 16#D6/Odieresis 16#D7/multiply 16#D8/Oslash
16#D9/Ugrave 16#DA/Uacute 16#DB/Ucircumflex 16#DC/Udieresis 16#DD/Yacute
16#DE/Thorn 16#DF/germandbls 16#E0/agrave 16#E1/aacute 16#E2/acircumflex
16#E3/atilde 16#E4/adieresis 16#E5/aring 16#E6/ae 16#E7/ccedilla 16#E8
/egrave 16#E9/eacute 16#EA/ecircumflex 16#EB/edieresis 16#EC/igrave
16#ED/iacute 16#EE/icircumflex 16#EF/idieresis 16#F0/eth 16#F1/ntilde
16#F2/ograve 16#F3/oacute 16#F4/ocircumflex 16#F5/otilde 16#F6/odieresis
16#F7/divide 16#F8/oslash 16#F9/ugrave 16#FA/uacute 16#FB/ucircumflex
16#FC/udieresis 16#FD/yacute 16#FE/thorn 16#FF/ydieresis ] def/reencdict
12 dict def/IsChar{basefontdict/CharStrings get exch known}bd/MapCh{dup
IsChar not{pop/bullet}if newfont/Encoding get 3 1 roll put}bd/MapDegree{16#b0
/degree IsChar{/degree}{/ring}ifelse MapCh}bd/MapBB{16#a6/brokenbar
IsChar{/brokenbar}{/bar}ifelse MapCh}bd/ANSIFont{reencdict begin/newfontname
ed/basefontname ed FontDirectory newfontname known not{/basefontdict
basefontname findfont def/newfont basefontdict maxlength dict def basefontdict{exch
dup/FID ne{dup/Encoding eq{exch dup length array copy newfont 3 1 roll
put}{exch newfont 3 1 roll put}ifelse}{pop pop}ifelse}forall newfont
/FontName newfontname put 127 1 159{newfont/Encoding get exch/bullet
put}for ANSIVec aload pop ANSIVec length 2 idiv{MapCh}repeat MapDegree
MapBB newfontname newfont definefont pop}if newfontname end}bd/SB{FC
/ULlen ed/str ed str length fBE not{dup 1 gt{1 sub}if}if/cbStr ed
/dxGdi ed/y0 ed/x0 ed str stringwidth dup 0 ne{/y1 ed/x1 ed y1 y1
mul x1 x1 mul add sqrt dxGdi exch div 1 sub dup x1 mul cbStr div exch
y1 mul cbStr div}{exch abs neg dxGdi add cbStr div exch}ifelse/dyExtra
ed/dxExtra ed x0 y0 M fBE{dxBreak 0 BCh dxExtra dyExtra str awidthshow}{dxExtra
dyExtra str ashow}ifelse fUL{x0 y0 M dxUL dyUL rmt ULlen fBE{Break
add}if 0 mxUE transform gs rlt cyUL sl [] 0 setdash st gr}if fSO{x0
y0 M dxSO dySO rmt ULlen fBE{Break add}if 0 mxUE transform gs rlt cyUL
sl [] 0 setdash st gr}if n/fBE false def}bd/font{/name ed/Ascent ed
0 ne/fT3 ed 0 ne/fSO ed 0 ne/fUL ed/Sy ed/Sx ed 10.0 div/ori ed -10.0
div/esc ed/BCh ed name findfont/xAscent 0 def/yAscent Ascent def/ULesc
esc def ULesc mxUE rotate pop fT3{/esc 0 def xAscent yAscent mxUE transform
/yAscent ed/xAscent ed}if [Sx 0 0 Sy neg xAscent yAscent] esc mxE
rotate mxF concatmatrix makefont setfont [Sx 0 0 Sy neg 0 Ascent] mxUE
mxUF concatmatrix pop fUL{currentfont dup/FontInfo get/UnderlinePosition
known not{pop/Courier findfont}if/FontInfo get/UnderlinePosition get
1000 div 0 exch mxUF transform/dyUL ed/dxUL ed}if fSO{0 .3 mxUF transform
/dySO ed/dxSO ed}if fUL fSO or{currentfont dup/FontInfo get/UnderlineThickness
known not{pop/Courier findfont}if/FontInfo get/UnderlineThickness get
1000 div Sy mul/cyUL ed}if}bd/min{2 copy gt{exch}if pop}bd/max{2 copy
lt{exch}if pop}bd/CP{/ft ed{{ft 0 eq{clip}{eoclip}ifelse}stopped{currentflat
1 add setflat}{exit}ifelse}loop}bd/patfont 10 dict def patfont begin
/FontType 3 def/FontMatrix [1 0 0 -1 0 0] def/FontBBox [0 0 16 16]
def/Encoding StandardEncoding def/BuildChar{pop pop 16 0 0 0 16 16
setcachedevice 16 16 false [1 0 0 1 .25 .25]{pat}imagemask}bd end/p{
/pat 32 string def{}forall 0 1 7{dup 2 mul pat exch 3 index put dup
2 mul 1 add pat exch 3 index put dup 2 mul 16 add pat exch 3 index
put 2 mul 17 add pat exch 2 index put pop}for}bd/pfill{/PatFont patfont
definefont setfont/ch(AAAA)def X0 64 X1{Y1 -16 Y0{1 index exch M ch
show}for pop}for}bd/vert{X0 w X1{dup Y0 M Y1 L st}for}bd/horz{Y0 w
Y1{dup X0 exch M X1 exch L st}for}bd/fdiag{X0 w X1{Y0 M X1 X0 sub dup
rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup rlt st}for}bd/bdiag{X0 w
X1{Y1 M X1 X0 sub dup neg rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup
neg rlt st}for}bd/AU{1 add cvi 15 or}bd/AD{1 sub cvi -16 and}bd/SHR{pathbbox
AU/Y1 ed AU/X1 ed AD/Y0 ed AD/X0 ed}bd/hfill{/w iRes 37.5 div round
def 0.1 sl [] 0 setdash n dup 0 eq{horz}if dup 1 eq{vert}if dup 2 eq{fdiag}if
dup 3 eq{bdiag}if dup 4 eq{horz vert}if 5 eq{fdiag bdiag}if}bd/F{/ft
ed fm 256 and 0 ne{gs FC ft 0 eq{fill}{eofill}ifelse gr}if fm 1536
and 0 ne{SHR gs HC ft CP fm 1024 and 0 ne{/Tmp save def pfill Tmp restore}{fm
15 and hfill}ifelse gr}if}bd/S{PenW sl PC st}bd/m matrix def/GW{iRes
12 div PenW add cvi}bd/DoW{iRes 50 div PenW add cvi}bd/DW{iRes 8 div
PenW add cvi}bd/SP{/PenW ed/iPen ed iPen 0 eq iPen 6 eq or{[] 0 setdash}if
iPen 1 eq{[DW GW] 0 setdash}if iPen 2 eq{[DoW GW] 0 setdash}if iPen
3 eq{[DW GW DoW GW] 0 setdash}if iPen 4 eq{[DW GW DoW GW DoW GW] 0
setdash}if}bd/E{m cm pop tr scale 1 0 moveto 0 0 1 0 360 arc cp m sm}bd
/AG{/sy ed/sx ed sx div 4 1 roll sy div 4 1 roll sx div 4 1 roll sy
div 4 1 roll atan/a2 ed atan/a1 ed sx sy scale a1 a2 ARC}def/A{m cm
pop tr AG m sm}def/P{m cm pop tr 0 0 M AG cp m sm}def/RRect{n 4 copy
M 3 1 roll exch L 4 2 roll L L cp}bd/RRCC{/r ed/y1 ed/x1 ed/y0 ed/x0
ed x0 x1 add 2 div y0 M x1 y0 x1 y1 r arcto 4{pop}repeat x1 y1 x0 y1
r arcto 4{pop}repeat x0 y1 x0 y0 r arcto 4{pop}repeat x0 y0 x1 y0 r
arcto 4{pop}repeat cp}bd/RR{2 copy 0 eq exch 0 eq or{pop pop RRect}{2
copy eq{pop RRCC}{m cm pop/y2 ed/x2 ed/ys y2 x2 div 1 max def/xs x2
y2 div 1 max def/y1 exch ys div def/x1 exch xs div def/y0 exch ys div
def/x0 exch xs div def/r2 x2 y2 min def xs ys scale x0 x1 add 2 div
y0 M x1 y0 x1 y1 r2 arcto 4{pop}repeat x1 y1 x0 y1 r2 arcto 4{pop}repeat
x0 y1 x0 y0 r2 arcto 4{pop}repeat x0 y0 x1 y0 r2 arcto 4{pop}repeat
m sm cp}ifelse}ifelse}bd/PP{{rlt}repeat}bd/OB{gs 0 ne{7 3 roll/y ed
/x ed x y translate ULesc rotate x neg y neg translate x y 7 -3 roll}if
sc B fill gr}bd/B{M/dy ed/dx ed dx 0 rlt 0 dy rlt dx neg 0 rlt cp}bd
/CB{B clip n}bd/ErrHandler{errordict dup maxlength exch length gt
dup{errordict begin}if/errhelpdict 12 dict def errhelpdict begin/stackunderflow(operand stack underflow)def
/undefined(this name is not defined in a dictionary)def/VMerror(you have used up all the printer's memory)def
/typecheck(operator was expecting a different type of operand)def
/ioerror(input/output error occured)def end{end}if errordict begin
/handleerror{$error begin newerror{/newerror false def showpage 72
72 scale/x .25 def/y 9.6 def/Helvetica findfont .2 scalefont setfont
x y moveto(Offending Command = )show/command load{dup type/stringtype
ne{(max err string)cvs}if show}exec/y y .2 sub def x y moveto(Error = )show
errorname{dup type dup( max err string )cvs show( : )show/stringtype
ne{( max err string )cvs}if show}exec errordict begin errhelpdict errorname
known{x 1 add y .2 sub moveto errhelpdict errorname get show}if end
/y y .4 sub def x y moveto(Stack =)show ostack{/y y .2 sub def x 1
add y moveto dup type/stringtype ne{( max err string )cvs}if show}forall
showpage}if end}def end}bd end
%%EndResource
/SVDoc save def
%%EndProlog
%%BeginSetup
Win35Dict begin
ErrHandler
statusdict begin 0 setjobtimeout end
statusdict begin statusdict /jobname (Microsoft Word - 501MDI.DOC) put end
/oldDictCnt countdictstack def {}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
/oldDictCnt countdictstack def {letter
}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
[{ }
/exec load currenttransfer /exec load] cvx settransfer
%%EndSetup
%%Page: 1 1
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
0 0 0 fC
/fm 256 def
1824 2 346 436 B
1 F
n
32 0 0 50 50 0 0 0 45 /Times-Roman /font32 ANSIFont font
0 0 0 fC
346 491 33 (C) 58 SB
404 491 36 (H) 61 SB
465 491 35 (A) 60 SB
525 491 28 (P) 53 SB
578 491 31 (T) 56 SB
634 491 31 (E) 56 SB
690 491 33 (R) 58 SB
748 491 13 ( ) 38 SB
786 491 25 (1) 50 SB
32 0 0 100 100 0 0 0 93 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 1400 513 346 604 CB
346 602 411 (The Win32) 411 SB
gr
32 0 0 38 38 0 0 0 35 /Helvetica-Narrow /font15 ANSIFont font
gs 1400 513 346 604 CB
757 616 31 (\231) 31 SB
gr
32 0 0 100 100 0 0 0 93 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 1400 513 346 604 CB
346 715 1056 (Multimedia Driver Interface) 1056 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1117 1404 (The chapters included in this section describe the development of the MCI, audio,) 1404 SB
721 1167 1076 (and joystick drivers. This part contains the following chapters:) 1076 SB
721 1250 1416 (Chapter 1, \223The Win32 Multimedia Driver Interface\224 \(this chapter\), describes the) 1416 SB
721 1300 1399 (driver interface common to multimedia drivers, as well as the installation process) 1399 SB
721 1350 156 (for them.) 156 SB
721 1433 1372 (Chapter 2, \223Win32 MCI Drivers,\224 provides a coherent, extensible approach for) 1372 SB
721 1483 1404 (interacting with different device types such as CD audio, videodisc, and graphics.) 1404 SB
721 1533 1430 (This chapter also describes how to develop drivers that use the standard features of) 1430 SB
721 1583 1350 (MCI and how to extend MCI to provide access to new devices and new device) 1350 SB
721 1633 148 (features.) 148 SB
721 1716 1439 (Chapter 3, \223Win32 Audio Drivers,\224 describes Win32 support for six types of audio) 1439 SB
721 1766 1316 (devices: waveform output, waveform input, MIDI output, MIDI input, MIDI) 1316 SB
721 1816 1339 (synthesizer, and auxiliary audio devices. This chapter discusses the functions,) 1339 SB
721 1866 1118 (messages, and data structures specific to low-level audio drivers.) 1118 SB
721 1949 1400 (Chapter 4, \223Win32 Joystick Drivers,\224 addresses development issues of a joystick) 1400 SB
721 1999 1413 (driver. Drivers that map device input into a coordinate system can use the joystick) 1413 SB
721 2049 739 (driver presented in this chapter as a model.) 739 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 2169 38 (1) 38 SB
384 2169 398 (.1  Overview) 398 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2283 1099 (This chapter discusses the interface that applies to all Microsoft) 1099 SB
32 0 0 29 29 0 0 0 26 /Times-Roman /font32 ANSIFont font
1820 2297 22 (\256) 22 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1842 2283 130 ( Win32) 130 SB
32 0 0 29 29 0 0 0 26 /Times-Roman /font32 ANSIFont font
1972 2289 28 (\231) 28 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2333 629 (multimedia drivers for the Microsoft) 629 SB
32 0 0 29 29 0 0 0 26 /Times-Roman /font32 ANSIFont font
1350 2347 22 (\256) 22 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1372 2333 245 ( Windows NT) 245 SB
32 0 0 29 29 0 0 0 26 /Times-Roman /font32 ANSIFont font
1617 2339 28 (\231) 28 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1645 2333 509 ( operating system. All Win32) 509 SB
721 2383 535 (multimedia drivers contain the ) 535 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1256 2382 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1470 2383 535 ( entry point the system uses for) 535 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 1 def
/wp$fpage (1) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 2 2
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 379 18 (1) 18 SB
277 379 11 (-) 11 SB
288 379 18 (2) 18 SB
306 379 9 ( ) 61 SB
367 379 9 ( ) 61 SB
428 379 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 436 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1348 (loading, installing, and configuring the driver. Topics discussed in this chapter) 1348 SB
634 546 137 (include:) 137 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 623 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 629 736 (Use of the Win32 and kernel-mode drivers) 736 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 690 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 696 77 (The ) 77 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
769 695 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
983 696 723 ( entry point for Win32 multimedia drivers) 723 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 757 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 763 386 (Messages used by the ) 386 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1078 762 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1292 763 197 ( entry point) 197 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 824 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 830 1308 (Actions a multimedia driver should take when responding to these messages) 1308 SB
634 930 753 (Most Win32 multimedia drivers extend the ) 753 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1387 929 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1601 930 360 ( entry point by either) 360 SB
634 980 1424 (adding messages specific to a device type \(for example, MCI drivers\) or by adding) 1424 SB
634 1030 1443 (additional entry points \(for example, audio drivers\). For more information about the) 1443 SB
634 1080 1386 (extended entry points and messages, see the chapter devoted to a specific type of) 1386 SB
634 1130 122 (device.) 122 SB
634 1213 1437 (The MCI, audio, and joystick extensions can use special hardware to enhance basic) 1437 SB
634 1263 1429 (Windows NT functionality: MCI drivers to support hardware to control auditorium) 1429 SB
634 1313 1444 (lighting or control the hardware in an audiovisual presentation; audio device drivers) 1444 SB
634 1363 1448 (to support audio hardware that adds improved fidelity or MIDI capabilities; joystick) 1448 SB
634 1413 1338 (drivers to support new hardware such as an airplane control wheel for a flight) 1338 SB
634 1463 173 (simulator.) 173 SB
634 1546 1409 (Drivers for MCI, audio \(waveform and MIDI\), and joystick devices are Windows) 1409 SB
634 1596 1237 (NT installable drivers. These drivers have the following characteristics:) 1237 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1673 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1679 812 (They load dynamically into memory as needed.) 812 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1740 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1746 1016 (They use a standard set of entry points to handle messages.) 1016 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1807 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1813 1118 (They handle unrecognized messages by using default processing.) 1118 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1874 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1880 885 (They store initialization information in the registry.) 885 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 2001 38 (1) 38 SB
297 2001 923 (.2  About Multimedia Drivers) 923 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 2115 1425 (The MCI provides a device-independent, extensible interface for controlling media) 1425 SB
634 2165 1278 (devices such as audio hardware, videodisc players, and animation players.) 1278 SB
634 2215 1323 (Multimedia device drivers can control media hardware through the low-level) 1323 SB
634 2265 1429 (multimedia API provided by Windows NT, or directly through the MCI services of) 1429 SB
634 2315 1408 (the MMSYSTEM library. Most commonly used devices, such as waveform audio) 1408 SB
634 2365 1426 (and MIDI devices, are controlled through the low-level multimedia API. Chapter 2) 1426 SB
634 2415 1444 (covers the elements of MCI device drivers, and Chapter 3 discusses low-level audio) 1444 SB
634 2465 1016 (drivers. For more information about MCI and API, see the ) 1016 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1650 2465 259 (Programmer\222s) 259 SB
634 2515 178 (Reference) 178 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
812 2515 464 ( of the Windows NT SDK.) 464 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 2 def
/wp$fpage (2) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 3 3
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1224 379 133 (Chapter ) 133 SB
1357 379 18 (1) 18 SB
1375 379 627 (    The Win32 Multimedia Driver Interface) 627 SB
2002 379 9 ( ) 61 SB
2063 379 9 ( ) 61 SB
2124 379 18 (1) 18 SB
2142 379 11 (-) 11 SB
2153 379 18 (3) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 436 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1422 (Depending on its use, a multimedia driver can consist of paired Win32 and kernel-) 1422 SB
721 546 1329 (mode drivers. Only the Win32 program can handle user dialog boxes. Only a) 1329 SB
721 596 1390 (kernel-mode driver can handle interrupts, write to the input and output ports, and) 1390 SB
721 646 181 (use DMA.) 181 SB
721 729 1257 (The Win32 driver exports its entry points, handles driver installation and) 1257 SB
721 779 1349 (configuration, writes configuration parameters to the registry, and uses Win32) 1349 SB
721 829 412 (functions \(for example, ) 412 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1133 828 199 (CreateFile) 199 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1332 829 22 (, ) 22 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1354 828 238 (CloseHandle) 238 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1592 829 22 (, ) 22 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1614 828 181 (WriteFile) 181 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1795 829 58 (, or) 58 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 878 311 (DeviceIoControl) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1032 879 1096 (\) to transfer data to and from the kernel-mode driver. It uses the) 1096 SB
721 929 562 (services functions \(for example, ) 562 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1283 928 267 (CreateService) 267 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1550 929 58 ( or ) 58 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1608 928 234 (StartService) 234 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1842 929 239 (\) to install the) 239 SB
721 979 1342 (kernel-mode driver in the registry and load it. The kernel-mode driver handles) 1342 SB
721 1029 1438 (interrupts, writes to the hardware output ports, reads from the hardware input ports,) 1438 SB
721 1079 562 (and coordinates DMA activities.) 562 SB
721 1162 1427 (If a Win32 driver does not use a dedicated device, it does not need a paired kernel-) 1427 SB
721 1212 1389 (mode driver. For example, the MCICDA CD audio driver uses the standard CD-) 1389 SB
721 1262 1445 (ROM file system so it does not have a paired kernel-mode driver. Conversely, if the) 1445 SB
721 1312 1391 (Drivers application and MMDRV can handle all the user-mode tasks, there is no) 1391 SB
721 1362 1324 (need for a Win32 driver. For example, the MIPS sound drivers do not have a) 1324 SB
721 1412 1240 (Win32 driver. For more information about kernel-mode drivers, see the ) 1240 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1961 1412 135 (Kernel-) 135 SB
721 1462 480 (mode Driver Design Guide) 480 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1201 1462 11 (.) 11 SB
721 1545 1381 (The interface to Windows NT multimedia drivers is always Unicode. Therefore,) 1381 SB
721 1595 1434 (any character strings received or returned must be defined using the wide-character) 1434 SB
721 1645 1227 (versions of the structures they appear in. This can be achieved by using) 1227 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 1734 300 (#define UNICODE) 300 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1820 292 (before including ) 292 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1013 1820 215 (mmsystem.h) 215 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1228 1820 808 ( or \(less preferably\) by using the version of the) 808 SB
721 1870 280 (structure with a ) 280 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1001 1870 48 (W ) 48 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1049 1870 682 (appended to its name, where one exists.) 682 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 3 def
/wp$fpage (3) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 4 4
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 379 18 (1) 18 SB
277 379 11 (-) 11 SB
288 379 18 (4) 18 SB
306 379 9 ( ) 61 SB
367 379 9 ( ) 61 SB
428 379 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 436 B
1 F
n
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 492 32 (1) 32 SB
291 492 1339 (.2.1  Win32 Multimedia Driver Function Overview) 1339 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 588 1422 (A Win32 multimedia driver is a DLL that an application \(or another Windows NT) 1422 SB
634 638 1334 (DLL\) can open, enable, query, disable, and close. Applications perform these) 1334 SB
634 688 781 (operations by calling the following functions:) 781 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 529 63 634 771 CB
634 776 207 (CloseDriver) 207 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 947 63 1164 771 CB
1214 776 247 (Closes a driver.) 247 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 529 63 634 834 CB
634 839 206 (OpenDriver) 206 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 947 63 1164 834 CB
1214 839 243 (Opens a driver.) 243 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 529 63 634 897 CB
634 902 343 (SendDriverMessage) 343 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 947 63 1164 897 CB
1214 902 449 (Sends a message to a driver.) 449 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 989 556 (Driver entry point functions are ) 556 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1190 988 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1404 989 404 ( for installable drivers, ) 404 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1808 988 226 (auxMessage) 226 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1039 548 (for auxiliary audio drivers, and ) 548 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1182 1038 232 (midMessage) 232 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1414 1039 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1498 1038 242 (modMessage) 242 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1740 1039 313 ( for MIDI drivers.) 313 SB
634 1122 1350 (Most functions for multimedia drivers are message-handling routines that pass) 1350 SB
634 1172 1090 (information between a driver and an application. In addition to ) 1090 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1724 1171 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1938 1172 78 ( \(the) 78 SB
634 1222 802 (primary message handler\), these functions are ) 802 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1436 1221 280 (DefDriverProc) 280 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1716 1222 315 (, which provides a) 315 SB
634 1272 650 (default handling of system messages; ) 650 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1284 1271 294 (DriverCallback) 294 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1578 1272 494 (, which sends a message to a) 494 SB
634 1322 588 (window or callback function; and ) 588 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1222 1321 311 (mciDriverNotify) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1533 1322 433 (, which posts notification) 433 SB
634 1372 173 (messages.) 173 SB
634 1455 842 (Other functions handle command tables, such as ) 842 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1476 1454 523 (mciFreeCommandResource) 523 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1999 1455 73 ( and) 73 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1504 534 (mciLoadCommandResource) 534 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1168 1505 742 (. Instance data is set and retrieved by using) 742 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1554 344 (mciSetDriverData) 344 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
978 1555 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1062 1554 354 (mciGetDriverData) 354 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1416 1555 22 (. ) 22 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1438 1554 300 (MciDriverYield) 300 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1738 1555 313 ( allows a driver to) 313 SB
634 1605 749 (check for the break key during its idle loop.) 749 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1713 32 (1) 32 SB
291 1713 1017 (.2.2  Win32 Driver Message Overview) 1017 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1809 522 (When an application calls the ) 522 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1156 1808 227 (OpenDriver) 227 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1383 1809 22 (, ) 22 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1405 1808 377 (SendDriverMessage) 377 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1782 1809 69 (, or ) 69 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1851 1808 229 (CloseDriver) 229 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1859 1449 (function, Win32 processes the call and sends one or more of the following messages) 1449 SB
634 1909 634 (to the appropriate multimedia driver:) 634 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 482 63 634 1992 CB
634 1997 146 (Message) 146 SB
gr
gs 966 63 1117 1992 CB
1167 1997 196 (Description) 196 SB
gr
1448 2 634 2055 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 482 63 634 2062 CB
634 2067 230 (DRV_CLOSE) 230 SB
gr
gs 966 50 1117 2062 CB
1167 2067 855 (Notifies a driver that Windows NT will decrement the) 855 SB
gr
gs 966 46 1117 2112 CB
1167 2113 901 (use count for the driver and send a DRV_FREE message) 901 SB
gr
gs 966 59 1117 2158 CB
1167 2159 364 (if the use count is zero.) 364 SB
gr
gs 482 63 634 2217 CB
634 2222 333 (DRV_CONFIGURE) 333 SB
gr
gs 966 50 1117 2217 CB
1167 2222 905 (Notifies a driver it should display a custom-configuration) 905 SB
gr
gs 966 46 1117 2267 CB
1167 2268 821 (dialog box. \(This message should only be sent if the) 821 SB
gr
gs 966 46 1117 2313 CB
1167 2314 625 (driver returns a nonzero value when the) 625 SB
gr
gs 966 59 1117 2359 CB
1167 2360 841 (DRV_QUERYCONFIGURE message is processed.\)) 841 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 4 def
/wp$fpage (4) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 5 5
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1224 379 133 (Chapter ) 133 SB
1357 379 18 (1) 18 SB
1375 379 627 (    The Win32 Multimedia Driver Interface) 627 SB
2002 379 9 ( ) 61 SB
2063 379 9 ( ) 61 SB
2124 379 18 (1) 18 SB
2142 379 11 (-) 11 SB
2153 379 18 (5) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 436 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
0 0 0 fC
gs 482 63 721 496 CB
721 501 146 (Message) 146 SB
gr
gs 966 63 1204 496 CB
1254 501 196 (Description) 196 SB
gr
481 2 721 559 B
1 F
n
965 2 1204 559 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 482 63 721 566 CB
721 571 271 (DRV_DISABLE) 271 SB
gr
gs 966 63 1204 566 CB
1254 571 610 (Notifies a driver it is about to be freed.) 610 SB
gr
gs 482 63 721 629 CB
721 634 260 (DRV_ENABLE) 260 SB
gr
gs 966 63 1204 629 CB
1254 634 749 (Notifies a driver it has been loaded or reloaded.) 749 SB
gr
gs 482 63 721 692 CB
721 697 202 (DRV_FREE) 202 SB
gr
gs 966 63 1204 692 CB
1254 697 580 (Notifies a driver it will be discarded.) 580 SB
gr
gs 482 63 721 755 CB
721 760 267 (DRV_INSTALL) 267 SB
gr
gs 966 63 1204 755 CB
1254 760 793 (Notifies a driver it has been successfully installed.) 793 SB
gr
gs 482 63 721 818 CB
721 823 215 (DRV_LOAD) 215 SB
gr
gs 966 63 1204 818 CB
1254 823 763 (Notifies a driver it has been successfully loaded.) 763 SB
gr
gs 482 63 721 881 CB
721 886 209 (DRV_OPEN) 209 SB
gr
gs 966 63 1204 881 CB
1254 886 644 (Notifies a driver it is about to be opened.) 644 SB
gr
gs 482 63 721 944 CB
721 949 471 (DRV_QUERYCONFIGURE) 471 SB
gr
gs 966 50 1204 944 CB
1254 949 724 (Queries a driver about whether it supports the) 724 SB
gr
gs 966 46 1204 994 CB
1254 995 882 (DRV_CONFIGURE message and can display a private) 882 SB
gr
gs 966 59 1204 1040 CB
1254 1041 398 (configuration dialog box.) 398 SB
gr
gs 482 63 721 1099 CB
721 1104 274 (DRV_REMOVE) 274 SB
gr
gs 966 50 1204 1099 CB
1254 1104 800 (Notifies a driver it is about to be removed from the) 800 SB
gr
gs 966 59 1204 1149 CB
1254 1150 119 (system.) 119 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1237 1050 (These messages are defined in the Windows NT header file \() 1050 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1771 1237 215 (mmsystem.h) 215 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1986 1237 153 (\) and are) 153 SB
721 1287 443 (processed by the driver\222s ) 443 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1164 1286 225 (DriverProc ) 225 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1389 1287 659 (function, as described in the following) 659 SB
721 1337 132 (section.) 132 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1457 38 (1) 38 SB
384 1457 1241 (.3  Creating a Win32 Multimedia Driver) 1241 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1571 1153 (Every Win32 multimedia driver provides a special entry point, the ) 1153 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1874 1570 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1621 1450 (function. This function processes the driver messages listed in the preceding section.) 1450 SB
721 1671 1346 (This function can also process private driver messages, which can be assigned) 1346 SB
721 1721 1440 (values ranging from DRV_RESERVED to DRV_USER \(two constants that appear) 1440 SB
721 1771 44 (in ) 44 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
765 1771 215 (mmsystem.h) 215 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
980 1771 26 (\).) 26 SB
721 1854 77 (The ) 77 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
798 1853 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1012 1854 1141 ( entry point processes messages sent by the system to the driver as) 1141 SB
721 1904 1337 (the result of an application manipulating the driver itself rather than one of its) 1337 SB
721 1954 1425 (devices. For example, when an application opens an audio driver, the system sends) 1425 SB
721 2004 1003 (the specified driver a DRV_OPEN message. The driver\222s ) 1003 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1724 2003 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1938 2004 197 ( entry point) 197 SB
721 2054 718 (receives and processes this message. The ) 718 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1439 2053 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1653 2054 350 ( function should call) 350 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 2103 291 (DefDriverProc ) 291 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1012 2104 621 (for any messages it does not handle.) 621 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 5 def
/wp$fpage (5) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 6 6
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 379 18 (1) 18 SB
277 379 11 (-) 11 SB
288 379 18 (6) 18 SB
306 379 9 ( ) 61 SB
367 379 9 ( ) 61 SB
428 379 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 436 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 899 (The following example shows the basic structure of ) 899 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1533 495 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1747 496 12 (:) 12 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
634 585 900 (LRESULT DriverProc \(DWORD dwDriverIdentifier,) 900 SB
634 631 680 (                    HDRVR hDriver,) 680 SB
634 677 620 (                    UINT  uMsg,) 620 SB
634 723 680 (                    LONG  lParam1,) 680 SB
634 769 680 (                    LONG  lParam2\)) 680 SB
634 815 20 ({) 20 SB
634 861 320 (   switch \(uMsg\)) 320 SB
634 907 80 (   {) 80 SB
634 953 400 (      case DRV_LOAD:) 400 SB
634 999 580 (          return \(LRESULT\)1L;) 580 SB
634 1045 400 (      case DRV_FREE:) 400 SB
634 1091 560 (         return \(LRESULT\)1L;) 560 SB
634 1137 400 (      case DRV_OPEN:) 400 SB
634 1183 560 (         return \(LRESULT\)1L;) 560 SB
634 1229 420 (      case DRV_CLOSE:) 420 SB
634 1275 560 (         return \(LRESULT\)1L;) 560 SB
634 1321 440 (      case DRV_ENABLE:) 440 SB
634 1367 620 (         /*  Enable the driver.) 620 SB
634 1413 1000 (          *  The driver cannot fail the DRV_ENABLE) 1000 SB
634 1459 1000 (          *  message; the return value is ignored.) 1000 SB
634 1505 240 (          */) 240 SB
634 1551 560 (         return \(LRESULT\)1L;) 560 SB
634 1597 460 (      case DRV_DISABLE:) 460 SB
634 1643 640 (         /*  Disable the driver.) 640 SB
634 1689 240 (          */) 240 SB
634 1735 560 (         return \(LRESULT\)1L;) 560 SB
634 1781 600 (      case DRV_QUERYCONFIGURE:) 600 SB
634 1827 960 (         /*  This driver supports configuration.) 960 SB
634 1873 240 (          */) 240 SB
634 1919 560 (         return \(LRESULT\)1L;) 560 SB
634 1965 500 (      case DRV_CONFIGURE:) 500 SB
634 2011 1220 (          /*  Configure the driver: display a dialog box that) 1220 SB
634 2057 1160 (           *  allows the user to configure the driver. For) 1160 SB
634 2103 1180 (           *  example, setting the port base and interrupt.) 1180 SB
634 2149 1220 (           *  Return DRVCNF_RESTART if the system needs to be) 1220 SB
634 2195 1100 (           *  restarted before the changes take effect.) 1100 SB
634 2241 260 (           */) 260 SB
634 2287 1200 (          return \(LRESULT\)Config\(LOWORD\(lParam1\), ghModule\);) 1200 SB
634 2333 460 (      case DRV_INSTALL:) 460 SB
634 2379 800 (         return \(LRESULT\)DRVCNF_RESTART;) 800 SB
634 2425 440 (      case DRV_REMOVE:) 440 SB
634 2471 1240 (         /*  Remove the driver: the driver's application sends) 1240 SB
634 2517 1260 (          *  this message when the driver is being removed from) 1260 SB
634 2563 1160 (          *  the installed drivers list. The driver should) 1160 SB
634 2609 1060 (          *  remove any registry or .INI information.) 1060 SB
634 2655 240 (          */) 240 SB
634 2701 480 (         ConfigRemove\(\);) 480 SB
634 2747 800 (         return \(LRESULT\)DRVCNF_RESTART;) 800 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 6 def
/wp$fpage (6) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 7 7
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1224 379 133 (Chapter ) 133 SB
1357 379 18 (1) 18 SB
1375 379 627 (    The Win32 Multimedia Driver Interface) 627 SB
2002 379 9 ( ) 61 SB
2063 379 9 ( ) 61 SB
2124 379 18 (1) 18 SB
2142 379 11 (-) 11 SB
2153 379 18 (7) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 436 B
1 F
n
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
721 502 280 (      default:) 280 SB
721 548 1160 (        /* Process any messages not explicitly trapped. */) 1160 SB
721 594 1160 (        return DefDriverProc \(dwDriverIdentifier, hDriver,) 1160 SB
721 640 1080 (                              uMsg, lParam1, lParam2\);) 1080 SB
721 686 100 (    }) 100 SB
721 732 20 (}) 20 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 772 87 (This ) 87 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
808 771 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1022 772 513 ( example calls two functions, ) 513 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1535 771 125 (Config) 125 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1660 772 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1744 771 277 (ConfigRemove) 277 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2021 772 108 (, to do) 108 SB
721 822 1375 (the work of configuring and removing the driver. These functions are part of the) 1375 SB
721 872 1388 (driver. Their implementation depends on the target hardware and the structure of) 1388 SB
721 922 177 (the driver.) 177 SB
721 1005 1403 (Generally, when a driver is enabled, it calls the kernel-mode driver to prepare the) 1403 SB
721 1055 1416 (hardware, allocates any memory it needs, and sets a flag to indicate that the driver) 1416 SB
721 1105 1425 (is enabled. If the driver has not been enabled by WINMM, or if the enable process) 1425 SB
721 1155 1356 (failed, it returns MMSYSERR_NOTENABLED. When a driver is disabled, it) 1356 SB
721 1205 1399 (frees any memory it allocated, calls the kernel-mode driver to reset the hardware,) 1399 SB
721 1255 1186 (and sets a flag to indicate that the driver is not enabled. Although the) 1186 SB
721 1305 1442 (DRV_ENABLE and DRV_DISABLE messages have no meaning in Windows NT,) 1442 SB
721 1355 599 (they are retained for compatibility.) 599 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1463 32 (1) 32 SB
378 1463 652 (.3.1  Opening the Driver) 652 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1559 459 (When an application calls ) 459 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1180 1558 227 (OpenDriver) 227 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1407 1559 635 ( to open the first instance of a driver,) 635 SB
721 1609 1402 (Win32 issues the DRV_LOAD, DRV_ENABLE, and DRV_OPEN messages, in) 1402 SB
721 1659 1357 (that order. Win32 sends only the DRV_OPEN message for subsequent calls to) 1357 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1708 227 (OpenDriver) 227 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
948 1709 11 (.) 11 SB
721 1792 1374 (When the driver processes the DRV_LOAD message, it reads the configuration) 1374 SB
721 1842 1379 (settings \(if any exist\) from the registry and configures the driver. If necessary, it) 1379 SB
721 1892 608 (calls the kernel-mode driver, using ) 608 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1329 1891 311 (DeviceIoControl) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1640 1892 480 (, to initialize any associated) 480 SB
721 1942 1448 (hardware. In response to the DRV_LOAD message, the driver can also allocate any) 1448 SB
721 1992 973 (memory not related to a particular instance of the driver.) 973 SB
721 2075 1425 (After processing the DRV_LOAD message, the driver returns a nonzero value if it) 1425 SB
721 2125 1439 (loads successfully. If it returns zero, Win32 immediately unloads the driver without) 1439 SB
721 2175 551 (issuing a DRV_FREE message.) 551 SB
721 2258 1365 (When the driver processes the DRV_ENABLE message, it prepares associated) 1365 SB
721 2308 1429 (peripherals as required. Win32 drivers indirectly prepare any associated hardware.) 1429 SB
721 2358 1056 (They must call a kernel-mode driver, using functions such as ) 1056 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1777 2357 311 (DeviceIoControl) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2088 2358 55 (, to) 55 SB
721 2408 368 (control the hardware.) 368 SB
721 2491 1298 (When the driver processes the DRV_OPEN message, it allocates resources) 1298 SB
721 2541 1347 (required by a single instance of the driver, using Win32 API functions such as) 1347 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 2590 233 (VirtualAlloc) 233 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
954 2591 11 (.) 11 SB
721 2674 1331 (For more information about functions a driver can use to communicate with a) 1331 SB
721 2724 579 (kernel-mode driver, see the SDK.) 579 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 7 def
/wp$fpage (7) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 8 8
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 379 18 (1) 18 SB
277 379 11 (-) 11 SB
288 379 18 (8) 18 SB
306 379 9 ( ) 61 SB
367 379 9 ( ) 61 SB
428 379 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 436 B
1 F
n
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 492 32 (1) 32 SB
291 492 629 (.3.2  Closing the Driver) 629 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 588 1422 (Win32 issues the DRV_CLOSE, DRV_DISABLE, and DRV_FREE messages, in) 1422 SB
634 638 1443 (that order, to close the last instance of a driver. \(When the application is not closing) 1443 SB
634 688 1224 (the last instance of the driver, only the DRV_CLOSE message is sent.\)) 1224 SB
634 771 1402 (When the driver processes the DRV_CLOSE message, it frees any resources that) 1402 SB
634 821 1410 (were allocated for the corresponding DRV_OPEN message and returns a nonzero) 1410 SB
634 871 1412 (value. A driver can choose to fail the DRV_CLOSE message by returning a value) 1412 SB
634 921 731 (of zero, although this is not recommended.) 731 SB
634 1004 1410 (When the driver processes the DRV_DISABLE message, it places any associated) 1410 SB
634 1054 1441 (peripherals in an inactive state. Win32 drivers deactivate hardware indirectly. They) 1441 SB
634 1104 1353 (must use a kernel-mode driver to control the hardware, using functions such as) 1353 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1153 311 (DeviceIoControl) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
945 1154 11 (.) 11 SB
634 1237 1418 (When the driver processes the DRV_FREE message, it frees all resources that are) 1418 SB
634 1287 243 (still allocated.) 243 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1395 32 (1) 32 SB
291 1395 1018 (.3.3  Default Processing of Messages) 1018 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1491 1072 (Any messages a driver does not process should be handled by ) 1072 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1706 1490 291 (DefDriverProc.) 291 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1997 1491 87 ( This) 87 SB
634 1541 1052 (function returns default values for each message it processes.) 1052 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 8 def
/wp$fpage (8) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 9 9
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1224 379 133 (Chapter ) 133 SB
1357 379 18 (1) 18 SB
1375 379 627 (    The Win32 Multimedia Driver Interface) 627 SB
2002 379 9 ( ) 61 SB
2063 379 9 ( ) 61 SB
2124 379 18 (1) 18 SB
2142 379 11 (-) 11 SB
2153 379 18 (9) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 436 B
1 F
n
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 492 32 (1) 32 SB
378 492 747 (.3.4  Configuring the Driver) 747 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 588 1401 (Multimedia drivers can support a private configuration dialog box that allows the) 1401 SB
721 638 1357 (user to configure the driver and any associated hardware. A driver receives the) 1357 SB
721 688 1358 (DRV_QUERYCONFIGURE message when an application inquires whether a) 1358 SB
721 738 1425 (driver supports such a dialog box. If the driver is configurable, it returns a nonzero) 1425 SB
721 788 1207 (value for the message. If the driver is not configurable, it returns zero.) 1207 SB
721 871 1401 (A driver receives the DRV_CONFIGURE message when an application requests) 1401 SB
721 921 1437 (the configuration dialog box to be displayed. In response to this message, the driver) 1437 SB
721 971 1443 (should display its dialog box and process user input. Drivers maintain configuration) 1443 SB
721 1021 944 (data specified by the user in the Windows NT registry.) 944 SB
721 1104 1433 (When configuration is complete, the driver can return DRV_OK, DRV_CANCEL,) 1433 SB
721 1154 1353 (or DRV_RESTART. If the user accepts a configuration, a driver should return) 1353 SB
721 1204 1349 (DRV_OK. If the user cancels configuration, or if the driver does not support a) 1349 SB
721 1254 1206 (dialog box, it should return DRV_CANCEL. The driver should return) 1206 SB
721 1304 1440 (DRV_RESTART only if the user needs to restart the system for the changes to take) 1440 SB
721 1354 108 (effect.) 108 SB
721 1437 1345 (For information about registry entries, installation, configuration, and setup of) 1345 SB
721 1487 271 (drivers, see the ) 271 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
992 1487 378 (Programmer\222s Guide) 378 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1370 1487 781 (. For information about functions that display) 781 SB
721 1537 863 (dialog boxes and process user input, see the SDK.) 863 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 9 def
/wp$fpage (9) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 10 10
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 379 18 (1) 18 SB
277 379 11 (-) 11 SB
288 379 36 (10) 36 SB
324 379 9 ( ) 61 SB
385 379 9 ( ) 61 SB
446 379 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 436 B
1 F
n
32 0 0 63 63 1 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1189 582 339 (BLANK PAGE) 339 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 755 1391 (IMPORTANT: This text will appear on screen, but will not) 1391 SB
634 828 700 (print on a PostScript printer.) 700 SB
634 934 1449 (This page should be the last one in this file; it was inserted) 1449 SB
634 1007 965 (by running the InsertBlankPage macro.) 965 SB
634 1113 1091 (Do not type any additional text on this page!) 1091 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 10 def
/wp$fpage (10) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def
1 setgray 41.5 73 moveto 0 646 rlineto 529 0 rlineto 0 646 neg rlineto closepath fill
 grestore
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 10 def
/wp$fpage (10) def
/wp$date (07/19/93) def
/wp$time (05:19 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%Trailer
SVDoc restore
end
%%Pages: 10
% TrueType font name key:
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT31c1cf = 0887DArial NarrowF00000028000002bc0000
%    MSTT31c1db = 0887DTimes New RomanF00000019000001900000
%    MSTT31c1e8 = 0887DTimes New RomanF00000015000001900000
%    MSTT31c1f5 = 0887DTimes New RomanF00000032000001900000
%    MSTT31c202 = 0887DTimes New RomanF00000000000001900000
%    MSTT31c20f = 0887DArial NarrowF0000002c000002bc0000
%    MSTT31c21b = 0887DArial NarrowF00000021000002bc0000
%    MSTT31c227 = 0887DTimes New RomanF0000002c000001900000
%    MSTT31c234 = 0887DTimes New RomanF00000021000001900000
%    MSTT31c1c1 = 0887DArial NarrowF00000064000002bc0000
%    MSTT31c241 = 0887DArial NarrowF00000026000001900000
%    MSTT31c24d = 0887DArial NarrowF00000053000002bc0000
%    MSTT31c267 = 0887DTimes New RomanF0000001d000001900000
%    MSTT31c274 = 0887DTimes New RomanF0000002c000002bc0000
%    MSTT31c281 = 0887DMSIconsF00000028000001900000
%    MSTT31c28c = 0887DTimes New RomanF0000002c000001900001
%    MSTT31c299 = 0887DLucida Sans TypewriterF00000021000001900000
%    MSTT31c2a8 = 0887DArial NarrowF00000047000002bc0000
%    MSTT31c2b4 = 0887DTimes New RomanF00000028000002bc0000
%    MSTT31c2c1 = 0887DTimes New RomanF00000028000001900000
%    MSTT31c2ce = 0887DTimes New RomanF00000011000001900000
%    MSTT31c2db = 0887DArial NarrowF0000003f000002bc0000
%%DocumentSuppliedResources: procset Win35Dict 3 1

%%DocumentNeededResources: font Helvetica-Narrow
%%+ font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman

%%EOF
