%!PS-Adobe-3.0
%%Creator: Windows PSCRIPT
%%Title: Microsoft Word - 502MCID.DOC
%%BoundingBox: 14 9 597 784
%%DocumentNeededResources: (atend)
%%DocumentSuppliedResources: (atend)
%%Pages: (atend)
%%BeginResource: procset Win35Dict 3 1
/Win35Dict 290 dict def Win35Dict begin/bd{bind def}bind def/in{72
mul}bd/ed{exch def}bd/ld{load def}bd/tr/translate ld/gs/gsave ld/gr
/grestore ld/M/moveto ld/L/lineto ld/rmt/rmoveto ld/rlt/rlineto ld
/rct/rcurveto ld/st/stroke ld/n/newpath ld/sm/setmatrix ld/cm/currentmatrix
ld/cp/closepath ld/ARC/arcn ld/TR{65536 div}bd/lj/setlinejoin ld/lc
/setlinecap ld/ml/setmiterlimit ld/sl/setlinewidth ld/scignore false
def/sc{scignore{pop pop pop}{0 index 2 index eq 2 index 4 index eq
and{pop pop 255 div setgray}{3{255 div 3 1 roll}repeat setrgbcolor}ifelse}ifelse}bd
/FC{bR bG bB sc}bd/fC{/bB ed/bG ed/bR ed}bd/HC{hR hG hB sc}bd/hC{
/hB ed/hG ed/hR ed}bd/PC{pR pG pB sc}bd/pC{/pB ed/pG ed/pR ed}bd/sM
matrix def/PenW 1 def/iPen 5 def/mxF matrix def/mxE matrix def/mxUE
matrix def/mxUF matrix def/fBE false def/iDevRes 72 0 matrix defaultmatrix
dtransform dup mul exch dup mul add sqrt def/fPP false def/SS{fPP{
/SV save def}{gs}ifelse}bd/RS{fPP{SV restore}{gr}ifelse}bd/EJ{gsave
showpage grestore}bd/#C{userdict begin/#copies ed end}bd/FEbuf 2 string
def/FEglyph(G  )def/FE{1 exch{dup 16 FEbuf cvrs FEglyph exch 1 exch
putinterval 1 index exch FEglyph cvn put}for}bd/SM{/iRes ed/cyP ed
/cxPg ed/cyM ed/cxM ed 72 100 div dup scale dup 0 ne{90 eq{cyM exch
0 eq{cxM exch tr -90 rotate -1 1 scale}{cxM cxPg add exch tr +90 rotate}ifelse}{cyP
cyM sub exch 0 ne{cxM exch tr -90 rotate}{cxM cxPg add exch tr -90
rotate 1 -1 scale}ifelse}ifelse}{pop cyP cyM sub exch 0 ne{cxM cxPg
add exch tr 180 rotate}{cxM exch tr 1 -1 scale}ifelse}ifelse 100 iRes
div dup scale 0 0 transform .25 add round .25 sub exch .25 add round
.25 sub exch itransform translate}bd/SJ{1 index 0 eq{pop pop/fBE false
def}{1 index/Break ed div/dxBreak ed/fBE true def}ifelse}bd/ANSIVec[
16#0/grave 16#1/acute 16#2/circumflex 16#3/tilde 16#4/macron 16#5/breve
16#6/dotaccent 16#7/dieresis 16#8/ring 16#9/cedilla 16#A/hungarumlaut
16#B/ogonek 16#C/caron 16#D/dotlessi 16#27/quotesingle 16#60/grave
16#7C/bar 16#82/quotesinglbase 16#83/florin 16#84/quotedblbase 16#85
/ellipsis 16#86/dagger 16#87/daggerdbl 16#88/circumflex 16#89/perthousand
16#8A/Scaron 16#8B/guilsinglleft 16#8C/OE 16#91/quoteleft 16#92/quoteright
16#93/quotedblleft 16#94/quotedblright 16#95/bullet 16#96/endash 16#97
/emdash 16#98/tilde 16#99/trademark 16#9A/scaron 16#9B/guilsinglright
16#9C/oe 16#9F/Ydieresis 16#A0/space 16#A1/exclamdown 16#A4/currency
16#A5/yen 16#A6/brokenbar 16#A7/section 16#A8/dieresis 16#A9/copyright
16#AA/ordfeminine 16#AB/guillemotleft 16#AC/logicalnot 16#AD/hyphen
16#AE/registered 16#AF/macron 16#B0/degree 16#B1/plusminus 16#B2/twosuperior
16#B3/threesuperior 16#B4/acute 16#B5/mu 16#B6/paragraph 16#B7/periodcentered
16#B8/cedilla 16#B9/onesuperior 16#BA/ordmasculine 16#BB/guillemotright
16#BC/onequarter 16#BD/onehalf 16#BE/threequarters 16#BF/questiondown
16#C0/Agrave 16#C1/Aacute 16#C2/Acircumflex 16#C3/Atilde 16#C4/Adieresis
16#C5/Aring 16#C6/AE 16#C7/Ccedilla 16#C8/Egrave 16#C9/Eacute 16#CA
/Ecircumflex 16#CB/Edieresis 16#CC/Igrave 16#CD/Iacute 16#CE/Icircumflex
16#CF/Idieresis 16#D0/Eth 16#D1/Ntilde 16#D2/Ograve 16#D3/Oacute 16#D4
/Ocircumflex 16#D5/Otilde 16#D6/Odieresis 16#D7/multiply 16#D8/Oslash
16#D9/Ugrave 16#DA/Uacute 16#DB/Ucircumflex 16#DC/Udieresis 16#DD/Yacute
16#DE/Thorn 16#DF/germandbls 16#E0/agrave 16#E1/aacute 16#E2/acircumflex
16#E3/atilde 16#E4/adieresis 16#E5/aring 16#E6/ae 16#E7/ccedilla 16#E8
/egrave 16#E9/eacute 16#EA/ecircumflex 16#EB/edieresis 16#EC/igrave
16#ED/iacute 16#EE/icircumflex 16#EF/idieresis 16#F0/eth 16#F1/ntilde
16#F2/ograve 16#F3/oacute 16#F4/ocircumflex 16#F5/otilde 16#F6/odieresis
16#F7/divide 16#F8/oslash 16#F9/ugrave 16#FA/uacute 16#FB/ucircumflex
16#FC/udieresis 16#FD/yacute 16#FE/thorn 16#FF/ydieresis ] def/reencdict
12 dict def/IsChar{basefontdict/CharStrings get exch known}bd/MapCh{dup
IsChar not{pop/bullet}if newfont/Encoding get 3 1 roll put}bd/MapDegree{16#b0
/degree IsChar{/degree}{/ring}ifelse MapCh}bd/MapBB{16#a6/brokenbar
IsChar{/brokenbar}{/bar}ifelse MapCh}bd/ANSIFont{reencdict begin/newfontname
ed/basefontname ed FontDirectory newfontname known not{/basefontdict
basefontname findfont def/newfont basefontdict maxlength dict def basefontdict{exch
dup/FID ne{dup/Encoding eq{exch dup length array copy newfont 3 1 roll
put}{exch newfont 3 1 roll put}ifelse}{pop pop}ifelse}forall newfont
/FontName newfontname put 127 1 159{newfont/Encoding get exch/bullet
put}for ANSIVec aload pop ANSIVec length 2 idiv{MapCh}repeat MapDegree
MapBB newfontname newfont definefont pop}if newfontname end}bd/SB{FC
/ULlen ed/str ed str length fBE not{dup 1 gt{1 sub}if}if/cbStr ed
/dxGdi ed/y0 ed/x0 ed str stringwidth dup 0 ne{/y1 ed/x1 ed y1 y1
mul x1 x1 mul add sqrt dxGdi exch div 1 sub dup x1 mul cbStr div exch
y1 mul cbStr div}{exch abs neg dxGdi add cbStr div exch}ifelse/dyExtra
ed/dxExtra ed x0 y0 M fBE{dxBreak 0 BCh dxExtra dyExtra str awidthshow}{dxExtra
dyExtra str ashow}ifelse fUL{x0 y0 M dxUL dyUL rmt ULlen fBE{Break
add}if 0 mxUE transform gs rlt cyUL sl [] 0 setdash st gr}if fSO{x0
y0 M dxSO dySO rmt ULlen fBE{Break add}if 0 mxUE transform gs rlt cyUL
sl [] 0 setdash st gr}if n/fBE false def}bd/font{/name ed/Ascent ed
0 ne/fT3 ed 0 ne/fSO ed 0 ne/fUL ed/Sy ed/Sx ed 10.0 div/ori ed -10.0
div/esc ed/BCh ed name findfont/xAscent 0 def/yAscent Ascent def/ULesc
esc def ULesc mxUE rotate pop fT3{/esc 0 def xAscent yAscent mxUE transform
/yAscent ed/xAscent ed}if [Sx 0 0 Sy neg xAscent yAscent] esc mxE
rotate mxF concatmatrix makefont setfont [Sx 0 0 Sy neg 0 Ascent] mxUE
mxUF concatmatrix pop fUL{currentfont dup/FontInfo get/UnderlinePosition
known not{pop/Courier findfont}if/FontInfo get/UnderlinePosition get
1000 div 0 exch mxUF transform/dyUL ed/dxUL ed}if fSO{0 .3 mxUF transform
/dySO ed/dxSO ed}if fUL fSO or{currentfont dup/FontInfo get/UnderlineThickness
known not{pop/Courier findfont}if/FontInfo get/UnderlineThickness get
1000 div Sy mul/cyUL ed}if}bd/min{2 copy gt{exch}if pop}bd/max{2 copy
lt{exch}if pop}bd/CP{/ft ed{{ft 0 eq{clip}{eoclip}ifelse}stopped{currentflat
1 add setflat}{exit}ifelse}loop}bd/patfont 10 dict def patfont begin
/FontType 3 def/FontMatrix [1 0 0 -1 0 0] def/FontBBox [0 0 16 16]
def/Encoding StandardEncoding def/BuildChar{pop pop 16 0 0 0 16 16
setcachedevice 16 16 false [1 0 0 1 .25 .25]{pat}imagemask}bd end/p{
/pat 32 string def{}forall 0 1 7{dup 2 mul pat exch 3 index put dup
2 mul 1 add pat exch 3 index put dup 2 mul 16 add pat exch 3 index
put 2 mul 17 add pat exch 2 index put pop}for}bd/pfill{/PatFont patfont
definefont setfont/ch(AAAA)def X0 64 X1{Y1 -16 Y0{1 index exch M ch
show}for pop}for}bd/vert{X0 w X1{dup Y0 M Y1 L st}for}bd/horz{Y0 w
Y1{dup X0 exch M X1 exch L st}for}bd/fdiag{X0 w X1{Y0 M X1 X0 sub dup
rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup rlt st}for}bd/bdiag{X0 w
X1{Y1 M X1 X0 sub dup neg rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup
neg rlt st}for}bd/AU{1 add cvi 15 or}bd/AD{1 sub cvi -16 and}bd/SHR{pathbbox
AU/Y1 ed AU/X1 ed AD/Y0 ed AD/X0 ed}bd/hfill{/w iRes 37.5 div round
def 0.1 sl [] 0 setdash n dup 0 eq{horz}if dup 1 eq{vert}if dup 2 eq{fdiag}if
dup 3 eq{bdiag}if dup 4 eq{horz vert}if 5 eq{fdiag bdiag}if}bd/F{/ft
ed fm 256 and 0 ne{gs FC ft 0 eq{fill}{eofill}ifelse gr}if fm 1536
and 0 ne{SHR gs HC ft CP fm 1024 and 0 ne{/Tmp save def pfill Tmp restore}{fm
15 and hfill}ifelse gr}if}bd/S{PenW sl PC st}bd/m matrix def/GW{iRes
12 div PenW add cvi}bd/DoW{iRes 50 div PenW add cvi}bd/DW{iRes 8 div
PenW add cvi}bd/SP{/PenW ed/iPen ed iPen 0 eq iPen 6 eq or{[] 0 setdash}if
iPen 1 eq{[DW GW] 0 setdash}if iPen 2 eq{[DoW GW] 0 setdash}if iPen
3 eq{[DW GW DoW GW] 0 setdash}if iPen 4 eq{[DW GW DoW GW DoW GW] 0
setdash}if}bd/E{m cm pop tr scale 1 0 moveto 0 0 1 0 360 arc cp m sm}bd
/AG{/sy ed/sx ed sx div 4 1 roll sy div 4 1 roll sx div 4 1 roll sy
div 4 1 roll atan/a2 ed atan/a1 ed sx sy scale a1 a2 ARC}def/A{m cm
pop tr AG m sm}def/P{m cm pop tr 0 0 M AG cp m sm}def/RRect{n 4 copy
M 3 1 roll exch L 4 2 roll L L cp}bd/RRCC{/r ed/y1 ed/x1 ed/y0 ed/x0
ed x0 x1 add 2 div y0 M x1 y0 x1 y1 r arcto 4{pop}repeat x1 y1 x0 y1
r arcto 4{pop}repeat x0 y1 x0 y0 r arcto 4{pop}repeat x0 y0 x1 y0 r
arcto 4{pop}repeat cp}bd/RR{2 copy 0 eq exch 0 eq or{pop pop RRect}{2
copy eq{pop RRCC}{m cm pop/y2 ed/x2 ed/ys y2 x2 div 1 max def/xs x2
y2 div 1 max def/y1 exch ys div def/x1 exch xs div def/y0 exch ys div
def/x0 exch xs div def/r2 x2 y2 min def xs ys scale x0 x1 add 2 div
y0 M x1 y0 x1 y1 r2 arcto 4{pop}repeat x1 y1 x0 y1 r2 arcto 4{pop}repeat
x0 y1 x0 y0 r2 arcto 4{pop}repeat x0 y0 x1 y0 r2 arcto 4{pop}repeat
m sm cp}ifelse}ifelse}bd/PP{{rlt}repeat}bd/OB{gs 0 ne{7 3 roll/y ed
/x ed x y translate ULesc rotate x neg y neg translate x y 7 -3 roll}if
sc B fill gr}bd/B{M/dy ed/dx ed dx 0 rlt 0 dy rlt dx neg 0 rlt cp}bd
/CB{B clip n}bd/ErrHandler{errordict dup maxlength exch length gt
dup{errordict begin}if/errhelpdict 12 dict def errhelpdict begin/stackunderflow(operand stack underflow)def
/undefined(this name is not defined in a dictionary)def/VMerror(you have used up all the printer's memory)def
/typecheck(operator was expecting a different type of operand)def
/ioerror(input/output error occured)def end{end}if errordict begin
/handleerror{$error begin newerror{/newerror false def showpage 72
72 scale/x .25 def/y 9.6 def/Helvetica findfont .2 scalefont setfont
x y moveto(Offending Command = )show/command load{dup type/stringtype
ne{(max err string)cvs}if show}exec/y y .2 sub def x y moveto(Error = )show
errorname{dup type dup( max err string )cvs show( : )show/stringtype
ne{( max err string )cvs}if show}exec errordict begin errhelpdict errorname
known{x 1 add y .2 sub moveto errhelpdict errorname get show}if end
/y y .4 sub def x y moveto(Stack =)show ostack{/y y .2 sub def x 1
add y moveto dup type/stringtype ne{( max err string )cvs}if show}forall
showpage}if end}def end}bd end
%%EndResource
/SVDoc save def
%%EndProlog
%%BeginSetup
Win35Dict begin
ErrHandler
statusdict begin 0 setjobtimeout end
statusdict begin statusdict /jobname (Microsoft Word - 502MCID.DOC) put end
/oldDictCnt countdictstack def {}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
/oldDictCnt countdictstack def {letter
}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
[{ }
/exec load currenttransfer /exec load] cvx settransfer
%%EndSetup
%%Page: 1 1
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 50 50 0 0 0 45 /Times-Roman /font32 ANSIFont font
0 0 0 fC
346 491 33 (C) 58 SB
404 491 36 (H) 61 SB
465 491 35 (A) 60 SB
525 491 28 (P) 53 SB
578 491 31 (T) 56 SB
634 491 31 (E) 56 SB
690 491 33 (R) 58 SB
748 491 13 ( ) 38 SB
786 491 25 (2) 50 SB
32 0 0 100 100 0 0 0 93 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 1400 513 346 604 CB
346 602 242 (Win32) 242 SB
gr
32 0 0 38 38 0 0 0 35 /Helvetica-Narrow /font15 ANSIFont font
gs 1400 513 346 604 CB
588 616 31 (\231) 31 SB
gr
32 0 0 100 100 0 0 0 93 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 1400 513 346 604 CB
619 602 480 ( MCI Drivers) 480 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1117 1422 (This chapter discusses the contents of an MCI driver and how to add to and extend) 1422 SB
721 1167 1268 (the MCI command set. For an overview of MCI and how to use it, see the) 1268 SB
721 1217 170 (Microsoft) 170 SB
32 0 0 29 29 0 0 0 26 /Times-Roman /font32 ANSIFont font
891 1231 22 (\256) 22 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
913 1217 245 ( Windows NT) 245 SB
32 0 0 29 29 0 0 0 26 /Times-Roman /font32 ANSIFont font
1158 1223 28 (\231) 28 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1186 1217 110 ( SDK ) 110 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1296 1217 448 (Programmer\222s Reference) 448 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1744 1217 422 (. This chapter covers the) 422 SB
721 1267 290 (following topics:) 290 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1344 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1350 176 (Using the ) 176 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
955 1349 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1169 1350 524 ( entry point for MCI messages) 524 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1411 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1417 426 (Handling MCI messages) 426 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1478 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1484 833 (Responding to the required and basic commands) 833 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1545 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1551 869 (Responding to commands for specific device types) 869 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1612 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1618 676 (Responding to the wait and notify flags) 676 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1679 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1685 496 (Adding new MCI commands) 496 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1746 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1752 777 (Functions available for use with MCI drivers) 777 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1873 38 (2) 38 SB
384 1873 959 (.1  The MCI Driver Entry Point) 959 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1987 355 (MCI drivers use the ) 355 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1076 1986 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1290 1987 854 ( entry point to handle messages for MCI services.) 854 SB
721 2037 1288 (MCI augments the messages needed by the system to install, initialize, and) 1288 SB
721 2087 1262 (configure the driver with MCI-specific messages. This chapter contains a) 1262 SB
721 2137 1348 (description of the messages added by MCI. Although this section mentions the) 1348 SB
721 2187 1338 (messages used by the system, it does so only in relation to the MCI messages.) 1338 SB
721 2237 1346 (Additional information, such as the following, can be found in other locations:) 1346 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2314 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2320 453 (For information about the ) 453 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1232 2319 225 (DriverProc ) 225 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1457 2320 711 (interface used by the system, see Chapter) 711 SB
779 2370 33 (1.) 33 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2431 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2437 749 (For information about the return values for ) 749 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1528 2436 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1742 2437 365 (, see the function and) 365 SB
779 2487 782 (message reference for MCI commands in the ) 782 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1561 2487 439 (Win32 Subsystem Driver) 439 SB
779 2537 178 (Reference) 178 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
957 2537 11 (.) 11 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 1 def
/wp$fpage (1) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow
%%+ font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 2 2
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 18 (2) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 40 40 0 0 0 46 /MSIcons2 font
0 0 0 fC
gs 653 3231 0 0 CB
634 490 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 496 895 (For information about general error returns, see the ) 895 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1587 495 354 (mciSendCommand) 354 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 546 377 (function listing in the ) 377 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1069 546 628 (Win32 Subsystem Driver Reference) 628 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1697 546 11 (.) 11 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 607 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 613 1350 (For information about errors specific to opening a device, see the MCI_OPEN) 1350 SB
692 663 381 (message listing in the ) 381 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1073 663 639 (Win32 Subsystem Driver Reference.) 639 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 763 477 (The high-order word of the ) 477 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1111 762 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1325 763 412 ( return value is used by ) 412 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1737 762 275 (mciSendString) 275 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2012 763 44 ( to) 44 SB
634 813 1043 (translate information returned in the data structure used with) 1043 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1677 813 164 ( lParam2) 164 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1841 813 180 (. For more) 180 SB
634 863 890 (information about data structures, see section 4.2.7.) 890 SB
634 946 1290 (If a driver uses a command set already defined for the device type, existing) 1290 SB
634 996 1439 (command tables convert the command strings to command messages, and the driver) 1439 SB
634 1046 1448 (only needs the handler for the command messages. MCI automatically translates the) 1448 SB
634 1096 1441 (command strings to the command messages. If this is the case, see sections 2.2, 2.3,) 1441 SB
634 1146 826 (and 2.4, which discuss handling MCI messages.) 826 SB
634 1229 1373 (If a driver extends command messages or adds new command messages, it must) 1373 SB
634 1279 1327 (extend the command tables as well as write the message handler. Writing the) 1327 SB
634 1329 1400 (message handler is described in the sections on handling MCI messages \(sections) 1400 SB
634 1379 1410 (2.2, 2.3, and 2.4\). Creating a new message or extending a message is described in) 1410 SB
634 1429 198 (section 2.5.) 198 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1549 38 (2) 38 SB
297 1549 566 (.2  MCI Messages) 566 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1663 936 (The MCI commands fall into the following categories:) 936 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1740 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
692 1746 362 (Required commands) 362 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1054 1746 995 (, handled by the driver, are supported by all MCI devices.) 995 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1807 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
692 1813 298 (Basic commands) 298 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
990 1813 732 ( are optionally supported by some devices.) 732 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1874 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
692 1880 365 (Extended commands) 365 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1057 1880 994 ( are specific to a device type or device class, for example,) 994 SB
692 1930 1373 (videodisc players. This category covers unique commands as well as extensions) 1373 SB
692 1980 630 (to the required and basic commands.) 630 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 2041 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
692 2047 323 (System commands) 323 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1015 2047 940 ( are handled directly by MCI rather than by the driver.) 940 SB
634 2147 1403 (A driver must support all required command messages. These messages represent) 1403 SB
634 2197 792 (the minimum command set for an MCI driver.) 792 SB
634 2280 1387 (Although a driver may optionally support the basic commands, it must recognize) 1387 SB
634 2330 1372 (and respond to all of them. If a driver does not support one of these messages, it) 1372 SB
634 2380 1318 (must return the error code MCI_UNSUPPORTED_FUNCTION. If a device) 1318 SB
634 2430 1279 (supports a basic command, it must support a defined set of options for that) 1279 SB
634 2480 177 (command.) 177 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 2 def
/wp$fpage (2) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 3 3
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1519 378 133 (Chapter ) 133 SB
1652 378 18 (2) 18 SB
1670 378 323 (    Win32 MCI Drivers) 323 SB
1993 378 9 ( ) 61 SB
2054 378 9 ( ) 61 SB
2115 378 9 ( ) 9 SB
2124 378 18 (2) 18 SB
2142 378 11 (-) 11 SB
2153 378 18 (3) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1343 (A driver can add options to the required or basic command sets, or create new) 1343 SB
721 546 1361 (command messages to form an extended command set. If the driver extends the) 1361 SB
721 596 1414 (command set for an existing device type, it should base the extended command set) 1414 SB
721 646 1369 (on one already defined. For example, a driver for a new videodisc player would) 1369 SB
721 696 1311 (base its extended commands on the commands already defined for videodisc) 1311 SB
721 746 136 (players.) 136 SB
721 829 402 (MCI, not the Microsoft) 402 SB
32 0 0 29 29 0 0 0 26 /Times-Roman /font32 ANSIFont font
1123 843 22 (\256) 22 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1145 829 130 ( Win32) 130 SB
32 0 0 29 29 0 0 0 26 /Times-Roman /font32 ANSIFont font
1275 835 28 (\231) 28 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1303 829 855 ( subsystem driver, responds to system commands.) 855 SB
721 912 1107 (The SDK lists required, basic, extended, and system commands.) 1107 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1020 32 (2) 32 SB
378 1020 615 (.2.1  Opening a Device) 615 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1116 1302 (Win32 services open a driver after MCI receives an MCI_OPEN command) 1302 SB
721 1166 1351 (message from an application. Win32 checks to determine whether the driver is) 1351 SB
721 1216 1359 (loaded, and, if not, it sends the DRV_LOAD and DRV_ENABLE messages to) 1359 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1265 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
935 1266 1208 ( to prepare the driver for use. A driver uses the DRV_LOAD message) 1208 SB
721 1316 1424 (to load custom command tables. \(For more information about these tables and how) 1424 SB
721 1366 1320 (to load them, see Section 2.5.5.\) When the driver is loaded, Win32 sends the) 1320 SB
721 1416 944 (DRV_OPEN and MCI_OPEN_DRIVER messages to ) 944 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1665 1415 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1879 1416 11 (.) 11 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 1513 29 (2) 29 SB
750 1513 675 (.2.1.1  Handling DRV_OPEN) 675 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1595 747 (For the DRV_OPEN message, Win32 sets ) 747 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1468 1595 332 (dwDriverIdentifier) 332 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1800 1595 252 ( to 0L and sets) 252 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
721 1645 140 (hDriver) 140 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
861 1645 741 ( to the driver handle it creates. Win32 sets ) 741 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1602 1645 153 (lParam1) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1755 1645 383 ( to a pointer to a zero-) 383 SB
721 1695 1107 (terminated string containing configuration information, and sets ) 1107 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1828 1695 153 (lParam2) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1981 1695 75 ( to a) 75 SB
721 1745 1134 (pointer to an MCI_OPEN_DRIVER_PARMS data structure. The) 1134 SB
721 1795 1359 (MCI_OPEN_DRIVER_PARMS structure contains information such as device) 1359 SB
721 1845 1447 (identifier, identifier to a device type-specific parsing table, and a handle to a custom) 1447 SB
721 1895 1206 (command table, if the driver uses one. For more information about the) 1206 SB
721 1945 885 (MCI_OPEN_DRIVER_PARMS structure, see the ) 885 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1606 1945 115 (Win32) 115 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1721 1945 11 ( ) 11 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1732 1945 313 (Subsystem Driver) 313 SB
721 1995 178 (Reference) 178 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
899 1995 100 (. Use ) 100 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
999 1994 534 (mciLoadCommandResource) 534 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1533 1995 430 ( to load command tables.) 430 SB
721 2078 1362 (After assigning values to the members of MCI_OPEN_DRIVER_PARMS, the) 1362 SB
721 2128 1345 (driver completes any other necessary tasks, such as allocating global memory.) 1345 SB
721 2178 1401 (Control of the physical device is handled by calling the kernel-mode driver, using) 1401 SB
721 2228 306 (functions such as ) 306 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1027 2227 311 (DeviceIoControl) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1338 2228 11 (.) 11 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 3 def
/wp$fpage (3) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 4 4
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 18 (4) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
634 493 29 (2) 29 SB
663 493 883 (.2.1.2  Handling MCI_OPEN_DRIVER) 883 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 575 1410 (After the MCI_OPEN message, the next message the driver receives from MCI is) 1410 SB
634 625 1182 (MCI_OPEN_DRIVER. Drivers can ignore the MCI_OPEN_TYPE,) 1182 SB
634 675 1230 (MCI_OPEN_TYPE_ID, and MCI_OPEN_ALIAS flags, as well as the) 1230 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 724 309 (lpstrDeviceType) 309 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
943 725 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1027 724 183 (lpstrAlias) 183 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1210 725 759 ( members of the MCI_OPEN_PARMS data) 759 SB
634 775 1357 (structure. For more information about the other flags and parameters used with) 1357 SB
634 825 554 (MCI_OPEN_DRIVER, see the ) 554 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1188 825 628 (Win32 Subsystem Driver Reference) 628 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1816 825 11 (.) 11 SB
634 908 1309 (Drivers should return MCIERR_UNSUPPORTED_FUNCTION to fail any) 1309 SB
634 958 1446 (messages not supported when a compound device is opened as a simple device. This) 1446 SB
634 1008 1166 (could happen if an application opens a compound driver without the) 1166 SB
634 1058 1306 (MCI_OPEN_ELEMENT flag to query it with the MCI_GETDEVCAPS or) 1306 SB
634 1108 373 (MCI_INFO message.) 373 SB
634 1191 1342 (Both simple and compound devices allocate memory needed for operation and) 1342 SB
634 1241 353 (associate it with the ) 353 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
987 1241 215 (dwDriverID) 215 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1202 1241 500 ( value when they are opened.) 500 SB
634 1324 1369 (Unless the application uses the MCI_WAIT flag, the driver should return to the) 1369 SB
634 1374 1255 (application as soon as it verifies that it can open successfully. During the) 1255 SB
634 1424 1252 (verification, it should check for any conditions that might prevent it from) 1252 SB
634 1474 1404 (completing the open. If the driver returns to the application before it is fully open,) 1404 SB
634 1524 1415 (any verification should be complete enough to avoid returning a no-error value for) 1415 SB
634 1574 1423 (MCI_OPEN_DRIVER and later posting the MM_MCINOTIFY message with the) 1423 SB
634 1624 1418 (MCI_NOTIFY_FAILURE flag. \(The MM_MCINOTIFY message is described in) 1418 SB
634 1674 1427 (the SDK.\) For example, a driver might need to load a large file from CD-ROM for) 1427 SB
634 1724 1423 (its operation. To return the driver to the application as soon as possible, the checks) 1423 SB
634 1774 1413 (performed for the open sequence might verify only that the file can be loaded. The) 1413 SB
634 1824 1385 (actual loading of the file can wait until after the driver returns to the application.) 1385 SB
634 1874 1392 (Some of the checks required would include verifying that enough memory can be) 1392 SB
634 1924 1342 (allocated, verifying that the CD-ROM is functional, and verifying that the file) 1342 SB
634 1974 413 (exists on the CD-ROM.) 413 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 4 def
/wp$fpage (4) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 5 5
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1519 378 133 (Chapter ) 133 SB
1652 378 18 (2) 18 SB
1670 378 323 (    Win32 MCI Drivers) 323 SB
1993 378 9 ( ) 61 SB
2054 378 9 ( ) 61 SB
2115 378 9 ( ) 9 SB
2124 378 18 (2) 18 SB
2142 378 11 (-) 11 SB
2153 378 18 (5) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
721 493 29 (2) 29 SB
750 493 768 (.2.1.3  Opening Shared Devices) 768 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 575 1332 (The MCI_OPEN_SHAREABLE flag requests that the driver be shared. This) 1332 SB
721 625 1418 (allows unrestricted access to simple devices by applications. As a shared device, a) 1418 SB
721 675 1440 (driver must create only one context for the mode and position of the MCI device for) 1440 SB
721 725 1422 (all applications using it. The shared context enables each application to change the) 1422 SB
721 775 1362 (mode and position of the MCI device. MCI creates a unique device ID for each) 1362 SB
721 825 499 (shared instance of the driver.) 499 SB
721 908 1125 (For drivers that control simple devices, the following rules apply:) 1125 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 985 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 991 972 (If the device cannot be shared, fail the open by returning) 972 SB
779 1041 754 (MCIERR_UNSUPPORTED_FUNCTION.) 754 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1102 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1108 872 (If the driver is initially opened as shareable, return) 872 SB
779 1158 1330 (MCIERR_MUST_USE_SHAREABLE to fail any subsequent opens without) 1330 SB
779 1208 649 (the MCI_OPEN_SHAREABLE flag.) 649 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1269 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1275 1329 (If the driver is initially opened as nonshareable, fail any subsequent opens by) 1329 SB
779 1325 870 (returning MCIERR_MUST_USE_SHAREABLE.) 870 SB
721 1425 1409 (For compound devices, the MCI_OPEN_SHAREABLE flag applies to the device) 1409 SB
721 1475 1368 (element. \(Compound drivers opened without a device element should ignore the) 1368 SB
721 1525 1433 (MCI_OPEN_SHAREABLE flag.\) A shared element allows several applications to) 1433 SB
721 1575 1406 (access the same context for the file element. All applications accessing the shared) 1406 SB
721 1625 1428 (context have equal control over the element. If a compound driver cannot support a) 1428 SB
721 1675 853 (shared element context, fail the open by returning) 853 SB
721 1725 754 (MCIERR_UNSUPPORTED_FUNCTION.) 754 SB
721 1808 1198 (Follow the guidelines listed below for elements of compound devices:) 1198 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1885 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1891 1199 (If an element of a driver is initially opened as a shared context, return) 1199 SB
779 1941 1383 (MCIERR_MUST_USE_SHAREABLE to fail subsequent opens of that element) 1383 SB
779 1991 1116 (context that do not include the MCI_OPEN_SHAREABLE flag.) 1116 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2052 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2058 1322 (If an element context is initially opened as nonshareable, fail any subsequent) 1322 SB
779 2108 899 (opens with MCIERR_MUST_USE_SHAREABLE.) 899 SB
721 2208 1395 (Drivers can also let applications open a single device element \(file\) several times) 1395 SB
721 2258 1410 (without using the MCI_OPEN_SHAREABLE flag. In this case, the driver should) 1410 SB
721 2308 1413 (treat each instance of the device element as a wholly separate device element. The) 1413 SB
721 2358 1399 (driver should maintain separate position and status information for each instance.) 1399 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 5 def
/wp$fpage (5) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Roman
%%Page: 6 6
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 18 (6) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 492 32 (2) 32 SB
291 492 592 (.2.2  Closing a Device) 592 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 588 1356 (For nonshared simple devices, a close message corresponds directly to an open) 1356 SB
634 638 1427 (message. These drivers should prepare to close when they receive a close message.) 1427 SB
634 721 1448 (For nonshared compound devices, a close message for a device element corresponds) 1448 SB
634 771 1444 (directly to an open message for that element. These drivers should close the element) 1444 SB
634 821 362 (corresponding to the ) 362 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
996 821 215 (dwDriverID) 215 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1211 821 811 (. Even when all device elements are closed, the) 811 SB
634 871 1387 (driver can remain open if an application also opened it without a device element.) 1387 SB
634 921 1434 (Nonshared compound drivers should not prepare to close until all applications have) 1434 SB
634 971 215 (closed them.) 215 SB
634 1054 1436 (Drivers also need to keep track of multiple applications opening shared devices and) 1436 SB
634 1104 1413 (device elements. The close messages received for these cases indicate only that an) 1413 SB
634 1154 1392 (application is finished using the device or device element. Other applications can) 1392 SB
634 1204 1349 (have these devices and device elements open and will continue to access them.) 1349 SB
634 1254 1433 (These drivers should not prepare to close until all applications that have opened the) 1433 SB
634 1304 1335 (devices have closed them. For example, a driver could keep track of an active) 1335 SB
634 1354 1335 (application by maintaining a count of the number of times it has been opened.) 1335 SB
634 1437 1372 (The system sends the DRV_FREE message when all applications have closed a) 1372 SB
634 1487 1313 (driver. Use this message to ensure that the driver is properly closed before it) 1313 SB
634 1537 1423 (terminates. If the driver registered a custom command table, it should free it at this) 1423 SB
634 1587 86 (time.) 86 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1695 32 (2) 32 SB
291 1695 1614 (.2.3  Synchronous vs. Asynchronous Message Processing) 1614 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1791 1400 (Typically, a driver returns control to the application immediately after processing) 1400 SB
634 1841 1422 (the command message. For many devices, control returns to the application even if) 1422 SB
634 1891 1358 (it takes several minutes for the hardware to complete the action initiated by the) 1358 SB
634 1941 177 (command.) 177 SB
634 2024 1340 (If a driver receives the MCI_WAIT flag, it must delay returning to the calling) 1340 SB
634 2074 1396 (application while the device completes the action requested. While a driver waits) 1396 SB
634 2124 858 (for the device to finish, it should periodically call ) 858 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1492 2123 294 (mciDriverYield) 294 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1786 2124 228 ( to let Win32) 228 SB
634 2174 414 (check for the break key.) 414 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 6 def
/wp$fpage (6) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 7 7
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1519 378 133 (Chapter ) 133 SB
1652 378 18 (2) 18 SB
1670 378 323 (    Win32 MCI Drivers) 323 SB
1993 378 9 ( ) 61 SB
2054 378 9 ( ) 61 SB
2115 378 9 ( ) 9 SB
2124 378 18 (2) 18 SB
2142 378 11 (-) 11 SB
2153 378 18 (7) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 492 32 (2) 32 SB
378 492 866 (.2.4  Notifying Clients of Events) 866 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 588 1365 (The MCI_NOTIFY flag directs the driver to return immediately and to post the) 1365 SB
721 638 1443 (MM_MCINOTIFY message when the requested action is complete. An MCI driver) 1443 SB
721 688 635 (responds to client applications using ) 635 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1356 687 311 (mciDriverNotify) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1667 688 344 (. When the action is) 344 SB
721 738 1310 (complete, notify the callback function specified by the application, using the) 1310 SB
721 788 301 (following syntax:) 301 SB
721 871 287 (BOOL WINAPI) 287 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1008 870 333 ( mciDriverNotify ) 333 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1341 871 15 (\() 15 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1356 871 559 (hCallback, wDeviceID, wStatus) 559 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1915 871 15 (\)) 15 SB
721 954 77 (The ) 77 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
798 954 181 (hCallback) 181 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
979 954 1127 ( parameter specifies the handle to the window associated with the) 1127 SB
721 1004 396 (callback function. The ) 396 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1117 1003 228 (dwCallBack) 228 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1345 1004 735 ( member of the data structure sent with the) 735 SB
721 1054 1009 (message contains this handle. Specify the device ID in the ) 1009 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1730 1054 199 (wDeviceID) 199 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1929 1054 195 ( parameter.) 195 SB
721 1104 77 (The ) 77 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
798 1104 135 (wStatus) 135 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
933 1104 1228 ( parameter specifies the status of the notification. The status can be one) 1228 SB
721 1154 47 (of:) 47 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1231 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1237 1334 (MCI_NOTIFY_SUCCESSFUL\227when the driver successfully completes the) 1334 SB
779 1287 309 (actions requested.) 309 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1348 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1354 1292 (MCI_NOTIFY_SUPERSEDED\227when an application sends another MCI) 1292 SB
779 1404 1368 (message with the MCI_NOTIFY flag before the driver meets the conditions for) 1368 SB
779 1454 1331 (the first notify. In this case, the driver calls the pending callback function and) 1331 SB
779 1504 1307 (resets the callback conditions to correspond to the new command requesting) 1307 SB
779 1554 208 (notification.) 208 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1615 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1621 1272 (MCI_NOTIFY_ABORTED\227when an application sends a command that) 1272 SB
779 1671 1300 (prevents the callback conditions from being satisfied. For example, the stop) 1300 SB
779 1721 1273 (command would cancel a notification pending for the \223play to 500 notify\224) 1273 SB
779 1771 177 (command.) 177 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1832 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1838 1307 (MCI_NOTIFY_FAILURE\227when a hardware failure prevents the callback) 1307 SB
779 1888 542 (conditions from being satisfied.) 542 SB
721 1988 1380 (When a driver receives a command using MCI_NOTIFY, it should verify that it) 1380 SB
721 2038 1395 (can successfully complete the command before it returns to the application. If the) 1395 SB
721 2088 1361 (driver anticipates an error, the driver should fail and not return any notification) 1361 SB
721 2138 110 (status.) 110 SB
721 2221 1074 (Perform the following tasks to handle the MCI_NOTIFY flag:) 1074 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2298 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2304 856 (Determine whether the MCI_NOTIFY flag is set.) 856 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2365 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2371 1298 (Set up an appropriate mechanism \(such as a timer or an event\) to determine) 1298 SB
779 2421 814 (when the device has finished the specified task.) 814 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 7 def
/wp$fpage (7) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 8 8
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 18 (8) 18 SB
306 378 9 ( ) 61 SB
367 378 9 ( ) 61 SB
428 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 40 40 0 0 0 46 /MSIcons2 font
0 0 0 fC
gs 653 3231 0 0 CB
634 490 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 496 1070 (Return control to the application while notification is pending.) 1070 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 557 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 563 1359 (When the task finishes, notify the application-specified callback function using) 1359 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
692 612 311 (mciDriverNotify) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1003 613 11 (.) 11 SB
634 713 1430 (The following example shows how to determine whether the MCI_NOTIFY flag is) 1430 SB
634 763 103 (set in ) 103 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
737 763 153 (lParam1) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
890 763 12 (:) 12 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
634 852 640 (wStatus = MCI_NOTIFY_SUCCESSFUL;) 640 SB
634 898 500 (if \(lParam1 & MCI_NOTIFY\)) 500 SB
634 944 1040 (    mciDriverNotify \(hCallBack, uDeviceID, wStatus\);) 1040 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1030 1178 (This code checks for the MCI_NOTIFY flag and, if it is found, calls) 1178 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1079 311 (mciDriverNotify) 311 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
945 1080 1096 ( to send the status message to the application-specified callback) 1096 SB
634 1130 1339 (function. This example is appropriate if no significant processing or hardware) 1339 SB
634 1180 946 (delays are associated with responding to the command.) 946 SB
634 1263 1396 (Drivers must take a different approach to handle actions that require a noticeable) 1396 SB
634 1313 1439 (delay before completion. For example, a driver could set a timer to periodically call) 1439 SB
634 1363 1397 (a timer function that interrogates the status of the device. After the driver sets the) 1397 SB
634 1413 901 (timer, it can return control to the calling application.) 901 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1521 32 (2) 32 SB
291 1521 939 (.2.5  Obtaining Device Information) 939 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1617 1386 (The MCI_INFO message requests the driver to return string information about a) 1386 SB
634 1667 477 (device. Flags used with the ) 477 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1111 1667 153 (lParam1) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1264 1667 241 ( parameter of ) 241 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1505 1666 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1719 1667 327 ( specify the type of) 327 SB
634 1717 1408 (information a driver should return. The MCI_INFO_PRODUCT flag requests the) 1408 SB
634 1767 1382 (product information from the driver. This should include the manufacturer of the) 1382 SB
634 1817 1446 (hardware and, if possible, the model information. If a driver applies to a device type) 1446 SB
634 1867 1346 (rather than a specific device, it should return the long name of the device type.) 1346 SB
634 1950 1340 (An application supplies a pointer to an MCI_INFO_PARMS data structure in) 1340 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
634 2000 153 (lParam2) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
787 2000 747 (. This structure has the following members:) 747 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
634 2089 320 (typedef struct {) 320 SB
634 2135 1020 (    DWORD  dwCallback;   // Callback for MCI_NOTIFY) 1020 SB
634 2181 1240 (    LPWSTR  lpstrReturn; // Pointer to information returned to) 1240 SB
634 2227 780 (                         // application) 780 SB
634 2273 1260 (    DWORD  dwRetSize;    // Size of application supplied buffer) 1260 SB
634 2319 340 (} MCI_INFO_PARMS;) 340 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 2405 77 (The ) 77 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
711 2404 221 (lpstrReturn) 221 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
932 2405 1145 ( member of this data structure contains a pointer to an application-) 1145 SB
634 2455 795 (supplied buffer whose size is indicated by the ) 795 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1429 2454 196 (dwRetSize) 196 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1625 2455 428 ( member. Use this buffer) 428 SB
634 2505 1318 (to return a zero-terminated string containing the information from the driver.) 1318 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 8 def
/wp$fpage (8) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 9 9
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1519 378 133 (Chapter ) 133 SB
1652 378 18 (2) 18 SB
1670 378 323 (    Win32 MCI Drivers) 323 SB
1993 378 9 ( ) 61 SB
2054 378 9 ( ) 61 SB
2115 378 9 ( ) 9 SB
2124 378 18 (2) 18 SB
2142 378 11 (-) 11 SB
2153 378 18 (9) 18 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1429 (Drivers can define other flags that extend the MCI_INFO message to request other) 1429 SB
721 546 1405 (information. If a driver does this, however, it should not use MCI_INFO to return) 1405 SB
721 596 1345 (information available with the MCI_STATUS message. For more information) 1345 SB
721 646 664 (about MCI_INFO_PARAMS, see the ) 664 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1385 646 502 (Subsystem Driver Reference) 502 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1887 646 11 (.) 11 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 754 32 (2) 32 SB
378 754 1315 (.2.6  Determining Driver and Device Capabilities) 1315 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 850 1420 (Drivers receive the MCI_GETDEVCAPS message from an application requesting) 1420 SB
721 900 721 (the capabilities of a device and its driver. ) 721 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1442 900 153 (lParam2) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1595 900 399 ( specifies a pointer to a) 399 SB
721 950 1415 (MCI_GETDEVCAPS_PARMS data structure, which has the following members:) 1415 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 1039 320 (typedef struct {) 320 SB
721 1085 1000 (    DWORD  dwCallback;  // Callback for MCI_NOTIFY) 1000 SB
721 1131 1100 (    DWORD  dwReturn;    // Information returned to user) 1100 SB
721 1177 1240 (    DWORD  dwItem;      // Flag specifying type of information) 1240 SB
721 1223 460 (} MCI_GETDEVCAPS_PARMS;) 460 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1309 704 (The driver returns the information in the ) 704 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1425 1308 187 (dwReturn) 187 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1612 1309 238 ( member. The) 238 SB
721 1359 1168 (MCI_GETDEVCAPS_ITEM flag sent by the application validates ) 1168 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1889 1358 142 (dwItem) 142 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2031 1359 88 (. The) 88 SB
721 1409 199 (contents of ) 199 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
920 1408 142 (dwItem) 142 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1062 1409 979 ( specify the type of information requested. The following) 979 SB
721 1459 966 (constants are always defined for MCI_GETDEVCAPS:) 966 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 767 63 721 1542 CB
721 1547 245 (MCI Constant) 245 SB
gr
gs 681 63 1489 1542 CB
1539 1547 196 (Description) 196 SB
gr
1448 2 721 1605 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 767 63 721 1612 CB
721 1617 641 (MCI_GETDEVCAPS_CAN_RECORD) 641 SB
gr
gs 681 50 1489 1612 CB
1539 1617 471 (TRUE if device has recording) 471 SB
gr
gs 681 46 1489 1662 CB
1539 1663 623 (capabilities.TRUE also implies that the) 623 SB
gr
gs 681 59 1489 1708 CB
1539 1709 603 (driver has stop and pause capabilities.) 603 SB
gr
gs 767 63 721 1767 CB
721 1772 601 (MCI_GETDEVCAPS_HAS_AUDIO) 601 SB
gr
gs 681 50 1489 1767 CB
1539 1772 467 (TRUE if the device has audio) 467 SB
gr
gs 681 59 1489 1817 CB
1539 1818 191 (capabilities.) 191 SB
gr
gs 767 63 721 1876 CB
721 1881 596 (MCI_GETDEVCAPS_HAS_VIDEO) 596 SB
gr
gs 681 50 1489 1876 CB
1539 1881 465 (TRUE if the device has video) 465 SB
gr
gs 681 59 1489 1926 CB
1539 1927 191 (capabilities.) 191 SB
gr
gs 767 63 721 1985 CB
721 1990 594 (MCI_GETDEVCAPS_USES_FILES) 594 SB
gr
gs 681 50 1489 1985 CB
1539 1990 576 (TRUE if the driver uses files. TRUE) 576 SB
gr
gs 681 46 1489 2035 CB
1539 2036 487 (also implies that the driver is a) 487 SB
gr
gs 681 59 1489 2081 CB
1539 2082 287 (compound device.) 287 SB
gr
gs 767 50 721 2140 CB
721 2145 745 (MCI_GETDEVCAPS_COMPOUND_DEVIC) 745 SB
gr
gs 767 59 721 2190 CB
721 2191 24 (E) 24 SB
gr
gs 681 50 1489 2140 CB
1539 2145 487 (TRUE if the driver uses device) 487 SB
gr
gs 681 59 1489 2190 CB
1539 2191 150 (elements.) 150 SB
gr
gs 767 63 721 2249 CB
721 2254 637 (MCI_GETDEVCAPS_DEVICE_TYPE) 637 SB
gr
gs 681 63 1489 2249 CB
1539 2254 371 (Returns the driver type.) 371 SB
gr
gs 767 63 721 2312 CB
721 2317 592 (MCI_GETDEVCAPS_CAN_EJECT) 592 SB
gr
gs 681 63 1489 2312 CB
1539 2317 628 (TRUE if the device can eject the media.) 628 SB
gr
gs 767 63 721 2375 CB
721 2380 581 (MCI_GETDEVCAPS_CAN_PLAY) 581 SB
gr
gs 681 50 1489 2375 CB
1539 2380 521 (TRUE if the device has playback) 521 SB
gr
gs 681 46 1489 2425 CB
1539 2426 575 (capabilities. TRUE also implies that) 575 SB
gr
gs 681 46 1489 2471 CB
1539 2472 460 (the driver has stop and pause) 460 SB
gr
gs 681 59 1489 2517 CB
1539 2518 191 (capabilities.) 191 SB
gr
gs 767 63 721 2576 CB
721 2581 582 (MCI_GETDEVCAPS_CAN_SAVE) 582 SB
gr
gs 681 63 1489 2576 CB
1539 2581 529 (TRUE if the driver can save data.) 529 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 9 def
/wp$fpage (9) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 10 10
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (10) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1226 (For more information about MCI_GETDEVCAPS_PARAMS, see the ) 1226 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1860 496 115 (Win32) 115 SB
634 546 502 (Subsystem Driver Reference) 502 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1136 546 11 (.) 11 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 654 32 (2) 32 SB
291 654 1167 (.2.7  Determining Device and Driver Status) 1167 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 750 1303 (A driver receives the MCI_STATUS message when an application requests) 1303 SB
634 800 570 (the status of a device and driver. ) 570 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1204 800 153 (lParam2) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1357 800 413 ( contains a pointer to an) 413 SB
634 850 1204 (MCI_STATUS_PARMS data structure. This structure contains a flag) 1204 SB
634 900 1244 (specifying the type of information requested by the application. A driver) 1244 SB
634 950 637 (can return the following information:) 637 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1027 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1033 1365 (The current mode of the device. This could include not ready, pause, play, stop,) 1365 SB
692 1083 370 (open, record, or seek.) 370 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1144 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1150 1289 (Device type-specific information such as current track number, total media) 1289 SB
692 1200 1382 (length, total number of playable tracks, current position in the media or track, or) 1382 SB
692 1250 575 (current time format of the device.) 575 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1371 38 (2) 38 SB
297 1371 980 (.3  Device-Specific Operations) 980 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1485 1305 (In addition to the required command messages, each driver supports a set of) 1305 SB
634 1535 1417 (command messages specific to its device type. Where possible, these type-specific) 1417 SB
634 1585 1264 (\(or basic\) commands are identical between types. For example, the basic ) 1264 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1898 1584 80 (play) 80 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1635 1288 (command is identical for videodisc and videotape players. Support of these) 1288 SB
634 1685 1322 (commands is optional. However, if a driver does support a command, it must) 1322 SB
634 1735 1350 (respond to all the options listed for that command. For more information about) 1350 SB
634 1785 794 (required and type-specific commands, see the ) 794 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1428 1785 628 (Win32 Subsystem Driver Reference) 628 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2056 1785 11 (.) 11 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1893 32 (2) 32 SB
291 1893 1223 (.3.1  Pause, Play, Record, Resume, and Stop) 1223 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1989 1430 (The MCI_PLAY and MCI_RECORD messages request a device to play or record.) 1430 SB
634 2039 1446 (If a flag is not specified, the driver should assume the current position to be the start) 1446 SB
634 2089 1358 (position and the end of the media to be the stop position. The MCI_FROM and) 1358 SB
634 2139 1401 (MCI_TO flags override the default positions. The units assigned to these position) 1401 SB
634 2189 1331 (values depend on the device and the options set with the MCI_SET command) 1331 SB
634 2239 156 (message.) 156 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 10 def
/wp$fpage (10) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 11 11
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (11) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1338 (The MCI_STOP command requests a device to stop playing or recording. If a) 1338 SB
721 546 1335 (driver supports MCI_STOP, it should also support MCI_PAUSE. If possible,) 1335 SB
721 596 1417 (MCI_PAUSE should only suspend operation and leave the device ready to resume) 1417 SB
721 646 584 (playing or recording immediately.) 584 SB
721 729 1352 (Drivers can include the MCI_RESUME command message to restart a paused) 1352 SB
721 779 1380 (device. This command does not change the stop position. An application can use) 1380 SB
721 829 1443 (MCI_PLAY or MCI_RECORD to resume operation from a stopped or paused state) 1443 SB
721 879 1391 (for the respective modes. These commands resume operation under the following) 1391 SB
721 929 189 (conditions:) 189 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1006 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1012 1143 (The MCI_FROM flag is absent or it specifies the current position.) 1143 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1073 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1079 950 (The MCI_TO flag specifies the position set previously.) 950 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1140 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1146 833 (The play or recording direction does not change.) 833 SB
721 1246 1307 (Pausing and resuming a device does not change notification for the play and) 1307 SB
721 1296 1335 (recording commands. These command messages do not prevent a device from) 1335 SB
721 1346 1401 (obtaining the notification conditions\227they only delay the command. Therefore, a) 1401 SB
721 1396 1237 (paused device can reach the notification conditions after it has resumed.) 1237 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 1493 29 (2) 29 SB
750 1493 1061 (.3.1.1  Creating New Files for MCI_RECORD) 1061 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1575 1314 (If a compound device supports recording, an application can open the device) 1314 SB
721 1625 1420 (without specifying a name for the device element. In this case, the application uses) 1420 SB
721 1675 1439 (the MCI_OPEN_ELEMENT flag with a zero-length, zero-terminated string for the) 1439 SB
721 1725 1409 (element name. Recorded data is not saved in a permanent file until the application) 1409 SB
721 1775 1331 (explicitly saves it with the MCI_SAVE command, specifying the name of the) 1331 SB
721 1825 267 (destination file.) 267 SB
721 1908 1370 (If a driver does not support recording without a device element being defined, it) 1370 SB
721 1958 931 (should detect the zero-length element name and return) 931 SB
721 2008 663 (MCIERR_FILENAME_REQUIRED.) 663 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 2116 32 (2) 32 SB
378 2116 864 (.3.2  Setting Device Information) 864 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2212 1423 (Drivers receive the MCI_SET command message from applications that set device) 1423 SB
721 2262 223 (information. ) 223 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
944 2262 153 (lParam2) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1097 2262 977 ( contains a pointer to an MCI_SET data structure, which) 977 SB
721 2312 1386 (supplies the location of the calling routine, time format or position indicator, and) 1386 SB
721 2362 1393 (audio channel affected. For specific information about constants for time formats) 1393 SB
721 2412 856 (and default time formats for MCI drivers, see the ) 856 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1577 2412 439 (Win32 Subsystem Driver) 439 SB
721 2462 178 (Reference) 178 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
899 2462 11 (.) 11 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 11 def
/wp$fpage (11) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 12 12
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (12) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 491 38 (2) 38 SB
297 491 1771 (.4  Extended Command Messages and Data Structures) 1771 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 605 1354 (Extended command messages apply to device types such as animation devices,) 1354 SB
634 655 1353 (which have capabilities not present in most types of MCI devices. Many of the) 1353 SB
634 705 1212 (required and basic commands are extended to use capabilities such as:) 1212 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 782 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 788 552 (working with MCI element files) 552 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 849 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 855 559 (device operation and positioning) 559 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 916 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 922 421 (windowed video devices) 421 SB
634 1022 1344 (If a driver uses an extended command, it must support the flags common to all) 1344 SB
634 1072 1399 (devices using the command. If a driver does not support an extended command, it) 1399 SB
634 1122 1430 (should return MCIERR_UNRECOGNIZED_COMMAND. For an enumeration of) 1430 SB
634 1172 592 (extended MCI commands, see the ) 592 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1226 1172 459 (Programmer\222s Reference ) 459 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1685 1172 208 (of the SDK.) 208 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1280 32 (2) 32 SB
291 1280 683 (.4.1  MCI Data Structures) 683 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1376 1149 (For a complete description of defined MCI data structures, see the ) 1149 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1783 1376 115 (Win32) 115 SB
634 1426 502 (Subsystem Driver Reference) 502 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1136 1426 859 (. A driver can define additional data structures, or) 859 SB
634 1476 1450 (redefine existing data structures to add new members. This section outlines the rules) 1450 SB
634 1526 993 (a driver must follow to extend the defined data structures.) 993 SB
634 1609 553 (The data structures used for the ) 553 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1187 1609 153 (lParam2) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1340 1609 700 ( parameter all have similar organization.) 700 SB
634 1659 1412 (All the members in these data structures are based on the size of DWORDs. \(Any) 1412 SB
634 1709 1430 (members of the WORD type are DWORD aligned, and any members of the RECT) 1430 SB
634 1759 1209 (type occupy the space of two DWORDs.\) The first member is always ) 1209 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1843 1758 222 (dwCallback) 222 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1809 1428 (and is used for the callback function associated with the MCI_NOTIFY flag. If the) 1428 SB
634 1859 1386 (data structure returns data from the driver, the data-return members immediately) 1386 SB
634 1909 1347 (follow the first member. If the data structure passes data to the driver from the) 1347 SB
634 1959 1374 (application, the data-transfer members immediately follow any return members.) 1374 SB
634 2042 996 (There are four possible arrangements for return members:) 996 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 2119 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 2125 1310 (If a command message does not have return data, the data structure does not) 1310 SB
692 2175 387 (have a return member.) 387 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 2236 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 2242 1283 (If a command message returns integer data, the second member of the data) 1283 SB
692 2292 567 (structure is reserved for the data.) 567 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 12 def
/wp$fpage (12) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 13 13
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (13) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 40 40 0 0 0 46 /MSIcons2 font
0 0 0 fC
gs 740 3231 0 0 CB
721 490 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 496 1360 (If a command message returns string data, the second and third members of the) 1360 SB
779 546 1352 (data structure are reserved. The second member is reserved for a pointer to the) 1352 SB
779 596 1335 (zero-terminated return string. The third member is reserved for the size of the) 1335 SB
779 646 1384 (return buffer. The application is responsible for creating the buffer for the return) 1384 SB
779 696 109 (string.) 109 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 757 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 763 1289 (If a command message returns RECT data, the data occupies members two) 1289 SB
779 813 1335 (through five of the data structure. The second and third members are reserved) 1335 SB
779 863 1278 (for the top-left values of the RECT data. The fourth and fifth members are) 1278 SB
779 913 944 (reserved for the bottom-right values of the RECT data.) 944 SB
721 1013 1429 (Any data passed to the driver follows the return members. A driver should not read) 1429 SB
721 1063 1411 (data from a member in these data structures unless the member is validated with a) 1411 SB
721 1113 1370 (flag. Without the flag, data in the structure might not be valid. For example, the) 1370 SB
721 1163 762 (MCI_OPEN_ELEMENT flag validates the ) 762 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1483 1162 353 (lpstrElementName) 353 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1836 1163 259 ( member of the) 259 SB
721 1213 645 (MCI_OPEN_PARMS data structure.) 645 SB
721 1296 1427 (If an application does not use any of the members of a data structure, it can specify) 1427 SB
721 1346 187 (NULL for ) 187 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
908 1346 153 (lParam2) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1061 1346 11 (.) 11 SB
721 1429 1330 (Commands that extend the data structures add new members to the end of the) 1330 SB
721 1479 1443 (existing data structures. The names used for extended structures add the device type) 1443 SB
721 1529 1436 (to the name of the data type. For example, the extended MCI_OPEN_PARMS data) 1436 SB
721 1579 1380 (structure for animation devices uses MCI_ANIM_OPEN_PARMS as the name.) 1380 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1687 32 (2) 32 SB
378 1687 1451 (.4.2  Returning Information in the MCI Data Structure) 1451 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1783 1333 (When an MCI data structure returns integer information that also has a string) 1333 SB
721 1833 1395 (equivalent, MCI uses the string ID to find it in the resource table. The high-order) 1395 SB
721 1883 1424 (word of the return member is set to the string ID. The low-order word of the return) 1424 SB
721 1933 662 (member is set to the return value. The ) 662 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1383 1932 473 (MAKEMCIRESOURCE) 473 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1856 1933 292 ( macro combines) 292 SB
721 1983 1344 (these values. For example, the following statement assigns information for the) 1344 SB
721 2033 709 (songpointer format to the return member:) 709 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 2122 1200 (lpStatus->dwReturn = MAKEMCIRESOURCE\(MCI_SEQ_FORMAT_SONGPTR,) 1200 SB
721 2168 1260 (                                     MCI_SEQ_FORMAT_SONGPTR_S\);) 1260 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2254 638 (Many of the return values defined in ) 638 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1359 2254 215 (mmsystem.h) 215 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1574 2254 527 ( also have a string resource ID) 527 SB
721 2304 182 (defined in ) 182 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
903 2304 161 (mmddk.h) 161 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1064 2304 970 (. Identifiers used only for return values and are not input) 970 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 13 def
/wp$fpage (13) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 14 14
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (14) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1313 (parameters will typically have only one version \(they do not have a resource) 1313 SB
634 546 1351 (identifier with the _S suffix\). The following string resource IDs are defined by) 1351 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
634 596 161 (mmddk.h) 161 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
795 596 12 (:) 12 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 724 63 634 679 CB
634 684 327 (String Resource ID) 327 SB
gr
gs 724 63 1359 679 CB
1409 684 245 (MCI Constant) 245 SB
gr
1448 2 634 742 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 724 63 634 749 CB
634 754 614 (MCI_FORMAT_MILLISECONDS_S) 614 SB
gr
gs 724 63 1359 749 CB
1409 754 572 (MCI_FORMAT_MILLISECONDS) 572 SB
gr
gs 724 63 634 812 CB
634 817 410 (MCI_FORMAT_HMS_S) 410 SB
gr
gs 724 63 1359 812 CB
1409 817 368 (MCI_FORMAT_HMS) 368 SB
gr
gs 724 63 634 875 CB
634 880 404 (MCI_FORMAT_MSF_S) 404 SB
gr
gs 724 63 1359 875 CB
1409 880 362 (MCI_FORMAT_MSF) 362 SB
gr
gs 724 63 634 938 CB
634 943 484 (MCI_FORMAT_FRAMES_S) 484 SB
gr
gs 724 63 1359 938 CB
1409 943 442 (MCI_FORMAT_FRAMES) 442 SB
gr
gs 724 63 634 1001 CB
634 1006 511 (MCI_FORMAT_SMPTE_24_S) 511 SB
gr
gs 724 63 1359 1001 CB
1409 1006 469 (MCI_FORMAT_SMPTE_24) 469 SB
gr
gs 724 63 634 1064 CB
634 1069 511 (MCI_FORMAT_SMPTE_25_S) 511 SB
gr
gs 724 63 1359 1064 CB
1409 1069 469 (MCI_FORMAT_SMPTE_25) 469 SB
gr
gs 724 63 634 1127 CB
634 1132 511 (MCI_FORMAT_SMPTE_30_S) 511 SB
gr
gs 724 63 1359 1127 CB
1409 1132 469 (MCI_FORMAT_SMPTE_30) 469 SB
gr
gs 724 63 634 1190 CB
634 1195 618 (MCI_FORMAT_SMPTE_30DROP_S) 618 SB
gr
gs 724 63 1359 1190 CB
1409 1195 576 (MCI_FORMAT_SMPTE_30DROP) 576 SB
gr
gs 724 63 634 1253 CB
634 1258 448 (MCI_FORMAT_BYTES_S) 448 SB
gr
gs 724 63 1359 1253 CB
1409 1258 406 (MCI_FORMAT_BYTES) 406 SB
gr
gs 724 63 634 1316 CB
634 1321 502 (MCI_FORMAT_SAMPLES_S) 502 SB
gr
gs 724 63 1359 1316 CB
1409 1321 460 (MCI_FORMAT_SAMPLES) 460 SB
gr
gs 724 63 634 1379 CB
634 1384 427 (MCI_FORMAT_TMSF_S) 427 SB
gr
gs 724 63 1359 1379 CB
1409 1384 385 (MCI_FORMAT_TMSF) 385 SB
gr
gs 724 63 634 1442 CB
634 1447 536 (MCI_VD_FORMAT_TRACK_S) 536 SB
gr
gs 724 63 1359 1442 CB
1409 1447 494 (MCI_VD_FORMAT_TRACK) 494 SB
gr
gs 724 63 634 1505 CB
634 1510 453 (WAVE_FORMAT_PCM_S) 453 SB
gr
gs 724 63 1359 1505 CB
1409 1510 411 (WAVE_FORMAT_PCM) 411 SB
gr
gs 724 63 634 1568 CB
634 1573 342 (WAVE_MAPPER_S) 342 SB
gr
gs 724 63 1359 1568 CB
1409 1573 300 (WAVE_MAPPER) 300 SB
gr
gs 724 63 634 1631 CB
634 1636 393 (MCI_SEQ_MAPPER_S) 393 SB
gr
gs 724 63 1359 1631 CB
1409 1636 351 (MCI_SEQ_MAPPER) 351 SB
gr
gs 724 63 634 1694 CB
634 1699 315 (MCI_SEQ_FILE_S) 315 SB
gr
gs 724 63 1359 1694 CB
1409 1699 273 (MCI_SEQ_FILE) 273 SB
gr
gs 724 63 634 1757 CB
634 1762 324 (MCI_SEQ_MIDI_S) 324 SB
gr
gs 724 63 1359 1757 CB
1409 1762 282 (MCI_SEQ_MIDI) 282 SB
gr
gs 724 63 634 1820 CB
634 1825 360 (MCI_SEQ_SMPTE_S) 360 SB
gr
gs 724 63 1359 1820 CB
1409 1825 318 (MCI_SEQ_SMPTE) 318 SB
gr
gs 724 63 634 1883 CB
634 1888 599 (MCI_SEQ_FORMAT_SONGPTR_S) 599 SB
gr
gs 724 63 1359 1883 CB
1409 1888 557 (MCI_SEQ_FORMAT_SONGPTR) 557 SB
gr
gs 724 63 634 1946 CB
634 1951 344 (MCI_SEQ_NONE_S) 344 SB
gr
gs 724 63 1359 1946 CB
1409 1951 302 (MCI_SEQ_NONE) 302 SB
gr
gs 724 63 634 2009 CB
634 2014 293 (MIDIMAPPER_S) 293 SB
gr
gs 724 63 1359 2009 CB
1409 2014 251 (MIDIMAPPER) 251 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 2101 641 (MCI uses the high-order word of the ) 641 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1275 2100 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1489 2101 402 ( return value to instruct) 402 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 2150 275 (mciSendString) 275 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
909 2151 1087 ( about how to convert the information returned in the MCI data) 1087 SB
634 2201 544 (structure into string form. \(The ) 544 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1178 2200 275 (mciSendString) 275 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1453 2201 500 ( function translates the string) 500 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 14 def
/wp$fpage (14) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 15 15
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (15) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1417 (interface used by an application to the command interface used by the driver.\) The) 1417 SB
721 546 998 (following flags are defined for the high-order word of the ) 998 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1719 545 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1933 546 230 ( return value:) 230 SB
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 543 63 721 629 CB
721 634 76 (Flag) 76 SB
gr
gs 905 63 1265 629 CB
1315 634 149 (Meaning) 149 SB
gr
1448 2 721 692 B
1 F
n
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 543 63 721 699 CB
721 704 537 (MCI_RESOURCE_RETURNED) 537 SB
gr
gs 905 50 1265 699 CB
1315 704 831 (Specifies that the high-order word of the value in the) 831 SB
gr
gs 905 46 1265 749 CB
1315 750 772 (return member is a string resource ID. This ID is) 772 SB
gr
gs 905 46 1265 795 CB
1315 796 213 (translated by ) 213 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Bold /font29 ANSIFont font
gs 905 46 1265 795 CB
1528 796 251 (mciSendString) 251 SB
gr
32 0 0 40 40 0 0 0 36 /Times-Roman /font32 ANSIFont font
gs 905 46 1265 795 CB
1779 796 386 ( by loading the specified) 386 SB
gr
gs 905 59 1265 841 CB
1315 842 142 (resource.) 142 SB
gr
gs 543 63 721 900 CB
721 905 474 (MCI_RESOURCE_DRIVER) 474 SB
gr
gs 905 50 1265 900 CB
1315 905 831 (Specifies that the high-order word of the value in the) 831 SB
gr
gs 905 46 1265 950 CB
1315 951 826 (return member is a string resource ID defined by the) 826 SB
gr
gs 905 46 1265 996 CB
1315 997 391 (driver. This flag requires) 391 SB
gr
gs 905 59 1265 1042 CB
1315 1043 547 (MCI_RESOURCE_RETURNED.) 547 SB
gr
gs 543 50 721 1101 CB
721 1106 522 (MCI_COLONIZED3_RETURN) 522 SB
gr
gs 543 59 721 1151 CB
721 1152 522 (MCI_COLONIZED4_RETURN) 522 SB
gr
gs 905 50 1265 1101 CB
1315 1106 801 (Specify that when the DWORD value in the return) 801 SB
gr
gs 905 46 1265 1151 CB
1315 1152 850 (member is converted into a string, its individual bytes) 850 SB
gr
gs 905 59 1265 1197 CB
1315 1198 483 (should be separated by colons.) 483 SB
gr
gs 543 63 721 1256 CB
721 1261 496 (MCI_INTEGER_RETURNED) 496 SB
gr
gs 905 50 1265 1256 CB
1315 1261 844 (Specifies that the value in a data structure that allows) 844 SB
gr
gs 905 59 1265 1306 CB
1315 1307 780 (either integer or string returns is an integer value.) 780 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1394 1409 (Integer return values that have resource string equivalents are indicated by setting) 1409 SB
721 1444 1425 (the MCI_RESOURCE_RETURNED bit in the error return. This indicates that the) 1425 SB
721 1494 1425 (high-order word of the value in the return member is a string ID to load. If a driver) 1425 SB
721 1544 1181 (returns MCI_RESOURCE_RETURNED to an application that used) 1181 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1593 354 (mciSendCommand) 354 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1075 1594 1046 ( to call the driver, the application does not see the high-order) 1046 SB
721 1644 1407 (word of the return value. When this flag is set, MCI clears the high-order word of) 1407 SB
721 1694 1390 (the return member before it returns to the application. Using the high-order word) 1390 SB
721 1744 1377 (for resource data restricts the integer return value to the 16 bits of the low-order) 1377 SB
721 1794 1426 (word. The following example sets the MCI_RESOURCE_RETURNED bit for the) 1426 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
721 1843 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
935 1844 230 ( return value:) 230 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 1933 1200 (lpStatus->dwReturn = MAKEMCIRESOURCE\(MCI_SEQ_FORMAT_SONGPTR,) 1200 SB
721 1979 1260 (                                     MCI_SEQ_FORMAT_SONGPTR_S\);) 1260 SB
721 2025 580 (return MCI_RESOURCE_RETURNED;) 580 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2111 1415 (If the driver defines the resource string, use the MCI_RESOURCE_DRIVER flag) 1415 SB
721 2161 826 (with the MCI_RESOURCE_RETURNED flag.) 826 SB
721 2244 1400 (If the driver returns information in the return member that should be separated by) 1400 SB
721 2294 1236 (colons when it is displayed, use the MCI_COLONIZED3_RETURN or) 1236 SB
721 2344 1436 (MCI_COLONIZED4_RETURN flag. For example, 0x01020304 is \223colonized\224 as) 1436 SB
721 2394 1059 (\2234:3:2\224 for MCI_COLONIZED3_RETURN or \2234:3:2:1\224 for) 1059 SB
721 2444 583 (MCI_COLONIZED4_RETURN.) 583 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 15 def
/wp$fpage (15) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 16 16
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (16) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 883 (Use the MCI_INTEGER_RETURNED flag in the ) 883 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1517 495 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1731 496 321 ( return value when) 321 SB
634 546 1358 (returning an integer value, if the return member of the data structure can return) 1358 SB
634 596 828 (either integer or string values. For example, the ) 828 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1462 595 127 (sysinfo) 127 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1589 596 449 ( command can return both) 449 SB
634 646 1445 (string and integer data. When this flag is set, the returned integer is converted into a) 1445 SB
634 696 353 (string equivalent by ) 353 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
987 695 275 (mciSendString) 275 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1262 696 11 (.) 11 SB
634 779 1415 (Data structures that return string data or RECT data do not require any flags to be) 1415 SB
634 829 445 (set in the return value for ) 445 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1079 828 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1293 829 11 (.) 11 SB
32 0 0 83 83 0 0 0 79 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 949 38 (2) 38 SB
297 949 1026 (.5  Adding New MCI Commands) 1026 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1063 1410 (If a driver needs to include new MCI commands or provide extensions to the MCI) 1410 SB
634 1113 566 (command set, follow these steps:) 566 SB
634 1196 33 (1.) 33 SB
692 1196 933 (Define the new MCI messages the driver will support.) 933 SB
634 1263 33 (2.) 33 SB
692 1263 1140 (Define new data structures and flags for this command to use with) 1140 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
692 1312 354 (mciSendCommand) 354 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1046 1313 11 (.) 11 SB
634 1380 33 (3.) 33 SB
692 1380 1312 (Create a command table that MCI can use to translate string commands sent) 1312 SB
692 1430 143 (through ) 143 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
835 1429 275 (mciSendString) 275 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1110 1430 969 ( into the command messages and data structures used by) 969 SB
692 1480 177 (the driver.) 177 SB
634 1547 33 (4.) 33 SB
692 1547 508 (Support the new messages in ) 508 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1200 1546 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1414 1547 11 (.) 11 SB
634 1614 33 (5.) 33 SB
692 1614 1288 (Register the new command table with MCI in the DRV_LOAD procedure.) 1288 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1723 32 (2) 32 SB
291 1723 733 (.5.1  Define New Messages) 733 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1819 1142 (Suppose a driver for a videodisc player supports a new command, ) 1142 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1776 1818 92 (reset) 92 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1868 1819 179 (, called by) 179 SB
634 1869 1363 (the string \223reset program_number.\224 The command sets all player parameters to) 1363 SB
634 1919 1280 (their default settings or to one of several predefined states indicated by the) 1280 SB
634 1969 308 (program_number.) 308 SB
634 2052 1092 (Add the following message to the list of messages supported in ) 1092 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1726 2051 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1940 2052 12 (:) 12 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
634 2141 620 (#define MCI_VDISC_RESET    1000) 620 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 2227 1326 (MCI_USER_MESSAGES is the first integer available for custom messages.) 1326 SB
634 2277 1362 (Because the resource compiler does not accept mathematical expressions in the) 1362 SB
634 2327 1169 (RCDATA resource type, the driver must indicate the specific value.) 1169 SB
634 2410 1449 (After defining the message ID, define the data structure and the command table, and) 1449 SB
634 2460 711 (create the code to handle this message in ) 711 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1345 2459 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1559 2460 11 (.) 11 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 16 def
/wp$fpage (16) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 17 17
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (17) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
346 492 32 (2) 32 SB
378 492 1144 (.5.2  Define the Data Structures and Flags) 1144 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 588 1396 (Most new messages require additional parameters to specify their exact function.) 1396 SB
721 638 334 (MCI messages use ) 334 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1055 638 153 (lParam2) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1208 638 616 ( as a pointer to a data structure and ) 616 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1824 638 153 (lParam1) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1977 638 136 ( as a bit) 136 SB
721 688 1410 (field for the flags associated with the message. A flag must exist for each member) 1410 SB
721 738 1416 (in the data structure that accepts data from the calling application. The application) 1416 SB
721 788 584 (uses the flag to set the bit field of ) 584 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1305 788 153 (lParam1) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1458 788 649 ( that indicates a value is assigned to a) 649 SB
721 838 1398 (particular member. Flags also specify options without parameters. These flags do) 1398 SB
721 888 844 (not correspond to a member in the data structure.) 844 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 985 29 (2) 29 SB
750 985 826 (.5.2.1  Defining the Data Structure) 826 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1067 1384 (The members of the data structure for an MCI message are based on DWORDs.) 1384 SB
721 1117 1430 (The number of members in the structure depends on the message. The first member) 1430 SB
721 1167 1405 (must be reserved for a handle to a callback function used with the MCI_NOTIFY) 1405 SB
721 1217 1438 (flag. The next members in the data structure depend on the type of data returned for) 1438 SB
721 1267 220 (the message:) 220 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1344 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1350 1374 (If no data is returned, no return members are reserved in the data structure. Any) 1374 SB
779 1400 1282 (data members for passing information to the driver immediately follow the) 1282 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
779 1449 222 (dwCallback) 222 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1001 1450 1077 ( member. For example, the following structure does not have a) 1077 SB
779 1500 265 (return member:) 265 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
779 1573 320 (typedef struct {) 320 SB
779 1619 440 (    DWORD  dwCallback;) 440 SB
779 1665 440 (    DWORD  lpfilename;) 440 SB
779 1711 340 (} MCI_SAVE_PARMS;) 340 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1791 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1797 1341 (If integer data is returned, the second member of the data structure is reserved) 1341 SB
779 1847 1378 (for the return data. Any data members for passing information to the driver start) 1378 SB
779 1897 1127 (with the third member. For example, the following structure uses ) 1127 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1906 1896 187 (dwReturn) 187 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2093 1897 48 ( as) 48 SB
779 1947 458 (the integer return member:) 458 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
779 2020 320 (typedef struct {) 320 SB
779 2066 420 (    DWORD dwCallback;) 420 SB
779 2112 380 (    DWORD dwReturn;) 380 SB
779 2158 340 (    DWORD dwItem;) 340 SB
779 2204 460 (} MCI_GETDEVCAPS_PARMS;) 460 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 2284 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 2290 1370 (If string data is returned, the second and third members of the data structure are) 1370 SB
779 2340 1287 (reserved for the return data. The second DWORD is assigned to a member) 1287 SB
779 2390 1382 (reserved for a pointer to the zero-terminated return string. The third DWORD is) 1382 SB
779 2440 1160 (assigned to a member reserved for the size of the return buffer. The) 1160 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 17 def
/wp$fpage (17) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 18 18
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (18) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
692 496 1256 (application creates the buffer for the return string. Any data members for) 1256 SB
692 546 1333 (passing information to the driver start in the fourth member. For example, the) 1333 SB
692 596 423 (following structure uses ) 423 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1115 595 221 (lpstrReturn) 221 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1336 596 84 ( and ) 84 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1420 595 196 (dwRetSize) 196 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1616 596 417 ( for the return members:) 417 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
692 669 320 (typedef struct {) 320 SB
692 715 420 (    DWORD dwCallback;) 420 SB
692 761 460 (    LPWSTR lpstrReturn;) 460 SB
692 807 400 (    DWORD dwRetSize;) 400 SB
692 853 340 (} MCI_INFO_PARMS;) 340 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 933 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 939 1380 (If RECT data is returned, the second through fifth members of the data structure) 1380 SB
692 989 1342 (are reserved for the return data. The first two DWORD positions are reserved) 1342 SB
692 1039 1364 (for the upper-left values of the RECT data. The second two DWORD positions) 1364 SB
692 1089 1383 (are reserved for the lower-right values of the RECT data. Any data members for) 1383 SB
692 1139 1358 (passing information to the driver start with the sixth DWORD position. Rather) 1358 SB
692 1189 1226 (than specifying four DWORDS for the RECT data, most data structure) 1226 SB
692 1239 1340 (definitions use one RECT data member to obtain an equivalent data structure.) 1340 SB
692 1289 724 (For example, the following structure uses ) 724 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1416 1288 40 (rc) 40 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1456 1289 400 ( for the return member:) 400 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
692 1362 320 (typedef struct {) 320 SB
692 1408 420 (    DWORD dwCallback;) 420 SB
692 1454 240 (    RECT rc;) 240 SB
692 1500 440 (} MCI_ANIM_RECT_PARMS;) 440 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 1571 29 (2) 29 SB
663 1571 710 (.5.2.2  Assigning Flag Values) 710 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1653 1428 (In addition to indicating the members used in a data structure, flags can indicate an) 1428 SB
634 1703 993 (option that does not use parameters, such as the wait flag.) 993 SB
634 1786 1434 (New flags must not conflict with flags already used. Bits 0 through 15 of the 32-bit) 1434 SB
634 1836 1396 (DWORD are reserved for MCI. Bit 16 \(0x00010000\) is the first bit that a driver) 1396 SB
634 1886 1282 (can use for its flags. New commands can start with this bit position. When) 1282 SB
634 1936 1430 (extending a command, bit positions must not conflict with the flags already defined) 1430 SB
634 1986 1286 (for that command. Any unused bits in the new flag must be set to zero. For) 1286 SB
634 2036 1329 (example, if a new command for videodisc players uses flags 16 through 20, a) 1329 SB
634 2086 1195 (custom extension to the new command could use flags 21 through 31.) 1195 SB
634 2169 1440 (To continue the example for adding a reset command to a videodisc driver, the code) 1440 SB
634 2219 1365 (that follows defines a data structure, a corresponding pointer for it, and the flag) 1365 SB
634 2269 1024 (corresponding to the program member of the data structure:) 1024 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
634 2358 320 (typedef struct {) 320 SB
634 2404 420 (    DWORD dwCallback;) 420 SB
634 2450 400 (    DWORD dwProgram;) 400 SB
634 2496 480 (} MCI_VDISC_RESET_PARMS;) 480 SB
634 2588 1260 (typedef    MCI_VDISC_RESET_PARMS FAR * LPMCI_VDISC_RESET_PARMS;) 1260 SB
634 2634 980 (#define    MCI_VDISC_RESET_PROGRAM    0x00010000L) 980 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 18 def
/wp$fpage (18) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 19 19
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (19) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1278 (When the application sets the MCI_VDISC_RESET_PROGRAM flag in ) 1278 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1999 496 164 (lParam1,) 164 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 546 716 (it indicates that a value is assigned in the ) 716 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1437 545 222 (dwProgram) 222 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1659 546 161 ( member.) 161 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 654 32 (2) 32 SB
378 654 1092 (.5.3  Creating the MCI Command Tables) 1092 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 750 1368 (The next step is to create the command table that tells MCI how to translate the) 1368 SB
721 800 1042 (equivalent string command into the message command form.) 1042 SB
721 883 431 (The MCI parser used by ) 431 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1152 882 275 (mciSendString) 275 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1427 883 711 ( uses the command tables to tell it how to) 711 SB
721 933 1011 (translate an MCI command string into parameters used by ) 1011 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1732 932 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1946 933 157 (. Most of) 157 SB
721 983 1270 (these tables are stored as resources within the driver. The resource type is) 1270 SB
721 1033 189 (RCDATA.) 189 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 1130 29 (2) 29 SB
750 1130 955 (.5.3.1  Contents of the Command Table) 955 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1212 760 (A command table consists of three columns:) 760 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1289 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1295 1370 (The first column contains the commands and flags used in the string form of the) 1370 SB
779 1345 1338 (command. Each entry in the first column must be terminated with \\0 to form a) 1338 SB
779 1395 907 (zero-terminated string. Prefix the quoted string with ) 907 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1686 1395 24 (L) 24 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1710 1395 429 ( to indicate a wide-string) 429 SB
779 1445 113 (literal.) 113 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1506 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1512 1366 (The second column is a DWORD and contains the commands and flags used in) 1366 SB
779 1562 598 (the message form of the command.) 598 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 740 3231 0 0 CB
721 1623 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
779 1629 1285 (The third column is a WORD and contains the identifiers that tell the MCI) 1285 SB
779 1679 592 (parser how to interpret each entry.) 592 SB
721 1779 955 (The following example shows a partial command table:) 955 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 1868 1260 (/*************************************************************/) 1260 SB
721 1914 1260 (/*   Command Table for the MCI core command set              */) 1260 SB
721 1960 1260 (/*************************************************************/) 1260 SB
721 2006 220 (core RCDATA) 220 SB
721 2052 100 (BEGIN) 100 SB
721 2098 1380 (  L"open\\0",            MCI_OPEN, 0,                MCI_COMMAND_HEAD,) 1380 SB
721 2144 1260 (  L"\\0",                MCI_INTEGER, 0,             MCI_RETURN,) 1260 SB
721 2190 1220 (  L"notify\\0",          MCI_NOTIFY,                 MCI_FLAG,) 1220 SB
721 2236 1220 (  L"wait\\0",            MCI_WAIT,                   MCI_FLAG,) 1220 SB
721 2282 1260 (  L"type\\0",            MCI_OPEN_TYPE,              MCI_STRING,) 1260 SB
721 2328 1260 (  L"element\\0",         MCI_OPEN_ELEMENT,           MCI_STRING,) 1260 SB
721 2374 1260 (  L"alias\\0",           MCI_OPEN_ALIAS,             MCI_STRING,) 1260 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 19 def
/wp$fpage (19) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 20 20
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (20) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
634 502 1220 (  L"shareable\\0",       MCI_OPEN_SHAREABLE,         MCI_FLAG,) 1220 SB
634 548 1360 (  L"\\0",                0L,                         MCI_END_COMMAND,) 1360 SB
634 594 1380 (  L"close\\0",           MCI_CLOSE, 0,               MCI_COMMAND_HEAD,) 1380 SB
634 640 1220 (  L"notify\\0",          MCI_NOTIFY,                 MCI_FLAG,) 1220 SB
634 686 1240 (  L"wait\\0",            MCI_WAIT,                   MCI_FLAG ,) 1240 SB
634 732 1360 (  L"\\0",                0L,                         MCI_END_COMMAND,) 1360 SB
634 778 1380 (  L"play\\0",            MCI_PLAY, 0,                MCI_COMMAND_HEAD,) 1380 SB
634 824 1220 (  L"notify\\0",          MCI_NOTIFY,                 MCI_FLAG,) 1220 SB
634 870 1240 (  L"wait\\0",            MCI_WAIT,                   MCI_FLAG ,) 1240 SB
634 916 1280 (  L"from\\0",            MCI_FROM,                   MCI_INTEGER,) 1280 SB
634 962 1280 (  L"to\\0",              MCI_TO,                     MCI_INTEGER,) 1280 SB
634 1008 1360 (  L"\\0",                0L,                         MCI_END_COMMAND,) 1360 SB
634 1054 480 (                       .) 480 SB
634 1100 480 (                       .) 480 SB
634 1146 480 (                       .) 480 SB
634 1192 1380 (  L"capability\\0",      MCI_GETDEVCAPS, 0,          MCI_COMMAND_HEAD,) 1380 SB
634 1238 1260 (  L"\\0",                MCI_INTEGER, 0,             MCI_RETURN,) 1260 SB
634 1284 1220 (  L"notify\\0",          MCI_NOTIFY,                 MCI_FLAG,) 1220 SB
634 1330 1240 (  L"wait\\0",            MCI_WAIT,                   MCI_FLAG ,) 1240 SB
634 1376 1280 (  L"\\0",                MCI_GETDEVCAPS_ITEM,        MCI_CONSTANT) 1280 SB
634 1422 1280 (  L"can record\\0",      MCI_GETDEVCAPS_CAN_RECORD,  MCI_INTEGER,) 1280 SB
634 1468 1280 (  L"has audio\\0",       MCI_GETDEVCAPS_HAS_AUDIO,   MCI_INTEGER,) 1280 SB
634 1514 1280 (  L"has video\\0",       MCI_GETDEVCAPS_HAS_VIDEO,   MCI_INTEGER,) 1280 SB
634 1560 1280 (  L"uses files\\0",      MCI_GETDEVCAPS_USES_FILES,  MCI_INTEGER,) 1280 SB
634 1606 1360 (  L"compound device\\0", MCI_GETDEVCAPS_COMPOUND_DEVICE, MCI_INTEGER,) 1360 SB
634 1652 1280 (  L"device type\\0",     MCI_GETDEVCAPS_DEVICE_TYPE, MCI_INTEGER,) 1280 SB
634 1698 1280 (  L"can eject\\0",       MCI_GETDEVCAPS_CAN_EJECT,   MCI_INTEGER,) 1280 SB
634 1744 1280 (  L"can play\\0",        MCI_GETDEVCAPS_CAN_PLAY,    MCI_INTEGER,) 1280 SB
634 1790 1280 (  L"can save\\0",        MCI_GETDEVCAPS_CAN_SAVE,    MCI_INTEGER,) 1280 SB
634 1836 1380 (  L"\\0",                0L,                         MCI_END_CONSTANT,) 1380 SB
634 1882 1360 (  L"\\0",                0L,                         MCI_END_COMMAND,) 1360 SB
634 1928 1380 (  L"resume\\0",          MCI_RESUME, 0,              MCI_COMMAND_HEAD,) 1380 SB
634 1974 1220 (  L"notify\\0",          MCI_NOTIFY,                 MCI_FLAG,) 1220 SB
634 2020 1220 (  L"wait\\0",            MCI_WAIT,                   MCI_FLAG,) 1220 SB
634 2066 1360 (  L"\\0",                0L,                         MCI_END_COMMAND,) 1360 SB
634 2112 1440 (  L"\\0",                0L,                         MCI_END_COMMAND_LIST) 1440 SB
634 2158 60 (END) 60 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 2244 1397 (When building a command table, ensure that the entries in the second column are) 1397 SB
634 2294 1409 (DWORDs and that the entries in the third column are WORDs. Pad any WORDs) 1409 SB
634 2344 1417 (in the second columns with a comma and a zero to keep the command list properly) 1417 SB
634 2394 1372 (aligned. For example, the MCI_PLAY message in the example is followed by a) 1372 SB
634 2444 1407 (comma and a zero. Without a zero after a WORD, the remainder of the command) 1407 SB
634 2494 735 (table would be misaligned by one WORD.) 735 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 20 def
/wp$fpage (20) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 21 21
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (21) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1438 (A command table consists of command lists, which define how to parse a particular) 1438 SB
721 546 1434 (command. For example, the following command list tells the parser which flags are) 1434 SB
721 596 1035 (valid and how to create the associated data structure for the ) 1035 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1756 595 80 (play) 80 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1836 596 189 ( command:) 189 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 685 1080 (L"play\\0",        MCI_PLAY, 0,       MCI_COMMAND_HEAD,) 1080 SB
721 731 920 (L"notify\\0",      MCI_NOTIFY,        MCI_FLAG,) 920 SB
721 777 940 (L"wait\\0",        MCI_WAIT,          MCI_FLAG ,) 940 SB
721 823 980 (L"from\\0",        MCI_FROM,          MCI_INTEGER,) 980 SB
721 869 980 (L"to\\0",          MCI_TO,            MCI_INTEGER,) 980 SB
721 915 1060 (L"\\0",            0L,                MCI_END_COMMAND,) 1060 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 1015 29 (2) 29 SB
750 1015 1305 (.5.3.2  Command List and Command Table Delimiters) 1305 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1097 1303 (The first entry in a command list must have the MCI_COMMAND_HEAD) 1303 SB
721 1147 1426 (delimiter in the third column. The MCI_COMMAND_HEAD delimiter designates) 1426 SB
721 1197 992 (the verb portion of the string command. For example, the ) 992 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1713 1196 80 (play) 80 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1793 1197 345 ( command list starts) 345 SB
721 1247 260 (with this entry:) 260 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 1336 1080 (L"play\\0",        MCI_PLAY, 0,       MCI_COMMAND_HEAD,) 1080 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1422 1439 (The last entry in a command list must have the MCI_END_COMMAND delimiter.) 1439 SB
721 1472 1419 (For this last entry, the first and second columns contain \223\\0\224 and 0L. For example,) 1419 SB
721 1522 645 (all command lists end with this entry:) 645 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 1611 1060 (L"\\0",            0L,                MCI_END_COMMAND,) 1060 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1697 1441 (The last entry of the command table must have the MCI_END_COMMAND_LIST) 1441 SB
721 1747 1430 (delimiter. The first and second columns for this entry also contain \223\\0\224 and 0L. For) 1430 SB
721 1797 1004 (instance, the example command table ends with this entry:) 1004 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 1886 1140 (L"\\0",            0L,                MCI_END_COMMAND_LIST) 1140 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 1986 29 (2) 29 SB
750 1986 505 (.5.3.3  Return Values) 505 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2068 1344 (To return data in a data structure, reserve a member by making an entry in the) 1344 SB
721 2118 1335 (command list with MCI_RETURN in the third column. MCI_RETURN must) 1335 SB
721 2168 1411 (immediately follow MCI_COMMAND_HEAD. MCI_RETURN can appear only) 1411 SB
721 2218 1347 (once in a command list. For example, the MCI_GETDEVCAPS command list) 1347 SB
721 2268 557 (starts with the following entries:) 557 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 2357 1080 (L"capability\\0"   MCI_GETDEVCAPS, 0, MCI_COMMAND_HEAD,) 1080 SB
721 2403 960 (L"\\0",            MCI_INTEGER, 0,    MCI_RETURN,) 960 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 21 def
/wp$fpage (21) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 22 22
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (22) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1392 (The string in the first column of an entry with MCI_RETURN is \223\\0\224, indicating) 1392 SB
634 546 391 (this column is ignored.) 391 SB
634 629 1432 (The second column of the MCI_RETURN entry specifies the type of data returned.) 1432 SB
634 679 1414 (The parser recognizes MCI_INTEGER, MCI_HWND, MCI_HPAL, MCI_HDC,) 1414 SB
634 729 1028 (MCI_STRING, and MCI_RECT for the data type returned.) 1028 SB
634 812 1338 (To return an integer value, use MCI_INTEGER,0 in the second column. MCI) 1338 SB
634 862 1218 (reserves the second DWORD in the data structure for the return value.) 1218 SB
634 945 1439 (To return an HWND value, use MCI_HWND,0 in the second column. To return an) 1439 SB
634 995 1384 (HPAL value, use MCI_HPAL,0 in the second column. To return an HDC value,) 1384 SB
634 1045 1450 (use MCI_HDC,0 in the second column. For HWND, HPAL, and HDC values, MCI) 1450 SB
634 1095 1218 (reserves the second DWORD in the data structure for the return value.) 1218 SB
634 1178 1381 (To return a string value, use MCI_STRING,0 in the second column. For strings,) 1381 SB
634 1228 1378 (MCI reserves the second and third DWORDs in the data structure for the return) 1378 SB
634 1278 1419 (value. The second DWORD corresponds to a buffer for the zero-terminated return) 1419 SB
634 1328 1193 (string, and the third DWORD corresponds to the length of the buffer.) 1193 SB
634 1411 1408 (To return a RECT value, use MCI_RECT,0 in the second column. For rectangles,) 1408 SB
634 1461 1440 (MCI reserves the second through fifth DWORDs in the data structure for the return) 1440 SB
634 1511 104 (value.) 104 SB
634 1594 1006 (The following example adds an integer return value to the ) 1006 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1640 1593 92 (reset) 92 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1732 1594 189 ( command:) 189 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
634 1683 1180 (L"reset\\0",    MCI_VDISC_RESET, 0,        MCI_COMMAND_HEAD,) 1180 SB
634 1729 1060 (L"\\0",         MCI_INTEGER, 0,            MCI_RETURN,) 1060 SB
634 1775 1020 (L"notify\\0",   MCI_NOTIFY,                MCI_FLAG,) 1020 SB
634 1821 1020 (L"wait\\0",     MCI_WAIT,                  MCI_FLAG,) 1020 SB
634 1867 1080 (L"program\\0",  MCI_VDISC_RESET_PROGRAM,   MCI_INTEGER,) 1080 SB
634 1913 1140 (L"\\0",         0L,                        MCI_END_COMMAND) 1140 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1999 702 (The corresponding data structure for the ) 702 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1336 1998 92 (reset) 92 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1428 1999 617 ( command using a return value is as) 617 SB
634 2049 140 (follows:) 140 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
634 2138 320 (typedef struct {) 320 SB
634 2184 440 (    DWORD  dwCallback;) 440 SB
634 2230 400 (    DWORD  dwReturn;) 400 SB
634 2276 420 (    DWORD  dwProgram;) 420 SB
634 2322 480 (} MCI_VDISC_RESET_PARMS;) 480 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 22 def
/wp$fpage (22) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 23 23
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (23) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
721 493 29 (2) 29 SB
750 493 561 (.5.3.4  Command Flags) 561 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 575 1396 (MCI interprets an entry with MCI_FLAG in the third column as a flag that is not) 1396 SB
721 625 1433 (associated with any member of the data structure. For example, all commands have) 1433 SB
721 675 816 (the following entry for the MCI_NOTIFY flag:) 816 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 764 860 (L"notify\\0",    MCI_NOTIFY,        MCI_FLAG) 860 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 850 1384 (The first column of this entry contains the string command used for the flag. The) 1384 SB
721 900 878 (second column contains the value used for the flag.) 878 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
721 997 29 (2) 29 SB
750 997 1203 (.5.3.5  Associating Command List Entries to Data) 1203 SB
721 1068 259 (Structures) 259 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1150 1275 (MCI associates a command list entry to a data structure member when the) 1275 SB
721 1200 1374 (command list entry has MCI_INTEGER, MCI_STRING, or MCI_RECT in the) 1374 SB
721 1250 1401 (third column. The order of the entries in the command list implies the order of the) 1401 SB
721 1300 1299 (members in a data structure. The command list does not explicitly name the) 1299 SB
721 1350 490 (members of a data structure.) 490 SB
721 1433 1408 (When assigning members, MCI reserves the first member in the data structure for) 1408 SB
721 1483 1446 (the handle to a callback function. MCI uses the second member of the data structure) 1446 SB
721 1533 1446 (for data associated with the first entry needing space in the data structure. MCI then) 1446 SB
721 1583 1425 (assigns the third data member to the second entry needing it. This continues for the) 1425 SB
721 1633 1327 (rest of the list. This association assumes that all the data members in the data) 1327 SB
721 1683 1440 (structure are DWORDS or a multiple of a DWORD. The command list can contain) 1440 SB
721 1733 1346 (unmodified entries interspersed with entries that are modified with values. For) 1346 SB
721 1783 1388 (example, a command designated as an MCI_FLAG will not be associated with a) 1388 SB
721 1833 1213 (member in a data structure. Instead, it will designate a bit flag used in ) 1213 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1934 1833 153 (lParam1) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
2087 1833 50 (. If) 50 SB
721 1883 1410 (the MCI_FLAG entry separates two entries designated MCI_INTEGER, it would) 1410 SB
721 1933 836 (not affect the data structure member assignment.) 836 SB
721 2016 1321 (As an example, the reset videodisc player command example would have the) 1321 SB
721 2066 270 (following form:) 270 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 2155 1020 (L"reset\\0",   MCI_VDISC_RESET, 0, MCI_COMMAND_HEAD,) 1020 SB
721 2201 860 (L"notify\\0",  MCI_NOTIFY,         MCI_FLAG,) 860 SB
721 2247 860 (L"wait\\0",    MCI_WAIT,           MCI_FLAG,) 860 SB
721 2293 1040 (L"program\\0", MCI_VDISC_RESET_PROGRAM,  MCI_INTEGER,) 1040 SB
721 2339 980 (L"\\0",        0L,                 MCI_END_COMMAND) 980 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 23 def
/wp$fpage (23) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 24 24
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (24) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1448 (\223\\0\224 in the first column designates that entry as a default entry. Any flags entered as) 1448 SB
634 546 1338 (part of a string command that do not match any entry in the command list will) 1338 SB
634 596 1387 (assume the default value. Only one default value can exist in each command list.) 1387 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 693 29 (2) 29 SB
663 693 569 (.5.3.6  Using Constants) 569 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 775 1443 (MCI uses MCI_CONSTANT and MCI_END_CONSTANT to associate a range of) 1443 SB
634 825 1372 (constants with a flag. MCI_CONSTANT reserves a DWORD in the associated) 1372 SB
634 875 1354 (data structure and delimits the start of a list of constants. The following entries) 1354 SB
634 925 1440 (contain the constants. Each constant entry has MCI_INTEGER in the third column.) 1440 SB
634 975 1306 (The list of constants ends with MCI_END_CONSTANT. For example, the ) 1306 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1940 974 52 (set) 52 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1025 1157 (command has the following entries for the audio channel constants:) 1157 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
634 1114 1000 (L"audio\\0",    MCI_SET_AUDIO,        MCI_CONSTANT,) 1000 SB
634 1160 980 (L"all\\0",      MCI_SET_AUDIO_ALL,    MCI_INTEGER,) 980 SB
634 1206 980 (L"left\\0",     MCI_SET_AUDIO_LEFT,   MCI_INTEGER,) 980 SB
634 1252 980 (L"right\\0",    MCI_SET_AUDIO_RIGHT,  MCI_INTEGER,) 980 SB
634 1298 1080 (L"\\0",         0L,                   MCI_END_CONSTANT,) 1080 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1384 1418 (The list of constants actually contains a list of predefined integers that can be used) 1418 SB
634 1434 1333 (in a string command. These predefined integers are passed to the driver in the) 1333 SB
634 1484 1360 (member reserved for the flag in the data structure. If the parser finds an integer) 1360 SB
634 1534 1397 (following a flag rather than one of the flag\222s predefined constants, the parser will) 1397 SB
634 1584 1402 (assign the integer to the data structure member. This allows the driver to use both) 1402 SB
634 1634 693 (constants and integers as data for a flag.) 693 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 1731 29 (2) 29 SB
663 1731 560 (.5.3.7  Types of Entries) 560 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1813 1400 (The following table summarizes the constants used to identify the type of entry in) 1400 SB
634 1863 337 (the command table:) 337 SB
634 1946 482 (MCI_COMMAND_HEAD) 482 SB
692 1996 1356 (This specifies that the zero-terminated string in the first column corresponds to) 1356 SB
692 2046 1351 (the verb portion of the string command. The DWORD following the command) 1351 SB
692 2096 828 (corresponds to the message command passed to ) 828 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1520 2095 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1734 2096 59 ( as ) 59 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1793 2096 104 (wMsg) 104 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1897 2096 98 (. This) 98 SB
692 2146 1311 (entry must be the first entry in the command list and it must be unique to the) 1311 SB
692 2196 96 (table.) 96 SB
634 2263 278 (MCI_RETURN) 278 SB
692 2313 1227 (This specifies that a data structure associated with a command has data) 1227 SB
692 2363 1304 (members reserved for return information. If used, the data entry must be the) 1304 SB
692 2413 1356 (second entry in the command list. The first column of the entry contains L\223\\0\224.) 1356 SB
692 2463 1342 (The second column of this entry contains the type of return value. If the return) 1342 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 24 def
/wp$fpage (24) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 25 25
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (25) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
779 496 1189 (type is specified as MCI_INTEGER, MCI_HWND, MCI_HPAL, or) 1189 SB
779 546 1378 (MCI_HDC, the second DWORD in the associated data structure is reserved for) 1378 SB
779 596 1309 (the return value. If the return type is specified as MCI_STRING, the second) 1309 SB
779 646 1351 (DWORD in the associated data structure is reserved for a pointer to the return) 1351 SB
779 696 1387 (string and the third DWORD is reserved for the length of the string. If the return) 1387 SB
779 746 1284 (type is specified as MCI_RECT, the second through fifth DWORDs in the) 1284 SB
779 796 987 (associated data structure are reserved for the RECT data.) 987 SB
721 863 217 (MCI_FLAG) 217 SB
779 913 1367 (This specifies that the MCI flag represented by the command list entry does not) 1367 SB
779 963 1304 (have any additional data associated with it. The second column of this entry) 1304 SB
779 1013 398 (contains the flag to set.) 398 SB
721 1080 291 (MCI_INTEGER) 291 SB
779 1130 1246 (This specifies that integer data modifies the MCI flag represented by the) 1246 SB
779 1180 1387 (command list entry. The second column of this entry contains the flag to set. The) 1387 SB
779 1230 1323 (data structure for the message command must reserve a DWORD to hold the) 1323 SB
779 1280 234 (integer value.) 234 SB
721 1347 242 (MCI_HWND) 242 SB
779 1397 1265 (This specifies that HWND data modifies the MCI flag represented by the) 1265 SB
779 1447 1387 (command list entry. The second column of this entry contains the flag to set. The) 1387 SB
779 1497 1323 (data structure for the message command must reserve a DWORD to hold the) 1323 SB
779 1547 253 (HWND value.) 253 SB
721 1614 197 (MCI_HDC) 197 SB
779 1664 1220 (This specifies that HDC data modifies the MCI flag represented by the) 1220 SB
779 1714 1387 (command list entry. The second column of this entry contains the flag to set. The) 1387 SB
779 1764 1323 (data structure for the message command must reserve a DWORD to hold the) 1323 SB
779 1814 208 (HDC value.) 208 SB
721 1881 217 (MCI_HPAL) 217 SB
779 1931 1240 (This specifies that HPAL data modifies the MCI flag represented by the) 1240 SB
779 1981 1387 (command list entry. The second column of this entry contains the flag to set. The) 1387 SB
779 2031 1323 (data structure for the message command must reserve a DWORD to hold the) 1323 SB
779 2081 228 (HPAL value.) 228 SB
721 2148 215 (MCI_RECT) 215 SB
779 2198 1238 (This specifies that RECT data modifies the MCI flag represented by the) 1238 SB
779 2248 1387 (command list entry. The second column of this entry contains the flag to set. The) 1387 SB
779 2298 1391 (data structure for the message command must reserve four DWORDs to hold the) 1391 SB
779 2348 226 (RECT value.) 226 SB
721 2415 261 (MCI_STRING) 261 SB
779 2465 1225 (This specifies that string data modifies the MCI flag represented by the) 1225 SB
779 2515 1387 (command list entry. The second column of this entry contains the flag to set. The) 1387 SB
779 2565 1319 (data structure for the message command must reserve two DWORDs: one to) 1319 SB
779 2615 1276 (hold a pointer to the string data, another to specify the length of the string.) 1276 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 25 def
/wp$fpage (25) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%Page: 26 26
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (26) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 336 (MCI_CONSTANT) 336 SB
692 546 1246 (This specifies that integer data modifies the MCI flag represented by the) 1246 SB
692 596 1332 (command list entry and that a list of constants that can be used for the integer) 1332 SB
692 646 1389 (data follows it. The second column of this entry contains the flag to set. The data) 1389 SB
692 696 1369 (structure for the message command must reserve a DWORD to hold the integer) 1369 SB
692 746 653 (value used inside MCI_CONSTANT.) 653 SB
634 813 449 (MCI_END_CONSTANT) 449 SB
692 863 1389 (This specifies the end of a list of constants. The first and second columns for this) 1389 SB
692 913 802 (entry must contain L\223\\0\224 and 0L, respectively.) 802 SB
634 980 451 (MCI_END_COMMAND) 451 SB
692 1030 1349 (This specifies the end of a command list. The first and second columns for this) 1349 SB
692 1080 802 (entry must contain L\223\\0\224 and 0L, respectively.) 802 SB
634 1147 563 (MCI_END_COMMAND_LIST) 563 SB
692 1197 1340 (This specifies the end of the command table. The first and second columns for) 1340 SB
692 1247 875 (this entry must contain L\223\\0\224 and 0L, respectively.) 875 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 1328 29 (2) 29 SB
663 1328 1210 (.5.3.8  How the Parser Uses the Command Tables) 1210 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1410 1446 (The following describes tells how the MCI parser uses the command table entries to) 1446 SB
634 1460 1357 (interpret the command string \223play videodisc1 notify from 10 to 20.\224 The MCI) 1357 SB
634 1510 1437 (parser reads the string to obtain the command and its destination device. The parser) 1437 SB
634 1560 1102 (uses the destination to determine the device ID and assigns it to ) 1102 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1736 1560 221 (dwDeviceID) 221 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1957 1560 46 ( of) 46 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1609 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
848 1610 1174 (. The parser also uses this information to determine which command) 1174 SB
634 1660 262 (table to search.) 262 SB
634 1743 1426 (When the parser searches the command tables for \223play,\224 it searches the command) 1426 SB
634 1793 333 (tables in this order:) 333 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1870 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1876 917 (the device-specific table \(the custom command table\)) 917 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 1937 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 1943 1007 (the device-type table \(such as the cdaudio command table\)) 1007 SB
32 0 0 40 40 0 0 0 46 /MSIcons2 font
gs 653 3231 0 0 CB
634 2004 19 (u) 19 SB
gr
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
692 2010 410 (the core command table) 410 SB
634 2110 1138 (When searching the command tables, the parser searches them for) 1138 SB
634 2160 1342 (MCI_COMMAND_HEAD. When it has been found, the parser compares the) 1342 SB
634 2210 1398 (command listed in the first column with the command from the input string. If the) 1398 SB
634 2260 1396 (two commands match, the parser uses the DWORD in the second column \(in this) 1396 SB
634 2310 451 (case, MCI_PLAY\) as the ) 451 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1085 2310 104 (wMsg) 104 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1189 2310 256 ( parameter for ) 256 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1445 2309 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1659 2310 11 (.) 11 SB
634 2393 1416 (The parser tries to match each subsequent parameter in the command string with a) 1416 SB
634 2443 1284 (corresponding entry in the current command list. For the example, the next) 1284 SB
634 2493 1341 (parameter is \223notify.\224 If the parser does not find this, it reports an error. If the) 1341 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 26 def
/wp$fpage (26) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 27 27
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (27) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1436 (parser does find it, it looks in the third column and finds MCI_FLAG. This tells the) 1436 SB
721 546 1347 (parser to OR the second column flag, MCI_NOTIFY, with the bit field for the) 1347 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
721 596 153 (lParam1) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
874 596 195 ( parameter.) 195 SB
721 679 1388 (If the example command contained \223wait\224 rather than \223notify,\224 the parser would) 1388 SB
721 729 1356 (take the same actions as for the \223notify\224 example except that it would combine) 1356 SB
721 779 648 (MCI_WAIT with the bit field for the ) 648 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1369 779 153 (lParam1) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1522 779 195 ( parameter.) 195 SB
721 862 1392 (When the parser interprets the \223from\224 parameter, MCI_INTEGER indicates that) 1392 SB
721 912 1421 (additional data is available from the command string. The parser obtains the string) 1421 SB
721 962 1392 (value, converts it to an integer, and stores it in the DWORD of the data structure) 1392 SB
721 1012 1431 (corresponding to the MCI_FROM flag. The parser also combines the MCI_FROM) 1431 SB
721 1062 455 (flag in the bit field for the ) 455 SB
32 0 0 44 44 0 0 0 40 /Times-Italic /font31 ANSIFont font
1176 1062 153 (lParam1) 153 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1329 1062 195 ( parameter.) 195 SB
721 1145 1381 (The parser processes the \223to\224 parameter exactly as it does the \223from\224 parameter) 1381 SB
721 1195 1334 (except that the integer modifier is stored in the DWORD of the data structure) 1334 SB
721 1245 613 (corresponding to the MCI_TO flag.) 613 SB
721 1328 1396 (When the parser has reached the end of the input string, it finishes translating the) 1396 SB
721 1378 177 (command.) 177 SB
721 1461 1343 (Because the parser maps the string commands to message commands and data) 1343 SB
721 1511 1296 (structures passed to the driver, the order of the flags in a command string is) 1296 SB
721 1561 1322 (irrelevant. The command string \223play videodisc1 to 20 from 10 notify\224 maps) 1322 SB
721 1611 1432 (exactly to the same command derived from \223play videodisc1 notify from 10 to 20.\224) 1432 SB
721 1694 1338 (The parser checks only for syntax errors. It does not check the input string for) 1338 SB
721 1744 1423 (invalid combinations of flags. Before handling any MCI command, a driver should) 1423 SB
721 1794 1004 (determine whether there are invalid combinations of flags.) 1004 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 1902 32 (2) 32 SB
378 1902 1543 (.5.4  Providing Support for New Messages in DriverProc) 1543 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 1998 889 (After the command table has been defined, prepare ) 889 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1610 1997 214 (DriverProc) 214 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1824 1998 314 ( to handle the new) 314 SB
721 2048 1277 (messages. The procedures for this are the same as preparing it for existing) 1277 SB
721 2098 173 (messages.) 173 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
346 2206 32 (2) 32 SB
378 2206 1021 (.5.5  Registering the Command Table) 1021 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
721 2302 1404 (The final step is to notify the MCI parser that a custom command table exists. Do) 1404 SB
721 2352 1374 (this by making the following call in the driver\222s DRV_LOAD message handler:) 1374 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
721 2441 1260 (wTableEntry = mciLoadCommandResource \(hInstance, "pioneer", 0\);) 1260 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 27 def
/wp$fpage (27) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 28 28
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (28) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
634 496 1326 (This example loads the resource named \223pioneer,\224 registers it with MCI, and) 1326 SB
634 546 503 (returns a handle to that table.) 503 SB
634 629 1394 (If a driver uses a custom command table, it must free the table when it closes. To) 1394 SB
634 679 1327 (free the table, include the following call in the driver\222s DRV_FREE message) 1327 SB
634 729 141 (handler:) 141 SB
32 0 0 33 33 0 0 0 31 /LetrGothicMS /font35 ANSIFont font
634 818 940 (fResult = mciFreeCommandResource \(wTableEntry\);) 940 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 904 731 (Use the table index number returned from ) 731 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1365 903 534 (mciLoadCommandResource) 534 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1899 904 111 ( as the) 111 SB
634 954 1402 (parameter to this function. If the table index number is valid, this function returns) 1402 SB
634 1004 124 (TRUE.) 124 SB
32 0 0 71 71 0 0 0 68 /Helvetica-Narrow-Bold /font16 ANSIFont font
259 1112 32 (2) 32 SB
291 1112 1216 (.5.6  Search Order for MCI Command Tables) 1216 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
634 1208 1408 (The three types of tables MCI supports are core, device-type, and device-specific.) 1408 SB
634 1258 1339 (While parsing, the search order is from device-specific to device-type to core.) 1339 SB
634 1308 1444 (When a command is found in a table, the search ends. If a device-specific command) 1444 SB
634 1358 280 (table includes a ) 280 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
914 1357 80 (play) 80 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
994 1358 1065 ( command, the parser uses that one instead of the command in) 1065 SB
634 1408 695 (the device-type or core command tables.) 695 SB
634 1491 1400 (Command tables can reside in external files or can be bound to a driver. External) 1400 SB
634 1541 1399 (files are simply DLLs containing only the compiled command table. A table for a) 1399 SB
634 1591 1433 (device-specific command set must use the same table name used by the driver in its) 1433 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1640 534 (mciLoadCommandResource) 534 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1168 1641 821 ( call. The DLL must use MCI for the extension.) 821 SB
634 1691 1447 (Avoid using the names of MCI device types as filenames. Using a device-type name) 1447 SB
634 1741 1227 (will prevent other devices from using the default MCI command tables.) 1227 SB
634 1824 1394 (If a driver is for a new device type and the command table it uses is type-specific) 1394 SB
634 1874 1387 (\(that is, it is not a custom or device-specific command table\), the command table) 1387 SB
634 1924 609 (does not need to be registered with ) 609 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
1243 1923 534 (mciLoadCommandResource) 534 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1777 1924 188 (. When the) 188 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
634 1973 125 (wType) 125 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
759 1974 1158 ( member of the MCI_OPEN_DRIVER_PARMS structure contains) 1158 SB
634 2024 1334 (MCI_DEVTYPE_OTHER, MCI automatically searches for the type-specific) 1334 SB
634 2074 1411 (command table. To obtain the filename, MCI searches the registry for the driver\222s) 1411 SB
634 2124 1134 (name and uses this name to load the type-specific command table.) 1134 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 28 def
/wp$fpage (28) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 29 29
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1501 378 133 (Chapter ) 133 SB
1634 378 18 (2) 18 SB
1652 378 323 (    Win32 MCI Drivers) 323 SB
1975 378 9 ( ) 61 SB
2036 378 9 ( ) 61 SB
2097 378 9 ( ) 9 SB
2106 378 18 (2) 18 SB
2124 378 11 (-) 11 SB
2135 378 36 (29) 36 SB
0 0 0 fC
/fm 256 def
1824 2 346 435 B
1 F
n
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
0 0 0 fC
721 496 1410 (MCI gives priority to the command tables contained in external files. Therefore, a) 1410 SB
721 546 1279 (driver can use the command tables in external files to supersede the bound) 1279 SB
721 596 1433 (command tables. For example, the command table bound with a driver could be the) 1433 SB
721 646 1275 (most commonly used table. A foreign language version of the driver could) 1275 SB
721 696 1342 (supersede the internal table with a foreign language command table by simply) 1342 SB
721 746 1448 (including it in an external file. Command tables must be in a directory accessible by) 1448 SB
721 796 193 (the Win32 ) 193 SB
32 0 0 44 44 0 0 0 41 /Times-Bold /font29 ANSIFont font
914 795 199 (CreateFile) 199 SB
32 0 0 44 44 0 0 0 40 /Times-Roman /font32 ANSIFont font
1113 796 163 ( function.) 163 SB
721 879 1326 (Command tables in external files can also contain string resources. MCI also) 1326 SB
721 929 1355 (searches for string resources in an external command file before searching in a) 1355 SB
721 979 274 (bound resource.) 274 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 29 def
/wp$fpage (29) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 30 30
%%PageResources: (atend)
SS
0 0 20 11 809 1100 300 SM
32 0 0 40 40 0 0 0 39 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
259 378 18 (2) 18 SB
277 378 11 (-) 11 SB
288 378 36 (30) 36 SB
324 378 9 ( ) 61 SB
385 378 9 ( ) 61 SB
446 378 528 (Part V    Win32 Multimedia Drivers) 528 SB
0 0 0 fC
/fm 256 def
1824 2 259 435 B
1 F
n
32 0 0 63 63 1 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1189 579 339 (BLANK PAGE) 339 SB
32 0 0 63 63 0 0 0 60 /Helvetica-Narrow-Bold /font16 ANSIFont font
634 752 1391 (IMPORTANT: This text will appear on screen, but will not) 1391 SB
634 825 700 (print on a PostScript printer.) 700 SB
634 931 1449 (This page should be the last one in this file; it was inserted) 1449 SB
634 1004 965 (by running the InsertBlankPage macro.) 965 SB
634 1110 1091 (Do not type any additional text on this page!) 1091 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 30 def
/wp$fpage (30) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def
1 setgray 41.5 73 moveto 0 646 rlineto 529 0 rlineto 0 646 neg rlineto closepath fill
 grestore
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 30 def
/wp$fpage (30) def
/wp$date (07/19/93) def
/wp$time (05:20 PM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 111 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bind def
/ed{exch def}bind def
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft 76 sub dTop moveto 72 0 rlineto dLeft 76 sub dBot moveto 72 0 rlineto
  dRight 4 add dTop moveto 72 0 rlineto dRight 4 add dBot moveto 72 0 rlineto
  dLeft dTop 76 add moveto 0 -72 rlineto dRight dTop 76 add moveto 0 -72 rlineto
  dLeft dBot 4 sub moveto 0 -72 rlineto dRight dBot 4 sub moveto 0 -72 rlineto
  stroke grestore}ndf
/DoPageBox {gsave 0 setgray /dopaint true def 0.25 setlinewidth
  dLeft dTop moveto dRight dTop lineto dRight dBot lineto dLeft dBot lineto
  closepath stroke grestore}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%Trailer
SVDoc restore
end
%%Pages: 30
% TrueType font name key:
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT31c1cf = 0887DArial NarrowF00000028000002bc0000
%    MSTT31c1db = 0887DTimes New RomanF00000019000001900000
%    MSTT31c1e8 = 0887DTimes New RomanF00000015000001900000
%    MSTT31c1f5 = 0887DTimes New RomanF00000032000001900000
%    MSTT31c202 = 0887DTimes New RomanF00000000000001900000
%    MSTT31c20f = 0887DArial NarrowF0000002c000002bc0000
%    MSTT31c21b = 0887DArial NarrowF00000021000002bc0000
%    MSTT31c227 = 0887DTimes New RomanF0000002c000001900000
%    MSTT31c234 = 0887DTimes New RomanF00000021000001900000
%    MSTT31c1c1 = 0887DArial NarrowF00000064000002bc0000
%    MSTT31c241 = 0887DArial NarrowF00000026000001900000
%    MSTT31c24d = 0887DArial NarrowF00000053000002bc0000
%    MSTT31c267 = 0887DTimes New RomanF0000001d000001900000
%    MSTT31c274 = 0887DTimes New RomanF0000002c000002bc0000
%    MSTT31c281 = 0887DMSIconsF00000028000001900000
%    MSTT31c28c = 0887DTimes New RomanF0000002c000001900001
%    MSTT31c299 = 0887DLucida Sans TypewriterF00000021000001900000
%    MSTT31c2a8 = 0887DArial NarrowF00000047000002bc0000
%    MSTT31c2b4 = 0887DTimes New RomanF00000028000002bc0000
%    MSTT31c2c1 = 0887DTimes New RomanF00000028000001900000
%    MSTT31c2ce = 0887DTimes New RomanF00000011000001900000
%    MSTT31c2db = 0887DArial NarrowF0000003f000002bc0000
%%DocumentSuppliedResources: procset Win35Dict 3 1

%%DocumentNeededResources: font Helvetica-Narrow
%%+ font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons2
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman

%%EOF
