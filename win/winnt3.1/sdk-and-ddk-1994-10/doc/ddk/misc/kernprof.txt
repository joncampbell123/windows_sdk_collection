                  Windows NT Kernel Profiler
                  --------------------------


The Windows NT Kernel Profiler is a tool for looking into the
operation of the system at the lowest levels.  It displays where
Windows NT is spending it's time in Privileged Mode.  This inlcudes
time in the executive/kernel module ntoskrnl.exe, as well as in the
Hardware Abstraction Layer (hal.dll) and non-display device drivers.

Usage:
------

  kernprof  TimeToRun   [ThresholdCount]

            TimeToRun       - Length of measurement run in seconds

            ThresholdCount  - Buckets with counts below this number
                              are not output

Operation:
----------

The kernel profiler runs for the number of seconds specified.  During
profiling the system will be interrutped once every millisecond.  If
the interrupt occurs when the system is in Privileged Mode, then a
count is added to a bucket associated with the public symbol in the
privileged module that was executing.

At the end of the specified run time kernprof will display on the
console device a count for each symbol encountered.  This may be
redirected to a file, e.g.:

    kernprof 300 10 >kernprof.out

For a symbol to be displayed it's count must be greater than or equal
to the ThresholdCount.  The default ThresholdCount is 100.

Hints:
------

You will want to use the User Manager to assign yourself the Advanced
User Rights "Profile system performance" and "Increase Quotas".

When running kernprof on MIPS machines, you must make a copy of
hal.dll from the system partition and place it in
%SystemRoot%\system32.

Caveats:
--------

You MUST be running on the checked build of Windows NT to use the
kernel profiler.  The free build does not have the right type of
symbols for profiling.  Because the checked build of the system has
extra error checking in the code, you should ignore the time spent in
the system as measured by the kernel profiler, and focus on the time
spent in your application.

You can measure time in the system on the free build if you first load
the .dll's with symbols provided in the SDK and then use WAP or CAP.
Those .dll's do not provide enough symbols for profiling.
