%!PS-Adobe-3.0
%%Creator: Windows PSCRIPT
%%Title: Microsoft Word - DLL.DOC
%%BoundingBox: 14 9 597 784
%%DocumentNeededResources: (atend)
%%DocumentSuppliedResources: (atend)
%%Pages: (atend)
%%BeginResource: procset Win35Dict 3 1
/Win35Dict 290 dict def Win35Dict begin/bd{bind def}bind def/in{72
mul}bd/ed{exch def}bd/ld{load def}bd/tr/translate ld/gs/gsave ld/gr
/grestore ld/M/moveto ld/L/lineto ld/rmt/rmoveto ld/rlt/rlineto ld
/rct/rcurveto ld/st/stroke ld/n/newpath ld/sm/setmatrix ld/cm/currentmatrix
ld/cp/closepath ld/ARC/arcn ld/TR{65536 div}bd/lj/setlinejoin ld/lc
/setlinecap ld/ml/setmiterlimit ld/sl/setlinewidth ld/scignore false
def/sc{scignore{pop pop pop}{0 index 2 index eq 2 index 4 index eq
and{pop pop 255 div setgray}{3{255 div 3 1 roll}repeat setrgbcolor}ifelse}ifelse}bd
/FC{bR bG bB sc}bd/fC{/bB ed/bG ed/bR ed}bd/HC{hR hG hB sc}bd/hC{
/hB ed/hG ed/hR ed}bd/PC{pR pG pB sc}bd/pC{/pB ed/pG ed/pR ed}bd/sM
matrix def/PenW 1 def/iPen 5 def/mxF matrix def/mxE matrix def/mxUE
matrix def/mxUF matrix def/fBE false def/iDevRes 72 0 matrix defaultmatrix
dtransform dup mul exch dup mul add sqrt def/fPP false def/SS{fPP{
/SV save def}{gs}ifelse}bd/RS{fPP{SV restore}{gr}ifelse}bd/EJ{gsave
showpage grestore}bd/#C{userdict begin/#copies ed end}bd/FEbuf 2 string
def/FEglyph(G  )def/FE{1 exch{dup 16 FEbuf cvrs FEglyph exch 1 exch
putinterval 1 index exch FEglyph cvn put}for}bd/SM{/iRes ed/cyP ed
/cxPg ed/cyM ed/cxM ed 72 100 div dup scale dup 0 ne{90 eq{cyM exch
0 eq{cxM exch tr -90 rotate -1 1 scale}{cxM cxPg add exch tr +90 rotate}ifelse}{cyP
cyM sub exch 0 ne{cxM exch tr -90 rotate}{cxM cxPg add exch tr -90
rotate 1 -1 scale}ifelse}ifelse}{pop cyP cyM sub exch 0 ne{cxM cxPg
add exch tr 180 rotate}{cxM exch tr 1 -1 scale}ifelse}ifelse 100 iRes
div dup scale 0 0 transform .25 add round .25 sub exch .25 add round
.25 sub exch itransform translate}bd/SJ{1 index 0 eq{pop pop/fBE false
def}{1 index/Break ed div/dxBreak ed/fBE true def}ifelse}bd/ANSIVec[
16#0/grave 16#1/acute 16#2/circumflex 16#3/tilde 16#4/macron 16#5/breve
16#6/dotaccent 16#7/dieresis 16#8/ring 16#9/cedilla 16#A/hungarumlaut
16#B/ogonek 16#C/caron 16#D/dotlessi 16#27/quotesingle 16#60/grave
16#7C/bar 16#82/quotesinglbase 16#83/florin 16#84/quotedblbase 16#85
/ellipsis 16#86/dagger 16#87/daggerdbl 16#89/perthousand 16#8A/Scaron
16#8B/guilsinglleft 16#8C/OE 16#91/quoteleft 16#92/quoteright 16#93
/quotedblleft 16#94/quotedblright 16#95/bullet 16#96/endash 16#97
/emdash 16#99/trademark 16#9A/scaron 16#9B/guilsinglright 16#9C/oe
16#9F/Ydieresis 16#A0/space 16#A4/currency 16#A6/brokenbar 16#A7/section
16#A8/dieresis 16#A9/copyright 16#AA/ordfeminine 16#AB/guillemotleft
16#AC/logicalnot 16#AD/hyphen 16#AE/registered 16#AF/macron 16#B0/degree
16#B1/plusminus 16#B2/twosuperior 16#B3/threesuperior 16#B4/acute 16#B5
/mu 16#B6/paragraph 16#B7/periodcentered 16#B8/cedilla 16#B9/onesuperior
16#BA/ordmasculine 16#BB/guillemotright 16#BC/onequarter 16#BD/onehalf
16#BE/threequarters 16#BF/questiondown 16#C0/Agrave 16#C1/Aacute 16#C2
/Acircumflex 16#C3/Atilde 16#C4/Adieresis 16#C5/Aring 16#C6/AE 16#C7
/Ccedilla 16#C8/Egrave 16#C9/Eacute 16#CA/Ecircumflex 16#CB/Edieresis
16#CC/Igrave 16#CD/Iacute 16#CE/Icircumflex 16#CF/Idieresis 16#D0/Eth
16#D1/Ntilde 16#D2/Ograve 16#D3/Oacute 16#D4/Ocircumflex 16#D5/Otilde
16#D6/Odieresis 16#D7/multiply 16#D8/Oslash 16#D9/Ugrave 16#DA/Uacute
16#DB/Ucircumflex 16#DC/Udieresis 16#DD/Yacute 16#DE/Thorn 16#DF/germandbls
16#E0/agrave 16#E1/aacute 16#E2/acircumflex 16#E3/atilde 16#E4/adieresis
16#E5/aring 16#E6/ae 16#E7/ccedilla 16#E8/egrave 16#E9/eacute 16#EA
/ecircumflex 16#EB/edieresis 16#EC/igrave 16#ED/iacute 16#EE/icircumflex
16#EF/idieresis 16#F0/eth 16#F1/ntilde 16#F2/ograve 16#F3/oacute 16#F4
/ocircumflex 16#F5/otilde 16#F6/odieresis 16#F7/divide 16#F8/oslash
16#F9/ugrave 16#FA/uacute 16#FB/ucircumflex 16#FC/udieresis 16#FD/yacute
16#FE/thorn 16#FF/ydieresis ] def/reencdict 12 dict def/IsChar{basefontdict
/CharStrings get exch known}bd/MapCh{dup IsChar not{pop/bullet}if
newfont/Encoding get 3 1 roll put}bd/MapDegree{16#b0/degree IsChar{
/degree}{/ring}ifelse MapCh}bd/MapBB{16#a6/brokenbar IsChar{/brokenbar}{
/bar}ifelse MapCh}bd/ANSIFont{reencdict begin/newfontname ed/basefontname
ed FontDirectory newfontname known not{/basefontdict basefontname findfont
def/newfont basefontdict maxlength dict def basefontdict{exch dup/FID
ne{dup/Encoding eq{exch dup length array copy newfont 3 1 roll put}{exch
newfont 3 1 roll put}ifelse}{pop pop}ifelse}forall newfont/FontName
newfontname put 127 1 159{newfont/Encoding get exch/bullet put}for
ANSIVec aload pop ANSIVec length 2 idiv{MapCh}repeat MapDegree MapBB
newfontname newfont definefont pop}if newfontname end}bd/SB{FC/ULlen
ed/str ed str length fBE not{dup 1 gt{1 sub}if}if/cbStr ed/dxGdi ed
/y0 ed/x0 ed str stringwidth dup 0 ne{/y1 ed/x1 ed y1 y1 mul x1 x1
mul add sqrt dxGdi exch div 1 sub dup x1 mul cbStr div exch y1 mul
cbStr div}{exch abs neg dxGdi add cbStr div exch}ifelse/dyExtra ed
/dxExtra ed x0 y0 M fBE{dxBreak 0 BCh dxExtra dyExtra str awidthshow}{dxExtra
dyExtra str ashow}ifelse fUL{x0 y0 M dxUL dyUL rmt ULlen fBE{Break
add}if 0 mxUE transform gs rlt cyUL sl [] 0 setdash st gr}if fSO{x0
y0 M dxSO dySO rmt ULlen fBE{Break add}if 0 mxUE transform gs rlt cyUL
sl [] 0 setdash st gr}if n/fBE false def}bd/font{/name ed/Ascent ed
0 ne/fT3 ed 0 ne/fSO ed 0 ne/fUL ed/Sy ed/Sx ed 10.0 div/ori ed -10.0
div/esc ed/BCh ed name findfont/xAscent 0 def/yAscent Ascent def/ULesc
esc def ULesc mxUE rotate pop fT3{/esc 0 def xAscent yAscent mxUE transform
/yAscent ed/xAscent ed}if [Sx 0 0 Sy neg xAscent yAscent] esc mxE
rotate mxF concatmatrix makefont setfont [Sx 0 0 Sy neg 0 Ascent] mxUE
mxUF concatmatrix pop fUL{currentfont dup/FontInfo get/UnderlinePosition
known not{pop/Courier findfont}if/FontInfo get/UnderlinePosition get
1000 div 0 exch mxUF transform/dyUL ed/dxUL ed}if fSO{0 .3 mxUF transform
/dySO ed/dxSO ed}if fUL fSO or{currentfont dup/FontInfo get/UnderlineThickness
known not{pop/Courier findfont}if/FontInfo get/UnderlineThickness get
1000 div Sy mul/cyUL ed}if}bd/min{2 copy gt{exch}if pop}bd/max{2 copy
lt{exch}if pop}bd/CP{/ft ed{{ft 0 eq{clip}{eoclip}ifelse}stopped{currentflat
1 add setflat}{exit}ifelse}loop}bd/patfont 10 dict def patfont begin
/FontType 3 def/FontMatrix [1 0 0 -1 0 0] def/FontBBox [0 0 16 16]
def/Encoding StandardEncoding def/BuildChar{pop pop 16 0 0 0 16 16
setcachedevice 16 16 false [1 0 0 1 .25 .25]{pat}imagemask}bd end/p{
/pat 32 string def{}forall 0 1 7{dup 2 mul pat exch 3 index put dup
2 mul 1 add pat exch 3 index put dup 2 mul 16 add pat exch 3 index
put 2 mul 17 add pat exch 2 index put pop}for}bd/pfill{/PatFont patfont
definefont setfont/ch(AAAA)def X0 64 X1{Y1 -16 Y0{1 index exch M ch
show}for pop}for}bd/vert{X0 w X1{dup Y0 M Y1 L st}for}bd/horz{Y0 w
Y1{dup X0 exch M X1 exch L st}for}bd/fdiag{X0 w X1{Y0 M X1 X0 sub dup
rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup rlt st}for}bd/bdiag{X0 w
X1{Y1 M X1 X0 sub dup neg rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup
neg rlt st}for}bd/AU{1 add cvi 15 or}bd/AD{1 sub cvi -16 and}bd/SHR{pathbbox
AU/Y1 ed AU/X1 ed AD/Y0 ed AD/X0 ed}bd/hfill{/w iRes 37.5 div round
def 0.1 sl [] 0 setdash n dup 0 eq{horz}if dup 1 eq{vert}if dup 2 eq{fdiag}if
dup 3 eq{bdiag}if dup 4 eq{horz vert}if 5 eq{fdiag bdiag}if}bd/F{/ft
ed fm 256 and 0 ne{gs FC ft 0 eq{fill}{eofill}ifelse gr}if fm 1536
and 0 ne{SHR gs HC ft CP fm 1024 and 0 ne{/Tmp save def pfill Tmp restore}{fm
15 and hfill}ifelse gr}if}bd/S{PenW sl PC st}bd/m matrix def/GW{iRes
12 div PenW add cvi}bd/DoW{iRes 50 div PenW add cvi}bd/DW{iRes 8 div
PenW add cvi}bd/SP{/PenW ed/iPen ed iPen 0 eq iPen 6 eq or{[] 0 setdash}if
iPen 1 eq{[DW GW] 0 setdash}if iPen 2 eq{[DoW GW] 0 setdash}if iPen
3 eq{[DW GW DoW GW] 0 setdash}if iPen 4 eq{[DW GW DoW GW DoW GW] 0
setdash}if}bd/E{m cm pop tr scale 1 0 moveto 0 0 1 0 360 arc cp m sm}bd
/AG{/sy ed/sx ed sx div 4 1 roll sy div 4 1 roll sx div 4 1 roll sy
div 4 1 roll atan/a2 ed atan/a1 ed sx sy scale a1 a2 ARC}def/A{m cm
pop tr AG m sm}def/P{m cm pop tr 0 0 M AG cp m sm}def/RRect{n 4 copy
M 3 1 roll exch L 4 2 roll L L cp}bd/RRCC{/r ed/y1 ed/x1 ed/y0 ed/x0
ed x0 x1 add 2 div y0 M x1 y0 x1 y1 r arcto 4{pop}repeat x1 y1 x0 y1
r arcto 4{pop}repeat x0 y1 x0 y0 r arcto 4{pop}repeat x0 y0 x1 y0 r
arcto 4{pop}repeat cp}bd/RR{2 copy 0 eq exch 0 eq or{pop pop RRect}{2
copy eq{pop RRCC}{m cm pop/y2 ed/x2 ed/ys y2 x2 div 1 max def/xs x2
y2 div 1 max def/y1 exch ys div def/x1 exch xs div def/y0 exch ys div
def/x0 exch xs div def/r2 x2 y2 min def xs ys scale x0 x1 add 2 div
y0 M x1 y0 x1 y1 r2 arcto 4{pop}repeat x1 y1 x0 y1 r2 arcto 4{pop}repeat
x0 y1 x0 y0 r2 arcto 4{pop}repeat x0 y0 x1 y0 r2 arcto 4{pop}repeat
m sm cp}ifelse}ifelse}bd/PP{{rlt}repeat}bd/OB{gs 0 ne{7 3 roll/y ed
/x ed x y translate ULesc rotate x neg y neg translate x y 7 -3 roll}if
sc B fill gr}bd/B{M/dy ed/dx ed dx 0 rlt 0 dy rlt dx neg 0 rlt cp}bd
/CB{B clip n}bd/ErrHandler{errordict dup maxlength exch length gt
dup{errordict begin}if/errhelpdict 12 dict def errhelpdict begin/stackunderflow(operand stack underflow)def
/undefined(this name is not defined in a dictionary)def/VMerror(you have used up all the printer's memory)def
/typecheck(operator was expecting a different type of operand)def
/ioerror(input/output error occured)def end{end}if errordict begin
/handleerror{$error begin newerror{/newerror false def showpage 72
72 scale/x .25 def/y 9.6 def/Helvetica findfont .2 scalefont setfont
x y moveto(Offending Command = )show/command load{dup type/stringtype
ne{(max err string)cvs}if show}exec/y y .2 sub def x y moveto(Error = )show
errorname{dup type dup( max err string )cvs show( : )show/stringtype
ne{( max err string )cvs}if show}exec errordict begin errhelpdict errorname
known{x 1 add y .2 sub moveto errhelpdict errorname get show}if end
/y y .4 sub def x y moveto(Stack =)show ostack{/y y .2 sub def x 1
add y moveto dup type/stringtype ne{( max err string )cvs}if show}forall
showpage}if end}def end}bd end
%%EndResource
/SVDoc save def
%%EndProlog
%%BeginSetup
Win35Dict begin
ErrHandler
statusdict begin 0 setjobtimeout end
statusdict begin statusdict /jobname (Microsoft Word - DLL.DOC) put end
/oldDictCnt countdictstack def {}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
/oldDictCnt countdictstack def {letter
}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
[{ }
/exec load currenttransfer /exec load] cvx settransfer
/setresolution where { pop 1200 1200 setresolution } if
%%EndSetup
%%Page: 1 1
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
8469 1517 216 (171) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 200 200 0 0 0 180 /Times-Roman /font32 ANSIFont font
0 0 0 fC
1385 1965 133 (C) 233 SB
1618 1965 144 (H) 244 SB
1862 1965 144 (A) 244 SB
2106 1965 111 (P) 211 SB
2317 1965 122 (T) 222 SB
2539 1965 122 (E) 222 SB
2761 1965 133 (R) 233 SB
2994 1965 50 ( ) 150 SB
3144 1965 100 (5) 200 SB
3344 1965 100 (0) 200 SB
32 0 0 400 400 0 0 0 373 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 5600 2050 1384 2419 CB
1384 2406 3623 (Dynamic-Link Libraries) 3623 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4473 2589 (50.1  About Dynamic-Link Libraries) 2589 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5478 4510 33 (.) 83 SB
5561 4510 33 (.) 83 SB
5644 4510 33 (.) 83 SB
5727 4510 33 (.) 83 SB
5810 4510 33 (.) 83 SB
5893 4510 33 (.) 83 SB
5976 4510 33 (.) 83 SB
6059 4510 33 (.) 83 SB
6142 4510 33 (.) 83 SB
6225 4510 33 (.) 83 SB
6308 4510 33 (.) 83 SB
6391 4510 33 (.) 83 SB
6474 4510 33 (.) 83 SB
6557 4510 33 (.) 83 SB
6640 4510 33 (.) 83 SB
6723 4510 33 (.) 83 SB
6806 4510 33 (.) 83 SB
6889 4510 33 (.) 83 SB
6972 4510 33 (.) 83 SB
7055 4510 33 (.) 83 SB
7138 4510 33 (.) 83 SB
7221 4510 33 (.) 83 SB
7304 4510 33 (.) 83 SB
7387 4510 33 (.) 83 SB
7470 4510 33 (.) 83 SB
7553 4510 33 (.) 83 SB
7636 4510 33 (.) 83 SB
7719 4510 33 (.) 83 SB
7802 4510 33 (.) 83 SB
7885 4510 33 (.) 83 SB
7968 4510 33 (.) 83 SB
8051 4510 33 (.) 83 SB
8134 4510 33 (.) 83 SB
8217 4510 33 (.) 83 SB
8300 4510 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 4473 264 (172) 264 SB
3118 4706 2835 (50.1.1  Advantages of Dynamic Linking) 2835 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5976 4743 33 (.) 83 SB
6059 4743 33 (.) 83 SB
6142 4743 33 (.) 83 SB
6225 4743 33 (.) 83 SB
6308 4743 33 (.) 83 SB
6391 4743 33 (.) 83 SB
6474 4743 33 (.) 83 SB
6557 4743 33 (.) 83 SB
6640 4743 33 (.) 83 SB
6723 4743 33 (.) 83 SB
6806 4743 33 (.) 83 SB
6889 4743 33 (.) 83 SB
6972 4743 33 (.) 83 SB
7055 4743 33 (.) 83 SB
7138 4743 33 (.) 83 SB
7221 4743 33 (.) 83 SB
7304 4743 33 (.) 83 SB
7387 4743 33 (.) 83 SB
7470 4743 33 (.) 83 SB
7553 4743 33 (.) 83 SB
7636 4743 33 (.) 83 SB
7719 4743 33 (.) 83 SB
7802 4743 33 (.) 83 SB
7885 4743 33 (.) 83 SB
7968 4743 33 (.) 83 SB
8051 4743 33 (.) 83 SB
8134 4743 33 (.) 83 SB
8217 4743 33 (.) 83 SB
8300 4743 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 4706 264 (173) 264 SB
3118 4939 2780 (50.1.2  Dynamic-Link Library Creation) 2780 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5976 4976 33 (.) 83 SB
6059 4976 33 (.) 83 SB
6142 4976 33 (.) 83 SB
6225 4976 33 (.) 83 SB
6308 4976 33 (.) 83 SB
6391 4976 33 (.) 83 SB
6474 4976 33 (.) 83 SB
6557 4976 33 (.) 83 SB
6640 4976 33 (.) 83 SB
6723 4976 33 (.) 83 SB
6806 4976 33 (.) 83 SB
6889 4976 33 (.) 83 SB
6972 4976 33 (.) 83 SB
7055 4976 33 (.) 83 SB
7138 4976 33 (.) 83 SB
7221 4976 33 (.) 83 SB
7304 4976 33 (.) 83 SB
7387 4976 33 (.) 83 SB
7470 4976 33 (.) 83 SB
7553 4976 33 (.) 83 SB
7636 4976 33 (.) 83 SB
7719 4976 33 (.) 83 SB
7802 4976 33 (.) 83 SB
7885 4976 33 (.) 83 SB
7968 4976 33 (.) 83 SB
8051 4976 33 (.) 83 SB
8134 4976 33 (.) 83 SB
8217 4976 33 (.) 83 SB
8300 4976 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 4939 264 (173) 264 SB
3118 5172 2650 (50.1.3  The DLL Entrypoint Function) 2650 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5810 5209 33 (.) 83 SB
5893 5209 33 (.) 83 SB
5976 5209 33 (.) 83 SB
6059 5209 33 (.) 83 SB
6142 5209 33 (.) 83 SB
6225 5209 33 (.) 83 SB
6308 5209 33 (.) 83 SB
6391 5209 33 (.) 83 SB
6474 5209 33 (.) 83 SB
6557 5209 33 (.) 83 SB
6640 5209 33 (.) 83 SB
6723 5209 33 (.) 83 SB
6806 5209 33 (.) 83 SB
6889 5209 33 (.) 83 SB
6972 5209 33 (.) 83 SB
7055 5209 33 (.) 83 SB
7138 5209 33 (.) 83 SB
7221 5209 33 (.) 83 SB
7304 5209 33 (.) 83 SB
7387 5209 33 (.) 83 SB
7470 5209 33 (.) 83 SB
7553 5209 33 (.) 83 SB
7636 5209 33 (.) 83 SB
7719 5209 33 (.) 83 SB
7802 5209 33 (.) 83 SB
7885 5209 33 (.) 83 SB
7968 5209 33 (.) 83 SB
8051 5209 33 (.) 83 SB
8134 5209 33 (.) 83 SB
8217 5209 33 (.) 83 SB
8300 5209 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5172 264 (174) 264 SB
3118 5405 2489 (50.1.4  The Module-Definition File) 2489 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5644 5442 33 (.) 83 SB
5727 5442 33 (.) 83 SB
5810 5442 33 (.) 83 SB
5893 5442 33 (.) 83 SB
5976 5442 33 (.) 83 SB
6059 5442 33 (.) 83 SB
6142 5442 33 (.) 83 SB
6225 5442 33 (.) 83 SB
6308 5442 33 (.) 83 SB
6391 5442 33 (.) 83 SB
6474 5442 33 (.) 83 SB
6557 5442 33 (.) 83 SB
6640 5442 33 (.) 83 SB
6723 5442 33 (.) 83 SB
6806 5442 33 (.) 83 SB
6889 5442 33 (.) 83 SB
6972 5442 33 (.) 83 SB
7055 5442 33 (.) 83 SB
7138 5442 33 (.) 83 SB
7221 5442 33 (.) 83 SB
7304 5442 33 (.) 83 SB
7387 5442 33 (.) 83 SB
7470 5442 33 (.) 83 SB
7553 5442 33 (.) 83 SB
7636 5442 33 (.) 83 SB
7719 5442 33 (.) 83 SB
7802 5442 33 (.) 83 SB
7885 5442 33 (.) 83 SB
7968 5442 33 (.) 83 SB
8051 5442 33 (.) 83 SB
8134 5442 33 (.) 83 SB
8217 5442 33 (.) 83 SB
8300 5442 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5405 264 (175) 264 SB
3118 5638 2605 (50.1.5  Load-Time Dynamic Linking) 2605 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5727 5675 33 (.) 83 SB
5810 5675 33 (.) 83 SB
5893 5675 33 (.) 83 SB
5976 5675 33 (.) 83 SB
6059 5675 33 (.) 83 SB
6142 5675 33 (.) 83 SB
6225 5675 33 (.) 83 SB
6308 5675 33 (.) 83 SB
6391 5675 33 (.) 83 SB
6474 5675 33 (.) 83 SB
6557 5675 33 (.) 83 SB
6640 5675 33 (.) 83 SB
6723 5675 33 (.) 83 SB
6806 5675 33 (.) 83 SB
6889 5675 33 (.) 83 SB
6972 5675 33 (.) 83 SB
7055 5675 33 (.) 83 SB
7138 5675 33 (.) 83 SB
7221 5675 33 (.) 83 SB
7304 5675 33 (.) 83 SB
7387 5675 33 (.) 83 SB
7470 5675 33 (.) 83 SB
7553 5675 33 (.) 83 SB
7636 5675 33 (.) 83 SB
7719 5675 33 (.) 83 SB
7802 5675 33 (.) 83 SB
7885 5675 33 (.) 83 SB
7968 5675 33 (.) 83 SB
8051 5675 33 (.) 83 SB
8134 5675 33 (.) 83 SB
8217 5675 33 (.) 83 SB
8300 5675 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5638 264 (176) 264 SB
3118 5871 2537 (50.1.6  Run-Time Dynamic Linking) 2537 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5727 5908 33 (.) 83 SB
5810 5908 33 (.) 83 SB
5893 5908 33 (.) 83 SB
5976 5908 33 (.) 83 SB
6059 5908 33 (.) 83 SB
6142 5908 33 (.) 83 SB
6225 5908 33 (.) 83 SB
6308 5908 33 (.) 83 SB
6391 5908 33 (.) 83 SB
6474 5908 33 (.) 83 SB
6557 5908 33 (.) 83 SB
6640 5908 33 (.) 83 SB
6723 5908 33 (.) 83 SB
6806 5908 33 (.) 83 SB
6889 5908 33 (.) 83 SB
6972 5908 33 (.) 83 SB
7055 5908 33 (.) 83 SB
7138 5908 33 (.) 83 SB
7221 5908 33 (.) 83 SB
7304 5908 33 (.) 83 SB
7387 5908 33 (.) 83 SB
7470 5908 33 (.) 83 SB
7553 5908 33 (.) 83 SB
7636 5908 33 (.) 83 SB
7719 5908 33 (.) 83 SB
7802 5908 33 (.) 83 SB
7885 5908 33 (.) 83 SB
7968 5908 33 (.) 83 SB
8051 5908 33 (.) 83 SB
8134 5908 33 (.) 83 SB
8217 5908 33 (.) 83 SB
8300 5908 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5871 264 (177) 264 SB
3118 6104 2506 (50.1.7  Dynamic-Link Library Data) 2506 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5644 6141 33 (.) 83 SB
5727 6141 33 (.) 83 SB
5810 6141 33 (.) 83 SB
5893 6141 33 (.) 83 SB
5976 6141 33 (.) 83 SB
6059 6141 33 (.) 83 SB
6142 6141 33 (.) 83 SB
6225 6141 33 (.) 83 SB
6308 6141 33 (.) 83 SB
6391 6141 33 (.) 83 SB
6474 6141 33 (.) 83 SB
6557 6141 33 (.) 83 SB
6640 6141 33 (.) 83 SB
6723 6141 33 (.) 83 SB
6806 6141 33 (.) 83 SB
6889 6141 33 (.) 83 SB
6972 6141 33 (.) 83 SB
7055 6141 33 (.) 83 SB
7138 6141 33 (.) 83 SB
7221 6141 33 (.) 83 SB
7304 6141 33 (.) 83 SB
7387 6141 33 (.) 83 SB
7470 6141 33 (.) 83 SB
7553 6141 33 (.) 83 SB
7636 6141 33 (.) 83 SB
7719 6141 33 (.) 83 SB
7802 6141 33 (.) 83 SB
7885 6141 33 (.) 83 SB
7968 6141 33 (.) 83 SB
8051 6141 33 (.) 83 SB
8134 6141 33 (.) 83 SB
8217 6141 33 (.) 83 SB
8300 6141 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6104 264 (178) 264 SB
2885 6337 2569 (50.2  Using Dynamic-Link Libraries) 2569 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5478 6374 33 (.) 83 SB
5561 6374 33 (.) 83 SB
5644 6374 33 (.) 83 SB
5727 6374 33 (.) 83 SB
5810 6374 33 (.) 83 SB
5893 6374 33 (.) 83 SB
5976 6374 33 (.) 83 SB
6059 6374 33 (.) 83 SB
6142 6374 33 (.) 83 SB
6225 6374 33 (.) 83 SB
6308 6374 33 (.) 83 SB
6391 6374 33 (.) 83 SB
6474 6374 33 (.) 83 SB
6557 6374 33 (.) 83 SB
6640 6374 33 (.) 83 SB
6723 6374 33 (.) 83 SB
6806 6374 33 (.) 83 SB
6889 6374 33 (.) 83 SB
6972 6374 33 (.) 83 SB
7055 6374 33 (.) 83 SB
7138 6374 33 (.) 83 SB
7221 6374 33 (.) 83 SB
7304 6374 33 (.) 83 SB
7387 6374 33 (.) 83 SB
7470 6374 33 (.) 83 SB
7553 6374 33 (.) 83 SB
7636 6374 33 (.) 83 SB
7719 6374 33 (.) 83 SB
7802 6374 33 (.) 83 SB
7885 6374 33 (.) 83 SB
7968 6374 33 (.) 83 SB
8051 6374 33 (.) 83 SB
8134 6374 33 (.) 83 SB
8217 6374 33 (.) 83 SB
8300 6374 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6337 264 (179) 264 SB
3118 6570 3443 (50.2.1  Creating a Simple Dynamic-Link Library) 3443 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
6640 6607 33 (.) 83 SB
6723 6607 33 (.) 83 SB
6806 6607 33 (.) 83 SB
6889 6607 33 (.) 83 SB
6972 6607 33 (.) 83 SB
7055 6607 33 (.) 83 SB
7138 6607 33 (.) 83 SB
7221 6607 33 (.) 83 SB
7304 6607 33 (.) 83 SB
7387 6607 33 (.) 83 SB
7470 6607 33 (.) 83 SB
7553 6607 33 (.) 83 SB
7636 6607 33 (.) 83 SB
7719 6607 33 (.) 83 SB
7802 6607 33 (.) 83 SB
7885 6607 33 (.) 83 SB
7968 6607 33 (.) 83 SB
8051 6607 33 (.) 83 SB
8134 6607 33 (.) 83 SB
8217 6607 33 (.) 83 SB
8300 6607 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6570 264 (179) 264 SB
3118 6803 3068 (50.2.2  Using Load-Time Dynamic Linking) 3068 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
6225 6840 33 (.) 83 SB
6308 6840 33 (.) 83 SB
6391 6840 33 (.) 83 SB
6474 6840 33 (.) 83 SB
6557 6840 33 (.) 83 SB
6640 6840 33 (.) 83 SB
6723 6840 33 (.) 83 SB
6806 6840 33 (.) 83 SB
6889 6840 33 (.) 83 SB
6972 6840 33 (.) 83 SB
7055 6840 33 (.) 83 SB
7138 6840 33 (.) 83 SB
7221 6840 33 (.) 83 SB
7304 6840 33 (.) 83 SB
7387 6840 33 (.) 83 SB
7470 6840 33 (.) 83 SB
7553 6840 33 (.) 83 SB
7636 6840 33 (.) 83 SB
7719 6840 33 (.) 83 SB
7802 6840 33 (.) 83 SB
7885 6840 33 (.) 83 SB
7968 6840 33 (.) 83 SB
8051 6840 33 (.) 83 SB
8134 6840 33 (.) 83 SB
8217 6840 33 (.) 83 SB
8300 6840 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6803 264 (181) 264 SB
3118 7036 3000 (50.2.3  Using Run-Time Dynamic Linking) 3000 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
6142 7073 33 (.) 83 SB
6225 7073 33 (.) 83 SB
6308 7073 33 (.) 83 SB
6391 7073 33 (.) 83 SB
6474 7073 33 (.) 83 SB
6557 7073 33 (.) 83 SB
6640 7073 33 (.) 83 SB
6723 7073 33 (.) 83 SB
6806 7073 33 (.) 83 SB
6889 7073 33 (.) 83 SB
6972 7073 33 (.) 83 SB
7055 7073 33 (.) 83 SB
7138 7073 33 (.) 83 SB
7221 7073 33 (.) 83 SB
7304 7073 33 (.) 83 SB
7387 7073 33 (.) 83 SB
7470 7073 33 (.) 83 SB
7553 7073 33 (.) 83 SB
7636 7073 33 (.) 83 SB
7719 7073 33 (.) 83 SB
7802 7073 33 (.) 83 SB
7885 7073 33 (.) 83 SB
7968 7073 33 (.) 83 SB
8051 7073 33 (.) 83 SB
8134 7073 33 (.) 83 SB
8217 7073 33 (.) 83 SB
8300 7073 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 7036 264 (182) 264 SB
3118 7269 4076 (50.2.4  Using Shared Memory in a Dynamic-Link Library) 4076 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
7221 7306 33 (.) 83 SB
7304 7306 33 (.) 83 SB
7387 7306 33 (.) 83 SB
7470 7306 33 (.) 83 SB
7553 7306 33 (.) 83 SB
7636 7306 33 (.) 83 SB
7719 7306 33 (.) 83 SB
7802 7306 33 (.) 83 SB
7885 7306 33 (.) 83 SB
7968 7306 33 (.) 83 SB
8051 7306 33 (.) 83 SB
8134 7306 33 (.) 83 SB
8217 7306 33 (.) 83 SB
8300 7306 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 7269 264 (183) 264 SB
3118 7502 4462 (50.2.5  Using Thread Local Storage in a Dynamic-Link Library) 4462 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
7636 7539 33 (.) 83 SB
7719 7539 33 (.) 83 SB
7802 7539 33 (.) 83 SB
7885 7539 33 (.) 83 SB
7968 7539 33 (.) 83 SB
8051 7539 33 (.) 83 SB
8134 7539 33 (.) 83 SB
8217 7539 33 (.) 83 SB
8300 7539 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 7502 264 (187) 264 SB
2885 7735 1089 (50.3  Functions) 1089 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
3984 7772 33 (.) 83 SB
4067 7772 33 (.) 83 SB
4150 7772 33 (.) 83 SB
4233 7772 33 (.) 83 SB
4316 7772 33 (.) 83 SB
4399 7772 33 (.) 83 SB
4482 7772 33 (.) 83 SB
4565 7772 33 (.) 83 SB
4648 7772 33 (.) 83 SB
4731 7772 33 (.) 83 SB
4814 7772 33 (.) 83 SB
4897 7772 33 (.) 83 SB
4980 7772 33 (.) 83 SB
5063 7772 33 (.) 83 SB
5146 7772 33 (.) 83 SB
5229 7772 33 (.) 83 SB
5312 7772 33 (.) 83 SB
5395 7772 33 (.) 83 SB
5478 7772 33 (.) 83 SB
5561 7772 33 (.) 83 SB
5644 7772 33 (.) 83 SB
5727 7772 33 (.) 83 SB
5810 7772 33 (.) 83 SB
5893 7772 33 (.) 83 SB
5976 7772 33 (.) 83 SB
6059 7772 33 (.) 83 SB
6142 7772 33 (.) 83 SB
6225 7772 33 (.) 83 SB
6308 7772 33 (.) 83 SB
6391 7772 33 (.) 83 SB
6474 7772 33 (.) 83 SB
6557 7772 33 (.) 83 SB
6640 7772 33 (.) 83 SB
6723 7772 33 (.) 83 SB
6806 7772 33 (.) 83 SB
6889 7772 33 (.) 83 SB
6972 7772 33 (.) 83 SB
7055 7772 33 (.) 83 SB
7138 7772 33 (.) 83 SB
7221 7772 33 (.) 83 SB
7304 7772 33 (.) 83 SB
7387 7772 33 (.) 83 SB
7470 7772 33 (.) 83 SB
7553 7772 33 (.) 83 SB
7636 7772 33 (.) 83 SB
7719 7772 33 (.) 83 SB
7802 7772 33 (.) 83 SB
7885 7772 33 (.) 83 SB
7968 7772 33 (.) 83 SB
8051 7772 33 (.) 83 SB
8134 7772 33 (.) 83 SB
8217 7772 33 (.) 83 SB
8300 7772 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 7735 264 (190) 264 SB
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 21 ( ) 21 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 171 def
/wp$fpage (171) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1447 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1822 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2180 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 171 def
/wp$fpage (171) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%Page: 2 2
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (172) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 333 333 0 0 0 311 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1968 4571 (50.1  About Dynamic-Link Libraries) 4571 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 2423 833 (In Microsof) 833 SB
3368 2423 49 (t) 78 SB
3446 2423 647 ( Window) 647 SB
4093 2423 68 (s) 97 SB
4190 2423 3884 (, dynamic linking provides a way for a process to call a) 3884 SB
2535 2623 5253 (function that is not part of its executable code. The executable code for the) 5253 SB
2535 2823 1646 (function is located in a ) 1646 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
4181 2823 1449 (dynamic-link library) 1449 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5630 2823 2223 ( \(DLL\), containing one or more) 2223 SB
2535 3023 5376 (functions that are compiled, linked, and stored separately from the processes) 5376 SB
2535 3223 2306 (using them. The Microsoft Win3) 2306 SB
4841 3223 88 (2) 117 SB
4958 3223 2724 ( application program interface \(API\) is) 2724 SB
2535 3423 5575 (implemented as a set of dynamic-link libraries, so any process using the Win32) 5575 SB
2535 3623 1863 (API uses dynamic linking.) 1863 SB
2535 3956 5452 (Dynamic linking allows an executable module \(either a .DLL or .EXE file\) to) 5452 SB
2535 4156 5800 (include only the information needed at run time to locate the executable code for a) 5800 SB
2535 4356 5723 (DLL function. This differs from the more familiar static linking, which requires a) 5723 SB
2535 4556 5458 (copy of a library function\222s executable code in the executable module of each) 5458 SB
2535 4756 1393 (application using it.) 1393 SB
2535 5089 3872 (There are two methods for calling a function in a DLL:) 3872 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 5396 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 5422 5090 (Load-time dynamic linking occurs when an application\222s code makes an) 5090 SB
2768 5622 5535 (explicit call to a DLL function. This requires that the executable module of the) 5535 SB
2768 5822 3292 (application be built by linking with the DLL\222s ) 3292 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
6060 5822 1000 (import library) 1000 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7060 5822 1137 (, which supplies) 1137 SB
2768 6022 5515 (the information needed to locate the DLL function when the application starts.) 5515 SB
2768 6222 5251 (For more information, see Section 50.1.5, \223Load-Time Dynamic Linking.\224) 5251 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 6463 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 6489 4190 (Run-time dynamic linking occurs when a program uses the ) 4190 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6958 6486 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7943 6489 298 ( and) 298 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2768 6686 1235 (GetProcAddress) 1235 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4003 6689 4264 ( functions to get the starting address of a DLL function. This) 4264 SB
2768 6889 5366 (eliminates the need to link with an import library. For more information, see) 5366 SB
2768 7089 3307 (Section 50.1.6, \223Run-Time Dynamic Linking.\224) 3307 SB
2535 7489 5455 (A DLL attaches to a process when the process starts or when one of it threads) 5455 SB
2535 7689 625 (calls the ) 625 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3160 7686 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4145 7689 4136 ( function. When a DLL attaches to a process, the operating) 4136 SB
2535 7889 5589 (system maps the DLL module into the address space of the process, making the) 5589 SB
2535 8089 5495 (DLL\222s executable code available to the process. When a DLL detaches from a) 5495 SB
2535 8289 4151 (process at process termination or as a result of a call to the ) 4151 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6686 8286 936 (FreeLibrary) 936 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7622 8289 674 ( function,) 674 SB
2535 8489 4817 (the DLL module is unmapped from the address space of the process.) 4817 SB
2535 8822 5599 (Like any other function, a DLL function is executed in the context of the thread) 5599 SB
2535 9022 5695 (\(and the thread\222s process\) that calls it. Therefore, the following conditions apply:) 5695 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 9329 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 9355 5299 (The threads of the process that called the DLL can use handles opened by a) 5299 SB
2768 9555 5431 (DLL function. Similarly, handles opened by any thread of the calling process) 5431 SB
2768 9755 2318 (can be used in the DLL function.) 2318 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 9996 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 10022 5468 (The DLL uses the user stack of the calling thread and the address space of the) 5468 SB
2768 10222 1093 (calling process.) 1093 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 10463 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 10489 5337 (Memory allocated by the DLL is in the address space of the calling process.) 5337 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 172 def
/wp$fpage (172) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 172 def
/wp$fpage (172) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 3 3
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5719 1517 2244 (Chapter 50    Dynamic-Link Libraries) 2244 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (173) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 158 158 0 0 0 182 /MSIcons font
0 0 0 fC
gs 2967 12924 0 0 CB
2885 1963 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 1989 5310 (The threads of the process that called the DLL can read from or write to the) 5310 SB
3118 2189 2762 (globally declared variables in the DLL.) 2762 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 2626 4299 (50.1.1  Advantages of Dynamic Linking) 4299 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 3007 3324 (Dynamic linking has the following advantages:) 3324 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2967 12924 0 0 CB
2885 3314 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 3340 5537 (Many processes can use a single DLL simultaneously, sharing a single copy of) 5537 SB
3118 3540 4933 (the DLL in memory. This saves memory space and reduces swapping.) 4933 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2967 12924 0 0 CB
2885 3781 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 3807 5378 (You can change the functions in a DLL without recompiling or relinking the) 5378 SB
3118 4007 5164 (applications that use them, as long as the functions\222 arguments and return) 5164 SB
3118 4207 5432 (values do not change. This differs from statically linked object code in which) 5432 SB
3118 4407 4991 (you must relink the application to update it when the functions change.) 4991 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2967 12924 0 0 CB
2885 4648 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 4674 5254 (You can use a DLL for after-market support. For example, a display driver) 5254 SB
3118 4874 5197 (DLL can be modified to support a display that was not available when the) 5197 SB
3118 5074 1733 (application was shipped.) 1733 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2967 12924 0 0 CB
2885 5315 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 5341 5420 (Programs written in different programming languages can call the same DLL) 5420 SB
3118 5541 5560 (function, as long as the programs follow the function\222s calling convention. The) 5560 SB
3118 5741 5396 (programs and the DLL function must be compatible in the order the function) 5396 SB
3118 5941 5457 (expects its arguments to be pushed onto the stack, whether the function or the) 5457 SB
3118 6141 4808 (application is responsible for cleaning up the stack, and whether any) 4808 SB
3118 6341 2364 (arguments are passed in registers.) 2364 SB
2885 6741 5145 (A potential disadvantage to using DLLs is that the application is not self-) 5145 SB
2885 6941 5767 (contained; it depends on the existence of a separate DLL module. A process using) 5767 SB
2885 7141 5763 (load-time dynamic linking is terminated by the operating system if the DLL is not) 5763 SB
2885 7341 5152 (found at process startup. A process using run-time dynamic linking is not) 5152 SB
2885 7541 5357 (terminated in this situation, but the functionality provided by the DLL is not) 5357 SB
2885 7741 1757 (available to the program.) 1757 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 8177 4156 (50.1.2  Dynamic-Link Library Creation) 4156 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 8558 5425 (To create a DLL, first create one or more source code files \(.C\) and a module) 5425 SB
2885 8758 5766 (definition file \(.DEF\). The source code file contains the exported functions for the) 5766 SB
2885 8958 5656 (DLL. The .DEF file lists these functions and defines other attributes of the DLL.) 5656 SB
2885 9291 5399 (The compiler uses the .C file to create an object code file \(.OBJ\). The library) 5399 SB
2885 9491 5589 (manager creates an export file \(.EXP\) and an import library file \(.LIB\) from the) 5589 SB
2885 9691 696 (.DEF file.) 696 SB
2885 10024 5767 (Finally, the linker uses the .OBJ, .EXP, and .LIB files to build the executable files) 5767 SB
2885 10224 5720 (for the DLL. The .OBJ and .EXP files provide the information the linker needs to) 5720 SB
2885 10424 5436 (build the .DLL file. The .LIB file contains the information the linker needs to) 5436 SB
2885 10624 5726 (resolve the external references to DLL functions, so that a program can locate the) 5726 SB
2885 10824 5797 (specified DLL at run time. The .LIB file enables the linker to build any executable) 5797 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 173 def
/wp$fpage (173) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 173 def
/wp$fpage (173) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons
%%+ font Times-Roman
%%Page: 4 4
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (174) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2535 1989 5547 (module \(.EXE or .DLL\) that calls a function in the DLL. For more information) 5547 SB
2535 2189 4770 (about .DEF files, see Section 50.1.4, \223The Module-Definition File.\224) 4770 SB
2535 2522 5220 (Note that the information in this section is based on using Win32 software) 5220 SB
2535 2722 5536 (development tools. Refer to the documentation provided with the development) 5536 SB
2535 2922 5000 (tools you are using for more detailed information about creating DLLs.) 5000 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 3358 3977 (50.1.3  The DLL Entrypoint Function) 3977 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 3739 170 (A ) 170 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2705 3736 1061 (DllEntryPoint) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3766 3739 4442 ( function is an optional DLL function that the operating system) 4442 SB
2535 3939 2896 (calls to perform user-defined operations. ) 2896 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5431 3936 1061 (DllEntryPoint) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6492 3939 1749 ( is not a typical function,) 1749 SB
2535 4139 5781 (but is a reference to a function specified in the linker command line. A DLL is not) 5781 SB
2535 4339 5528 (required to have an entrypoint function, but it can be useful for initializing and) 5528 SB
2535 4539 5547 (cleaning up processes and threads. The name of a DLL\222s entrypoint function is) 5547 SB
2535 4739 1157 (specified by the ) 1157 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3692 4736 997 (hyphen entry) 997 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4689 4739 3405 ( switch of the linker. For example, the following) 3405 SB
2535 4939 1702 (command line specifies ) 1702 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
4237 4939 605 (LibMain) 605 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4842 4939 3135 ( as the entrypoint function of MYDLL.DLL:) 3135 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 5292 5120 (link -entry:LibMain -out:mydll.dll mydll.exp mydll.obj $\(mylibs\)) 5120 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 5638 5603 (If an entrypoint function is specified, the operating system causes it to be called) 5603 SB
2535 5838 3200 (whenever any of the following events occurs:) 3200 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 6145 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 6171 5565 (The DLL attaches to a process. For processes using load-time dynamic linking,) 5565 SB
2768 6371 5543 (this occurs during initialization. For processes using run-time linking, the DLL) 5543 SB
2768 6571 3681 (attaches and the entrypoint function is called before ) 3681 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6449 6568 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7434 6571 575 ( returns.) 575 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 6812 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 6838 5502 (The DLL detaches from a process. This occurs when the process terminates or) 5502 SB
2768 7038 2997 (when the DLL is unloaded by a call to the ) 2997 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5765 7035 936 (FreeLibrary) 936 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6701 7038 1093 ( function. If the) 1093 SB
2768 7238 2540 (process terminates as a result of the ) 2540 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5308 7235 1354 (TerminateProcess) 1354 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6662 7238 449 ( or the) 449 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2768 7435 1344 (TerminateThread) 1344 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4112 7438 4097 ( function, the system does not call the entrypoint function.) 4097 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 7679 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 7705 5515 (The DLL attaches to a thread. This occurs whenever a new thread is created in) 5515 SB
2768 7905 2643 (a process to which a DLL is attached.) 2643 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 8146 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 8172 5558 (The DLL detaches from a thread. This occurs whenever a thread of an attached) 5558 SB
2768 8372 3087 (process terminates, except as a result of the ) 3087 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5855 8369 1344 (TerminateThread) 1344 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7199 8372 449 ( or the) 449 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2768 8569 1354 (TerminateProcess) 1354 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4122 8572 3670 ( function. When a DLL detaches from a process, the) 3670 SB
2768 8772 5452 (entrypoint function is called only once for the entire process, rather than once) 5452 SB
2768 8972 2717 (for each existing thread of the process.) 2717 SB
2535 9372 5337 (The system causes the entrypoint function to be called, but it is called in the) 5337 SB
2535 9572 5790 (context of a process or thread attaching to or detaching from the DLL. This allows) 5790 SB
2535 9772 5776 (a DLL to use its entrypoint function for allocating memory in the address space of) 5776 SB
2535 9972 5626 (the process or to open handles accessible to the process. When called to attach a) 5626 SB
2535 10172 5650 (new thread, the entrypoint function can allocate memory for thread local storage) 5650 SB
2535 10372 5589 (\(TLS\) that is private to the new thread. For more about thread local storage, see) 5589 SB
2535 10572 2651 (Chapter 43, \223Processes and Threads.\224) 2651 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 174 def
/wp$fpage (174) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 174 def
/wp$fpage (174) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 5 5
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5719 1517 2244 (Chapter 50    Dynamic-Link Libraries) 2244 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (175) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2885 1989 5423 (When a DLL\222s entrypoint function is called for process attachment, it returns) 5423 SB
2885 2189 5785 (TRUE to indicate success. For processes using load-time linking, a return value of) 5785 SB
2885 2389 5491 (FALSE causes the process initialization to fail and the process terminates. For) 5491 SB
2885 2589 4871 (processes using run-time linking, a return value of FALSE causes the) 4871 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 2786 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3870 2789 4776 ( function to return NULL, indicating failure. The return value of the) 4776 SB
2885 2989 5689 (entrypoint function is disregarded when it is called for any other reasons, such as) 5689 SB
2885 3189 3284 (process detach, thread attach, or thread detach.) 3284 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 3625 3681 (50.1.4  The Module-Definition File) 3681 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4006 5356 (A module definition \(.DEF\) file is a text file containing one or more module) 5356 SB
2885 4206 5103 (statements that describe various attributes of a dynamic-link library. The) 5103 SB
2885 4406 5583 (descriptions and examples in this section are based on the keywords and syntax) 5583 SB
2885 4606 5313 (used by the Win32 software development tools. Refer to the documentation) 5313 SB
2885 4806 5471 (provided with your development tools for complete documentation of module) 5471 SB
2885 5006 1074 (definition files.) 1074 SB
2885 5339 5772 (A DLL requires a module-definition file to create an import library \(.LIB\) file and) 5772 SB
2885 5539 5596 (an export \(.EXP\) file. The linker uses the import library to build any executable) 5596 SB
2885 5739 5314 (module that uses the DLL; it also uses the export file to build the .DLL file.) 5314 SB
2885 6072 3327 (A DLL\222s module definition file must include a ) 3327 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6212 6069 806 (LIBRARY) 806 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7018 6072 1225 ( statement and an) 1225 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 6269 828 (EXPORTS) 828 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3713 6272 1122 ( statement. The ) 1122 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4835 6269 806 (LIBRARY) 806 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5641 6272 2973 ( statement identifies the module definition) 2973 SB
2885 6472 5557 (file as belonging to a DLL and must be the first statement in the file. The name) 5557 SB
2885 6672 1118 (specified in the ) 1118 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4003 6669 806 (LIBRARY) 806 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4809 6672 3649 ( statement identifies the library in the DLL\222s import) 3649 SB
2885 6872 873 (library. The ) 873 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3758 6869 828 (EXPORTS) 828 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4586 6872 3740 ( statement lists the names and, optionally, the ordinal) 3740 SB
2885 7072 5639 (values of the functions exported by the DLL. When ordinal values are specified,) 5639 SB
2885 7272 3225 (they must be in the range 1 through N, where ) 3225 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
6110 7272 117 (N) 117 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6227 7272 1888 ( is the number of functions) 1888 SB
2885 7472 1522 (exported by the DLL.) 1522 SB
2885 7805 5631 (The following is a DLL\222s module definition file that exports three functions and) 5631 SB
2885 8005 3275 (associates an ordinal value with each function.) 3275 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 8358 1040 (LIBRARY mydll) 1040 SB
2885 8541 560 (EXPORTS) 560 SB
2885 8724 1040 (    Func_A @1) 1040 SB
2885 8907 1040 (    Func_B @2) 1040 SB
2885 9090 1040 (    Func_C @3) 1040 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 9436 5414 (The module definition file can contain additional statements specifying other) 5414 SB
2885 9636 2667 (attributes of a DLL. For example, the ) 2667 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5552 9633 884 (SECTIONS) 884 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6436 9636 1874 ( statements can change the) 1874 SB
2885 9836 4129 (default scope of global and static variables. The following ) 4129 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7014 9833 884 (SECTIONS) 884 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7898 9836 717 ( statement) 717 SB
2885 10036 5715 (makes the DLL\222s initialized data shared, while the uninitialized variables are not.) 5715 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 10389 640 (SECTIONS) 640 SB
2885 10572 4800 (    .data READ WRITE SHARED    ; share initialized variables) 4800 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 175 def
/wp$fpage (175) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 175 def
/wp$fpage (175) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 6 6
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (176) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1975 3874 (50.1.5  Load-Time Dynamic Linking) 3874 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 2356 5585 (Load-time dynamic linking occurs when an application\222s code explicitly calls a) 5585 SB
2535 2556 5754 (DLL function. When the source code is compiled or assembled, the DLL function) 5754 SB
2535 2756 5529 (call generates an external function reference in the object code. To resolve this) 5529 SB
2535 2956 5616 (external reference, the application must be linked with the import library for the) 5616 SB
2535 3156 384 (DLL.) 384 SB
2535 3489 5657 (Finding an external function in an import library informs the linker that the code) 5657 SB
2535 3689 5488 (for that function is in a dynamic-link library. To resolve external references to) 5488 SB
2535 3889 5588 (dynamic-link libraries, the linker simply adds information to the executable file) 5588 SB
2535 4089 5321 (that tells the system where to find the DLL code when the process starts up.) 5321 SB
2535 4422 5667 (When the system starts a program that contains dynamically linked references, it) 5667 SB
2535 4622 5742 (uses the information in the program\222s executable file to locate the required DLLs.) 5742 SB
2535 4822 5619 (The system first searches the set of pre-installed DLLs, such as the performance) 5619 SB
2535 5022 5694 (library, \(KERNEL32.DLL\) and the security library, \(USER32.DLL\). The system) 5694 SB
2535 5222 4419 (then searches for the DLLs by using the following search path:) 4419 SB
2536 5555 132 (1.) 132 SB
2768 5555 5424 (The directory where the executable module for the current process is located.) 5424 SB
2536 5822 132 (2.) 132 SB
2768 5822 1536 (The current directory.) 1536 SB
2536 6089 132 (3.) 132 SB
2768 6089 2564 (The windows system directory. The ) 2564 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5332 6086 1528 (GetSystemDirectory) 1528 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6860 6089 1278 ( function retrieves) 1278 SB
2768 6289 1772 (the path of this directory.) 1772 SB
2536 6556 132 (4.) 132 SB
2768 6556 2033 (The windows directory. The ) 2033 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4801 6553 1693 (GetWindowsDirectory) 1693 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6494 6556 1537 ( function retrieves the) 1537 SB
2768 6756 1513 (path of this directory.) 1513 SB
2536 7023 132 (5.) 132 SB
2768 7023 4009 (The directories listed in the PATH environment variable.) 4009 SB
2535 7423 3437 (The LIBPATH environment variable is not used.) 3437 SB
2535 7756 5775 (If it cannot locate a specified DLL, the system terminates the process and displays) 5775 SB
2535 7956 5690 (a dialog box that reports the error. Otherwise, the system maps the DLL modules) 5690 SB
2535 8156 2278 (into the process\222s address space.) 2278 SB
2535 8489 1759 (If any of the DLLs has a ) 1759 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4294 8486 1061 (DllEntryPoint) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5355 8489 2797 ( function, the operating system calls the) 2797 SB
2535 8689 674 (function. ) 674 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3209 8686 1061 (DllEntryPoint) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4270 8689 3807 ( specifies a code that indicates the DLL is attaching to) 3807 SB
2535 8889 5078 (the process. If the entrypoint function does not return TRUE, the system) 5078 SB
2535 9089 5334 (terminates the process and reports the error. For more information about the) 5334 SB
2535 9289 5129 (entrypoint function, see Section 50.1.3, \223The DLL Entrypoint Function.\224) 5129 SB
2535 9622 5461 (Finally, the system modifies the executable code of the process to provide the) 5461 SB
2535 9822 2876 (starting addresses for the DLL functions.) 2876 SB
2535 10155 5667 (Like the rest of a program\222s code, DLL code is mapped into the address space of) 5667 SB
2535 10355 5796 (the process when the process starts up and loaded into memory only when needed.) 5796 SB
2535 10555 1097 (As a result, the ) 1097 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3632 10552 855 (PRELOAD) 855 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4487 10555 234 ( or ) 234 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4721 10552 1253 (LOADONCALL) 1253 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5974 10555 2289 ( code attributes used by module-) 2289 SB
2535 10755 5285 (definition files to control loading in previous versions of Windows have no) 5285 SB
2535 10955 1822 (meaning in Windows NT.) 1822 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 176 def
/wp$fpage (176) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 176 def
/wp$fpage (176) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 7 7
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5719 1517 2244 (Chapter 50    Dynamic-Link Libraries) 2244 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (177) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1385 1975 3770 (50.1.6  Run-Time Dynamic Linking) 3770 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 2356 4279 (Run-time dynamic linking occurs when the process calls the ) 4279 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7164 2353 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 2556 3298 (function to specify the name of a DLL and the ) 3298 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6183 2553 1235 (GetProcAddress) 1235 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7418 2556 1070 ( function to get) 1070 SB
2885 2756 5241 (the starting address of any function in the DLL. Run-time dynamic linking) 5241 SB
2885 2956 5739 (eliminates the need to link the process with an import library the process does not) 5739 SB
2885 3156 5768 (explicitly call the DLL\222s functions, so it does not generate the external references.) 5768 SB
2885 3489 898 (If the call to ) 898 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3783 3486 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4768 3489 3473 ( specifies a DLL module already mapped into the) 3473 SB
2885 3689 2590 (address space of the calling process, ) 2590 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5475 3686 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6460 3689 2137 ( simply returns a handle of the) 2137 SB
2885 3889 4436 (DLL and increments the module\222s reference count. Otherwise, ) 4436 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7321 3886 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4089 5585 (attempts to locate the DLL on the same search path used for load-time dynamic) 5585 SB
2885 4289 5213 (linking \(see Section 50.1.5, \223Load-Time Dynamic Linking\224\). If the search) 5213 SB
2885 4489 5730 (succeeds, the system maps the DLL module into the address space of the process.) 5730 SB
2885 4689 1203 (If the DLL has a ) 1203 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4088 4686 1061 (DllEntryPoint) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5149 4689 3427 ( function, the operating system calls the function) 3427 SB
2885 4889 2706 (in the context of the thread that called ) 2706 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5591 4886 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6576 4889 1919 (. The entrypoint function is) 1919 SB
2885 5089 5765 (not called if the DLL is already attached to the process due to load-time linking to) 5765 SB
2885 5289 1250 (a previous call to ) 1250 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4135 5286 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5120 5289 3333 (. This occurs when no corresponding call to the) 3333 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 5486 936 (FreeLibrary) 936 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3821 5489 1752 ( function has been made.) 1752 SB
2885 5822 5539 (If the system cannot find the DLL or if the entrypoint function returns FALSE,) 5539 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 6019 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3870 6022 1289 ( returns NULL. If ) 1289 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5159 6019 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6144 6022 2469 ( succeeds, it returns a handle of the) 2469 SB
2885 6222 5675 (DLL module. The process can use this handle to identify the DLL in a call to the) 5675 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 6419 1235 (GetProcAddress) 1235 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4120 6422 234 ( or ) 234 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4354 6419 936 (FreeLibrary) 936 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5290 6422 742 ( functions.) 742 SB
2885 6755 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3202 6752 1391 (GetModuleHandle) 1391 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4593 6755 2714 ( function also returns a handle used in ) 2714 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7307 6752 1235 (GetProcAddress) 1235 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 6955 190 (or ) 190 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3075 6952 936 (FreeLibrary) 936 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4011 6955 88 (. ) 88 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4099 6952 1391 (GetModuleHandle) 1391 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5490 6955 3112 ( succeeds only if the DLL module is already) 3112 SB
2885 7155 5168 (mapped into the address space of the process by load-time linking or by a) 5168 SB
2885 7355 1128 (previous call to ) 1128 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4013 7352 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4998 7355 610 (. Unlike ) 610 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5608 7352 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6593 7355 88 (, ) 88 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6681 7352 1391 (GetModuleHandle) 1391 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8072 7355 366 ( does) 366 SB
2885 7555 3464 (not increment the module\222s reference count. The ) 3464 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6349 7552 1567 (GetModuleFileName) 1567 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7916 7555 630 ( function) 630 SB
2885 7755 5124 (retrieves the full path of the module associated with a handle returned by) 5124 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 7952 1391 (GetModuleHandle) 1391 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4276 7955 234 ( or ) 234 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4510 7952 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5495 7955 44 (.) 44 SB
2885 8288 1453 (The process can use ) 1453 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4338 8285 1235 (GetProcAddress) 1235 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5573 8288 3076 ( to get the starting handle returned by either) 3076 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 8485 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3870 8488 4541 ( or address of a function in the DLL using a DLL module handle) 4541 SB
2885 8688 1293 (returned by either ) 1293 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4178 8685 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5163 8688 234 ( or ) 234 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5397 8685 1391 (GetModuleHandle) 1391 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6788 8688 1830 (. The function is specified) 1830 SB
2885 8888 3491 (by using its name or ordinal value as listed in the ) 3491 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6376 8885 828 (EXPORTS) 828 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7204 8888 1166 ( statement of the) 1166 SB
2885 9088 2088 (DLL\222s module definition file.) 2088 SB
2885 9421 4810 (When the DLL module is no longer needed, the process can call the ) 4810 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7695 9418 936 (FreeLibrary) 936 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 9621 5590 (function. This decrements the module\222s reference count and unmaps it from the) 5590 SB
2885 9821 4071 (address space of the process if the reference count is zero.) 4071 SB
2885 10154 5463 (Run-time dynamic linking enables the process to continue executing even if a) 5463 SB
2885 10354 5387 (DLL is not available. This allows the process to use an alternative method to) 5387 SB
2885 10554 5743 (accomplish its objective. For example, if a process is unable to locate one DLL, it) 5743 SB
2885 10754 5688 (can try to use another, or it can notify the user of an error. If the user can provide) 5688 SB
2885 10954 5670 (the full path of the missing DLL, the process can use this information to load the) 5670 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 177 def
/wp$fpage (177) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 177 def
/wp$fpage (177) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 8 8
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (178) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2535 1989 5598 (library even though it is not in the normal search path. This contrasts with load-) 5598 SB
2535 2189 5426 (time linking in which the operating system simply terminates the process if it) 5426 SB
2535 2389 1483 (cannot find the DLL.) 1483 SB
2535 2722 5522 (The developer need not know the names of either the DLLs or of the functions) 5522 SB
2535 2922 5569 (within a DLL. The process can get this information from a configuration file or) 5569 SB
2535 3122 979 (from the user.) 979 SB
2535 3455 4913 (Run-time dynamic linking can cause problems if the DLL is using the) 4913 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 3652 1061 (DllEntryPoint) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3596 3655 4376 ( function to perform initialization for each thread of a process,) 4376 SB
2535 3855 2176 (because threads existing when ) 2176 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4711 3852 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5696 3855 2500 ( is called will not be initialized. For) 2500 SB
2535 4055 5542 (an example showing how to deal with this problem, see Section 50.2.5, \223Using) 5542 SB
2535 4255 3593 (Thread Local Storage in a Dynamic-Link Library.\224) 3593 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 4691 3717 (50.1.7  Dynamic-Link Library Data) 3717 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 5072 3349 (Windows NT supports the use of the following:) 3349 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 5379 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 5405 5430 (Global and static variables in a DLL module private to each process that uses) 5430 SB
2768 5605 643 (the DLL.) 643 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 5846 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 5872 5182 (Global and static variables shared by all processes simultaneously using a) 5182 SB
2768 6072 384 (DLL.) 384 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 6313 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 6339 5067 (Dynamically allocated memory private to each process that uses a DLL.) 5067 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 6580 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 6606 4326 (Dynamically allocated memory shared by multiple processes.) 4326 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2617 12924 0 0 CB
2535 6847 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 6873 4459 (Static storage private to each thread of a multithreaded process.) 4459 SB
2535 7273 5406 (The default scope of a DLL\222s variables is the same as in any statically linked) 5406 SB
2535 7473 5703 (code. Global variables in a DLL source code file are global to each process using) 5703 SB
2535 7673 5759 (the DLL. Static variables create permanent storage for each process, limiting their) 5759 SB
2535 7873 5479 (scope to the block in which they are declared. As a result, each process has its) 5479 SB
2535 8073 4416 (own instance of a DLL\222s global and static variables by default.) 4416 SB
2535 8406 5476 (Win32 development tools enable you to use a DLL\222s module definition file to) 5476 SB
2535 8606 5537 (override the default scope of global and static variables. For more information,) 5537 SB
2535 8806 5680 (see Section 50.1.4, \223The Module-Definition File,\224 and the documentation for the) 5680 SB
2535 9006 1187 (tools being used.) 1187 SB
2535 9339 4819 (When a DLL allocates memory using any of the allocation functions) 4819 SB
2535 9539 58 (\() 58 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2593 9536 897 (GlobalAlloc) 897 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3490 9539 88 (, ) 88 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3578 9536 810 (LocalAlloc) 810 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4388 9539 88 (, ) 88 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4476 9536 789 (HeapAlloc) 789 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5265 9539 88 (, ) 88 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5353 9536 935 (VirtualAlloc) 935 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6288 9539 278 (, or ) 278 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6566 9536 498 (malloc) 498 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7064 9539 1200 ( and other C run-) 1200 SB
2535 9739 5426 (time allocation functions\) the memory is allocated in the address space of the) 5426 SB
2535 9939 5405 (calling process and is accessible only to the threads of that process. A DLL\222s) 5405 SB
2535 10139 5165 (module-definition file cannot be used to change the scope of dynamically) 5165 SB
2535 10339 1307 (allocated memory.) 1307 SB
2535 10672 5243 (A DLL can use file mapping to allocate memory that can be shared among) 5243 SB
2535 10872 5672 (processes. For a general discussion of using file mapping to create named shared) 5672 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 178 def
/wp$fpage (178) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 178 def
/wp$fpage (178) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 9 9
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5719 1517 2244 (Chapter 50    Dynamic-Link Libraries) 2244 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (179) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2885 1989 5004 (memory, see Chapter 47, \223File Mapping.\224 For an example that uses the) 5004 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 2186 1061 (DllEntryPoint) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3946 2189 4645 ( function to set up shared memory using file mapping, see Section) 4645 SB
2885 2389 4275 (50.2.4, \223Using Shared Memory in a Dynamic-Link Library.\224) 4275 SB
2885 2722 5597 (The thread local storage functions enable a DLL to allocate an index for storing) 5597 SB
2885 2922 5506 (and retrieving a different value for each thread of a multithreaded process. For) 5506 SB
2885 3122 5615 (example, a spreadsheet application can create a new instance of the same thread) 5615 SB
2885 3322 5579 (each time the user opens a new spreadsheet. A DLL providing the functions for) 5579 SB
2885 3522 5552 (various spreadsheet operations can use thread local storage to save information) 5552 SB
2885 3722 5799 (about the current state of each spreadsheet \(row, column, and so on\). For a general) 5799 SB
2885 3922 5636 (discussion of thread local storage, see Chapter 43, \223Processes and Threads.\224 For) 5636 SB
2885 4122 1762 (an example that uses the ) 1762 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4647 4119 1061 (DllEntryPoint) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5708 4122 2734 ( function to set up thread local storage,) 2734 SB
2885 4322 5500 (see Section 50.2.5, \223Using Thread Local Storage in a Dynamic-Link Library.\224) 5500 SB
32 0 0 333 333 0 0 0 311 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 4801 4541 (50.2  Using Dynamic-Link Libraries) 4541 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 5256 4090 (The examples in this section illustrate the following tasks:) 4090 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2967 12924 0 0 CB
2885 5563 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 5589 2776 (Creating a simple dynamic-link library.) 2776 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2967 12924 0 0 CB
2885 5830 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 5856 3603 (Calling a DLL function by using load-time linking.) 3603 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2967 12924 0 0 CB
2885 6097 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 6123 3534 (Calling a DLL function by using run-time linking.) 3534 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2967 12924 0 0 CB
2885 6364 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 6390 5491 (Using a DLL\222s entrypoint function to create named shared memory accessible) 5491 SB
3118 6590 2185 (to all processes using the DLL.) 2185 SB
32 0 0 158 158 0 0 0 182 /MSIcons font
gs 2967 12924 0 0 CB
2885 6831 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 6857 2570 (Using thread local storage in a DLL.) 2570 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 7360 5177 (50.2.1  Creating a Simple Dynamic-Link Library) 5177 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 7741 5126 (Dynamic-link libraries make common functions available to a number of) 5126 SB
2885 7941 5592 (processes or threads at once. The following file, MYPUTS.C, contains a simple) 5592 SB
2885 8141 3494 (string printing function. This DLL does not use a ) 3494 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6379 8138 1061 (DllEntryPoint) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7440 8141 1230 ( function because) 1230 SB
2885 8341 3842 (it has no initialization or cleanup functions to perform.) 3842 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 8694 1600 (#include <windows.h>) 1600 SB
2885 9060 160 (/*) 160 SB
2885 9243 4240 ( * A function that writes a null terminated string to) 4240 SB
2885 9426 1440 ( * console output.) 1440 SB
2885 9609 240 ( */) 240 SB
2885 9975 2320 (VOID myPuts\(LPTSTR lpszMsg\) {) 2320 SB
2885 10158 1680 (    DWORD cchWritten;) 1680 SB
2885 10341 1520 (    HANDLE hStdout;) 1520 SB
2885 10707 3600 (    /* Get a handle to the console output. */) 3600 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 179 def
/wp$fpage (179) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 179 def
/wp$fpage (179) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 10 10
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (180) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2535 2009 3680 (    hStdout = GetStdHandle\(STD_OUTPUT_HANDLE\);) 3680 SB
2535 2375 5040 (    /* Write a null-terminated string to the console output. */) 5040 SB
2535 2741 1600 (    while \(*lpszMsg\)) 1600 SB
2535 2924 4800 (        WriteFile\(hStdout, lpszMsg++, 1, &cchWritten, NULL\);) 4800 SB
2535 3107 80 (}) 80 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 3453 5455 (The module-definition file for this DLL is MYPUTS.DEF, and it contains the) 5455 SB
2535 3653 1605 (following information:) 1605 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 4006 1120 (LIBRARY myputs) 1120 SB
2535 4372 560 (EXPORTS) 560 SB
2535 4555 880 (     myPuts) 880 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 4901 1859 (The name specified in the ) 1859 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4394 4898 806 (LIBRARY) 806 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5200 4901 3009 ( statement identifies the DLL in the DLL\222s) 3009 SB
2535 5101 5781 (import library. Load-time dynamic linking enables the system to use this name for) 5781 SB
2535 5301 4563 (locating the DLL. If run-time dynamic linking is being used, the ) 4563 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7098 5298 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 5501 3914 (function does not use this name to locate the DLL. The ) 3914 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6449 5498 828 (EXPORTS) 828 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7277 5501 717 ( statement) 717 SB
2535 5701 5112 (indicates that other .EXE or .DLL modules can call the myPuts function.) 5112 SB
2535 6034 5195 (The source code in MYPUTS.C is compiled to produce an object module,) 5195 SB
2535 6234 4781 (MYPUTS.OBJ. The library manager uses the module-definition file) 4781 SB
2535 6434 5649 (\(MYPUTS.DEF\) to create the import library \(MYPUTS.LIB\) and the export file) 5649 SB
2535 6634 5684 (\(MYPUTS.EXP\). The linker uses MYPUTS.EXP and MYPUTS.OBJ to produce) 5684 SB
2535 6834 5683 (the executable DLL module \(MYPUTS.DLL\). The MYPUTS.LIB import library) 5683 SB
2535 7034 5136 (is not used in creating MYPUTS.DLL, but the linker uses it to create any) 5136 SB
2535 7234 4662 (executable module \(.EXE or .DLL\) that calls the myPuts function.) 4662 SB
2535 7567 5639 (Following are some typical command lines used to compile and link a DLL. For) 5639 SB
2535 7767 5164 (more information about compiling and linking dynamic-link libraries and) 5164 SB
2535 7967 5743 (programs that use them, refer to the documentation for the development tools you) 5743 SB
2535 8167 683 (are using.) 683 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 8520 2240 (cvars=-DWIN32 -D_MT -DSTRICT) 2240 SB
2535 8886 3200 (# Compile myputs.c to create myputs.obj.) 3200 SB
2535 9069 1600 (myputs.obj: myputs.c) 1600 SB
2535 9252 3040 (    $\(cc\)  $\(cflags\) $\(cvars\) myputs.c) 3040 SB
2535 9801 2720 (# Create the DLL's import library.) 2720 SB
2535 9984 3280 (# Also create the myputs.exp export file.) 3280 SB
2535 10167 1760 (myputs.lib: myputs.def) 1760 SB
2535 10350 2080 (    $\(lib\) -machine:i386 \\) 2080 SB
2535 10533 2000 (    -def:myputs.def     \\) 2000 SB
2535 10716 1520 (    -out:myputs.lib) 1520 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 180 def
/wp$fpage (180) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 180 def
/wp$fpage (180) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 11 11
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5719 1517 2244 (Chapter 50    Dynamic-Link Libraries) 2244 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (181) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2009 4320 (# Link myputs.obj and myputs.exp to create myputs.dll.) 4320 SB
2885 2192 4000 (# myputs.lib is not used here but is included as a) 4000 SB
2885 2375 3600 (# dependency to force creation of myputs.exp.) 3600 SB
2885 2558 2640 (myputs.dll: myputs.obj myputs.lib) 2640 SB
2885 2741 1760 (    $\(link\)          \\) 1760 SB
2885 2924 1760 (    -out:myputs.dll  \\) 1760 SB
2885 3107 2880 (    myputs.exp myputs.obj $\(conlibs\)) 2880 SB
2885 3473 4480 (# If dll has a DllEntryPoint function, substitute a line) 4480 SB
2885 3656 4720 (# like this to specify the name of the entrypoint function.) 4720 SB
2885 3839 2560 (#    $\(link\) -entry:LibMain    \\) 2560 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 4288 4584 (50.2.2  Using Load-Time Dynamic Linking) 4584 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4669 5541 (Once you have created a dynamic-link library, you can use it in an application.) 5541 SB
2885 4869 5245 (The following file, LOADTIME.C, is the source code for a simple console) 5245 SB
2885 5069 4204 (process that uses the myPuts function from MYPUTS.DLL.) 4204 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 5422 160 (/*) 160 SB
2885 5605 1760 ( *   File:  loadtime.c) 1760 SB
2885 5788 4480 ( *   A simple program that uses myPuts\(\) from myputs.dll) 4480 SB
2885 5971 240 ( */) 240 SB
2885 6337 1600 (#include <windows.h>) 1600 SB
2885 6703 4000 (VOID myPuts\(LPTSTR\);   /* a function from a DLL */) 4000 SB
2885 7069 1360 (VOID main\(VOID\) {) 1360 SB
2885 7435 4400 (    myPuts\("message printed using the DLL function\\n"\);) 4400 SB
2885 7801 80 (}) 80 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 8147 5721 (Because LOADTIME.C calls the DLL function explicitly, the executable module) 5721 SB
2885 8347 5246 (for the application must be linked with the import library \(MYPUTS.LIB\).) 5246 SB
2885 8547 5363 (Following are some typical command lines used for compiling and linking a) 5363 SB
2885 8747 1798 (program that uses a DLL.) 1798 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 9100 3520 (# Compile loadtime.c to create loadtime.obj.) 3520 SB
2885 9283 1920 (loadtime.obj: loadtime.c) 1920 SB
2885 9466 3200 (    $\(cc\)  $\(cflags\) $\(cvars\) loadtime.c) 3200 SB
2885 10015 4640 (# Link loadtime.obj and myputs.lib to create loadtime.exe.) 4640 SB
2885 10198 2960 (loadtime.exe: loadtime.obj myputs.lib) 2960 SB
2885 10381 2000 (    $\(link\) $\(conflags\) \\) 2000 SB
2885 10564 4480 (    -out:loadtime.exe loadtime.obj myputs.lib $\(conlibs\)) 4480 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 181 def
/wp$fpage (181) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 181 def
/wp$fpage (181) def
/wp$date (04/23/93) def
/wp$time (11:08 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 12 12
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (182) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1975 4480 (50.2.3  Using Run-Time Dynamic Linking) 4480 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 2356 5225 (You can use the same dynamic-link library in both load-time and run-time) 5225 SB
2535 2556 5679 (dynamic linking. If the system can find the specified DLL module, the following) 5679 SB
2535 2756 5563 (source code produces the same output as the load-time example in the previous) 5563 SB
2535 2956 2146 (section. The program uses the ) 2146 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4681 2953 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5666 2956 1895 ( function to get a handle of) 1895 SB
2535 3156 1341 (MYPUTS.DLL. If ) 1341 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3876 3153 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4861 3156 3356 ( succeeds, the program uses the returned handle) 3356 SB
2535 3356 440 (in the ) 440 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2975 3353 1235 (GetProcAddress) 1235 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4210 3356 4000 ( function to get the starting address of the DLL\222s myPuts) 4000 SB
2535 3556 4449 (function. After calling the DLL function, the program calls the ) 4449 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6984 3553 936 (FreeLibrary) 936 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 3756 3170 (function to detach the DLL from the process.) 3170 SB
2535 4089 5633 (The following example illustrates an important difference between run-time and) 5633 SB
2535 4289 5155 (load-time dynamic linking. If the MYPUTS.DLL file is not available, the) 5155 SB
2535 4489 5422 (application using load-time dynamic linking simply terminates. The run-time) 5422 SB
2535 4689 4670 (dynamic linking example, however, is able to respond to the error.) 4670 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 5042 160 (/*) 160 SB
2535 5225 1680 ( *   File:  runtime.c) 1680 SB
2535 5408 3760 ( *   A simple program that uses LoadLibrary and) 3760 SB
2535 5591 4640 ( *   GetProcAddress to access myPuts\(\) from the myputs DLL) 4640 SB
2535 5774 240 ( */) 240 SB
2535 6140 1440 (#include <stdio.h>) 1440 SB
2535 6323 1600 (#include <windows.h>) 1600 SB
2535 6689 2480 (typedef VOID \(*MYPROC\)\(LPTSTR\);) 2480 SB
2535 7055 1360 (VOID main\(VOID\) {) 1360 SB
2535 7238 1840 (    HINSTANCE hinstLib;) 1840 SB
2535 7421 1520 (    MYPROC ProcAdd;) 1520 SB
2535 7604 4000 (    BOOL fFreeResult, fRunTimeLinkSuccess = FALSE;) 4000 SB
2535 7970 3280 (    /* Get a handle to the DLL module. */) 3280 SB
2535 8336 2960 (    hinstLib = LoadLibrary\("myputs"\);) 2960 SB
2535 8702 5120 (    /* If a handle is valid, try to get the function address. */) 5120 SB
2535 9068 2160 (    if \(hinstLib != NULL\) {) 2160 SB
2535 9251 4960 (        ProcAdd = \(MYPROC\) GetProcAddress\(hinstLib, "myPuts"\);) 4960 SB
2535 9617 5280 (        /* If the function address is valid, call the function. */) 5280 SB
2535 9983 4160 (        if \(fRunTimeLinkSuccess = \(ProcAdd != NULL\)\)) 4160 SB
2535 10166 4240 (            \(ProcAdd\) \("message via DLL function\\n"\);) 4240 SB
2535 10532 2720 (        /* Free the DLL module. */) 2720 SB
2535 10898 3520 (        fFreeResult = FreeLibrary\(hinstLib\);) 3520 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 182 def
/wp$fpage (182) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 182 def
/wp$fpage (182) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 13 13
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5719 1517 2244 (Chapter 50    Dynamic-Link Libraries) 2244 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (183) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2192 240 (  }) 240 SB
2885 2558 5280 (    /* If unable to call the DLL function, use the alternative. */) 5280 SB
2885 2924 2400 (    if \(! fRunTimeLinkSuccess\)) 2400 SB
2885 3107 4080 (        printf\("message via alternative method\\n"\);) 4080 SB
2885 3473 80 (}) 80 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 3819 5509 (Because the program uses run-time dynamic linking, it is not necessary to link) 5509 SB
2885 4019 5575 (with the DLL\222s import library when creating the program\222s executable module.) 5575 SB
2885 4219 5613 (The following lines are typical of the command lines used to compile and link a) 5613 SB
2885 4419 2254 (program using run-time linking.) 2254 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 4772 3360 (# Compile runtime.c to create runtime.obj.) 3360 SB
2885 4955 1760 (runtime.obj: runtime.c) 1760 SB
2885 5138 3120 (    $\(cc\)  $\(cflags\) $\(cvars\) runtime.c) 3120 SB
2885 5687 3360 (# Link runtime.obj to create loadtime.exe.) 3360 SB
2885 5870 1920 (runtime.exe: runtime.obj) 1920 SB
2885 6053 2000 (    $\(link\) $\(conflags\) \\) 2000 SB
2885 6236 3440 (    -out:runtime.exe runtime.obj $\(conlibs\)) 3440 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 6685 6132 (50.2.4  Using Shared Memory in a Dynamic-Link Library) 6132 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 7066 5669 (This section shows the use of a DLL\222s entrypoint function to set up memory that) 5669 SB
2885 7266 5381 (can be shared by multiple processes. In this DLL, the name of the entrypoint) 5381 SB
2885 7466 5606 (function is LibMain. The module definition file for this DLL is MYPUTS.DEF,) 5606 SB
2885 7666 2929 (and it contains the following information.) 2929 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 8019 1120 (LIBRARY myputs) 1120 SB
2885 8385 560 (EXPORTS) 560 SB
2885 8568 880 (     myPuts) 880 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 8914 5688 (The example uses file mapping to map a block of named shared memory into the) 5688 SB
2885 9114 5302 (address space of each process to which the DLL is attached. The entrypoint) 5302 SB
2885 9314 1255 (function calls the ) 1255 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4140 9311 1470 (CreateFileMapping) 1470 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5610 9314 2821 ( function to create a file-mapping object) 2821 SB
2885 9514 5653 (whenever the DLL attaches to a new process. You can use this function to either) 5653 SB
2885 9714 5608 (create or open a named file-mapping object. The first process to which the DLL) 5608 SB
2885 9914 5606 (attaches creates the file-mapping object. Subsequent processes open a handle of) 5606 SB
2885 10114 1695 (the existing object. The ) 1695 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4580 10111 1042 (GetLastError) 1042 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5622 10114 2593 ( function triggers initialization of the) 2593 SB
2885 10314 5005 (shared memory, because it returns NO_ERROR to the first process and) 5005 SB
2885 10514 3953 (ERROR_ALREADY_EXISTS to subsequent processes.) 3953 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 183 def
/wp$fpage (183) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 183 def
/wp$fpage (183) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 14 14
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (184) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2535 1989 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2852 1986 1206 (MapViewOfFile) 1206 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4058 1989 3875 ( function maps the file-mapping object into the address) 3875 SB
2535 2189 5478 (space of each process, returning a pointer to the memory. Note that the shared) 5478 SB
2535 2389 5495 (memory can be mapped to a different address in each process. For this reason,) 5495 SB
2535 2589 2580 (each process has its own instance of ) 2580 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
5115 2589 565 (lpvMem) 565 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5680 2589 2592 (, declared as a global variable so it is) 2592 SB
2535 2789 5474 (available to the DLL\222s functions. The example assumes that the DLL\222s global) 5474 SB
2535 2989 4782 (data is not shared, so each attaching process has its own instance of ) 4782 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
7317 2989 565 (lpvMem) 565 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7882 2989 293 (. By) 293 SB
2535 3189 5533 (default, DLL data is not shared, but this can be modified by the DLL\222s module) 5533 SB
2535 3389 4649 (definition file \(see Section 50.1.4, \223The Module-Definition File\224\).) 4649 SB
2535 3722 5217 (Any shared DLL memory persists only as long as the DLL is attached to a) 5217 SB
2535 3922 5584 (process. In this example, the shared memory is released when the last handle of) 5584 SB
2535 4122 5725 (the file-mapping object is closed. To create persistent shared memory, a DLL can) 5725 SB
2535 4322 5498 (create a detached process \(see Chapter 43, \223Processes and Threads\224\) when the) 5498 SB
2535 4522 5680 (DLL attaches to the first process. If this detached process uses the DLL and does) 5680 SB
2535 4722 5613 (not terminate, it has a handle of the file-mapping object that prevents the shared) 5613 SB
2535 4922 2066 (memory from being released.) 2066 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 5275 160 (/*) 160 SB
2535 5458 1760 ( *   File:  dllshmem.c) 1760 SB
2535 5641 160 ( *) 160 SB
2535 5824 4480 ( *   DLL entrypoint function sets up shared memory using) 4480 SB
2535 6007 1920 ( *   named file mapping.) 1920 SB
2535 6190 240 ( */) 240 SB
2535 6556 1600 (#include <windows.h>) 1600 SB
2535 6739 1520 (#include <memory.h>) 1520 SB
2535 7105 1760 (#define SHMEMSIZE 4096) 1760 SB
2535 7471 4720 (static LPVOID lpvMem = NULL; /* address of shared memory */) 4720 SB
2535 7837 160 (/*) 160 SB
2535 8020 4480 ( * LibMain\(\) is the DllEntryPoint function for this DLL.) 4480 SB
2535 8203 240 ( */) 240 SB
2535 8569 4720 (BOOL LibMain\(HINSTANCE hinstDLL,   /* DLL module handle  */) 4720 SB
2535 8752 4720 (        DWORD fdwReason,      /* reason called           */) 4720 SB
2535 8935 4720 (        LPVOID lpvReserved\) { /* reserved                */) 4720 SB
2535 9301 4800 (    HANDLE hMapObject = NULL;   /* handle to file mapping */) 4800 SB
2535 9484 1920 (    BOOL fInit, fIgnore;) 1920 SB
2535 9850 1920 (    switch \(fdwReason\) {) 1920 SB
2535 10216 800 (        /*) 800 SB
2535 10399 4480 (         * DLL is attaching to a process, due to process) 4480 SB
2535 10582 4080 (         * initialization or a call to LoadLibrary.) 4080 SB
2535 10765 880 (         */) 880 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 184 def
/wp$fpage (184) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 184 def
/wp$fpage (184) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 15 15
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5719 1517 2244 (Chapter 50    Dynamic-Link Libraries) 2244 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (185) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2009 2720 (          case DLL_PROCESS_ATTACH:) 2720 SB
2885 2375 4000 (            /* create named file mapping object */) 4000 SB
2885 2741 3440 (            hMapObject = CreateFileMapping\() 3440 SB
2885 2924 4880 (                \(HANDLE\) 0xFFFFFFFF, /* use paging file    */) 4880 SB
2885 3107 4880 (                NULL,                /* no security attr.  */) 4880 SB
2885 3290 4880 (                PAGE_READWRITE,      /* read/write access  */) 4880 SB
2885 3473 4880 (                0,                   /* size: high 32-bits */) 4880 SB
2885 3656 4880 (                SHMEMSIZE,           /* size: low 32-bits  */) 4880 SB
2885 3839 4880 (                "dllmemfilemap"\);    /* name of map object */) 4880 SB
2885 4022 2800 (            if \(hMapObject == NULL\)) 2800 SB
2885 4205 2320 (                return FALSE;) 2320 SB
2885 4571 5200 (            /* The first process to attach initializes memory. */) 5200 SB
2885 4937 4880 (            fInit = \(GetLastError\(\) != ERROR_ALREADY_EXISTS\);) 4880 SB
2885 5303 4880 (            /* Get a pointer to file mapped shared memory. */) 4880 SB
2885 5669 2800 (            lpvMem = MapViewOfFile\() 2800 SB
2885 5852 4960 (                hMapObject,     /* object to map view of    */) 4960 SB
2885 6035 4960 (                FILE_MAP_WRITE, /* read/write access        */) 4960 SB
2885 6218 4960 (                0,              /* high offset: map from    */) 4960 SB
2885 6401 4960 (                0,              /* low offset: beginning    */) 4960 SB
2885 6584 4960 (                0\);             /* default: map entire file */) 4960 SB
2885 6767 2480 (            if \(lpvMem == NULL\)) 2480 SB
2885 6950 2320 (                return FALSE;) 2320 SB
2885 7316 5200 (            /* Initialize memory if this is the first process. */) 5200 SB
2885 7682 1760 (            if \(fInit\)) 1760 SB
2885 7865 3840 (                memset\(lpvMem, '\\0', SHMEMSIZE\);) 3840 SB
2885 8231 1440 (            break;) 1440 SB
2885 8597 4480 (        /* The attached process creates a new thread. */) 4480 SB
2885 8963 2480 (        case DLL_THREAD_ATTACH:) 2480 SB
2885 9146 1440 (            break;) 1440 SB
2885 9512 4800 (        /* The thread of the attached process terminates. */) 4800 SB
2885 9878 2480 (        case DLL_THREAD_DETACH:) 2480 SB
2885 10061 1440 (            break;) 1440 SB
2885 10427 800 (        /*) 800 SB
2885 10610 4320 (         * The DLL is detaching from a process, due to) 4320 SB
2885 10793 4480 (         * process termination or a call to FreeLibrary.) 4480 SB
2885 10976 880 (         */) 880 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 185 def
/wp$fpage (185) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 185 def
/wp$fpage (185) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 16 16
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (186) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2535 2192 2560 (        case DLL_PROCESS_DETACH:) 2560 SB
2535 2558 5280 (            /* Unmap shared memory from process' address space. */) 5280 SB
2535 2924 3680 (            fIgnore = UnmapViewOfFile\(lpvMem\);) 3680 SB
2535 3290 5680 (            /* Close the process' handle to the file-mapping object. */) 5680 SB
2535 3656 3680 (            fIgnore = CloseHandle\(hMapObject\);) 3680 SB
2535 4022 1440 (            break;) 1440 SB
2535 4388 1280 (        default:) 1280 SB
2535 4571 1280 (          break;) 1280 SB
2535 4937 240 (  }) 240 SB
2535 5303 1280 (    return TRUE;) 1280 SB
2535 5486 2960 (    UNREFERENCED_PARAMETER\(hinstDLL\);) 2960 SB
2535 5669 3200 (    UNREFERENCED_PARAMETER\(lpvReserved\);) 3200 SB
2535 6035 80 (}) 80 SB
2535 6584 160 (/*) 160 SB
2535 6767 4240 ( * SetSharedMem\(\) sets the contents of shared memory.) 4240 SB
2535 6950 240 ( */) 240 SB
2535 7316 2800 (VOID SetSharedMem\(LPTSTR lpszBuf\) {) 2800 SB
2535 7499 1520 (    LPTSTR lpszTmp;) 1520 SB
2535 7865 4240 (    /* Get the address of the shared memory block. */) 4240 SB
2535 8231 2400 (    lpszTmp = \(LPTSTR\) lpvMem;) 2400 SB
2535 8597 4880 (    /* Copy the null-terminated string into shared memory. */) 4880 SB
2535 8963 1600 (    while \(*lpszBuf\)) 1600 SB
2535 9146 2560 (        *lpszTmp++ = *lpszBuf++;) 2560 SB
2535 9329 1600 (    *lpszTmp = '\\0';) 1600 SB
2535 9512 80 (}) 80 SB
2535 10061 160 (/*) 160 SB
2535 10244 3920 ( * GetSharedMem\(\) gets contents of shared memory.) 3920 SB
2535 10427 240 ( */) 240 SB
2535 10793 4000 (VOID GetSharedMem\(LPTSTR lpszBuf, DWORD cchSize\) {) 4000 SB
2535 10976 1520 (    LPTSTR lpszTmp;) 1520 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 186 def
/wp$fpage (186) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 186 def
/wp$fpage (186) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 17 17
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5719 1517 2244 (Chapter 50    Dynamic-Link Libraries) 2244 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (187) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2192 4240 (    /* Get the address of the shared memory block. */) 4240 SB
2885 2558 2400 (    lpszTmp = \(LPTSTR\) lpvMem;) 2400 SB
2885 2924 4720 (    /* Copy from shared memory into the caller's buffer. */) 4720 SB
2885 3290 2640 (    while \(*lpszTmp && --cchSize\)) 2640 SB
2885 3473 2560 (        *lpszBuf++ = *lpszTmp++;) 2560 SB
2885 3656 1600 (    *lpszBuf = '\\0';) 1600 SB
2885 3839 80 (}) 80 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 4288 6766 (50.2.5  Using Thread Local Storage in a Dynamic-Link Library) 6766 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4669 5724 (This section shows the use of a DLL\222s entrypoint function to set up a thread local) 5724 SB
2885 4869 5687 (storage \(TLS\) index to provide private storage for each thread of a multithreaded) 5687 SB
2885 5069 570 (process.) 570 SB
2885 5402 2319 (The entrypoint function uses the ) 2319 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5204 5399 624 (TlsAlloc) 624 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5828 5402 2314 ( function to allocate a TLS index) 2314 SB
2885 5602 5662 (whenever the DLL attaches to a process. Each thread of the process can then use) 5662 SB
2885 5802 3953 (this index to store a pointer to its own block of memory.) 3953 SB
2885 6135 5761 (When the entrypoint function is called with the DLL_PROCESS_ATTACH code,) 5761 SB
2885 6335 1499 (it does the following:) 1499 SB
2886 6668 132 (1.) 132 SB
3118 6668 643 (Uses the ) 643 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3761 6665 624 (TlsAlloc) 624 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4385 6668 2358 ( function to allocate a TLS index.) 2358 SB
2886 6935 132 (2.) 132 SB
3118 6935 5506 (Allocates a block of memory to be used exclusively by the initial thread of the) 5506 SB
3118 7135 570 (process.) 570 SB
2886 7402 132 (3.) 132 SB
3118 7402 2474 (Uses the TLS index in a call to the ) 2474 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5592 7399 905 (TlsSetValue) 905 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6497 7402 2041 ( function to store a pointer to) 2041 SB
3118 7602 1566 (the allocated memory.) 1566 SB
2885 8002 5689 (Each time the process creates a new thread, the entrypoint function is called with) 5689 SB
2885 8202 5455 (the DLL_THREAD_ATTACH code. The entrypoint function then allocates a) 5455 SB
2885 8402 5532 (block of memory for the new thread and stores a pointer to it by using the TLS) 5532 SB
2885 8602 3754 (index. Each thread can use the TLS index in a call to ) 3754 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6639 8599 944 (TlsGetValue) 944 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7583 8602 1020 ( to retrieve the) 1020 SB
2885 8802 2532 (pointer to its own block of memory.) 2532 SB
2885 9135 4738 (When a thread terminates, the entrypoint function is called with the) 4738 SB
2885 9335 5727 (DLL_THREAD_DETACH code and the memory for that thread is freed. When a) 5727 SB
2885 9535 4241 (process terminates, the entrypoint function is called with the) 4241 SB
2885 9735 4315 (DLL_PROCESS_DETACH code and the TLS index is freed.) 4315 SB
2885 10068 5701 (The TLS index is stored in a global variable, making it available to all the DLL\222s) 5701 SB
2885 10268 5338 (functions. The following example assumes that the DLL\222s global data is not) 5338 SB
2885 10468 5433 (shared, because the TLS index is not necessarily the same for each process to) 5433 SB
2885 10668 1907 (which the DLL is attached.) 1907 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 187 def
/wp$fpage (187) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 187 def
/wp$fpage (187) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 18 18
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (188) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2535 2009 4400 (static DWORD dwTlsIndex; /* address of shared memory */) 4400 SB
2535 2375 160 (/*) 160 SB
2535 2558 4480 ( * LibMain\(\) is the DllEntryPoint function for this DLL.) 4480 SB
2535 2741 240 ( */) 240 SB
2535 3107 4720 (BOOL LibMain\(HINSTANCE hinstDLL,   /* DLL module handle  */) 4720 SB
2535 3290 4720 (        DWORD fdwReason,           /* reason called      */) 4720 SB
2535 3473 4720 (        LPVOID lpvReserved\) {      /* reserved           */) 4720 SB
2535 3839 1520 (    LPVOID lpvData;) 1520 SB
2535 4022 1360 (    BOOL fIgnore;) 1360 SB
2535 4388 1920 (    switch \(fdwReason\) {) 1920 SB
2535 4754 800 (        /*) 800 SB
2535 4937 4800 (         * The DLL is attaching to a process, due to process) 4800 SB
2535 5120 4080 (         * initialization or a call to LoadLibrary.) 4080 SB
2535 5303 880 (         */) 880 SB
2535 5669 2560 (        case DLL_PROCESS_ATTACH:) 2560 SB
2535 6035 3280 (              /* Allocate a TLS index. */) 3280 SB
2535 6401 4640 (              if \(\(dwTlsIndex = TlsAlloc\(\)\) == 0xFFFFFFFF\)) 4640 SB
2535 6584 2480 (                  return FALSE;) 2480 SB
2535 6950 5280 (            /* No break: Initialize the index for first thread. */) 5280 SB
2535 7316 4480 (        /* The attached process creates a new thread. */) 4480 SB
2535 7682 2480 (        case DLL_THREAD_ATTACH:) 2480 SB
2535 8048 4720 (            /* Initialize the TLS index for this thread. */) 4720 SB
2535 8414 4240 (            lpvData = \(LPVOID\) LocalAlloc\(LPTR, 256\);) 4240 SB
2535 8597 2560 (            if \(lpvData != NULL\)) 2560 SB
2535 8780 4720 (                fIgnore = TlsSetValue\(dwTlsIndex, lpvData\);) 4720 SB
2535 9146 1440 (            break;) 1440 SB
2535 9512 4800 (        /* The thread of the attached process terminates. */) 4800 SB
2535 9878 2480 (        case DLL_THREAD_DETACH:) 2480 SB
2535 10244 5040 (            /* Release the allocated memory for this thread. */) 5040 SB
2535 10610 3680 (            lpvData = TlsGetValue\(dwTlsIndex\);) 3680 SB
2535 10793 2560 (            if \(lpvData != NULL\)) 2560 SB
2535 10976 3520 (                LocalFree\(\(HLOCAL\) lpvData\);) 3520 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 188 def
/wp$fpage (188) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 188 def
/wp$fpage (188) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 19 19
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
5719 1517 2244 (Chapter 50    Dynamic-Link Libraries) 2244 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (189) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2192 1440 (            break;) 1440 SB
2885 2558 800 (        /*) 800 SB
2885 2741 4320 (         * The DLL is detaching from a process, due to) 4320 SB
2885 2924 4320 (         * process termination or call to FreeLibrary.) 4320 SB
2885 3107 880 (         */) 880 SB
2885 3473 2560 (        case DLL_PROCESS_DETACH:) 2560 SB
2885 3839 5040 (            /* Release the allocated memory for this thread. */) 5040 SB
2885 4205 3680 (            lpvData = TlsGetValue\(dwTlsIndex\);) 3680 SB
2885 4388 2560 (            if \(lpvData != NULL\)) 2560 SB
2885 4571 3520 (                LocalFree\(\(HLOCAL\) lpvData\);) 3520 SB
2885 4937 3200 (            /* Release the TLS index. */) 3200 SB
2885 5303 2560 (            TlsFree\(dwTlsIndex\);) 2560 SB
2885 5486 1440 (            break;) 1440 SB
2885 5852 1280 (        default:) 1280 SB
2885 6035 1440 (            break;) 1440 SB
2885 6401 400 (    }) 400 SB
2885 6767 1280 (    return TRUE;) 1280 SB
2885 6950 2960 (    UNREFERENCED_PARAMETER\(hinstDLL\);) 2960 SB
2885 7133 3200 (    UNREFERENCED_PARAMETER\(lpvReserved\);) 3200 SB
2885 7499 80 (}) 80 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 7845 5615 (When a process uses load-time linking with this DLL, the entrypoint function is) 5615 SB
2885 8045 5633 (sufficient to manage the thread local storage. Problems can occur with a process) 5633 SB
2885 8245 5595 (that uses run-time linking, because the TLS memory is not allocated for threads) 5595 SB
2885 8445 1435 (that exist before the ) 1435 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4320 8442 985 (LoadLibrary) 985 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5305 8445 3090 ( function is called to attach the process. The) 3090 SB
2885 8645 5423 (following example solves this problem by checking the value returned by the) 5423 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 8842 944 (TlsGetValue) 944 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3829 8845 4720 ( function and allocating memory if the value indicates that the TLS) 4720 SB
2885 9045 1996 (slot for this thread is not set.) 1996 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 9398 1200 (LPVOID lpvData;) 1200 SB
2885 9764 4240 (/* Retrieve a data pointer for the current thread. */) 4240 SB
2885 10130 2720 (lpvData = TlsGetValue\(dwTlsIndex\);) 2720 SB
2885 10496 3760 (/* If NULL, allocate memory for this thread. */) 3760 SB
2885 10862 1760 (if \(lpvData == NULL\) {) 1760 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 189 def
/wp$fpage (189) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 189 def
/wp$fpage (189) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 20 20
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (190) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2535 2009 3600 (    lpvData = \(LPVOID\) LocalAlloc\(LPTR, 256\);) 3600 SB
2535 2192 1920 (    if \(lpvData != NULL\)) 1920 SB
2535 2375 3280 (        TlsSetValue\(dwTlsIndex, lpvData\);) 3280 SB
2535 2558 80 (}) 80 SB
32 0 0 333 333 0 0 0 311 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 3050 1990 (50.3  Functions) 1990 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 3505 3720 (Following are the functions used in dynamic linking.) 3720 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 3835 1061 (DllEntryPoint) 1061 SB
2535 4035 936 (FreeLibrary) 936 SB
2535 4235 1567 (GetModuleFileName) 1567 SB
2535 4435 1391 (GetModuleHandle) 1391 SB
2535 4635 1235 (GetProcAddress) 1235 SB
2535 4835 985 (LoadLibrary) 985 SB
2535 5035 1190 (LoadLibraryEx) 1190 SB
2535 5235 964 (LoadModule) 964 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 190 def
/wp$fpage (190) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 358 (DLL.DOC) 358 SB
gr
gs 5800 351 1426 12120 CB
2159 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3290 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3491 12144 298 (04/23/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3789 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4051 12144 346 (11:08 AM) 346 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 190 def
/wp$fpage (190) def
/wp$date (04/23/93) def
/wp$time (11:09 AM) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Trailer
SVDoc restore
end
%%Pages: 20
% TrueType font name key:
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT31c1d5 = 09afDArial NarrowF00000000000002bc0000
%    MSTT31c1e1 = 09afDTimes New RomanF00000064000001900000
%    MSTT31c1ee = 09afDTimes New RomanF00000053000001900000
%    MSTT31c1fb = 09afDTimes New RomanF00000000000001900000
%    MSTT31c208 = 09afDTimes New RomanF00000000000002bc0000
%    MSTT31c215 = 09afDTimes New RomanF00000043000001900000
%    MSTT31c222 = 09afDTimes New RomanF00000000000001900001
%    MSTT31c22f = 09afDLucida Sans TypewriterF00000000000001900000
%    MSTT31c252 = 09afDArialF00000000000002bc0000
%%DocumentSuppliedResources: procset Win35Dict 3 1

%%DocumentNeededResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman

%%EOF
