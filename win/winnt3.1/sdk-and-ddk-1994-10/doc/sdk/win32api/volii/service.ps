%!PS-Adobe-3.0
%%Creator: Windows PSCRIPT
%%Title: Microsoft Word - SERVICE.DOC
%%BoundingBox: 14 9 597 784
%%DocumentNeededResources: (atend)
%%DocumentSuppliedResources: (atend)
%%Pages: (atend)
%%BeginResource: procset Win35Dict 3 1
/Win35Dict 290 dict def Win35Dict begin/bd{bind def}bind def/in{72
mul}bd/ed{exch def}bd/ld{load def}bd/tr/translate ld/gs/gsave ld/gr
/grestore ld/M/moveto ld/L/lineto ld/rmt/rmoveto ld/rlt/rlineto ld
/rct/rcurveto ld/st/stroke ld/n/newpath ld/sm/setmatrix ld/cm/currentmatrix
ld/cp/closepath ld/ARC/arcn ld/TR{65536 div}bd/lj/setlinejoin ld/lc
/setlinecap ld/ml/setmiterlimit ld/sl/setlinewidth ld/scignore false
def/sc{scignore{pop pop pop}{0 index 2 index eq 2 index 4 index eq
and{pop pop 255 div setgray}{3{255 div 3 1 roll}repeat setrgbcolor}ifelse}ifelse}bd
/FC{bR bG bB sc}bd/fC{/bB ed/bG ed/bR ed}bd/HC{hR hG hB sc}bd/hC{
/hB ed/hG ed/hR ed}bd/PC{pR pG pB sc}bd/pC{/pB ed/pG ed/pR ed}bd/sM
matrix def/PenW 1 def/iPen 5 def/mxF matrix def/mxE matrix def/mxUE
matrix def/mxUF matrix def/fBE false def/iDevRes 72 0 matrix defaultmatrix
dtransform dup mul exch dup mul add sqrt def/fPP false def/SS{fPP{
/SV save def}{gs}ifelse}bd/RS{fPP{SV restore}{gr}ifelse}bd/EJ{gsave
showpage grestore}bd/#C{userdict begin/#copies ed end}bd/FEbuf 2 string
def/FEglyph(G  )def/FE{1 exch{dup 16 FEbuf cvrs FEglyph exch 1 exch
putinterval 1 index exch FEglyph cvn put}for}bd/SM{/iRes ed/cyP ed
/cxPg ed/cyM ed/cxM ed 72 100 div dup scale dup 0 ne{90 eq{cyM exch
0 eq{cxM exch tr -90 rotate -1 1 scale}{cxM cxPg add exch tr +90 rotate}ifelse}{cyP
cyM sub exch 0 ne{cxM exch tr -90 rotate}{cxM cxPg add exch tr -90
rotate 1 -1 scale}ifelse}ifelse}{pop cyP cyM sub exch 0 ne{cxM cxPg
add exch tr 180 rotate}{cxM exch tr 1 -1 scale}ifelse}ifelse 100 iRes
div dup scale 0 0 transform .25 add round .25 sub exch .25 add round
.25 sub exch itransform translate}bd/SJ{1 index 0 eq{pop pop/fBE false
def}{1 index/Break ed div/dxBreak ed/fBE true def}ifelse}bd/ANSIVec[
16#0/grave 16#1/acute 16#2/circumflex 16#3/tilde 16#4/macron 16#5/breve
16#6/dotaccent 16#7/dieresis 16#8/ring 16#9/cedilla 16#A/hungarumlaut
16#B/ogonek 16#C/caron 16#D/dotlessi 16#27/quotesingle 16#60/grave
16#7C/bar 16#82/quotesinglbase 16#83/florin 16#84/quotedblbase 16#85
/ellipsis 16#86/dagger 16#87/daggerdbl 16#89/perthousand 16#8A/Scaron
16#8B/guilsinglleft 16#8C/OE 16#91/quoteleft 16#92/quoteright 16#93
/quotedblleft 16#94/quotedblright 16#95/bullet 16#96/endash 16#97
/emdash 16#99/trademark 16#9A/scaron 16#9B/guilsinglright 16#9C/oe
16#9F/Ydieresis 16#A0/space 16#A4/currency 16#A6/brokenbar 16#A7/section
16#A8/dieresis 16#A9/copyright 16#AA/ordfeminine 16#AB/guillemotleft
16#AC/logicalnot 16#AD/hyphen 16#AE/registered 16#AF/macron 16#B0/degree
16#B1/plusminus 16#B2/twosuperior 16#B3/threesuperior 16#B4/acute 16#B5
/mu 16#B6/paragraph 16#B7/periodcentered 16#B8/cedilla 16#B9/onesuperior
16#BA/ordmasculine 16#BB/guillemotright 16#BC/onequarter 16#BD/onehalf
16#BE/threequarters 16#BF/questiondown 16#C0/Agrave 16#C1/Aacute 16#C2
/Acircumflex 16#C3/Atilde 16#C4/Adieresis 16#C5/Aring 16#C6/AE 16#C7
/Ccedilla 16#C8/Egrave 16#C9/Eacute 16#CA/Ecircumflex 16#CB/Edieresis
16#CC/Igrave 16#CD/Iacute 16#CE/Icircumflex 16#CF/Idieresis 16#D0/Eth
16#D1/Ntilde 16#D2/Ograve 16#D3/Oacute 16#D4/Ocircumflex 16#D5/Otilde
16#D6/Odieresis 16#D7/multiply 16#D8/Oslash 16#D9/Ugrave 16#DA/Uacute
16#DB/Ucircumflex 16#DC/Udieresis 16#DD/Yacute 16#DE/Thorn 16#DF/germandbls
16#E0/agrave 16#E1/aacute 16#E2/acircumflex 16#E3/atilde 16#E4/adieresis
16#E5/aring 16#E6/ae 16#E7/ccedilla 16#E8/egrave 16#E9/eacute 16#EA
/ecircumflex 16#EB/edieresis 16#EC/igrave 16#ED/iacute 16#EE/icircumflex
16#EF/idieresis 16#F0/eth 16#F1/ntilde 16#F2/ograve 16#F3/oacute 16#F4
/ocircumflex 16#F5/otilde 16#F6/odieresis 16#F7/divide 16#F8/oslash
16#F9/ugrave 16#FA/uacute 16#FB/ucircumflex 16#FC/udieresis 16#FD/yacute
16#FE/thorn 16#FF/ydieresis ] def/reencdict 12 dict def/IsChar{basefontdict
/CharStrings get exch known}bd/MapCh{dup IsChar not{pop/bullet}if
newfont/Encoding get 3 1 roll put}bd/MapDegree{16#b0/degree IsChar{
/degree}{/ring}ifelse MapCh}bd/MapBB{16#a6/brokenbar IsChar{/brokenbar}{
/bar}ifelse MapCh}bd/ANSIFont{reencdict begin/newfontname ed/basefontname
ed FontDirectory newfontname known not{/basefontdict basefontname findfont
def/newfont basefontdict maxlength dict def basefontdict{exch dup/FID
ne{dup/Encoding eq{exch dup length array copy newfont 3 1 roll put}{exch
newfont 3 1 roll put}ifelse}{pop pop}ifelse}forall newfont/FontName
newfontname put 127 1 159{newfont/Encoding get exch/bullet put}for
ANSIVec aload pop ANSIVec length 2 idiv{MapCh}repeat MapDegree MapBB
newfontname newfont definefont pop}if newfontname end}bd/SB{FC/ULlen
ed/str ed str length fBE not{dup 1 gt{1 sub}if}if/cbStr ed/dxGdi ed
/y0 ed/x0 ed str stringwidth dup 0 ne{/y1 ed/x1 ed y1 y1 mul x1 x1
mul add sqrt dxGdi exch div 1 sub dup x1 mul cbStr div exch y1 mul
cbStr div}{exch abs neg dxGdi add cbStr div exch}ifelse/dyExtra ed
/dxExtra ed x0 y0 M fBE{dxBreak 0 BCh dxExtra dyExtra str awidthshow}{dxExtra
dyExtra str ashow}ifelse fUL{x0 y0 M dxUL dyUL rmt ULlen fBE{Break
add}if 0 mxUE transform gs rlt cyUL sl [] 0 setdash st gr}if fSO{x0
y0 M dxSO dySO rmt ULlen fBE{Break add}if 0 mxUE transform gs rlt cyUL
sl [] 0 setdash st gr}if n/fBE false def}bd/font{/name ed/Ascent ed
0 ne/fT3 ed 0 ne/fSO ed 0 ne/fUL ed/Sy ed/Sx ed 10.0 div/ori ed -10.0
div/esc ed/BCh ed name findfont/xAscent 0 def/yAscent Ascent def/ULesc
esc def ULesc mxUE rotate pop fT3{/esc 0 def xAscent yAscent mxUE transform
/yAscent ed/xAscent ed}if [Sx 0 0 Sy neg xAscent yAscent] esc mxE
rotate mxF concatmatrix makefont setfont [Sx 0 0 Sy neg 0 Ascent] mxUE
mxUF concatmatrix pop fUL{currentfont dup/FontInfo get/UnderlinePosition
known not{pop/Courier findfont}if/FontInfo get/UnderlinePosition get
1000 div 0 exch mxUF transform/dyUL ed/dxUL ed}if fSO{0 .3 mxUF transform
/dySO ed/dxSO ed}if fUL fSO or{currentfont dup/FontInfo get/UnderlineThickness
known not{pop/Courier findfont}if/FontInfo get/UnderlineThickness get
1000 div Sy mul/cyUL ed}if}bd/min{2 copy gt{exch}if pop}bd/max{2 copy
lt{exch}if pop}bd/CP{/ft ed{{ft 0 eq{clip}{eoclip}ifelse}stopped{currentflat
1 add setflat}{exit}ifelse}loop}bd/patfont 10 dict def patfont begin
/FontType 3 def/FontMatrix [1 0 0 -1 0 0] def/FontBBox [0 0 16 16]
def/Encoding StandardEncoding def/BuildChar{pop pop 16 0 0 0 16 16
setcachedevice 16 16 false [1 0 0 1 .25 .25]{pat}imagemask}bd end/p{
/pat 32 string def{}forall 0 1 7{dup 2 mul pat exch 3 index put dup
2 mul 1 add pat exch 3 index put dup 2 mul 16 add pat exch 3 index
put 2 mul 17 add pat exch 2 index put pop}for}bd/pfill{/PatFont patfont
definefont setfont/ch(AAAA)def X0 64 X1{Y1 -16 Y0{1 index exch M ch
show}for pop}for}bd/vert{X0 w X1{dup Y0 M Y1 L st}for}bd/horz{Y0 w
Y1{dup X0 exch M X1 exch L st}for}bd/fdiag{X0 w X1{Y0 M X1 X0 sub dup
rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup rlt st}for}bd/bdiag{X0 w
X1{Y1 M X1 X0 sub dup neg rlt st}for Y0 w Y1{X0 exch M Y1 Y0 sub dup
neg rlt st}for}bd/AU{1 add cvi 15 or}bd/AD{1 sub cvi -16 and}bd/SHR{pathbbox
AU/Y1 ed AU/X1 ed AD/Y0 ed AD/X0 ed}bd/hfill{/w iRes 37.5 div round
def 0.1 sl [] 0 setdash n dup 0 eq{horz}if dup 1 eq{vert}if dup 2 eq{fdiag}if
dup 3 eq{bdiag}if dup 4 eq{horz vert}if 5 eq{fdiag bdiag}if}bd/F{/ft
ed fm 256 and 0 ne{gs FC ft 0 eq{fill}{eofill}ifelse gr}if fm 1536
and 0 ne{SHR gs HC ft CP fm 1024 and 0 ne{/Tmp save def pfill Tmp restore}{fm
15 and hfill}ifelse gr}if}bd/S{PenW sl PC st}bd/m matrix def/GW{iRes
12 div PenW add cvi}bd/DoW{iRes 50 div PenW add cvi}bd/DW{iRes 8 div
PenW add cvi}bd/SP{/PenW ed/iPen ed iPen 0 eq iPen 6 eq or{[] 0 setdash}if
iPen 1 eq{[DW GW] 0 setdash}if iPen 2 eq{[DoW GW] 0 setdash}if iPen
3 eq{[DW GW DoW GW] 0 setdash}if iPen 4 eq{[DW GW DoW GW DoW GW] 0
setdash}if}bd/E{m cm pop tr scale 1 0 moveto 0 0 1 0 360 arc cp m sm}bd
/AG{/sy ed/sx ed sx div 4 1 roll sy div 4 1 roll sx div 4 1 roll sy
div 4 1 roll atan/a2 ed atan/a1 ed sx sy scale a1 a2 ARC}def/A{m cm
pop tr AG m sm}def/P{m cm pop tr 0 0 M AG cp m sm}def/RRect{n 4 copy
M 3 1 roll exch L 4 2 roll L L cp}bd/RRCC{/r ed/y1 ed/x1 ed/y0 ed/x0
ed x0 x1 add 2 div y0 M x1 y0 x1 y1 r arcto 4{pop}repeat x1 y1 x0 y1
r arcto 4{pop}repeat x0 y1 x0 y0 r arcto 4{pop}repeat x0 y0 x1 y0 r
arcto 4{pop}repeat cp}bd/RR{2 copy 0 eq exch 0 eq or{pop pop RRect}{2
copy eq{pop RRCC}{m cm pop/y2 ed/x2 ed/ys y2 x2 div 1 max def/xs x2
y2 div 1 max def/y1 exch ys div def/x1 exch xs div def/y0 exch ys div
def/x0 exch xs div def/r2 x2 y2 min def xs ys scale x0 x1 add 2 div
y0 M x1 y0 x1 y1 r2 arcto 4{pop}repeat x1 y1 x0 y1 r2 arcto 4{pop}repeat
x0 y1 x0 y0 r2 arcto 4{pop}repeat x0 y0 x1 y0 r2 arcto 4{pop}repeat
m sm cp}ifelse}ifelse}bd/PP{{rlt}repeat}bd/OB{gs 0 ne{7 3 roll/y ed
/x ed x y translate ULesc rotate x neg y neg translate x y 7 -3 roll}if
sc B fill gr}bd/B{M/dy ed/dx ed dx 0 rlt 0 dy rlt dx neg 0 rlt cp}bd
/CB{B clip n}bd/ErrHandler{errordict dup maxlength exch length gt
dup{errordict begin}if/errhelpdict 12 dict def errhelpdict begin/stackunderflow(operand stack underflow)def
/undefined(this name is not defined in a dictionary)def/VMerror(you have used up all the printer's memory)def
/typecheck(operator was expecting a different type of operand)def
/ioerror(input/output error occured)def end{end}if errordict begin
/handleerror{$error begin newerror{/newerror false def showpage 72
72 scale/x .25 def/y 9.6 def/Helvetica findfont .2 scalefont setfont
x y moveto(Offending Command = )show/command load{dup type/stringtype
ne{(max err string)cvs}if show}exec/y y .2 sub def x y moveto(Error = )show
errorname{dup type dup( max err string )cvs show( : )show/stringtype
ne{( max err string )cvs}if show}exec errordict begin errhelpdict errorname
known{x 1 add y .2 sub moveto errhelpdict errorname get show}if end
/y y .4 sub def x y moveto(Stack =)show ostack{/y y .2 sub def x 1
add y moveto dup type/stringtype ne{( max err string )cvs}if show}forall
showpage}if end}def end}bd end
%%EndResource
/SVDoc save def
%%EndProlog
%%BeginSetup
Win35Dict begin
ErrHandler
statusdict begin 0 setjobtimeout end
statusdict begin statusdict /jobname (Microsoft Word - SERVICE.DOC) put end
/oldDictCnt countdictstack def {}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
/oldDictCnt countdictstack def {letter
}stopped 
{ countdictstack oldDictCnt lt { Win35Dict begin } 
{1 1 countdictstack oldDictCnt sub {pop end } for } ifelse } if 
[{ }
/exec load currenttransfer /exec load] cvx settransfer
/fPP true def
/setresolution where { pop 1200 1200 setresolution } if
%%EndSetup
%%Page: 1 1
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
8469 1517 216 (367) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 200 200 0 0 0 180 /Times-Roman /font32 ANSIFont font
0 0 0 fC
1385 1965 133 (C) 233 SB
1618 1965 144 (H) 244 SB
1862 1965 144 (A) 244 SB
2106 1965 111 (P) 211 SB
2317 1965 122 (T) 222 SB
2539 1965 122 (E) 222 SB
2761 1965 133 (R) 233 SB
2994 1965 50 ( ) 150 SB
3144 1965 100 (5) 200 SB
3344 1965 100 (8) 200 SB
32 0 0 400 400 0 0 0 373 /Helvetica-Narrow-Bold /font16 ANSIFont font
gs 5600 2050 1384 2419 CB
1384 2406 1348 (Services) 1348 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4473 1473 (58.1  About Services) 1473 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
4399 4510 33 (.) 83 SB
4482 4510 33 (.) 83 SB
4565 4510 33 (.) 83 SB
4648 4510 33 (.) 83 SB
4731 4510 33 (.) 83 SB
4814 4510 33 (.) 83 SB
4897 4510 33 (.) 83 SB
4980 4510 33 (.) 83 SB
5063 4510 33 (.) 83 SB
5146 4510 33 (.) 83 SB
5229 4510 33 (.) 83 SB
5312 4510 33 (.) 83 SB
5395 4510 33 (.) 83 SB
5478 4510 33 (.) 83 SB
5561 4510 33 (.) 83 SB
5644 4510 33 (.) 83 SB
5727 4510 33 (.) 83 SB
5810 4510 33 (.) 83 SB
5893 4510 33 (.) 83 SB
5976 4510 33 (.) 83 SB
6059 4510 33 (.) 83 SB
6142 4510 33 (.) 83 SB
6225 4510 33 (.) 83 SB
6308 4510 33 (.) 83 SB
6391 4510 33 (.) 83 SB
6474 4510 33 (.) 83 SB
6557 4510 33 (.) 83 SB
6640 4510 33 (.) 83 SB
6723 4510 33 (.) 83 SB
6806 4510 33 (.) 83 SB
6889 4510 33 (.) 83 SB
6972 4510 33 (.) 83 SB
7055 4510 33 (.) 83 SB
7138 4510 33 (.) 83 SB
7221 4510 33 (.) 83 SB
7304 4510 33 (.) 83 SB
7387 4510 33 (.) 83 SB
7470 4510 33 (.) 83 SB
7553 4510 33 (.) 83 SB
7636 4510 33 (.) 83 SB
7719 4510 33 (.) 83 SB
7802 4510 33 (.) 83 SB
7885 4510 33 (.) 83 SB
7968 4510 33 (.) 83 SB
8051 4510 33 (.) 83 SB
8134 4510 33 (.) 83 SB
8217 4510 33 (.) 83 SB
8300 4510 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 4473 264 (368) 264 SB
3118 4706 2620 (58.1.1  The Service Control Manager) 2620 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5810 4743 33 (.) 83 SB
5893 4743 33 (.) 83 SB
5976 4743 33 (.) 83 SB
6059 4743 33 (.) 83 SB
6142 4743 33 (.) 83 SB
6225 4743 33 (.) 83 SB
6308 4743 33 (.) 83 SB
6391 4743 33 (.) 83 SB
6474 4743 33 (.) 83 SB
6557 4743 33 (.) 83 SB
6640 4743 33 (.) 83 SB
6723 4743 33 (.) 83 SB
6806 4743 33 (.) 83 SB
6889 4743 33 (.) 83 SB
6972 4743 33 (.) 83 SB
7055 4743 33 (.) 83 SB
7138 4743 33 (.) 83 SB
7221 4743 33 (.) 83 SB
7304 4743 33 (.) 83 SB
7387 4743 33 (.) 83 SB
7470 4743 33 (.) 83 SB
7553 4743 33 (.) 83 SB
7636 4743 33 (.) 83 SB
7719 4743 33 (.) 83 SB
7802 4743 33 (.) 83 SB
7885 4743 33 (.) 83 SB
7968 4743 33 (.) 83 SB
8051 4743 33 (.) 83 SB
8134 4743 33 (.) 83 SB
8217 4743 33 (.) 83 SB
8300 4743 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 4706 264 (368) 264 SB
3118 4939 2648 (58.1.2  Database of Installed Services) 2648 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5810 4976 33 (.) 83 SB
5893 4976 33 (.) 83 SB
5976 4976 33 (.) 83 SB
6059 4976 33 (.) 83 SB
6142 4976 33 (.) 83 SB
6225 4976 33 (.) 83 SB
6308 4976 33 (.) 83 SB
6391 4976 33 (.) 83 SB
6474 4976 33 (.) 83 SB
6557 4976 33 (.) 83 SB
6640 4976 33 (.) 83 SB
6723 4976 33 (.) 83 SB
6806 4976 33 (.) 83 SB
6889 4976 33 (.) 83 SB
6972 4976 33 (.) 83 SB
7055 4976 33 (.) 83 SB
7138 4976 33 (.) 83 SB
7221 4976 33 (.) 83 SB
7304 4976 33 (.) 83 SB
7387 4976 33 (.) 83 SB
7470 4976 33 (.) 83 SB
7553 4976 33 (.) 83 SB
7636 4976 33 (.) 83 SB
7719 4976 33 (.) 83 SB
7802 4976 33 (.) 83 SB
7885 4976 33 (.) 83 SB
7968 4976 33 (.) 83 SB
8051 4976 33 (.) 83 SB
8134 4976 33 (.) 83 SB
8217 4976 33 (.) 83 SB
8300 4976 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 4939 264 (369) 264 SB
3118 5172 2300 (58.1.3  Win32 Service Processes) 2300 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5478 5209 33 (.) 83 SB
5561 5209 33 (.) 83 SB
5644 5209 33 (.) 83 SB
5727 5209 33 (.) 83 SB
5810 5209 33 (.) 83 SB
5893 5209 33 (.) 83 SB
5976 5209 33 (.) 83 SB
6059 5209 33 (.) 83 SB
6142 5209 33 (.) 83 SB
6225 5209 33 (.) 83 SB
6308 5209 33 (.) 83 SB
6391 5209 33 (.) 83 SB
6474 5209 33 (.) 83 SB
6557 5209 33 (.) 83 SB
6640 5209 33 (.) 83 SB
6723 5209 33 (.) 83 SB
6806 5209 33 (.) 83 SB
6889 5209 33 (.) 83 SB
6972 5209 33 (.) 83 SB
7055 5209 33 (.) 83 SB
7138 5209 33 (.) 83 SB
7221 5209 33 (.) 83 SB
7304 5209 33 (.) 83 SB
7387 5209 33 (.) 83 SB
7470 5209 33 (.) 83 SB
7553 5209 33 (.) 83 SB
7636 5209 33 (.) 83 SB
7719 5209 33 (.) 83 SB
7802 5209 33 (.) 83 SB
7885 5209 33 (.) 83 SB
7968 5209 33 (.) 83 SB
8051 5209 33 (.) 83 SB
8134 5209 33 (.) 83 SB
8217 5209 33 (.) 83 SB
8300 5209 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5172 264 (370) 264 SB
3352 5405 1700 (58.1.3.1  Main Function) 1700 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5063 5442 33 (.) 83 SB
5146 5442 33 (.) 83 SB
5229 5442 33 (.) 83 SB
5312 5442 33 (.) 83 SB
5395 5442 33 (.) 83 SB
5478 5442 33 (.) 83 SB
5561 5442 33 (.) 83 SB
5644 5442 33 (.) 83 SB
5727 5442 33 (.) 83 SB
5810 5442 33 (.) 83 SB
5893 5442 33 (.) 83 SB
5976 5442 33 (.) 83 SB
6059 5442 33 (.) 83 SB
6142 5442 33 (.) 83 SB
6225 5442 33 (.) 83 SB
6308 5442 33 (.) 83 SB
6391 5442 33 (.) 83 SB
6474 5442 33 (.) 83 SB
6557 5442 33 (.) 83 SB
6640 5442 33 (.) 83 SB
6723 5442 33 (.) 83 SB
6806 5442 33 (.) 83 SB
6889 5442 33 (.) 83 SB
6972 5442 33 (.) 83 SB
7055 5442 33 (.) 83 SB
7138 5442 33 (.) 83 SB
7221 5442 33 (.) 83 SB
7304 5442 33 (.) 83 SB
7387 5442 33 (.) 83 SB
7470 5442 33 (.) 83 SB
7553 5442 33 (.) 83 SB
7636 5442 33 (.) 83 SB
7719 5442 33 (.) 83 SB
7802 5442 33 (.) 83 SB
7885 5442 33 (.) 83 SB
7968 5442 33 (.) 83 SB
8051 5442 33 (.) 83 SB
8134 5442 33 (.) 83 SB
8217 5442 33 (.) 83 SB
8300 5442 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5405 264 (370) 264 SB
3352 5638 2270 (58.1.3.2  Service Main Function) 2270 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5644 5675 33 (.) 83 SB
5727 5675 33 (.) 83 SB
5810 5675 33 (.) 83 SB
5893 5675 33 (.) 83 SB
5976 5675 33 (.) 83 SB
6059 5675 33 (.) 83 SB
6142 5675 33 (.) 83 SB
6225 5675 33 (.) 83 SB
6308 5675 33 (.) 83 SB
6391 5675 33 (.) 83 SB
6474 5675 33 (.) 83 SB
6557 5675 33 (.) 83 SB
6640 5675 33 (.) 83 SB
6723 5675 33 (.) 83 SB
6806 5675 33 (.) 83 SB
6889 5675 33 (.) 83 SB
6972 5675 33 (.) 83 SB
7055 5675 33 (.) 83 SB
7138 5675 33 (.) 83 SB
7221 5675 33 (.) 83 SB
7304 5675 33 (.) 83 SB
7387 5675 33 (.) 83 SB
7470 5675 33 (.) 83 SB
7553 5675 33 (.) 83 SB
7636 5675 33 (.) 83 SB
7719 5675 33 (.) 83 SB
7802 5675 33 (.) 83 SB
7885 5675 33 (.) 83 SB
7968 5675 33 (.) 83 SB
8051 5675 33 (.) 83 SB
8134 5675 33 (.) 83 SB
8217 5675 33 (.) 83 SB
8300 5675 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5638 264 (371) 264 SB
3352 5871 2475 (58.1.3.3  Control Handler Function) 2475 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5893 5908 33 (.) 83 SB
5976 5908 33 (.) 83 SB
6059 5908 33 (.) 83 SB
6142 5908 33 (.) 83 SB
6225 5908 33 (.) 83 SB
6308 5908 33 (.) 83 SB
6391 5908 33 (.) 83 SB
6474 5908 33 (.) 83 SB
6557 5908 33 (.) 83 SB
6640 5908 33 (.) 83 SB
6723 5908 33 (.) 83 SB
6806 5908 33 (.) 83 SB
6889 5908 33 (.) 83 SB
6972 5908 33 (.) 83 SB
7055 5908 33 (.) 83 SB
7138 5908 33 (.) 83 SB
7221 5908 33 (.) 83 SB
7304 5908 33 (.) 83 SB
7387 5908 33 (.) 83 SB
7470 5908 33 (.) 83 SB
7553 5908 33 (.) 83 SB
7636 5908 33 (.) 83 SB
7719 5908 33 (.) 83 SB
7802 5908 33 (.) 83 SB
7885 5908 33 (.) 83 SB
7968 5908 33 (.) 83 SB
8051 5908 33 (.) 83 SB
8134 5908 33 (.) 83 SB
8217 5908 33 (.) 83 SB
8300 5908 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 5871 264 (372) 264 SB
3118 6104 2799 (58.1.4  Service Configuration Programs) 2799 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5976 6141 33 (.) 83 SB
6059 6141 33 (.) 83 SB
6142 6141 33 (.) 83 SB
6225 6141 33 (.) 83 SB
6308 6141 33 (.) 83 SB
6391 6141 33 (.) 83 SB
6474 6141 33 (.) 83 SB
6557 6141 33 (.) 83 SB
6640 6141 33 (.) 83 SB
6723 6141 33 (.) 83 SB
6806 6141 33 (.) 83 SB
6889 6141 33 (.) 83 SB
6972 6141 33 (.) 83 SB
7055 6141 33 (.) 83 SB
7138 6141 33 (.) 83 SB
7221 6141 33 (.) 83 SB
7304 6141 33 (.) 83 SB
7387 6141 33 (.) 83 SB
7470 6141 33 (.) 83 SB
7553 6141 33 (.) 83 SB
7636 6141 33 (.) 83 SB
7719 6141 33 (.) 83 SB
7802 6141 33 (.) 83 SB
7885 6141 33 (.) 83 SB
7968 6141 33 (.) 83 SB
8051 6141 33 (.) 83 SB
8134 6141 33 (.) 83 SB
8217 6141 33 (.) 83 SB
8300 6141 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6104 264 (373) 264 SB
3118 6337 2350 (58.1.5  Service Control Programs) 2350 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5478 6374 33 (.) 83 SB
5561 6374 33 (.) 83 SB
5644 6374 33 (.) 83 SB
5727 6374 33 (.) 83 SB
5810 6374 33 (.) 83 SB
5893 6374 33 (.) 83 SB
5976 6374 33 (.) 83 SB
6059 6374 33 (.) 83 SB
6142 6374 33 (.) 83 SB
6225 6374 33 (.) 83 SB
6308 6374 33 (.) 83 SB
6391 6374 33 (.) 83 SB
6474 6374 33 (.) 83 SB
6557 6374 33 (.) 83 SB
6640 6374 33 (.) 83 SB
6723 6374 33 (.) 83 SB
6806 6374 33 (.) 83 SB
6889 6374 33 (.) 83 SB
6972 6374 33 (.) 83 SB
7055 6374 33 (.) 83 SB
7138 6374 33 (.) 83 SB
7221 6374 33 (.) 83 SB
7304 6374 33 (.) 83 SB
7387 6374 33 (.) 83 SB
7470 6374 33 (.) 83 SB
7553 6374 33 (.) 83 SB
7636 6374 33 (.) 83 SB
7719 6374 33 (.) 83 SB
7802 6374 33 (.) 83 SB
7885 6374 33 (.) 83 SB
7968 6374 33 (.) 83 SB
8051 6374 33 (.) 83 SB
8134 6374 33 (.) 83 SB
8217 6374 33 (.) 83 SB
8300 6374 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6337 264 (375) 264 SB
3352 6570 1737 (58.1.5.1  Service Startup) 1737 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5146 6607 33 (.) 83 SB
5229 6607 33 (.) 83 SB
5312 6607 33 (.) 83 SB
5395 6607 33 (.) 83 SB
5478 6607 33 (.) 83 SB
5561 6607 33 (.) 83 SB
5644 6607 33 (.) 83 SB
5727 6607 33 (.) 83 SB
5810 6607 33 (.) 83 SB
5893 6607 33 (.) 83 SB
5976 6607 33 (.) 83 SB
6059 6607 33 (.) 83 SB
6142 6607 33 (.) 83 SB
6225 6607 33 (.) 83 SB
6308 6607 33 (.) 83 SB
6391 6607 33 (.) 83 SB
6474 6607 33 (.) 83 SB
6557 6607 33 (.) 83 SB
6640 6607 33 (.) 83 SB
6723 6607 33 (.) 83 SB
6806 6607 33 (.) 83 SB
6889 6607 33 (.) 83 SB
6972 6607 33 (.) 83 SB
7055 6607 33 (.) 83 SB
7138 6607 33 (.) 83 SB
7221 6607 33 (.) 83 SB
7304 6607 33 (.) 83 SB
7387 6607 33 (.) 83 SB
7470 6607 33 (.) 83 SB
7553 6607 33 (.) 83 SB
7636 6607 33 (.) 83 SB
7719 6607 33 (.) 83 SB
7802 6607 33 (.) 83 SB
7885 6607 33 (.) 83 SB
7968 6607 33 (.) 83 SB
8051 6607 33 (.) 83 SB
8134 6607 33 (.) 83 SB
8217 6607 33 (.) 83 SB
8300 6607 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6570 264 (375) 264 SB
3352 6803 2445 (58.1.5.2  Service Control Requests) 2445 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5810 6840 33 (.) 83 SB
5893 6840 33 (.) 83 SB
5976 6840 33 (.) 83 SB
6059 6840 33 (.) 83 SB
6142 6840 33 (.) 83 SB
6225 6840 33 (.) 83 SB
6308 6840 33 (.) 83 SB
6391 6840 33 (.) 83 SB
6474 6840 33 (.) 83 SB
6557 6840 33 (.) 83 SB
6640 6840 33 (.) 83 SB
6723 6840 33 (.) 83 SB
6806 6840 33 (.) 83 SB
6889 6840 33 (.) 83 SB
6972 6840 33 (.) 83 SB
7055 6840 33 (.) 83 SB
7138 6840 33 (.) 83 SB
7221 6840 33 (.) 83 SB
7304 6840 33 (.) 83 SB
7387 6840 33 (.) 83 SB
7470 6840 33 (.) 83 SB
7553 6840 33 (.) 83 SB
7636 6840 33 (.) 83 SB
7719 6840 33 (.) 83 SB
7802 6840 33 (.) 83 SB
7885 6840 33 (.) 83 SB
7968 6840 33 (.) 83 SB
8051 6840 33 (.) 83 SB
8134 6840 33 (.) 83 SB
8217 6840 33 (.) 83 SB
8300 6840 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 6803 264 (376) 264 SB
3118 7036 1683 (58.1.6  Service Security) 1683 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
4814 7073 33 (.) 83 SB
4897 7073 33 (.) 83 SB
4980 7073 33 (.) 83 SB
5063 7073 33 (.) 83 SB
5146 7073 33 (.) 83 SB
5229 7073 33 (.) 83 SB
5312 7073 33 (.) 83 SB
5395 7073 33 (.) 83 SB
5478 7073 33 (.) 83 SB
5561 7073 33 (.) 83 SB
5644 7073 33 (.) 83 SB
5727 7073 33 (.) 83 SB
5810 7073 33 (.) 83 SB
5893 7073 33 (.) 83 SB
5976 7073 33 (.) 83 SB
6059 7073 33 (.) 83 SB
6142 7073 33 (.) 83 SB
6225 7073 33 (.) 83 SB
6308 7073 33 (.) 83 SB
6391 7073 33 (.) 83 SB
6474 7073 33 (.) 83 SB
6557 7073 33 (.) 83 SB
6640 7073 33 (.) 83 SB
6723 7073 33 (.) 83 SB
6806 7073 33 (.) 83 SB
6889 7073 33 (.) 83 SB
6972 7073 33 (.) 83 SB
7055 7073 33 (.) 83 SB
7138 7073 33 (.) 83 SB
7221 7073 33 (.) 83 SB
7304 7073 33 (.) 83 SB
7387 7073 33 (.) 83 SB
7470 7073 33 (.) 83 SB
7553 7073 33 (.) 83 SB
7636 7073 33 (.) 83 SB
7719 7073 33 (.) 83 SB
7802 7073 33 (.) 83 SB
7885 7073 33 (.) 83 SB
7968 7073 33 (.) 83 SB
8051 7073 33 (.) 83 SB
8134 7073 33 (.) 83 SB
8217 7073 33 (.) 83 SB
8300 7073 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 7036 264 (376) 264 SB
3352 7269 2788 (58.1.6.1  Win32 Service User Accounts) 2788 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
6142 7306 33 (.) 83 SB
6225 7306 33 (.) 83 SB
6308 7306 33 (.) 83 SB
6391 7306 33 (.) 83 SB
6474 7306 33 (.) 83 SB
6557 7306 33 (.) 83 SB
6640 7306 33 (.) 83 SB
6723 7306 33 (.) 83 SB
6806 7306 33 (.) 83 SB
6889 7306 33 (.) 83 SB
6972 7306 33 (.) 83 SB
7055 7306 33 (.) 83 SB
7138 7306 33 (.) 83 SB
7221 7306 33 (.) 83 SB
7304 7306 33 (.) 83 SB
7387 7306 33 (.) 83 SB
7470 7306 33 (.) 83 SB
7553 7306 33 (.) 83 SB
7636 7306 33 (.) 83 SB
7719 7306 33 (.) 83 SB
7802 7306 33 (.) 83 SB
7885 7306 33 (.) 83 SB
7968 7306 33 (.) 83 SB
8051 7306 33 (.) 83 SB
8134 7306 33 (.) 83 SB
8217 7306 33 (.) 83 SB
8300 7306 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 7269 264 (377) 264 SB
2885 7502 1453 (58.2  Using Services) 1453 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
4399 7539 33 (.) 83 SB
4482 7539 33 (.) 83 SB
4565 7539 33 (.) 83 SB
4648 7539 33 (.) 83 SB
4731 7539 33 (.) 83 SB
4814 7539 33 (.) 83 SB
4897 7539 33 (.) 83 SB
4980 7539 33 (.) 83 SB
5063 7539 33 (.) 83 SB
5146 7539 33 (.) 83 SB
5229 7539 33 (.) 83 SB
5312 7539 33 (.) 83 SB
5395 7539 33 (.) 83 SB
5478 7539 33 (.) 83 SB
5561 7539 33 (.) 83 SB
5644 7539 33 (.) 83 SB
5727 7539 33 (.) 83 SB
5810 7539 33 (.) 83 SB
5893 7539 33 (.) 83 SB
5976 7539 33 (.) 83 SB
6059 7539 33 (.) 83 SB
6142 7539 33 (.) 83 SB
6225 7539 33 (.) 83 SB
6308 7539 33 (.) 83 SB
6391 7539 33 (.) 83 SB
6474 7539 33 (.) 83 SB
6557 7539 33 (.) 83 SB
6640 7539 33 (.) 83 SB
6723 7539 33 (.) 83 SB
6806 7539 33 (.) 83 SB
6889 7539 33 (.) 83 SB
6972 7539 33 (.) 83 SB
7055 7539 33 (.) 83 SB
7138 7539 33 (.) 83 SB
7221 7539 33 (.) 83 SB
7304 7539 33 (.) 83 SB
7387 7539 33 (.) 83 SB
7470 7539 33 (.) 83 SB
7553 7539 33 (.) 83 SB
7636 7539 33 (.) 83 SB
7719 7539 33 (.) 83 SB
7802 7539 33 (.) 83 SB
7885 7539 33 (.) 83 SB
7968 7539 33 (.) 83 SB
8051 7539 33 (.) 83 SB
8134 7539 33 (.) 83 SB
8217 7539 33 (.) 83 SB
8300 7539 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 7502 264 (378) 264 SB
3118 7735 4056 (58.2.1  Writing a Win32 Service Process\222s main Function) 4056 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
7221 7772 33 (.) 83 SB
7304 7772 33 (.) 83 SB
7387 7772 33 (.) 83 SB
7470 7772 33 (.) 83 SB
7553 7772 33 (.) 83 SB
7636 7772 33 (.) 83 SB
7719 7772 33 (.) 83 SB
7802 7772 33 (.) 83 SB
7885 7772 33 (.) 83 SB
7968 7772 33 (.) 83 SB
8051 7772 33 (.) 83 SB
8134 7772 33 (.) 83 SB
8217 7772 33 (.) 83 SB
8300 7772 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 7735 264 (378) 264 SB
3118 7968 2805 (58.2.2  Writing a ServiceMain Function) 2805 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5976 8005 33 (.) 83 SB
6059 8005 33 (.) 83 SB
6142 8005 33 (.) 83 SB
6225 8005 33 (.) 83 SB
6308 8005 33 (.) 83 SB
6391 8005 33 (.) 83 SB
6474 8005 33 (.) 83 SB
6557 8005 33 (.) 83 SB
6640 8005 33 (.) 83 SB
6723 8005 33 (.) 83 SB
6806 8005 33 (.) 83 SB
6889 8005 33 (.) 83 SB
6972 8005 33 (.) 83 SB
7055 8005 33 (.) 83 SB
7138 8005 33 (.) 83 SB
7221 8005 33 (.) 83 SB
7304 8005 33 (.) 83 SB
7387 8005 33 (.) 83 SB
7470 8005 33 (.) 83 SB
7553 8005 33 (.) 83 SB
7636 8005 33 (.) 83 SB
7719 8005 33 (.) 83 SB
7802 8005 33 (.) 83 SB
7885 8005 33 (.) 83 SB
7968 8005 33 (.) 83 SB
8051 8005 33 (.) 83 SB
8134 8005 33 (.) 83 SB
8217 8005 33 (.) 83 SB
8300 8005 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 7968 264 (379) 264 SB
3118 8201 3054 (58.2.3  Writing a Control Handler Function) 3054 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
6225 8238 33 (.) 83 SB
6308 8238 33 (.) 83 SB
6391 8238 33 (.) 83 SB
6474 8238 33 (.) 83 SB
6557 8238 33 (.) 83 SB
6640 8238 33 (.) 83 SB
6723 8238 33 (.) 83 SB
6806 8238 33 (.) 83 SB
6889 8238 33 (.) 83 SB
6972 8238 33 (.) 83 SB
7055 8238 33 (.) 83 SB
7138 8238 33 (.) 83 SB
7221 8238 33 (.) 83 SB
7304 8238 33 (.) 83 SB
7387 8238 33 (.) 83 SB
7470 8238 33 (.) 83 SB
7553 8238 33 (.) 83 SB
7636 8238 33 (.) 83 SB
7719 8238 33 (.) 83 SB
7802 8238 33 (.) 83 SB
7885 8238 33 (.) 83 SB
7968 8238 33 (.) 83 SB
8051 8238 33 (.) 83 SB
8134 8238 33 (.) 83 SB
8217 8238 33 (.) 83 SB
8300 8238 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 8201 264 (384) 264 SB
3118 8434 2912 (58.2.4  Opening an SCManager Database) 2912 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
6059 8471 33 (.) 83 SB
6142 8471 33 (.) 83 SB
6225 8471 33 (.) 83 SB
6308 8471 33 (.) 83 SB
6391 8471 33 (.) 83 SB
6474 8471 33 (.) 83 SB
6557 8471 33 (.) 83 SB
6640 8471 33 (.) 83 SB
6723 8471 33 (.) 83 SB
6806 8471 33 (.) 83 SB
6889 8471 33 (.) 83 SB
6972 8471 33 (.) 83 SB
7055 8471 33 (.) 83 SB
7138 8471 33 (.) 83 SB
7221 8471 33 (.) 83 SB
7304 8471 33 (.) 83 SB
7387 8471 33 (.) 83 SB
7470 8471 33 (.) 83 SB
7553 8471 33 (.) 83 SB
7636 8471 33 (.) 83 SB
7719 8471 33 (.) 83 SB
7802 8471 33 (.) 83 SB
7885 8471 33 (.) 83 SB
7968 8471 33 (.) 83 SB
8051 8471 33 (.) 83 SB
8134 8471 33 (.) 83 SB
8217 8471 33 (.) 83 SB
8300 8471 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 8434 264 (385) 264 SB
3118 8667 1884 (58.2.5  Installing a Service) 1884 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
5063 8704 33 (.) 83 SB
5146 8704 33 (.) 83 SB
5229 8704 33 (.) 83 SB
5312 8704 33 (.) 83 SB
5395 8704 33 (.) 83 SB
5478 8704 33 (.) 83 SB
5561 8704 33 (.) 83 SB
5644 8704 33 (.) 83 SB
5727 8704 33 (.) 83 SB
5810 8704 33 (.) 83 SB
5893 8704 33 (.) 83 SB
5976 8704 33 (.) 83 SB
6059 8704 33 (.) 83 SB
6142 8704 33 (.) 83 SB
6225 8704 33 (.) 83 SB
6308 8704 33 (.) 83 SB
6391 8704 33 (.) 83 SB
6474 8704 33 (.) 83 SB
6557 8704 33 (.) 83 SB
6640 8704 33 (.) 83 SB
6723 8704 33 (.) 83 SB
6806 8704 33 (.) 83 SB
6889 8704 33 (.) 83 SB
6972 8704 33 (.) 83 SB
7055 8704 33 (.) 83 SB
7138 8704 33 (.) 83 SB
7221 8704 33 (.) 83 SB
7304 8704 33 (.) 83 SB
7387 8704 33 (.) 83 SB
7470 8704 33 (.) 83 SB
7553 8704 33 (.) 83 SB
7636 8704 33 (.) 83 SB
7719 8704 33 (.) 83 SB
7802 8704 33 (.) 83 SB
7885 8704 33 (.) 83 SB
7968 8704 33 (.) 83 SB
8051 8704 33 (.) 83 SB
8134 8704 33 (.) 83 SB
8217 8704 33 (.) 83 SB
8300 8704 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 8667 264 (386) 264 SB
3118 8900 1825 (58.2.6  Deleting a Service) 1825 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
4980 8937 33 (.) 83 SB
5063 8937 33 (.) 83 SB
5146 8937 33 (.) 83 SB
5229 8937 33 (.) 83 SB
5312 8937 33 (.) 83 SB
5395 8937 33 (.) 83 SB
5478 8937 33 (.) 83 SB
5561 8937 33 (.) 83 SB
5644 8937 33 (.) 83 SB
5727 8937 33 (.) 83 SB
5810 8937 33 (.) 83 SB
5893 8937 33 (.) 83 SB
5976 8937 33 (.) 83 SB
6059 8937 33 (.) 83 SB
6142 8937 33 (.) 83 SB
6225 8937 33 (.) 83 SB
6308 8937 33 (.) 83 SB
6391 8937 33 (.) 83 SB
6474 8937 33 (.) 83 SB
6557 8937 33 (.) 83 SB
6640 8937 33 (.) 83 SB
6723 8937 33 (.) 83 SB
6806 8937 33 (.) 83 SB
6889 8937 33 (.) 83 SB
6972 8937 33 (.) 83 SB
7055 8937 33 (.) 83 SB
7138 8937 33 (.) 83 SB
7221 8937 33 (.) 83 SB
7304 8937 33 (.) 83 SB
7387 8937 33 (.) 83 SB
7470 8937 33 (.) 83 SB
7553 8937 33 (.) 83 SB
7636 8937 33 (.) 83 SB
7719 8937 33 (.) 83 SB
7802 8937 33 (.) 83 SB
7885 8937 33 (.) 83 SB
7968 8937 33 (.) 83 SB
8051 8937 33 (.) 83 SB
8134 8937 33 (.) 83 SB
8217 8937 33 (.) 83 SB
8300 8937 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 8900 264 (386) 264 SB
3118 9133 2934 (58.2.7  Changing a Service Configuration) 2934 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
6059 9170 33 (.) 83 SB
6142 9170 33 (.) 83 SB
6225 9170 33 (.) 83 SB
6308 9170 33 (.) 83 SB
6391 9170 33 (.) 83 SB
6474 9170 33 (.) 83 SB
6557 9170 33 (.) 83 SB
6640 9170 33 (.) 83 SB
6723 9170 33 (.) 83 SB
6806 9170 33 (.) 83 SB
6889 9170 33 (.) 83 SB
6972 9170 33 (.) 83 SB
7055 9170 33 (.) 83 SB
7138 9170 33 (.) 83 SB
7221 9170 33 (.) 83 SB
7304 9170 33 (.) 83 SB
7387 9170 33 (.) 83 SB
7470 9170 33 (.) 83 SB
7553 9170 33 (.) 83 SB
7636 9170 33 (.) 83 SB
7719 9170 33 (.) 83 SB
7802 9170 33 (.) 83 SB
7885 9170 33 (.) 83 SB
7968 9170 33 (.) 83 SB
8051 9170 33 (.) 83 SB
8134 9170 33 (.) 83 SB
8217 9170 33 (.) 83 SB
8300 9170 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 9133 264 (387) 264 SB
3118 9366 3040 (58.2.8  Querying a Service\222s Configuration) 3040 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
6225 9403 33 (.) 83 SB
6308 9403 33 (.) 83 SB
6391 9403 33 (.) 83 SB
6474 9403 33 (.) 83 SB
6557 9403 33 (.) 83 SB
6640 9403 33 (.) 83 SB
6723 9403 33 (.) 83 SB
6806 9403 33 (.) 83 SB
6889 9403 33 (.) 83 SB
6972 9403 33 (.) 83 SB
7055 9403 33 (.) 83 SB
7138 9403 33 (.) 83 SB
7221 9403 33 (.) 83 SB
7304 9403 33 (.) 83 SB
7387 9403 33 (.) 83 SB
7470 9403 33 (.) 83 SB
7553 9403 33 (.) 83 SB
7636 9403 33 (.) 83 SB
7719 9403 33 (.) 83 SB
7802 9403 33 (.) 83 SB
7885 9403 33 (.) 83 SB
7968 9403 33 (.) 83 SB
8051 9403 33 (.) 83 SB
8134 9403 33 (.) 83 SB
8217 9403 33 (.) 83 SB
8300 9403 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 9366 264 (389) 264 SB
3118 9599 1776 (58.2.9  Starting a Service) 1776 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
4897 9636 33 (.) 83 SB
4980 9636 33 (.) 83 SB
5063 9636 33 (.) 83 SB
5146 9636 33 (.) 83 SB
5229 9636 33 (.) 83 SB
5312 9636 33 (.) 83 SB
5395 9636 33 (.) 83 SB
5478 9636 33 (.) 83 SB
5561 9636 33 (.) 83 SB
5644 9636 33 (.) 83 SB
5727 9636 33 (.) 83 SB
5810 9636 33 (.) 83 SB
5893 9636 33 (.) 83 SB
5976 9636 33 (.) 83 SB
6059 9636 33 (.) 83 SB
6142 9636 33 (.) 83 SB
6225 9636 33 (.) 83 SB
6308 9636 33 (.) 83 SB
6391 9636 33 (.) 83 SB
6474 9636 33 (.) 83 SB
6557 9636 33 (.) 83 SB
6640 9636 33 (.) 83 SB
6723 9636 33 (.) 83 SB
6806 9636 33 (.) 83 SB
6889 9636 33 (.) 83 SB
6972 9636 33 (.) 83 SB
7055 9636 33 (.) 83 SB
7138 9636 33 (.) 83 SB
7221 9636 33 (.) 83 SB
7304 9636 33 (.) 83 SB
7387 9636 33 (.) 83 SB
7470 9636 33 (.) 83 SB
7553 9636 33 (.) 83 SB
7636 9636 33 (.) 83 SB
7719 9636 33 (.) 83 SB
7802 9636 33 (.) 83 SB
7885 9636 33 (.) 83 SB
7968 9636 33 (.) 83 SB
8051 9636 33 (.) 83 SB
8134 9636 33 (.) 83 SB
8217 9636 33 (.) 83 SB
8300 9636 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 9599 264 (390) 264 SB
3118 9832 3324 (58.2.10  Sending Control Requests to a Service) 3324 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
6474 9869 33 (.) 83 SB
6557 9869 33 (.) 83 SB
6640 9869 33 (.) 83 SB
6723 9869 33 (.) 83 SB
6806 9869 33 (.) 83 SB
6889 9869 33 (.) 83 SB
6972 9869 33 (.) 83 SB
7055 9869 33 (.) 83 SB
7138 9869 33 (.) 83 SB
7221 9869 33 (.) 83 SB
7304 9869 33 (.) 83 SB
7387 9869 33 (.) 83 SB
7470 9869 33 (.) 83 SB
7553 9869 33 (.) 83 SB
7636 9869 33 (.) 83 SB
7719 9869 33 (.) 83 SB
7802 9869 33 (.) 83 SB
7885 9869 33 (.) 83 SB
7968 9869 33 (.) 83 SB
8051 9869 33 (.) 83 SB
8134 9869 33 (.) 83 SB
8217 9869 33 (.) 83 SB
8300 9869 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 9832 264 (392) 264 SB
2885 10065 1089 (58.3  Functions) 1089 SB
32 0 0 133 133 0 0 0 119 /Times-Roman /font32 ANSIFont font
3984 10102 33 (.) 83 SB
4067 10102 33 (.) 83 SB
4150 10102 33 (.) 83 SB
4233 10102 33 (.) 83 SB
4316 10102 33 (.) 83 SB
4399 10102 33 (.) 83 SB
4482 10102 33 (.) 83 SB
4565 10102 33 (.) 83 SB
4648 10102 33 (.) 83 SB
4731 10102 33 (.) 83 SB
4814 10102 33 (.) 83 SB
4897 10102 33 (.) 83 SB
4980 10102 33 (.) 83 SB
5063 10102 33 (.) 83 SB
5146 10102 33 (.) 83 SB
5229 10102 33 (.) 83 SB
5312 10102 33 (.) 83 SB
5395 10102 33 (.) 83 SB
5478 10102 33 (.) 83 SB
5561 10102 33 (.) 83 SB
5644 10102 33 (.) 83 SB
5727 10102 33 (.) 83 SB
5810 10102 33 (.) 83 SB
5893 10102 33 (.) 83 SB
5976 10102 33 (.) 83 SB
6059 10102 33 (.) 83 SB
6142 10102 33 (.) 83 SB
6225 10102 33 (.) 83 SB
6308 10102 33 (.) 83 SB
6391 10102 33 (.) 83 SB
6474 10102 33 (.) 83 SB
6557 10102 33 (.) 83 SB
6640 10102 33 (.) 83 SB
6723 10102 33 (.) 83 SB
6806 10102 33 (.) 83 SB
6889 10102 33 (.) 83 SB
6972 10102 33 (.) 83 SB
7055 10102 33 (.) 83 SB
7138 10102 33 (.) 83 SB
7221 10102 33 (.) 83 SB
7304 10102 33 (.) 83 SB
7387 10102 33 (.) 83 SB
7470 10102 33 (.) 83 SB
7553 10102 33 (.) 83 SB
7636 10102 33 (.) 83 SB
7719 10102 33 (.) 83 SB
7802 10102 33 (.) 83 SB
7885 10102 33 (.) 83 SB
7968 10102 33 (.) 83 SB
8051 10102 33 (.) 83 SB
8134 10102 33 (.) 83 SB
8217 10102 33 (.) 83 SB
8300 10102 33 (.) 83 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8421 10065 264 (393) 264 SB
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 21 ( ) 21 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 367 def
/wp$fpage (367) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1447 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1822 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2364 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 367 def
/wp$fpage (367) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%Page: 2 2
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (368) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 333 333 0 0 0 311 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1968 2673 (58.1  About Services) 2673 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 2423 1092 (In the Microsof) 1092 SB
3627 2423 49 (t) 78 SB
3705 2423 433 ( Win3) 433 SB
4138 2423 88 (2) 117 SB
4255 2423 3134 ( application programming interface \(API\), a ) 3134 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
7389 2423 497 (service) 497 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7886 2423 371 ( is an) 371 SB
2535 2623 5712 (executable object that is installed in a registry database maintained by the service) 5712 SB
2535 2823 5390 (control manager. The services database includes information that determines) 5390 SB
2535 3023 5469 (whether each installed service is started on demand or is started automatically) 5469 SB
2535 3223 5334 (when the system starts up. The database can also contain logon and security) 5334 SB
2535 3423 5626 (information for a service so that a service can run even though no user is logged) 5626 SB
2535 3623 5593 (on. It also enables system administrators to customize security requirements for) 5593 SB
2535 3823 5718 (each service and thereby control access to the service. No more than one instance) 5718 SB
2535 4023 2591 (of a service can be running at a time.) 2591 SB
2535 4356 5781 (Services can be divided into these two groups: Win32 services that conform to the) 5781 SB
2535 4556 5676 (interface rules of the service control manager and driver services that conform to) 5676 SB
2535 4756 3012 (the device driver protocols for Windows N) 3012 SB
5547 4756 107 (T) 136 SB
5683 4756 44 (.) 44 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 5192 3989 (58.1.1  The Service Control Manager) 3989 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 5573 170 (A ) 170 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2705 5573 1717 (service control manager) 1717 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4422 5573 3601 ( provides a unified and secure means of controlling) 3601 SB
2535 5773 5178 (services. Each machine that is running Windows NT has a service control) 5178 SB
2535 5973 5364 (manager process started by the system at system startup. The service control) 5364 SB
2535 6173 5552 (manager is a Remote Procedure Call \(RPC\) server. The functions in the Win32) 5552 SB
2535 6373 5335 (API that access a service control manager are provided through RPC so that) 5335 SB
2535 6573 5527 (service configuration and service control processes can manipulate services on) 5527 SB
2535 6773 1238 (remote machines.) 1238 SB
2535 7106 5704 (The Win32 API includes a set of functions that provide a programmer\222s interface) 5704 SB
2535 7306 4618 (for the following tasks performed by the service control manager:) 4618 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 7573 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 7639 4826 (Using the registry to maintain a database of installed service objects.) 4826 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 7840 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 7906 4829 (Starting services either when the system is starting up or on demand.) 4829 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 8107 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 8173 3641 (Maintaining status information on running services.) 3641 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 8374 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 8440 3493 (Transmitting control requests to running services.) 3493 SB
2535 8840 3150 (Three types of programs use these functions:) 3150 SB
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 674 250 2535 9169 CB
2535 9189 342 (Type) 342 SB
gr
gs 5124 250 3210 9169 CB
3410 9189 781 (Description) 781 SB
gr
5798 11 2535 9419 B
1 F
n
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 5799 250 2535 9448 CB
2535 9471 1431 (Win32 service process) 1431 SB
gr
gs 5124 200 3210 9698 CB
3410 9721 4629 (A process that provides executable code for one or more services. Win32) 4629 SB
gr
gs 5124 183 3210 9898 CB
3410 9904 4745 (services use functions that connect to the service control manager and send) 4745 SB
gr
gs 5124 233 3210 10081 CB
3410 10087 4199 (status information to it. Driver services do not use these functions.) 4199 SB
gr
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 368 def
/wp$fpage (368) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 368 def
/wp$fpage (368) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 3 3
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (369) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
0 0 0 fC
gs 5799 250 2885 1985 CB
2885 2008 1941 (Service configuration program) 1941 SB
gr
gs 5124 200 3560 2235 CB
3760 2258 4517 (A program that queries or modifies a service control manager database.) 4517 SB
gr
gs 5124 183 3560 2435 CB
3760 2441 4835 (Service configuration programs use functions that open a database, install or) 4835 SB
gr
gs 5124 183 3560 2618 CB
3760 2624 4550 (delete services in a database, and query or modify the configuration and) 4550 SB
gr
gs 5124 183 3560 2801 CB
3760 2807 4206 (security parameters of installed services. The functions are used to) 4206 SB
gr
gs 5124 233 3560 2984 CB
3760 2990 2994 (manipulate Win32 services and driver services.) 2994 SB
gr
gs 5799 250 2885 3217 CB
2885 3240 1537 (Service control program) 1537 SB
gr
gs 5124 200 3560 3467 CB
3760 3490 4924 (A program that starts a service and controls a running service. Service control) 4924 SB
gr
gs 5124 183 3560 3667 CB
3760 3673 4631 (programs use functions that send requests to the service control manager,) 4631 SB
gr
gs 5124 183 3560 3850 CB
3760 3856 4909 (which starts the requested service or sends the control request to the specified) 4909 SB
gr
gs 5124 233 3560 4033 CB
3760 4039 487 (service.) 487 SB
gr
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 4506 4119 (58.1.2  Database of Installed Services) 4119 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4887 5048 (The service control manager maintains a ServicesActive database in the) 5048 SB
2885 5087 5655 (configuration registry. This is the currently active database that was used to start) 5655 SB
2885 5287 3323 (the system. The registry path to this database is) 3323 SB
2885 5487 5320 (HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services. In this) 5320 SB
2885 5687 5346 (directory, there is a <ServiceName> key for each installed Win32 service or) 5346 SB
2885 5887 5796 (driver service. The <ServiceName> key is the name of the service specified by the) 5796 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 6084 1052 (CreateService) 1052 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3937 6087 2854 ( function when the service was installed.) 2854 SB
2885 6420 5442 (The database includes the following information about each installed service:) 5442 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 6687 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 6753 5540 (The type of service. For Win32 services, the service type indicates whether the) 5540 SB
3118 6953 5099 (service executes in its own process or shares a process with other Win32) 5099 SB
3118 7153 5461 (services. For driver services, it indicates whether the service is a kernel driver) 5461 SB
3118 7353 1584 (or a file system driver.) 1584 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 7554 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 7620 5249 (The start type of the service. The start type indicates whether the service is) 5249 SB
3118 7820 5482 (started automatically at system startup or whether the service control manager) 5482 SB
3118 8020 5498 (starts it when requested to by a service control process. The start type can also) 5498 SB
3118 8220 5222 (indicate whether the service is disabled, in which case it cannot be started.) 5222 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 8421 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 8487 5460 (A fully-qualified path of the service\222s executable file. The filename extension) 5460 SB
3118 8687 3993 (is .EXE for Win32 services and .SYS for driver services.) 3993 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 8888 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 8954 5250 (Optional information used by the service control manager to determine the) 5250 SB
3118 9154 4994 (proper order for starting services. This information can include a list of) 4994 SB
3118 9354 5371 (services that must be running before the service can start, the name of a load) 5371 SB
3118 9554 5472 (ordering group that the service is part of, and a tag identifier that indicates the) 5472 SB
3118 9754 3581 (start order of the service in its load ordering group.) 3581 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 9955 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 10021 5162 (For Win32 services, an optional logon account name in which the service) 5162 SB
3118 10221 5020 (process runs and an optional password for this account. If no account is) 5020 SB
3118 10421 3859 (specified, the service runs in the LocalSystem account.) 3859 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 10622 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 10688 5532 (For driver services, an optional Windows NT driver object name \(for example,) 5532 SB
3118 10888 5266 (\\FileSystem\\Rdr or \\Driver\\Xns\), used by the I/O system to load the device) 5266 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 369 def
/wp$fpage (369) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 369 def
/wp$fpage (369) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 4 4
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (370) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2768 1989 5490 (driver. If no name is specified, the I/O system creates a default name based on) 5490 SB
2768 2189 1224 (the service name.) 1224 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 2692 3577 (58.1.3  Win32 Service Processes) 3577 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 3073 5592 (A Win32 service process contains executable code for one or more services. To) 5592 SB
2535 3273 5403 (conform to the interface requirements of the service control manager, it must) 5403 SB
2535 3473 567 (include:) 567 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 3740 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 3806 170 (A ) 170 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2938 3803 380 (main) 380 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3318 3806 2529 ( function that immediately calls the ) 2529 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5847 3803 2053 (StartServiceCtrlDispatcher) 2053 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 4006 5105 (function to connect the main thread of the process to the Service Control) 5105 SB
2768 4206 668 (Manager.) 668 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 4407 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 4473 1743 (An entry point function, ) 1743 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4511 4470 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5456 4473 2513 (, for each service that can run in the) 2513 SB
2768 4673 570 (process.) 570 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 4874 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 4940 1957 (A control handler function, ) 1957 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4725 4937 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5348 4940 2513 (, for each service that can run in the) 2513 SB
2768 5140 570 (process.) 570 SB
2535 5540 4104 (For simplicity, the discussions in this section use the term ) 4104 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
6639 5540 497 (service) 497 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7136 5540 649 ( to mean ) 649 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
7785 5540 459 (Win32) 459 SB
2535 5740 497 (service) 497 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3032 5740 4622 (. The information in this section does not apply to driver services.) 4622 SB
32 0 0 250 250 0 0 0 233 /Helvetica-Narrow-Bold /font16 ANSIFont font
2535 6130 2243 (58.1.3.1  Main Function) 2243 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 6456 5732 (When the service control manager starts a service process, it waits for the process) 5732 SB
2535 6656 738 (to call the ) 738 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3273 6653 2053 (StartServiceCtrlDispatcher) 2053 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5326 6656 2668 ( function. If a service does not share a) 2668 SB
2535 6856 5659 (process with other services \(SERVICE_WIN32_OWN_PROCESS services\), the) 5659 SB
2535 7056 5538 (main thread of a service process should make this call immediately, leaving all) 5538 SB
2535 7256 2973 (initialization tasks to be performed by the ) 2973 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5508 7253 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6453 7256 1795 ( function after the service) 1795 SB
2535 7456 4386 (is started. For services where multiple services share a process) 4386 SB
2535 7656 5415 (\(SERVICE_WIN32_SHARE_PROCESS services\) and where some common) 5415 SB
2535 7856 3914 (process-wide initialization needs to be done before any ) 3914 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6449 7853 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7394 7856 791 ( function is) 791 SB
2535 8056 3787 (called, the main thread can do the work before calling) 3787 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 8253 2053 (StartServiceCtrlDispatcher) 2053 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4588 8256 3654 (, as long as it takes less than 30 seconds. Otherwise,) 3654 SB
2535 8456 5456 (another thread must be created to do the process-wide initialization, while the) 5456 SB
2535 8656 1244 (main thread calls ) 1244 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3779 8653 2053 (StartServiceCtrlDispatcher) 2053 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5832 8656 2455 (. Any service specific initialization) 2455 SB
2535 8856 2654 (should still be done by the individual ) 2654 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5189 8853 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6134 8856 742 ( functions.) 742 SB
2535 9189 160 (If ) 160 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2695 9186 2053 (StartServiceCtrlDispatcher) 2053 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4748 9189 3218 ( succeeds, it connects the calling thread to the) 3218 SB
2535 9389 5310 (service control manager and does not return until all running services in the) 5310 SB
2535 9589 5796 (process have terminated. The service control manager uses this connection to send) 5796 SB
2535 9789 5541 (control and service start requests to the main thread of the service process. The) 5541 SB
2535 9989 4119 (main thread acts as a dispatcher by calling the appropriate ) 4119 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6654 9986 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7277 9989 811 ( function to) 811 SB
2535 10189 5456 (handle control requests or by creating a new thread to execute the appropriate) 5456 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 10386 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3480 10389 2770 ( function when a new service is started.) 2770 SB
2535 10722 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2852 10719 2053 (StartServiceCtrlDispatcher) 2053 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4905 10722 3423 ( function specifies a dispatch table containing an) 3423 SB
2535 10922 5684 (entry for each service that can run in the calling process. Each entry specifies the) 5684 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 370 def
/wp$fpage (370) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 370 def
/wp$fpage (370) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 5 5
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (371) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
0 0 0 fC
2885 1986 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3830 1989 2058 ( function for that service. For) 2058 SB
2885 2189 5478 (SERVICE_WIN32_SHARE_PROCESS services, each entry must contain the) 5478 SB
2885 2389 5223 (name of a service. This name is the service name that was specified by the) 5223 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 2586 1052 (CreateService) 1052 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3937 2589 3141 ( function when the service was installed. For) 3141 SB
2885 2789 5799 (SERVICE_WIN32_OWN_PROCESS services, the service name in the table entry) 5799 SB
2885 2989 742 (is ignored.) 742 SB
32 0 0 250 250 0 0 0 233 /Helvetica-Narrow-Bold /font16 ANSIFont font
2885 3379 3030 (58.1.3.2  Service Main Function) 3030 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 3705 1336 (Each service has a ) 1336 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4221 3702 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5166 3705 3450 ( function that performs the initialization tasks for) 3450 SB
2885 3905 5791 (the service. A service process that can execute multiple services can have multiple) 5791 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 4102 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3830 4105 742 ( functions.) 742 SB
2885 4438 2930 (When a service control program calls the ) 2930 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5815 4435 925 (StartService) 925 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6740 4438 1864 ( function to start a service,) 1864 SB
2885 4638 5765 (the service control manager starts the service process \(if it is not already running\).) 5765 SB
2885 4838 5689 (Then the service control manager sends the start request to the control dispatcher) 5689 SB
2885 5038 5614 (in the main thread of the service process. The dispatcher creates a new thread to) 5614 SB
2885 5238 840 (execute the ) 840 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3725 5235 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4670 5238 2400 ( function for the specified service.) 2400 SB
2885 5571 170 (A ) 170 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3055 5568 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4000 5571 3761 ( function should perform the following ordered steps:) 3761 SB
2886 5904 132 (1.) 132 SB
3118 5904 596 (Call the ) 596 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3714 5901 2103 (RegisterServiceCtrlHandler) 2103 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5817 5904 2425 ( function immediately to register a) 2425 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3118 6101 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3741 6104 4782 ( function to handle control requests for the service. The return value) 4782 SB
3118 6304 190 (of ) 190 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3308 6301 2103 (RegisterServiceCtrlHandler) 2103 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5411 6304 3265 ( is a SERVICE_STATUS_HANDLE type that) 3265 SB
3118 6504 2485 (identifies the service in calls to the ) 2485 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5603 6501 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6848 6504 674 ( function.) 674 SB
2886 6771 132 (2.) 132 SB
3118 6771 337 (Call ) 337 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3455 6768 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4700 6771 3577 ( to update the status of the service control manager) 3577 SB
3118 6971 5312 (information for the service. This function should specify the current service) 5312 SB
3118 7171 2825 (state as SERVICE_START_PENDING.) 2825 SB
2886 7438 132 (3.) 132 SB
3118 7438 5238 (Complete the initialization tasks for the service, such as starting additional) 5238 SB
3118 7638 4960 (threads to perform the work of the service. If this initialization is time-) 4960 SB
3118 7838 4176 (consuming, the application should make additional calls to ) 4176 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7294 7835 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 8038 5095 (to report the progress of the initialization to the service control manager.) 5095 SB
2886 8305 132 (4.) 132 SB
3118 8305 2915 (As one of the initialization tasks, call the ) 2915 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6033 8302 944 (CreateEvent) 944 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6977 8305 1484 ( function to create an) 1484 SB
3118 8505 5252 (event object. The other threads of the process, such as the control handling) 5252 SB
3118 8705 2906 (thread, use this event object to signal the ) 2906 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6024 8702 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6969 8705 1563 ( function thread that it) 1563 SB
3118 8905 1405 (is time to terminate.) 1405 SB
2886 9172 132 (5.) 132 SB
3118 9172 2587 (When initialization is complete, call ) 2587 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5705 9169 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6950 9172 732 ( to specify) 732 SB
3118 9372 3563 (SERVICE_RUNNING as the current service state.) 3563 SB
2886 9639 132 (6.) 132 SB
3118 9639 596 (Call the ) 596 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3714 9636 1606 (WaitForSingleObject) 1606 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5320 9639 2943 ( function to wait for the termination event) 2943 SB
3118 9839 3834 (object to be signaled. This blocks the execution of the ) 3834 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6952 9836 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7897 9839 630 ( function) 630 SB
3118 10039 4162 (thread until the service is ready to terminate. The service\222s ) 4162 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7280 10036 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7903 10039 630 ( function) 630 SB
3118 10239 4028 (sets the event object to the signaled state if it receives the) 4028 SB
3118 10439 5293 (SERVICE_CONTROL_STOP control code. If an error occurs that requires) 5293 SB
3118 10639 5104 (service termination, other threads of the service can also signal the event) 5104 SB
3118 10839 474 (object.) 474 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 371 def
/wp$fpage (371) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 371 def
/wp$fpage (371) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 6 6
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (372) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2536 1989 132 (7.) 132 SB
2768 1989 5316 (When the wait function returns, perform any cleanup tasks, and then return.) 5316 SB
2535 2389 2258 (For more information about the ) 2258 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4793 2386 944 (CreateEvent) 944 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5737 2389 342 ( and ) 342 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6079 2386 1606 (WaitForSingleObject) 1606 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 2589 3225 (functions, see Chapter 44, \223Synchronization.\224) 3225 SB
2535 2922 2418 (During lengthy initializations, the ) 2418 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4953 2919 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5898 2922 2196 ( function should make frequent) 2196 SB
2535 3122 547 (calls to ) 547 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3082 3119 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4327 3122 3932 ( to let the service control manager know that progress is) 3932 SB
2535 3322 3082 (being made. The following members of the ) 3082 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5617 3319 1545 (SERVICE_STATUS) 1545 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7162 3322 658 ( structure) 658 SB
2535 3522 898 (specified by ) 898 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3433 3519 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4678 3522 3271 ( should change as the initialization progresses:) 3271 SB
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 1736 250 2535 3851 CB
2535 3871 579 (Member) 579 SB
gr
gs 4062 250 4272 3851 CB
4472 3871 395 (Value) 395 SB
gr
5798 11 2535 4101 B
1 F
n
gs 1736 250 2535 4130 CB
2535 4150 1099 (dwCurrentState) 1099 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4062 200 4272 4130 CB
4472 4153 3852 (This value should be SERVICE_START_PENDING service) 3852 SB
gr
gs 4062 183 4272 4330 CB
4472 4336 2403 (state during initialization, changing to) 2403 SB
gr
gs 4062 233 4272 4513 CB
4472 4519 3490 (SERVICE_RUNNING when initialization is complete.) 3490 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 1736 250 2535 4746 CB
2535 4766 1414 (dwControlsAccepted) 1414 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4062 200 4272 4746 CB
4472 4769 3654 (Control codes may be disabled during initialization. After) 3654 SB
gr
gs 4062 233 4272 4946 CB
4472 4952 3710 (initialization is complete, enable the desired control codes.) 3710 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 1736 250 2535 5179 CB
2535 5199 995 (dwCheckPoint) 995 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4062 200 4272 5179 CB
4472 5202 3632 (This value lets the service control manager know how far) 3632 SB
gr
gs 4062 183 4272 5379 CB
4472 5385 3792 (initialization has progressed. Increment this value each time) 3792 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 4062 233 4272 5562 CB
4472 5565 1124 (SetServiceStatus) 1124 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4062 233 4272 5562 CB
5596 5568 2469 ( is called during lengthy initializations.) 2469 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 1736 250 2535 5795 CB
2535 5815 845 (dwWaitHint) 845 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4062 200 4272 5795 CB
4472 5818 3735 (This value specifies a worst-case estimate of the amount of) 3735 SB
gr
gs 4062 183 4272 5995 CB
4472 6001 3665 (time in milliseconds that will elapse before the next status) 3665 SB
gr
gs 4062 183 4272 6178 CB
4472 6184 3517 (message will be sent out. If this interval elapses and the) 3517 SB
gr
gs 4062 183 4272 6361 CB
4472 6367 3591 (checkpoint has not been incremented, the service control) 3591 SB
gr
gs 4062 183 4272 6544 CB
4472 6550 3469 (manager or the service control program that started the) 3469 SB
gr
gs 4062 183 4272 6727 CB
4472 6733 3850 (service may assume that an error has occurred. Set this value) 3850 SB
gr
gs 4062 183 4272 6910 CB
4472 6916 3565 (to allow a generous amount of time to complete the next) 3565 SB
gr
gs 4062 233 4272 7093 CB
4472 7099 1133 (initialization step.) 1133 SB
gr
32 0 0 250 250 0 0 0 233 /Helvetica-Narrow-Bold /font16 ANSIFont font
2535 7454 3324 (58.1.3.3  Control Handler Function) 3324 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 7780 3903 (Each Win32 service has a control handler function, the ) 3903 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6438 7777 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7061 7780 1143 ( function, that is) 1143 SB
2535 7980 5324 (invoked by the main thread\222s control dispatcher when the service receives a) 5324 SB
2535 8180 5747 (control request. The service specifies the address of this function when it calls the) 5747 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 8377 2103 (RegisterServiceCtrlHandler) 2103 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4638 8380 1876 ( entrypoint function, in its ) 1876 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6514 8377 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7459 8380 674 ( function.) 674 SB
2535 8580 5015 (Control requests are generated by service control programs that call the) 5015 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 8777 1130 (ControlService) 1130 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3665 8780 674 ( function.) 674 SB
2535 9113 1554 (Whenever a service\222s ) 1554 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4089 9110 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4712 9113 3188 ( function is invoked, the service must call the) 3188 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 9310 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3780 9313 4499 ( function to report its status to the service control manager. This) 4499 SB
2535 9513 4647 (reporting must be done even if the service\222s status did not change.) 4647 SB
2535 9846 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2852 9843 1130 (ControlService) 1130 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3982 9846 4266 ( function can specify any of the standard control codes listed) 4266 SB
2535 10046 4435 (in the following table. All services must accept and process the) 4435 SB
2535 10246 4866 (SERVICE_CONTROL_INTERROGATE code. When a service calls) 4866 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 10443 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3780 10446 4042 (, it can enable or disable the other standard control codes.) 4042 SB
2535 10646 5670 (Services can also handle additional user-defined control codes, which must be in) 5670 SB
2535 10846 2213 (the range 128 to 255, inclusive.) 2213 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 372 def
/wp$fpage (372) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 372 def
/wp$fpage (372) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 7 7
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (373) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
0 0 0 fC
gs 874 250 2885 1985 CB
2885 2005 527 (Control) 527 SB
gr
gs 4924 250 3760 1985 CB
3960 2005 597 (Meaning) 597 SB
gr
5798 11 2885 2235 B
1 F
n
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 5799 250 2885 2264 CB
2885 2287 1950 (SERVICE_CONTROL_STOP) 1950 SB
gr
gs 4924 250 3760 2514 CB
3960 2537 1795 (Requests the service to stop.) 1795 SB
gr
gs 5799 250 2885 2764 CB
2885 2787 2064 (SERVICE_CONTROL_PAUSE) 2064 SB
gr
gs 4924 250 3760 3014 CB
3960 3037 1891 (Requests the service to pause.) 1891 SB
gr
gs 5799 250 2885 3264 CB
2885 3287 2371 (SERVICE_CONTROL_CONTINUE) 2371 SB
gr
gs 4924 250 3760 3514 CB
3960 3537 2465 (Requests the paused service to resume.) 2465 SB
gr
gs 5799 250 2885 3764 CB
2885 3787 2670 (SERVICE_CONTROL_INTERROGATE) 2670 SB
gr
gs 4924 200 3760 4014 CB
3960 4037 4603 (Requests the service to immediately update its current status information) 4603 SB
gr
gs 4924 233 3760 4214 CB
3960 4220 1954 (to the service control manager.) 1954 SB
gr
gs 5799 250 2885 4447 CB
2885 4470 2468 (SERVICE_CONTROL_SHUTDOWN) 2468 SB
gr
gs 4924 200 3760 4697 CB
3960 4720 4321 (Requests the service to perform cleanup tasks, because the system is) 4321 SB
gr
gs 4924 183 3760 4897 CB
3960 4903 4646 (shutting down. Due to the extremely limited time available for shutdown,) 4646 SB
gr
gs 4924 183 3760 5080 CB
3960 5086 4532 (this control should only be used by services that absolutely need to shut) 4532 SB
gr
gs 4924 183 3760 5263 CB
3960 5269 4513 (down. For instance, the eventlog service needs to clear a dirty bit in the) 4513 SB
gr
gs 4924 183 3760 5446 CB
3960 5452 4401 (files that it maintains, or the server service needs to shut down so that) 4401 SB
gr
gs 4924 183 3760 5629 CB
3960 5635 4630 (network connections cannot be made when the system is in the shutdown) 4630 SB
gr
gs 4924 233 3760 5812 CB
3960 5818 329 (state.) 329 SB
gr
gs 4924 200 3760 6045 CB
3960 6068 4507 (If the service takes time to shut down, and sends out STOP_PENDING) 4507 SB
gr
gs 4924 183 3760 6245 CB
3960 6251 4573 (status messages, it is highly recommended that these messages include a) 4573 SB
gr
gs 4924 183 3760 6428 CB
3960 6434 4619 (wait hint so that the service controller will know how long to wait before) 4619 SB
gr
gs 4924 183 3760 6611 CB
3960 6617 4489 (indicating to the system that service shutdown is complete. The system) 4489 SB
gr
gs 4924 183 3760 6794 CB
3960 6800 4368 (gives the service control manager a limited amount of time \(about 20) 4368 SB
gr
gs 4924 183 3760 6977 CB
3960 6983 4721 (seconds\) to complete service shutdown, after which time system shutdown) 4721 SB
gr
gs 4924 233 3760 7160 CB
3960 7166 3906 (proceeds regardless of whether service shutdown is complete.) 3906 SB
gr
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 7633 4337 (58.1.4  Service Configuration Programs) 4337 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 8014 4766 (Service configuration programs are used by programmers or system) 4766 SB
2885 8214 5379 (administrators to query or modify a service control manager database. These) 5379 SB
2885 8414 5183 (databases are maintained in the configuration registry, so they can also be) 5183 SB
2885 8614 5799 (accessed by using the registry functions or a registry editor. It is, however, safer to) 5799 SB
2885 8814 5626 (use the service control manager\222s configuration functions, which ensure that the) 5626 SB
2885 9014 3084 (service is installed and configured properly.) 3084 SB
2885 9347 5599 (Service control manager databases and services are implemented as objects that) 5599 SB
2885 9547 5393 (should only be accessed through the service control manager\222s configuration) 5393 SB
2885 9747 5800 (functions. A database of installed services is represented by an SCManager object,) 5800 SB
2885 9947 5674 (and an installed service is represented by a service object. An SCManager object) 5674 SB
2885 10147 3271 (is a container object that holds service objects.) 3271 SB
2885 10480 5754 (The handle type of both SCManager objects and service objects is SC_HANDLE.) 5754 SB
2885 10680 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3202 10677 1313 (OpenSCManager) 1313 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4515 10680 3885 ( function returns a handle to an SCManager object on a) 3885 SB
2885 10880 1678 (specified machine. The ) 1678 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4563 10877 1052 (CreateService) 1052 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5615 10880 342 ( and ) 342 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5957 10877 954 (OpenService) 954 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6911 10880 1283 ( functions return a) 1283 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 373 def
/wp$fpage (373) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 373 def
/wp$fpage (373) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 8 8
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (374) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2535 1989 5125 (handle to a service object installed in a specified SCManager object. The) 5125 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 2186 1500 (CloseServiceHandle) 1500 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4035 2189 3884 ( function closes SC_HANDLE to either an SCManager) 3884 SB
2535 2389 1801 (object or a service object.) 1801 SB
2535 2722 5571 (The functions that return SC_HANDLE can request different types of access to) 5571 SB
2535 2922 5307 (the SCManager or service object. The requested access is granted or denied) 5307 SB
2535 3122 5584 (depending on the access token of the calling process and the security descriptor) 5584 SB
2535 3322 3468 (associated with the SCManager or service object.) 3468 SB
2535 3655 2404 (A configuration program uses the ) 2404 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4939 3652 1052 (CreateService) 1052 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5991 3655 2284 ( function to install a new service) 2284 SB
2535 3855 5547 (in an service control manager database. This function specifies the name of the) 5547 SB
2535 4055 5617 (service and provides the service\222s configuration information that is stored in the) 5617 SB
2535 4255 5381 (database. For a description of the information stored in the database for each) 5381 SB
2535 4455 4632 (service, see Section 58.2.2, \223Database of Installed Services.\224 The ) 4632 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7167 4452 1013 (DeleteService) 1013 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 4655 3902 (function removes an installed service from its database.) 3902 SB
2535 4988 5665 (The following functions are available to determine the current configuration of a) 5665 SB
2535 5188 2385 (service control manager database:) 2385 SB
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 949 250 2535 5517 CB
2535 5537 607 (Function) 607 SB
gr
gs 4849 250 3485 5517 CB
3685 5537 781 (Description) 781 SB
gr
5798 11 2535 5767 B
1 F
n
gs 5799 250 2535 5796 CB
2535 5816 1378 (QueryServiceConfig) 1378 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4849 200 3485 6046 CB
3685 6069 1452 (Fills in a buffer with a ) 1452 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 4849 200 3485 6046 CB
5137 6066 2061 (QUERY_SERVICE_CONFIG) 2061 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4849 200 3485 6046 CB
7198 6069 633 ( structure,) 633 SB
gr
gs 4849 183 3485 6246 CB
3685 6252 4498 (containing the current configuration information for a specified service) 4498 SB
gr
gs 4849 233 3485 6429 CB
3685 6435 427 (object.) 427 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 5799 250 2535 6662 CB
2535 6682 1940 (QueryServiceObjectSecurity) 1940 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4849 200 3485 6912 CB
3685 6935 1575 (Fills in a buffer with the ) 1575 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 4849 200 3485 6912 CB
5260 6932 1929 (SECURITY_DESCRIPTOR) 1929 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4849 200 3485 6912 CB
7189 6935 875 ( structure of a) 875 SB
gr
gs 4849 233 3485 7112 CB
3685 7118 2490 (specified SCManager or service object.) 2490 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 5799 250 2535 7345 CB
2535 7365 1694 (EnumDependentServices) 1694 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4849 200 3485 7595 CB
3685 7618 2068 (Fills in a buffer with an array of ) 2068 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 4849 200 3485 7595 CB
5753 7615 1955 (ENUM_SERVICE_STATUS) 1955 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4849 183 3485 7795 CB
3685 7801 4558 (structures, containing the name and current status of all services that are) 4558 SB
gr
gs 4849 233 3485 7978 CB
3685 7984 2521 (dependent on a specified service object.) 2521 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 5799 250 2535 8211 CB
2535 8231 1387 (EnumServicesStatus) 1387 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4849 200 3485 8461 CB
3685 8484 2068 (Fills in a buffer with an array of ) 2068 SB
gr
32 0 0 158 158 0 0 0 144 /Times-Bold /font29 ANSIFont font
gs 4849 200 3485 8461 CB
5753 8481 1955 (ENUM_SERVICE_STATUS) 1955 SB
gr
32 0 0 158 158 0 0 0 141 /Times-Roman /font32 ANSIFont font
gs 4849 183 3485 8661 CB
3685 8667 4321 (structures, containing the name and current status of all services in a) 4321 SB
gr
gs 4849 233 3485 8844 CB
3685 8850 1831 (specified SCManager object.) 1831 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 9214 5411 (To modify the configuration information for a service object, a configuration) 5411 SB
2535 9414 1243 (program uses the ) 1243 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3778 9411 1626 (ChangeServiceConfig) 1626 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5404 9414 2323 ( function. To modify the security) 2323 SB
2535 9614 5444 (descriptor for either an SCManager object or a service object, a configuration) 5444 SB
2535 9814 1243 (program uses the ) 1243 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3778 9811 1907 (SetServiceObjectSecurity) 1907 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5685 9814 674 ( function.) 674 SB
2535 10147 5614 (Before using either of these functions to reconfigure a service object, a program) 5614 SB
2535 10347 1050 (should use the ) 1050 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3585 10344 1617 (LockServiceDatabase) 1617 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5202 10347 2870 ( function. This function tries to acquire a) 2870 SB
2535 10547 5781 (lock on the specified service control manager database and, if successful, prevents) 5781 SB
2535 10747 5502 (the service control manager from starting a service while the database is being) 5502 SB
2535 10947 5792 (reconfigured. A lock should also be acquired before using the registry functions to) 5792 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 374 def
/wp$fpage (374) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 374 def
/wp$fpage (374) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 9 9
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (375) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2885 1989 5767 (reconfigure a service object. Note, however, that failure to acquire a lock does not) 5767 SB
2885 2189 5745 (prevent a configuration program from successfully reconfiguring a service object.) 5745 SB
2885 2389 5712 (The only effect of a lock is to prevent the service control manager from starting a) 5712 SB
2885 2589 5330 (service in the locked database. To release the lock on the database when the) 5330 SB
2885 2789 2557 (reconfiguration is complete, use the ) 2557 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5442 2786 1772 (UnlockServiceDatabase) 1772 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7214 2789 913 ( function. To) 913 SB
2885 2989 3518 (determine whether the database is locked, use the ) 3518 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6403 2986 1869 (QueryServiceLockStatus) 1869 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 3189 630 (function.) 630 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 3625 3640 (58.1.5  Service Control Programs) 3640 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4006 4100 (A service control program performs the following actions:) 4100 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 4273 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 4339 4875 (Starts a Win32 service or a driver service, if the service\222s start type is) 4875 SB
3118 4539 2270 (SERVICE_DEMAND_START.) 2270 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 4740 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 4806 3059 (Sends control requests to a running service.) 3059 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 5007 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 5073 3277 (Queries the current status of a running service.) 3277 SB
2885 5473 5705 (The program must have an open handle to any service object that it wants to start) 5705 SB
2885 5673 3517 (or control. To do this, it must perform these steps:) 3517 SB
2886 6006 132 (1.) 132 SB
3118 6006 575 (Use the ) 575 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3693 6003 1313 (OpenSCManager) 1313 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5006 6006 3218 ( function to open a handle to a service control) 3218 SB
3118 6206 2956 (manager database on a specified machine.) 2956 SB
2886 6473 132 (2.) 132 SB
3118 6473 575 (Use the ) 575 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3693 6470 954 (OpenService) 954 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4647 6473 234 ( or ) 234 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4881 6470 1052 (CreateService) 1052 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5933 6473 2272 ( function to open a handle to the) 2272 SB
3118 6673 1566 (desired service object.) 1566 SB
32 0 0 250 250 0 0 0 233 /Helvetica-Narrow-Bold /font16 ANSIFont font
2885 7064 2359 (58.1.5.1  Service Startup) 2359 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 7390 1829 (To start a service, use the ) 1829 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4714 7387 925 (StartService) 925 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5639 7390 2917 ( function. For Win32 services, the calling) 2917 SB
2885 7590 5593 (process can use the parameters of this function to specify an array of arguments) 5593 SB
2885 7790 1518 (that are passed to the ) 1518 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4403 7787 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5348 7790 3147 ( function of the service. This function fails if) 3147 SB
2885 7990 5659 (the service control manager database is locked. If this occurs, the service control) 5659 SB
2885 8190 2896 (program can wait a few seconds and call ) 2896 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5781 8187 925 (StartService) 925 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6706 8190 1621 ( again. It can check the) 1621 SB
2885 8390 3432 (current lock status of the database by calling the ) 3432 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6317 8387 1869 (QueryServiceLockStatus) 1869 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 8590 630 (function.) 630 SB
2885 8923 2203 (When starting a driver service, ) 2203 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5088 8920 925 (StartService) 925 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6013 8923 2399 ( returns after the device driver has) 2399 SB
2885 9123 1920 (completed its initialization.) 1920 SB
2885 9456 2261 (When starting a Win32 service, ) 2261 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5146 9453 925 (StartService) 925 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6071 9456 1199 ( returns after the ) 1199 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7270 9453 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 9656 5553 (function thread for the new service has been created. During its initialization, a) 5553 SB
2885 9856 1321 (service specifies a ) 1321 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4206 9853 1545 (SERVICE_STATUS) 1545 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5751 9856 1689 ( structure in calls to the ) 1689 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7440 9853 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 10056 5693 (function to report its progress to the service control manager. The service control) 5693 SB
2885 10256 4123 (program can retrieve this status information by calling the ) 4123 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7008 10253 1489 (QueryServiceStatus) 1489 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 10456 2452 (function. During initialization, the ) 2452 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5337 10453 1214 (dwCurrentState) 1214 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6551 10456 1067 ( member of the) 1067 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 10653 1545 (SERVICE_STATUS) 1545 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4430 10656 4011 ( structure should be SERVICE_START_PENDING. The) 4011 SB
2885 10856 2059 (service should increment the ) 2059 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4944 10853 1098 (dwCheckPoint) 1098 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6042 10856 2482 ( member at regular intervals during) 2482 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 375 def
/wp$fpage (375) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 375 def
/wp$fpage (375) def
/wp$date (05/05/93) def
/wp$time (16:37) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 10 10
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (376) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2535 1989 1295 (initialization. The ) 1295 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3830 1986 933 (dwWaitHint) 933 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4763 1989 3347 ( member is a time interval, in milliseconds, that) 3347 SB
2535 2189 5182 (indicates how long the service control program should wait before calling) 5182 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 2386 1489 (QueryServiceStatus) 1489 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4024 2389 3817 ( again. When the initialization is complete, the service) 3817 SB
2535 2589 869 (changes the ) 869 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3404 2586 1214 (dwCurrentState) 1214 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4618 2589 2509 ( member to SERVICE_RUNNING.) 2509 SB
32 0 0 250 250 0 0 0 233 /Helvetica-Narrow-Bold /font16 ANSIFont font
2535 2979 3349 (58.1.5.2  Service Control Requests) 3349 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 3305 3782 (To send control requests to a running service, use the ) 3782 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6317 3302 1130 (ControlService) 1130 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7447 3305 674 ( function.) 674 SB
2535 3505 4105 (This function specifies a control code that is passed to the ) 4105 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6640 3502 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7263 3505 820 ( function of) 820 SB
2535 3705 5543 (the specified service. This control code can be a user-defined code, or it can be) 5543 SB
2535 3905 5792 (one of the standard codes that enable the calling program to perform the following) 5792 SB
2535 4105 547 (actions:) 547 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 4372 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 4438 1799 (Stops or pauses a service.) 1799 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 4639 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 4705 1872 (Resumes a paused service.) 1872 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 4906 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 4972 3330 (Gets updated status information from a service.) 3330 SB
2535 5372 5206 (Each service specifies the control codes that it will accept and process. To) 5206 SB
2535 5572 5630 (determine which of the standard control codes are accepted by a service, use the) 5630 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 5769 1489 (QueryServiceStatus) 1489 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4024 5772 1630 ( function or specify the) 1630 SB
2535 5972 4914 (SERVICE_CONTROL_INTERROGATE control code in a call to the) 4914 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 6169 1130 (ControlService) 1130 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3665 6172 1035 ( function. The ) 1035 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4700 6169 1565 (dwControlsAccepted) 1565 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6265 6172 1067 ( member of the) 1067 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 6369 1545 (SERVICE_STATUS) 1545 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4080 6372 4147 ( structure returned by these functions indicates whether the) 4147 SB
2535 6572 5522 (service can be stopped and whether it can be paused and resumed. All services) 5522 SB
2535 6772 5761 (accept the SERVICE_CONTROL_INTERROGATE control code, which requests) 5761 SB
2535 6972 3561 (the service to immediately report its current status.) 3561 SB
2535 7305 1688 (Note, however, that the ) 1688 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4223 7302 1489 (QueryServiceStatus) 1489 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5712 7305 2503 ( function reports the service control) 2503 SB
2535 7505 5640 (manager\222s most recent status for a specified service, but does not get an updated) 5640 SB
2535 7705 5744 (status from the service itself. Using the SERVICE_CONTROL_INTERROGATE) 5744 SB
2535 7905 1700 (control code in a call to ) 1700 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4235 7902 1130 (ControlService) 1130 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5365 7905 2454 ( ensures that the status information) 2454 SB
2535 8105 1331 (returned is current.) 1331 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 8541 2583 (58.1.6  Service Security) 2583 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 8922 1759 (When a process uses the ) 1759 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4294 8919 1313 (OpenSCManager) 1313 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5607 8922 2676 ( function to open a handle to a service) 2676 SB
2535 9122 5603 (control manager database, the system performs a security check before granting) 5603 SB
2535 9322 5615 (the requested access. All processes are permitted SC_MANAGER_CONNECT,) 5615 SB
2535 9522 3512 (SC_MANAGER_ENUMERATE_SERVICE, and) 3512 SB
2535 9722 5164 (SC_MANAGER_QUERY_LOCK_STATUS access to all service control) 5164 SB
2535 9922 5424 (manager databases. This access enables any process to open a service control) 5424 SB
2535 10122 3333 (manager database handle that it can use for the ) 3333 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5868 10119 954 (OpenService) 954 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6822 10122 44 (,) 44 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 10319 1537 (EnumServicesStatus) 1537 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4072 10322 386 (, and ) 386 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4458 10319 1869 (QueryServiceLockStatus) 1869 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6327 10322 1853 ( functions. Only processes) 1853 SB
2535 10522 5695 (with Administrator privileges are able to open a database handle that can be used) 5695 SB
2535 10722 479 (by the ) 479 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3014 10719 1052 (CreateService) 1052 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4066 10722 342 ( and ) 342 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4408 10719 1617 (LockServiceDatabase) 1617 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6025 10722 742 ( functions.) 742 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 376 def
/wp$fpage (376) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 376 def
/wp$fpage (376) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 11 11
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (377) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2885 1989 5442 (Security for service objects is provided by an access check performed when a) 5442 SB
2885 2189 1175 (process uses the ) 1175 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4060 2186 954 (OpenService) 954 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5014 2189 3433 ( function. The access permitted to different users) 3433 SB
2885 2389 1099 (depends on the ) 1099 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3984 2386 2137 (SECURITY_DESCRIPTOR) 2137 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6121 2389 2039 ( structure associated with the) 2039 SB
2885 2589 5458 (service object. The service control manager creates a service object\222s security) 5458 SB
2885 2789 3250 (descriptor when the service is installed by the ) 3250 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6135 2786 1052 (CreateService) 1052 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7187 2789 1308 ( function. You can) 1308 SB
2885 2989 537 (use the ) 537 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3422 2986 2151 (QueryServiceObjectSecurity) 2151 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5573 2989 342 ( and ) 342 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5915 2986 1907 (SetServiceObjectSecurity) 1907 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7822 2989 698 ( functions) 698 SB
2885 3189 5543 (to query and set the security descriptor of a service object. The default security) 5543 SB
2885 3389 4126 (descriptor of a service object permits the following access:) 4126 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 3656 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 3722 5504 (All users have SERVICE_QUERY_CONFIG, SERVICE_QUERY_STATUS,) 5504 SB
3118 3922 5283 (SERVICE_ENUMERATE_DEPENDENTS, SERVICE_INTERROGATE,) 5283 SB
3118 4122 3847 (and SERVICE_USER_DEFINED_CONTROL access.) 3847 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 4323 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 4389 5418 (Local users have SERVICE_START access in addition to those listed above.) 5418 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 4590 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 4656 4342 (LocalSystem users and PowerUsers have SERVICE_START,) 4342 SB
3118 4856 5456 (SERVICE_PAUSE_CONTINUE, and SERVICE_STOP access in addition to) 5456 SB
3118 5056 1304 (those listed above.) 1304 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 5257 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 5323 3914 (Administrators have SERVICE_ALL_ACCESS access.) 3914 SB
32 0 0 250 250 0 0 0 233 /Helvetica-Narrow-Bold /font16 ANSIFont font
2885 5714 3748 (58.1.6.1  Win32 Service User Accounts) 3748 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 6040 5470 (Each Win32 service runs in a user account. The username and password of an) 5470 SB
2885 6240 2006 (account are specified by the ) 2006 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4891 6237 1052 (CreateService) 1052 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5943 6240 2377 ( function at the time the service is) 2377 SB
2885 6440 4753 (installed. The user name and password can be changed by using the) 4753 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 6637 1626 (ChangeServiceConfig) 1626 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4511 6640 1889 ( function. You can use the ) 1889 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6400 6637 1529 (QueryServiceConfig) 1529 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7929 6640 630 ( function) 630 SB
2885 6840 4405 (to get the user name \(but not the password\) of a service object.) 4405 SB
2885 7173 5253 (When starting a service process, the service control manager logs on to the) 5253 SB
2885 7373 5181 (account associated with the service. If the log on is successful, the system) 5181 SB
2885 7573 5543 (produces an access token and attaches it to the new service process. This token) 5543 SB
2885 7773 5719 (identifies the service process in all subsequent interactions with securable objects) 5719 SB
2885 7973 5707 (\(objects that have a security descriptor associated with them\). For example, if the) 5707 SB
2885 8173 5664 (service tries to open a handle to a pipe, the system compares the service\222s access) 5664 SB
2885 8373 4309 (token to the pipe\222s security descriptor before granting access.) 4309 SB
2885 8706 5544 (A SERVICE_WIN32_OWN_PROCESS service that runs in a process by itself) 5544 SB
2885 8906 5756 (can have an account from either the built-in \(local\), primary, or trusted domain. A) 5756 SB
2885 9106 5447 (SERVICE_WIN32_SHARE_PROCESS service that can share a process with) 5447 SB
2885 9306 3373 (multiple services must be installed to run in the ) 3373 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6258 9303 955 (LocalSystem) 955 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7213 9306 991 ( account. This) 991 SB
2885 9506 5793 (restriction exists because different services in the same process must run under the) 5793 SB
2885 9706 1566 (same security context.) 1566 SB
2885 10039 5482 (The service control manager does not try to maintain the passwords of service) 5482 SB
2885 10239 5434 (user accounts. If a password is expired, the logon fails and the service fails to) 5434 SB
2885 10439 5271 (start. The system administrator who assigns accounts to services can create) 5271 SB
2885 10639 5516 (accounts with passwords that never expire. The administrator can also manage) 5516 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 377 def
/wp$fpage (377) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 377 def
/wp$fpage (377) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 12 12
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (378) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2535 1989 5654 (accounts with passwords that expire by using a service configuration program to) 5654 SB
2535 2189 2459 (periodically change the passwords.) 2459 SB
2535 2522 5682 (If a service needs to recognize another service before sharing its information, the) 5682 SB
2535 2722 5732 (second service can either use the same account as the first service, or it can run in) 5732 SB
2535 2922 5574 (an account belonging to an alias that is recognized by the first service. Services) 5574 SB
2535 3122 5729 (that need to run in a distributed manner across the network should run in domain-) 5729 SB
2535 3322 1044 (wide accounts.) 1044 SB
32 0 0 333 333 0 0 0 311 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 3801 2643 (58.2  Using Services) 2643 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 4256 3695 (The examples in this section illustrate the following:) 3695 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 4523 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 4589 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3085 4586 380 (main) 380 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3465 4589 2574 ( function of a Win32 service process) 2574 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 4790 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 4856 1802 (The entry point function, ) 1802 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4570 4853 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5515 4856 1988 (, of a Win32 service process) 1988 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 5057 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 5123 2104 (The control handler function, ) 2104 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4872 5120 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5495 5123 1988 (, of a Win32 service process) 1988 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 5324 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 5390 3107 (Opening a service control manager database) 3107 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 5591 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 5657 4919 (Installing and deleting a service in a service control manager database) 4919 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 5858 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 5924 4374 (Changing or querying the configuration of an installed service) 4374 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 6125 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 6191 1219 (Starting a service) 1219 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2617 12924 0 0 CB
2535 6392 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2768 6458 3172 (Sending control requests to a running service) 3172 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 6961 6225 (58.2.1  Writing a Win32 Service Process\222s main Function) 6225 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 7342 317 (The ) 317 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2852 7339 380 (main) 380 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3232 7342 3516 ( function of a Win32 service process must call the) 3516 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 7539 2053 (StartServiceCtrlDispatcher) 2053 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4588 7542 3594 ( function as soon as possible. For service processes) 3594 SB
2535 7742 5424 (that execute only one service, the function is called immediately, because the) 5424 SB
2535 7942 668 (service\222s ) 668 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3203 7939 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4148 7942 4167 ( function can perform all initialization tasks for the service.) 4167 SB
2535 8142 2424 (The following example shows the ) 2424 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4959 8139 380 (main) 380 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5339 8142 1000 ( function for a) 1000 SB
2535 8342 3851 (SERVICE_WIN32_OWN_PROCESS service process:) 3851 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 8695 1040 (/* Globals */) 1040 SB
2535 9061 1920 (SERVICE_STATUS ssStatus;) 1920 SB
2535 9427 2320 (HANDLE hServDoneEvent = NULL;) 2320 SB
2535 9793 3040 (SERVICE_STATUS_HANDLE sshStatusHandle;) 3040 SB
2535 10159 4800 (/* Exit code that is set by any thread when error occurs. */) 4800 SB
2535 10525 2320 (DWORD dwGlobalErr = NO_ERROR;) 2320 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 378 def
/wp$fpage (378) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 378 def
/wp$fpage (378) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 13 13
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (379) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2009 1360 (VOID main\(VOID\) {) 1360 SB
2885 2375 3680 (  SERVICE_TABLE_ENTRY   steDispatchTable[] = {) 3680 SB
2885 2741 2720 (      /* entry for "Sample_Srv" */) 2720 SB
2885 3107 2160 (      { TEXT\("Sample_Srv"\),) 2160 SB
2885 3290 3840 (        \(LPSERVICE_MAIN_FUNCTION\) ServMainFunc},) 3840 SB
2885 3656 4480 (      /* NULL entry designating the end of the table. */) 4480 SB
2885 4022 1600 (      { NULL, NULL }) 1600 SB
2885 4388 320 (  };) 320 SB
2885 4754 320 (  /*) 320 SB
2885 4937 5440 (   * The main thread of a service process starts the service control) 5440 SB
2885 5120 4640 (   * dispatcher that dispatches start and control requests) 4640 SB
2885 5303 4560 (   * for the services specified in steDispatchTable. This) 4560 SB
2885 5486 4400 (   * function does not return unless there is an error.) 4400 SB
2885 5669 400 (   */) 400 SB
2885 6035 4320 (  if \(! StartServiceCtrlDispatcher\(steDispatchTable\) \)) 4320 SB
2885 6218 3840 (      MyErrorExit\("StartServiceCtrlDispatcher"\);) 3840 SB
2885 6584 80 (}) 80 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 6930 5437 (When a service process will execute multiple services, it may be necessary to) 5437 SB
2885 7130 5349 (perform some common process-wide initialization before starting any of the) 5349 SB
2885 7330 5596 (services. If this initialization is brief \(less than 30 seconds\), the main thread can) 5596 SB
2885 7530 1636 (do it before calling the ) 1636 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4521 7527 2053 (StartServiceCtrlDispatcher) 2053 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6574 7530 2078 ( function. Otherwise, you can) 2078 SB
2885 7730 2464 (use one of the following strategies:) 2464 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 7997 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 8063 575 (Use the ) 575 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3693 8060 1061 (CreateThread) 1061 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4754 8063 3905 ( function to create a thread to perform the initialization.) 3905 SB
32 0 0 158 158 0 0 0 222 /MSIcons font
gs 2967 12924 0 0 CB
2885 8264 82 (u) 82 SB
gr
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3118 8330 2581 (Use a global flag that each service\222s ) 2581 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5699 8327 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6644 8330 1865 ( function checks during its) 1865 SB
3118 8530 4864 (initialization so that the first service to start up performs the common) 4864 SB
3118 8730 934 (initialization.) 934 SB
2885 9130 5770 (Other than these initialization issues and the fact that there is a dispatch table with) 5770 SB
2885 9330 5518 (additional entries, the main thread of a multiple service process does not differ) 5518 SB
2885 9530 3598 (from that of a service process with a single service.) 3598 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 9966 4236 (58.2.2  Writing a ServiceMain Function) 4236 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 10347 317 (The ) 317 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
3202 10347 1044 (ServMainFunc) 1044 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4246 10347 4335 ( function in the following example is the service\222s entry point) 4335 SB
2885 10547 674 (function, ) 674 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3559 10544 945 (ServiceMain) 945 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4504 10547 1190 (. It first calls the ) 1190 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5694 10544 2103 (RegisterServiceCtrlHandler) 2103 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7797 10547 811 ( function to) 811 SB
2885 10747 829 (register the ) 829 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3714 10744 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4337 10747 1441 ( function, called the ) 1441 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
5778 10747 1180 (ServCtrlHandler) 1180 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6958 10747 1109 ( function in this) 1109 SB
2885 10947 1855 (example. Then it calls the ) 1855 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
4740 10947 1600 (ReportStatusToSCMgr) 1600 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6340 10947 2143 ( subroutine, which updates the) 2143 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 379 def
/wp$fpage (379) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 379 def
/wp$fpage (379) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 14 14
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (380) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
0 0 0 fC
2535 1989 2114 (service\222s status by calling the ) 2114 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4649 1986 1245 (SetServiceStatus) 1245 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5894 1989 2105 ( function. As the initialization) 2105 SB
2535 2189 5110 (tasks are completed, it makes additional status updates, incrementing the) 5110 SB
2535 2389 1963 (checkpoint value each time.) 1963 SB
2535 2722 3407 (As part of the initialization, the service calls the ) 3407 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5942 2719 944 (CreateEvent) 944 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6886 2722 1274 ( function to create) 1274 SB
2535 2922 259 (the ) 259 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2794 2922 1180 (hServDoneEvent) 1180 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3974 2922 2315 ( event object. The initial state of ) 2315 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
6289 2922 1180 (hServDoneEvent) 1180 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7469 2922 488 ( is not-) 488 SB
2535 3122 5345 (signaled. After the initialization is complete, the service updates its status to) 5345 SB
2535 3322 5678 (SERVICE_RUNNING \(with checkpoint and waithint values set to zero\). Then it) 5678 SB
2535 3522 625 (calls the ) 625 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3160 3519 1606 (WaitForSingleObject) 1606 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4766 3522 2264 ( function to wait for the state of ) 2264 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
7030 3522 1180 (hServDoneEvent) 1180 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
8210 3522 44 (,) 44 SB
2535 3722 2630 (to be signaled. When this occurs, the ) 2630 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
5165 3722 1044 (ServMainFunc) 1044 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6209 3722 2079 ( function updates the services) 2079 SB
2535 3922 3708 (status to SERVICE_STOPPED, cleans up, and exits.) 3708 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 4275 160 (/*) 160 SB
2535 4458 3120 ( * ServiceMain function of "Sample_Srv") 3120 SB
2535 4641 160 ( *) 160 SB
2535 4824 4960 ( * When the service is started, the service control dispatcher) 4960 SB
2535 5007 3920 ( * creates a new thread to execute this function.) 3920 SB
2535 5190 240 ( */) 240 SB
2535 5556 4000 (VOID ServiceMain\(DWORD dwArgc, LPTSTR *lpszArgv\) {) 4000 SB
2535 5922 1200 (  DWORD dwWait;) 1200 SB
2535 6288 5040 (  /* Register the control handler function for this service. */) 5040 SB
2535 6654 3760 (  sshStatusHandle = RegisterServiceCtrlHandler\() 3760 SB
2535 6837 4480 (      TEXT\("Sample_Srv"\), /* service name             */) 4480 SB
2535 7020 4480 (      ServCtrlHandler\);   /* control handler function */) 4480 SB
2535 7386 4320 (  if \(sshStatusHandle == \(SERVICE_STATUS_HANDLE\) NULL\)) 4320 SB
2535 7569 1520 (      goto Cleanup;) 1520 SB
2535 7935 4880 (  /* SERVICE_STATUS members that do not change in example. */) 4880 SB
2535 8301 4240 (  ssStatus.dwServiceType = SERVICE_WIN32_OWN_PROCESS;) 4240 SB
2535 8484 3280 (  ssStatus.dwServiceSpecificExitCode = 0;) 3280 SB
2535 9033 4240 (  /* Report the status to service control manager. */) 4240 SB
2535 9399 2240 (  if \(! ReportStatusToSCMgr\() 2240 SB
2535 9582 3840 (      SERVICE_START_PENDING, /* service state */) 3840 SB
2535 9765 3840 (      NO_ERROR,              /* exit code     */) 3840 SB
2535 9948 3840 (      1,                     /* checkpoint    */) 3840 SB
2535 10131 3840 (      3000\) \)                /* wait hint     */) 3840 SB
2535 10314 1520 (      goto Cleanup;) 1520 SB
2535 10680 320 (  /*) 320 SB
2535 10863 5280 (   * Create the event object. The control handler function signals) 5280 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 380 def
/wp$fpage (380) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 380 def
/wp$fpage (380) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 15 15
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (381) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2009 4560 (   * this event when it receives the "stop" control code.) 4560 SB
2885 2192 400 (   */) 400 SB
2885 2558 2560 (  hServDoneEvent = CreateEvent \() 2560 SB
2885 2741 3360 (     NULL,    /* no security attributes */) 3360 SB
2885 2924 3360 (     TRUE,    /* manual reset event     */) 3360 SB
2885 3107 3360 (     FALSE,   /* nonsignaled            */) 3360 SB
2885 3290 3360 (     NULL\);   /* no name                */) 3360 SB
2885 3656 3200 (  if \( hServDoneEvent == \(HANDLE\) NULL \)) 3200 SB
2885 3839 1520 (      goto Cleanup;) 1520 SB
2885 4205 4560 (  /* Report the status to the service control manager. */) 4560 SB
2885 4571 2240 (  if \(! ReportStatusToSCMgr\() 2240 SB
2885 4754 3840 (      SERVICE_START_PENDING, /* service state */) 3840 SB
2885 4937 3840 (      NO_ERROR,              /* exit code     */) 3840 SB
2885 5120 3840 (      2,                     /* checkpoint    */) 3840 SB
2885 5303 3840 (      3000\) \)                /* wait hint     */) 3840 SB
2885 5486 1520 (      goto Cleanup;) 1520 SB
2885 5852 5040 (  /* Start the thread that performs the work of the service. */) 5040 SB
2885 6218 2320 (  if \(! SampleServiceInit\(\) \)) 2320 SB
2885 6401 1520 (      goto Cleanup;) 1520 SB
2885 6767 4560 (  /* Report the status to the service control manager. */) 4560 SB
2885 7133 2240 (  if \(! ReportStatusToSCMgr\() 2240 SB
2885 7316 3360 (      SERVICE_RUNNING, /* service state */) 3360 SB
2885 7499 3360 (      NO_ERROR,        /* exit code     */) 3360 SB
2885 7682 3360 (      0,               /* checkpoint    */) 3360 SB
2885 7865 3360 (      0\) \)             /* wait hint     */) 3360 SB
2885 8048 1520 (      goto Cleanup;) 1520 SB
2885 8414 4720 (  /* Wait indefinitely until hServDoneEvent is signaled. */) 4720 SB
2885 8780 2560 (  dwWait = WaitForSingleObject \() 2560 SB
2885 8963 3520 (    hServDoneEvent,  /* event object      */) 3520 SB
2885 9146 3520 (    INFINITE\);       /* wait indefinitely */) 3520 SB
2885 9512 720 (Cleanup :) 720 SB
2885 9878 2320 (  if \(hServDoneEvent != NULL\)) 2320 SB
2885 10061 2640 (     CloseHandle\(hServDoneEvent\);) 2640 SB
2885 10427 5760 (  /* Try to report the stopped status to the service control manager. */) 5760 SB
2885 10793 2400 (  if \(sshStatusHandle != NULL\)) 2400 SB
2885 10976 3920 (      \(VOID\) ReportStatusToSCMgr\(SERVICE_STOPPED,) 3920 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 381 def
/wp$fpage (381) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 381 def
/wp$fpage (381) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 16 16
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (382) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2535 2009 3840 (                             dwGlobalErr, 0, 0\);) 3840 SB
2535 2375 320 (  /*) 320 SB
2535 2558 4640 (   * When ServiceMain function returns in a single service) 4640 SB
2535 2741 4480 (   * process, the StartServiceCtrlDispatcher function in) 4480 SB
2535 2924 4320 (   * the main thread returns, terminating the process.) 4320 SB
2535 3107 400 (   */) 400 SB
2535 3473 720 (  return;) 720 SB
2535 3839 80 (}) 80 SB
2535 4571 160 (/*) 160 SB
2535 4754 2480 ( * ReportStatusToSCMgr function) 2480 SB
2535 4937 160 ( *) 160 SB
2535 5120 4160 ( * This function is called by the ServMainFunc\(\) and) 4160 SB
2535 5303 4880 ( * ServCtrlHandler\(\) functions to update the service's status) 4880 SB
2535 5486 2720 ( * to the service control manager.) 2720 SB
2535 5669 240 ( */) 240 SB
2535 6035 3760 (BOOL ReportStatusToSCMgr \(DWORD dwCurrentState,) 3760 SB
2535 6218 3760 (     DWORD dwWin32ExitCode, DWORD dwCheckPoint,) 3760 SB
2535 6401 1920 (     DWORD dwWaitHint\) {) 1920 SB
2535 6767 1200 (  BOOL fResult;) 1200 SB
2535 7133 4960 (  /* Disable control requests until the service is started. */) 4960 SB
2535 7499 3680 (  if \(dwCurrentState == SERVICE_START_PENDING\)) 3680 SB
2535 7682 3040 (      ssStatus.dwControlsAccepted = 0;) 3040 SB
2535 7865 480 (  else) 480 SB
2535 8048 4560 (      ssStatus.dwControlsAccepted = SERVICE_ACCEPT_STOP |) 4560 SB
2535 8231 3200 (          SERVICE_ACCEPT_PAUSE_CONTINUE;) 3200 SB
2535 8597 4880 (  /* These SERVICE_STATUS members are set from parameters. */) 4880 SB
2535 8963 3440 (  ssStatus.dwCurrentState = dwCurrentState;) 3440 SB
2535 9146 3600 (  ssStatus.dwWin32ExitCode = dwWin32ExitCode;) 3600 SB
2535 9329 3120 (  ssStatus.dwCheckPoint = dwCheckPoint;) 3120 SB
2535 9512 2800 (  ssStatus.dwWaitHint = dwWaitHint;) 2800 SB
2535 9878 5760 (  /* Report the status of the service to the service control manager. */) 5760 SB
2535 10244 2960 (  if \(! \(fResult = SetServiceStatus \() 2960 SB
2535 10427 4480 (      sshStatusHandle,    /* service reference handle */) 4480 SB
2535 10610 4480 (      &ssStatus\) \) \) {    /* SERVICE_STATUS structure */) 4480 SB
2535 10976 3920 (      /* If an error occurs, stop the service. */) 3920 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 382 def
/wp$fpage (382) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 382 def
/wp$fpage (382) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 17 17
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (383) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2192 3520 (      StopSampleService\("SetServiceStatus"\);) 3520 SB
2885 2375 240 (  }) 240 SB
2885 2558 1360 (  return fResult;) 1360 SB
2885 2924 80 (}) 80 SB
2885 3473 160 (/*) 160 SB
2885 3656 5680 (* The StopSampleService function can be used by any thread to report an) 5680 SB
2885 3839 2320 (* error, or stop the service.) 2320 SB
2885 4022 160 (*/) 160 SB
2885 4388 3200 (VOID StopSampleService\(LPTSTR lpszMsg\) {) 3200 SB
2885 4571 1280 (CHAR chMsg[256];) 1280 SB
2885 4754 1600 (HANDLE hEventSource;) 1600 SB
2885 4937 1760 (LPTSTR lpszStrings[2];) 1760 SB
2885 5303 2480 (  dwGlobalErr = GetLastError\(\);) 2480 SB
2885 5669 3520 (  /*  Use event logging to log the error. */) 3520 SB
2885 6035 3360 (  hEventSource = RegisterEventSource\(NULL,) 3360 SB
2885 6218 3600 (                         TEXT\("Sample_Srv"\)\);) 3600 SB
2885 6584 4320 (  sprintf\(chMsg, "Sample_Srv error: %d", dwGlobalErr\);) 4320 SB
2885 6767 2000 (  lpszStrings[0] = chMsg;) 2000 SB
2885 6950 2160 (  lpszStrings[1] = lpszMsg;) 2160 SB
2885 7316 2320 (  if \(hEventSource != NULL\) {) 2320 SB
2885 7499 4800 (      ReportEvent\(hEventSource, /* handle of event source */) 4800 SB
2885 7682 4800 (          EVENTLOG_ERROR_TYPE,  /* event type             */) 4800 SB
2885 7865 4800 (          0,                    /* event category         */) 4800 SB
2885 8048 4800 (          0,                    /* event ID               */) 4800 SB
2885 8231 4800 (          NULL,                 /* current user's SID     */) 4800 SB
2885 8414 4800 (          2,                    /* strings in lpszStrings */) 4800 SB
2885 8597 4800 (          0,                    /* no bytes of raw data   */) 4800 SB
2885 8780 4800 (          lpszStrings,          /* array of error strings */) 4800 SB
2885 8963 4800 (          NULL\);                /* no raw data            */) 4800 SB
2885 9329 3920 (      \(VOID\) DeregisterEventSource\(hEventSource\);) 3920 SB
2885 9512 240 (  }) 240 SB
2885 9878 4880 (  /* Set a termination event to stop ServiceMain function. */) 4880 SB
2885 10244 2160 (  SetEvent\(hServDoneEvent\);) 2160 SB
2885 10610 80 (}) 80 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 383 def
/wp$fpage (383) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 383 def
/wp$fpage (383) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 18 18
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (384) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1975 4635 (58.2.3  Writing a Control Handler Function) 4635 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 2356 317 (The ) 317 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2852 2356 1180 (ServCtrlHandler) 1180 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4032 2356 4066 ( function in the following example is the service\222s control) 4066 SB
2535 2556 1245 (handler function, ) 1245 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3780 2553 623 (Handler) 623 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4403 2556 3563 ( function. When this function is called by the main) 3563 SB
2535 2756 5263 (thread\222s control dispatcher, it handles the control request and then calls the) 5263 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
2535 2956 1600 (ReportStatusToSCMgr) 1600 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4135 2956 2895 ( subroutine to update the service\222s status.) 2895 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 3309 160 (/*) 160 SB
2535 3492 5040 ( * The service control dispatcher invokes this function when it) 5040 SB
2535 3675 4720 ( * gets a control request from the service control manager.) 4720 SB
2535 3858 240 ( */) 240 SB
2535 4224 3280 (VOID ServCtrlHandler \(DWORD dwCtrlCode\) {) 3280 SB
2535 4590 2800 (  DWORD  dwState = SERVICE_RUNNING;) 2800 SB
2535 4956 3360 (  /* Handle the requested control code. */) 3360 SB
2535 5322 1760 (  switch\(dwCtrlCode\) {) 1760 SB
2535 5688 3760 (      /* Pause the service if it is running. */) 3760 SB
2535 6054 2640 (      case SERVICE_CONTROL_PAUSE:) 2640 SB
2535 6420 4720 (          if \(ssStatus.dwCurrentState == SERVICE_RUNNING\) {) 4720 SB
2535 6603 2800 (              PauseSampleService\(\);) 2800 SB
2535 6786 3120 (              dwState = SERVICE_PAUSED;) 3120 SB
2535 6969 880 (          }) 880 SB
2535 7152 1280 (          break;) 1280 SB
2535 7518 3040 (      /* Resume the paused service. */) 3040 SB
2535 7884 2880 (      case SERVICE_CONTROL_CONTINUE:) 2880 SB
2535 8250 4640 (          if \(ssStatus.dwCurrentState == SERVICE_PAUSED\) {) 4640 SB
2535 8433 2880 (              ResumeSampleService\(\);) 2880 SB
2535 8616 3200 (              dwState = SERVICE_RUNNING;) 3200 SB
2535 8799 880 (          }) 880 SB
2535 8982 1280 (          break;) 1280 SB
2535 9348 2320 (      /* Stop the service. */) 2320 SB
2535 9714 2560 (      case SERVICE_CONTROL_STOP:) 2560 SB
2535 10080 3280 (          dwState = SERVICE_STOP_PENDING;) 3280 SB
2535 10446 960 (          /*) 960 SB
2535 10629 5680 (           * Report the status, specifying the checkpoint and waithint,) 5680 SB
2535 10812 4000 (           * before setting the termination event.) 4000 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 384 def
/wp$fpage (384) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 384 def
/wp$fpage (384) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 19 19
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (385) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2009 1040 (           */) 1040 SB
2885 2375 2960 (          \(VOID\) ReportStatusToSCMgr\() 2960 SB
2885 2558 4800 (                   SERVICE_STOP_PENDING, /* current state */) 4800 SB
2885 2741 4800 (                   NO_ERROR,             /* exit code     */) 4800 SB
2885 2924 4800 (                   1,                    /* checkpoint    */) 4800 SB
2885 3107 4800 (                   3000\);                /* waithint      */) 4800 SB
2885 3473 2800 (          SetEvent\(hServDoneEvent\);) 2800 SB
2885 3656 1360 (          return;) 1360 SB
2885 4022 3040 (      /* Update the service status. */) 3040 SB
2885 4388 3120 (      case SERVICE_CONTROL_INTERROGATE:) 3120 SB
2885 4571 1280 (          break;) 1280 SB
2885 4937 2560 (      /* invalid control code */) 2560 SB
2885 5303 1120 (      default:) 1120 SB
2885 5486 1280 (          break;) 1280 SB
2885 5852 400 (    }) 400 SB
2885 6218 2640 (    /* Send a status response. */) 2640 SB
2885 6584 4480 (    \(VOID\) ReportStatusToSCMgr\(dwState, NO_ERROR, 0, 0\);) 4480 SB
2885 6950 80 (}) 80 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 7399 4492 (58.2.4  Opening an SCManager Database) 4492 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 7780 5680 (The examples in the following sections require an open handle to an SCManager) 5680 SB
2885 7980 5307 (database object. Different operations on a service control manager database) 5307 SB
2885 8180 5337 (require different levels of access, and you should only request the minimum) 5337 SB
2885 8380 4869 (access required. If SC_MANAGER_ALL_ACCESS is requested, the) 4869 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 8577 1313 (OpenSCManager) 1313 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4198 8580 3490 ( function fails if the calling process does not have) 3490 SB
2885 8780 5788 (Administrator privileges. The following example shows how to request full access) 5788 SB
2885 8980 3699 (to the ServicesActive database on the local machine.) 3699 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 9333 3760 (/* Open a handle to the SC Manager database. */) 3760 SB
2885 9699 2320 (schSCManager = OpenSCManager\() 2320 SB
2885 9882 4640 (     NULL,                   /* local machine           */) 4640 SB
2885 10065 4640 (     NULL,                   /* ServicesActive database */) 4640 SB
2885 10248 4640 (     SC_MANAGER_ALL_ACCESS\); /* full access rights      */) 4640 SB
2885 10614 2000 (if \(schSCManager == NULL\)) 2000 SB
2885 10797 2640 (    MyErrorExit\("OpenSCManager"\);) 2640 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 385 def
/wp$fpage (385) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 385 def
/wp$fpage (385) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 20 20
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (386) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1975 2882 (58.2.5  Installing a Service) 2882 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 2356 2945 (A service configuration program uses the ) 2945 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5480 2353 1052 (CreateService) 1052 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6532 2356 1407 ( function to install a) 1407 SB
2535 2556 3585 (service in a service control manager database. The ) 3585 SB
32 0 0 175 175 0 0 0 156 /Times-Italic /font31 ANSIFont font
6120 2556 1083 (schSCManager) 1083 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7203 2556 898 ( handle must) 898 SB
2535 2756 5797 (have SC_MANAGER_CREATE_SERVICE access to the SCManager object. The) 5797 SB
2535 2956 3512 (following example shows how to install a service.) 3512 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 3309 2240 (VOID CreateSampleService\(\) {) 2240 SB
2535 3492 2240 (LPCTSTR lpszBinaryPathName =) 2240 SB
2535 3675 4240 (          TEXT\("%SystemRoot%\\\\system\\\\testserv.exe"\);) 4240 SB
2535 4041 2320 (  schService = CreateService\() 2320 SB
2535 4224 4960 (       schSCManager,              /* SCManager database     */) 4960 SB
2535 4407 4960 (       TEXT\("Sample_Srv"\),        /* name of service        */) 4960 SB
2535 4590 4960 (       SERVICE_ALL_ACCESS,        /* desired access         */) 4960 SB
2535 4773 4960 (       SERVICE_WIN32_OWN_PROCESS, /* service type           */) 4960 SB
2535 4956 4960 (       SERVICE_DEMAND_START,      /* start type             */) 4960 SB
2535 5139 4960 (       SERVICE_ERROR_NORMAL,      /* error control type     */) 4960 SB
2535 5322 4960 (       lpszBinaryPathName,        /* service's binary       */) 4960 SB
2535 5505 4960 (       NULL,                      /* no load ordering group */) 4960 SB
2535 5688 4960 (       NULL,                      /* no tag identifier      */) 4960 SB
2535 5871 4960 (       NULL,                      /* no dependencies        */) 4960 SB
2535 6054 4960 (       NULL,                      /* LocalSystem account    */) 4960 SB
2535 6237 4960 (       NULL\);                     /* no password            */) 4960 SB
2535 6603 2000 (  if \(schService == NULL\)) 2000 SB
2535 6786 2800 (      MyErrorExit\("CreateService"\);) 2800 SB
2535 6969 480 (  else) 480 SB
2535 7152 3200 (      printf\("CreateService SUCCESS\\n"\);) 3200 SB
2535 7518 2640 (  CloseServiceHandle\(schService\);) 2640 SB
2535 7884 80 (}) 80 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 8333 2777 (58.2.6  Deleting a Service) 2777 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 8714 4756 (In the following example, a service configuration program uses the ) 4756 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7291 8711 954 (OpenService) 954 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 8914 5621 (function to get a handle with DELETE access to an installed service object. The) 5621 SB
2535 9114 3558 (program then uses the service object handle in the ) 3558 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
6093 9111 1013 (DeleteService) 1013 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
7106 9114 811 ( function to) 811 SB
2535 9314 4393 (remove the service from the service control manager database.) 4393 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 9667 2240 (VOID DeleteSampleService\(\) {) 2240 SB
2535 10033 2160 (  schService = OpenService\() 2160 SB
2535 10216 4480 (       schSCManager,       /* SCManager database      */) 4480 SB
2535 10399 4480 (       TEXT\("Sample_Srv"\), /* name of service         */) 4480 SB
2535 10582 4480 (       DELETE\);            /* only need DELETE access */) 4480 SB
2535 10948 2000 (  if \(schService == NULL\)) 2000 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 386 def
/wp$fpage (386) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 386 def
/wp$fpage (386) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%Page: 21 21
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (387) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2009 2640 (      MyErrorExit\("OpenService"\);) 2640 SB
2885 2375 2800 (  if \(! DeleteService\(schService\) \)) 2800 SB
2885 2558 2800 (      MyErrorExit\("DeleteService"\);) 2800 SB
2885 2741 480 (  else) 480 SB
2885 2924 3200 (      printf\("DeleteService SUCCESS\\n"\);) 3200 SB
2885 3290 2640 (  CloseServiceHandle\(schService\);) 2640 SB
2885 3656 80 (}) 80 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 4105 4519 (58.2.7  Changing a Service Configuration) 4519 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4486 4712 (In the following example, a service configuration program uses the) 4712 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 4683 1626 (ChangeServiceConfig) 1626 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4511 4686 3816 ( function to change the configuration parameters of an) 3816 SB
2885 4886 5299 (installed service. The program first tries to lock the database, to prevent the) 5299 SB
2885 5086 5764 (service control manager from starting a service while it is being reconfigured. If it) 5764 SB
2885 5286 5710 (successfully locks the database, the program opens a handle to the service object,) 5710 SB
2885 5486 5320 (modifies its configuration, unlocks the database, and then closes the service) 5320 SB
2885 5686 5549 (object handle. If the program does not successfully in lock the database, it uses) 5549 SB
2885 5886 259 (the ) 259 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
3144 5883 1869 (QueryServiceLockStatus) 1869 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5013 5886 3349 ( function to retrieve information about the lock.) 3349 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 6239 3680 (VOID ReconfigureSampleService\(BOOL fDisable\) {) 3680 SB
2885 6605 1280 (SC_LOCK sclLock;) 1280 SB
2885 6788 3040 (LPQUERY_SERVICE_LOCK_STATUS lpqslsBuf;) 3040 SB
2885 6971 2640 (DWORD dwBytesNeeded, dwStartType;) 2640 SB
2885 7337 4720 (  /* Need to acquire database lock before reconfiguring. */) 4720 SB
2885 7703 3680 (  sclLock = LockServiceDatabase\(schSCManager\);) 3680 SB
2885 8069 4880 (  /* If the database cannot be locked, report the details. */) 4880 SB
2885 8435 1920 (  if \(sclLock == NULL\) {) 1920 SB
2885 8801 5280 (      /* Exit if the database is not locked by another process. */) 5280 SB
2885 9167 4640 (      if \(GetLastError\(\) != ERROR_SERVICE_DATABASE_LOCKED\)) 4640 SB
2885 9350 3600 (          MyErrorExit\("LockServiceDatabase"\);) 3600 SB
2885 9716 4800 (      /* Allocate a buffer to get details about the lock. */) 4800 SB
2885 10082 4720 (      lpqslsBuf = \(LPQUERY_SERVICE_LOCK_STATUS\) LocalAlloc\() 4720 SB
2885 10265 4400 (          LPTR, sizeof\(QUERY_SERVICE_LOCK_STATUS\)+256\);) 4400 SB
2885 10448 2240 (      if \(lpqslsBuf == NULL\)) 2240 SB
2885 10631 2880 (          MyErrorExit\("LocalAlloc"\);) 2880 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 387 def
/wp$fpage (387) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 387 def
/wp$fpage (387) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 22 22
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (388) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2535 2009 4320 (      /* Get and print the lock status information. */) 4320 SB
2535 2375 2800 (      if \(! QueryServiceLockStatus\() 2800 SB
2535 2558 1840 (          schSCManager,) 1840 SB
2535 2741 1600 (          lpqslsBuf,) 1600 SB
2535 2924 3840 (          sizeof\(QUERY_SERVICE_LOCK_STATUS\)+256,) 3840 SB
2535 3107 2160 (          &dwBytesNeeded\) \)) 2160 SB
2535 3290 3840 (          MyErrorExit\("QueryServiceLockStatus"\);) 3840 SB
2535 3656 2480 (      if \(lpqslsBuf->fIsLocked\)) 2480 SB
2535 3839 4560 (          printf\("Locked by: %s, duration: %d seconds\\n",) 4560 SB
2535 4022 2960 (              lpqslsBuf->lpLockOwner,) 2960 SB
2535 4205 3280 (              lpqslsBuf->dwLockDuration\);) 3280 SB
2535 4388 800 (      else) 800 SB
2535 4571 3120 (          printf\("No longer locked\\n"\);) 3120 SB
2535 4937 2160 (      LocalFree\(lpqslsBuf\);) 2160 SB
2535 5120 3600 (      MyErrorExit\("Could not lock database"\);) 3600 SB
2535 5303 240 (  }) 240 SB
2535 5669 4960 (  /* The database is locked, so it is safe to make changes. */) 4960 SB
2535 6035 2960 (  /* Open a handle to the service. */) 2960 SB
2535 6401 2160 (  schService = OpenService\() 2160 SB
2535 6584 4400 (       schSCManager,           /* SCManager database */) 4400 SB
2535 6767 4400 (       TEXT\("Sample_Srv"\),     /* name of service    */) 4400 SB
2535 6950 4400 (       SERVICE_CHANGE_CONFIG\); /* need CHANGE access */) 4400 SB
2535 7133 2000 (  if \(schService == NULL\)) 2000 SB
2535 7316 2640 (      MyErrorExit\("OpenService"\);) 2640 SB
2535 7682 3760 (  dwStartType = \(fDisable\) ? SERVICE_DISABLED :) 3760 SB
2535 7865 4000 (                             SERVICE_DEMAND_START;) 4000 SB
2535 8231 2240 (  if \(! ChangeServiceConfig\() 2240 SB
2535 8414 4800 (       schService,        /* handle of service            */) 4800 SB
2535 8597 4800 (       SERVICE_NO_CHANGE, /* service type: no change      */) 4800 SB
2535 8780 4800 (       dwStartType,       /* *change* service start type  */) 4800 SB
2535 8963 4800 (       SERVICE_NO_CHANGE, /* error control: no change     */) 4800 SB
2535 9146 4800 (       NULL,              /* binary path: no change       */) 4800 SB
2535 9329 4800 (       NULL,              /* load order group: no change  */) 4800 SB
2535 9512 4800 (       NULL,              /* tag ID: no change            */) 4800 SB
2535 9695 4800 (       NULL,              /* dependencies: no change      */) 4800 SB
2535 9878 4800 (       NULL,              /* account name: no change      */) 4800 SB
2535 10061 4800 (       NULL\) \)            /* password: no change          */) 4800 SB
2535 10244 3280 (      MyErrorExit\("ChangeServiceConfig"\);) 3280 SB
2535 10427 480 (  else) 480 SB
2535 10610 3680 (      printf\("ChangeServiceConfig SUCCESS\\n"\);) 3680 SB
2535 10976 2720 (  /* Release the database lock. */) 2720 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 388 def
/wp$fpage (388) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 388 def
/wp$fpage (388) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 23 23
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (389) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2192 2640 (  UnlockServiceDatabase\(sclLock\);) 2640 SB
2885 2558 3200 (  /* Close the handle to the service. */) 3200 SB
2885 2924 2640 (  CloseServiceHandle\(schService\);) 2640 SB
2885 3290 80 (}) 80 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 3739 4662 (58.2.8  Querying a Service\222s Configuration) 4662 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4120 4756 (In the following example, a service configuration program uses the ) 4756 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7641 4117 954 (OpenService) 954 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 4320 5741 (function to get a handle with SERVICE_QUERY_CONFIG access to an installed) 5741 SB
2885 4520 4890 (service object. Then the program uses the service object handle in the) 4890 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 4717 1529 (QueryServiceConfig) 1529 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4414 4720 4216 ( function to retrieve the current configuration of the service.) 4216 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2885 5073 2480 (VOID GetSampleServiceConfig\(\) {) 2480 SB
2885 5439 2560 (LPQUERY_SERVICE_CONFIG lpqscBuf;) 2560 SB
2885 5622 1600 (DWORD dwBytesNeeded;) 1600 SB
2885 5988 2960 (  /* Open a handle to the service. */) 2960 SB
2885 6354 2160 (  schService = OpenService\() 2160 SB
2885 6537 4480 (       schSCManager,           /* SCManager database  */) 4480 SB
2885 6720 4480 (       TEXT\("Sample_Srv"\),     /* name of service     */) 4480 SB
2885 6903 4480 (       SERVICE_QUERY_CONFIG\);  /* need QUERY access   */) 4480 SB
2885 7086 2000 (  if \(schService == NULL\)) 2000 SB
2885 7269 2640 (      MyErrorExit\("OpenService"\);) 2640 SB
2885 7635 4800 (  /* Allocate a buffer for the information configuration. */) 4800 SB
2885 8001 3920 (  lpqscBuf = \(LPQUERY_SERVICE_CONFIG\) LocalAlloc\() 3920 SB
2885 8184 4080 (                                       LPTR, 4096\);) 4080 SB
2885 8367 1840 (  if \(lpqscBuf == NULL\)) 1840 SB
2885 8550 2560 (      MyErrorExit\("LocalAlloc"\);) 2560 SB
2885 8916 4160 (  /* Get and print the information configuration. */) 4160 SB
2885 9282 2160 (  if \(! QueryServiceConfig\() 2160 SB
2885 9465 1360 (      schService,) 1360 SB
2885 9648 1200 (      lpqscBuf,) 1200 SB
2885 9831 880 (      4096,) 880 SB
2885 10014 1840 (      &dwBytesNeeded\) \)) 1840 SB
2885 10197 3200 (      MyErrorExit\("QueryServiceConfig"\);) 3200 SB
2885 10563 3440 (  printf\("\\nSample_Srv configuration: \\n"\);) 3440 SB
2885 10746 4160 (  printf\("  Type: 0x%x\\n", lpqscBuf->dwServiceType\);) 4160 SB
2885 10929 4480 (  printf\("  Start Type: 0x%x\\n", lpqscBuf->dwStartType\);) 4480 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 389 def
/wp$fpage (389) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 389 def
/wp$fpage (389) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 24 24
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (390) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2535 2009 4800 (  printf\("  Err Control: 0x%x\\n", lpqscBuf->dwErrorControl\);) 4800 SB
2535 2192 4800 (  printf\("  Binary path: %s\\n", lpqscBuf->lpBinaryPathName\);) 4800 SB
2535 2375 3280 (  if \(lpqscBuf->lpLoadOrderGroup != NULL\)) 3280 SB
2535 2558 3200 (      printf\("  Load order group: %s\\n",) 3200 SB
2535 2741 3600 (                 lpqscBuf->lpLoadOrderGroup\);) 3600 SB
2535 2924 2320 (  if \(lpqscBuf->dwTagId != 0\)) 2320 SB
2535 3107 4000 (      printf\("  Tag ID: %d\\n", lpqscBuf->dwTagId\);) 4000 SB
2535 3290 3120 (  if \(lpqscBuf->lpDependencies != NULL\)) 3120 SB
2535 3473 5040 (      printf\("  Dependencies: %s\\n", lpqscBuf->lpDependencies\);) 5040 SB
2535 3656 3440 (  if \(lpqscBuf->lpServiceStartName != NULL\)) 3440 SB
2535 3839 2720 (      printf\("  Start Name: %s\\n",) 2720 SB
2535 4022 3760 (                 lpqscBuf->lpServiceStartName\);) 3760 SB
2535 4388 1760 (  LocalFree\(lpqscBuf\);) 1760 SB
2535 4754 80 (}) 80 SB
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
1035 5203 2738 (58.2.9  Starting a Service) 2738 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 5584 5642 (To start a service, the following example opens a handle to an installed database) 5642 SB
2535 5784 3116 (and then specifies the handle in a call to the ) 3116 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
5651 5781 925 (StartService) 925 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6576 5784 718 ( function. ) 718 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
7294 5781 925 (StartService) 925 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 5984 5541 (can be used to start either a Win32 service or a driver service, but this example) 5541 SB
2535 6184 5315 (assumes that a Win32 service is being started. After starting the service, the) 5315 SB
2535 6384 2378 (program uses the members of the ) 2378 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4913 6381 1545 (SERVICE_STATUS) 1545 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
6458 6384 1766 ( structure returned by the) 1766 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 6581 1489 (QueryServiceStatus) 1489 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
4024 6584 3658 ( function to track the progress of the Win32 service.) 3658 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 6937 2160 (VOID StartSampleService\(\) {) 2160 SB
2535 7120 1920 (SERVICE_STATUS ssStatus;) 1920 SB
2535 7303 1760 (DWORD dwOldCheckPoint;) 1760 SB
2535 7669 2160 (  schService = OpenService\() 2160 SB
2535 7852 4640 (       schSCManager,          /* S. C. Manager database */) 4640 SB
2535 8035 4640 (       TEXT\("Sample_Srv"\),    /* name of service        */) 4640 SB
2535 8218 2160 (       SERVICE_ALL_ACCESS\);) 2160 SB
2535 8584 4480 (     //  SERVICE_START |        /* need START access  */) 4480 SB
2535 8767 4480 (     //  SERVICE_QUERY_CONFIG\); /* and QUERY access   */) 4480 SB
2535 9133 2000 (  if \(schService == NULL\)) 2000 SB
2535 9316 2640 (      MyErrorExit\("OpenService"\);) 2640 SB
2535 9682 4640 (  if \(! StartService\(schService, /* handle of service   */) 4640 SB
2535 9865 4640 (            0,                   /* number of arguments */) 4640 SB
2535 10048 4640 (            NULL\) \)              /* no arguments        */) 4640 SB
2535 10231 2720 (      MyErrorExit\("StartService"\);) 2720 SB
2535 10414 480 (  else) 480 SB
2535 10597 3200 (      printf\("Service start pending\\n"\);) 3200 SB
2535 10963 4320 (  /* Check the status until the service is running. */) 4320 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 390 def
/wp$fpage (390) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 390 def
/wp$fpage (390) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 25 25
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (391) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2192 2160 (  if \(! QueryServiceStatus\() 2160 SB
2885 2375 3920 (      schService,   /* handle of service       */) 3920 SB
2885 2558 3920 (      &ssStatus\) \)  /* address of status info  */) 3920 SB
2885 2741 3200 (      MyErrorExit\("QueryServiceStatus"\);) 3200 SB
2885 3107 4320 (  while \(ssStatus.dwCurrentState != SERVICE_RUNNING\) {) 4320 SB
2885 3473 3200 (      /* Save the current checkpoint. */) 3200 SB
2885 3839 3680 (      dwOldCheckPoint = ssStatus.dwCheckPoint;) 3680 SB
2885 4205 3520 (      /* Wait for the specified interval. */) 3520 SB
2885 4571 2640 (      Sleep\(ssStatus.dwWaitHint\);) 2640 SB
2885 4937 2800 (      /* Check the status again. */) 2800 SB
2885 5303 2480 (      if \(! QueryServiceStatus\() 2480 SB
2885 5486 4560 (              schService,   /* handle of service       */) 4560 SB
2885 5669 4560 (              &ssStatus\) \)  /* address of status info  */) 4560 SB
2885 5852 1280 (          break;) 1280 SB
2885 6218 4880 (      /* Break if the checkpoint has not been incremented. */) 4880 SB
2885 6584 4080 (      if \(dwOldCheckPoint >= ssStatus.dwCheckPoint\)) 4080 SB
2885 6767 1280 (          break;) 1280 SB
2885 7133 240 (  }) 240 SB
2885 7499 3920 (  if \(ssStatus.dwCurrentState == SERVICE_RUNNING\)) 3920 SB
2885 7682 3120 (      printf\("StartService SUCCESS\\n"\);) 3120 SB
2885 7865 640 (  else {) 640 SB
2885 8048 3360 (      printf\("\\nService not started: \\n"\);) 3360 SB
2885 8231 2960 (      printf\("  Current State: %d\\n",) 2960 SB
2885 8414 3520 (                   ssStatus.dwCurrentState\);) 3520 SB
2885 8597 4800 (      printf\("  Exit Code: %d\\n", ssStatus.dwWin32ExitCode\);) 4800 SB
2885 8780 4000 (      printf\("  Service Specific Exit Code: %d\\n",) 4000 SB
2885 8963 4400 (                   ssStatus.dwServiceSpecificExitCode\);) 4400 SB
2885 9146 4720 (      printf\("  Check Point: %d\\n", ssStatus.dwCheckPoint\);) 4720 SB
2885 9329 4400 (      printf\("  Wait Hint: %d\\n", ssStatus.dwWaitHint\);) 4400 SB
2885 9512 240 (  }) 240 SB
2885 9878 2640 (  CloseServiceHandle\(schService\);) 2640 SB
2885 10244 80 (}) 80 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 391 def
/wp$fpage (391) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 391 def
/wp$fpage (391) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Roman
%%Page: 26 26
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (392) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 283 283 0 0 0 264 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1975 5190 (58.2.10  Sending Control Requests to a Service) 5190 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2535 2356 2288 (The following example uses the ) 2288 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4823 2353 1130 (ControlService) 1130 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5953 2356 2217 ( function to send a control code) 2217 SB
2535 2556 5613 (to a running service. Different control codes require different levels of access to) 5613 SB
2535 2756 4655 (the service object. For example, a service object handle must have) 4655 SB
2535 2956 5626 (SERVICE_STOP access to send the SERVICE_CONTROL_STOP code. When) 5626 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2535 3153 1130 (ControlService) 1130 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
3665 3156 741 ( returns, a ) 741 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
4406 3153 1545 (SERVICE_STATUS) 1545 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
5951 3156 1962 ( structure contains the latest) 1962 SB
2535 3356 2365 (status information for the service.) 2365 SB
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
2535 3709 3600 (VOID ControlSampleService\(DWORD fdwControl\) {) 3600 SB
2535 4075 1920 (SERVICE_STATUS ssStatus;) 1920 SB
2535 4258 1280 (DWORD fdwAccess;) 1280 SB
2535 4624 5280 (  /* The required service object access depends on the control. */) 5280 SB
2535 4990 1840 (  switch \(fdwControl\) {) 1840 SB
2535 5173 2560 (      case SERVICE_CONTROL_STOP:) 2560 SB
2535 5356 2800 (          fdwAccess = SERVICE_STOP;) 2800 SB
2535 5539 1280 (          break;) 1280 SB
2535 5905 2640 (      case SERVICE_CONTROL_PAUSE:) 2640 SB
2535 6088 2880 (      case SERVICE_CONTROL_CONTINUE:) 2880 SB
2535 6271 3600 (          fdwAccess = SERVICE_PAUSE_CONTINUE;) 3600 SB
2535 6454 1280 (          break;) 1280 SB
2535 6820 3120 (      case SERVICE_CONTROL_INTERROGATE:) 3120 SB
2535 7003 3360 (          fdwAccess = SERVICE_INTERROGATE;) 3360 SB
2535 7186 1280 (          break;) 1280 SB
2535 7552 1120 (      default:) 1120 SB
2535 7735 3360 (          fdwAccess = SERVICE_INTERROGATE;) 3360 SB
2535 7918 240 (  }) 240 SB
2535 8284 2960 (  /* Open a handle to the service. */) 2960 SB
2535 8650 2160 (  schService = OpenService\() 2160 SB
2535 8833 4160 (       schSCManager,        /* SCManager database */) 4160 SB
2535 9016 4160 (       TEXT\("Sample_Srv"\),  /* name of service    */) 4160 SB
2535 9199 4160 (       fdwAccess\);          /* specify access     */) 4160 SB
2535 9382 2000 (  if \(schService == NULL\)) 2000 SB
2535 9565 2640 (      MyErrorExit\("OpenService"\);) 2640 SB
2535 9931 3440 (  /* Send a control code to the service. */) 3440 SB
2535 10297 1840 (  if \(! ControlService\() 1840 SB
2535 10480 3920 (      schService,   /* handle of service       */) 3920 SB
2535 10663 3920 (      fdwControl,   /* control code to send    */) 3920 SB
2535 10846 3920 (      &ssStatus\) \)  /* address of status info  */) 3920 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 392 def
/wp$fpage (392) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 392 def
/wp$fpage (392) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 27 27
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
6618 1517 1345 (Chapter 58    Services) 1345 SB
7963 1517 36 ( ) 253 SB
8216 1517 36 ( ) 253 SB
8469 1517 216 (393) 216 SB
0 0 0 fC
/fm 256 def
7299 11 1385 1741 B
1 F
n
32 0 0 133 133 0 0 0 123 /LetrGothicMS /font35 ANSIFont font
0 0 0 fC
2885 2009 2880 (      MyErrorExit\("ControlService"\);) 2880 SB
2885 2375 2640 (  /* Print the service status. */) 2640 SB
2885 2741 3120 (  printf\("\\nStatus of Sample_Srv: \\n"\);) 3120 SB
2885 2924 4720 (  printf\("  Service Type: 0x%x\\n", ssStatus.dwServiceType\);) 4720 SB
2885 3107 4880 (  printf\("  Current State: 0x%x\\n", ssStatus.dwCurrentState\);) 4880 SB
2885 3290 3120 (  printf\("  Controls Accepted: 0x%x\\n",) 3120 SB
2885 3473 3520 (               ssStatus.dwControlsAccepted\);) 3520 SB
2885 3656 4480 (  printf\("  Exit Code: %d\\n", ssStatus.dwWin32ExitCode\);) 4480 SB
2885 3839 3680 (  printf\("  Service Specific Exit Code: %d\\n",) 3680 SB
2885 4022 4080 (               ssStatus.dwServiceSpecificExitCode\);) 4080 SB
2885 4205 4400 (  printf\("  Check Point: %d\\n", ssStatus.dwCheckPoint\);) 4400 SB
2885 4388 4080 (  printf\("  Wait Hint: %d\\n", ssStatus.dwWaitHint\);) 4080 SB
2885 4754 720 (  return;) 720 SB
2885 4937 80 (}) 80 SB
32 0 0 333 333 0 0 0 311 /Helvetica-Narrow-Bold /font16 ANSIFont font
1385 5429 1990 (58.3  Functions) 1990 SB
32 0 0 175 175 0 0 0 156 /Times-Roman /font32 ANSIFont font
2885 5884 5727 (Following are the Win32 functions used by services and by programs that control) 5727 SB
2885 6084 1521 (or configure services:) 1521 SB
32 0 0 175 175 0 0 0 159 /Times-Bold /font29 ANSIFont font
2885 6414 1626 (ChangeServiceConfig) 1626 SB
2885 6614 1500 (CloseServiceHandle) 1500 SB
2885 6814 1130 (ControlService) 1130 SB
2885 7014 1052 (CreateService) 1052 SB
2885 7214 1013 (DeleteService) 1013 SB
2885 7414 1877 (EnumDependentServices) 1877 SB
2885 7614 1537 (EnumServicesStatus) 1537 SB
2885 7814 623 (Handler) 623 SB
2885 8014 1617 (LockServiceDatabase) 1617 SB
2885 8214 1313 (OpenSCManager) 1313 SB
2885 8414 954 (OpenService) 954 SB
2885 8614 1529 (QueryServiceConfig) 1529 SB
2885 8814 1869 (QueryServiceLockStatus) 1869 SB
2885 9014 2151 (QueryServiceObjectSecurity) 2151 SB
2885 9214 1489 (QueryServiceStatus) 1489 SB
2885 9414 2103 (RegisterServiceCtrlHandler) 2103 SB
2885 9614 945 (ServiceMain) 945 SB
2885 9814 1907 (SetServiceObjectSecurity) 1907 SB
2885 10014 1245 (SetServiceStatus) 1245 SB
2885 10214 925 (StartService) 925 SB
2885 10414 2053 (StartServiceCtrlDispatcher) 2053 SB
2885 10614 1772 (UnlockServiceDatabase) 1772 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 393 def
/wp$fpage (393) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 188 def
/wp$right 76 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 393 def
/wp$fpage (393) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font Times-Bold
%%+ font Times-Roman
%%Page: 28 28
%%PageResources: (atend)
SS
0 0 20 11 809 1100 1200 SM
32 0 0 158 158 0 0 0 147 /Helvetica-Narrow-Bold /font16 ANSIFont font
0 0 0 fC
1035 1517 216 (394) 216 SB
1251 1517 36 ( ) 244 SB
1495 1517 36 ( ) 244 SB
1739 1517 3364 (    Microsoft Win32 Programmer\222s Reference, Volume 2) 3364 SB
0 0 0 fC
/fm 256 def
7299 11 1035 1741 B
1 F
n
32 0 0 250 250 1 0 0 232 /Helvetica-Bold /font13 ANSIFont font
0 0 0 fC
4607 2326 1655 (BLANK PAGE) 1655 SB
32 0 0 250 250 0 0 0 232 /Helvetica-Bold /font13 ANSIFont font
2535 3020 5344 (IMPORTANT: This text will appear on screen,) 5344 SB
2535 3314 4772 (but will not print on a PostScript printer.) 4772 SB
2535 3741 5411 (This page should be the last one in this file; it) 5411 SB
2535 4035 5346 (was inserted by running the InsertBlankPage) 5346 SB
2535 4329 819 (macro.) 819 SB
2535 4756 5261 (Do not type any additional text on this page!) 5261 SB
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 394 def
/wp$fpage (394) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def
1 setgray 41.5 73 moveto 0 646 rlineto 529 0 rlineto 0 646 neg rlineto closepath fill
 grestore
gsave
initgraphics
/wp$xorig 0 def
/wp$yorig 0 def
/wp$y 792 def
/wp$x 612 def
/wp$page 394 def
/wp$fpage (394) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$top 127 def
/wp$bottom 115 def
/wp$left 167 def
/wp$right 97 def
/wp$col 1 def
/wp$colx 348 def
/wp$colxb 0 def

/ndf{1 index where{pop pop pop}{dup xcheck{bind}if def} ifelse}bd
/SetPageOffset{neg wp$y add/dTop ed/dLeft ed}ndf
/SetPageSize {neg dTop add/dBot ed dLeft add/dRight ed}ndf
/DoCropMarks{gs 0 setgray /dopaint true def 0.25 sl
  dLeft 76 sub dTop M 72 0 rlt dLeft 76 sub dBot M 72 0 rlt
  dRight 4 add dTop M 72 0 rlt dRight 4 add dBot M 72 0 rlt
  dLeft dTop 76 add M 0 -72 rlt dRight dTop 76 add M 0 -72 rlt
  dLeft dBot 4 sub M 0 -72 rlt dRight dBot 4 sub M 0 -72 rlt
  stroke gr}ndf
/DoPageBox {gs 0 setgray /dopaint true def 0.25 sl
  dLeft dTop M dRight dTop L dRight dBot L dLeft dBot L
  cp stroke gr}ndf
40.5 72 SetPageOffset
531 648 SetPageSize
DoCropMarks
DoPageBox
 grestore
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1426 12144 354 (Filename: ) 354 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1780 12144 21 ( ) 21 SB
gr
32 0 0 83 83 0 0 0 74 /Times-Roman /font32 ANSIFont font
gs 5800 351 1426 12120 CB
1801 12144 542 (SERVICE.DOC) 542 SB
gr
gs 5800 351 1426 12120 CB
2343 12144 1006 (     Project: c:\\win32\\ovrviews) 1006 SB
gr
gs 5800 351 1426 12120 CB
3478 12144 201 (Date: ) 201 SB
gr
gs 5800 351 1426 12120 CB
3679 12144 298 (05/05/93) 298 SB
gr
gs 5800 351 1426 12120 CB
3977 12144 262 (  Time: ) 262 SB
gr
gs 5800 351 1426 12120 CB
4239 12144 191 (16:37) 191 SB
gr
gs 5800 351 1426 12120 CB
1426 12261 281 (Author: ) 281 SB
gr
gs 5800 351 1426 12120 CB
1707 12261 196 (bobbr) 196 SB
gr
gsave
initgraphics
98 36 translate
/wp$xorig 98 def
/wp$yorig 36 def
/wp$y 21 def
/wp$x 351 def
/wp$page 394 def
/wp$fpage (394) def
/wp$date (05/05/93) def
/wp$time (16:38) def
/wp$box { newpath 0 0 moveto wp$x 0 rlineto 0 wp$y rlineto wp$x neg 0 rlineto closepath } def
wp$box clip newpath
/wp$style (footer) def
/wp$top 0 def
/wp$bottom 0 def
/wp$left 0 def
/wp$first 0 def
/wp$right 0 def

0 setgray /dopaint true def 2 2 moveto
/str 30 string def /Times-Roman findfont 5 scalefont setfont
(Printed On: ) show statusdict begin product show end 
(     Colorlayer: ) show /colorlayer where {pop colorlayer str cvs show}{(?) show}ifelse 
(     Document Page: ) show wp$fpage show
 grestore
1 #C
statusdict begin /manualfeed false store end
EJ RS
%%PageTrailer
%%PageResources: font Helvetica-Bold
%%+ font Helvetica-Narrow-Bold
%%+ font Times-Roman
%%Trailer
SVDoc restore
end
%%Pages: 28
% TrueType font name key:
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT310000 = 
%    MSTT31c2a1 = 0ae7DArial NarrowF00000000000002bc0000
%    MSTT31c2ad = 0ae7DTimes New RomanF00000064000001900000
%    MSTT31c2ba = 0ae7DTimes New RomanF00000000000001900000
%    MSTT31c2c7 = 0ae7DTimes New RomanF00000053000001900000
%    MSTT31c2d4 = 0ae7DTimes New RomanF00000000000002bc0000
%    MSTT31c2e1 = 0ae7DTimes New RomanF00000043000001900000
%    MSTT31c2ee = 0ae7DArialF00000000000002bc0000
%    MSTT31c2f9 = 0ae7DTimes New RomanF00000000000001900001
%    MSTT31c306 = 0ae7DLucida Sans TypewriterF00000000000001900000
%%DocumentSuppliedResources: procset Win35Dict 3 1

%%DocumentNeededResources: font Helvetica-Bold
%%+ font Helvetica-Narrow-Bold
%%+ font LetrGothicMS
%%+ font MSIcons
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman

%%EOF
