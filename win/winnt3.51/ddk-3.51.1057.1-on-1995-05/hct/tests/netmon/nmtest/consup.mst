'******************************************************************************
'
' Microsoft Test Smart Event(tm) Recording.
'
'              Date:  Saturday, July 09, 1994
'              Time:  4:09:39 PM
'
'     String Length:  60
'   Pause threshold:  2000
'     Ordinals Only:  NO
'
'******************************************************************************
'$INCLUDE 'DECLARES.INC'

'$IFNDEF REC_VARS_DEFINED
'$DEFINE REC_VARS_DEFINED
Macro TimeVal(t) = t

Dim CurrentWindow       As Long,  _
    ChildCurrentWindow  As Long,  _
    ResDeltaX           As Long,  _
    ResDeltaY           As Long,  _
    Timeout             As Short
'$ENDIF

Timeout = 5

' Check the resolution that this script was recorded on.
'------------------------------------------------------------------------------
ResDeltaX = 640     'Screen width, inserted by recorder.
ResDeltaY = 480     'Screen height, inserted by recorder.
If CheckResolution (ResDeltaX, ResDeltaY) = FALSE Then End

'Make sure this script does not try to playback to its own instance of MT.EXE
'------------------------------------------------------------------------------
If GetHandle (GH_HWNDCLIENT) Then WMinWnd GetHandle (GH_HWNDCLIENT)
'******************************************************************************
'       This is where I start the loop counter




'           Try to turn on viewport

    VIEWPORT ON
    VIEWPORT CLEAR

Counter% = 0
Top:

counter% = counter% + 1
     Print   "Loop Count ="+ STR$(counter%)
CurrentWindow = WFndWndWaitC ("Network Monitor", "BH_MainWndClass", FINDWINDOWFLAGS, Timeout)
WSetWndPosSiz CurrentWindow, 22, 21, 614, 387
QueKeys "%(c)n"
QueKeys "4{Enter}"
QueFlush FALSE

CurrentWindow = WFndWndWaitC ("Connect To Network Monitoring Agent", "#32770", FINDWINDOWFLAGS, Timeout)
WSetWndPosSiz CurrentWindow, 30, 133, 579, 213
QueKeyUp "c%"
QueKeys "BH_do{NUMPAD4}{NUMPAD8}{NUMPAD6}"
QueKeyDn "{ENTER}"
QueFlush FALSE

CurrentWindow = WFndWndWaitC ("Reconnected", "#32770", FINDWINDOWFLAGS, Timeout)
WSetWndPosSiz CurrentWindow, 152, 132, 354, 164
QueKeyUp "{ENTER}"
QuePause TimeVal(2463)
QueKeyDn "{ENTER}"
QueFlush FALSE

CurrentWindow = WFndWndWaitC ("Network Monitor", "BH_MainWndClass", FINDWINDOWFLAGS, Timeout)
WSetWndPosSiz CurrentWindow, 22, 21, 614, 387
QueKeyUp "{ENTER}"
QuePause TimeVal(5137)
QueFlush FALSE
Sleep (5)


CurrentWindow = WFndWndWaitC ("Network Monitor", "BH_MainWndClass", FINDWINDOWFLAGS, Timeout)
WSetWndPosSiz CurrentWindow, 22, 21, 614, 387
QueKeys "%(c)n"
QueKeys "s"
QueKeys "%(s)"
QueKeys "{UP}{UP}{UP}{ENTER}"
QueFlush FALSE


GOTO Top