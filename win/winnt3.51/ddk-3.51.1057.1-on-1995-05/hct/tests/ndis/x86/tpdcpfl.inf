***********************************************************************
;
; TPDCPFL.INF
;
;       Goes with the setup file for the Ndiswan Test Tool
;
; Modification History:
;
;    01-26-95 Sanjay Anand  Created
;
; NOTE:  Please don't randomly change the order of the program or the
;        function calls (Shell commands).  A lot depends on the order
;        in which the functions are called.
;
;    04-27-95 Sanjay Anand
;        Removed references to tag files in the source media descriptions
;        since we cannot sync the names of files on the NT and DDK disks
;        that ship.
;-----------------------------------------------------------------------


[CopyFiles]
    set !STF_SRCDIR_OVERRIDE = ""
    set SourceDir = $($0)
    Debug-Output "In tpdfilecopy"

    Shell $(!UtilityInf), DoAskSource, $(!STF_CWDDIR), $(SourceDir) NO

    Debug-Output "Reached"$($ShellCode)

    Ifint $($ShellCode) != $(!SHELL_CODE_OK)
        goto ShellCodeError
    Else-Ifstr(i) $($R0) == STATUS_FAILED
        Shell $(UtilityInf) RegistryErrorString "ASK_SOURCE_FAIL"
        ifint $($ShellCode) != $(!SHELL_CODE_OK)
        goto ShellCodeError
        endif
        set Error = $($R0)
        goto fatal
    Else-Ifstr(i) $($R0) == STATUS_USERCANCEL
         Goto end
    Endif

    Set !STF_SRCDIR = $($R1)
    Set SourceDir  = $($R1)

    Debug-Output  "In SysCopyFiles"$(SourceDir)$(!STF_WINDOWSSYSPATH)

    set STF_VITAL = ""

    install OtherFiles

    Debug-Output  "Done Copying Files"
    Set Status = STATUS_SUCCESSFUL
    goto end

fatal =+
ShellCodeError =+
    Set Status = STATUS_FAILED

end =+
    return $(Status)

[Source Media Descriptions]
    1 = "Test Protocol Driver Disk #1" ;, TAGFILE = testp.1
    2 = "Test Protocol Driver Disk #2" ;, TAGFILE = abc


[OtherFiles]
debug-output $(SourceDir)

    AddSectionFilesToCopyList Files-Driver $(SourceDir) +
                 $(!STF_WINDOWSSYSPATH)\drivers

dumpcopylist
    set !STF_NCPA_FLUSH_COPYLIST = TRUE  ; ZZ

debug-output "copy file"
    CopyFilesInCopyList
debug-output "after copy file"
    exit

[Files-Driver]
2, NDISTAPI.SYS , SIZE=999
2, NDISWAN.SYS , SIZE=999

