<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="MultiVMR9_and_AP_files/filelist.xml">
<link rel=Edit-Time-Data href="MultiVMR9_and_AP_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>VMR9Multi</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>a-denevs</o:Author>
  <o:LastAuthor>a-denevs</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>293</o:TotalTime>
  <o:LastPrinted>2002-09-04T22:23:00Z</o:LastPrinted>
  <o:Created>2002-09-04T22:49:00Z</o:Created>
  <o:LastSaved>2002-09-07T01:21:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>2888</o:Words>
  <o:Characters>16467</o:Characters>
  <o:Company>Microsoft Corporation</o:Company>
  <o:Lines>137</o:Lines>
  <o:Paragraphs>38</o:Paragraphs>
  <o:CharactersWithSpaces>19317</o:CharactersWithSpaces>
  <o:Version>10.3501</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="64" DLLVersion="131077"
   NLCheck="1">1</w:ActiveWritingStyle>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="64" DLLVersion="131078"
   NLCheck="1">1</w:ActiveWritingStyle>
  <w:GrammarState>Clean</w:GrammarState>
  <w:DrawingGridHorizontalSpacing>4.3 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>4.3 pt</w:DrawingGridVerticalSpacing>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-update:auto;
	mso-style-parent:"";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
h1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:24.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Times New Roman";
	mso-bidi-font-family:Arial;
	mso-font-kerning:16.0pt;
	font-weight:bold;}
h2
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:20.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman";
	mso-bidi-font-family:Arial;
	font-weight:bold;
	mso-bidi-font-style:italic;}
h3
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:18.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:"Times New Roman";
	mso-bidi-font-family:Arial;
	font-weight:bold;}
h4
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
p.MsoListNumber, li.MsoListNumber, div.MsoListNumber
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l0 level1 lfo3;
	tab-stops:list .25in;
	font-size:11.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
code
	{font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
kbd
	{mso-ansi-font-size:11.0pt;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
pre
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
span.PlainTextChar1
	{mso-style-name:"Plain Text Char1\,Plain Text Char Char\,Plain Text Char1 Char Char\,Plain Text Char Char Char Char\,Plain Text Char1 Char1 Char Char Char\,Plain Text Char Char Char1 Char Char Char\,Plain Text Char1 Char Char Char Char Char\,Plain Text Char1 Char1";
	mso-style-link:"Plain Text\,Plain Text Char\,Plain Text Char1 Char\,Plain Text Char Char Char\,Plain Text Char1 Char1 Char Char\,Plain Text Char Char Char1 Char Char\,Plain Text Char1 Char Char Char Char\,Plain Text Char Char Char Char Char Char\,Plain Text Char1";
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-ansi-language:EN-US;
	mso-fareast-language:EN-US;
	mso-bidi-language:AR-SA;}
p.PlainText, li.PlainText, div.PlainText
	{mso-style-name:"Plain Text\,Plain Text Char\,Plain Text Char1 Char\,Plain Text Char Char Char\,Plain Text Char1 Char1 Char Char\,Plain Text Char Char Char1 Char Char\,Plain Text Char1 Char Char Char Char\,Plain Text Char Char Char Char Char Char\,Plain Text Char1";
	mso-style-link:"Plain Text Char1\,Plain Text Char Char\,Plain Text Char1 Char Char\,Plain Text Char Char Char Char\,Plain Text Char1 Char1 Char Char Char\,Plain Text Char Char Char1 Char Char Char\,Plain Text Char1 Char Char Char Char Char\,Plain Text Char1 Char1";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p.Methodheader, li.Methodheader, div.Methodheader
	{mso-style-name:"Method header";
	mso-style-parent:"Heading 2";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.5in;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-list:l1 level1 lfo5;
	tab-stops:list .5in;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Arial;
	font-weight:bold;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.Interfaceheader, li.Interfaceheader, div.Interfaceheader
	{mso-style-name:"Interface header";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:16.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Arial;
	mso-ascii-font-family:Arial;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:Arial;
	mso-ansi-language:EN-US;
	mso-fareast-language:EN-US;
	mso-bidi-language:AR-SA;
	font-weight:bold;
	font-style:italic;}
span.API
	{mso-style-name:API;
	mso-style-parent:"HTML Code";
	mso-ansi-font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Trebuchet MS";
	mso-ascii-font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Trebuchet MS";
	mso-bidi-font-family:"Courier New";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.PlainText0, li.PlainText0, div.PlainText0
	{mso-style-name:"Plain Text\,Plain Text Char\,Plain Text Char1 Char\,Plain Text Char Char Char\,Plain Text Char1 Char1 Char Char\,Plain Text Char Char Char1 Char Char\,Plain Text Char1 Char Char Char Char\,Plain Text Char Char Char Char Char Char\,Plain Text Char1";
	mso-style-parent:"Default Paragraph Font";
	mso-style-link:"Plain Text Char1\,Plain Text Char Char\,Plain Text Char1 Char Char\,Plain Text Char Char Char Char\,Plain Text Char1 Char1 Char Char Char\,Plain Text Char Char Char1 Char Char Char\,Plain Text Char1 Char Char Char Char Char\,Plain Text Char1 Char1";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
span.PlainTextCharChar1
	{mso-style-name:"Plain Text Char Char1";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-ansi-language:EN-US;
	mso-fareast-language:EN-US;
	mso-bidi-language:AR-SA;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:.7in .6in .7in .6in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:-120;
	mso-list-type:simple;
	mso-list-template-ids:-1908897130;}
@list l0:level1
	{mso-level-style-link:"List Number";
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l1
	{mso-list-id:61175212;
	mso-list-type:hybrid;
	mso-list-template-ids:-2064089872 -1914684544 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"Method header";
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:265505719;
	mso-list-template-ids:-515442184;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3
	{mso-list-id:373506796;
	mso-list-type:hybrid;
	mso-list-template-ids:1156505600 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:407579977;
	mso-list-template-ids:335192764;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l5
	{mso-list-id:562913755;
	mso-list-template-ids:67698719;
	mso-list-style-name:"1 \/ 1\.1 \/ 1\.1\.1";}
@list l5:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l5:level2
	{mso-level-text:"%1\.%2\.";
	mso-level-tab-stop:.55in;
	mso-level-number-position:left;
	margin-left:.55in;
	text-indent:-.3in;}
@list l5:level3
	{mso-level-text:"%1\.%2\.%3\.";
	mso-level-tab-stop:.85in;
	mso-level-number-position:left;
	margin-left:.85in;
	text-indent:-.35in;}
@list l5:level4
	{mso-level-text:"%1\.%2\.%3\.%4\.";
	mso-level-tab-stop:1.2in;
	mso-level-number-position:left;
	margin-left:1.2in;
	text-indent:-.45in;}
@list l5:level5
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.";
	mso-level-tab-stop:1.55in;
	mso-level-number-position:left;
	margin-left:1.55in;
	text-indent:-.55in;}
@list l5:level6
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.";
	mso-level-tab-stop:1.9in;
	mso-level-number-position:left;
	margin-left:1.9in;
	text-indent:-.65in;}
@list l5:level7
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.";
	mso-level-tab-stop:2.25in;
	mso-level-number-position:left;
	margin-left:2.25in;
	text-indent:-.75in;}
@list l5:level8
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.";
	mso-level-tab-stop:2.6in;
	mso-level-number-position:left;
	margin-left:2.6in;
	text-indent:-.85in;}
@list l5:level9
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9\.";
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	margin-left:3.0in;
	text-indent:-1.0in;}
@list l6
	{mso-list-id:623002011;
	mso-list-template-ids:695607866;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l7
	{mso-list-id:931594823;
	mso-list-type:hybrid;
	mso-list-template-ids:619503048 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8
	{mso-list-id:1121924486;
	mso-list-template-ids:67698719;}
@list l8:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l8:level2
	{mso-level-text:"%1\.%2\.";
	mso-level-tab-stop:.55in;
	mso-level-number-position:left;
	margin-left:.55in;
	text-indent:-.3in;}
@list l8:level3
	{mso-level-text:"%1\.%2\.%3\.";
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:.85in;
	text-indent:-.35in;}
@list l8:level4
	{mso-level-text:"%1\.%2\.%3\.%4\.";
	mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.2in;
	text-indent:-.45in;}
@list l8:level5
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.";
	mso-level-tab-stop:1.75in;
	mso-level-number-position:left;
	margin-left:1.55in;
	text-indent:-.55in;}
@list l8:level6
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.";
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	margin-left:1.9in;
	text-indent:-.65in;}
@list l8:level7
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.";
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	margin-left:2.25in;
	text-indent:-.75in;}
@list l8:level8
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.";
	mso-level-tab-stop:2.75in;
	mso-level-number-position:left;
	margin-left:2.6in;
	text-indent:-.85in;}
@list l8:level9
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9\.";
	mso-level-tab-stop:3.25in;
	mso-level-number-position:left;
	margin-left:3.0in;
	text-indent:-1.0in;}
@list l9
	{mso-list-id:1169834371;
	mso-list-type:hybrid;
	mso-list-template-ids:-114029508 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l9:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l9:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10
	{mso-list-id:1443303743;
	mso-list-type:hybrid;
	mso-list-template-ids:-1599852122 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l10:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l10:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l11
	{mso-list-id:1717705093;
	mso-list-type:hybrid;
	mso-list-template-ids:-1735763668 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l11:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l11:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l11:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l11:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l11:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l11:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l11:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l11:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l11:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l12
	{mso-list-id:1759209739;
	mso-list-template-ids:960239784;}
@list l12:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin-top:3.0pt;
	mso-para-margin-right:0in;
	mso-para-margin-bottom:3.0pt;
	mso-para-margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="3074" fillcolor="white">
  <v:fill color="white"/>
  <o:colormru v:ext="edit" colors="#eaeaea"/>
  <o:colormenu v:ext="edit" fillcolor="none" strokecolor="black"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
  <o:rules v:ext="edit">
   <o:r id="V:Rule2" type="connector" idref="#_x0000_s1226">
    <o:proxy start="" idref="#_x0000_s1224" connectloc="1"/>
    <o:proxy end="" idref="#_x0000_s1222" connectloc="0"/>
   </o:r>
  </o:rules>
  <o:regrouptable v:ext="edit">
   <o:entry new="1" old="0"/>
   <o:entry new="2" old="0"/>
   <o:entry new="3" old="0"/>
   <o:entry new="4" old="0"/>
   <o:entry new="5" old="0"/>
   <o:entry new="6" old="0"/>
  </o:regrouptable>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1>Using Video Mixing Renderer 9 with Multiple Filter Graphs</h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2>1. What Is New</h2>

<p class=MsoNormal style='text-indent:.5in'>VMR7 contains all the necessary
functionality to manage several filter graphs; this task can be accomplished by
providing VMR7 with custom allocator-presenter (as shown in sample VMRMulti,
see <kbd>Samples\cpp\DirectShow\VMR\VMRMulti</kbd>). However, introduction of
VMR9 essentially simplifies this task:</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l7 level1 lfo8;tab-stops:list .5in'>In
     VMR7, developers had bad times with surface allocation, while VMR9
     introduces helper function <span class=API>IVMRSurfaceAllocatorNotify9::AllocateSurfaceHelper</span>,
     so that allocated surface is compatible both with VMR9 and client
     application preferences</li>
 <li class=MsoNormal style='mso-list:l7 level1 lfo8;tab-stops:list .5in'>Since
     VMR9 is based on DirectX 9, there is nothing special to be done to put
     video in the DirectDraw exclusive mode: client application just gives VMR9
     properly initialized Direct3D9 device.</li>
</ul>

<h2>2. Using Custom Allocator-Presenter to Manage Several Filter Graphs</h2>

<h3>2.1. Developing Custom Allocator-Presenter for VMR9</h3>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'>Development of custom (user
provided) Allocator-Presenter for the renderer has not changed much since VMR7,
but there are several differences. Below is the “how to” scenario, it is
implemented in the sample VMR9Allocator (See <kbd>Samples\cpp\DirectShow\VMR9\VMR9Allocator</kbd>).
First, developer of the client application has to implement custom
allocator-presenter (A/P), an object derived from <span class=API>IVMRSurfaceAllocator9</span>
and <span class=API>IVMRImagePresenter9</span>. See DirectX 9.0 SDK help for
more information on custom allocator-presenter (see “<span class=MsoHyperlink>Supplying
a Custom Allocator-Presenter for VMR9</span>”). Figure 1 shows relationship
between VMR9 filter and its Allocator-Presenter.</p>

<p class=MsoNormal style='text-indent:.5in'><!--[if mso & !supportInlineShapes & supportFields]><span
style='mso-element:field-begin;mso-field-lock:yes'></span><span
style='mso-spacerun:yes'> </span>SHAPE <span
style='mso-spacerun:yes'> </span>\* MERGEFORMAT <span style='mso-element:field-separator'></span><![endif]--><!--[if gte vml 1]><v:group
 id="_x0000_s1239" editas="canvas" style='width:395.6pt;height:176.3pt;
 mso-position-horizontal-relative:char;mso-position-vertical-relative:line'
 coordorigin="1011,1077" coordsize="7912,3526">
 <o:lock v:ext="edit" aspectratio="t"/>
 <v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75"
  o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
  <v:stroke joinstyle="miter"/>
  <v:formulas>
   <v:f eqn="if lineDrawn pixelLineWidth 0"/>
   <v:f eqn="sum @0 1 0"/>
   <v:f eqn="sum 0 0 @1"/>
   <v:f eqn="prod @2 1 2"/>
   <v:f eqn="prod @3 21600 pixelWidth"/>
   <v:f eqn="prod @3 21600 pixelHeight"/>
   <v:f eqn="sum @0 0 1"/>
   <v:f eqn="prod @6 1 2"/>
   <v:f eqn="prod @7 21600 pixelWidth"/>
   <v:f eqn="sum @8 21600 0"/>
   <v:f eqn="prod @7 21600 pixelHeight"/>
   <v:f eqn="sum @10 21600 0"/>
  </v:formulas>
  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
  <o:lock v:ext="edit" aspectratio="t"/>
 </v:shapetype><v:shape id="_x0000_s1240" type="#_x0000_t75" style='position:absolute;
  left:1011;top:1077;width:7912;height:3526' o:preferrelative="f">
  <v:fill o:detectmouseclick="t"/>
  <v:path o:extrusionok="t" o:connecttype="none"/>
 </v:shape><v:group id="_x0000_s1241" style='position:absolute;left:1441;top:1335;
  width:7482;height:2883' coordorigin="1441,1335" coordsize="7482,2883">
  <v:shape id="_x0000_s1242" style='position:absolute;left:2511;top:2419;
   width:1980;height:1799' coordsize="1980,1800" path="m1980,1800l,1800,,,540,r,900l1980,900r,900xe">
   <v:path arrowok="t"/>
  </v:shape><v:rect id="_x0000_s1243" style='position:absolute;left:3231;top:1335;
   width:1439;height:721'>
   <v:textbox style='mso-next-textbox:#_x0000_s1243'>
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=MsoNormal><span style='mso-spacerun:yes'>     </span>A/P</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:rect><v:line id="_x0000_s1244" style='position:absolute' from="3591,2023"
   to="3592,2778">
   <v:stroke endarrow="oval"/>
  </v:line><v:line id="_x0000_s1245" style='position:absolute' from="4279,2023"
   to="4280,2797">
   <v:stroke endarrow="oval"/>
  </v:line><v:line id="_x0000_s1246" style='position:absolute;flip:x y' from="3935,2797"
   to="3936,3313">
   <v:stroke endarrow="oval"/>
  </v:line><v:group id="_x0000_s1247" style='position:absolute;left:1441;top:3133;
   width:1076;height:94' coordorigin="1551,6256" coordsize="1076,94">
   <v:line id="_x0000_s1248" style='position:absolute' from="1551,6300" to="2451,6301">
    <v:stroke endarrow="block"/>
   </v:line><v:rect id="_x0000_s1249" style='position:absolute;left:2448;top:6256;
    width:179;height:94'/>
  </v:group><v:group id="_x0000_s1250" style='position:absolute;left:1441;
   top:3915;width:1076;height:94' coordorigin="1551,6256" coordsize="1076,94">
   <v:line id="_x0000_s1251" style='position:absolute' from="1551,6300" to="2451,6301">
    <v:stroke endarrow="block"/>
   </v:line><v:rect id="_x0000_s1252" style='position:absolute;left:2448;top:6256;
    width:179;height:94'/>
  </v:group><v:shapetype id="_x0000_t202" coordsize="21600,21600" o:spt="202"
   path="m,l,21600r21600,l21600,xe">
   <v:stroke joinstyle="miter"/>
   <v:path gradientshapeok="t" o:connecttype="rect"/>
  </v:shapetype><v:shape id="_x0000_s1253" type="#_x0000_t202" style='position:absolute;
   left:2861;top:3456;width:1204;height:430' filled="f" stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1253'>
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=MsoNormal>VMR-9</p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:line id="_x0000_s1254" style='position:absolute' from="3591,2281"
   to="5139,2282" strokeweight="1pt">
   <v:stroke dashstyle="dash"/>
  </v:line><v:line id="_x0000_s1255" style='position:absolute' from="4279,2624"
   to="5139,2625" strokeweight="1pt">
   <v:stroke dashstyle="dash"/>
  </v:line><v:line id="_x0000_s1256" style='position:absolute' from="3935,2969"
   to="5139,2970" strokeweight="1pt">
   <v:stroke dashstyle="dash"/>
  </v:line><v:shape id="_x0000_s1257" type="#_x0000_t202" style='position:absolute;
   left:5225;top:2023;width:2838;height:430' stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1257' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText><b style='mso-bidi-font-weight:normal'>IVMRSurfaceAllocator9<o:p></o:p></b></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1258" type="#_x0000_t202" style='position:absolute;
   left:5225;top:2453;width:2838;height:430' stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1258' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText><b style='mso-bidi-font-weight:normal'>IVMRImagePresenter9<o:p></o:p></b></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal>CMultiVMR9UILayer: IMultiVMR9UILayer</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal>CMultiVMR9UILayer: IMultiVMR9UILayer</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1259" type="#_x0000_t202" style='position:absolute;
   left:5225;top:2797;width:3698;height:430' stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1259' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText><b style='mso-bidi-font-weight:normal'>IVMRSurfaceAllocatorNotify9<o:p></o:p></b></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal>CMultiVMR9UILayer: IMultiVMR9UILayer</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal>CMultiVMR9UILayer: IMultiVMR9UILayer</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1260" type="#_x0000_t202" style='position:absolute;
   left:1441;top:2711;width:946;height:430' stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1260' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText>Pin 0</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1261" type="#_x0000_t202" style='position:absolute;
   left:1441;top:3227;width:946;height:688' stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1261' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText>…</p>
      <p class=PlainText>Pin N</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape></v:group><v:shape id="_x0000_s1262" type="#_x0000_t202" style='position:absolute;
  left:4623;top:4046;width:4300;height:475' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1262'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><span class=GramE>Figure 1.</span> Standard
     Allocator-Presenter</p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><w:wrap type="none"/>
 <w:anchorlock/>
</v:group><![endif]--><![if !vml]><img width=530 height=235
src="MultiVMR9_and_AP_files/image004.gif" v:shapes="_x0000_s1239 _x0000_s1240 _x0000_s1241 _x0000_s1242 _x0000_s1243 _x0000_s1244 _x0000_s1245 _x0000_s1246 _x0000_s1247 _x0000_s1248 _x0000_s1249 _x0000_s1250 _x0000_s1251 _x0000_s1252 _x0000_s1253 _x0000_s1254 _x0000_s1255 _x0000_s1256 _x0000_s1257 _x0000_s1258 _x0000_s1259 _x0000_s1260 _x0000_s1261 _x0000_s1262"><![endif]><!--[if mso & !supportInlineShapes & supportFields]><v:shape
 id="_x0000_i1025" type="#_x0000_t75" style='width:395.6pt;height:176.3pt'>
 <v:imagedata croptop="-65520f" cropbottom="65520f"/>
</v:shape><span style='mso-element:field-end'></span><![endif]--></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l9 level1 lfo11;tab-stops:list .5in'>Please
     note that this is developer’s responsibility to make custom allocator-presenter
     object thread safe.</li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo11;tab-stops:list .5in'><span
     class=API>IVMRSurfaceAllocator9::AdviseNotify</span>. Client application
     calls this method to inform A/P about allocator notifier. Custom
     implementation should just save the pointer to <span class=API>IVMRSurfaceAllocatorNotify9</span>.
     It will be used in <span class=API>IVMRSurfaceAllocator9::InitializeDevice</span>.</li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo11;tab-stops:list .5in'><span
     class=API><span style='mso-bidi-font-size:11.0pt;font-family:Arial'>IVMRSurfaceAllocator9::InitializeDevice</span></span>.
     VMR9 calls this method to initialize Direct3D9 device and allocate the
     chain of Direct3D9 surfaces. When implementing this method, client
     application can modify flags of <span class=API>VMR9AllocationInfo</span><code><span
     style='mso-ansi-font-size:11.0pt;mso-bidi-font-size:11.0pt;font-family:
     Arial;mso-bidi-font-weight:bold'> structure. Usually this method performs
     the following tasks:</span></code><code><span style='mso-ansi-font-size:
     11.0pt;mso-bidi-font-size:11.0pt;font-family:Arial;mso-bidi-font-family:
     "Times New Roman"'><o:p></o:p></span></code></li>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l9 level2 lfo11;tab-stops:list 1.0in'><code><span
      style='mso-ansi-font-size:11.0pt;mso-bidi-font-size:11.0pt;font-family:
      Arial;mso-bidi-font-weight:bold'>Create Direct3D9 object (or acquire it
      from some other part of the application).</span></code><code><span
      style='mso-ansi-font-size:11.0pt;mso-bidi-font-size:11.0pt;font-family:
      Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></code></li>
  <li class=MsoNormal style='mso-list:l9 level2 lfo11;tab-stops:list 1.0in'><code><span
      style='mso-ansi-font-size:11.0pt;mso-bidi-font-size:11.0pt;font-family:
      Arial;mso-bidi-font-weight:bold'>Create Direct3D9 device (or acquire it
      from some other part of the application).</span></code><code><span
      style='mso-ansi-font-size:11.0pt;mso-bidi-font-size:11.0pt;font-family:
      Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></code></li>
  <li class=MsoNormal style='mso-list:l9 level2 lfo11;tab-stops:list 1.0in'><code><span
      style='mso-ansi-font-size:11.0pt;mso-bidi-font-size:11.0pt;font-family:
      Arial;mso-bidi-font-weight:bold'>Allocate Direct3D9 surfaces according to
      VMR9AllocationInfo structure. In most cases, it is advised to use helper
      function </span></code><span class=API>IVMRSurfaceAllocatorNotify9::AllocateSurfaceHelper
      </span>rather than directly allocate surfaces with methods of <span
      class=API>IDirect3Ddevice9</span>.</li>
  <li class=MsoNormal style='mso-list:l9 level2 lfo11;tab-stops:list 1.0in'><code><span
      style='mso-ansi-font-size:11.0pt;mso-bidi-font-size:11.0pt;font-family:
      Arial;mso-bidi-font-weight:bold'>Create all the other Direct3D9 objects
      associated with this custom A/P (if applicable)</span></code><code><span
      style='mso-ansi-font-size:11.0pt;mso-bidi-font-size:11.0pt;font-family:
      Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></code></li>
 </ul>
 <li class=MsoNormal style='mso-list:l9 level1 lfo11;tab-stops:list .5in'><span
     class=API>IVMRSurfaceAllocator9::GetSurface</span>. VMR9 calls this method
     every time it needs Direct3D surface. Custom implementation of this method
     returns a pointer to one of the surfaces allocated in <span class=API>IVMRSurfaceAllocator9::InitializeDevice</span>.</li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo11;tab-stops:list .5in'><span
     class=API>IVMRSurfaceAllocator9::TerminateDevice</span>. Custom
     implementation of this method releases all the resources allocated in <span
     class=API>IVMRSurfaceAllocator9::InitializeDevice</span>.</li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo11;tab-stops:list .5in'><span
     class=API>IVMRImagePresenter9::StartPresenting</span>. VMR9 calls this
     method to indicate that presenting is about to start. Custom
     implementation just returns S_OK in most cases.</li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo11;tab-stops:list .5in'><span
     class=API>IVMRImagePresenter9::StopPresenting</span>. VMR9 calls this
     method to indicate that presenting is about to stop. Custom implementation
     just returns S_OK in most cases.</li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo11;tab-stops:list .5in'><span
     class=API>IVMRImagePresenter9::PresentImage</span>. VMR9 calls this method
     to indicate that sample is ready to be rendered. Custom implementation can
     either perform actual rendering at this point (as in VMR9Allocator
     sample), or save the buffer with image (when rendering is asynchronous
     from VMR9 calls). If surfaces were not allocated as render targets, it is
     developer’s responsibility to correctly transorm formats to perform
     rendering. For example, if the video source is in YUV format, developer
     might use <span class=API>IDirect3Ddevice9::StretchRect</span> function,
     etc.</li>
</ul>

<h3>2.2. Using Custom Allocator-Presenter </h3>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.25in'>When client application supplies a
custom A/P for VMR9, there are several rules to be followed: custom A/P must be
thread-safe; when advising custom A/P, filter graph must be stopped and VMR9
filter must be in the rendeless mode; and all its inputs pins must be
disconnected. Below is the typical scenario of using custom A/P.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Create
instance of the filter graph (<span class=API>CLSID_FilterGraph</span>).</p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Create
instance of Video Mixing Renderer 9 (<span class=API>CLSID_VideoMixingRender9</span>)
and add it to the filter graph.</p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Set
VMR9 to the Renderless mode (see <span class=API>IVMRFilterConfig9::SetRenderingMode</span><span
class=GramE>) .</span></p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Query
VMR9 filter for interface <span class=API>IVMRSurfaceAllocatorNotify9</span>.</p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Create
instance of custom allocator-presenter.</p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Associate
your filter graph with some cookie (any DWORD_PTR value that uniquely
identifies the filter graph).</p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Advice
custom A/P to the VMR9 (see <span class=API>IVMRSurfaceAllocatorNotify9::AdviseSurfaceAllocator</span>).</p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Inform
custom A/P about the allocator notifier (see <span class=API>IVMRSurfaceAllocator9::AdviseNotify</span>).</p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Build
the rest of the graph, render, and run.</p>

<p class=MsoListNumber><![if !supportLists]><span style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]>When
destroying the filter graph, stop the graph, disconnect all the pins of VMR9
filter and advise it with NULL surface allocator</p>

<h3>2.3. Using Custom Allocator-Presenter in Multi-Graph Environment</h3>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'>To provide multi-graph
functionality to the scenario above, few modifications are needed. Custom A/P
should contain references to all the connected filter graphs. Each filter graph
is uniquely identified with a cookie (parameter DWORD_PTR dwUserID in <span
style='mso-bidi-font-family:Arial'>methods of </span><span class=API>IVMRSurfaceAllocator9</span><span
style='mso-bidi-font-family:Arial'> and </span><span class=API>IVMRImagePresenter9</span><span
style='mso-bidi-font-family:Arial'>). </span>Since several filter graphs are
asynchronous to each other, it is advised to perform rendering in a separate
thread with some fixed user-defined frame rate. In this case, method <span
class=API>IVMRImagePresenter9::PresentImage</span> just copies images from VMR9
filters to some private textures. This causes some performance drop, but leaves
filter graphs independent on each other. It is advised to set the frame rate to
the highest frame rate of all connected video streams to prevent frame
dropping.<span style='mso-bidi-font-family:Arial'> </span>At last, it would be
logical if such custom allocator-presenter have methods <span class=API>Attach</span>
and <span class=API>Detach</span>, to connect and disconnect involved filter
graphs. Figure 2 illustrates relationship between connecting filter graphs and
custom A/P.<span style='mso-bidi-font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><!--[if mso & !supportInlineShapes & supportFields]><span
style='mso-element:field-begin;mso-field-lock:yes'></span><span
style='mso-spacerun:yes'> </span>SHAPE <span
style='mso-spacerun:yes'> </span>\* MERGEFORMAT <span style='mso-element:field-separator'></span><![endif]--><!--[if gte vml 1]><v:group
 id="_x0000_s1182" editas="canvas" style='width:498.8pt;height:378.4pt;
 mso-position-horizontal-relative:char;mso-position-vertical-relative:line'
 coordorigin="1011,1077" coordsize="9976,7568">
 <o:lock v:ext="edit" aspectratio="t"/>
 <v:shape id="_x0000_s1183" type="#_x0000_t75" style='position:absolute;left:1011;
  top:1077;width:9976;height:7568' o:preferrelative="f">
  <v:fill o:detectmouseclick="t"/>
  <v:path o:extrusionok="t" o:connecttype="none"/>
 </v:shape><v:rect id="_x0000_s1184" style='position:absolute;left:5225;top:2625;
  width:1439;height:721'>
  <v:textbox style='mso-next-textbox:#_x0000_s1184'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><span style='mso-spacerun:yes'>     </span>A/P</p>
     <p class=MsoNormal><o:p>&nbsp;</o:p></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:rect><v:line id="_x0000_s1185" style='position:absolute' from="5585,3313"
  to="5586,4068">
  <v:stroke endarrow="oval"/>
 </v:line><v:line id="_x0000_s1186" style='position:absolute' from="6273,3313"
  to="6274,4087">
  <v:stroke endarrow="oval"/>
 </v:line><v:group id="_x0000_s1227" style='position:absolute;left:1827;top:4947;
  width:3398;height:2838' coordorigin="1827,4173" coordsize="3398,2838">
  <v:shape id="_x0000_s1199" style='position:absolute;left:2043;top:4173;
   width:3182;height:2838' coordsize="3182,2838" o:regroupid="5" path="m,l3182,r,2838l,2838e">
   <v:shadow on="t" opacity=".5" offset="6pt,6pt"/>
   <v:path arrowok="t"/>
  </v:shape><v:shape id="_x0000_s1188" style='position:absolute;left:2903;
   top:4775;width:1980;height:1799' coordsize="1980,1800" o:regroupid="5"
   path="m1980,1800l,1800,,,540,r,900l1980,900r,900xe">
   <v:path arrowok="t"/>
  </v:shape><v:line id="_x0000_s1189" style='position:absolute;flip:x y'
   from="4107,4861" to="4108,5721" o:regroupid="5">
   <v:stroke endarrow="oval"/>
  </v:line><v:group id="_x0000_s1190" style='position:absolute;left:1827;top:5369;
   width:1076;height:94' coordorigin="1551,6256" coordsize="1076,94"
   o:regroupid="5">
   <v:line id="_x0000_s1191" style='position:absolute' from="1551,6300" to="2451,6301">
    <v:stroke endarrow="block"/>
   </v:line><v:rect id="_x0000_s1192" style='position:absolute;left:2448;top:6256;
    width:179;height:94'/>
  </v:group><v:group id="_x0000_s1193" style='position:absolute;left:1827;
   top:6151;width:1076;height:94' coordorigin="1551,6256" coordsize="1076,94"
   o:regroupid="5">
   <v:line id="_x0000_s1194" style='position:absolute' from="1551,6300" to="2451,6301">
    <v:stroke endarrow="block"/>
   </v:line><v:rect id="_x0000_s1195" style='position:absolute;left:2448;top:6256;
    width:179;height:94'/>
  </v:group><v:shape id="_x0000_s1196" type="#_x0000_t202" style='position:absolute;
   left:3247;top:5893;width:1204;height:430' o:regroupid="5" filled="f"
   stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1196'>
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=MsoNormal>VMR-9</p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1197" type="#_x0000_t202" style='position:absolute;
   left:1827;top:4947;width:946;height:430' o:regroupid="5" stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1197' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText>Pin 0</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1198" type="#_x0000_t202" style='position:absolute;
   left:1827;top:5463;width:946;height:688' o:regroupid="5" stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1198' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText>…</p>
      <p class=PlainText>Pin N</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal>VMR N</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal>VMR N</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1200" type="#_x0000_t202" style='position:absolute;
   left:2043;top:6656;width:3096;height:355' o:regroupid="5" filled="f"
   fillcolor="#eaeaea" stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1200' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText align=center style='text-align:center'><b
      style='mso-bidi-font-weight:normal'>Filter graph ID=1<o:p></o:p></b></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1201" type="#_x0000_t202" style='position:absolute;
   left:1871;top:4345;width:3182;height:344' o:regroupid="5" stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1201' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText><b style='mso-bidi-font-weight:normal'><span
      style='font-size:9.0pt'>IVMRSurfaceAllocatorNotify9<o:p></o:p></span></b></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:line id="_x0000_s1202" style='position:absolute' from="3591,4603"
   to="4107,5463" o:regroupid="5">
   <v:stroke dashstyle="1 1"/>
  </v:line></v:group><v:group id="_x0000_s1228" style='position:absolute;
  left:6343;top:4947;width:3312;height:2838' coordorigin="6343,4173"
  coordsize="3312,2838">
  <v:shape id="_x0000_s1215" style='position:absolute;left:6473;top:4173;
   width:3182;height:2838' coordsize="3182,2838" o:regroupid="6" path="m,l3182,r,2838l,2838e">
   <v:shadow on="t" opacity=".5" offset="6pt,6pt"/>
   <v:path arrowok="t"/>
  </v:shape><v:shape id="_x0000_s1204" style='position:absolute;left:7419;
   top:4775;width:1980;height:1799' coordsize="1980,1800" o:regroupid="6"
   path="m1980,1800l,1800,,,540,r,900l1980,900r,900xe">
   <v:path arrowok="t"/>
  </v:shape><v:line id="_x0000_s1205" style='position:absolute;flip:x y'
   from="8623,4861" to="8624,5721" o:regroupid="6">
   <v:stroke endarrow="oval"/>
  </v:line><v:group id="_x0000_s1206" style='position:absolute;left:6343;top:5369;
   width:1076;height:94' coordorigin="1551,6256" coordsize="1076,94"
   o:regroupid="6">
   <v:line id="_x0000_s1207" style='position:absolute' from="1551,6300" to="2451,6301">
    <v:stroke endarrow="block"/>
   </v:line><v:rect id="_x0000_s1208" style='position:absolute;left:2448;top:6256;
    width:179;height:94'/>
  </v:group><v:group id="_x0000_s1209" style='position:absolute;left:6343;
   top:6151;width:1076;height:94' coordorigin="1551,6256" coordsize="1076,94"
   o:regroupid="6">
   <v:line id="_x0000_s1210" style='position:absolute' from="1551,6300" to="2451,6301">
    <v:stroke endarrow="block"/>
   </v:line><v:rect id="_x0000_s1211" style='position:absolute;left:2448;top:6256;
    width:179;height:94'/>
  </v:group><v:shape id="_x0000_s1212" type="#_x0000_t202" style='position:absolute;
   left:7763;top:5893;width:1204;height:430' o:regroupid="6" filled="f"
   stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1212'>
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=MsoNormal>VMR-9</p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1213" type="#_x0000_t202" style='position:absolute;
   left:6343;top:4947;width:946;height:430' o:regroupid="6" stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1213' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText>Pin 0</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1214" type="#_x0000_t202" style='position:absolute;
   left:6343;top:5463;width:946;height:688' o:regroupid="6" stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1214' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText>…</p>
      <p class=PlainText>Pin N</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal>VMR N</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      <p class=MsoNormal>VMR N</p>
      <p class=MsoNormal><o:p>&nbsp;</o:p></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1216" type="#_x0000_t202" style='position:absolute;
   left:6515;top:6656;width:3096;height:355' o:regroupid="6" filled="f"
   fillcolor="#eaeaea" stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1216' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText align=center style='text-align:center'><b
      style='mso-bidi-font-weight:normal'>Filter graph ID=N<o:p></o:p></b></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:shape id="_x0000_s1217" type="#_x0000_t202" style='position:absolute;
   left:6387;top:4345;width:3182;height:344' o:regroupid="6" stroked="f">
   <v:textbox style='mso-next-textbox:#_x0000_s1217' inset="0,0,0,0">
    <![if !mso]>
    <table cellpadding=0 cellspacing=0 width="100%">
     <tr>
      <td><![endif]>
      <div>
      <p class=PlainText><b style='mso-bidi-font-weight:normal'><span
      style='font-size:9.0pt'>IVMRSurfaceAllocatorNotify9<o:p></o:p></span></b></p>
      </div>
      <![if !mso]></td>
     </tr>
    </table>
    <![endif]></v:textbox>
  </v:shape><v:line id="_x0000_s1218" style='position:absolute' from="8107,4603"
   to="8623,5463" o:regroupid="6">
   <v:stroke dashstyle="1 1"/>
  </v:line></v:group><v:shape id="_x0000_s1219" type="#_x0000_t202" style='position:absolute;
  left:5397;top:6065;width:774;height:602' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1219'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal>. . .</p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1220" type="#_x0000_t202" style='position:absolute;
  left:2473;top:3399;width:2902;height:516' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1220' inset="0,0,0,0">
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=PlainText align=right style='text-align:right'><b
     style='mso-bidi-font-weight:normal'>IVMRSurfaceAllocator9<o:p></o:p></b></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1221" type="#_x0000_t202" style='position:absolute;
  left:6429;top:3399;width:3096;height:602' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1221' inset="0,0,0,0">
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=PlainText><b style='mso-bidi-font-weight:normal'>IVMRImagePresenter9<o:p></o:p></b></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shapetype id="_x0000_t73" coordsize="21600,21600" o:spt="73"
  path="m8472,l,3890,7602,8382,5022,9705r7200,4192l10012,14915r11588,6685l14767,12877r1810,-870l11050,6797r1810,-717xe">
  <v:stroke joinstyle="miter"/>
  <v:path o:connecttype="custom" o:connectlocs="8472,0;0,3890;5022,9705;10012,14915;21600,21600;16577,12007;12860,6080"
   o:connectangles="270,270,180,180,90,0,0" textboxrect="8757,7437,13917,14277"/>
 </v:shapetype><v:shape id="_x0000_s1222" type="#_x0000_t73" style='position:absolute;
  left:4451;top:3915;width:859;height:860;rotation:16881422fd'/>
 <v:shape id="_x0000_s1223" type="#_x0000_t73" style='position:absolute;left:6515;
  top:3915;width:946;height:860;rotation:180'/>
 <v:shape id="_x0000_s1224" type="#_x0000_t202" style='position:absolute;
  left:1785;top:2023;width:2580;height:1290'>
  <v:stroke dashstyle="1 1" endcap="round"/>
  <v:textbox style='mso-next-textbox:#_x0000_s1224' inset=",0,0,0">
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=PlainText><span style='font-size:9.0pt;font-family:Arial'>VMR9 calls
     methods of IVMRSurfaceAllocator9 and IVMRImagePresenter9; <br>
     A / P calls methods of IVMRSurfaceAllocatorNotify9<o:p></o:p></span></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shapetype id="_x0000_t34" coordsize="21600,21600" o:spt="34"
  o:oned="t" adj="10800" path="m,l@0,0@0,21600,21600,21600e" filled="f">
  <v:stroke joinstyle="miter"/>
  <v:formulas>
   <v:f eqn="val #0"/>
  </v:formulas>
  <v:path arrowok="t" fillok="f" o:connecttype="none"/>
  <v:handles>
   <v:h position="#0,center"/>
  </v:handles>
  <o:lock v:ext="edit" shapetype="t"/>
 </v:shapetype><v:shape id="_x0000_s1226" type="#_x0000_t34" style='position:absolute;
  left:1785;top:2668;width:2697;height:1860;rotation:180;flip:x y'
  o:connectortype="elbow" adj="-2883,57217,14272">
  <v:stroke dashstyle="1 1" endcap="round"/>
 </v:shape><v:rect id="_x0000_s1232" style='position:absolute;left:7805;top:1249;
  width:2924;height:2064'>
  <v:stroke dashstyle="dash"/>
  <v:textbox style='mso-next-textbox:#_x0000_s1232'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><o:p>&nbsp;</o:p></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:rect><v:shapetype id="_x0000_t99" coordsize="21600,21600" o:spt="99"
  adj="-11796480,,5400" path="al10800,10800@8@8@4@6,10800,10800,10800,10800@9@7l@30@31@17@18@24@25@15@16@32@33xe">
  <v:stroke joinstyle="miter"/>
  <v:formulas>
   <v:f eqn="val #1"/>
   <v:f eqn="val #0"/>
   <v:f eqn="sum #1 0 #0"/>
   <v:f eqn="val 10800"/>
   <v:f eqn="sum 0 0 #1"/>
   <v:f eqn="sumangle @2 360 0"/>
   <v:f eqn="if @2 @2 @5"/>
   <v:f eqn="sum 0 0 @6"/>
   <v:f eqn="val #2"/>
   <v:f eqn="sum 0 0 #0"/>
   <v:f eqn="sum #2 0 2700"/>
   <v:f eqn="cos @10 #1"/>
   <v:f eqn="sin @10 #1"/>
   <v:f eqn="cos 13500 #1"/>
   <v:f eqn="sin 13500 #1"/>
   <v:f eqn="sum @11 10800 0"/>
   <v:f eqn="sum @12 10800 0"/>
   <v:f eqn="sum @13 10800 0"/>
   <v:f eqn="sum @14 10800 0"/>
   <v:f eqn="prod #2 1 2"/>
   <v:f eqn="sum @19 5400 0"/>
   <v:f eqn="cos @20 #1"/>
   <v:f eqn="sin @20 #1"/>
   <v:f eqn="sum @21 10800 0"/>
   <v:f eqn="sum @12 @23 @22"/>
   <v:f eqn="sum @22 @23 @11"/>
   <v:f eqn="cos 10800 #1"/>
   <v:f eqn="sin 10800 #1"/>
   <v:f eqn="cos #2 #1"/>
   <v:f eqn="sin #2 #1"/>
   <v:f eqn="sum @26 10800 0"/>
   <v:f eqn="sum @27 10800 0"/>
   <v:f eqn="sum @28 10800 0"/>
   <v:f eqn="sum @29 10800 0"/>
   <v:f eqn="sum @19 5400 0"/>
   <v:f eqn="cos @34 #0"/>
   <v:f eqn="sin @34 #0"/>
   <v:f eqn="mid #0 #1"/>
   <v:f eqn="sumangle @37 180 0"/>
   <v:f eqn="if @2 @37 @38"/>
   <v:f eqn="cos 10800 @39"/>
   <v:f eqn="sin 10800 @39"/>
   <v:f eqn="cos #2 @39"/>
   <v:f eqn="sin #2 @39"/>
   <v:f eqn="sum @40 10800 0"/>
   <v:f eqn="sum @41 10800 0"/>
   <v:f eqn="sum @42 10800 0"/>
   <v:f eqn="sum @43 10800 0"/>
   <v:f eqn="sum @35 10800 0"/>
   <v:f eqn="sum @36 10800 0"/>
  </v:formulas>
  <v:path o:connecttype="custom" o:connectlocs="@44,@45;@48,@49;@46,@47;@17,@18;@24,@25;@15,@16"
   textboxrect="3163,3163,18437,18437"/>
  <v:handles>
   <v:h position="@3,#0" polar="10800,10800"/>
   <v:h position="#2,#1" polar="10800,10800" radiusrange="0,10800"/>
  </v:handles>
 </v:shapetype><v:shape id="_x0000_s1233" type="#_x0000_t99" style='position:absolute;
  left:7977;top:1335;width:602;height:506'/>
 <v:shape id="_x0000_s1234" type="#_x0000_t99" style='position:absolute;left:7977;
  top:1507;width:602;height:506;rotation:180'/>
 <v:shape id="_x0000_s1235" type="#_x0000_t73" style='position:absolute;left:6816;
  top:1636;width:946;height:860;rotation:5688392fd'/>
 <v:shape id="_x0000_s1236" type="#_x0000_t202" style='position:absolute;
  left:7977;top:2109;width:2666;height:860' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1236' inset="0,0,0,0">
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=PlainText>Rendering thread is asynchronous from <span
     class=GramE>PresentImage(</span>) calls</p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1238" type="#_x0000_t202" style='position:absolute;
  left:2043;top:8129;width:7654;height:462' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1238'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><span class=GramE>Figure 2.</span> Custom
     Allocator-Presenter in the Multi-graph environment</p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><w:wrap type="none"/>
 <w:anchorlock/>
</v:group><![endif]--><![if !vml]><img width=665 height=505
src="MultiVMR9_and_AP_files/image005.gif" v:shapes="_x0000_s1182 _x0000_s1183 _x0000_s1184 _x0000_s1185 _x0000_s1186 _x0000_s1227 _x0000_s1199 _x0000_s1188 _x0000_s1189 _x0000_s1190 _x0000_s1191 _x0000_s1192 _x0000_s1193 _x0000_s1194 _x0000_s1195 _x0000_s1196 _x0000_s1197 _x0000_s1198 _x0000_s1200 _x0000_s1201 _x0000_s1202 _x0000_s1228 _x0000_s1215 _x0000_s1204 _x0000_s1205 _x0000_s1206 _x0000_s1207 _x0000_s1208 _x0000_s1209 _x0000_s1210 _x0000_s1211 _x0000_s1212 _x0000_s1213 _x0000_s1214 _x0000_s1216 _x0000_s1217 _x0000_s1218 _x0000_s1219 _x0000_s1220 _x0000_s1221 _x0000_s1222 _x0000_s1223 _x0000_s1224 _x0000_s1226 _x0000_s1232 _x0000_s1233 _x0000_s1234 _x0000_s1235 _x0000_s1236 _x0000_s1238"><![endif]><!--[if mso & !supportInlineShapes & supportFields]><v:shape
 id="_x0000_i1026" type="#_x0000_t75" style='width:498.8pt;height:378.4pt'>
 <v:imagedata croptop="-65520f" cropbottom="65520f"/>
</v:shape><span style='mso-element:field-end'></span><![endif]--></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2>3. MultiVMR9.dll Helper Library</h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'>DirectX 9.0 SDK samples include
sources for <span class=API>MultiVMR9.dll</span> (see <kbd>Samples\cpp\DirectShow\VMR9\MultiVMR9</kbd>).
This helper library demonstrates how to implement a user-provided (customized)
allocator-presenter for the Video Mixing Renderer 9 in a multigraph
environment. It seemed logical to extract several abstraction layers that could
be overriden by client applications:</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l3 level1 lfo13;
tab-stops:list .75in'><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'><i
style='mso-bidi-font-style:normal'>Wizard</i></b>, an object that implements
actual allocation-presenting and contains references to all connected filter
graphs. The wizard is responsible for interaction with client application as
well as connecting and disconnecting graphs. Object is implemented by <span
class=API>IMultiVMR9Wizard</span> interface. </p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l3 level1 lfo13;
tab-stops:list .75in'><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'><i
style='mso-bidi-font-style:normal'>Rendering Engine</i></b>, an object that
contains all Direct3D data and performs actual rendering asynchronously from
calls to <span class=API>IVMRImagePresenter9::PresentImage</span>. Object is
implemented by <span class=API>IMultiVMR9RenderEngine</span> interface.</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l3 level1 lfo13;
tab-stops:list .75in'><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'><i
style='mso-bidi-font-style:normal'>Mixer Control</i></b>, an object that
performs scene composition and defines geometry of Direct3D objects. By
default, this object acts as <span class=API>IVMRMixerControl9</span> in a
single graph (see sample MultiPlayer, <kbd>Samples\cpp\DirectShow\VMR9\MultiVMR9\MultiPlayer</kbd>),
but can be overriden to perform any sort of 3D transformation (as in the sample
GamePlayer,<kbd> Samples\cpp\DirectShow\VMR9\MultiVMR9\GamePlayer</kbd>).
Object is implemented by <span class=API>IMultiVMR9MixerControl</span>
interface.</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l3 level1 lfo13;
tab-stops:list .75in'><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'><i
style='mso-bidi-font-style:normal'>User Interface Layer</i></b>, an object that
is responsible for interaction with user in video playback window. User Interface
Layer is always drawn over the scene rendered by mixer control. Message
processing function of the video window sends all the appropriate messages to
this object. Object is implemented by <span class=API>IMultiVMR9UILayer</span>
interface. By default, <span class=API>MultiVMR9.dll</span> does not use this
object, so if client application needs user interaction, it must provide
IMultiVMR9UILayer object.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Figure 3 illustrates structure of MultiVMR9.dll.</p>

<p class=MsoNormal><!--[if mso & !supportInlineShapes & supportFields]><span
style='mso-element:field-begin;mso-field-lock:yes'></span><span
style='mso-spacerun:yes'> </span>SHAPE <span
style='mso-spacerun:yes'> </span>\* MERGEFORMAT <span style='mso-element:field-separator'></span><![endif]--><!--[if gte vml 1]><v:group
 id="_x0000_s1263" editas="canvas" style='width:6in;height:378pt;
 mso-position-horizontal-relative:char;mso-position-vertical-relative:line'
 coordorigin="1816,2354" coordsize="8640,7560">
 <o:lock v:ext="edit" aspectratio="t"/>
 <v:shape id="_x0000_s1264" type="#_x0000_t75" style='position:absolute;left:1816;
  top:2354;width:8640;height:7560' o:preferrelative="f" filled="t" stroked="t">
  <v:fill o:detectmouseclick="t"/>
  <v:stroke dashstyle="1 1"/>
  <v:path o:extrusionok="t" o:connecttype="none"/>
 </v:shape><v:rect id="_x0000_s1265" style='position:absolute;left:1996;top:4334;
  width:8248;height:4140' fillcolor="#eaeaea">
  <v:textbox style='mso-next-textbox:#_x0000_s1265'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><o:p>&nbsp;</o:p></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:rect><v:shape id="_x0000_s1266" type="#_x0000_t202" style='position:absolute;
  left:3076;top:3074;width:540;height:362' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1266'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal>…</p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1267" type="#_x0000_t202" style='position:absolute;
  left:2896;top:4694;width:4510;height:539'>
  <v:textbox style='mso-next-textbox:#_x0000_s1267'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><code><span style='font-size:9.0pt'>CMultiVMR9Wizard:
     IMultiVMR9Wizard<o:p></o:p></span></code></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1268" type="#_x0000_t202" style='position:absolute;
  left:2418;top:6134;width:5878;height:539'>
  <v:textbox style='mso-next-textbox:#_x0000_s1268'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><code><span style='font-size:9.0pt'>CMultiVMR9RenderEngine:
     IMultiVMR9RenderEngine<o:p></o:p></span></code></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1269" type="#_x0000_t202" style='position:absolute;
  left:4826;top:7034;width:5246;height:394'>
  <v:textbox style='mso-next-textbox:#_x0000_s1269' inset="0,0,0,0">
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><code><span style='font-size:9.0pt'><span
     style='mso-spacerun:yes'> </span>CMultiVMR9MixerControl:
     IMultiVMR9MixerControl<o:p></o:p></span></code></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1270" type="#_x0000_t202" style='position:absolute;
  left:2176;top:7754;width:4198;height:448'>
  <v:textbox style='mso-next-textbox:#_x0000_s1270' inset="0,0,0,0">
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><code><span style='font-size:9.0pt'><span
     style='mso-spacerun:yes'> </span>CMultiVMR9UILayer: IMultiVMR9UILayer<o:p></o:p></span></code></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shapetype id="_x0000_t176" coordsize="21600,21600" o:spt="176"
  adj="2700" path="m@0,qx0@0l0@2qy@0,21600l@1,21600qx21600@2l21600@0qy@1,xe">
  <v:stroke joinstyle="miter"/>
  <v:formulas>
   <v:f eqn="val #0"/>
   <v:f eqn="sum width 0 #0"/>
   <v:f eqn="sum height 0 #0"/>
   <v:f eqn="prod @0 2929 10000"/>
   <v:f eqn="sum width 0 @3"/>
   <v:f eqn="sum height 0 @3"/>
   <v:f eqn="val width"/>
   <v:f eqn="val height"/>
   <v:f eqn="prod width 1 2"/>
   <v:f eqn="prod height 1 2"/>
  </v:formulas>
  <v:path gradientshapeok="t" limo="10800,10800" o:connecttype="custom"
   o:connectlocs="@8,0;0,@9;@8,@7;@6,@9" textboxrect="@3,@3,@4,@5"/>
 </v:shapetype><v:shape id="_x0000_s1271" type="#_x0000_t176" style='position:absolute;
  left:2716;top:2534;width:1440;height:539'>
  <v:textbox style='mso-next-textbox:#_x0000_s1271'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal>VMR 1</p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1272" type="#_x0000_t176" style='position:absolute;
  left:2716;top:3614;width:1440;height:539'>
  <v:textbox style='mso-next-textbox:#_x0000_s1272'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal>VMR N</p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:line id="_x0000_s1273" style='position:absolute' from="4876,5234"
  to="4877,6134">
  <v:stroke startarrow="diamond" endarrow="block"/>
 </v:line><v:line id="_x0000_s1274" style='position:absolute' from="4336,6674"
  to="4337,7754">
  <v:stroke startarrow="diamond" endarrow="block"/>
 </v:line><v:line id="_x0000_s1275" style='position:absolute' from="6856,6674"
  to="6857,7034">
  <v:stroke startarrow="diamond" endarrow="block"/>
 </v:line><v:line id="_x0000_s1276" style='position:absolute' from="4156,3974"
  to="4696,3974" strokeweight="1.5pt">
  <v:stroke dashstyle="longDashDot" startarrow="block"/>
 </v:line><v:line id="_x0000_s1277" style='position:absolute' from="4696,3974"
  to="4696,4694" strokeweight="1.5pt">
  <v:stroke dashstyle="longDashDot" endarrow="block"/>
 </v:line><v:line id="_x0000_s1278" style='position:absolute' from="4156,3074"
  to="5236,3074" strokeweight="1.5pt">
  <v:stroke dashstyle="longDashDot" startarrow="block"/>
 </v:line><v:line id="_x0000_s1279" style='position:absolute' from="5236,3074"
  to="5236,4694" strokeweight="1.5pt">
  <v:stroke dashstyle="longDashDot" endarrow="block"/>
 </v:line><v:shape id="_x0000_s1280" type="#_x0000_t202" style='position:absolute;
  left:7664;top:4590;width:2160;height:540' filled="f" stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1280'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal align=right style='text-align:right'><code><span
     style='font-size:10.0pt'>VMR9Multi.dll<o:p></o:p></span></code></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:line id="_x0000_s1281" style='position:absolute' from="2176,9014"
  to="3076,9015">
  <v:stroke startarrow="diamond" endarrow="block"/>
 </v:line><v:line id="_x0000_s1282" style='position:absolute' from="2176,9553"
  to="3076,9554" strokeweight="1.5pt">
  <v:stroke dashstyle="longDashDot" startarrow="block" endarrow="block"/>
 </v:line><v:shape id="_x0000_s1283" type="#_x0000_t202" style='position:absolute;
  left:3256;top:8834;width:6840;height:360' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1283' inset="0,0,0,0">
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><code><span style='font-size:10.0pt'>Containment<o:p></o:p></span></code></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1284" type="#_x0000_t202" style='position:absolute;
  left:3256;top:9374;width:6840;height:360' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1284' inset="0,0,0,0">
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal><code><span style='font-size:10.0pt'>External calls<o:p></o:p></span></code></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><v:shape id="_x0000_s1285" type="#_x0000_t202" style='position:absolute;
  left:7492;top:2698;width:2322;height:516' stroked="f">
  <v:textbox style='mso-next-textbox:#_x0000_s1285'>
   <![if !mso]>
   <table cellpadding=0 cellspacing=0 width="100%">
    <tr>
     <td><![endif]>
     <div>
     <p class=MsoNormal align=right style='text-align:right'><code><span
     style='font-size:9.0pt'>Client application<o:p></o:p></span></code></p>
     </div>
     <![if !mso]></td>
    </tr>
   </table>
   <![endif]></v:textbox>
 </v:shape><w:wrap type="none"/>
 <w:anchorlock/>
</v:group><![endif]--><![if !vml]><img width=579 height=507
src="MultiVMR9_and_AP_files/image006.gif" v:shapes="_x0000_s1263 _x0000_s1264 _x0000_s1265 _x0000_s1266 _x0000_s1267 _x0000_s1268 _x0000_s1269 _x0000_s1270 _x0000_s1271 _x0000_s1272 _x0000_s1273 _x0000_s1274 _x0000_s1275 _x0000_s1276 _x0000_s1277 _x0000_s1278 _x0000_s1279 _x0000_s1280 _x0000_s1281 _x0000_s1282 _x0000_s1283 _x0000_s1284 _x0000_s1285"><![endif]><!--[if mso & !supportInlineShapes & supportFields]><v:shape
 id="_x0000_i1027" type="#_x0000_t75" style='width:6in;height:378pt'>
 <v:imagedata croptop="-65520f" cropbottom="65520f"/>
</v:shape><span style='mso-element:field-end'></span><![endif]--></p>

<h3>3.1. Interfaces</h3>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>See <kbd>Samples\cpp\DirectShow\VMR9\MultiVMR9\DLL\MultiVMR9.idl</kbd></p>

<h4>IMultiVMR9Wizard</h4>

<p class=MsoNormal style='text-indent:.5in'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'>Objects exposing this interface are
responsible for managing several VMRs with single rendering environment. Object
that implements this interface must also implement <span class=API>IVMRSurfaceAllocator9</span>
and <span class=API>IVMRImagePresenter9</span>. Otherwise method <span
class=API>Initialize</span> should return E_NOTIMPL. <span class=API>CLSID_MultiVMR9Wizard</span>
is the default implementation of this interface. </p>

<p class=MsoNormal style='text-indent:.5in'><o:p>&nbsp;</o:p></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0'>
  <td valign=top style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=PlainText><span class=API><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt'>Initialize <o:p></o:p></span></span></p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Configure and initialize internal structures. This method
  must be called before using the wizard; otherwise consequent calls to the
  wizard will return VFW_E_WRONG_STATE. Also, use this method to supply
  customized Rendering Engine.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Terminate<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Releases all internal resources of the wizard; disconnects
  all connected filter graphs. This method must be called before destroying the
  wizard.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Attach<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Attaches filter graph to the wizard</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Detach<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Detaches filter graph from the wizard</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>VerifyID<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Verifies if there is any attached filter graph with specified
  “UserID” cookie</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetGraph<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IFilterGraph</span> of
  the connected filter graph identified by “UserID” cookie</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetRenderEngine<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IMultiVMR9RenderEngine</span>
  actively used by the wizard</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetMixerControl<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IMultiVMR9MixerControl</span>
  actively used by the wizard</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetTexture<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IDirect3DTexture9</span>
  that contains “ready-to-render” image from the filter graph identified by
  “UserID” cookie</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetVideoSize<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns native image size of the video stream from the
  filter graph identified by “UserID” cookie</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:.5in'><o:p>&nbsp;</o:p></p>

<h4>IMultiVMR9RenderEngine</h4>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'>Objects exposing this interface
perfom actual rendering of video streams to a single Direct3D device. While <span
class=API>IMultiVMR9Wizard</span> provides surface management requested by
VMR9, <span class=API>IMultiVMR9RenderEngine</span> performs actual rendering
of the image to the screen, asynchronously from VMR9 calls. Rendering engine
manages two objects:<span style='mso-spacerun:yes'>  </span><span class=API>MultiVMR9MixerControl</span>
and <span class=API>MultiVMR9UILayer</span><span style='mso-bidi-font-size:
9.0pt;mso-bidi-font-family:"Courier New"'>. By default, UI layer is not
implemented, and the default mixer control acts similar to </span><span
class=API>IVMRMixerControl9</span><span style='mso-bidi-font-size:9.0pt;
mso-bidi-font-family:"Courier New"'> in a single graph. </span><span class=API>CLSID_MultiVMR9RenderEngine</span>
is the default implementation of this interface.<span style='mso-bidi-font-size:
9.0pt;mso-bidi-font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-size:9.0pt;mso-bidi-font-family:
"Courier New"'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0'>
  <td valign=top style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Initialize<o:p></o:p></span></p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>This method must be called before connecting “this”
  rendering engine to the wizard. Client application has to call this method
  only if it supplies customized rendering engine (<span class=API>in
  IMultiVMR9Wizard::Initialize</span>). Otherwise, wizard creates and
  initializes default instance of this object. Also, this method can be used to
  supply customized Mixer Control and User Interface Layer to the rendering
  engine.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Terminate<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Releases all internal resources of the rendering engine. Client
  application must call this method only if it supplies customized rendering
  engine. Client applications must call this method after destroying the
  wizard.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Render<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>A call-back function invoked from a separate thread with
  frequency specified by <span class=API>IMultiVMR9RenderEngine::SetFrameRate</span>.
  Method performs actual rendering of the scene in several steps: scene
  initialization (such as <span class=API>IDirect3Ddevice9::BeginScene</span>);
  composition of the mixer objects (<span class=API>IMultiVMR9MixerControl::Compose</span>);
  rendering of the mixer objects (<span class=API>IMultiVMR9MixerControl::Render</span>);
  composition of the UI layer if it is present (<span class=API>IMultiVMR9UILayer::Compose</span>);
  rendering of the UI Layer (<span class=API>IMultiVMR9UILayer::Render</span>),
  and scene completion (<span class=API>IDirect3Ddevice9::EndScene</span> and <span
  class=API>IDirect3Ddevice9::Present</span>). It also updates actual frame
  rate.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetUILayer<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IMultiVMR9UILayer</span>
  actively used by the render engine</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>SetFrameRate<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Sets desired frames-per-second rate, multiplied by 100</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetFrameRate<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns actual frame rate (multiplied by 100) from the
  last rendering</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetFrameRateAvg<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns actual frame rate (multiplied by 100) averaged
  over the lifetime of the rendering object</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetMixingPrefs<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns mixing preferences flags originally set in the
  method Initialize. By default, mixing preferences flags are ignored</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>SetWizardOwner<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Wizard calls this method to inform redering engine that it
  is the owner of the object. Also, when wizard is terminating, it sets the
  owner of its child rendering engine to NULL.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetWizardOwner<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IMultiVMR9Wizard</span>,
  the parent wizard object that currently owns this rendering engine</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetMixerControl<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IMultiVMR9MixerControl</span>
  actively used by the render engine</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Get3DDevice<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IDirect3DDevice9</span>
  actively used for rendering</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetVideoWindow<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns handle to the video window. </p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h4>IMultiVMR9MixerControl</h4>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'>Object that implements this interface,
performs scene composition and defines geometry of Direct3D primitives. By
default, this interface is similar to IVMRMixerControl9 interface of a single
graph. Provide custom implementation of this interface to add animation,
special effects, or to inject video into 3D environent. <span class=API>CLSID_MultiVMR9MixerControl</span>
is the default implementation of this interface.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0'>
  <td valign=top style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Initialize<o:p></o:p></span></p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>This method must be called before connecting “this” mixer control
  to the rendering engine. Client application has to call this method only if
  it supplies customized mixer control (<span class=API>in
  IMultiVMR9RenderEngine::Initialize</span>). Otherwise, rendering engine
  creates and initializes default instance of this object. </p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>SetRenderEngineOwner<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Rendering engine calls this method to inform mixer control
  that it is the owner of the object. Also, when rendering engine is
  terminating, it sets the owner of its child mixer control to NULL.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetRenderEngineOwner<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IMultiVMR9RenderEngine</span>,
  the parent rendering engine object that currently owns this mixer control</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Compose<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>This method is called from IMultiVMR9RenderEngine::Render.
  Method performs calculation of primitives’ coordinates that provides
  animation, special effects, etc.</p>
  </td>
 </tr>
</table>

<span style='font-size:11.0pt;font-family:Arial;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><br clear=all style='mso-special-character:line-break;
page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0'>
  <td valign=top style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Render<o:p></o:p></span></p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>This method is called from IMultiVMR9RenderEngine::Render.
  Method performs actual rendering of primitives. Please note that this method
  must not call <span class=API>IDirect3Ddevice9::BeginScene</span> or <span
  class=API>IDirect3Ddevice9::EndScene</span>, because it is done inside
  rendering engine.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>AddVideoSource<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Wizard calls this method when it attaches a new filter
  graph. Upon receiving this call, mixer control must allocate objects
  (primitives) associated with new video source. </p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>DeleteVideoSource<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Wizard calls this method when it detaches some filter
  graph. Upon receiving this call, mixer control must release objects
  (primitives) associated with this video source.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetIdealOutputRect<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns “ideal” location of the video image, that is, normalized
  rectangle that covers maximum space of the render target and maintains
  original aspect ratio of the image. Please note that normalized rectangle is
  calculated with respect to the render target size (rather than the client
  size of the video window). Use <span class=API>IMultiVMR9RenderEngine::Get3DDevice</span>
  and <span class=API>IDirect3Ddevice9::GetRenderTarger</span> to transform the
  “render target” space into the “client area of the window” space.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'>The following methods are
implemented in the default instance of <span class=API>IMultiVMR9MixerControl</span>
and basically repeat functionality of <span class=MsoHyperlink>IVMRMixerControl9</span>.
The only difference is that cookie “UserID” is used instead of the number of
input pin. When these methods do not make sense in the application-specific
implementation of <span class=API>IMultiVMR9MixerControl</span>, just make them
returning S_OK.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0'>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetOutputRect<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>SetOutputRect<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetZOrder<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>SetZOrder<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetAlpha<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>SetAlpha<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetBackgroundColor<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>SetBackgroundColor<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h4>IMultiVMR9UILayer</h4>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'>Object that exposes this interface,
represents UI- related Direct3D primitives (such as buttons, menus, sliders
etc.) as well as user input to the video window (Win32 messages). User
Interface layer is always drawn over the scene rendered by <span class=API>IMultiVMR9MixerControl</span>.
By default, rendering engine does not use this object, so if client application
implies UI interaction from the video window, it should provide implementation
of <span class=API>IMultiVMR9UILayer</span> and send it to <span class=API>IMultiVMR9RenderEngine::Initialize</span>.</p>

<p class=MsoNormal style='text-indent:.5in'><o:p>&nbsp;</o:p></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0'>
  <td valign=top style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Initialize<o:p></o:p></span></p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>This method can be called to initialize internal objects
  before connecting “this” UI layer to the rendering engine. </p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>ProcessMessage<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>This method is called by the video window message
  processing thread. Method can modify state of the UI Layer and send commands to
  client application, rendering engine, or the wizard.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>Render<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>This method is called from <span class=API>IMultiVMR9RenderEngine::Render</span>.
  Method performs actual rendering of the primitives of UI layer. Please note
  that this method must not call <span class=API>IDirect3Ddevice9::BeginScene</span>
  or <span class=API>IDirect3Ddevice9::EndScene</span>, because it is done
  inside rendering engine</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>SetRenderEngineOwner<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Rendering engine calls this method to inform UI Layer that
  it is the owner of the object. Also, when rendering engine is terminating, it
  sets the owner of its child UI Layer to NULL.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=API>GetRenderEngineOwner<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Returns pointer to <span class=API>IMultiVMR9RenderEngine</span>,
  the parent rendering engine object that currently owns this UI Layer</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h3>3.2. Samples</h3>

<h4>MultiSample</h4>

<p class=MsoNormal><kbd>Samples\cpp\DirectShow\VMR9\MultiVMR9\MultiPlayer</kbd>.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>This MFC-based sample implements default functionality of
MultiVMR9.dll, so make sure that MultiVMR9.dll is built and registered with
regsvr32.exe. MultiPlayer looks much like the property page of the VMR9 in the
mixing mode; the only evident difference is that this application supports
several filter graphs at once. Application starts with configuration dialog.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>1. Controls related to the application:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l11 level1 lfo16;tab-stops:list .5in'>To
     add a new source, hit '+' (‘plus’) button and select some media file.
     Application has not been tested on mpeg2 streams.</li>
 <li class=MsoNormal style='mso-list:l11 level1 lfo16;tab-stops:list .5in'>Use
     'FPS' slider to set desired frames per second rate. Default value is 30;
     possible range is [5; 100]</li>
 <li class=MsoNormal style='mso-list:l11 level1 lfo16;tab-stops:list .5in'>To
     exit application, hit 'Close'</li>
 <li class=MsoNormal style='mso-list:l11 level1 lfo16;tab-stops:list .5in'>To
     change the color of the background, hit 'brush' button and select the
     color</li>
</ul>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>2. Controls related to the selected item of the combo box:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l10 level1 lfo19;tab-stops:list .5in'>To
     delete the source, hit '-' (‘minus’)</li>
 <li class=MsoNormal style='mso-list:l10 level1 lfo19;tab-stops:list .5in'>Use
     sliders to change x,y positions and vertical and horizontal sizes</li>
 <li class=MsoNormal style='mso-list:l10 level1 lfo19;tab-stops:list .5in'>Use
     slider to change z-order of the source (0 is foremost)</li>
 <li class=MsoNormal style='mso-list:l10 level1 lfo19;tab-stops:list .5in'>Use
     slider to change alpha-level of the source</li>
 <li class=MsoNormal style='mso-list:l10 level1 lfo19;tab-stops:list .5in'>Use
     'Timeline' slider and buttons 'Play' and 'Pause' to control state and seek
     the stream.</li>
 <li class=MsoNormal style='mso-list:l10 level1 lfo19;tab-stops:list .5in'>Use
     'rulers' button to restore aspect ratio of selected source</li>
</ul>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Notes: Application does NOT support multiple monitors.
Desktop must be set to the 32 bit mode.</p>

<p class=MsoNormal>For other details, see the source code.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always'>
</span>

<h4>GameSample</h4>

<p class=MsoNormal><kbd>Samples\cpp\DirectShow\VMR9\MultiVMR9\GamePlayer.<o:p></o:p></kbd></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>This sample illustrates how to integrate video powered by
VMR9 into (some imaginary 3D game) Direct3D environment. Application uses the
same MultiVMR9.dll, but overrides IMultiVMR9MixerControl and IMultiVMR9UILayer.
Before building this sample, make sure that MultiVMR9.dll is built and
registered with regsvr32.exe. Please note that slow machines and older video
cards can demonstrate significant performance drop. Machines like Pentium-III
500MHz and up with videocards no older that 2 years would be enough.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Usage</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>1. Run GamePlayer</p>

<p class=MsoNormal>2. Select a few (3-5) mpeg1 or AVI movies and hit
&quot;start&quot;.</p>

<p class=MsoNormal>3. New window should appear; a girl walking along the wall.</p>

<p class=MsoNormal>4. In a few seconds, girl starts passing videos on the wall.</p>

<p class=MsoNormal>5. To focus on the highlighted movie, hit the yellow button
in the lower right corner.</p>

<p class=MsoNormal>6. To stop the presentation, go back to initial dialog and
hit &quot;stop&quot; and &quot;exit&quot;.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>For other details, see the source code.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
