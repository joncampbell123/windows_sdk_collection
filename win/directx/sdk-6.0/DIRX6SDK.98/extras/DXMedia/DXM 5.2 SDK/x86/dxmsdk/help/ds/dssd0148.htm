<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IFilterGraph2 Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0147.htm','/dssd0000.htm','/dssd0093.htm','/index.htm','/dssd0149.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_0001060137000000">IFilterGraph2 Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IFilterGraph2</B> interface adds new functionality to the <A HREF="dssd0153.htm" TARGET="TEXT">IGraphBuilder</A> and <A HREF="dssd0147.htm" TARGET="TEXT">IFilterGraph</A> interfaces. It inherits from both interfaces and exposes all their methods. This interface also includes a method to add a source for a moniker, and an improved version of the <A HREF="dssd0147.htm#If_0001060136030600" TARGET="TEXT">IFilterGraph::Reconnect</A> method. For this reason, you should usually use <B>IFilterGraph2</B> instead of the other two.

<A NAME="If_0001060137010000"></A><P><B>When to Implement
</B>
<P>The filter graph implements this interface so it isn't intended that you implement it.

<A NAME="If_0001060137020000"></A><P><B>When to Use
</B>
<P>Use this interface in applications that previously called <A HREF="dssd0147.htm#If_0001060136030600" TARGET="TEXT">IFilterGraph::Reconnect</A> and in applications that need a source filter for a moniker.

<A NAME="If_0001060137030000"></A><P><B>Methods in Vtable Order

</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0183.htm#If_000106015a030200" TARGET="TEXT">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0183.htm#If_000106015a030100" TARGET="TEXT">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0183.htm#If_000106015a030300" TARGET="TEXT">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IFilterGraph methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0148.htm#If_0001060137030100" TARGET="TEXT">AddSourceFilterForMoniker</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds a source for a moniker.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0148.htm#If_0001060137030200" TARGET="TEXT">ReconnectEx</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Specifies a pin and a media type to reconnect with.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="If_0001060137030100">IFilterGraph2::AddSourceFilterForMoniker</A></H3>
<A HREF="dssd0148.htm" TARGET="TEXT">IFilterGraph2 Interface</A>
<P>Adds a source for a <A HREF="dssd0419.htm#gloss_00010b010d000008" TARGET="TEXT">moniker</A>.
<P><B>HRESULT</B> <B>AddSourceFilterForMoniker</B><B>(</B><BR>&nbsp;&nbsp;<B>IMoniker</B> <I>*pMoniker</I><B>,</B><BR>&nbsp;&nbsp;<B>IBindCtx</B> <I>*pCtx</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpcwstrFilterName</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <I>**ppFilter</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pMoniker</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0406.htm#external_00010a0109000091" TARGET="TEXT">IMoniker</A> interface.
</DD><DT><I>pCtx</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0406.htm#external_00010a0109000042" TARGET="TEXT">IBindCtx</A> bind context interface.
</DD><DT><I>lpcwstrFilterName</I>
 </DT><DD>[in] Pointer to the filter's name.
</DD><DT><I>ppFilter</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="dssd0123.htm" TARGET="TEXT">IBaseFilter</A> interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0310.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface.

<H5>Remarks</H5>
<P>When adding a source filter for the given moniker to the graph, the COM <A HREF="dssd0406.htm#external_00010a0109000092" TARGET="TEXT">IMoniker::BindToStorage</A> member function will query for an <A HREF="dssd0406.htm#external_00010a01090000b1" TARGET="TEXT">IStream</A> interface. If this fails, <A HREF="dssd0406.htm#external_00010a0109000093" TARGET="TEXT">IMoniker::BindToObject</A> will try to retrieve an <A HREF="dssd0123.htm" TARGET="TEXT">IBaseFilter</A> interface.

<H3><HR COLOR="#0000FF"><A NAME="If_0001060137030200">IFilterGraph2::ReconnectEx</A></H3>
<A HREF="dssd0148.htm" TARGET="TEXT">IFilterGraph2 Interface</A>
<P>Specifies a pin and a media type to reconnect with.
<P><B>HRESULT</B> <B>ReconnectEx</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppin</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>AM_MEDIA_TYPE</B> <I>*pmt</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppin</I>
 </DT><DD>[in] Pin to disconnect and reconnect.
</DD><DT><I>pmt</I>
 </DT><DD>[in] Media type to reconnect with. Specify NULL to use the existing media type.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0310.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface.

<H5>Remarks</H5>
<P>Like the <A HREF="dssd0147.htm#If_0001060136030600" TARGET="TEXT">IFilterGraph::Reconnect</A> method, the <B>ReconnectEx</B> method schedules a reconnection of the pin with the pin it is currently connected to. By specifying a media type when this method is called, the pins don't have to check what type they were originally connected with or enumerate possible new types. This makes the reconnection more likely to succeed.

<H5>See Also</H5>
<P><A HREF="dssd0147.htm#If_0001060136030600" TARGET="TEXT">IFilterGraph::Reconnect</A><P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
