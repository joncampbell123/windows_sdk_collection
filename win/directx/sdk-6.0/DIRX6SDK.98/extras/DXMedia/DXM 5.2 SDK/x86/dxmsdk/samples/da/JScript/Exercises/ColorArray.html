<HTML> 
<HEAD>
<TITLE>DirectAnimation SDK, JScript sample</TITLE>
<SCRIPT LANGUAGE="JScript">
<!--
if (window.top.frames.length!=0 && window.top.frames[0].ShowNoButtons!=null)
    window.top.frames[0].ShowNoButtons();
//-->
</SCRIPT>
</HEAD>	 

<BODY BGCOLOR=WHITE TOPMARGIN=15 LEFTMARGIN=20>
<FONT FACE="Verdana, Arial, Helvetica" SIZE=2> 
<CENTER>
<H1>A DAArray of Colors</H1>
</CENTER>
          
<OBJECT ID="DAControl"
  STYLE= "left:100; top:100;width:300;height:300" 
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>

<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  // an array of DA colors
  clrs = new Array(m.Red, m.Green, m.Blue, m.Aqua, m.Fuchsia, m.Gray,
                   m.Lime, m.Maroon, m.Navy, m.Olive, m.Purple, 
                   m.Silver, m.Teal, m.Cyan, m.Magenta, m.Yellow, 
                   m.Black, m.White);
  // make a DA array out of it, so that we can use time varying index like below
  clrsDA = m.Array(clrs);    

  // a number that cycles through all the indices to the array repeatedly.
  // It traverses the integers in order and sticks to each for 1 second.
  index = m.Floor(m.Mod(m.LocalTime, m.DANumber(clrs.length)));
  // a color that switches between the colors of the array according to index
  clr = clrsDA.NthAnim(index);

  // define a red oval
  fillImg = m.SolidColorImage(clr);
  ovalImg = m.Oval(200,200).Fill(m.DefaultLineStyle, fillImg);

  // rotation by 45 degrees per sec around 3D first diagonal
  rotXf  = m.Rotate3RateDegrees(m.Vector3(1,1,1), 45).ParallelTransform2();   
  finalImg = ovalImg.Transform(rotXf);

  /* -- End code -- */

  // set the rotating oval, an image, as the model to be displayed
  DAControl.Image = finalImg; 
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()
//-->
</SCRIPT>
<P>
A time varying index based on the "Floor" function is used to select a color.
</FONT>
</BODY>
</HTML>
