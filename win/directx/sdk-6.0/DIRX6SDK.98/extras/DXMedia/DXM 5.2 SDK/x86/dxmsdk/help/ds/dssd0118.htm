<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IAMVfwCompressDialogs Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0117.htm','/dssd0000.htm','/dssd0093.htm','/index.htm','/dssd0119.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_0001060119000000">IAMVfwCompressDialogs Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IAMVfwCompressDialogs</B> interface enables an application to display a Video for Windows codec (compressor/decompressor) Configure or About dialog box and to set and retrieve compressor status.

<A NAME="If_0001060119010000"></A><P><B>When to Implement</B>
<P>Microsoft's video compression manager (VCM) compressor filter (<A CLASS=TCTOP HREF="dssd0317.htm#filteref_0001070106000000" TARGET="TEXT">AVI Compressor</A>) implements this interface. Other filters should not need to implement it.

<A NAME="If_0001060119020000"></A><P><B>When to Use</B>
<P>An application should use this interface when it must enable the user to change compression settings in an VCM compressor's Configure dialog box or to view the compressor's About dialog box. Applications also use this interface to set and retrieve compressor status.

<A NAME="If_0001060119030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0183.htm#If_000106015a030200" TARGET="TEXT">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0183.htm#If_000106015a030100" TARGET="TEXT">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0183.htm#If_000106015a030300" TARGET="TEXT">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMVfwCompressDialogs methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0118.htm#If_0001060119030400" TARGET="TEXT">ShowDialog</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Displays the specified dialog box.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0118.htm#If_0001060119030100" TARGET="TEXT">GetState</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the current configuration settings for the VCM codec currently being used.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0118.htm#If_0001060119030300" TARGET="TEXT">SetState</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets configuration for the ICM codec.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0118.htm#If_0001060119030200" TARGET="TEXT">SendDriverMessage</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sends a driver-specific message.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="If_0001060119030100">IAMVfwCompressDialogs::GetState</A></H3>
<A HREF="dssd0118.htm" TARGET="TEXT">IAMVfwCompressDialogs Interface</A>
<P>Retrieves the current configuration settings for the VCM codec currently being used.
<P><B>HRESULT</B> <B>GetState</B><B>(</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>pState</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <B>*pcbState</B> <H5>Parameters</H5>
<DL><DT><I>pState</I>
 </DT><DD>[out] State of the VCM codec.
</DD><DT><I>pcbState</I>
 </DT><DD>[in, out] Size of the state.
</DD></DL>
<H5>Return Values</H5>
<P> Return value varies depending on the implementation within each driver.

<H5>Remarks</H5>
<P>This method calls the COM <A HREF="dssd0406.htm#external_00010a0109000048" TARGET="TEXT">ICGetState</A> macro.

<H3><HR COLOR="#0000FF"><A NAME="If_0001060119030200">IAMVfwCompressDialogs::SendDriverMessage</A></H3>
<A HREF="dssd0118.htm" TARGET="TEXT">IAMVfwCompressDialogs Interface</A>
<P> Sends a driver-specific message.
<P><B>HRESULT</B> <B>SendDriverMessage</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>uMsg</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dw1</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dw2</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>uMsg</I>
 </DT><DD>[in] Message to send to the driver.
</DD><DT><I>dw1</I>
 </DT><DD>[in] Message data.
</DD><DT><I>dw2</I>
 </DT><DD>[in] Message data.
</DD></DL>
<H5>Return Values</H5>
<P> Return value varies depending on the implementation within each driver.

<H5>Remarks</H5>
<P>You should never need to use this method. This method can send any private message to the video compressor (codec). Behavior might
be undetermined in response to arbitrary messages; use this method at your own risk.

<P>This method calls the Video for Windows video compression manager (VCM) <A HREF="dssd0406.htm#external_00010a0109000047" TARGET="TEXT">ICSendMessage</A> function to send the message.
 

<H3><HR COLOR="#0000FF"><A NAME="If_0001060119030300">IAMVfwCompressDialogs::SetState</A></H3>
<A HREF="dssd0118.htm" TARGET="TEXT">IAMVfwCompressDialogs Interface</A>
<P>Sets configuration for the VCM codec.
<P><B>HRESULT</B> <B>SetState</B><B>(</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>pState</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>cbState</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pState</I>
 </DT><DD>[in] State of the VCM codec.
</DD><DT><I>cbState</I>
 </DT><DD>[in] Size of the state.
</DD></DL>
<H5>Return Values</H5>
<P> Return value varies depending on the implementation within each driver.

<H5>Remarks</H5>
<P>This method calls the COM <B>ICSetState</B> macro, which notifies a video compression driver to set the state of the compressor.

<H3><HR COLOR="#0000FF"><A NAME="If_0001060119030400">IAMVfwCompressDialogs::ShowDialog</A></H3>
<A HREF="dssd0118.htm" TARGET="TEXT">IAMVfwCompressDialogs Interface</A>
<P> Displays the specified dialog box.
<P><B>HRESULT</B> <B>ShowDialog</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>iDialog</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>hwnd</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>iDialog</I>
 </DT><DD>[in] Dialog box to display. This is a member of the <A HREF="dssd0301.htm#dtypes_0001060601002400" TARGET="TEXT">VfwCompressDialogs</A> enumerated data type.
</DD><DT><I>hwnd</I>
 </DT><DD>[in] Handle of the dialog box's parent window.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0310.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>This method returns an error when asked to display a dialog box while the driver is streaming or displaying another dialog box. While the driver displays the dialog box you can't stream (pause or run) the filter.

<P><B>IAMVfwCompressDialogs::ShowDialog</B> calls the Video for Windows video compression manager (VCM) functions <A HREF="dssd0406.htm#external_00010a0109000044" TARGET="TEXT">ICConfigure</A>, <A HREF="dssd0406.htm#external_00010a0109000043" TARGET="TEXT">ICAbout</A>, <B>ICQueryConfigure</B>, and I<B>CQueryAbout</B> to display the appropriate dialog box or determine if one exists.
<p>The VfwCompressDialog_QueryConfig and VfwCompressDialog_QueryAbout members of the <A HREF="dssd0301.htm#dtypes_0001060601002400" TARGET="TEXT">VfwCompressDialogs</A> enumerated data type tell you whether or not the configure dialog or about dialog is available. If passed one of these flags, the filter will return S_OK if the dialog exists, and S_FALSE if it does not. If a dialog is available, you should then call <B>ShowDialog</B> again with the value VfwCompressDialog_Config or VfwCompressDialog_About to bring up the dialog.


 <P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
