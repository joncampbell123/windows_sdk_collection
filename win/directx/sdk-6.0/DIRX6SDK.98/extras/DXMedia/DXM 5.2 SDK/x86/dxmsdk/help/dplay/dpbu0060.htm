<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::SendChatMessage</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0059.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0061.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03002500">IDirectPlay3::SendChatMessage</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Sends a text message to another player, a group of players, or all players. This method supports both Unicode (the <A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3</A> interface) and ANSI strings (the <A CLASS=tctop HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3A</A> interface). The player receiving the chat message is informed through a <A HREF="dpbu0096.htm" TARGET="TEXT">DPMSG_CHAT</A> system message in the player's receive queue. This method must be used in a lobby session. 
<P><B>HRESULT</B> <B>SendChatMessage</B><B>(</B><BR>&nbsp;&nbsp;<B>DPID</B> <I>idFrom</I><B>,</B><BR>&nbsp;&nbsp;<B>DPID</B> <I>idTo</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDPCHAT</B> <I>lpChatMessage</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>idFrom</I>
</DT><DD>ID of the sending player. The player ID must correspond to one of the local players on this computer.
</DD><DT><I>idTo</I>
</DT><DD>ID of the player to send the message to, the group ID of the group of players to send the message to, or DPID_ALLPLAYERS to send the message to all players in the session. 
</DD><DT><I>dwFlags</I>
</DT><DD>Indicates how the message should be sent. If this parameter is set to 0, the message is sent nonguaranteed. 
<DL>
<DT>DPSEND_GUARANTEED
</DT><DD>Sends the message by using a guaranteed method of delivery if it is available.
</DD></DL>
</DD><DT><I>lpChatMessage</I>
</DT><DD>Pointer to a <A HREF="dpbu0084.htm" TARGET="TEXT">DPCHAT</A> structure containing the message to be sent.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful or one of the following error values:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a09000003" TARGET="TEXT">DPERR_ACCESSDENIED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000019" TARGET="TEXT">DPERR_INVALIDFLAGS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001f" TARGET="TEXT">DPERR_INVALIDPLAYER</A>
</DT></DL>
<P>This method returns <A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A> if the <I>idTo</I> ID is not a valid player or group. It returns <A HREF="dpbu0120.htm#ref_0001010a0900001f" TARGET="TEXT">DPERR_INVALIDPLAYER</A> if the <I>idFrom</I> ID is not a valid player. It returns <A HREF="dpbu0120.htm#ref_0001010a09000003" TARGET="TEXT">DPERR_ACCESSDENIED</A> if the <I>idFrom</I> ID is not a local player.


<H5>Remarks</H5>
<P>This method facilitates player to player chatting within a lobby session where it is possible for different client applications to be connected. You must use this method in a lobby session. Use is optional in an application seession.
<P>The receiving player will receive a system message (<I>idFrom</I> = DPID_SYSTEM). The <A HREF="dpbu0084.htm" TARGET="TEXT">DPCHAT</A> structure will specify which player the chat message came from.
<H5>See Also</H5>
<P><A HREF="dpbu0084.htm" TARGET="TEXT">DPCHAT</A>, <A HREF="dpbu0096.htm" TARGET="TEXT">DPMSG_CHAT</A>, <A HREF="dpbu0059.htm" TARGET="TEXT">IDirectPlay3::Send</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
