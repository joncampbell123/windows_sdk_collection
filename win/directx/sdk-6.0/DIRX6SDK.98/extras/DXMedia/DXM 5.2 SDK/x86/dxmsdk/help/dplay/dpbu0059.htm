<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::Send</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0058.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0060.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03002400">IDirectPlay3::Send</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Sends a message to another player, to a group of players, or to all players in the session.
To send a message to another player, specify the target player's player ID. To send a message to a group of players, send the message to the group ID assigned to the group. To send a message to the entire session, send the message to the player ID DPID_ALLPLAYERS. Messages can be sent using either a guaranteed or nonguaranteed protocol on a per message basis. If the session is being hosted on a secure server, messages can be sent encrypted (to ensure privacy) or digitally signed (to ensure authenticity) on a per message basis. 
<P><B>HRESULT</B> <B>Send</B><B>(</B><BR>&nbsp;&nbsp;<B>DPID</B> <I>idFrom</I><B>,</B><BR>&nbsp;&nbsp;<B>DPID</B> <I>idTo</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpData</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwDataSize</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>idFrom</I>
</DT><DD>ID of the sending player. The player ID must correspond to one of the local players on this computer.
</DD><DT><I>idTo</I>
</DT><DD>The destination ID of the message. To send a message to another player, specify the ID of the player. To send a message to all the players in a group, specify the ID of the group. To send a message to all the players in the session, use the constant symbol DPID_ALLPLAYERS. To send a message to the server player, specify the constant symbol DPID_SERVERPLAYER. A player cannot send a message to itself.
</DD><DT><I>dwFlags</I>
</DT><DD>Indicates how the message should be sent. By default (<I>dwFlags</I> = 0), the message is sent nonguaranteed. 
<DL>
<DT><B><A NAME="ref_0001010a03002401">DPSEND_ENCRYPTED</A></B>
</DT><DD>Sends the messages encrypted. This can only be done in a secure session. This flag can only be used if the <A HREF="dpbu0059.htm#ref_0001010a03002402" TARGET="TEXT">DPSEND_GUARANTEED</A> flag is also set. The message will be sent as a <A HREF="dpbu0103.htm" TARGET="TEXT">DPMSG_SECUREMESSAGE</A> system message.
</DD><DT><B><A NAME="ref_0001010a03002402">DPSEND_GUARANTEED</A></B>
</DT><DD>Sends the message by using a guaranteed method of delivery if it is available.
</DD><DT><B><A NAME="ref_0001010a03002403">DPSEND_SIGNED</A></B>
</DT><DD>Sends the message with a digital signature. This can only be done in a secure session. This flag can only be used if the <A HREF="dpbu0059.htm#ref_0001010a03002402" TARGET="TEXT">DPSEND_GUARANTEED</A> flag is also set. The message will be sent as a <A HREF="dpbu0103.htm" TARGET="TEXT">DPMSG_SECUREMESSAGE</A> system message.

</DD></DL>
</DD><DT><I>lpData</I>
</DT><DD>Pointer to the data being sent. 
</DD><DT><I>dwDataSize</I>
</DT><DD>Length of the data being sent.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful or one of the following error values:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a09000009" TARGET="TEXT">DPERR_BUSY</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001f" TARGET="TEXT">DPERR_INVALIDPLAYER</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900002a" TARGET="TEXT">DPERR_NOTLOGGEDIN</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900002d" TARGET="TEXT">DPERR_SENDTOOBIG</A>
</DT></DL>
<P>This method returns DPERR_INVALIDPARAMS if the encrypted or signed flag is specified for a message that is not also specified as guaranteed. It returns DPERR_NOTLOGGEDIN when the client application tries to send a secure message without first logging in.


<H5>Remarks</H5>
<P>Messages can be sent guaranteed or nonguaranteed. By default, messages are sent nonguaranteed which means that DirectPlay does no verification that the message reached the intended recipient. Sending a guaranteed message takes much longer; a minimum of 2 to 3 times longer than nonguaranteed messages. Applications should try to minimize sending guaranteed messages as much as possible and design the application to tolerate lost messages. All the service providers shipped with DirectPlay perform integrity checks on the data to protect against corruption. Any message retrieved using this method is guaranteed to be free from corruption.


<P>A player cannot send a message to itself. If a player sends a message to a group that it is part of or to DPID_ALLPLAYERS, it will not receive a copy of that message. The exception to this rule is if the DPSESSION_NOMESSAGEID was specified in the session description (<A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A>). Then it is possible for a player to receive a message that it sent to a group. Because there is no DirectPlay message ID header on the message (indicating who sent the message), it cannot filter out messages based on the message ID.

<P>When DPSESSION_NOMESSAGEID is used, the <I>idFrom</I> parameter has no meaning and the <I>idTo</I> parameter is used simply to direct the message to the correct target computer. If the target computer has more than one player on it, it cannot be determined whose receive queue the message will appear in. When the message is received, it will appear to have come from player DPID_UNKNOWN.

<P>There is no limit to the size of messages that can be transmitted using the <B>Send</B> method. DirectPlay will automatically break up large messages into packets (packetize) and reassemble them on the receiving end. Beware of sending large messages nonguaranteed&#151;if even one of the packets fails to reach the receiver then the entire message will be ignored. The application can determine the maximum size of a message before it starts packetizing by calling <A CLASS=tctop HREF="dpbu0040.htm" TARGET="TEXT">GetCaps</A> and examining the <A HREF="dpbu0083.htm#ref_0001010a0500020a" TARGET="TEXT">dwMaxBufferSize</A> member of the <A HREF="dpbu0083.htm" TARGET="TEXT">DPCAPS</A> structure.

<P>When you send an encryted or signed message, it is not delivered as an application message, but as a system message, <A HREF="dpbu0103.htm" TARGET="TEXT">DPMSG_SECUREMESSAGE</A>.


<H5>See Also</H5>
<P><A HREF="dpbu0057.htm" TARGET="TEXT">IDirectPlay3::Receive</A>, <A HREF="dpbu0060.htm" TARGET="TEXT">IDirectPlay3::SendChatMessage</A>, <A HREF="dpbu0103.htm" TARGET="TEXT">DPMSG_SECUREMESSAGE</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
