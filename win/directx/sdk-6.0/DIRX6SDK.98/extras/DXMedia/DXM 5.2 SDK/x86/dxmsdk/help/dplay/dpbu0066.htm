<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::SetSessionDesc</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0065.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0067.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03002b00">IDirectPlay3::SetSessionDesc</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Changes the properties of the current session. Only the host of the session can change the session properties. If a nonhost attempts to call it, the method returns DPERR_ACCESSDENIED.
<P>The updated session description will be propagated to all the other computers in the session. Each player will receive a <A HREF="dpbu0107.htm" TARGET="TEXT">DPMSG_SETSESSIONDESC</A> system message.
<P>You can't use <B>SetSessionDesc</B> in a lobby session.

<P><B>HRESULT</B> <B>SetSessionDesc</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDPSESSIONDESC2</B> <I>lpSessDesc</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpSessDesc</I>
</DT><DD>Pointer to the <A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A> structure containing the new settings.
</DD><DT><I>dwFlags</I>
</DT><DD>No flags are currently used by this method.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a09000003" TARGET="TEXT">DPERR_ACCESSDENIED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000028" TARGET="TEXT">DPERR_NOSESSIONS</A>
</DT></DL>
<P>This method returns <A HREF="dpbu0120.htm#ref_0001010a09000003" TARGET="TEXT">DPERR_ACCESSDENIED</A> if this computer does not have permission to change the session. Only the host can change the session properties. It returns <A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A> if the application attempts to change a property in the session description that cannot be changed or tries to give a property an invalid value. 

<H5>Remarks</H5>
<P>Changing the session description will cause a <A CLASS=tctop HREF="dpbu0007.htm#usingdp_0001010701060200" TARGET="TEXT">DPSYS_SETSESSIONDESC</A> system message to be generated on all the other computers in the session.

<P>The following members and flags of the <A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A> structure can be changed using <B>IDirectPlay3::SetSessionDesc</B>:
<DL>
<DT><I>dwFlags</I>
</DT><DD><A HREF="dpbu0092.htm#ref_0001010a05000b04" TARGET="TEXT">DPSESSION_JOINDISABLED</A>
</DD><DD><A HREF="dpbu0092.htm#ref_0001010a05000b08" TARGET="TEXT">DPSESSION_NEWPLAYERSDISABLED</A>
</DD><DD><A HREF="dpbu0092.htm#ref_0001010a05000b09" TARGET="TEXT">DPSESSION_NODATAMESSAGES</A>
</DD><DD><A HREF="dpbu0092.htm#ref_0001010a05000b0c" TARGET="TEXT">DPSESSION_PRIVATE</A>
</DD><DT><I>dwMaxPlayers</I>
 </DT><DD>If you set the maximum players to a value less than the current number of players, the method returns <A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>.
</DD><DT><I>lpszSessionName</I> / <I>lpszSessionNameA</I>
</DT><DT><I>lpszPassword</I> / <I>lpszPasswordA</I>
</DT><DT><I>dwUser1</I>
</DT><DT><I>dwUser2</I>
</DT><DT><I>dwUser3</I>
</DT><DT><I>dwUser4</I>


</DT></DL>
<P>If the following members and flags of the <A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A> structure are changed, an error will occur (for example, if the <A HREF="dpbu0092.htm#ref_0001010a05000b05" TARGET="TEXT">DPSESSION_KEEPALIVE</A> flag is currently set and you try to set this bit, you will not get an error, but if you try to clear this bit, you will get an error and <B>IDirectPlay3::SetSessionDesc</B> will fail):
<DL>
<DT><I>dwSize</I>
</DT><DT><I>dwFlags</I>
</DT><DD><A HREF="dpbu0092.htm#ref_0001010a05000b0a" TARGET="TEXT">DPSESSION_NOMESSAGEID</A>
</DD><DD><A HREF="dpbu0092.htm#ref_0001010a05000b05" TARGET="TEXT">DPSESSION_KEEPALIVE</A>
</DD></DL>
<P>The following members of the <A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A> structure are ignored (that is, it does not matter what you pass in these members&#151;DirectPlay will always use the values passed when <A HREF="dpbu0056.htm" TARGET="TEXT">IDirectPlay3::Open</A> was called):
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>guidInstance</I>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>guidApplication</I>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>dwCurrentPlayers</I>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>dwReserved1</I>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>dwReserved2</I>
</FONT></TD></TR></TABLE>
<H5>See Also</H5>
<P><A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A>, <A HREF="dpbu0053.htm" TARGET="TEXT">IDirectPlay3::GetSessionDesc</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
