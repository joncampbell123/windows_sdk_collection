<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::EnumConnections</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0033.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0035.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03000b00">IDirectPlay3::EnumConnections</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Enumerates all the registered service providers and lobby providers that are available to the application. These should be presented to the user to make a selection. The connection that the user selects should be passed to the <A HREF="dpbu0055.htm" TARGET="TEXT">IDirectPlay3::InitializeConnection</A> method.

<P><B>HRESULT</B> <B>EnumConnections</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCGUID</B> <I>lpguidApplication</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDPENUMCONNECTIONSCALLBACK</B> <I>lpEnumCallback</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpContext</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpguidApplication</I>
</DT><DD>Pointer to an application GUID. Only service providers and lobby providers that are usable by this application will be returned. If set to a NULL pointer, a list of all the connections is enumerated regardless of the application GUID.
</DD><DT><I>lpEnumCallback</I>
</DT><DD>Pointer to a user-supplied <A HREF="dpbu0018.htm" TARGET="TEXT">EnumConnectionsCallback</A> function that will be called for each available connection.
</DD><DT><I>lpContext</I>
</DT><DD>Pointer to a user-defined context that is passed to the callback function.
</DD><DT><I>dwFlags</I>
</DT><DD>Flags that specify the type of connections to be enumerated. The default (<I>dwFlags</I> = 0) will enumerate DirectPlay service providers only. Possible values are:
</DD><DD><B><A NAME="ref_0001010a03000b01">DPCONNECTION_DIRECTPLAY</A></B> &#150; enumerate DirectPlay service providers to communicate in an application session.
</DD><DD><B><A NAME="ref_0001010a03000b02">DPCONNECTION_DIRECTPLAYLOBBY</A></B> &#150; enumerate DirectPlay lobby providers to communicate with a lobby server.

</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a09000019" TARGET="TEXT">DPERR_INVALIDFLAGS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT></DL>

<H5>Remarks</H5>
<P>This method replaces the <A HREF="dpbu0013.htm" TARGET="TEXT">DirectPlayEnumerate</A> function. <B>DirectPlayEnumerate</B> still works, but only returns registered service providers.

<P>The order in which the service and lobby providers are returned is not guaranteed to be the same in subsequent calls to <B>EnumConnections</B>

<P>Not all the enumerated connections are available for use. For example, this method will return the Modem service provider even if the user has no modem installed. The application can call the <A HREF="dpbu0055.htm" TARGET="TEXT">IDirectPlay3::InitializeConnection</A> method on each connection and check for an error code to determine if the service provider can be used.
<H5>See Also</H5>
<P><A HREF="dpbu0055.htm" TARGET="TEXT">IDirectPlay3::InitializeConnection</A>, <A HREF="dpbu0018.htm" TARGET="TEXT">EnumConnectionsCallback</A>, <A CLASS=tctop HREF="dpbu0007.htm#usingdp_0001010701070000" TARGET="TEXT">DirectPlay Address</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
