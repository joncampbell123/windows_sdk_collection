<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::SecureOpen</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0057.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0059.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03002300">IDirectPlay3::SecureOpen</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Creates or joins a secure session. When joining a secure session, use this method to supply login credentials.
<P>When creating a new session, the host computer can specify an alternate security package to use. When joining a session, a computer can specify a user name and password.
<P><B>HRESULT</B> <B>IDirectPlay3::SecureOpen</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCDPSESSIONDESC2</B> <I>lpsd</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCDPSECURITYDESC</B> <I>lpSecurity</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCDPCREDENTIALS</B> <I>lpCredentials</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>lpsd</I>
</DT><DD>Pointer to the <A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A> structure describing the session to be created or joined. If a session is to be joined, then only the <A HREF="dpbu0092.htm#ref_0001010a05000b0e" TARGET="TEXT">guidInstance</A> and <B>lpszPassword</B> members need to be specified. The password need only be supplied if the enumerated session had the DPSESSION_PASSWORDREQUIRED flag set.
</DD><DD>If a session is to be created, then the application must completely fill out the <A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A> structure with the properties of the sessions to be created. The <I>guidInstance</I> will be generated by DirectPlay. NOTE: The DPSESSION_SECURESERVER flag must be set to indicate that all computers attempting to open the session must be authenticated. 
<P>If you don't specify the DPSESSION_SECURESERVER flag when filling out the <A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A> structure, <B>SecureOpen</B> will open an unsecure session, just as if you had called <A HREF="dpbu0056.htm" TARGET="TEXT">Open</A>. 
</DD><DT><I>dwFlags</I>
</DT><DD>One of the following flags: 
<DL>
<DT><A HREF="dpbu0056.htm#ref_0001010a03002101" TARGET="TEXT">DPOPEN_CREATE</A>
</DT><DD>Creates a new instance of a secured session.
</DD><DT><A HREF="dpbu0056.htm#ref_0001010a03002102" TARGET="TEXT">DPOPEN_JOIN</A>
</DT><DD>Joins an existing instance of a secured session. 
</DD><DT><A HREF="dpbu0056.htm#ref_0001010a03002103" TARGET="TEXT">DPOPEN_RETURNSTATUS</A>
</DT><DD>If this flag is specified, the method will not display any dialog boxes showing the connection progress status. If the connection cannot be made immediately, the method will return with the <A HREF="dpbu0120.htm#ref_0001010a09000014" TARGET="TEXT">DPERR_CONNECTING</A> error. The application must keep calling <B>SecureOpen</B> until either DP_OK is returned, indicating successful completion, or some other error code is returned, indicating an error.
</DD></DL>
</DD><DT><I>lpSecurity</I>
</DT><DD>Pointer to a <A HREF="dpbu0091.htm" TARGET="TEXT">DPSECURITYDESC</A> structure containing the security package to use. Set this parameter to NULL to use the default security package (NT LAN Manager) and CryptoAPI package (Microsoft RSA Base Cryptographic Provider). Relevant only when creating a session. Must be set to NULL when joining a session.
</DD><DT><I>lpCredentials</I>
</DT><DD>Pointer to a <A HREF="dpbu0087.htm" TARGET="TEXT">DPCREDENTIALS</A> structure containing the logon name, password, and domain to be authenticated on the server. NULL if there are no credentials. Credentials are ignored when creating a session.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful or one of the following error values:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a09000003" TARGET="TEXT">DPERR_ACCESSDENIED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000005" TARGET="TEXT">DPERR_ALREADYINITIALIZED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000007" TARGET="TEXT">DPERR_AUTHENTICATIONFAILED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000010" TARGET="TEXT">DPERR_CANTLOADCAPI</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000011" TARGET="TEXT">DPERR_CANTLOADSECURITYPACKAGE</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000012" TARGET="TEXT">DPERR_CANTLOADSSPI</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000014" TARGET="TEXT">DPERR_CONNECTING</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000015" TARGET="TEXT">DPERR_ENCRYPTIONFAILED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000018" TARGET="TEXT">DPERR_INVALIDCREDENTIALS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000019" TARGET="TEXT">DPERR_INVALIDFLAGS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001e" TARGET="TEXT">DPERR_INVALIDPASSWORD</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000020" TARGET="TEXT">DPERR_LOGONDENIED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000022" TARGET="TEXT">DPERR_NOCONNECTION</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000026" TARGET="TEXT">DPERR_NONEWPLAYERS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900002f" TARGET="TEXT">DPERR_SIGNFAILED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000030" TARGET="TEXT">DPERR_TIMEOUT</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000032" TARGET="TEXT">DPERR_UNINITIALIZED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000035" TARGET="TEXT">DPERR_USERCANCEL</A>
</DT></DL>
<P>This method <A HREF="dpbu0120.htm#ref_0001010a09000020" TARGET="TEXT">DPERR_LOGONDENIED</A> after being called with invalid creadentials or without credentials when credentials are required. The application must collect the user's credentials and call <B>SecureOpen</B> again. 

<H5>Remarks</H5>
<P>When joining a session, first call <B>SecureOpen</B> with no credentials. If the method returns <A HREF="dpbu0120.htm#ref_0001010a09000020" TARGET="TEXT">DPERR_LOGONDENIED</A>, then the application must collect the user name and password from the user and call <B>SecureOpen</B> again, passing in the user's credentials through the <I>lpCredentials</I> parameter. If the method returns DP_OK, then the player was able to login with the credentials he or she had specified earlier during system logon (network logon in NTLM). 
<H5>See Also</H5>
<P><A HREF="dpbu0056.htm" TARGET="TEXT">IDirectPlay3::Open</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
