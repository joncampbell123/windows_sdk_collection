<HTML> 
<HEAD>
<TITLE>DirectAnimation SDK, JScript sample</TITLE>
<SCRIPT LANGUAGE="JScript">
<!--
if (window.top.frames.length!=0 && window.top.frames[0].ShowNoButtons!=null)
    window.top.frames[0].ShowNoButtons();
//-->
</SCRIPT>
</HEAD>	 

<BODY BGCOLOR=WHITE TOPMARGIN=15 LEFTMARGIN=20>
<FONT FACE="Verdana, Arial, Helvetica" SIZE=2> 
<CENTER>
<H1>Oscillating House </H1>
</CENTER>        

<P>
With coordinated pan on midi sound.
<P>

<OBJECT ID="DAControl" WIDTH=400 HEIGHT=400 ALIGN=Center   
   CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT><BR>

<SCRIPT LANGUAGE="JScript">
<!--
  m = DAControl.PixelLibrary;  
  
  mediaBase = "..\\..\\..\\..\\media\\";
  midiBase = mediaBase + "midi\\";
  snd = m.ImportSound(midiBase + "island.mid").Sound;	
  
  roofFillImg = m.SolidColorImage(m.Red);
  roofImg = m.Polyline(new Array(-85,-50, 0,-125, 85,-50)).close().
             Fill(m.DefaultLineStyle, roofFillImg);
  wallFillImg = m.SolidColorImage(m.Teal);
  wallImg = m.Polyline(new Array(-75,50, -75,-50, 75,-50, 75,50)).
             Fill(m.DefaultLineStyle, wallFillImg);
  doorFillImg = m.GradientHorizontal(m.Maroon, m.Navy, 1);
  doorArr = new Array(-25,50, -25,0, 25,0, 25,50);
  doorFillImg = m.GradientPolygon(doorArr, 
                    new Array(m.Red, m.Green, m.Blue, m.Yellow));
  doorImg = m.Polyline(doorArr).
             Fill(m.DefaultLineStyle, doorFillImg);
  grassFillImg = m.SolidColorImage(m.Green);
  grassImg = m.Polyline(new Array(-150,75, -150,50, 150,50, 150,75)).close().
             Fill(m.DefaultLineStyle, grassFillImg);

  houseImg = m.OverlayArray(new Array(doorImg, roofImg, wallImg, grassImg));


  // number that varries from -1 to 1 and back
  oscNum = m.Sin(m.LocalTime);

  // use this oscillating number as a rotational angle in radians
  rotImg = houseImg.Transform(m.Rotate2Anim(oscNum));

  DAControl.Image = rotImg;

  DAControl.Sound = snd.Loop().PanAnim(oscNum);

  DAControl.Start()
//-->
</SCRIPT>
</FONT>
</BODY>
</HTML>
