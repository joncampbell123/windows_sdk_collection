<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>EnumSessionsCallback2</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0021.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0023.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a02000700">EnumSessionsCallback2</A></H2>
<BR CLEAR=ALL>
<P>Application-defined callback function for the <A HREF="dpbu0039.htm" TARGET="TEXT">IDirectPlay3::EnumSessions</A> method.

<P><B>BOOL</B> <B>FAR</B> <B>PASCAL</B> <B>EnumSessionsCallback2</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCDPSESSIONDESC2</B> <I>lpThisSD</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDWORD</B> <I>lpdwTimeOut</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpContext</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpThisSD</I>
</DT><DD>Pointer to a <A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A> structure describing the enumerated session. This parameter will be set to NULL if the enumeration has timed out.
</DD><DT><I>lpdwTimeOut</I>
</DT><DD>Pointer to a variable containing the current time-out value. This parameter can be reset when the DPESC_TIMEDOUT flag is returned if you want to wait longer for sessions to reply. 
</DD><DT><I>dwFlags</I>
</DT><DD>Typically, this flag is set to zero.
<DL>
<DT><B><A NAME="ref_0001010a02000701">DPESC_TIMEDOUT</A></B>
</DT><DD>The enumeration has timed out. Reset <I>lpdwTimeOut</I> and return TRUE to continue, or FALSE to stop the enumeration.
</DD></DL>
</DD><DT><I>lpContext</I>
</DT><DD>Pointer to an application-defined context.
</DD></DL>
<H5>Return Values</H5>
<P>Returns TRUE to continue the enumeration or FALSE to stop it.

<H5>Remarks</H5>
<P>The application must implement this function in order to use the <A HREF="dpbu0039.htm" TARGET="TEXT">IDirectPlay3::EnumSessions</A> method. This callback function will be called once for each session that is enumerated. Once all the session are enumerated, the callback function will be called one additional time with the DPESC_TIMEDOUT flag.
<P>Applications should look at the flags of the <A HREF="dpbu0092.htm" TARGET="TEXT">DPSESSIONDESC2</A> to determine the nature of the session.

<P>Any pointers returned in a callback function are temporary and are valid only in the body of the callback function. If the application needs to save pointer information, it must allocate memory to hold the data, copy the data, and then store the pointer to this new data. In this function, <I>lpThisSD</I> is temporary. Also note that the pointers inside the structure specified in the <I>lpThisSD</I> parameter&#151;<I>lpszSessionName</I> / <I>lpszSessionNameA</I> and <I>lpszPassword</I> / <I>lpszPasswordA</I>&#151;are also temporary.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
