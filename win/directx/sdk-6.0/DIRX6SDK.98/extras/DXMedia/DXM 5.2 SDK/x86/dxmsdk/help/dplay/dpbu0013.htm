<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>DirectPlayEnumerate</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0012.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0014.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a01000200">DirectPlayEnumerate</A></H2>
<BR CLEAR=ALL>
<P>Enumerates the DirectPlay <A HREF="dpbu0130.htm#dpgloss_0001010b09000002" TARGET="TEXT">service provider</A>s installed on the system.
<P>This function is obsolete and remains for compatibility with applications written using DirectX 3. It will only enumerate service providers, not DirectPlay Addresses (connections). It is recommended that applications use the <A HREF="dpbu0034.htm" TARGET="TEXT">IDirectPlay3::EnumConnections</A> method to enumerate all the connections available to the application after creating an <A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3</A> interface.

<P>This function will not enumerate service providers that have the <B>Enumerate</B> value in the registry set to zero. For backward compatibility, this function will only return simple service providers registered under the "Service Providers" registry key.

<P><B>HRESULT</B> <B>WINAPI</B> <B>DirectPlayEnumerate</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDPENUMDPCALLBACK</B> <I>lpEnumCallback</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpContext</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpEnumCallback</I>
</DT><DD>Pointer to a callback function that will be called with a description of each DirectPlay service provider installed in the system. Depending on whether UNICODE is defined or not, the prototype for the callback function will have the service provider name <I>lpSPName</I> defined as a LPWSTR (for Unicode) or LPSTR (for ANSI).
</DD><DT><I>lpContext</I>
</DT><DD>Pointer to an application-defined structure that will be passed to the callback function each time the function is called.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise: 
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a09000016" TARGET="TEXT">DPERR_EXCEPTION</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000017" TARGET="TEXT">DPERR_GENERIC</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT></DL>
<P>DPERR_INVALIDPARAMS is returned if an invalid enumeration callback was supplied.

<H5>Remarks</H5>
<P>This function will enumerate service providers installed in the system even though the system might not be capable of using those service providers. For example, a TAPI service provider will be part of the enumeration even though the system might not have a modem installed.
<H5>See Also</H5>
<P><A HREF="dpbu0034.htm" TARGET="TEXT">IDirectPlay3::EnumConnections</A>, <A HREF="dpbu0012.htm" TARGET="TEXT">DirectPlayCreate</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
