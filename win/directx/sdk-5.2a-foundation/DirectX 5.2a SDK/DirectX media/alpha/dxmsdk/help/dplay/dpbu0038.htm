<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::EnumPlayers</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0037.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0039.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03000f00">IDirectPlay3::EnumPlayers</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Enumerates the players in the current open session. If there is no open session, players in a remote session can be enumerated by specifying the DPENUMPLAYERS_SESSION flag and the <I> guidInstance</I> of the session. Password protected remote sessions cannot be enumerated.
<P>A pointer to an application-implemented callback function must be supplied and DirectPlay calls it once for each player in the session that matches the criteria specified in <I>dwFlags</I>.

<P>Within a lobby session, this method will always return DPERR_ACCESSDENIED.
<P><B>HRESULT</B> <B>EnumPlayers</B><B>(</B><BR>&nbsp;&nbsp;<B>LPGUID</B> <I>lpguidInstance</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDPENUMPLAYERSCALLBACK2</B> <I>lpEnumPlayersCallback2</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpContext</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpguidInstance</I>
</DT><DD>This parameter should be NULL to enumerate players in the currently open session. If there is no open session, this parameter can be a pointer to a GUID identifying the session to be enumerated. The GUID must be equal to one of the sessions enumerated by <A HREF="dpbu0039.htm" TARGET="TEXT">IDirectPlay3::EnumSessions</A>. This parameter is ignored unless the DPENUMPLAYERS_SESSION flag is specified. 
</DD><DT><I>lpEnumPlayersCallback2</I>
</DT><DD>Pointer to the <A HREF="dpbu0021.htm" TARGET="TEXT">EnumPlayersCallback2</A> function that will be called for every player in the session that matches the criteria specified in <I>dwFlags</I>.

</DD><DT><I>lpContext</I>
</DT><DD>Pointer to an application-defined context that is passed to each enumeration callback.
</DD><DT><I>dwFlags</I>
</DT><DD>Flags specifying how the enumeration is to be done. Default (<I>dwFlags</I> = 0) enumerates all players in the current active session. You should OR together the flags that you want to specify. Only players that meet all the criteria of the combined flags will be enumerated. For example, if you specify (DPENUMPLAYERS_LOCAL | DPENUMPLAYERS_SPECTATOR) only players that are local and are spectator players will be enumerated. If you specify (DPENUMPLAYERS_LOCAL | DPENUMPLAYERS_REMOTE), no players will be enumerated because no player can be both local and remote. 
</DD><DD>Can be one or more of the following values:

<DL>
<DT><B><A NAME="ref_0001010a03000f01">DPENUMPLAYERS_ALL</A></B>
</DT><DD>Enumerates all players in this session. 
</DD><DT><B><A NAME="ref_0001010a03000f02">DPENUMPLAYERS_GROUP</A></B>
</DT><DD>Includes groups in the enumeration of players. 
</DD><DT><B><A NAME="ref_0001010a03000f03">DPENUMPLAYERS_LOCAL</A></B>
</DT><DD>Enumerates players created locally by this DirectPlay object. 
</DD><DT><B><A NAME="ref_0001010a03000f04">DPENUMPLAYERS_REMOTE</A></B>
</DT><DD>Enumerates players created by remote DirectPlay objects. 
</DD><DT><B><A NAME="ref_0001010a03000f05">DPENUMPLAYERS_SERVERPLAYER</A></B>
</DT><DD>Enumerates the server player. 
</DD><DT><B>DPENUMPLAYERS_SESSION</B>
</DT><DD>Enumerates the players for the session identified by <I>lpguidInstance</I>. This flag can only be used if there is no current open session. 
</DD><DT><B><A NAME="ref_0001010a03000f06">DPENUMPLAYERS_SPECTATOR</A></B>
</DT><DD>Enumerates players who are spectator players. 
</DD></DL>
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A> 
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000028" TARGET="TEXT">DPERR_NOSESSIONS</A> 
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000031" TARGET="TEXT">DPERR_UNAVAILABLE</A> 
</DT></DL>
<P>This method returns <A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A> if an invalid callback, an invalid <I>guidInstance</I>, or invalid flags were supplied. It returns <A HREF="dpbu0120.htm#ref_0001010a09000028" TARGET="TEXT">DPERR_NOSESSIONS</A> if there is no open session. It returns <A HREF="dpbu0120.htm#ref_0001010a09000031" TARGET="TEXT">DPERR_UNAVAILABLE</A> if the remote session could not be enumerated.


<H5>Remarks</H5>
<P>By default, this method will enumerate players in the current open session. Groups can also be included in the enumeration by using the DPENUMPLAYERS_GROUP flag. The DPENUMPLAYERS_SESSION flag can be used, along with a session instance GUID, to request that a session's host provide its list for enumeration. This method cannot be called from within an <A HREF="dpbu0039.htm" TARGET="TEXT">IDirectPlay3::EnumSessions</A> enumeration. Furthermore, use of the DPENUMPLAYERS_SESSION flag with this method must occur after the <B>IDirectPlay3::EnumSessions</B> method has been called, and before any calls to the <A HREF="dpbu0026.htm" TARGET="TEXT">IDirectPlay3::Close</A> or <A HREF="dpbu0056.htm" TARGET="TEXT">IDirectPlay3::Open</A> methods.
<H5>See Also</H5>
<P><A HREF="dpbu0029.htm" TARGET="TEXT">IDirectPlay3::CreatePlayer</A>, <A HREF="dpbu0033.htm" TARGET="TEXT">IDirectPlay3::DestroyPlayer</A>, <A HREF="dpbu0039.htm" TARGET="TEXT">IDirectPlay3::EnumSessions</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
