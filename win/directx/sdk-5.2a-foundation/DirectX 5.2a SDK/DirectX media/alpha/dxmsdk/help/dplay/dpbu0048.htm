<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::GetPlayerAddress</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0047.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0049.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03001900">IDirectPlay3::GetPlayerAddress</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Retrieves the DirectPlay Address for a player. 
<P>The DirectPlay Address is a network address for a player using a specific <A HREF="dpbu0130.htm#dpgloss_0001010b09000002" TARGET="TEXT">service provider</A>. You should call the <A HREF="dpbu0072.htm" TARGET="TEXT">IDirectPlayLobby2::EnumAddress</A> method to parse the DirectPlay Address buffer retrieved by <B>IDirectPlay3::GetPlayerAddress</B>.

<P><B>HRESULT</B> <B>GetPlayerAddress</B><B>(</B><BR>&nbsp;&nbsp;<B>DPID</B> <I>idPlayer</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpData</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDWORD</B> <I>lpdwDataSize</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>idPlayer</I>
</DT><DD>Player ID that the address is being requested for. Pass in zero to obtain a list of valid address options for a service provider (for example, a list of valid modem choices for the modem-to-modem service provider). 

</DD><DT><I>lpData</I>
</DT><DD>Pointer to a buffer where the DirectPlay Address is to be written. Set this parameter to NULL to request only the size of data. The <I>lpdwDataSize</I> parameter will be set to the size required to hold the data.
</DD><DT><I>lpdwDataSize</I>
</DT><DD>Pointer to a variable that is initialized to the size of the buffer before calling this method. After the method returns, this parameter will be set to the size, in bytes, of the group data. If the buffer was too small, then this parameter will be set to the buffer size that is required and the method will return <A HREF="dpbu0120.htm#ref_0001010a0900000a" TARGET="TEXT">DPERR_BUFFERTOOSMALL</A>.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a0900000a" TARGET="TEXT">DPERR_BUFFERTOOSMALL</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001c" TARGET="TEXT">DPERR_INVALIDOBJECT</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001f" TARGET="TEXT">DPERR_INVALIDPLAYER</A>
</DT></DL>

<H5>Remarks</H5>
<P>To get a list of valid modem choices, pass in zero for the <I>idPlayer</I> parameter. A list of modem choices will be returned as a list of ANSI or Unicode strings with a zero-length string at the end.

<P>For more information about the DirectPlay Address, <A CLASS=tctop HREF="dpbu0007.htm#usingdp_0001010701070000" TARGET="TEXT">DirectPlay Address</A>. 
<H5>See Also</H5>
<P><A HREF="dpbu0072.htm" TARGET="TEXT">IDirectPlayLobby2::EnumAddress</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
