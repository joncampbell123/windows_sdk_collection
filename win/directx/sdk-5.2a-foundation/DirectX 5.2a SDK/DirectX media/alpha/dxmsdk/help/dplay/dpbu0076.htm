<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlayLobby2::ReceiveLobbyMessage</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0075.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0077.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a04000800">IDirectPlayLobby2::ReceiveLobbyMessage</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0068.htm" TARGET="TEXT">IDirectPlayLobby2 Interface</A>
<P>Retrieves the message sent between a <A HREF="dpbu0128.htm#dpgloss_0001010b07000002" TARGET="TEXT">lobby client</A> application and a DirectPlay application. Messages are queued, so there is no danger of losing data if it is not read in time.

<P><B>HRESULT</B> <B>ReceiveLobbyMessage</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwAppID</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDWORD</B> <I>lpdwMessageFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpData</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDWORD</B> <I>lpdwDataSize</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>dwFlags</I>
</DT><DD>Reserved; must be zero.
</DD><DT><I>dwAppID</I>
</DT><DD>Identifies which application's message to retrieve when called from a lobby client (that communicates with several applications). When called from an application (that communicates only with one lobby client), this parameter must be set to zero. This ID number is obtained by using the <A HREF="dpbu0077.htm" TARGET="TEXT">IDirectPlayLobby2::RunApplication</A> method.
</DD><DT><I>lpdwMessageFlags</I>
</DT><DD>Flags indicating what type of message is being returned. The default (<I>lpdwMessageFlags</I> = 0) indicates that the message is custom-defined by the sender. Processing of this type of message is optional. The receiver must interpret this message based on the identity of the sending application. A lobby can identify the sending application based on the GUID of the application that was launched. An application will need to identify the lobby by sending the lobby a standard message requesting an identifying GUID.
<DL>
<DT><B><A NAME="ref_0001010a04000801">DPLMSG_STANDARD</A></B>
</DT><DD>Indicates that this is a DirectPlay-defined message. Processing of this type of message is optional.
</DD><DT><B><A NAME="ref_0001010a04000802">DPLMSG_SYSTEM</A></B>
</DT><DD>Indicates that this is a DirectPlay generated system message used to inform the lobby of changes in the status of the application it launched.
</DD></DL>
</DD><DT><I>lpData</I>
</DT><DD>Pointer to a buffer in which the message is to be written. Set this parameter to NULL to request only the size of message. The <I>lpdwDataSize</I> parameter will be set to the minimum size required to hold the message.
</DD><DT><I>lpdwDataSize</I>
</DT><DD>Pointer to a variable that is initialized to the size of the buffer before calling this method. After the method returns, this parameter will be set to the size, in bytes, of the message. If the buffer was too small (DPERR_BUFFERTOOSMALL), then this parameter will be set to the minimum buffer size required.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a09000006" TARGET="TEXT">DPERR_APPNOTSTARTED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900000a" TARGET="TEXT">DPERR_BUFFERTOOSMALL</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000017" TARGET="TEXT">DPERR_GENERIC</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001b" TARGET="TEXT">DPERR_INVALIDINTERFACE</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001c" TARGET="TEXT">DPERR_INVALIDOBJECT</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000024" TARGET="TEXT">DPERR_NOMESSAGES</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900002b" TARGET="TEXT">DPERR_OUTOFMEMORY</A>
</DT></DL>

<H5>See Also</H5>
<P><A HREF="dpbu0077.htm" TARGET="TEXT">IDirectPlayLobby2::RunApplication</A>, <A HREF="dpbu0078.htm" TARGET="TEXT">IDirectPlayLobby2::SendLobbyMessage</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
