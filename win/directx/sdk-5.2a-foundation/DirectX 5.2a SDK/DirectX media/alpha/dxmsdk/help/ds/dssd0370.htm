<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>C/C++-based Sample Applications</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0369.htm','/dssd0000.htm','/dssd0311.htm','/index.htm','/dssd0371.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="samples_0001070208000000">C/C++-based Sample Applications</A></H2>
<BR CLEAR=ALL>
<P>This article details sample applications that are written in C++ or C. The sample applications implement media players or perform other application-related functions. The differences between them are mainly the different programming languages, API, or frameworks used.

<P>Some of these samples use the Microsoft&#174; Foundation Classes (MFC).
<P><B>Contents of this article:</B>
<UL><LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208010000" TARGET="TEXT">AMCap Sample (DirectShow Capture Application)</A> 
<LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208020000" TARGET="TEXT">CPlay Sample (C/COM-based Media Player Application)</A>
<LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208030000" TARGET="TEXT">Dvdsampl Sample (DVD Player Application)</A>
<LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208040000" TARGET="TEXT">InWindow Sample (Window Playback Application)</A>
<LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208050000" TARGET="TEXT">IPlay Sample (Indeo Player Application)</A>
<LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208060000" TARGET="TEXT">MFCPlay Sample (C++/COM-based Media Player Application)</A>
<LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208070000" TARGET="TEXT">MPEGProp Sample (MPEG Property Page Display Application)</A>
<LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208080000" TARGET="TEXT">PlayFile Sample (Simple Playback Application)</A>
<LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208090000" TARGET="TEXT">ShowStrm Sample (Multimedia Streaming Application)</A>
<LI><A CLASS=TCTOP HREF="dssd0370.htm#samples_00010702080a0000" TARGET="TEXT">VidClip Sample (Video Editing Application)</A>

</UL>
<A NAME="samples_0001070208010000"></A><P><B>AMCap Sample (DirectShow Capture Application)</B>
<P>The DirectShow capture sample, AMCap, demonstrates the basics of capturing audio and video from a hardware source to a specified output file or to a preview window.

<P>To see a list of the hardware capture devices on your system, choose the <B>Devices</B> menu; DirectShow uses the <A HREF="dssd0129.htm" TARGET="TEXT">ICreateDevEnum</A> interface to create the list of devices that appears. After choosing a device, choose the <B>Set Frame Rate</B> command from the <B>Capture</B> menu and set the desired frame rate; the default value is 30 frames per second. To set an output file for your capture, pick the <B>Set Capture File</B> command from the <B>File</B> menu. DirectShow uses the <A CLASS=TCTOP HREF="dssd0334.htm" TARGET="TEXT">File Writer</A> filter to associate your specified file with the capture session.

<P>If you want to turn audio capturing on or off, choose the <B>Capture Audio</B> command from the <B>Capture</B> menu. To turn capture previewing on or off, choose the Preview command from the Options menu. When you are ready to begin capturing, choose the <B>Start Capture</B> command from the <B>Capture</B> menu. If you want to save your captured data to a file other than the specified output file, choose the <B>Save Captured Video As</B> command from the <B>File</B> menu.

<P><B>Note:</B>  Before you begin capturing for the first time, choose Allocate File Space from the File menu to preallocate the capture file. Preallocating the file improves capture performance. AMCap calls <A HREF="dssd0126.htm#If_0001060121030100" TARGET="TEXT">AllocCapFile</A> to preallocate the capture file.<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>



<A NAME="samples_0001070208020000"></A><P><B>CPlay Sample (C/COM-based Media Player Application)</B>
<P>This C/COM-based media player sample, CPlay, is a simple application that renders multimedia files using DirectShow&#153; from within the C language. The CPlay sample does not use Microsoft Foundation Classes (MFC). If you want to see a sample that uses MFC, see <A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208060000" TARGET="TEXT">MFCPlay Sample (C++/COM-based Media Player Application)</A>. The CPlay sample shows how to utilize the DirectShow components without using the base classes provided with DirectShow. The sample creates a filter graph (by calling <A HREF="dssd0406.htm#external_00010a010900000c" TARGET="TEXT">CoCreateInstance</A> to get a pointer to the <A HREF="dssd0153.htm" TARGET="TEXT">IGraphBuilder</A> interface), and requests the filter graph to render a file. The filter graph is then controlled by using the <A HREF="dssd0156.htm" TARGET="TEXT">IMediaControl</A> interface. This sample also uses the <A HREF="dssd0157.htm" TARGET="TEXT">IMediaEvent</A> and <A HREF="dssd0161.htm" TARGET="TEXT">IMediaPosition</A> interfaces. 

<P>CPlay is a minimal application that implements the following menu commands: Open, Play, Pause, Stop, and Exit on the File menu, and About on the Help menu.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>




<A NAME="samples_0001070208030000"></A><P><B>Dvdsampl Sample (DVD Player Application)</B>
<P>The DirectShow DVD sample player, Dvdsampl, is a simple application that plays DVD Video content. It uses the <A HREF="dssd0136.htm" TARGET="TEXT">IDvdGraphBuilder</A> interface to build a DVD filter graph and to obtain interface pointers for <A HREF="dssd0107.htm" TARGET="TEXT">IAMLine21Decoder</A>, <A HREF="dssd0135.htm" TARGET="TEXT">IDvdControl</A>, and <A HREF="dssd0137.htm" TARGET="TEXT">IDvdInfo</A>. It uses those interfaces and enables you to turn closed captioning on and off, play in full screen mode, and display and select from DVD menus.

<P><B>Note:</B>  Your system must include DVD playback hardware to run this sample.<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>



<A NAME="samples_0001070208040000"></A><P><B>InWindow Sample (Window Playback Application)</B>
<P>The InWindow application is a simple sample that shows minimal code required to play back a media file into a specific window. It builds on the <A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208080000" TARGET="TEXT">PlayFile sample</A>. Like PlayFile, it provides a file Open dialog box that enables you to open media files. It also uses <A HREF="dssd0153.htm" TARGET="TEXT">IGraphBuilder</A>, <A HREF="dssd0158.htm" TARGET="TEXT">IMediaEventEx</A>, and <A HREF="dssd0156.htm" TARGET="TEXT">IMediaControl</A> as PlayFile does. InWindow expands on the PlayFile functionality by calling <A HREF="dssd0185.htm#If_000106015c031f00" TARGET="TEXT">IVideoWindow::put_Owner</A>, <A HREF="dssd0185.htm#If_000106015c032400" TARGET="TEXT">IVideoWindow::put_WindowStyle</A>, and <A HREF="dssd0185.htm#If_000106015c032700" TARGET="TEXT">IVideoWindow::SetWindowPosition</A> to direct playback into the main application window.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>




<A NAME="samples_0001070208050000"></A><P><B>IPlay Sample (Indeo Player Application)</B>
<P>The Intel&#174; Indeo player sample, IPlay, uses DirectShow to render multimedia files and demonstrates the Indeo Video Interactive application programming interfaces (API). IPlay demonstrates how to access the advanced features of the Indeo Video Interactive (IVI) codec. It is a simple application written in C++ using Microsoft Foundation Classes (MFC). If the file is an IVI format file, it enables controls for the IVI advanced features. The advanced features include local decoding, a decoding time limit, and the ability to adjust brightness, saturation, and contrast.

<P>The Ax_spec.h file defines the interfaces of the IVI codec. The CIPlayDoc::OnOpenDocument function demonstrates how to determine if a file is an IVI format file. The CIPlayDoc::Getxxx and CIPlayDoc::Setxxx functions demonstrate how to get and set the IVI playback parameters for the advanced features.

<P>This sample uses the following interfaces:
<UL><LI><A HREF="dssd0153.htm" TARGET="TEXT">IGraphBuilder</A> &#151; to create a filter graph and render a file
<LI><A HREF="dssd0147.htm" TARGET="TEXT">IFilterGraph</A> &#151; to enumerate the filters in the filter graph
<LI><A HREF="dssd0156.htm" TARGET="TEXT">IMediaControl</A> &#151; to play/pause/stop the playback
<LI><A HREF="dssd0157.htm" TARGET="TEXT">IMediaEvent</A> &#151; to be notified of <A HREF="dssd0308.htm#events_0001060801000400" TARGET="TEXT">EC_COMPLETE</A> (playback complete) and other events
<LI><A HREF="dssd0161.htm" TARGET="TEXT">IMediaPosition</A> &#151; to set the time that the media stream begins
<LI><A HREF="dssd0185.htm" TARGET="TEXT">IVideoWindow</A> &#151; to set the window size/caption/position
<LI><A HREF="dssd0125.htm" TARGET="TEXT">IBasicVideo</A> &#151; to get the native window size.
</UL>
<P>IPlay also implements and uses the <B>IIndeoDecode</B> interface (not part of DirectShow).


<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>



<A NAME="samples_0001070208060000"></A><P><B>MFCPlay Sample (C++/COM-based Media Player Application)</B>
<P>The C++/COM-based media player sample, MFCPlay, is a simple application that renders multimedia files using DirectShow from within C++ and Microsoft Foundation Classes (MFC). It demonstrates how to connect the DirectShow components by using the interfaces provided with DirectShow and MFC. The sample creates a filter graph (by calling <A HREF="dssd0406.htm#external_00010a010900000c" TARGET="TEXT">CoCreateInstance</A> to get a pointer to the <A HREF="dssd0153.htm" TARGET="TEXT">IGraphBuilder</A> interface), and requests the filter graph to render a file. The filter graph is then controlled by using the <A HREF="dssd0156.htm" TARGET="TEXT">IMediaControl</A> interface. This sample also uses the <A HREF="dssd0157.htm" TARGET="TEXT">IMediaEvent</A> and <A HREF="dssd0161.htm" TARGET="TEXT">IMediaPosition</A> interfaces.

<P>The MFCPlay application implements the following menu commands: Open, Play, Pause, Stop, and Exit on the File menu, and About on the Help menu.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>




<A NAME="samples_0001070208070000"></A><P><B>MPEGProp Sample (MPEG Property Page Display Application)</B>
<P>The MPEGProp sample application demonstrates how to display a filter's property page.

<P>When you open MPEGProp, choose Open from the File menu and select an MPEG media file from the standard Open dialog box. After you select an appropriate file, MPEGProp calls <A HREF="dssd0406.htm#external_00010a010900000c" TARGET="TEXT">CoCreateInstance</A> to create a new filter graph and renders the chosen source file. MPEGProp calls <A HREF="dssd0147.htm#If_0001060136030500" TARGET="TEXT">IFilterGraph::FindFilterByName</A> to locate the <A HREF="dssd0348.htm" TARGET="TEXT">MPEG Video Codec</A> filter, and then calls <A HREF="dssd0406.htm#external_00010a01090000c4" TARGET="TEXT">OleCreatePropertyFrame</A> with the codec pointer to display the filter's property page.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>



<A NAME="samples_0001070208080000"></A><P><B>PlayFile Sample (Simple Playback Application)</B>
<P>The PlayFile application is a simple sample that shows minimal code required to play back a media file. It provides a file Open dialog box that enables you to open files including file types such as AVI, MPEG, MOV, and QT. PlayFile uses the <A HREF="dssd0153.htm#If_000106013c030400" TARGET="TEXT">IGraphBuilder::RenderFile</A> method to render the filter graph for the chosen media file, <A HREF="dssd0158.htm" TARGET="TEXT">IMediaEventEx</A> to handle signaling of events, <A HREF="dssd0156.htm#If_000106013f030700" TARGET="TEXT">IMediaControl::Run</A> to play the resulting filter graph, and <A HREF="dssd0156.htm#If_000106013f030800" TARGET="TEXT">IMediaControl::Stop</A> to stop playback. The sample calls <A HREF="dssd0185.htm" TARGET="TEXT">IVideoWindow</A> to control whether the playback window is visible. Video follows the default behavior and plays back in a separate window rather than in the main application window.

<P>See <A CLASS=TCTOP HREF="dssd0370.htm#samples_0001070208040000" TARGET="TEXT">InWindow Sample (Window Playback Application)</A> for a sample that builds on PlayFile and plays back video into the main application window.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>


<A NAME="samples_0001070208090000"></A><P><B>ShowStrm Sample (Multimedia Streaming Application)</B>
<P>The ShowStrm application demonstrates how to use a Microsoft&#174; DirectDraw&#174; surface to blit a multimedia stream. It is a console application that sends a movie out to the surface when invoked from the command line with the following syntax:

<PRE><FONT FACE="Courier" SIZE="2">
SHOWSTRM Name_of_Movie
</FONT></PRE>
<P>For example, to play Angry.avi, you could use the command:

<PRE><FONT FACE="Courier" SIZE="2">
C:\&gt;SHOWSTRM angry.avi
</FONT></PRE>
<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>


<A NAME="samples_00010702080a0000"></A><P><B>VidClip Sample (Video Editing Application)</B>
<P>The VidClip application demonstrates how to use the multimedia streaming interfaces and how to support rudimentary video editing. The VidClip sample reads from multiple streams and writes to a single stream. For more information on the multimedia streaming interfaces, see <A CLASS=TCTOP HREF="dssd0376.htm#ms_iface_0001080201000000" TARGET="TEXT">List of Multimedia Streaming Interfaces</A>.

<P>On the <B>Video</B> menu in the VidClip application, choose the <B>Add Clip</B> command to add clips to your list; you can include start and stop times, if you want to add only a portion of a clip. Choose the <B>Edit Clip</B> command to edit existing clips in the list, and the <B>Delete Clip</B> command to delete clips. The <B>Make a Movie</B> command combines the clips into one stream. 

<P>On the <B>File</B> menu, choose the <B>Settings</B> command to set the height, width, depth, and compression for the stream data. Choose the <B>Save</B> command to save the settings to a file in your project. 

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>


<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
