<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::EnumGroups</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0035.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0037.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03000d00">IDirectPlay3::EnumGroups</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Enumerates all the top-level groups in the current session. Top-level groups are groups that were created with the <A HREF="dpbu0027.htm" TARGET="TEXT">IDirectPlay3::CreateGroup</A> method. If there is no open session, groups in a remote session can be enumerated by specifying the DPENUMGROUPS_SESSION flag and the <I>guidInstance</I> of the session. Password protected remote sessions cannot be enumerated.
<P>A pointer to an application-implemented callback function must be supplied, and DirectPlay calls it once for each group in the session that matches the criteria specified in <I>dwFlags</I>.


<P>You can't use <B>EnumGroups</B> in a lobby session you're not connected to.

<P><B>HRESULT</B> <B>EnumGroups</B><B>(</B><BR>&nbsp;&nbsp;<B>LPGUID</B> <I>lpguidInstance</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDPENUMPLAYERSCALLBACK2</B> <I>lpEnumPlayersCallback2</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpContext</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpguidInstance</I>
</DT><DD>This parameter should be NULL to enumerate groups in the currently open session. If there is no open session, this parameter can be a pointer to a GUID identifying the session to be enumerated. The GUID must be equal to one of the sessions enumerated by <A HREF="dpbu0039.htm" TARGET="TEXT">IDirectPlay3::EnumSessions</A>. This parameter is ignored unless the DPENUMGROUPS_SESSION flag is specified. 
</DD><DT><I>lpEnumPlayersCallback2</I>
</DT><DD>Pointer to the <A HREF="dpbu0021.htm" TARGET="TEXT">EnumPlayersCallback2</A> function that will be called for every group in the session that matches the criteria specified in <I>dwFlags</I>.
</DD><DT><I>lpContext</I>
</DT><DD>Pointer to an application-defined context that is passed to each enumeration callback.
</DD><DT><I>dwFlags</I>
</DT><DD>Flags specifying how the enumeration is to be done. Default (dwFlags = 0) enumerates all groups in the current active session. You should OR together the flags that you want to specify. Only groups that meet all the criteria of the combined flags will be enumerated. For example, if you specify (DPENUMGROUPS_LOCAL | DPENUMGROUPS_STAGINGAREA) only groups that are local and are staging areas will be enumerated. If you specify (DPENUMGROUPS_LOCAL | DPENUMGROUPS_REMOTE), no groups will be enumerated because no group can be both local and remote. 
</DD><DD>Can be one or more of the following values:
<DL>
<DT><B><A NAME="ref_0001010a03000d01">DPENUMGROUPS_ALL</A></B>
</DT><DD>Enumerates all groups in this session. 
</DD><DT><B><A NAME="ref_0001010a03000d02">DPENUMGROUPS_LOCAL</A></B>
</DT><DD>Enumerates groups created locally by this DirectPlay object. 
</DD><DT><B><A NAME="ref_0001010a03000d03">DPENUMGROUPS_REMOTE</A></B>
</DT><DD>Enumerates groups created by remote DirectPlay objects. 
</DD><DT><B><A NAME="ref_0001010a03000d04">DPENUMGROUPS_SESSION</A></B>
</DT><DD>Performs enumeration in the session identified by the <I>lpguidInstance</I> parameter. This flag can only be used if there is no current active session. You can't use this flag in a lobby session.

</DD><DT><B><A NAME="ref_0001010a03000d05">DPENUMGROUPS_STAGINGAREA</A></B>
</DT><DD>Enumerates groups that are staging areas. (Staging areas are used to marshal players together in order to launch a new session.) 
</DD></DL>
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error messages otherwise:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A> 
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000028" TARGET="TEXT">DPERR_NOSESSIONS</A> 
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000031" TARGET="TEXT">DPERR_UNAVAILABLE</A> 
</DT></DL>
<P>This method returns <A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A> if an invalid callback, an invalid <I>guidInstance</I>, or invalid flags were supplied. It returns <A HREF="dpbu0120.htm#ref_0001010a09000028" TARGET="TEXT">DPERR_NOSESSIONS</A> if there is no open session. It returns <A HREF="dpbu0120.htm#ref_0001010a09000031" TARGET="TEXT">DPERR_UNAVAILABLE</A> if the remote session could not be enumerated.




<H5>Remarks</H5>
<P>To enumerate the subgroups in a group, use <A HREF="dpbu0037.htm" TARGET="TEXT">IDirectPlay3::EnumGroupsInGroup</A>.

<H5>See Also</H5>
<P><A HREF="dpbu0021.htm" TARGET="TEXT">EnumPlayersCallback2</A>, <A HREF="dpbu0027.htm" TARGET="TEXT">IDirectPlay3::CreateGroup</A>, <A HREF="dpbu0032.htm" TARGET="TEXT">IDirectPlay3::DestroyGroup</A>, <A HREF="dpbu0039.htm" TARGET="TEXT">IDirectPlay3::EnumSessions</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
