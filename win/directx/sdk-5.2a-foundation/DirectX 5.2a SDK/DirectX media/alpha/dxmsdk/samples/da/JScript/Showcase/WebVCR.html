<HTML> 
<HEAD>
<!-- This document was handcrafted for your enjoyment -->
<TITLE>DirectAnimation SDK, JScript sample</TITLE>
<SCRIPT LANGUAGE="JScript">
<!--
if (window.top.frames.length!=0 && window.top.frames[0].ShowNoButtons!=null)
    window.top.frames[0].ShowNoButtons();
//-->
</SCRIPT>
</HEAD>	 
<STYLE>
	input.clsbtn {font-size:16;font-family:WebDings;color:yellow;background:black}
</STYLE>
<BODY BGCOLOR=#AAAAAA TOPMARGIN=10 LEFTMARGIN=10 OnLoad="ScrollBar.value = 4;">
<FONT FACE="Impact" SIZE=5><CENTER>
WebVCR: Controlling sound and movie playback through Microsoft's DirectAnimation scripting and Dynamic HTML
</FONT><BR>

<DIV STYLE="position:absolute; top:70; width=600; left:20%;">
<OBJECT ID="DAControl" HEIGHT=270 WIDTH=300  
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<BR>
<input type=button CLASS=clsbtn value="7" onClick="setRate(-3);">
<input type=button CLASS=clsbtn value="r" onClick="stop(true)">
<input type=button CLASS=clsbtn value="4" onClick="setRate(1)">
<input type=button CLASS=clsbtn value="8" onClick="setRate(3)">
<input type=button CLASS=clsbtn value=";" onClick="stop(false)">
<FONT FACE="webdings" SIZE=6>X</FONT>
<input type=button CLASS=clsbtn value="6" onClick="setVolume(-1)">
<input type=button CLASS=clsbtn value="5" onClick="setVolume(1)">
<BR>
<OBJECT ID="ScrollBar" WIDTH=203 HEIGHT=16
    CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D">
    <PARAM NAME="Size" VALUE="6000;423">
    <PARAM NAME="Max" VALUE="6">
    <PARAM NAME="Min" VALUE="0">
    <PARAM NAME="LargeChange" VALUE=".5">
    <PARAM NAME="Orientation" VALUE="1">
</OBJECT>
</CENTER>
</DIV>

<DIV ID=ReadOuts STYLE="position:absolute; width:200; height:20; top:70; left:35">
<FONT FACE="Impact" SIZE=3>
Rate: <SPAN ID=Rate>1</SPAN><BR>
Volume: <SPAN ID=Volume>10</SPAN><BR>
Status: <SPAN ID=Status>Playing</SPAN><P>
<FONT FACE="Arial Black" SIZE=-1>Now everyone can design custom multimedia playback interfaces for their web pages.
In this script, the majority of the logic is for controlling the buttons and status
feedback.  DirectAnimation is used to import a piece of media and control the rate
of playback.
</FONT>
</FONT>
</DIV>               

<SCRIPT LANGUAGE="JScript">
<!--
  // For a more in-depth description of the DirectAnimation calls being used
  // please see the Java sample called VCR in the templates directory.
  m = DAControl.MeterLibrary;
  mediaBase = "../../../../media/";

  // Import some media  
  importResult = m.ImportMovie(mediaBase + "movie/movie.avi");
  sampleDur = importResult.Duration;
  sampleImg = importResult.Image;
  sampleSnd = importResult.Sound;
  
  _gain = 10; 
  _resetEv   = m.AppTriggeredEvent();  // Reset Event
  _rateSw    = m.ModifiableBehavior(m.DANumber(1)); // Speed Switch
  _gainSw    = m.ModifiableBehavior(m.DANumber(_gain/10));  // Volume Switch
  
  posNum = specialMod(m.Integral(_rateSw), sampleDur);
  
  resetablePosNum = new ActiveXObject("DirectAnimation.DANumber");
  resetablePosNum.Init(m.Until(posNum, _resetEv, resetablePosNum));

  videoTrack = sampleImg.SubstituteTime(resetablePosNum);
  audioTrack = sampleSnd.Loop().SubstituteTime(resetablePosNum);         
  audioTrack = audioTrack.GainAnim(_gainSw);
  DAControl.Image = videoTrack;
  DAControl.Sound = audioTrack;
  DAControl.Start();

  function stop(bReset) {   
    setRate(0);      
    document.all["Status"].innerText = (bReset) ? "Stop" : "Paused";
    if (bReset) m.TriggerEvent( _resetEv, m.DANumber(1) );               
  }

  function ScrollBar_change() {    
    rate = ScrollBar.value-3;
    document.all["Rate"].innerText = rate;
    _rateSw.SwitchTo(m.DANumber(rate));
  }

  function setVolume(increment) {    
    _gain += increment;
    if(_gain > 10) _gain = 10;
    if(_gain < 0) _gain = 0;
    document.all["Volume"].innerText = _gain;
    _gainSw.SwitchTo(m.DANumber(_gain/10));
  }

  function setRate(rate) {
    ScrollBar.value = rate+3;
    document.all["Rate"].innerText = rate;
    if (rate<0) status = "Rewind";
    else if(rate>1) status = "Fast Forward";
    else status = "Playing";
    document.all["Status"].innerText = status;
    _rateSw.SwitchTo(m.DANumber(rate));   
  }

  function specialMod(numNum, denomNum) {
    return m.Cond(m.GT(numNum, m.DANumber(0)), m.Mod(numNum, denomNum),
                  m.Sub(denomNum, m.Mod(m.Abs(numNum), denomNum)));
  }
//-->
</SCRIPT>
</BODY>
</HTML>