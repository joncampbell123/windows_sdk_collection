<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Callback Functions</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/rm0007.htm','/rm0000.htm','/rm0006.htm','/index.htm','/rm0009.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="dx5_Callback_Functions_d3drm"></A><A NAME="rmfuncs_0001010602000000">Callback Functions</A></H2>
<BR CLEAR=ALL>
<P>The Microsoft&#174; Direct3D&#174; Retained Mode callback functions are:
<UL><LI><A HREF="rm0008.htm#rmfuncs_0001010602000100" TARGET="TEXT">D3DRMDEVICEPALETTECALLBACK</A>
<LI><A HREF="rm0008.htm#rmfuncs_0001010602000200" TARGET="TEXT">D3DRMFRAMEMOVECALLBACK</A>
<LI><A HREF="rm0008.htm#rmfuncs_0001010602000300" TARGET="TEXT">D3DRMLOADCALLBACK</A>
<LI><A HREF="rm0008.htm#rmfuncs_0001010602000400" TARGET="TEXT">D3DRMLOADTEXTURECALLBACK</A>
<LI><A HREF="rm0008.htm#rmfuncs_0001010602000500" TARGET="TEXT">D3DRMOBJECTCALLBACK</A>
<LI><A HREF="rm0008.htm#rmfuncs_0001010602000600" TARGET="TEXT">D3DRMUPDATECALLBACK</A>
<LI><A HREF="rm0008.htm#rmfuncs_0001010602000700" TARGET="TEXT">D3DRMUSERVISUALCALLBACK</A>
<LI><A HREF="rm0008.htm#rmfuncs_0001010602000800" TARGET="TEXT">D3DRMWRAPCALLBACK</A>
</UL>
<H3><HR COLOR="#0000FF"><A NAME="rmfuncs_0001010602000100">D3DRMDEVICEPALETTECALLBACK</A></H3>
<P>Enumerates palette entries. This callback function is application-defined.

<P>
<P>
<P><B>void</B> <B>(</B><BR>&nbsp;&nbsp;<I>*D3DRMDEVICEPALETTECALLBACK</I><BR>&nbsp;&nbsp;<B>)</B><BR><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMDEVICE</B> <I>lpDirect3DRMDev</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwIndex</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>red</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>green</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>blue</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpDirect3DRMDev</I>
</DT><DD>Address of the <A CLASS=tctop HREF="rm0014.htm" TARGET="TEXT">IDirect3DRMDevice</A> interface for this device.
</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to this callback function.
</DD><DT><I>dwIndex</I>
</DT><DD>Index of the palette entry being described.
</DD><DT><I>red</I>, <I>green</I>, and <I>blue</I>
</DT><DD>Red, green, and blue components of the color at the given index in the palette.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.

<H5>Remarks</H5>
<P>When determining the order in which to use callback functions, the system searches the objects highest in the hierarchy first, and then uses their callback functions in the order in which they were created.
<H3><HR COLOR="#0000FF"><A NAME="rmfuncs_0001010602000200">D3DRMFRAMEMOVECALLBACK</A></H3>
<P>Enables an application to apply customized algorithms when a frame is moved or updated. You can use this callback function to compensate for changing frame rates. This callback function is application-defined.

<P>
<P><B>void</B> <B>(</B><BR>&nbsp;&nbsp;<I>*D3DRMFRAMEMOVECALLBACK</I><BR>&nbsp;&nbsp;<B>)</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMFRAME</B> <I>lpD3DRMFrame</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>delta</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpD3DRMFrame</I>
</DT><DD>Address of the Direct3DRMFrame object that is being moved.
</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to this callback function.
</DD><DT><I>delta</I>
</DT><DD>Amount of change to apply to the movement. There are two components to the change in position of a frame: linear and rotational. The change in each component is equal to <I>velocity_of_component</I>&#215;<I>delta</I>. Although either or both of these velocities can be set relative to any frame, the system automatically converts them to velocities relative to the parent frame for the purpose of applying time deltas. 
</DD></DL>
<H5>Return Values</H5>
<P>No return value.

<H5>Remarks</H5>
<P>Your application can synthesize the acceleration of a frame relative to its parent frame. To do so, on each tick your application should set the velocity of the child frame relative to itself to (<I>a</I> units per tick) &#215; 1 tick, where <I>a</I> is the required acceleration. This is equal to <I>a</I> &#215; <I>delta</I> units per tick. Internally, <I>a</I> &#215; <I>delta</I> units per tick relative to the child frame is converted to (<I>v</I> + (<I>a</I> &#215; <I>delta</I>)) units per tick relative to the parent frame, where <I>v</I> is the current velocity of the child relative to the parent.
<P>You can add and remove this callback function from your application by using the <A HREF="rm0017.htm#rmframe_000101060b000300" TARGET="TEXT">IDirect3DRMFrame::AddMoveCallback</A> and <A HREF="rm0017.htm#rmframe_000101060b000b00" TARGET="TEXT">IDirect3DRMFrame::DeleteMoveCallback</A> methods.
<P>When determining the order in which to use callback functions, the system searches the objects highest in the hierarchy first, and then uses their callback functions in the order in which they were created.
<H3><HR COLOR="#0000FF"><A NAME="rmfuncs_0001010602000300">D3DRMLOADCALLBACK</A></H3>
<P>Loads objects named in a call to the <A HREF="rm0010.htm#rmid3drm_0001010604001a00" TARGET="TEXT">IDirect3DRM::Load</A> method. This callback function is application-defined.
<P><B>void</B> <B>(</B><BR>&nbsp;&nbsp;<I>*D3DRMLOADCALLBACK</I><BR>&nbsp;&nbsp;<B>)</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMOBJECT</B> <I>lpObject</I><B>,</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>ObjectGuid</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpObject</I>
</DT><DD>Address of the Direct3DRMObject being loaded.
</DD><DT><I>ObjectGuid</I>
</DT><DD>Globally unique identifier (GUID) of the object being loaded.
</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to this callback function.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.

<H5>Remarks</H5>
<P>When determining the order in which to use callback functions, the system searches the objects highest in the hierarchy first, and then uses their callback functions in the order in which they were created.
<H5>See Also</H5>
<P><A HREF="rm0010.htm#rmid3drm_0001010604001a00" TARGET="TEXT">IDirect3DRM::Load</A> 
<H3><HR COLOR="#0000FF"><A NAME="rmfuncs_0001010602000400">D3DRMLOADTEXTURECALLBACK</A></H3>
<P>Loads texture maps from a file or resource named in a call to one of the <B>Load</B> methods. This callback function is application-defined.
<P><B>HRESULT</B> <B>(</B><BR>&nbsp;&nbsp;<I>*D3DRMLOADTEXTURECALLBACK</I><BR>&nbsp;&nbsp;<B>)</B><B>(</B><BR>&nbsp;&nbsp;<B>char</B> <I>*tex_name</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <I>*lpArg</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMTEXTURE</B> <I>*lpD3DRMTex</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>tex_name</I>
</DT><DD>Address of a string containing the name of the texture.
</DD><DT><I>lpArg</I>
</DT><DD>Address of application-specific data.
</DD><DT><I>lpD3DRMTex</I>
</DT><DD>Address of the Direct3DRMTexture object.
</DD></DL>
<H5>Return Values</H5>
<P>Should return D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A CLASS=tctop HREF="rm0037.htm" TARGET="TEXT">Direct3D Retained Mode Return Values</A>.

<H5>Remarks</H5>
<P>Applications can use this callback function to implement support for textures that are not in the Microsoft&#174; Windows&#174; bitmap (.bmp) or Portable Pixmap (.ppm) P6 format.
<P>When determining the order in which to use callback functions, the system searches the objects highest in the hierarchy first, and then uses their callback functions in the order in which they were created.
<H5>See Also</H5>
<P><A HREF="rm0010.htm#rmid3drm_0001010604001a00" TARGET="TEXT">IDirect3DRM::Load</A>, <A HREF="rm0013.htm#rmanimst_0001010607000300" TARGET="TEXT">IDirect3DRMAnimationSet::Load</A>, <A HREF="rm0017.htm#rmframe_000101060b002400" TARGET="TEXT">IDirect3DRMFrame::Load</A>, <A HREF="rm0023.htm#rmmshbld_0001010611001500" TARGET="TEXT">IDirect3DRMMeshBuilder::Load</A>
<H3><HR COLOR="#0000FF"><A NAME="rmfuncs_0001010602000500">D3DRMOBJECTCALLBACK</A></H3>
<P>Enumerates objects in response to a call to the <A HREF="rm0010.htm#rmid3drm_0001010604001600" TARGET="TEXT">IDirect3DRM::EnumerateObjects</A> method. This callback function is application-defined.
<P><B>void</B> <B>(</B><BR>&nbsp;&nbsp;<I>*D3DRMOBJECTCALLBACK</I><BR>&nbsp;&nbsp;<B>)</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMOBJECT</B> <I>lpD3DRMobj</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpD3DRMobj</I>
</DT><DD>Address of an <A CLASS=tctop HREF="rm0025.htm" TARGET="TEXT">IDirect3DRMObject</A> interface for the object being enumerated. The application must use the <B>Release</B> method for each enumerated object.
</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to this callback function.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.

<H5>Remarks</H5>
<P>When determining the order in which to use callback functions, the system searches the objects highest in the hierarchy first, and then uses their callback functions in the order in which they were created.
<H5>See Also</H5>
<P><A HREF="rm0010.htm#rmid3drm_0001010604001600" TARGET="TEXT">IDirect3DRM::EnumerateObjects</A> 
<H3><HR COLOR="#0000FF"><A NAME="rmfuncs_0001010602000600">D3DRMUPDATECALLBACK</A></H3>
<P>Alerts the application when the device changes. This callback function is application-defined.
<P>
<P><B>void</B> <B>(</B><BR>&nbsp;&nbsp;<I>*D3DRMUPDATECALLBACK</I><BR>&nbsp;&nbsp;<B>)</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMDEVICE</B> <I>lpobj</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>iRectCount</I><B>,</B><BR>&nbsp;&nbsp;<B>LPD3DRECT</B> <I>d3dRectUpdate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpobj</I>
</DT><DD>Address of the Direct3DRMDevice object to which this callback function applies.
</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to this callback function.
</DD><DT><I>iRectCount</I>
</DT><DD>Number of rectangles specified in the <I>d3dRectUpdate</I> parameter.
</DD><DT><I>d3dRectUpdate</I>
</DT><DD>Array of one or more <A HREF="rm0038.htm#external_0001010620000013" TARGET="TEXT">D3DRECT</A> structures that describe the area to be updated. The coordinates are specified in device units.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.

<H5>Remarks</H5>
<P>When determining the order in which to use callback functions, the system searches the objects highest in the hierarchy first, and then uses their callback functions in the order in which they were created.
<H5>See Also</H5>
<P><A HREF="rm0014.htm#rmdevice_0001010608000100" TARGET="TEXT">IDirect3DRMDevice::AddUpdateCallback</A>, <A HREF="rm0014.htm#rmdevice_0001010608000200" TARGET="TEXT">IDirect3DRMDevice::DeleteUpdateCallback</A>, <A HREF="rm0014.htm#rmdevice_0001010608001700" TARGET="TEXT">IDirect3DRMDevice::Update</A>
<H3><HR COLOR="#0000FF"><A NAME="rmfuncs_0001010602000700">D3DRMUSERVISUALCALLBACK</A></H3>
<P>Alerts an application that supplies user-visual objects that it should execute the execute buffer. This function is application-defined.

<P>
<P><B>int</B> <B>(</B><BR>&nbsp;&nbsp;<I>*D3DRMUSERVISUALCALLBACK</I><BR>&nbsp;&nbsp;<B>)</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMUSERVISUAL</B> <I>lpD3DRMUV</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DRMUSERVISUALREASON</B> <I>lpD3DRMUVreason</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMDEVICE</B> <I>lpD3DRMDev</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMVIEWPORT</B> <I>lpD3DRMview</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpD3DRMUV</I>
</DT><DD>Address of the Direct3DRMUserVisual object.
</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to this callback function.
</DD><DT><I>lpD3DRMUVreason</I>
</DT><DD>One of the members of the <A HREF="rm0035.htm#rmtypes_000101061d000f00" TARGET="TEXT">D3DRMUSERVISUALREASON</A> enumerated type:
<DL>
<DT>D3DRMUSERVISUAL_CANSEE
 </DT><DD>The application should return TRUE if the user-visual object is visible in the viewport. In this case, the application uses the device specified in the <I>lpD3DRMview</I> parameter.
</DD><DT>D3DRMUSERVISUAL_RENDER
 </DT><DD>The application should render the user-visual element. In this case, the application uses the device specified in the <I>lpD3DRMDev</I> parameter.
</DD></DL>
</DD><DT><I>lpD3DRMDev</I>
</DT><DD>Address of a Direct3DRMDevice object used to render the Direct3DRMUserVisual object.
</DD><DT><I>lpD3DRMview</I>
</DT><DD>Address of a Direct3DRMViewport object used to determine whether the Direct3DRMUserVisual object is visible.
</DD></DL>
<H5>Return Values</H5>
<P>Returns TRUE if the <I>lpD3DRMUVreason</I> parameter is D3DRMUSERVISUAL_CANSEE and the user-visual object is visible in the viewport. Returns FALSE otherwise. If the <I>lpD3DRMUVreason</I> parameter is D3DRMUSERVISUAL_RENDER, the return value is application-defined. It is always safe to return TRUE. 

<H5>Remarks</H5>
<P>When determining the order in which to use callback functions, the system searches the objects highest in the hierarchy first, and then uses their callback functions in the order in which they were created.
<H5>See Also</H5>
<P><A HREF="rm0030.htm#rmuservz_0001010618000100" TARGET="TEXT">IDirect3DRMUserVisual::Init</A>
<H3><HR COLOR="#0000FF"><A NAME="rmfuncs_0001010602000800">D3DRMWRAPCALLBACK</A></H3>
<P>This callback function is not supported.
<P>
<P>
<P><B>void</B> <B>(</B><BR>&nbsp;&nbsp;<I>*D3DRMWRAPCALLBACK</I><BR>&nbsp;&nbsp;<B>)</B><B>(</B><BR>&nbsp;&nbsp;<B>LPD3DVECTOR</B> <I>lpD3DVector</I><B>,</B><BR>&nbsp;&nbsp;<B>int*</B> <I>lpU</I><B>,</B><BR>&nbsp;&nbsp;<B>int*</B> <I>lpV</I><B>,</B><BR>&nbsp;&nbsp;<B>LPD3DVECTOR</B> <I>lpD3DRMVA</I><B>,</B><BR>&nbsp;&nbsp;<B>LPD3DVECTOR</B> <I>lpD3DRMVB</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
