<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Inftee Sample (Infinite-Pin Tee Filter)</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0366.htm','/dssd0000.htm','/dssd0311.htm','/index.htm','/dssd0368.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="samples_0001070205000000">Inftee Sample (Infinite-Pin Tee Filter)</A></H2>
<BR CLEAR=ALL>
<P>The Inftee sample infinite-pin tee filter has multiple output pins and passes through type enumerators from source filters. The filter uses the <A HREF="dssd0198.htm" TARGET="TEXT">CAutoLock</A>, <A HREF="dssd0204.htm" TARGET="TEXT">CBaseFilter</A>, <A HREF="dssd0205.htm" TARGET="TEXT">CBaseInputPin</A>, <A HREF="dssd0209.htm" TARGET="TEXT">CBaseOutputPin</A>, <A HREF="dssd0220.htm" TARGET="TEXT">CCritSec</A>, and <A HREF="dssd0245.htm" TARGET="TEXT">COutputQueue</A> base classes.

<P>Inftee has one input pin and a variable number of output pins, typically two. It accepts data samples through the <A HREF="dssd0168.htm" TARGET="TEXT">IMemInputPin</A> transport, which it implements. All data samples sent to the filter are delivered down all paths simultaneously, therefore <I>teeing</I> the input into multiple separate output streams. The data samples are not type-specific, so the input, for example, can be text lyrics, video images, or audio buffers.

<P>When considering two output pins, the tee filter sends the same data down both of the pins; therefore, the pins must have negotiated the same media type during connection. The infinite-pin tee filter handles this negotiation so that the input pin and both output pins converge when using the same media type. If a suitable media type cannot be found, then the connection is rejected.

<P>The filter always uses the suggested allocator; the filter that provides the data suggests the allocator. The data arriving at the input pin is not copied before it is sent to the output pins. The filter also ensures that the data is delivered to the downstream filters, to guarantee that both outputs receive timely service. In particular, if one of the outputs can block in the <A HREF="dssd0245.htm#Lib_0001060237020d00" TARGET="TEXT">COutputQueue::Receive</A> member function, then the tee spins off a thread to deliver the sample. If there were no thread to deliver the sample, then the thread that delivers the sample to the tee input pin might pass the data to a downstream filter; at that point, it might block, keeping data from the other downstream filter for long periods of time.

<P>This filter is installed with the DirectShow run time and is available through the Filter Graph Editor when you choose <B>Insert Filters</B> from the <B>Graph</B> menu, and select the DirectShow Filters category.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>



<A NAME="samples_0001070205010000"></A><P><B>MPGAudio Sample (MPEG Audio Decoder Filter)</B>
<P>The sample MPEG audio codec, MPGAudio, provides a prototype for an MPEG audio decoder. It uses the <A HREF="dssd0259.htm" TARGET="TEXT">CTransformFilter</A> class.

<P>As supplied, this framework just consumes the passed-in audio frames. That is, audio frames do not produce any output from this framework. You would need to expand the framework with code specific to the outputs desired.

<P>This filter is installed with the DirectShow run time and is available through the Filter Graph Editor when you choose <B>Insert Filters</B> from the <B>Graph</B> menu, and select the DirectShow Filters category.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>


<A NAME="samples_0001070205020000"></A><P><B>MPGVideo Sample (MPEG Video Decoder Filter)</B>
<P>The sample MPEG video codec, MPGVideo, provides a prototype for an MPEG video decoder. It uses the <A HREF="dssd0259.htm" TARGET="TEXT">CTransformFilter</A> class. The MPGVideo filter also shows the processing of quality-management messages.

<P>As supplied, this framework just consumes the passed-in video frames. That is, video frames do not produce any output from this framework. You would need to expand the framework with code specific to the outputs desired.

<P>This filter is installed with the DirectShow run time and is available through the Filter Graph Editor when you choose <B>Insert Filters</B> from the <B>Graph</B> menu, and select the DirectShow Filters category.


<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>


<A NAME="samples_0001070205030000"></A><P><B>Nullip Sample (Null In Place Filter)</B>
<P>The null in-place sample filter, Nullip, is an example of a transform-inplace filter. It illustrates how a transform filter can behave in a relatively transparent manner. Nullip is a simple filter that passes all data from its input pin to its output pin. No transformations are performed on the data.

<P>The Nullip filter provides an example of using the <A HREF="dssd0263.htm" TARGET="TEXT">CTransInPlaceInputPin</A> class. It shows how to use the <A HREF="dssd0198.htm" TARGET="TEXT">CAutoLock</A> class to automatically release critical sections. Other classes used include <A HREF="dssd0262.htm" TARGET="TEXT">CTransInPlaceFilter</A>, <A HREF="dssd0211.htm" TARGET="TEXT">CBasePropertyPage</A>, <A HREF="dssd0240.htm" TARGET="TEXT">CMediaType</A>, and <A HREF="dssd0264.htm" TARGET="TEXT">CTransInPlaceOutputPin</A>. It also enables a user to select the media types that it can pass through itself. This filter has one input pin, one output pin, and performs its transform in place (without copying the data) in the push thread.


 In other words, the <A HREF="dssd0262.htm#Lib_0001060248030a00" TARGET="TEXT">CTransInPlaceFilter::Receive</A> method is called with a buffer, which it transforms and delivers to the next filter downstream. The 
<A HREF="dssd0262.htm#Lib_0001060248030a00" TARGET="TEXT">Receive</A> method is then blocked until that filter returns; it subsequently returns to its own calling member function.

<P>This filter is installed with the DirectShow run time and is available through the Filter Graph Editor when you choose <B>Insert Filters</B> from the <B>Graph</B> menu, and select the DirectShow Filters category.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>


<A NAME="samples_0001070205040000"></A><P><B>Nullnull Sample (Minimal Null Filter)</B>
<P>The minimal null sample filter, Nullnull, illustrates a minimal filter. It does not support the media type selection that <A CLASS=TCTOP HREF="dssd0367.htm#samples_0001070205030000" TARGET="TEXT">Nullip</A> does. The Nullnull filter uses the <A HREF="dssd0262.htm" TARGET="TEXT">CTransInPlaceFilter</A> class.

<P>This filter is installed with the DirectShow run time and is available through the Filter Graph Editor when you choose <B>Insert Filters</B> from the <B>Graph</B> menu, and select the DirectShow Filters category.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>


<A NAME="samples_0001070205050000"></A><P><B>Vcrctrl Sample (VCR Control Filter)</B>
<P>The VCR control sample filter, Vcrctrl, is a simple implementation of the external device control interfaces that DirectShow provides. Vcrctrl provides basic transport control and SMPTE timecode-reading capabilities for certain Betacam and SVHS videocassette recorders with RS-422 or RS-232 serial interfaces (see source code for specific machine types supported).

<P>This sample is not intended to be a frame-accurate, system-ready implementation ready for professional applications. It is designed to show basic device control filter structure, and therefore does not implement several of the more sophisticated features of the interfaces, such as edit event control. Frame-accurate control is best achieved by writing a low-level, kernel-mode communications driver underneath the filter. Developers should refer to the Driver Development Kit (DDK) for the appropriate platform.


<P><B>Using the Sample</B>
<P>With this sample, you can control a VCR through property pages.


 You should keep in mind the following:
<UL><LI>The sample automatically links the transport to the graph's Run, Pause, and Stop methods. You can unlink the transport on the General property page by removing the selection from the Link to Graph check box. This is a persistent property, so if you save the graph the transport will remain unlinked.
<LI>The filter automatically detects the presence of a compatible VCR on COM2. If it can't find a VCR or if the port is in use, it switches to simulation mode. You can select the port to use on the General property page. 
<LI>The timecode pin can connect either to the text renderer or the timecode renderer (Tcrender.ax), which accepts the media type MEDIATYPE_AuxData/MEDIASUBTYPE_Timecode. 
<LI>The main property page shows the available video and audio inputs, although you can't select them. The hardware does not support this feature, and it was implemented to show physical pin property enumeration.
<LI>The device communications class (CDevCom, specified in Cdevcom.h and Cdevcom.cpp) is thread-safe and handles SMPTE timecodes. On some VCRs, timecode detection is not supported, so timecode values might not be accurate.
</UL>
<P>This sample contains the following files:
<UL><LI>Vcrutil.h, .cpp &#151; implementation of the device control interfaces
<LI>Fvcrctrl.h, .cpp &#151; the filter implementation
<LI>Cdevcom.h, .cpp &#151; the communications object that handles device-specific protocols and the serial port interface
<LI>Ctimecod.h, .cpp &#151; the SMPTE timecode support
<LI>Trprop.h, .cpp &#151; the transport properties
<LI>Vcrprop.h, .cpp &#151; the general properties
<LI>Vcrprop.rc &#151; the dialog resources
<LI>Vcrctrl.def &#151; the module definition file
<LI>Vcruids.h &#151; the CLSIDs used by the filter
</UL>
<P>This filter is installed with the DirectShow run time and is available through the Filter Graph Editor when you choose <B>Insert Filters</B> from the <B>Graph</B> menu, and select the DirectShow Filters category.

<P><A CLASS=TCTOP HREF="dssd0363.htm#samples_0001070201090000" TARGET="TEXT">Sample Locations</A>


<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
