<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::CreatePlayer</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0028.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0030.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03000600">IDirectPlay3::CreatePlayer</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Creates a local player for the current session.

<P><B>HRESULT</B> <B>CreatePlayer</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDPID</B> <I>lpidPlayer</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDPNAME</B> <I>lpPlayerName</I><B>,</B><BR>&nbsp;&nbsp;<B>HANDLE</B> <I>hEvent</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpData</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwDataSize</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpidPlayer</I>
</DT><DD>Pointer to a variable that will be filled with the DirectPlay player ID. This value is defined by DirectPlay.
</DD><DT><I>lpPlayerName</I>
</DT><DD>Pointer to a <A HREF="dpbu0090.htm" TARGET="TEXT">DPNAME</A> structure that holds the name of the player. NULL indicates that the player has no initial name information. The name in <I>lpPlayerName</I> is provided for human use only. It is not used internally and need not be unique. 
</DD><DT><I>hEvent</I>
</DT><DD>An event object created by the application that will be signaled by DirectPlay when a message addressed to this player is received.
</DD><DT><I>lpData</I>
</DT><DD>Pointer to a block of application-defined data to associate with the player ID. NULL indicates that the player has no initial data. The data specified in this parameter is assumed to be remote data that will be propagated to all the other applications in the session, as if <A HREF="dpbu0064.htm" TARGET="TEXT">IDirectPlay3::SetPlayerData</A> were called.
</DD><DT><I>dwDataSize</I>
</DT><DD>Size, in bytes, of the data block that <I>lpData</I> points to.
</DD><DT><I>dwFlags</I>
</DT><DD>Flags indicating what type of player this is. Default (<I>dwFlags</I> = 0) is a nonspectator, nonserver player.
</DD><DD><B><A NAME="ref_0001010a03000601">DPPLAYER_SERVERPLAYER</A></B> &#150; the player is a server player for client/server communications. Only the host can create a server player. There can only be one server player in a session. <B>CreatePlayer</B> will always return a player ID of DPID_SERVERPLAYER if this flag is specified.
</DD><DD><B><A NAME="ref_0001010a03000602">DPPLAYER_SPECTATOR</A></B> &#150; the player is created as a spectator. A spectator player behaves exactly as a normal player except the player is flagged as a spectator. The application can then limit what a spectator player can do. The behavior of a spectator player is completely defined by the application. DirectPlay simply propagates this flag.

</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a0900000b" TARGET="TEXT">DPERR_CANTADDPLAYER</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900000d" TARGET="TEXT">DPERR_CANTCREATEPLAYER</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000019" TARGET="TEXT">DPERR_INVALIDFLAGS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000022" TARGET="TEXT">DPERR_NOCONNECTION</A>
</DT></DL>

<H5>Remarks</H5>
<P> 
A single process can have multiple local players that communicate through a DirectPlay object with other players on the same computer or players on remote computers. 
<P>Upon successful completion, this method sends a <A HREF="dpbu0097.htm" TARGET="TEXT">DPMSG_CREATEPLAYERORGROUP</A> system message to all the other players in the session announcing that a new player has joined the session. By default, all local players receive copies of all the system messages. 


<P>Your application should use the player ID returned to the application to identify the player for message passing and data association. Player and group IDs assigned by DirectPlay will always be unique within the session.

<P>If the application closes the session, any local players created will be automatically destroyed. Only the application that created the player can:
<UL><LI>destroy the player.
<LI>change the player's name or remote data. 
<LI>send messages from the player. 
</UL>
<P>If the application uses a separate thread to retrieve DirectPlay messages, it is highly recommended that a non-NULL <I>hEvent</I> be supplied and used for synchronization. This event will be set when this player receives a message. Within the message receive thread, use the Win32 API <B>WaitForSingleObject</B> (or use <B>WaitForMultipleObjects</B> if more than one event is used) within the thread to determine if a player has messages. It is inefficient to loop on <A HREF="dpbu0057.htm" TARGET="TEXT">IDirectPlay3::Receive</A> inside a separate thread waiting for a message. The same event can be used for all the local players, or the application can supply different events for each player. The application is responsible for creating and destroying the event. See <A CLASS=tctop HREF="dpbu0007.htm#usingdp_0001010701060100" TARGET="TEXT">Synchronization</A> for more information.

<H5>See Also</H5>
<P><A HREF="dpbu0090.htm" TARGET="TEXT">DPNAME</A>, <A HREF="dpbu0097.htm" TARGET="TEXT">DPMSG_CREATEPLAYERORGROUP</A>, <A HREF="dpbu0033.htm" TARGET="TEXT">IDirectPlay3::DestroyPlayer</A>, <A HREF="dpbu0038.htm" TARGET="TEXT">IDirectPlay3::EnumPlayers</A>, <A HREF="dpbu0057.htm" TARGET="TEXT">IDirectPlay3::Receive</A>, <A HREF="dpbu0059.htm" TARGET="TEXT">IDirectPlay3::Send</A>, <A HREF="dpbu0064.htm" TARGET="TEXT">IDirectPlay3::SetPlayerData</A>, <A HREF="dpbu0065.htm" TARGET="TEXT">IDirectPlay3::SetPlayerName</A>, <A HREF="dpbu0051.htm" TARGET="TEXT">IDirectPlay3::GetPlayerFlags</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
