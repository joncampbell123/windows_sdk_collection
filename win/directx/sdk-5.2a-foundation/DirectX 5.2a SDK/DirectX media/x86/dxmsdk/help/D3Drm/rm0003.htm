<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Direct3D Retained Mode Architecture</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/rm0002.htm','/rm0000.htm','/rm0000.htm','/index.htm','/rm0004.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="dx5_Introduction_to_Direct3D_Retained_Mode_Objects_d3drm"></A><A NAME="rmobject_0001010301000000">Direct3D Retained Mode Architecture</A></H2>
<BR CLEAR=ALL>
<P>This section gives an overview of the Microsoft&#174; Direct3D&#174; Retained Mode interfaces. The following topics are discussed:
<UL><LI><A CLASS=tctop HREF="rm0003.htm#rmobject_0001010301010000" TARGET="TEXT">Objects</A> gives a brief description of the Direct3D Retained Mode objects.
<LI><A CLASS=tctop HREF="rm0003.htm#rmobject_0001010301020000" TARGET="TEXT">Objects and Interfaces</A> lists the interfaces supported by each object, as well as information on creating interfaces to both single objects and array objects. 
<LI><A CLASS=tctop HREF="rm0003.htm#rmobject_0001010301030000" TARGET="TEXT">Objects and Reference Counting</A> gives tips on reference counting in Direct3D Retained Mode.
<LI><A CLASS=tctop HREF="rm0003.htm#rmobject_0001010301040000" TARGET="TEXT">Z-Buffers in Retained Mode</A> describes how Direct3D Retained Mode handles overlays.
</UL>
<H3><A NAME="rmobject_0001010301010000">Direct3D Retained Mode Objects</A></H3>
<P>All access to Direct3D Retained Mode is through a small set of objects. The following table lists these objects and a brief description of each:
<P>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Object</B></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401020000" TARGET="TEXT">Direct3DRMAnimation</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Defines how a transformation will be modified&#151;often in reference to a Direct3DRMFrame or Direct3DRMFrame2 object. You can use it to animate the position, orientation, and scaling of Direct3DRMVisual, Direct3DRMLight, and Direct3DRMViewport objects.


</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401020000" TARGET="TEXT">Direct3DRMAnimationSet</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Allows Direct3DRMAnimation
 objects to be grouped together.

</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401030000" TARGET="TEXT">Direct3DRMDevice</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Represents the visual display destination for the renderer. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401030000" TARGET="TEXT">Direct3DRMDevice2</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Represents the visual display destination for the renderer. Same as the Direct3DRMDevice object but with enhanced control of transparency. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401040000" TARGET="TEXT">Direct3DRMFace</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Represents a single polygon in a mesh.
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401050000" TARGET="TEXT">Direct3DRMFrame</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Positions objects within a scene and defines the positions and orientations of visual objects. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401050000" TARGET="TEXT">Direct3DRMFrame2</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Extends the <B>Direct3DRMFrame</B> object by enabling access to the frame axes, bounding boxes, and materials. Also supports ray picking.
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401060000" TARGET="TEXT">Direct3DRMInterpolator</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Stores actions and applies the actions to objects with automatic calculation of in-between values.
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401070000" TARGET="TEXT">Direct3DRMLight</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Defines one of five types of lights that are used to illuminate the visual objects in a scene. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401080000" TARGET="TEXT">Direct3DRMMaterial</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Defines how a surface reflects light. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401090000" TARGET="TEXT">Direct3DRMMesh</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Consists of a set of polygonal faces. You can use this object to manipulate groups of faces and vertices. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401090000" TARGET="TEXT">Direct3DRMMeshBuilder</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Allows you to work with individual vertices and faces in a mesh. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401090000" TARGET="TEXT">Direct3DRMMeshBuilder2</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Allows you to work with individual vertices and faces in a mesh. Same as the <B>Direct3DRMMeshBuilder</B> object but with than the <B>Direct3DRMMeshBuilder</B> object.

</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_00010104010a0000" TARGET="TEXT">Direct3DRMObject</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Used as a base class by all other Direct3D Retained Mode objects. It has characteristics that are common to all objects. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_00010104010b0000" TARGET="TEXT">Direct3DRMPickedArray</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Identifies a visual object that corresponds to a given 2-D point. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_00010104010b0000" TARGET="TEXT">Direct3DRMPicked2Array</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Identifies a visual object that corresponds to a given ray intersection. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_00010104010c0000" TARGET="TEXT">Direct3DRMProgressiveMesh</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Consists of a coarse base mesh together with records describing how to incrementally refine the mesh. This allows a generalized level of detail to be set on the mesh, as well as progressive download of the mesh from a remote source. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_00010104010d0000" TARGET="TEXT">Direct3DRMShadow</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Defines a shadow. 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_00010104010e0000" TARGET="TEXT">Direct3DRMTexture</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Represents a rectangular array of colored pixels.

</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_00010104010e0000" TARGET="TEXT">Direct3DRMTexture2</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Represents a rectangular array of colored pixels. Same as the <B>Direct3DRMTexture</B> object except that resources can be loaded from files other than the currently executing file, textures can be created from images in memory, and you can generate mipmaps.
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_00010104010f0000" TARGET="TEXT">Direct3DRMUserVisual</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Provides functionality not otherwise available in the system. It is defined by an application.

</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401100000" TARGET="TEXT">Direct3DRMViewport</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Defines how the 3-D scene is rendered into a 2-D window. 

</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401110000" TARGET="TEXT">Direct3DRMVisual</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Represents anything that can be rendered in a scene. Visual objects need not be visible; for example, a frame can be added as a visual object.
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0004.htm#rmfaceov_0001010401120000" TARGET="TEXT">Direct3DRMWrap</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Calculates texture coordinates for a face or mesh. 
</FONT></TD>
</TR>
</TABLE>
<P>Many objects can be grouped into arrays, called <I>array objects</I>. Array objects make it simpler to apply operations to the entire group. The Component Object Model (COM) interfaces that allow you to work with array objects contain the <B>GetElement</B> and <B>GetSize</B> methods. These methods retrieve a pointer to an element in the array and the size of the array, respectively. For more information about array interfaces, see <A CLASS=tctop HREF="rm0009.htm#rmarray_0001010603000000" TARGET="TEXT">IDirect3DRM Array Interfaces</A>.

<H3><A NAME="dx5_Objects_and_Interfaces_d3drm"></A><A NAME="rmobject_0001010301020000">Objects and Interfaces</A></H3>
<P>Using the <I>IObjectName</I><B>::QueryInterface</B> method retrieves a valid interface pointer only if the object supports that interface; therefore, you could use the <B>IDirect3DRMDevice::QueryInterface</B> method to retrieve the <B>IDirect3DRMWinDevice</B> interface, but not to retrieve the <B>IDirect3DRMVisual</B> interface. 
<P>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Object name
 </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Supported interfaces
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMAnimation
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0012.htm#rmanim_0001010606000000" TARGET="TEXT">IDirect3DRMAnimation</A>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMAnimationSet
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0013.htm#rmanimst_0001010607000000" TARGET="TEXT">IDirect3DRMAnimationSet</A>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMDevice
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0014.htm#rmdevice_0001010608000000" TARGET="TEXT">IDirect3DRMDevice</A>, <A CLASS=tctop HREF="rm0032.htm#rmwindev_000101061a000000" TARGET="TEXT">IDirect3DRMWinDevice</A> 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMDevice2
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0015.htm#rmdev2_0001010609000000" TARGET="TEXT">IDirect3DRMDevice2</A>, <A CLASS=tctop HREF="rm0032.htm#rmwindev_000101061a000000" TARGET="TEXT">IDirect3DRMWinDevice</A>
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMFace
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0016.htm#rmface_000101060a000000" TARGET="TEXT">IDirect3DRMFace</A>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMFrame
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0017.htm#rmframe_000101060b000000" TARGET="TEXT">IDirect3DRMFrame</A>, <B>IDirect3DRMVisual</B>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMFrame2
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0018.htm#rmframe2_000101060c000000" TARGET="TEXT">IDirect3DRMFrame2</A>, <B>IDirect3DRMVisual</B>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMInterpolator
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0019.htm#rminterp_000101060d000000" TARGET="TEXT">IDirect3DRInterpolator</A>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMLight
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0020.htm#rmlight_000101060e000000" TARGET="TEXT">IDirect3DRMLight</A>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMMaterial
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0021.htm#rmmatrl_000101060f000000" TARGET="TEXT">IDirect3DRMMaterial</A>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMMesh
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0022.htm#rmmesh_0001010610000000" TARGET="TEXT">IDirect3DRMMesh</A>, <B>IDirect3DRMVisual</B>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMMeshBuilder
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0023.htm#rmmshbld_0001010611000000" TARGET="TEXT">IDirect3DRMMeshBuilder</A>, <B>IDirect3DRMVisual</B>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMMeshBuilder2
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0024.htm#rmmshbl2_0001010612000000" TARGET="TEXT">IDirect3DRMMeshBuilder2</A>, <B>IDirect3DRMVisual</B>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMProgressiveMesh
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0026.htm#rmpmesh_0001010614000000" TARGET="TEXT">IDirect3DRMProgressiveMesh</A>, <B>IDirect3DRMVisual</B>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMShadow
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0027.htm#rmshadow_0001010615000000" TARGET="TEXT">IDirect3DRMShadow</A>, <B>IDirect3DRMVisual</B>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMTexture
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0028.htm#rmtextur_0001010616000000" TARGET="TEXT">IDirect3DRMTexture</A>, <A CLASS=tctop HREF="rm0029.htm#rmtext2_0001010617000000" TARGET="TEXT">IDirect3DRMTexture2</A>, <B>IDirect3DRMVisual</B>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMUserVisual
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0030.htm#rmuservz_0001010618000000" TARGET="TEXT">IDirect3DRMUserVisual</A>, <B>IDirect3DRMVisual</B>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMViewport
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0031.htm#rmviewpt_0001010619000000" TARGET="TEXT">IDirect3DRMViewport</A>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Direct3DRMWrap
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0033.htm#rmwrap_000101061b000000" TARGET="TEXT">IDirect3DRMWrap</A>
</FONT></TD></TR></TABLE>
<P>The following example illustrates how to create two interfaces to a single Direct3DRMDevice object. The <A HREF="rm0010.htm#rmid3drm_0001010604000f00" TARGET="TEXT">IDirect3DRM::CreateObject</A> method creates an uninitialized Direct3DRMDevice object. The <A HREF="rm0014.htm#rmdevice_0001010608001000" TARGET="TEXT">IDirect3DRMDevice::InitFromClipper</A> method initializes the object. The call to the <A HREF="rm0038.htm#external_0001010620000021" TARGET="TEXT">IDirect3DRMDevice::QueryInterface</A> method creates a second interface to the Direct3DRMDevice object&#151;an <A CLASS=tctop HREF="rm0032.htm#rmwindev_000101061a000000" TARGET="TEXT">IDirect3DRMWinDevice</A> interface that the application will use to handle WM_PAINT and WM_ACTIVATE messages.
<PRE><FONT FACE="Courier" SIZE="2">
d3drmapi-&gt;CreateObject(CLSID_CDirect3DRMDevice, NULL,
    IID_IDirect3DRMDevice,(LPVOID FAR*)&amp;dev1);
dev1-&gt;InitFromClipper(lpDDClipper, IID_IDirect3DRMDevice, 
    r.right, r.bottom);
dev1-&gt;QueryInterface(IID_IDirect3DRMWinDevice, (LPVOID*) &amp;dev2);
</FONT></PRE>
<P>To determine whether two interfaces refer to the same object, use the <B>QueryInterface</B> method of each interface, and compare the values of the pointers they return. If the pointer values are the same, the interfaces refer to the same object. 

<P>All Direct3D Retained Mode objects support the <A HREF="rm0025.htm#rmobj_0001010613000000" TARGET="TEXT">IDirect3DRMObject</A> and <A CLASS=tctop HREF="rm0038.htm#external_000101062000001e" TARGET="TEXT">IUnknown</A> interfaces in addition to the interfaces in the preceding list. Array objects are not derived from <B>IDirect3DRMObject</B>. Array objects have no class identifiers (CLSIDs) because they are not needed. Applications cannot create array objects in a call to the <A HREF="rm0010.htm#rmid3drm_0001010604000f00" TARGET="TEXT">IDirect3DRM::CreateObject</A> method; instead, they should use the creation methods listed below for each interface:
<P>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Array interface</B></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Creation method
</B></FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0009.htm#rmarray_0001010603020000" TARGET="TEXT">IDirect3DRMDeviceArray</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="rm0010.htm#rmid3drm_0001010604001700" TARGET="TEXT">IDirect3DRM::GetDevices</A>
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0009.htm#rmarray_0001010603030000" TARGET="TEXT">IDirect3DRMFaceArray</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="rm0023.htm#rmmshbld_0001010611000e00" TARGET="TEXT">IDirect3DRMMeshBuilder::GetFaces</A> or <A HREF="rm0024.htm#rmmshbl2_0001010612000f00" TARGET="TEXT">IDirect3DRMMeshBuilder2::GetFaces</A> 
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0009.htm#rmarray_0001010603040000" TARGET="TEXT">IDirect3DRMFrameArray</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="rm0009.htm#rmarray_0001010603070100" TARGET="TEXT">IDirect3DRMPickedArray::GetPick</A>, <A HREF="rm0009.htm#rmarray_0001010603080100" TARGET="TEXT">IDirect3DRMPicked2Array::GetPick</A>, or <A HREF="rm0017.htm#rmframe_000101060b000d00" TARGET="TEXT">IDirect3DRMFrame::GetChildren</A>
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0009.htm#rmarray_0001010603050000" TARGET="TEXT">IDirect3DRMLightArray</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="rm0017.htm#rmframe_000101060b000f00" TARGET="TEXT">IDirect3DRMFrame::GetLights</A>
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0009.htm#rmarray_0001010603060000" TARGET="TEXT">IDirect3DRMObjectArray</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="rm0019.htm#rminterp_000101060d000300" TARGET="TEXT">IDirect3DRMInterpolator::GetAttachedObjects</A>
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0009.htm#rmarray_0001010603070000" TARGET="TEXT">IDirect3DRMPickedArray</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="rm0031.htm#rmviewpt_0001010619001300" TARGET="TEXT">IDirect3DRMViewport::Pick</A>
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0009.htm#rmarray_0001010603080000" TARGET="TEXT">IDirect3DRMPicked2Array</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="rm0018.htm#rmframe2_000101060c002d00" TARGET="TEXT">IDirect3DRMFrame2::RayPick</A>
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0009.htm#rmarray_0001010603090000" TARGET="TEXT">IDirect3DRMViewportArray</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="rm0010.htm#rmid3drm_0001010604000900" TARGET="TEXT">IDirect3DRM::CreateFrame</A>
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="rm0009.htm#rmarray_00010106030a0000" TARGET="TEXT">IDirect3DRMVisualArray</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="rm0017.htm#rmframe_000101060b002100" TARGET="TEXT">IDirect3DRMFrame::GetVisuals</A>
</FONT></TD>
</TR>
</TABLE>
<H3><A NAME="dx5_Objects_and_Reference_Counting_d3drm"></A><A NAME="rmobject_0001010301030000">Objects and Reference Counting</A></H3>
<P>When an object is created, its <A HREF="rm0055.htm#3Dgloss_000101080b000001" TARGET="TEXT">reference count</A> is increased. Each time an application creates a child of an object or a method returns a pointer to an object, the system increases the reference count for that object. The object is not deleted until its reference count reaches zero. 
<P>Applications need to keep track of the reference count for a single object only&#151;the root of the scene. The system keeps track of the other reference counts automatically. Applications should be able to simply release the scene, the viewport, and the device when they clean up before exiting. (When your application releases the viewport, the system automatically takes care of the camera's references.) Theoretically, an application could release a viewport without releasing the device (if it needed to add a new viewport to the device, for example), but when an application releases a device, it should release the viewport as well. 

<P>The reference count of a child or visual object increases when it is added to a frame. When you use the <A HREF="rm0017.htm#rmframe_000101060b000100" TARGET="TEXT">IDirect3DRMFrame::AddChild</A> method to move a child from one parent to another, the system handles the reference counting automatically. 
<P>After your application loads a visual object into a scene, the scene handles the reference counting for the visual object. The application no longer needs the visual object and can release it.
<P>Creating and applying a wrap does not increase the reference count of any objects because wrapping is really just a convenient method of calculating texture coordinates.
<H3><A NAME="rmobject_0001010301040000">Z-Buffers in Retained Mode</A></H3>
<P>The order in the z-buffer determines the order in which overlays clip each other. Overlays are assumed to be on top of all other screen components. Overlays that do not have a specified z-order behave in unpredictable ways when overlaying the same area on the primary surface. Direct3D Retained Mode does not sort overlays if you do not have a z-buffer. Overlays without a specified z-order are assumed to have a z-order of 0, and will appear in the order they are rendered. The possible z-order of overlays ranges from 0, which is just on top of the primary surface, to 4 billion, which is as close to the viewer as possible. An overlay with a z-order of 2 would obscure an overlay with a z-order of 1. No two overlays can have the same z-order. 

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
