<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IAMVideoControl Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0119.htm','/dssd0000.htm','/dssd0093.htm','/index.htm','/dssd0184.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="IAMVideoControl">IAMVideoControl Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IAMVideoControl</B> interface allows you to flip a picture horizontally and/or vertically, to set up a stream so it can capture from an external trigger, for example, a push button on a camera, to simulate an external trigger in software, and to list the available frame rates.

<P>This interface uses the video control flags in the <A HREF="dssd0301.htm#VideoControlFlags" TARGET="TEXT">VideoControlFlags</A> enumeration.

<A NAME="IAMVideoControl_When_to_Implement"></A><P><B>When to Implement</B>
<P>Implement this interface when your filter needs to control the video image or to list the frame rates.

<A NAME="IAMVideoControl_When_to_Use"></A><P><B>When to Use</B>
<P>Use this interface when your application runs on hardware which is capable of flipping and external triggering.

<A NAME="IAMVideoControl_Methods_in_Vtable_Or"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0183.htm#If_000106015a030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0183.htm#If_000106015a030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0183.htm#If_000106015a030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>

<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMVideoControl methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="IAMVideoControl.htm#GetCaps" TARGET="TEXT">GetCaps</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the capabilities of the underlying hardware.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="IAMVideoControl.htm#SetMode" TARGET="TEXT">SetMode</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the video control mode of operation.
</FONT></TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="IAMVideoControl.htm#GetMode" TARGET="TEXT">GetMode</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the video control mode of operation.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="IAMVideoControl.htm#GetCurrentActualFrameRate" TARGET="TEXT">GetCurrentActualFrameRate</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the actual frame rate at which the device is streaming.  For some devices, such as USB (Universal Serial Bus) and IEEE 1394 cameras, where the maximum framerate may be limited due to bandwidth availability. This is only available during video streaming.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="IAMVideoControl.htm#GetMaxAvailableFrameRate" TARGET="TEXT">GetMaxAvailableFrameRate</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the maximum frame rate currently available based on bus bandwidth usage, for connections such as USB and 1394 camera devices where the maximum framerate may be limited due to bandwidth availability.
</FONT></TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="IAMVideoControl.htm#GetFrameRateList" TARGET="TEXT">GetFrameRateList</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a list of available frame rates.
</FONT></TD></TR>
</TABLE>

<H3><HR COLOR="#0000FF"><A NAME="GetCaps">IAMVideoControl::GetCaps</A></H3>
<A HREF="IAMVideoControl.htm" TARGET="TEXT">IAMVideoControl Interface</A>
<P>Retrieves the capabilities of the underlying hardware.
<P><B>HRESULT</B> <B>GetCaps</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B><I>pCapsFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR>
<H5>Parameters</H5>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to query capabilities from. 
</DD><DT><I>pCapsFlags</I>
 </DT><DD>[out] Pointer to a value representing a combination of the flags from the <A HREF="dssd0301.htm#VideoControlFlags" TARGET="TEXT">VideoControlFlags</A> enumeration. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0310.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 
<H5>Remarks</H5>
<P>Possible capabilities include one or more of the following: flipping the picture horizontally, flipping the picture vertically, enabling external triggers, and simulating external triggers. 


<H3><HR COLOR="#0000FF"><A NAME="GetCurrentActualFrameRate">IAMVideoControl::GetCurrentActualFrameRate</A></H3>
<A HREF="IAMVideoControl.htm" TARGET="TEXT">IAMVideoControl Interface</A>
<P>Retrieves the actual frame rate, expressed as a frame duration in 100 nS units. USB (Universal Serial Bus) and IEEE 1394 cameras may provide lower frame rates than requested, due to bandwidth availability. This is only available during video streaming.
<P><B>HRESULT</B> <B>GetCurrentActualFrameRate</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B><I>ActualFrameRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR><H5>Parameters</H5>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to retrieve the frame rate from. 
</DD><DT><I>ActualFrameRate</I>
 </DT><DD>[out] Pointer to the frame rate in frame duration in 100 nS units.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0310.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H3><HR COLOR="#0000FF"><A NAME="GetFrameRateList">IAMVideoControl::GetFrameRateList</A></H3>
<A HREF="IAMVideoControl.htm" TARGET="TEXT">IAMVideoControl Interface</A>
<P>Retrieves a list of available frame rates.
<P><B>HRESULT</B> <B>GetFrameRateList</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>iIndex</I><B>,</B><BR>&nbsp;&nbsp;<B>SIZE</B> <I>Dimensions</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B><I>ListSize</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>**</B> <I>FrameRates</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR>
<H5>Parameters</H5>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to query list of frame rates from. 
</DD><DT><I>iIndex</I>
 </DT><DD>[in] The index of the format to query for frame rates. This index corresponds to the order in which formats are enumerated by <A HREF="dssd0110.htm#If_0001060111030300" TARGET="TEXT">IAMStreamConfig::GetStreamCaps</A>. The value must range between 0 and the number of supported <A HREF="dssd0300.htm#structs_0001060501001c00" TARGET="TEXT">VIDEO_STREAM_CONFIG_CAPS</A> structures returned by <A HREF="dssd0110.htm#If_0001060111030200" TARGET="TEXT">IAMStreamConfig::GetNumberOfCapabilities</A>) -1. 

</DD><DT><I>Dimensions</I>
 </DT><DD>[in] The frame's image size (width and height) in pixels.  
</DD><DT><I>ListSize</I>
 </DT><DD>[out] Pointer to the number of elements in the list of frame rates.
</DD><DT><I>FrameRates</I>
 </DT><DD>[out] An array of frame rates in 100 nSec units. Can be NULL if only <I>ListSize</I> is wanted.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0310.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 
<H5>Remarks</H5>
<p>It is the responsibility of the caller to free the memory through a call to <A HREF="dssd0406.htm#external_00010a0109000012" TARGET="TEXT">CoTaskMemFree</A>.

<H3><HR COLOR="#0000FF"><A NAME="GetMaxAvailableFrameRate">IAMVideoControl::GetMaxAvailableFrameRate</A></H3>
<A HREF="IAMVideoControl.htm" TARGET="TEXT">IAMVideoControl Interface</A>
<P>Retrieves the maximum frame rate currently available, based on bus bandwidth usage for connections, such as  USB (Universal Serial Bus) and IEEE 1394, where the maximum framerate may be limited due to bandwidth availability.
<P><B>HRESULT</B> <B>GetMaxAvailableFrameRate</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>iIndex</I><B>,</B><BR>&nbsp;&nbsp;<B>SIZE</B> <I>Dimensions</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>MaxAvailableFrameRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR>
<H5>Parameters</H5>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to maximum frame rate from. 
</DD><DT><I>iIndex</I>
 </DT><DD>[in] The index of the format to query for maximum frame rate. This index corresponds to the order in which formats are enumerated by <A HREF="dssd0110.htm#If_0001060111030300" TARGET="TEXT">IAMStreamConfig::GetStreamCaps</A>. The value must range between 0 and the number of supported <A HREF="dssd0300.htm#structs_0001060501001c00" TARGET="TEXT">VIDEO_STREAM_CONFIG_CAPS</A> structures returned by <A HREF="dssd0110.htm#If_0001060111030200" TARGET="TEXT">IAMStreamConfig::GetNumberOfCapabilities</A>) -1. 
</DD><DT><I>Dimensions</I>
 </DT><DD>[in] The frame's image size (width and height) in pixels.  
</DD><DT><I>MaxAvailableFrameRate</I>
 </DT><DD>[out] Pointer to the maximum available frame rate in frame duration in 100 nS units.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0310.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H3><HR COLOR="#0000FF"><A NAME="GetMode">IAMVideoControl::GetMode</A></H3>
<A HREF="IAMVideoControl.htm" TARGET="TEXT">IAMVideoControl Interface</A>
<P>Retrieves the video control mode of operation.
<P><B>HRESULT</B> <B>GetMode</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B>  <B>*</B><I>Mode</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR><H5>Parameters</H5>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to retrieve the video control mode from. 
</DD><DT><I>Mode</I>
 </DT><DD>[out] Pointer to a value representing a combination of the flags from the <A HREF="dssd0301.htm#VideoControlFlags" TARGET="TEXT">VideoControlFlags</A> enumeration, which specify the video control mode. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0310.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>Possible modes of operation include one or more of the following: flip the picture horizontally, flip the picture vertically, enable external triggers, and simulate external triggers. 

<H3><HR COLOR="#0000FF"><A NAME="SetMode">IAMVideoControl::SetMode</A></H3>
<A HREF="IAMVideoControl.htm" TARGET="TEXT">IAMVideoControl Interface</A>
<P>Sets the video control mode of operation.
<P><B>HRESULT</B> <B>SetMode</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B>  <B>*</B><I>Mode</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR><H5>Parameters</H5>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to set the video control mode on. 
</DD><DT><I>Mode</I>
 </DT><DD>[in] Pointer to a value specifying a combination of the flags from the <A HREF="dssd0301.htm#VideoControlFlags" TARGET="TEXT">VideoControlFlags</A> enumeration to set the video control mode. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0310.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>Possible modes of operation include one or more of the following: flip the picture horizontally, flip the picture vertically, enable external triggers, and simulate external triggers. 

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
