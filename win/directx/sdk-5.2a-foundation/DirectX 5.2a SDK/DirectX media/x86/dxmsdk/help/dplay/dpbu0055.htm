<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::InitializeConnection</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0054.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0056.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03002000">IDirectPlay3::InitializeConnection</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Initializes a DirectPlay connection. All the information about the connection, including the service provider to use, the network address of the server, and the GUID of the session, is passed in through the <I>lpConnection</I> parameter. 

<P><B>HRESULT</B> <B>InitializeConnection</B><B>(</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpConnection</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpConnection</I>
</DT><DD>Pointer to a buffer that contains all the information about the connection to be initialized as a <A CLASS=tctop HREF="dpbu0007.htm#usingdp_0001010701070000" TARGET="TEXT">DirectPlay Address</A>. 
</DD><DT><I>dwFlags</I>
</DT><DD>Not used. Must be zero.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise: 
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a09000005" TARGET="TEXT">DPERR_ALREADYINITIALIZED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000019" TARGET="TEXT">DPERR_INVALIDFLAGS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000031" TARGET="TEXT">DPERR_UNAVAILABLE</A>
</DT></DL>
<P>This method returns <A HREF="dpbu0120.htm#ref_0001010a09000005" TARGET="TEXT">DPERR_ALREADYINITIALIZED</A> if <B>InitializeConnection</B> has previously been called on this object. It returns <A HREF="dpbu0120.htm#ref_0001010a09000031" TARGET="TEXT">DPERR_UNAVAILABLE</A> if the service provider could not be initialized. This can be because the resources necessary to operate this service provider are not present (for example, TCP/IP stack not present).

<H5>Remarks</H5>
<P>The <I>lpConnection</I> parameter supplied to this method can be obtained from the <A HREF="dpbu0034.htm" TARGET="TEXT">IDirectPlay3::EnumConnections</A> method, or the application can create one directly using the <A HREF="dpbu0071.htm" TARGET="TEXT">IDirectPlayLobby2::CreateCompoundAddress</A> method.

<P>This method loads and initializes the appropriate service provider. The <I>lpConnection</I> parameter is passed on to the service provider, which extracts and saves any relevant information. This information is used when the <A HREF="dpbu0039.htm" TARGET="TEXT">IDirectPlay3::EnumSessions</A> or <A HREF="dpbu0056.htm" TARGET="TEXT">IDirectPlay3::Open</A> method is called so that the service provider does not pop up a dialog box asking for that information.

<P>This method replaces <A HREF="dpbu0012.htm" TARGET="TEXT">DirectPlayCreate</A> as the means of binding a service provider to a DirectPlay object. The primary benefits of <B>InitializeConnection</B> are that you can override the service provider dialogs, and you can initialize a lobby provider. 

<H5>See Also</H5>
<P><A HREF="dpbu0034.htm" TARGET="TEXT">IDirectPlay3::EnumConnections</A>, <A HREF="dpbu0071.htm" TARGET="TEXT">IDirectPlayLobby2::CreateCompoundAddress</A>, <A CLASS=tctop HREF="dpbu0007.htm#usingdp_0001010701070000" TARGET="TEXT">DirectPlay Address</A> 
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
