<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlay3::CreateGroup</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0026.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0028.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a03000400">IDirectPlay3::CreateGroup</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0023.htm" TARGET="TEXT">IDirectPlay3 Interface</A>
<P>Creates a group in the current session. A group is a logical collection of players or other groups.
<P><B>HRESULT</B> <B>CreateGroup</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDPID</B> <I>lpidGroup</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDPNAME</B> <I>lpGroupName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpData</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwDataSize</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpidGroup</I>
</DT><DD>Pointer to a variable that will be filled with the DirectPlay group ID. This value is defined by DirectPlay. 
</DD><DT><I>lpGroupName</I>
</DT><DD>Pointer to a <A HREF="dpbu0090.htm" TARGET="TEXT">DPNAME</A> structure that holds the name of the group. NULL indicates that the group has no initial name. The name in <I>lpGroupName</I> is provided for human use only; it is not used internally and need not be unique. 

</DD><DT><I>lpData</I>
</DT><DD>Pointer to a block of application-defined remote data to associate initially with the Group ID. NULL indicates that the group has no initial data. The data specified here is assumed to be remote data that will be propagated to all the other applications in the session as if <A HREF="dpbu0062.htm" TARGET="TEXT">IDirectPlay3::SetGroupData</A> were called.
</DD><DT><I>dwDataSize</I>
</DT><DD>Size, in bytes, of the data block that <I>lpData</I> points to.
</DD><DT><I>dwFlags</I>
</DT><DD>Flag indicating what type of group to create. By default (<I>dwFlags</I> = 0), ownership of the group will migrate to the host when the owner leaves the session, and the group persists until it is explicitly destroyed.


</DD><DD><B><A NAME="ref_0001010a03000401">DPGROUP_STAGINGAREA</A></B> &#150; the group is created as a staging area. A <A HREF="dpbu0005.htm#lobbyover_0001010501040000" TARGET="TEXT">staging area</A> is used to marshal players together in order to launch a new session. 

</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a0900000b" TARGET="TEXT">DPERR_CANTADDPLAYER</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000019" TARGET="TEXT">DPERR_INVALIDFLAGS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT></DL>

<H5>Remarks</H5>
<P>This method will generate a <A HREF="dpbu0097.htm" TARGET="TEXT">DPMSG_CREATEPLAYERORGROUP</A> system message that will be sent to all the other players. The application can use <A HREF="dpbu0059.htm" TARGET="TEXT">IDirectPlay3::Send</A> to send a message to all the players in a group by sending one message to the group ID. DirectPlay will either use multicast to send the message (if the service provider supports it) or send individual messages to each player in the group.
<P>The group ID returned to the application should be used to identify the group for message passing and data association. Player and group IDs assigned by DirectPlay will always be unique within the session. 

<P>Groups created with <B>CreateGroup</B> are top-level groups in the session. They are enumerated with <A HREF="dpbu0036.htm" TARGET="TEXT">IDirectPlay3::EnumGroups</A>. In contrast, the <A HREF="dpbu0028.htm" TARGET="TEXT">IDirectPlay3::CreateGroupInGroup</A> method creates a group that is a sub-group of a parent group.
<P>Groups can also be used by the application for general organization. In a lobby session, a staging area is used as the mechanism for collecting players for the purpose of starting a new application session using <A HREF="dpbu0067.htm" TARGET="TEXT">IDirectPlay3::StartSession</A>.
<P>The player that creates a group is the default owner of it. Only the owner can change group properties such as the name and remote data. If the owner leaves the session, ownership is transferred to the host of the session. 
<P>Any player in the session can change the membership of the group or delete the group. 
<P>Groups will persist in the session until they are explicitly destroyed.


<H5>See Also</H5>
<P><A HREF="dpbu0090.htm" TARGET="TEXT">DPNAME</A>, <A HREF="dpbu0097.htm" TARGET="TEXT">DPMSG_CREATEPLAYERORGROUP</A>, <A HREF="dpbu0032.htm" TARGET="TEXT">IDirectPlay3::DestroyGroup</A>, <A HREF="dpbu0036.htm" TARGET="TEXT">IDirectPlay3::EnumGroups</A>, <A HREF="dpbu0035.htm" TARGET="TEXT">IDirectPlay3::EnumGroupPlayers</A>, <A HREF="dpbu0059.htm" TARGET="TEXT">IDirectPlay3::Send</A>, <A HREF="dpbu0062.htm" TARGET="TEXT">IDirectPlay3::SetGroupData</A>, <A HREF="dpbu0063.htm" TARGET="TEXT">IDirectPlay3::SetGroupName</A>, <A HREF="dpbu0028.htm" TARGET="TEXT">IDirectPlay3::CreateGroupInGroup</A>, <A HREF="dpbu0043.htm" TARGET="TEXT">IDirectPlay3::GetGroupFlags</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
