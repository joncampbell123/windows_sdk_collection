<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectPlayLobby2::GetConnectionSettings</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dpbu0074.htm','/dpbu0000.htm','/dpbu0010.htm','/index.htm','/dpbu0076.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><HR COLOR="#0000FF"><A NAME="ref_0001010a04000700">IDirectPlayLobby2::GetConnectionSettings</A></H2>
<BR CLEAR=ALL>
<A HREF="dpbu0068.htm" TARGET="TEXT">IDirectPlayLobby2 Interface</A>
<P>Retrieves the <A HREF="dpbu0089.htm" TARGET="TEXT">DPLCONNECTION</A> structure that contains all the information needed to start and connect an application. The data returned is the same data that was passed to the <A HREF="dpbu0077.htm" TARGET="TEXT">IDirectPlayLobby2::RunApplication</A> method by the lobby client, or set by calling the <A HREF="dpbu0079.htm" TARGET="TEXT">IDirectPlayLobby2::SetConnectionSettings</A> method.

<P><B>HRESULT</B> <B>GetConnectionSettings</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwAppID</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpData</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDWORD</B> <I>lpdwDataSize</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>dwAppID</I>
</DT><DD>Identifies which application's connection settings to retrieve when called from a lobby client (that communicates with several applications). When called from an application (that only communicates with one lobby client), this parameter must be zero. This ID number is obtained from <A HREF="dpbu0077.htm" TARGET="TEXT">IDirectPlayLobby2::RunApplication</A>.
</DD><DT><I>lpData</I>
</DT><DD>Pointer to a buffer in which the connection settings are to be written. Set this parameter to NULL to request only the size of data. The <I>lpdwDataSize</I> parameter will be set to the minimum size required to hold the data.
</DD><DT><I>lpdwDataSize</I>
</DT><DD>Pointer to a variable that is initialized to the size of the buffer before calling this method. After the method returns, this parameter will be set to the size, in bytes, of the data. If the buffer was too small (DPERR_BUFFERTOOSMALL), then this parameter will be set to the minimum buffer size required.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise:
<DL>
<DT><A HREF="dpbu0120.htm#ref_0001010a0900000a" TARGET="TEXT">DPERR_BUFFERTOOSMALL</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000017" TARGET="TEXT">DPERR_GENERIC</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001b" TARGET="TEXT">DPERR_INVALIDINTERFACE</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001c" TARGET="TEXT">DPERR_INVALIDOBJECT</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900001d" TARGET="TEXT">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a09000029" TARGET="TEXT">DPERR_NOTLOBBIED</A>
</DT><DT><A HREF="dpbu0120.htm#ref_0001010a0900002b" TARGET="TEXT">DPERR_OUTOFMEMORY</A>
</DT></DL>

<H5>Remarks</H5>
<P>The <I>lpData</I> member should be cast to the <A HREF="dpbu0089.htm" TARGET="TEXT">DPLCONNECTION</A> structure when the function returns to read the data from it.

<H5>See Also</H5>
<P><A HREF="dpbu0089.htm" TARGET="TEXT">DPLCONNECTION</A>, <A HREF="dpbu0077.htm" TARGET="TEXT">IDirectPlayLobby2::RunApplication</A>, <A HREF="dpbu0079.htm" TARGET="TEXT">IDirectPlayLobby2::SetConnectionSettings</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
