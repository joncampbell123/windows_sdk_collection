<HTML> 
<HEAD>
<TITLE>DirectAnimation SDK, VBScript sample</TITLE>
<SCRIPT LANGUAGE="JScript">
<!--
if (window.top.frames.length!=0 && window.top.frames[0].ShowNoButtons!=null)
    window.top.frames[0].ShowNoButtons();
//-->
</SCRIPT>
</HEAD>	 

<BODY  BGCOLOR=WHITE TOPMARGIN=15 LEFTMARGIN=20 
  TEXT=RED>

<CENTER>
<STRONG>
<FONT SIZE=6 FACE=Tahoma>
Complex, animated graphics 
that use very little bandwidth.
</FONT>
</STRONG>      

<OBJECT ID="DAControl"
        STYLE="position:absolute; left:10%; top:10; width:500; height:400" 
        CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
</CENTER>


<script language="VBScript">
<!--     
            
Set m = DAControl.MeterLibrary 
Set ds = m.NewDrawingSurface() 

function Interpolate(From, ToVal, Duration) 
  Set i = m.Div(m.LocalTime, m.DANumber(Duration))
	diff = CDbl(ToVal - From)
  Set interv = m.DANumber(CDbl(diff))
  Set delta = m.Mul(interv, i)
  Set val = m.Add(m.DANumber(From), delta)
  Set Interpolate = val.Duration(Duration)
End Function      
    
ds.FillStyle (1)
ds.BorderStyle = m.DefaultLineStyle.Color(m.Black).Dash(m.DashStyleSolid)
ds.FillColor m.ColorRgb(1, 0, 0.5)
ds.FillPath m.Polyline(Array(-178, 402, -229, 332, -419, 523, -362, 591, -333, 535, -235, 492, -178, 402))
            
ds.FillColor m.ColorRgb(0, 0.5, 1)
ds.FillPath m.Polyline(Array(-456, 611, -444, 775, -403, 761, -380, 601, -456, 611))

ds.FillColor m.ColorRgb(0.5, 0, 1)
ds.FillPath m.Polyline(Array(-440, 792, -362, 818, -344, 843, -389, 857, -356, 937, -372, 964, -415, 896, -395, 990, -421, 1000, -440, 896, -448, 990, -481, 988, -466, 884, -497, 966, -518, 970, -481, 832, -440, 792))

ds.FillColor m.ColorRgb(0.1, 0.1, 0.1)
ds.FillPath m.Polyline(Array(-249, 123, -18, 91, -18, 50, -243, 37, -249, 123))

ds.FillColor m.ColorRgb(0, 0.5, 1)
ds.FillPath m.Polyline(Array(-268, 64, -296, -120, -116, -102, 31, -174, 9, 15, -268, 64))

ds.FillColor m.ColorRgb(1, 0.8, 0)
ds.FillPath m.Polyline(Array(-223, 441, -94, 447, 132, 345, 9, 74, -237, 148, -223, 441))

ds.FillColor m.ColorRgb(1, 0.5, 0)
ds.FillPath m.Polyline(Array(101, 337, 44, 279, 220, 80, 267, 144, 232, 173, 226, 271, 101, 337))

ds.FillColor m.ColorRgb(0.1, 0.1, 0.1)
ds.FillPath m.Polyline(Array(265, 35, 441, 48, 415, 93, 265, 119, 265, 35))

ds.FillColor m.ColorRgb(1, 0.5, 0)
ds.FillPath m.Polyline(Array(-182, -8, -167, -168, -561, -53, -594, -18, -581, 25, -526, 80, -182, -8))

ds.FillColor m.ColorRgb(1, 0, 0.5)
ds.FillPath m.Polyline(Array(27, -42, -102, -94, 31, -446, 66, -477, 132, -450, 148, -413, 27, -42))

ds.FillColor m.ColorRgb(0.1, 0.1, 0.1)
ds.FillPath m.Polyline(Array(-516, -42, -581, -94, -421, -305, -341, -297, -407, -198, -415, -131, -516, -42))

ds.FillColor m.ColorRgb(0.1, 0.1, 0.1)
ds.FillPath m.Polyline(Array(44, -512, 128, -520, 189, -774, 136, -838, 87, -711, 58, -684, 44, -512))

ds.FillColor m.ColorRgb(1, 0, 0.5)
ds.FillPath m.Polyline(Array(-403, -364, -423, -514, -391, -559, -302, -479, -309, -399, -292, -331, -354, -311, -403, -364))

ds.FillColor m.ColorRgb(0, 0.5, 1)
ds.FillPath m.Polyline(Array(200, -840, 366, -915, 386, -959, 273, -1000, 200, -956, 138, -961, 144, -879, 200, -840))

ds.FillColor m.ColorRgb(0.1, 0.1, 0.1)
ds.FillPath m.Polyline(Array(-7, 677, -102, 623, -112, 552, -87, 525, -89, 513, -93, 482, -102, 447, -114, 417, -102, 386, -87, 369, -67, 359, -46, 357, -28, 359, -12, 365, -1, 369, 3, 371, 3, 439, 42, 437, 66, 457, 83, 494, 107, 496, 113, 568, 124, 621, -7, 677))

ds.FillColor m.ColorRgb(0.5, 0, 1)
ds.FillPath m.Polyline(Array(-59, 607, -69, 591, -71, 597, -79, 609, -91, 621, -110, 626, -128, 626, -141, 625, -153, 625, -161, 632, -163, 646, -157, 660, -153, 671, -161, 679, -177, 685, -190, 689, -198, 691, -202, 693, -184, 724, -178, 722, -165, 720, -151, 714, -139, 705, -136, 695, -137, 683, -139, 671, -141, 662, -139, 654, -132, 650, -120, 648, -108, 646, -94, 642, -81, 636, -67, 623, -59, 607))

ds.FillColor m.ColorRgb(0.5, 0, 1)
ds.FillPath m.Polyline(Array(-26, 623, -40, 609, -40, 615, -44, 628, -53, 644, -71, 656, -91, 660, -106, 662, -118, 662, -126, 671, -126, 687, -118, 703, -116, 716, -122, 728, -137, 738, -151, 746, -159, 750, -163, 751, -132, 779, -126, 775, -114, 767, -100, 753, -93, 742, -89, 730, -89, 718, -91, 707, -94, 697, -94, 689, -87, 683, -77, 677, -63, 673, -50, 666, -38, 656, -28, 640, -26, 623))

ds.FillColor m.ColorRgb(0.5, 0, 1)
ds.FillPath m.Polyline(Array(11, 628, -12, 619, -11, 625, -9, 640, -12, 658, -26, 675, -46, 685, -63, 693, -73, 699, -77, 710, -71, 724, -61, 738, -55, 750, -61, 763, -75, 777, -85, 791, -93, 798, -94, 802, -46, 820, -42, 814, -34, 800, -24, 785, -18, 769, -16, 757, -18, 744, -22, 734, -30, 724, -34, 716, -30, 707, -20, 699, -9, 689, 3, 679, 13, 666, 17, 648, 11, 628))

ds.FillColor m.ColorRgb(0.5, 0, 1)
ds.FillPath m.Polyline(Array(48, 625, 23, 621, 27, 626, 34, 640, 40, 658, 34, 677, 21, 693, 7, 703, -1, 710, 1, 722, 13, 736, 27, 750, 36, 763, 36, 779, 31, 794, 25, 806, 23, 814, 21, 818, 70, 818, 72, 812, 77, 798, 81, 783, 81, 767, 77, 753, 72, 742, 62, 730, 52, 724, 44, 718, 44, 708, 48, 699, 56, 687, 64, 673, 66, 658, 62, 642, 48, 625))

ds.FillColor m.ColorRgb(0.5, 0, 1)
ds.FillPath m.Polyline(Array(81, 611, 56, 615, 62, 619, 77, 628, 89, 644, 93, 664, 85, 681, 77, 695, 73, 707, 81, 716, 97, 726, 111, 734, 120, 744, 126, 759, 126, 777, 126, 792, 124, 804, 124, 808, 179, 792, 179, 787, 181, 773, 179, 755, 171, 742, 159, 730, 148, 720, 136, 712, 122, 708, 114, 705, 113, 695, 114, 681, 118, 667, 118, 654, 114, 638, 103, 623, 81, 611))

ds.FillColor m.ColorRgb(0.5, 0, 1)
ds.FillPath m.Polyline(Array(-69, 582, -73, 564, -77, 568, -87, 578, -104, 585, -124, 587, -141, 582, -155, 576, -165, 572, -175, 578, -180, 589, -177, 603, -177, 615, -186, 621, -202, 621, -216, 625, -223, 626, -227, 626, -218, 660, -212, 660, -200, 658, -186, 654, -173, 650, -167, 640, -165, 630, -165, 619, -167, 609, -163, 603, -153, 601, -141, 601, -128, 603, -120, 605, -114, 605, -106, 603, -98, 601, -91, 599, -83, 595, -75, 589, -69, 582))

ds.FillColor m.ColorRgb(1, 0, 0.5)
ds.FillPath m.Polyline(Array(454, 97, 536, 144, 595, 76, 544, -14, 491, 11, 505, 33, 538, 41, 544, 64, 466, 35, 454, 97))

Set runner = ds.Image

Set R1StartPos = m.Point2(-1300, 0)
Set R1EndPos = m.Point2(1000, 0)
Set R2StartPos = m.Point2(1500, 0)
Set R2EndPos = m.Point2(-1000, 0)
Set R1Axis = m.Vector3(10, -2, 5)
Set R2Axis = m.Vector3(0, 5, 0)

Set factor = Interpolate(1.0, 0.2, 7)
    
Set ZoomOut = m.Sequence(m.IdentityTransform3.Duration(5), _
                        m.Scale3UniformAnim(factor).Duration(7)). _
                        ParallelTransform2
                        
Set Rot1 = m.Sequence(m.IdentityTransform3.Duration(2), _
                            m.Rotate3RateDegrees(R1Axis, -160).Duration(10)). _
                            ParallelTransform2         
Set Rot2 = m.Sequence(m.IdentityTransform3.Duration(3), _
                            m.Rotate3RateDegrees(R2Axis, 200).Duration(9)). _
                            ParallelTransform2

Set Trans1 = m.FollowPath(m.Line(R1StartPos, R1EndPos), 5)     
Set Trans2 = m.FollowPath(m.Line(R2StartPos, R2EndPos), 5)

'* a mirrored runner
Set Mirror = m.Scale2(-1, 1)
Set mRunner = runner.Transform(Mirror)

Set runner1 = runner.Transform(Rot1).Transform(ZoomOut).Transform(Trans1)
Set runner2 = mRunner.Transform(Rot2).Transform(ZoomOut).Transform(Trans2)

Set bothImgs = m.Overlay(runner2, runner1)
                                                
DAControl.Image = bothImgs.Transform(m.Scale2(1.0 / 720.0 / 39.37, 1.0 / 720.0 / 39.37))

DAControl.start              
                             
-->
</script>
</BODY>
</HTML>