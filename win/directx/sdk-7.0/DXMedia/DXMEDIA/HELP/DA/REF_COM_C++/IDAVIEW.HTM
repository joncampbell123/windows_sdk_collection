<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IDAView</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IDAView">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl(); initGloss()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDAView_Interface"></A>



<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="IDAView"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/hdrdanim.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectAnimation Animated Header --IDAView"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectAnimation SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->


<!-- NAV_LINKS_START -->


<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="COMref.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IDAUserData.htm">IDAUserData Interface</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IDAViewSite.htm">IDAViewSite Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->



<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->


<H1>IDAView Interface</H1>

<P>The <B>IDAView</B> interface handles tasks specific to a particular view.

<p>You can access the view through the  <A HREF="..\ref_script\class\DAViewerControlClass.htm#viewv_control">View</A> property in <B>DAViewerControl</B>.


<P>This interface inherits from <B>IDispatch</B>. Like pure COM interfaces, such as <B>IUnknown</B>, <B>IDispatch</B> exposes objects, methods, and properties to applications. Unlike <B>IUnknown</B>, <B>IDispatch</B> members are identified with human-readable names, not as vtable indexes. <B>IDispatch</B> interfaces don't perform as well as pure COM interfaces. 

<P CLASS="ref">IDAView Methods</P>
<BLOCKQUOTE><TABLE CLASS="ref">
<TR><TD><A HREF="IDAView.htm#AddBvrToRun">AddBvrToRun</A>
</TD><TD>Adds a behavior to the run list when the behavior is not part of the model or returned from the notifier.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#get_ClientSite">get_ClientSite</A>
</TD><TD>Retrieves the pointer to <B>IOleClientSite</B> interface of the view. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#get_CompositeDirectlyToTarget">get_CompositeDirectlyToTarget</A>
</TD><TD>Retrieves the flag specifying the composition mode: whether to compose to the back buffer or directly to the target device. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#get_DC">get_DC</A>
</TD><TD>Retrieves the handle of the device context (DC) in which the view will appear. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#get_IDirectDrawSurface">get_IDirectDrawSurface</A>
</TD><TD>Retrieves the <B>DirectDrawSurface</B> object in which the view will appear.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#get_Preferences">get_Preferences</A>
</TD><TD>Retrieves a pointer to the <B>DAPreferences</B> object for this view.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#get_SimulationTime">get_SimulationTime</A>
</TD><TD>Retrieves the current simulation (tick) time. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#get_Site">get_Site</A>
</TD><TD>Retrieves the pointer to the <B>IDAViewSite</B> interface of the view site for this view.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#get_Window">get_Window</A>
</TD><TD>Retrieves the handle of the window in which to display the view.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#OnFocus">OnFocus</A>
</TD><TD>Notifies the view that it has focus.

</TD></TR>
<TR><TD><A HREF="IDAView.htm#OnKey">OnKey</A>
</TD><TD>Notifies the view that the user pressed a keyboard key. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#OnMouseButton">OnMouseButton</A>
</TD><TD>Notifies the view that the user clicked a mouse button.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#OnMouseMove">OnMouseMove</A>
</TD><TD>Notifies the view that the mouse pointer has moved.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#PaletteChanged">PaletteChanged</A>
</TD><TD>Sets a flag to inform the video driver whether the palette has changed.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#put_ClientSite">put_ClientSite</A>
</TD><TD>Specifies the pointer to <B>IOleClientSite</B> interface of the view. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#put_CompositeDirectlyToTarget">put_CompositeDirectlyToTarget</A>
</TD><TD>Sets the flag specifying the composition mode: whether to compose to the back buffer or directly to the target device. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#put_DC">put_DC</A>
</TD><TD>Sets the handle of the device context (DC) in which the view will appear. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#put_IDirectDrawSurface">put_IDirectDrawSurface</A>
</TD><TD>Sets the <B>DirectDrawSurface</B> in which the view will appear. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#put_Site">put_Site</A>
</TD><TD>Specifies the pointer to the <B>IDAViewSite</B> interface of the view site for this view.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#put_Window">put_Window</A>
</TD><TD>Sets the handle of the window in which to display the view.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#QueryHitPoint">QueryHitPoint</A>
</TD><TD>Goes through the image or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#geometry')">geometry</A> objects in a view and retrieves the number hit.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#RemoveRunningBvr">RemoveRunningBvr</A>
</TD><TD>Removes a behavior previously added with <A HREF="IDAView.htm#AddBvrToRun">IDAView::AddBvrToRun</a> from the view.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#Render">Render</A>
</TD><TD>Renders the view.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#RePaint">RePaint</A>
</TD><TD>Repaints the specified rectangle of this view.  
</TD></TR>
<TR><TD><A HREF="IDAView.htm#SetClipRect">SetClipRect</A>
</TD><TD>Sets the clipping rectangle for this view.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#SetViewport">SetViewport</A>
</TD><TD>Sets the viewport for the view. A viewport is a rectangle in device space.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#StartModel">StartModel</A>
</TD><TD>Starts rendering the animation model with the specified image and <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#sound')">sound</A> at the specified base start time.
</TD></TR>
<TR><TD><A HREF="IDAView.htm#StopModel">StopModel</A>
</TD><TD>Stops rendering of the current animation model. 
</TD></TR>
<TR><TD><A HREF="IDAView.htm#Tick">Tick</A>
</TD><TD>Tells the animation what time it is so that the view can be updated accordingly.   
</TD></TR>

</TABLE></BLOCKQUOTE>


<H1><A NAME="AddBvrToRun" IDX_CONCEPT="noindex; IDAView::AddBvrToRun (Accessible only from COM); AddBvrToRun (IDAView)(Accessible only from COM)">IDAView::AddBvrToRun</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Adds a behavior to the run list when the behavior is not part of the model or returned from the notifier. When the system starts the model, the view or notifier will retrieve these additional behaviors and run them with the same start time as the behaviors included in the model.  
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>AddBvrToRun</B><B>(</B>&nbsp;<B>IDABehavior</B> <I>*bvr</I><B>,</B>&nbsp;<B>LONG</B> <I>*pId</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>bvr</I> 
 </DT><DD>[in] Pointer to the <A HREF="../ref_script/class/dabehaviorclass.htm">DABehavior</A> object to be added.
</DD><DT><I>pID</I>
 </DT><DD>[out] Pointer to an identifier for the added behavior. Use this identifier to remove the behavior from the view.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>You must use the <I>pID</I> identifier to remove the added behavior from the view by calling <A HREF="IDAView.htm#RemoveRunningBvr">IDAView::RemoveRunningBvr</a>. You cannot use the behavior itself as the identifier.
</BLOCKQUOTE>
 
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#RemoveRunningBvr">IDAView::RemoveRunningBvr</A>
</BLOCKQUOTE>

<H1><A NAME="get_ClientSite" IDX_CONCEPT="noindex; IDAView::get_ClientSite (Accessible only from COM); get_ClientSite (IDAView)(Accessible only from COM)">IDAView::get_ClientSite</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Retrieves a pointer to <B>IOleClientSite</B> interface of the view. When set, this interface enables imports from a relative file name by establishing an absolute URL base.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>get_ClientSite</B><B>(</B>&nbsp;<B>IOleClientSite</B> <I>*pClientSite</I>&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pClientSite</I>
 </DT><DD>[out] Pointer to the <B>IOleClientSite</B> interface of the view. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>The <B>IOleClientSite</B> interface is the primary means by which an embedded object obtains information about the location and extent of its display site, its moniker, its user interface, and other resources provided by its container.
</BLOCKQUOTE> 
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#put_ClientSite">IDAView::put_ClientSite</A>, <A HREF="IDAStatics.htm#get_clientsite">IDAStatics::get_ClientSite</A>
</BLOCKQUOTE>

<H1><A NAME="get_CompositeDirectlyToTarget" IDX_CONCEPT="noindex; IDAView::get_CompositeDirectlyToTarget (Accessible only from COM); get_CompositeDirectlyToTarget (IDAView)(Accessible only from COM)">IDAView::get_CompositeDirectlyToTarget</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Retrieves the flag specifying the composition mode: whether to compose to the back buffer or directly to the target device. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>get_CompositeDirectlyToTarget</B><B>(</B>
<B>VARIANT_BOOL</B> <I>*composeToTarget</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>composeToTarget</I>
 </DT><DD>[out] Pointer to the flag specifying the composition mode. If True, the view is composed directly to the target device. If False, the view is composed to the back buffer. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>The back buffer is a nonvisible surface that images can be drawn to while the primary surface displays the currently visible image.  
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#put_CompositeDirectlyToTarget">IDAView::put_CompositeDirectlyToTarget</A>
</BLOCKQUOTE>


<H1><A NAME="get_DC" IDX_CONCEPT="noindex; IDAView::get_DC (Accessible only from COM); get_DC (IDAView)(Accessible only from COM)">IDAView::get_DC</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Retrieves the handle of the device context (DC) in which the view will be displayed. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>get_DC</B><B>(</B>&nbsp;<B>HDC</B> <I>*dc</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>dc</I>
 </DT><DD>[out] Pointer to the handle of the device context (DC).
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>The DC refers to a physical output device, its name, device driver, and other attributes. Methods contain a handle to a DC to include the attributes of the specified device. There are four types of DC: display (supports drawing operations on a video display terminal), printer (supports drawing operations on a printer or plotter), memory (supports drawing operations on a bitmap), and information (supports retrieval of device data). 
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#put_DC">IDAView::put_DC</A>
</BLOCKQUOTE>



<H1><A NAME="get_IDirectDrawSurface" IDX_CONCEPT="noindex; IDAView::get_IDirectDrawSurface (Accessible only from COM); get_IDirectDrawSurface (IDAView)(Accessible only from COM)">IDAView::get_IDirectDrawSurface</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Retrieves the <B>DirectDrawSurface</B> in which the view will appear. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>get_IDirectDrawSurface</B><B>(</B>&nbsp;<B>IUnknown</B> <I>**ddsurf</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>ddsurf</I>
 </DT><DD>[out] Address of a pointer to the <B>IUnknown</B> of the <B>DirectDrawSurface</B> object.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#put_IDirectDrawSurface">IDAView::put_IDirectDrawSurface</A>
</BLOCKQUOTE>

<H1><A NAME="get_Preferences" IDX_CONCEPT="noindex; IDAView::get_Preferences (Accessible only from COM); get_Preferences (IDAView)(Accessible only from COM)">IDAView::get_Preferences</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Retrieves a pointer to <A HREF="../ref_script/class/DAPreferencesClass.htm">DAPreferences</A> object for this view. You can use the <B>DAPreferences</B> object to provide explicit rendering and viewing preference settings to DirectAnimation, such as the fill mode or the maximum frames per second.

 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>get_Preferences</B><B>(</B>&nbsp;<B>IDAPreferences</B> <I>**prefs</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>prefs</I>
 </DT><DD>[out] Address of a pointer to the <B>IDAPreferences</B> interface for this view. 
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="../ref_script/class/DAPreferencesClass.htm#PutPreferencev_pref">PutPreference</A>, <A HREF="../ref_script/class/DAPreferencesClass.htm#GetPreferencev_pref">GetPreference</A>, <A HREF="../ref_script/class/DAPreferencesClass.htm#Propagatev_pref">Propagate</A>
</BLOCKQUOTE>


<H1><A NAME="get_SimulationTime" IDX_CONCEPT="noindex; IDAView::get_SimulationTime (Accessible only from COM); get_SimulationTime (IDAView)(Accessible only from COM)">IDAView::get_SimulationTime</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Retrieves the current simulation time. The simulation time (in seconds) sets the time for subsequent rendering. It is reported to the view every time <A HREF="IDAView.htm#Tick">Tick</A> is called so that the view can be updated accordingly. The actual elapsed time in the animation is the start time, set with <A HREF="IDAView.htm#StartModel">StartModel</A>, minus the simulation time.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>get_SimulationTime</B><B>(</B>&nbsp;<B>double</B> <I>*simTime</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>simTime</I>
 </DT><DD>[in] Pointer to the currently set simulation time.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#Tick">IDAView::Tick</A>, <A HREF="IDAView.htm#StartModel">IDAView::StartModel</A>
</BLOCKQUOTE>

<H1><A NAME="get_Site" IDX_CONCEPT="noindex; IDAView::get_Site (Accessible only from COM); get_Site (IDAView)(Accessible only from COM)">IDAView::get_Site</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Retrieves a pointer to <B>IDAViewSite</B> interface of the view site for this view. When you create a view, you should also create a view site. DirectAnimation sends status information about the view to the view site. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>get_Site</B><B>(</B>&nbsp;<B>IDAViewSite</B> <I>**pViewSite</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pViewSite</I>
 </DT><DD>[out] Address of a pointer to the <B>IDAViewSite</B> interface of the view site for this view. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#put_Site">IDAView::put_Site</A>
</BLOCKQUOTE>

<H1><A NAME="get_Window" IDX_CONCEPT="noindex; IDAView::get_Window (Accessible only from COM); get_Window (IDAView)(Accessible only from COM)">IDAView::get_Window</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Retrieves the handle of the window in which the view will appear. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>get_Window</B><B>(</B>&nbsp;<B>HWND</B> <I>*hwnd</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>hwnd</I>
 </DT><DD>[out] Pointer to the handle of the window in which the view will appear.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#put_Window">IDAView::put_Window</A>
</BLOCKQUOTE>

<H1><A NAME="OnFocus" IDX_CONCEPT="noindex; IDAView::OnFocus (Accessible only from COM); OnFocus (IDAView)(Accessible only from COM)">IDAView::OnFocus</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Notifies the view that it has Windows&reg; focus. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>OnFocus</B><B>(</B>&nbsp;<B>VARIANT_BOOL</B> <I>bHasFocus</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>bHasFocus</I>
 </DT><DD>[in] Flag that indicates whether the view has Windows&reg; focus. True if the view has the Windows&reg; focus. False if the view does not have focus.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>In the Microsoft&reg; Windows&reg; environment, only one object can receive mouse clicks or keyboard input at any one time, and this object has the focus. The user or the application can set focus.
<P>For an example of this method, see ctlhost.cpp in the Samples\Multimedia\DAnim\C++\Showcase\DragGeoCntrl directory.
</BLOCKQUOTE>



<H1><A NAME="OnKey" IDX_CONCEPT="noindex; IDAView::OnKey (Accessible only from COM); OnKey (IDAView)(Accessible only from COM)">IDAView::OnKey</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Notifies the view that the user pressed a keyboard key. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>OnKey</B><B>(</B>&nbsp;<B>double</B> <I>when</I><B>,</B>&nbsp;<B>LONG</B> <I>key</I><B>,</B>&nbsp;<B>VARIANT_BOOL</B> <I>bPressed</I><B>,</B>
<B>BYTE</B> <I>modifiers</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>when</I>
 </DT><DD>[in] Time the key was pressed. The time is relative to the simulation time set with <A HREF="IDAView.htm#Tick">Tick</A>. 
</DD><DT><I>key</I>
 </DT><DD>[in] Identifies the key pressed. Can be one or more of the following values.
 <TABLE>
 <TR><TD>DAKEY_END</TD><TD>DAKEY_HOME</TD><TD>DAKEY_LEFT</TD></TR>
 <TR><TD>DAKEY_UP</TD><TD>DAKEY_RIGHT</TD><TD>DAKEY_DOWN</TD></TR>
 <TR><TD>DAKEY_INSERT</TD><TD>DAKEY_DELETE</TD><TD>DAKEY_NUMPAD0</TD></TR>
 <TR><TD>DAKEY_NUMPAD1</TD><TD>DAKEY_NUMPAD2</TD><TD>DAKEY_NUMPAD3</TD></TR>
 <TR><TD>DAKEY_NUMPAD4</TD><TD>DAKEY_NUMPAD5</TD><TD>DAKEY_NUMPAD6</TD></TR>
 <TR><TD>DAKEY_NUMPAD7</TD><TD>DAKEY_NUMPAD8</TD><TD>DAKEY_NUMPAD9</TD></TR>
 <TR><TD>DAKEY_MULTIPLY</TD><TD>DAKEY_ATD</TD><TD>DAKEY_SEPARATOR</TD></TR>
 <TR><TD>DAKEY_SUBTRACT </TD><TD>DAKEY_DECIMAL</TD><TD>DAKEY_DIVIDE</TD></TR>
 <TR><TD>DAKEY_F1</TD><TD>DAKEY_F2</TD><TD>DAKEY_F3</TD></TR>
 <TR><TD>DAKEY_F4</TD><TD>DAKEY_F5</TD><TD>DAKEY_F6</TD></TR>
 <TR><TD>DAKEY_F7</TD><TD>DAKEY_F8</TD><TD>DAKEY_F9</TD></TR>
 <TR><TD>DAKEY_F10</TD><TD>DAKEY_F11</TD><TD>DAKEY_F12</TD></TR>
 <TR><TD>DAKEY_F13</TD><TD>DAKEY_F14</TD><TD>DAKEY_F15</TD></TR>
 <TR><TD>DAKEY_F16</TD><TD>DAKEY_F17</TD><TD>DAKEY_F18</TD></TR>
 <TR><TD>DAKEY_F19</TD><TD>DAKEY_F20</TD><TD>DAKEY_F21</TD></TR>
 <TR><TD>DAKEY_F22</TD><TD>DAKEY_F23</TD><TD>DAKEY_F24</TD></TR>
 <TR><TD>DAKEY_PGUP</TD><TD>DAKEY_PGDN</TD><TD></TD></TR>
</TABLE>
</DD><DT><I>bPressed</I>
 </DT><DD>[in] Flag that indicates whether the key is pressed (down). True if the key is pressed (down). False if the key is not pressed (up).
</DD><DT><I>modifiers</I>
 </DT><DD>[in] Identifies other keyboard keys pressed, which can modify the meaning of the key being pressed. Can be one or more of the following values.
<TABLE>
<TR><TH>Flag</TH><TH>Description</TH><TH>Value</TH></TR>
<TR><TD>DAEMOD_SHIFT_MASK</TD><TD>the SHIFT key</TD><TD>0x01 </TD></TR>
<TR><TD>DAEMOD_CTRL_MASK</TD><TD>the CTRL key</TD><TD>0x02 </TD></TR>
<TR><TD>DAEMOD_ALT_MASK</TD><TD>the ALT key</TD><TD>0x04</TD></TR>
<TR><TD>DAEMOD_META_MASK</TD><TD>the META key</TD><TD>0x08</TD></TR>
</TABLE>

</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For an example of this method, see ctlhost.cpp in the Samples\Multimedia\DAnim\C++\Showcase\DragGeoCntrl directory.
</BLOCKQUOTE>



<H1><A NAME="OnMouseButton" IDX_CONCEPT="noindex; IDAView::OnMouseButton (Accessible only from COM); OnMouseButton (IDAView)(Accessible only from COM)">IDAView::OnMouseButton</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Notifies the view that the user clicked a mouse button. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax">
<B>HRESULT</B> <B>OnMouseButton</B><B>(</B>
    <B>double</B> <I>when</I><B>,</B>
    <B>LONG</B> <I>xPos</I><B>,</B>
    <B>LONG</B> <I>yPos</I><B>,</B>
    <B>BYTE</B> <I>button</I><B>,</B>
    <B>VARIANT_BOOL</B> <I>bPressed</I><B>,</B>
    <B>BYTE</B> <I>modifiers</I>
<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>when</I>
 </DT><DD>[in] Time the mouse button event occurred. The time is relative to the simulation time set with <A HREF="IDAView.htm#Tick">Tick</A>. 
</DD><DT><I>xPos</I>, <I>yPos</I>
 </DT><DD>[in] Mouse pointer position. 
</DD><DT><I>button</I>
 </DT><DD>[in] Identifies the mouse button clicked. Can be one or more of the following values.
<DD>DA_MOUSE_BUTTON_LEFT - 0</DD>
<DD>DA_MOUSE_BUTTON_RIGHT - 1</DD>
<DD>DA_MOUSE_BUTTON_MIDDLE -2</DD>
</DD><DT><I>bPressed</I>
 </DT><DD>[in] Flag that indicates whether the mouse button is clicked (down). True if the button is pressed (down). False if the button is not pressed (up).
</DD><DT><I>modifiers</I>
 </DT><DD>[in] Identifies keyboard keys pressed, which can modify the meaning of the mouse button being pressed. Can be one or more of the following values.
<TABLE>
<TR><TH>Flag</TH><TH>Description</TH><TH>Value</TH></TR>
<TR><TD>DAEMOD_SHIFT_MASK</TD><TD>the SHIFT key</TD><TD>0x01 </TD></TR>
<TR><TD>DAEMOD_CTRL_MASK</TD><TD>the CTRL key</TD><TD>0x02 </TD></TR>
<TR><TD>DAEMOD_ALT_MASK</TD><TD>the ALT key</TD><TD>0x04</TD></TR>
<TR><TD>DAEMOD_META_MASK</TD><TD>the META key</TD><TD>0x08</TD></TR>
</TABLE>
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 



<H1><A NAME="OnMouseMove" IDX_CONCEPT="noindex; IDAView::OnMouseMove (Accessible only from COM); OnMouseMove (IDAView)(Accessible only from COM)">IDAView::OnMouseMove</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Notifies the view that the mouse pointer has moved. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>OnMouseMove</B><B>(</B>&nbsp;<B>double</B> <I>when</I><B>,</B>&nbsp;<B>LONG</B> <I>xPos</I><B>,</B>&nbsp;<B>LONG</B> <I>yPos</I><B>,</B>
<B>BYTE</B> <I>modifiers</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>when</I>
 </DT><DD>[in] Time the mouse pointer move occurred. The time is relative to the simulation time set with <A HREF="IDAView.htm#Tick">Tick</A>. 
</DD><DT><I>xPos</I>, <I>yPos</I>
 </DT><DD>[in] Mouse pointer position. 
</DD><DT><I>modifiers</I>
 </DT><DD>[in] Identifies keyboard keys pressed, which can modify the meaning of the mouse movement. Can be one or more of the following values.
<TABLE>
<TR><TH>Flag</TH><TH>Description</TH><TH>Value</TH></TR>
<TR><TD>DAEMOD_SHIFT_MASK</TD><TD>the SHIFT key</TD><TD>0x01 </TD></TR>
<TR><TD>DAEMOD_CTRL_MASK</TD><TD>the CTRL key</TD><TD>0x02 </TD></TR>
<TR><TD>DAEMOD_ALT_MASK</TD><TD>the ALT key</TD><TD>0x04</TD></TR>
<TR><TD>DAEMOD_META_MASK</TD><TD>the META key</TD><TD>0x08</TD></TR>
</TABLE>
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 

<H1><A NAME="PaletteChanged" IDX_CONCEPT="noindex; IDAView::PaletteChanged (Accessible only from COM); PaletteChanged (IDAView)(Accessible only from COM)">IDAView::PaletteChanged</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Sets a flag to inform the video driver whether the palette has changed.  
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>PaletteChanged</B><B>(</B>&nbsp;<B>VARIANT_BOOL</B> <I>bNew</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>bnew</I>
 </DT><DD>[in] Flag indicating whether the palette has changed. If True, the palette has changed. If False, the palette has not changed. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE>

<H1><A NAME="put_ClientSite" IDX_CONCEPT="noindex; IDAView::put_ClientSite (Accessible only from COM); put_ClientSite (IDAView)(Accessible only from COM)">IDAView::put_ClientSite</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Specifies the pointer to the <B>IOleClientSite</B> interface of the view. When set, this interface enables imports from a relative file name by establishing an absolute URL base.

 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>put_ClientSite</B><B>(</B>&nbsp;<B>IOleClientSite</B> <I>*pClientSite</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pClientSite</I>
 </DT><DD>[in] Pointer to the <B>IOleClientSite</B> interface of the view. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>The <B>IOleClientSite</B> interface is the primary means by which an embedded object obtains information about the location and extent of its display site, its moniker, its user interface, and other resources provided by its container.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#get_ClientSite">IDAView::get_ClientSite</A>, <A HREF="IDAStatics.htm#put_clientsite">IDAStatics::put_ClientSite</A> 
</BLOCKQUOTE>




<H1><A NAME="put_CompositeDirectlyToTarget" IDX_CONCEPT="noindex; IDAView::put_CompositeDirectlyToTarget (Accessible only from COM); put_CompositeDirectlyToTarget (IDAView)(Accessible only from COM)">IDAView::put_CompositeDirectlyToTarget</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Sets the flag specifying the composition mode: whether to compose to the back buffer or directly to the target device. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>put_CompositeDirectlyToTarget</B><B>(</B>
<B>VARIANT_BOOL</B> <I>composeToTarget</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>composeToTarget</I>
 </DT><DD>[in] Flag specifying the composition mode. If True, the view is composed directly to the target device. If False, the view is composed to the back buffer. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For an example of this method, see the dxa.cpp file in the Samples\Multimedia\DAnim\C++\Showcase\Movie directory.</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#get_CompositeDirectlyToTarget">IDAView::get_CompositeDirectlyToTarget</A>
</BLOCKQUOTE>

<H1><A NAME="put_DC" IDX_CONCEPT="noindex; IDAView::put_DC (Accessible only from COM); put_DC (IDAView)(Accessible only from COM)">IDAView::put_DC</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Sets the handle of the device context (DC) in which the view will appear. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>get_DC</B><B>(</B>&nbsp;<B>HDC</B> <I>dc</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>dc</I>
 </DT><DD>[out] Handle of the DC.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#get_DC">IDAView::get_DC</A>
</BLOCKQUOTE>



<H1><A NAME="put_IDirectDrawSurface" IDX_CONCEPT="noindex; IDAView::put_IDirectDrawSurface (Accessible only from COM); put_IDirectDrawSurface (IDAView)(Accessible only from COM)">IDAView::put_IDirectDrawSurface</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Sets the <B>DirectDrawSurface</B> in which the view will appear. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>put_IDirectDrawSurface</B><B>(</B>&nbsp;<B>IUnknown</B> <I>*ddsurf</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>ddsurf</I>
 </DT><DD>[in] Pointer to the <B>IUnknown</B> interface of the <B>DirectDrawSurface</B> object.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For an example of this method, see the dxa.cpp file in the Samples\Multimedia\DAnim\C++\Showcase\Movie directory.</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#get_IDirectDrawSurface">IDAView::get_IDirectDrawSurface</A>
</BLOCKQUOTE>

<H1><A NAME="put_Site" IDX_CONCEPT="noindex; IDAView::put_Site (Accessible only from COM); put_Site (IDAView)(Accessible only from COM)">IDAView::put_Site</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Specifies the pointer to the <B>IDAViewSite</B> interface of the view site for this view. When you create a view, you should also create a view site. DirectAnimation sends status information about the view to the view site. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>put_Site</B><B>(</B>&nbsp;<B>IDAViewSite</B> <I>*pViewSite</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pViewSite</I>
 </DT><DD>[in] Pointer to the <B>IDAViewSite</B> interface of the view site for this view. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#get_Site">IDAView::get_Site</A>
</BLOCKQUOTE>


<H1><A NAME="put_Window" IDX_CONCEPT="noindex; IDAView::put_Window (Accessible only from COM); put_Window (IDAView)(Accessible only from COM)">IDAView::put_Window</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Sets the handle of the window in which to display the view. 
 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>put_Window</B><B>(</B>&nbsp;<B>HWND</B> <I>*hwnd</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>hwnd</I>
 </DT><DD>[in] Handle of the window in which to display the view.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#get_Window">IDAView::get_Window</A>
</BLOCKQUOTE>



<H1><A NAME="QueryHitPoint" IDX_CONCEPT="noindex;IDAView::QueryHitPoint (Accessible only from COM); QueryHitPoint(IDAView)(Accessible only from COM)">IDAView::QueryHitPoint</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Goes through the image or geometry objects in a view and retrieves the number hit. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE CLASS="syntax">
<B>HRESULT</B> <B>QueryHitPoint</B><B>(</B>
    <B>DWORD</B> <I>dwAspect</I><B>,</B>
    <B>LPCRECT</B> <I>prcBounds</I><B>,</B>
    <B>POINT</B> <I>ptLoc</I><B>,</B>
    <B>LONG</B> <I>lCloseHint</I><B>,</B>
    <B>DWORD</B><I>*pHitResult</I>
<B>)</B><B>;</B>
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwAspect</I></DT>
<DD>[in] Flag that specifies how the object will be represented. This parameter contains only one value taken from the enumeration <B>DVASPECT</B> or <B>DVASPECT2</B>. See <B>Remarks</B>.
</DD>
<DT><I>prcBounds</I></DT>
<DD>[in] Pointer to a <B>RECT</B> structure specifying the bounding rectangle of the view to be checked.</DD>
<DT><I>ptLoc</I></DT>
<DD>[in] Point in device x- and y-coordinates to test for a hit.</DD>
<DT><I>lCloseHint</I></DT>
<DD>[in] Distance that defines "close" to the point checked for a hit.</DD>
<DT><I>pHitResult</I></DT>
<DD>[out] Pointer to the result of the hit query. Can be one of the following values.
<DL>
<DT>HITRESULT_OUTSIDE</DT>
<DD><I>ptLoc</I> is outside the bounds of <I>prcBounds</I> and not close to an object in the view.</DD>
<DT>HITRESULT_TRANSPARENT</DT>
<DD><I>ptLoc</I> is within the bounds of <I>prcBounds</I>, but not close to an object in the view. For example, a point in the middle of a doughnut could be HITRESULT_TRANSPARENT.</DD>
<DT>HITRESULT_CLOSE</DT>
<DD><I>ptLoc</I> is inside or outside the bounds of <I>prcBounds</I>, but close enough to an image or geometry object in the view to be considered "close" as defined by <I>lCloseHint</I>. Even if a point is outside the bounding rectangle of the view, it can still be close (this is needed for hitting small objects).</DD>
<DT>HITRESULT_HIT</DT>
<DD><I>ptLoc</I> is within the bounds of <I>prcBounds</I> and within an image or geometry in the view.</DD>
</DL>

	
</DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE>
 
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The <A HREF="IDA2View.htm#QueryHitPointEx">IDA2View::QueryHitPointEx</A> method returns identifiers of the geometry or images hit, and also coordinates describing where they were hit.
<p>The DVASPECT enumeration values specify the desired data or view aspect of the object when drawing or getting data.
<PRE>
typedef enum tagDVASPECT 
{ 
    DVASPECT_CONTENT    = 1, 
    DVASPECT_THUMBNAIL  = 2, 
    DVASPECT_ICON       = 4, 
    DVASPECT_DOCPRINT   = 8 
} DVASPECT; 
</PRE>
<p>The DVASPECT2 enumeration value is used to specify new drawing aspects used to optimize the drawing process.
<PRE>
typedef enum tagDVASPECT2 
{ 
    DVASPECT_OPAQUE         = 16, 
    DVASPECT_TRANSPARENT    = 32 
} DVASPECT2;
</PRE> 


</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDA2View.htm#QueryHitPointEx">IDA2View::QueryHitPointEx</A>
</BLOCKQUOTE>


<H1><A NAME="RemoveRunningBvr" IDX_CONCEPT="noindex; IDAView::RemoveRunningBvr(Accessible only from COM);RemoveRunningBvr (IDAView)(Accessible only from COM)">IDAView::RemoveRunningBvr</A></H1><HR size=1>
<A HREF="IDAView.htm">IDAView</A>
<P>Removes a behavior previously added with <A HREF="IDAView.htm#AddBvrToRun">IDAView::AddBvrToRun</a> from the view.

 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>RemoveRunningBvr</B><B>(</B>&nbsp;<B>LONG</B> <I>Id</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>Id</I>
 </DT><DD>[in] Identifier of the behavior to remove. This identifier is returned when the behavior is added with <A HREF="IDAView.htm#AddBvrToRun">IDAView::AddBvrToRun</a>.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#AddBvrToRun">IDAView::AddBvrToRun</A>
</BLOCKQUOTE>


<H1><A NAME="Render" IDX_CONCEPT="noindex; IDAView::Render (Accessible only from COM); Render (IDAView)(Accessible only from COM)">IDAView::Render</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Renders the view. You can use this method to force a refresh whether the view has changed or not. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>StopModel</B><B>(</B>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For examples of this method, see the following files:
<UL>
<LI>Samples\Multimedia\DAnim\C++\Showcase\Donut\donut.cpp.
<LI>Samples\Multimedia\DAnim\C++\Showcase\Donut\dxa.cpp.
</UL></BLOCKQUOTE>



<H1><A NAME="RePaint" IDX_CONCEPT="noindex; IDAView::RePaint (Accessible only from COM); RePaint (IDAView)(Accessible only from COM)">IDAView::RePaint</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Repaints the specified rectangle of this view.  

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>RePaint</B><B>(</B>&nbsp;<B>LONG</B> <I>xPos</I><B>,</B>&nbsp;<B>LONG</B> <I>yPos</I><B>,</B>&nbsp;<B>LONG</B> <I>w</I><B>,</B>&nbsp;<B>LONG</B> <I>h</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>xPos</I>, <I>yPos</I>
 </DT><DD>[in] Coordinates of the top-left corner of the rectangle to repaint. 
</DD><DT><I>w</I>, <I>h</I>
 </DT><DD>[in] Width and height, in pixels, of the rectangle to repaint.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 



<H1><A NAME="SetClipRect" IDX_CONCEPT="noindex; IDAView::SetClipRect (Accessible only from COM); SetClipRect (IDAView)(Accessible only from COM)">IDAView::SetClipRect</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Sets the clipping rectangle for this view. Graphics operations performed on this view will have no effect outside the clipping area. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>SetClipRect</B><B>(</B>&nbsp;<B>LONG</B> <I>xPos</I><B>,</B>&nbsp;<B>LONG</B> <I>yPos</I><B>,</B>&nbsp;<B>LONG</B> <I>w</I><B>,</B>&nbsp;<B>LONG</B> <I>h</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>xPos</I>, <I>yPos</I>
 </DT><DD>[in] Coordinates of the top-left corner of the clipping rectangle. 
</DD><DT><I>w</I>, <I>h</I>
 </DT><DD>[in] Width and height, in pixels, of the clipping rectangle.  
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 


<H1><A NAME="SetViewport" IDX_CONCEPT="noindex; IDAView::SetViewport (Accessible only from COM); SetViewport (IDAView)(Accessible only from COM)">IDAView::SetViewport</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Sets the viewport for the view. The viewport is a rectangle in device space. Viewport extents are measured in pixels for a video display. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>SetViewport</B><B>(</B>&nbsp;<B>LONG</B> <I>xPos</I><B>,</B>&nbsp;<B>LONG</B> <I>yPos</I><B>,</B>&nbsp;<B>LONG</B> <I>w</I><B>,</B>&nbsp;<B>LONG</B> <I>h</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>xPos</I>, <I>yPos</I>
 </DT><DD>[in] Coordinates of the top-left corner of the viewport. 
</DD><DT><I>w</I>, <I>h</I>
 </DT><DD>[in] Width and height, in pixels, of the viewport.  
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>A viewport is a rectangle in device space, such as on a video display.
<p>For examples of this method, see the following files:
<UL><LI>Samples\Multimedia\DAnim\C++\Showcase\Donut\dxa.cpp.
<LI>Samples\Multimedia\DAnim\C++\Showcase\Union\dxa.cpp.
</UL></BLOCKQUOTE>

<H1><A NAME="StartModel" IDX_CONCEPT="noindex; IDAView::StartModel (Accessible only from COM); StartModel (IDAView)(Accessible only from COM)">IDAView::StartModel</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Starts rendering the animation model with the specified image and sound at the specified base start time. If all synchronous imports are not loaded, rendering will be blocked until they are loaded.
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>StartModel</B><B>(</B>&nbsp;<B>IDAImage</B> <I>*pImage</I><B>,</B>&nbsp;<B>IDASound</B> <I>*pSound</I><B>,</B>
<B>double</B> <I>startTime</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pImage</I> 
 </DT><DD>[in] Pointer to the image to be rendered. 
</DD><DT><I>pSound</I>
 </DT><DD>[in] Pointer to the sound to be rendered.  
</DD><DT><I>startTime</I>
 </DT><DD>[in] Base time at which to start the clock for this model. Ticks will be relative to this time. Elapsed time is tick time minus <I>startTime</I>. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>You can use the <I>startTime</I> to synchronize with other models. For example, if another model starts at time 0 and something occurs in that model at time 1000 that you want to synchronize with, set <I>startTime</I> to 1000.

<p>If you do not want rendering to be blocked by synchronous imports that are not loaded, you should use <A HREF="IDA2View.htm#StartModelEx">IDA2View::StartModelEx</A>. If you set its flag to DAAsyncFlag and all synchronous imports are not loaded, <B>StartModelEx</B> returns E_PENDING but starts rendering the model.  

<P>For examples of this method, see the following files:
<UL><LI>Samples\Multimedia\DAnim\C++\Showcase\Donut\dxa.cpp.
<LI>Samples\Multimedia\DAnim\C++\Showcase\Movie\dxa.cpp.
<LI>Samples\Multimedia\DAnim\C++\Showcase\Union\dxa.cpp.
</UL></BLOCKQUOTE>


<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#StopModel">IDAView::StopModel</A>
</BLOCKQUOTE>



<H1><A NAME="StopModel" IDX_CONCEPT="noindex; IDAView::StopModel (Accessible only from COM); StopModel (IDAView)(Accessible only from COM)">IDAView::StopModel</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Stops rendering of the current animation model. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>StopModel</B><B>(</B>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.
</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For an example of this method, see the dxa.cpp file in the Samples\Multimedia\DAnim\C++\Showcase\Movie directory.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#StartModel">IDAView::StartModel</A>
</BLOCKQUOTE>

<H1><A NAME="Tick" IDX_CONCEPT="noindex; IDAView::Tick (Accessible only from COM); Tick (IDAView)(Accessible only from COM)">IDAView::Tick</A></H1><HR size="1">
<A HREF="IDAView.htm">IDAView</A>
<P>Tells the animation what time it is so that the view can be updated accordingly. Typically, you call <A HREF="IDAView.htm#StartModel">StartModelEx</A> once per view, and then call <B>Tick</B> with every new frame, to change the scene according to the simulation time (in seconds) specified. The actual elapsed time in the animation is the start time, set with <A HREF="IDAView.htm#StartModel">StartModel</A>, minus the simulation time.

 <P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>Tick</B><B>(</B>&nbsp;<B>double</B> <I>simTime</I><B>,</B>&nbsp;<B>boolean</B> <I>needToRender</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>simTime</I>
 </DT><DD>[in] Simulation time to set.
</DD><DT><I>needToRender</I>
 </DT><DD>[out] Value that indicates whether the scene at the new simulation time has been updated, and the view needs to be rendered again. If True, the view needs to be rendered. If False, the view does not need to be rendered.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For examples of this method, see the following files:
<UL><LI>Samples\Multimedia\DAnim\C++\Showcase\Movie\dxa.cpp.
<LI>Samples\Multimedia\DAnim\C++\Showcase\Donut\donut.cpp.
<LI>Samples\Multimedia\DAnim\C++\Showcase\Union\dxa.cpp.
</UL></BLOCKQUOTE>



<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="IDAView.htm#get_SimulationTime">IDAView::get_SimulationTime</A>
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size="1"></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
</BODY>
</HTML>
