<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IDA2View</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IDA2View">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl(); initGloss()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDA2View_Interface"></A>



<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="IDA2View"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/hdrdanim.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectAnimation Animated Header --IDA2View"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectAnimation SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->


<!-- NAV_LINKS_START -->


<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="COMref.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IDA2Statics.htm">IDA2Statics Interface</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IDABvrHook.htm">IDABvrHook Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->



<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->

<H1>IDA2View Interface</H1>

<P>The <B>IDA2View</B> interface is the COM interface that defines <B>DAView</B> objects. This interface can access all the methods in the <A HREF="idaview.htm">IDAView</A> interface and define additional methods. You can't access the methods in this interface from script; you must access them through the COM interface, typically using C++.  

<P>This interface inherits from <B>IDAView</B>, which in turn inherits from <B>IDispatch</B>.
<P CLASS="ref">IDA2View Methods</P>
<BLOCKQUOTE><TABLE CLASS="ref">
<TR><TD><A HREF="IDA2View.htm#GetDDD3DRM">GetDDD3DRM</A>
</TD><TD>Retrieves the <B>IDirectDraw</B> and <B>IDirect3DRM</B> interfaces used by the view. 
</TD></TR>
<TR><TD><A HREF="IDA2View.htm#GetInvalidatedRects">GetInvalidatedRects</A>
</TD><TD>Gets the RECT regions of the view that have changed. 
</TD></TR>
<TR><TD><A HREF="IDA2View.htm#GetRMDevice">GetRMDevice</A>
</TD><TD>Retrieves the <B>IDirect3DRMDevice</B> interface of the underlying Microsoft&reg; Direct3D&reg; Retained Mode device, and a version so you can tell if it has changed.   
</TD></TR><TR><TD><A HREF="IDA2View.htm#QueryHitPointEx">QueryHitPointEx</A>
</TD><TD>Goes through the image or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#geometry')">geometry</A> objects in a scene and retrieves the number hit, which were hit, and where they were hit. 
</TD></TR>
<TR><TD><A HREF="IDA2View.htm#StartModelEx">StartModelEx</A>
</TD><TD>Starts the animation model with the specified image and <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#sound')">sound</A> at the specified base start time. 
</TD></TR>
</TABLE></BLOCKQUOTE>


<H1><A NAME="GetDDD3DRM" IDX_CONCEPT="noindex; IDA2View::GetDDD3DRM (Accessible only from COM); GetDDD3DRM (IDA2View)(Accessible only from COM)">IDA2View::GetDDD3DRM</A><HR size=1></H1>
<A HREF="IDA2View.htm">IDA2View</A>
<P>Retrieves the <B>IDirectDraw</B> and <B>IDirect3DRM</B> interfaces used by the view.  
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>GetDDD3DRM</B><B>(</B>&nbsp;<B>IUnknown</B> <I>**directDraw</I><B>,</B>&nbsp;<B>IUnknown</B> <I>**d3drm</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>directDraw</I> 
 </DT><DD>[out] Address of the pointer to the <B>IDirectDraw</B> interface used by the view.
</DD><DT><I>d3drm</I>
 </DT><DD>[out] Address of the pointer to the <B>IDirect3DRM</B> interface used by the view.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 
 
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For information about IDirectDraw, see the DirectX Foundation SDK. For information about IDirect3DRM, see the Direct3D Retained Mode documents in the DirectX Media SDK.</BLOCKQUOTE> 

<H1><A NAME="GetInvalidatedRects" IDX_CONCEPT="noindex; IDA2View::GetInvalidatedRects (Accessible only from COM); GetInvalidatedRects (IDA2View)(Accessible only from COM)">IDA2View::GetInvalidatedRects</A><HR size=1></H1>
<A HREF="IDA2View.htm">IDA2View</A>
<P>Retrieves the rectangular regions (RECTs) that have changed in the view.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>GetInvalidatedRects</B><B>(</B>&nbsp;<B>DWORD</B> <I>flags</I><B>,<BR></B>&nbsp;<B>LONG</B> <I>s</I><B>,</B>&nbsp;<B>RECT</B> <I>*pRects</I><B>,</B>&nbsp;<B>LONG</B> <I>*pNumRects</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>flags</I> 
 </DT><DD>[in] Not currently used.
</DD><DT><I>s</I>
 </DT><DD>[in] Size of the array that will contain the changed rectangles.
</DD><DT><I>pRects</I>
 </DT><DD>[size_is(s), in] The array that will hold the changed rectangles. Note that if there are more changed rectangles than the size of the array, only <I>s</I> changed rectangles will be returned. 
</DD><DT><I>pNumRects</I>
 </DT><DD>[out] The actual number of changed rectangles. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Typically, you call <B>GetInvalidatedRects</B> with <I>pRects</I> set to NULL and examine the value returned in <i>pNumRects</i>. This tells you how many rectangles actually changed. You then call <B>GetInvalidatedRects</B> again, using the value returned in <I>pNumRects</I> as the size <I>s</I> of the <I>pRects</I> array. This ensures that all the changed rectangles are retrieved.
</BLOCKQUOTE> 


<H1><A NAME="GetRMDevice" IDX_CONCEPT="noindex; IDA2View::GetRMDevice (Accessible only from COM); GetRMDevice (IDA2View)(Accessible only from COM)">IDA2View::GetRMDevice</A><HR size=1></H1>
<A HREF="IDA2View.htm">IDA2View</A>
<P>Retrieves the <B>IDirect3DRMDevice</B> interface of the underlying Direct3D Retained Mode device and a version indicator so you can tell if it has changed.
   
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax"><P><B>HRESULT</B> <B>GetRMDevice</B><B>(</B>&nbsp;<B>IUnknown</B> <I>**d3drmDevice</I><B>,</B>
<B>DWORD</B> <I>*sequenceNumber</I>&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>d3drmDevice</I> 
 </DT><DD>[out] Address of the pointer to the <B>IDirect3DRMDevice</B> interface of the view's underlying Direct3D Retained Mode device.
</DD><DT><I>sequenceNumber</I>
 </DT><DD>[out] Pointer to the version stamp of the underlying device so you can check if the device has changed, for example, from hardware to software. 
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><p>For information about IDirect3DRMDevice, see the Direct3D Retained Mode documents in the DirectX Media SDK.</BLOCKQUOTE> 
<H1><A NAME="QueryHitPointEx" IDX_CONCEPT="noindex; IDA2View::QueryHitPointEx (Accessible only from COM); QueryHitPointEx (IDA2View)(Accessible only from COM)">IDA2View::QueryHitPointEx</A><HR size=1></H1>
<A HREF="IDA2View.htm">IDA2View</A>
<P>Goes through the image or geometry objects in a view and retrieves the number hit, which were hit, and where they were hit. This method provides a way to do synchronous picking. Call this method to find out what in the view is hit at this point now. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax">
<B>HRESULT</B> <B>QueryHitPointEx</B><B>(</B>
     <B>LONG</B> <I>s</I><B>,</B>
     <B>DWORD</B> <I>cookies</I><B>,</B>
     <B>double</B> <I>*points</I><B>,</B>
     <B>LPCRECT</B> <I>prcBounds</I><B>,</B>
     <B>POINT</B> <I>ptLoc</I><B>,</B>
     <B>LONG</B><I>*hits</I>
<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>s</I> 
 </DT><DD>[in] Size of the array holding the images or geometries that were hit.
</DD><DT><I>cookies</I>
 </DT><DD>[size_is(s), out] Array of cookies (identification tokens) identifying the images or geometries hit.  
</DD><DT><I>points</I>
 </DT><DD>[size_is(s*5), out] The x-, y-, and z-coordinates of the hit in the object's local coordinates, and the u and v <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#texture')">texture</A> coordinates of the hit on the object.
</DD><DT><I>prcBounds</I>
 </DT><DD>[in] Pointer to a <B>RECT</B> structure specifying the bounding rectangle of the view to be checked.
</DD><DT><I>ptLoc</I>
 </DT><DD>[in] Point in device x- and y-coordinates to test for a hit.
</DD><DT><I>hits</I>
 </DT><DD>[out] Total number of images or geometries that were hit.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an HRESULT value that indicates the success of the method or the reason why it failed. This HRESULT depends on the implementation of the interface.</BLOCKQUOTE> 
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>If the number of hits found is greater than the size of the array, the array will be filled with as many hits as it can hold, and the rest will not be returned. No error will be reported. You should check the <I>hits</I> parameter and increase the size of the array, if necessary.
</BLOCKQUOTE> 

<H1><A NAME="StartModelEx" IDX_CONCEPT="noindex; IDA2View::StartModelEx (Accessible only from COM); StartModelEx (IDA2View)(Accessible only from COM)">IDA2View::StartModelEx</A><HR size=1></H1>
<A HREF="IDA2View.htm">IDA2View</A>
<P>Starts rendering the animation model with the specified image and sound at the specified base start time.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE CLASS="syntax">
<B>HRESULT</B> <B>StartModelEx</B><B>(</B>
     <B>IDAImage</B> <I>*pImage</I><B>,</B>
     <B>IDASound</B> <I>*pSound</I><B>,</B>
     <B>double</B> <I>startTime</I><B>,</B>
     <B>DWORD</B>  <I>dwFlags</I>
<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pImage</I> 
 </DT><DD>[in] Pointer to the image to be rendered. 
</DD><DT><I>pSound</I>
 </DT><DD>[in] Pointer to the sound to be rendered.  
</DD><DT><I>startTime</I>
 </DT><DD>[in] Base time at which to start the clock for this model. Ticks will be relative to this time. Elapsed time is tick time minus <I>startTime</I>. 
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flag that specifies whether the model renders immediately, or whether it waits for all synchronous imports to be loaded. By default (<I>dwFlags</I>=0), if all synchronous imports are not loaded then rendering is blocked. Set <I>dwFlags</I> to DAAsyncFlag to render the model even though all synchronous imports are not loaded.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns E_PENDING if DAAsyncFlag is set and the model is being rendered but all synchronous imports are not loaded. Otherwise, returns an HRESULT value that depends on the implementation of the interface.</BLOCKQUOTE>
 
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>If you set <I>dwFlags</I> to DAAsyncFlag and all synchronous imports are not loaded, the method will return E_PENDING but start rendering the model. If you do not set this flag and all synchronous imports are not loaded, rendering will be blocked until they are loaded.

<P>You can use the <I>startTime</I> parameter to synchronize with other models. For example, if another model starts at time 0 and something occurs in that model at time 1000 that you want to synchronize with, set <I>startTime</I> to 1000.
</BLOCKQUOTE> 
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
</BODY>
</HTML>
