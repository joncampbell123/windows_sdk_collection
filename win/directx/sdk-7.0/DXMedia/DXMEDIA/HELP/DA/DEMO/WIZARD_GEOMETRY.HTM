<HTML>
<HEAD><TITLE>Interactive Geometry Demo</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="DirectAnimation Interactive Geometry Demo">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->
</SCRIPT>

<!-- STYLE_START -->
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
<SCRIPT LANGUAGE="JavaScript">if((g_isIE == true) && (g_iMaj < 4)) window.location.href = 'demo_downlevel.htm'</SCRIPT>
<SCRIPT DEFER>
// Declare Globals
var chromeBrowser = "false";
var textObj;
var rotateObj;
var colorObj;
var playRotate = "onclick";
var playColor = "onmouseover";
var stopRotate = "ondblclick";
var stopColor = "onmouseout";

function toggleNotes() {
	if (notes.style.display == "none") {
		notes.style.display = "";
		noteTitle.innerText = "Hide information"
	}
	else {
		notes.style.display = "none";
		noteTitle.innerText = "Show more information."
	}
}
</SCRIPT>
<SCRIPT LANGUAGE="JScript">
<!--
// Declare Globals

var cubeTexture;
var cubeShadow;
var shadowGeo;
var cubeTransScale;
var cubeTransRot;
var cubeTransTrans;
var cubeOpacity;
var movieSound;
var movieSnd;

var Rotating = false;
var Translating = false;
var Shadows = false;

function rotate()
{
  if(Rotating == false)  {
    Rotating = true;
    cubeTransRot = "m.Rotate3RateDegrees(" + selectRotAxis.value + ",60)";
    CubeTransRot.innerHTML = "<B>"+cubeTransRot+"</B>";
    cubeTransF.SwitchTo(m.Compose3Array(new Array( eval(cubeTransScale), 
      eval(cubeTransRot), eval(cubeTransTrans))));
    Rotate.style.backgroundColor = "red";
    Rotate.innerText = "Stop";
    selectRotAxis.disabled = true;
  }
  else {
    Rotating = false;
    cubeTransRot = "m.Rotate3Degrees(m.XVector3,60)";
    CubeTransRot.innerText = cubeTransRot;
    cubeTransF.SwitchTo(m.Compose3Array(new Array( eval(cubeTransScale), 
      eval(cubeTransRot), eval(cubeTransTrans))));
    Rotate.style.backgroundColor = "";
    Rotate.innerText = "Rotate";
    selectRotAxis.disabled = false;
  }
}

function translate()
{
  if(Translating == false)  {
    Translating = true;
    cubeTransTrans = "m.Translate3Anim(" + selectTransAxis.value + ")";
    CubeTransTrans.innerHTML = "<B>"+cubeTransTrans+"</B>";
    cubeTransF.SwitchTo(m.Compose3Array(new Array( eval(cubeTransScale), 
      eval(cubeTransRot), eval(cubeTransTrans))));
    Translate.style.backgroundColor = "red";
    Translate.innerText = "Stop";
    selectTransAxis.disabled = true;
  }
  else {
    Translating = false;
    cubeTransTrans = "m.Translate3(0,0,0)";
    CubeTransTrans.innerText = cubeTransTrans;
    cubeTransF.SwitchTo(m.Compose3Array(new Array( eval(cubeTransScale), 
      eval(cubeTransRot), eval(cubeTransTrans))));
    Translate.style.backgroundColor = "";
    Translate.innerText = "Translate";
    selectTransAxis.disabled = false;
  }
}


function applytex()
{
  if(selectTexture.value == "Movie")  {
    movieImport = 'm.ImportMovie(movieBase + "movie.avi")'
    MovieImport.innerHTML = "<B>" + "movieImport = " + movieImport + ";" + "</B>";
    cubeTexture.SwitchTo(eval(movieImport + ".Image.MapToUnitSquare()"));
    CubeTexture.innerHTML = "<B>" + "movieImport.Image.MapToUnitSquare()" +"</B>";
    movieSound =  movieImport + ".Sound";
    movieSnd.SwitchTo(eval(movieSound));
    MovieSound.innerHTML = "<B>" + "finalSnd = " + "movieImport.Sound;" + "</B>";
  }
  else  {
    MovieImport.innerText = "";
    MovieSound.innerText = "";
    cubeTexture.SwitchTo(eval(selectTexture.value));
    CubeTexture.innerHTML = "<B>"+selectTexture.value+"</B>";
    MovieSound.innerText = "finalSnd = m.Silence" + ";";
    movieSnd.SwitchTo(eval('m.Silence'));
  }
}	

function applyshadow()
{

  if(Shadows == false)  {
    Shadows = true;
	cubeShadow = "lightAndGeo.Shadow(lightAndGeo,m.Point3(0, -0.021, 0),m.Vector3(0,1,0))";
	shadowGeo.SwitchTo(eval(cubeShadow));
    ApplyShadow.innerText = "Turn Shadow Off";
  }
  else  {
    Shadows = false;
    cubeShadow = "m.EmptyGeometry";
	shadowGeo.SwitchTo(eval(cubeShadow));
    ApplyShadow.innerText = "Turn Shadow On";
  }
  CubeShadow.innerHTML = "<B>"+cubeShadow+"</B>";
}
-->
</SCRIPT>
<SCRIPT LANGUAGE="VBS">
<!--
sub OpacityScrollGeo_Change()
 cubeOpacity.SwitchToNumber((OpacityScrollGeo.value)/100)
 update_opactiy()
end sub
-->
</SCRIPT>

<SCRIPT LANGUAGE="JScript">
<!--
function update_opactiy()  {
 CubeOpacity.innerHTML = "<B>" + OpacityScrollGeo.value/100 + "</B>";
}
-->
</SCRIPT>

<SCRIPT LANGUAGE="JScript">
<!--
function winLoad()  {
  m = DAControl.MeterLibrary;
if( m.VersionString != "5.01.15.1106" && m.VersionString != "6.00.03.0518" && m.VersionString != "5.01.17.0825" && m.VersionString != "5.01.15.0828")  {
  
  mediaBase = "../../../samples/multimedia/media/";
  geoBase = mediaBase + "geometry/";
  imageBase = mediaBase + "image/";
  movieBase = mediaBase + "movie/";
  // a rotating cube
  cubeGeo = m.ImportGeometry(geoBase + "cube.x");

  MovieImport.innerText = "";

  cubeTexture = m.ModifiableBehavior(eval(selectTexture.value));

  cubeTransScale = "m.Scale3Uniform(0.0125)";
  cubeGeo = cubeGeo.TextureImage(cubeTexture);
  cubeTransRot = "m.Rotate3Degrees(" + selectRotAxis.value + ",60)";
  cubeTransTrans = "m.IdentityTransform3"

  cubeTransF = m.ModifiableBehavior(m.Compose3Array(new Array( eval(cubeTransScale), 
    eval(cubeTransRot), eval(cubeTransTrans))));

  CubeTransScale.innerText = cubeTransScale;
  CubeTransRot.innerText = cubeTransRot;
  CubeTransTrans.innerText = cubeTransTrans;
  CubeTexture.innerText = selectTexture.value;

  cubeGeo = cubeGeo.Transform(cubeTransF);

  cubeOpacity = m.ModifiableNumber(eval(OpacityScrollGeo.value/100));
  CubeOpacity.innerText = OpacityScrollGeo.value/100;

  cubeGeo = cubeGeo.OpacityAnim(cubeOpacity);

  camera = m.PerspectiveCamera(0.06, 0.033);
  light = m.UnionGeometry(m.AmbientLight,m.DirectionalLight.Transform(m.Rotate3Degrees(m.XVector3,-90)));

  lightAndGeo = m.UnionGeometry(cubeGeo, light);

  cubeShadow = "m.EmptyGeometry";
  CubeShadow.innerText = cubeShadow;

  shadowGeo = m.ModifiableBehavior(eval(cubeShadow));

  finalImg = m.UnionGeometry(lightAndGeo, shadowGeo).render(camera);

  DAControl.Image = finalImg;

  movieSound = "m.Silence";
  MovieSound.innerText = "finalSnd = m.Silence" + ";";

  movieSnd = m.ModifiableBehavior(eval(movieSound));
  
  DAControl.Sound = movieSnd;
     
  // start the animation       
  DAControl.Start();
}

 else
    window.top.location.href = "demo_downlevel.htm"
}
-->
</SCRIPT>

</HEAD>
<BODY onload="InitPage();winLoad();" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="Geometry_Wiz"></A>
<!-- HEADGRAPH_START -->
<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Microsoft DirectAnimation SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/hdrdanim.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectAnimation Animated Header --Microsoft DirectAnimation SDK"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectAnimation Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectAnimation SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- DACONTROL_START -->
	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="demo_entry.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="demo_entry.htm">Interactive Script Demos</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="wizard_image.htm" TARGET="_top">Interactive Image Demo</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<!-- START POP-UP GLOSSARY -->
<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<BLOCKQUOTE CLASS="body">




<!-- CONTENTS_START -->
<TABLE Border="2" bgcolor="#DDDDDD" Width="100%">
  <TR>
    <TD>

<TABLE>
        <TR Width="301">
 				  <TD ALIGN=CENTER BGCOLOR="#EEEEEE">
					  <OBJECT ID="DAControl"
					  STYLE="width:300;height:350" 
					  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
					  </OBJECT>
          </TD>
        </TR>
        <TR Bgcolor="#DDDDDD">
    		<TD ALIGN="LEFT">
	<TABLE Bgcolor="#DDDDDD" CELLPADDING="0">

			<TR>
			<TD COLSPAN="2">
	<!--"background-Color:"";width:120" -->
			<BUTTON ID="Rotate" style="width:120" 
			TITLE="Click this button to toggle rotation." 
			onclick="rotate()">Rotate
			</BUTTON>
			</TD>
			<TD ALIGN="LEFT">Rotate Along:</TD>
			<TD STYLE="padding-left:0">
			<SELECT ID="selectRotAxis" STYLE="width:120" TITLE="Change the rotation axis.">
			<OPTION SELECTED VALUE="m.XVector3">X-AXIS</OPTION>
			<OPTION VALUE="m.YVector3">Y-AXIS</OPTION>
			<OPTION VALUE="m.ZVector3">Z-AXIS</OPTION>
			</SELECT>
			</TD>
			
			</TR>

			<TR>
			<TD COLSPAN="2">
<!--"background-Color:"";width:120" -->
			<BUTTON ID="Translate" style="width:120" 
			TITLE="Click this button to toggle translation." 
			onclick="translate()">Translate
			</BUTTON>
			</TD>
			<TD ALIGN="LEFT">Translate Along:</TD>
			<TD STYLE="padding-left:0">
			<SELECT ID="selectTransAxis" STYLE="width:120" TITLE="Change the translation axis.">
			<OPTION SELECTED VALUE="m.Sin(m.LocalTime),m.DANumber(0),m.DANumber(0)">X-AXIS</OPTION>
			<OPTION VALUE="m.DANumber(0),m.Sin(m.LocalTime),m.DANumber(0)">Y-AXIS</OPTION>
			<OPTION VALUE="m.DANumber(0),m.DANumber(0),m.Sin(m.LocalTime)">Z-AXIS</OPTION>
			<OPTION VALUE="m.Cos(m.LocalTime),m.Sin(m.LocalTime),m.DANumber(0)">X AND Y-AXIS</OPTION>
			<OPTION VALUE="m.Cos(m.LocalTime),m.DANumber(0),m.Sin(m.LocalTime)">X AND Z-AXIS</OPTION>
			<OPTION VALUE="m.DANumber(0),m.Cos(m.LocalTime),m.Sin(m.LocalTime)">Y AND Z-AXIS</OPTION>			
			<OPTION VALUE="m.Sin(m.LocalTime),m.Cos(m.LocalTime),m.Sin(m.LocalTime)">X, Y AND Z-AXIS</OPTION>						
			</SELECT>
			</TD>
			</TR>

			<TR>
			<TD COLSPAN="2">
<!--"background-Color:"";width:120" -->
			<BUTTON ID="ApplyTex" style="width:120" 
			TITLE="Click this button to apply the texture." 
			onclick="applytex()">Apply Texture
			</BUTTON>
			</TD>
			<TD ALIGN="LEFT">Texture:</TD>
			<TD style="padding-left:0">
			<SELECT id="selectTexture" STYLE="width:120" TITLE="Change the texture.">
			<OPTION SELECTED VALUE="m.SolidColorImage(m.blue)">SOLID COLOR</option>
			<OPTION VALUE="m.ImportImage(imageBase + 'mndscp2.jpg').MapToUnitSquare()">IMAGE</option>
			<OPTION VALUE="Movie">MOVIE</option>
			<OPTION VALUE="m.gradientSquare(m.Red, m.Black, m.Blue, m.White).MapToUnitSquare()">GRADIENT</option>
			<OPTION VALUE="m.StringImage('DA',m.Font('Arial',8,m.Blue)).MapToUnitSquare()">TEXT</option>
			<OPTION VALUE="m.Oval(0.01, 0.01).Fill(m.DefaultLineStyle, m.SolidColorImage(m.Red)).MapToUnitSquare()">VCTR GRAPHICS</option>
			</SELECT>
			</TD>
			
</TR>
</TABLE>
<TABLE>			
<TR>
			<TD>
<!--"background-Color:"";width:120" -->
			<BUTTON ID="ApplyShadow" style="width:120" 
			TITLE="Click this button to apply a shadow." 
			onclick="applyshadow()">Turn Shadow On
			</BUTTON>
</TD>
		
</TR>
			</TABLE>
			</TD>
			</TR>

			<TR>
			<TD ALIGN="left"> Opacity:
			<OBJECT ID="OpacityScrollGeo" 
			STYLE="position:relative; left:26; top:0; width:112;height:20" STYLE="border:2px solid #696969;"
			CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D">
			<PARAM NAME="Max" VALUE="100">
			<PARAM NAME="Position" VALUE="100">
			<PARAM NAME="LargeChange" VALUE="10">
			<PARAM NAME="Orientation" VALUE="1">
			</OBJECT>
			</TD>
			</TR>
	
		</TABLE>
		</TD>
		<TD>
<TABLE BORDERCOLOR="#AAAAAA" bgcolor="#FFFFFF" HEIGHT="100%">
				<TR>
					<TD Bgcolor="#DDDDDD" STYLE="border-width:1; border-style:solid; padding-left:5; padding-right:5">
						<CENTER><H3><A NAME="Geo_Demo" IDX_CONCEPT="noindex; Geometry Demo; Demo, geometry">Geometries</A></H3></CENTER>
						Use the controls on the left to add animation, apply textures, turn shadowing on and off, and set the opacity. The JScript code used to generate the 
            animation appears below. Note that in order to use <A HREF="../ref_script/class/DAGeometryClass.htm#Shadowv_g">shadows</A> you must have Microsoft&reg; DirectX&reg; 6.x or later installed. You will not get an error if you turn on shadows without DirectX 6.x. It will simply have no effect.
            <SPAN ID="noteTitle" STYLE="text-decoration:underline;" 
            onmouseover='this.style.cursor = "hand"' onclick="toggleNotes()">Show more 
            information. </SPAN><SPAN ID="notes" STYLE="display:none">
<BR><BR>You can construct or import 3-D graphics (<B>DAGeometry</B> objects), and perform sequences of operations on them in any order. The simplest way to construct a geometry behavior is to import a geometry from an .X formatted file. You can import geometries synchronously or asynchronously. You can augment geometry with lights, including ambient, directional, point, and spot lights. You can attach a sound source to a geometry, which is used to give 3-D spatial characteristics to a sound by embedding it in other geometric models. You can also set a shadow for a geometry.
<p>To set shadows correctly, you must create a visible object and the light to cast shadows. Also, you must set the shadow plane and light position 
correctly. You need a point and a vector to define the shadow plane. The point is a point on the plane, and the vector defines the normal (a vector perpendicular to the plane) at the point that points toward the object. This is the syntax for shadow: <Code>geometryObj.Shadow( geoContainingLights, planePoint, planeNormal)</code>. Thus, setting the vector to (0 0 1) means the plane is directly behind the object and the normal points ahead toward the object, while setting the vector to (0 0 -1) means the plane is in front of the object and the normal points back to it. Note that changing the position of the light or the shadow plane changes the shadow's location. &nbsp;
						</SPAN>
					</TD>
				</TR>
				<TR>
	    			<TD bgcolor="#FFFFFF" VALIGN="top">
					<!-- Display required object code -->
					<SPAN STYLE="font-size:11; font:Courier-New">
					&lt;HTML&gt;<BR>
					&lt;HEAD&gt;<BR>
					&lt;/HEAD&gt;<BR>
					&lt;BODY&gt;<BR>

					&lt;OBJECT ID="DAControl" STYLE="width:300;height:350"<BR>
					CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D"&gt;<BR>
					&lt;/OBJECT&gt;<BR>
          &lt;SCRIPT LANGUAGE="JScript"&gt;<BR>
          &lt;!--<BR>
          m = DAControl.MeterLibrary;<BR><BR>
          mediaBase = "../../../samples/multimedia/media/";<BR>
          imageBase = mediaBase + "image/";<BR>
          geoBase = mediaBase + "geometry/";<BR>
          movieBase = mediaBase + "movie/";<BR>
          cubeGeo = m.ImportGeometry(geoBase + "cube.x");<BR>
          <SPAN id="MovieImport"></SPAN><BR><BR>
          cubeTexture = <SPAN id="CubeTexture"></SPAN>;<BR>
          cubeGeo = cubeGeo.TextureImage(cubeTexture);<BR><BR>
          cubeTransScale = <SPAN id="CubeTransScale"></SPAN>;<BR>
          cubeTransRot = <SPAN id="CubeTransRot"></SPAN>;<BR>
          cubeTransTrans = <SPAN id="CubeTransTrans"></SPAN>;<BR>
          cubeTransF = m.Compose3Array(new Array( cubeTransScale, cubeTransRot, cubeTransTrans));<BR><BR>
          cubeGeo = cubeGeo.Transform(cubeTransF);<BR><BR>
          cubeGeo = cubeGeo.Opacity(<SPAN id="CubeOpacity"></SPAN>);<BR><BR>
          camera = m.PerspectiveCamera(0.06, 0.033);<BR>
          light = m.UnionGeometry(m.AmbientLight, m.DirectionalLight.Transform(m.Rotate3Degrees(m.XVector3,-90)));<BR>
          lightAndGeo = m.UnionGeometry(cubeGeo, light);<BR>
          shadowGeo = <SPAN id="CubeShadow"></SPAN>;<BR><BR>
          finalImg = m.UnionGeometry(lightAndGeo, shadowGeo).render(camera);<BR>
          <SPAN id="MovieSound"></SPAN><BR><BR>
          DAControl.Image = finalImg;<BR>
          DAControl.Sound = finalSnd;<BR>
          DAControl.Start();<BR>
          --&gt;<BR>
          &lt;/SCRIPT&gt;<BR>
					&lt;/BODY&gt;<BR>
					&lt;/HTML&gt;<BR>
					</SPAN>
					</TD>
				</TR>
			</TABLE>
					</TD>
	</TR>
</TABLE>
<!-- END_PAGE_FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>