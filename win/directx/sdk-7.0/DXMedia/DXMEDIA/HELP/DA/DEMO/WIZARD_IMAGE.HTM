<HTML>
<HEAD><TITLE>Interactive Image Demo</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="DirectAnimation Interactive Image Demo">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->
</SCRIPT>

<!-- STYLE_START -->
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<SCRIPT LANGUAGE="JavaScript">if((g_isIE == true) && (g_iMaj < 4)) window.location.href = 'demo_downlevel.htm'</SCRIPT>
<!-- STYLE_END -->
<SCRIPT DEFER>
// Declare Globals
var chromeBrowser = "false";
var textObj;
var rotateObj;
var colorObj;
var playRotate = "onclick";
var playColor = "onmouseover";
var stopRotate = "ondblclick";
var stopColor = "onmouseout";

function toggleNotes() {
	if (notes.style.display == "none") {
		notes.style.display = "";
		noteTitle.innerText = "Hide information"
	}
	else {
		notes.style.display = "none";
		noteTitle.innerText = "Show more information."
	}
}
</SCRIPT>
<SCRIPT LANGUAGE="JScript">
<!--
// Declare Globals

var imgTransScale;
var imgTransRot;
var imgTransTrans;
var imgCrop;

var Rotating = false;
var Translating = false;
var Scaling = false;
var Cropping = false;

function rotate()
{
  if(Rotating == false)  {
    Rotating = true;
    imgTransRot = "m.Rotate2RateDegrees(60)";
    ImgTransRot.innerHTML = "<B>"+imgTransRot+"</B>";
    imgTransF.SwitchTo(m.Compose2Array(new Array( eval(imgTransScale), 
      eval(imgTransRot), eval(imgTransTrans))));
    Rotate.style.backgroundColor = "red";
    Rotate.innerText = "Stop";
  }
  else {
    Rotating = false;
    imgTransRot = "m.IdentityTransform2";
    ImgTransRot.innerText = imgTransRot;
    imgTransF.SwitchTo(m.Compose2Array(new Array( eval(imgTransScale), 
      eval(imgTransRot), eval(imgTransTrans))));
    Rotate.style.backgroundColor = "";
    Rotate.innerText = "Rotate";
  }
}

function translate()
{
  if(Translating == false)  {
    Translating = true;
    imgTransTrans = "m.Translate2Anim(" + selectTransAxis.value + ")";
    ImgTransTrans.innerHTML = "<B>"+imgTransTrans+"</B>";
    imgTransF.SwitchTo(m.Compose2Array(new Array( eval(imgTransScale), 
      eval(imgTransRot), eval(imgTransTrans))));
    Translate.style.backgroundColor = "red";
    Translate.innerText = "Stop";
    selectTransAxis.disabled = true;
  }
  else {
    Translating = false;
    imgTransTrans = "m.IdentityTransform2";
    ImgTransTrans.innerText = imgTransTrans;
    imgTransF.SwitchTo(m.Compose2Array(new Array( eval(imgTransScale), 
      eval(imgTransRot), eval(imgTransTrans))));
    Translate.style.backgroundColor = "";
    Translate.innerText = "Translate";
    selectTransAxis.disabled = false;
  }
}


function scale()
{
  if(Scaling == false)  {
    Scaling = true;
    imgTransScale = "m.Scale2Anim(" + selectScaleAxis.value + ")";
    ImgTransScale.innerHTML = "<B>"+imgTransScale+"</B>";
    imgTransF.SwitchTo(m.Compose2Array(new Array( eval(imgTransScale), 
      eval(imgTransRot), eval(imgTransTrans))));
    Scale.style.backgroundColor = "red";
    Scale.innerText = "Stop";
    selectScaleAxis.disabled = true;
  }
  else {
    Scaling = false;
    imgTransScale = "m.IdentityTransform2";
    ImgTransScale.innerText = imgTransScale;
    imgTransF.SwitchTo(m.Compose2Array(new Array( eval(imgTransScale), 
      eval(imgTransRot), eval(imgTransTrans))));
    Scale.style.backgroundColor = "";
    Scale.innerText = "Scale";
    selectScaleAxis.disabled = false;
  }
}

function applycrop()
{
  if(Cropping == false)  {
    Cropping = true;
    finalImg.SwitchTo(rawImg.Crop(m.Point2(-0.01,-0.01), m.Point2(0.01,0.01)).Opacity(OpacityScrollImg.value/100));
	  imgCrop = "finalImg = rawImg.Crop(m.Point2(-0.01,-0.01), m.Point2(0.01,0.01)).Opacity(" + OpacityScrollImg.value/100 + ")" + ";";
    ApplyCrop.style.backgroundColor = "red";    
    ApplyCrop.innerText = "Stop";
  }
  else  {
    Cropping = false;
    finalImg.SwitchTo(rawImg.Opacity(OpacityScrollImg.value/100));
	  imgCrop = "finalImg = rawImg.Opacity(" + OpacityScrollImg.value/100 + ")" + ";";
    ApplyCrop.style.backgroundColor = "";    
    ApplyCrop.innerText = "Crop";
  }
  ImgCrop.innerHTML = "<B>"+imgCrop+"</B>";
}
-->
</SCRIPT>
<SCRIPT LANGUAGE="VBS">
<!--
sub OpacityScrollImg_Change()
 'imgOpacity.SwitchToNumber((OpacityScrollImg.value)/100)
 update_opacity()
end sub
-->
</SCRIPT>

<SCRIPT LANGUAGE="JScript">
<!--
function update_opacity()  {
  if(Cropping == false)  {
    finalImg.SwitchTo(rawImg.Opacity(OpacityScrollImg.value/100));
    imgCrop = "finalImg = rawImg.Opacity(" + OpacityScrollImg.value/100 + ")" + ";";
  }
  else  {
    finalImg.SwitchTo(rawImg.Crop(m.Point2(-0.01,-0.01), m.Point2(0.01,0.01)).Opacity(OpacityScrollImg.value/100));
	  imgCrop = "finalImg = rawImg.Crop(m.Point2(-0.01,-0.01), m.Point2(0.01,0.01)).Opacity(" + OpacityScrollImg.value/100 + ")" + ";";
  }
  
  ImgCrop.innerHTML = "<B>" + imgCrop + "</B>";
}
-->
</SCRIPT>

<SCRIPT LANGUAGE="JScript">
<!--
function winLoad()  {
  m = DAControl.MeterLibrary;
if( m.VersionString != "5.01.15.1106" && m.VersionString != "6.00.03.0518")  {
  
  mediaBase = "../../../samples/multimedia/media/";
  imageBase = mediaBase + "image/";
  rawImg = m.ImportImage(imageBase + "metablob.jpg");

  imgTransScale = "m.IdentityTransform2";
  imgTransRot = "m.IdentityTransform2";
  imgTransTrans = "m.IdentityTransform2"

  imgTransF = m.ModifiableBehavior(m.Compose2Array(new Array( eval(imgTransScale), 
    eval(imgTransRot), eval(imgTransTrans))));

  ImgTransScale.innerText = imgTransScale;
  ImgTransRot.innerText = imgTransRot;
  ImgTransTrans.innerText = imgTransTrans;

  rawImg = rawImg.Transform(imgTransF);

  finalImg = m.ModifiableBehavior(rawImg);
  imgCrop = "finalImg = rawImg.Opacity(" + OpacityScrollImg.value/100 + ")" + ";";
  ImgCrop.innerHTML = imgCrop;

  DAControl.Image = finalImg;
     
  DAControl.Start();
}

 else
    window.top.location.href = "demo_downlevel.htm"
}
-->
</SCRIPT>

</HEAD>
<BODY onload="InitPage();winLoad();" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="Image_Wiz"></A>
<!-- HEADGRAPH_START -->
<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Microsoft DirectAnimation SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/hdrdanim.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectAnimation Animated Header --Microsoft DirectAnimation SDK"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectAnimation Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectAnimation SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- DACONTROL_START -->
	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="demo_entry.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="wizard_geometry.htm">Interactive Geometry Demo</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="wizard_sound.htm" TARGET="_top">Interactive Sound Demo</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<!-- START POP-UP GLOSSARY -->
<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<BLOCKQUOTE CLASS="body">




<!-- CONTENTS_START -->
<TABLE Border="2" bgcolor="#DDDDDD" Width="100%">
  <TR>
    <TD>
<!-- insert table 3 here -->
      <TABLE>
        <TR Width="301">

					  <TD ALIGN=CENTER BGCOLOR="#EEEEEE">
					  <OBJECT ID="DAControl"
					  STYLE="width:400;height:400" 
					  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
					  </OBJECT>
          </TD>
        </TR>
        <TR Bgcolor="#DDDDDD">
    		<TD ALIGN="LEFT">
<!--insert table 2 here -->
		  <TABLE Bgcolor="#DDDDDD" CELLPADDING="0">

			<TR>
			<TD COLSPAN="2">
			<!--background-Color:""; width:120-->
			<BUTTON ID="Rotate" style="width:120" 
			TITLE="Click this button to toggle rotation." 
			onclick="rotate()">Rotate
			</BUTTON>
			</TD>
</TR>
</TABLE>
<TABLE>
			<TR>
			<TD COLSPAN="2">
			<!--background-Color:""; width:120-->
			<BUTTON ID="Translate" style="width:120" 
			TITLE="Click this button to toggle translation." 
			onclick="translate()">Translate
			</BUTTON>
			</TD><TD ALIGN="LEFT">Translate Along:</TD>
			<TD STYLE="padding-left:0">
			
			<SELECT ID="selectTransAxis" STYLE="width:120" TITLE="Change the translation axis.">
			<OPTION SELECTED VALUE="m.Mul(m.Sin(m.LocalTime),m.DANumber(0.01)),m.DANumber(0)">X-AXIS</OPTION>
			<OPTION VALUE="m.DANumber(0),m.Mul(m.Sin(m.LocalTime),m.DANumber(0.01))">Y-AXIS</OPTION>
			<OPTION VALUE="m.Mul(m.Cos(m.LocalTime),m.DANumber(0.01)),m.Mul(m.Sin(m.LocalTime),m.DANumber(0.01))">X AND Y-AXIS</OPTION>
			</SELECT>
			</TD>
			
			</TR>

			<TR>
			<TD COLSPAN="2">
			<!--background-Color:""; width:120-->
			<BUTTON ID="Scale" style="width:120" 
			TITLE="Click this button to to toggle scaling."
			onclick="scale()">Scale
			</BUTTON>
			</TD>
			<TD ALIGN="LEFT">Scale Along:</TD>
			<TD style="padding-left:0">
			
			<SELECT id="selectScaleAxis" STYLE="width:120" TITLE="Change the scale axis">
			<OPTION SELECTED VALUE="m.Abs(m.Sin(m.LocalTime)),m.DANumber(1)">X-AXIS</option>
			<OPTION VALUE="m.DANumber(1),m.Abs(m.Sin(m.LocalTime))">Y-AXIS</OPTION>
			<OPTION VALUE="m.Abs(m.Sin(m.LocalTime)),m.Abs(m.Sin(m.LocalTime))">X AND Y-AXIS</OPTION>			
      </SELECT>
			</TD>
			
</TR>
<TR>

			<TD>
			<!--background-Color:""; width:120-->
			<BUTTON ID="ApplyCrop" style="width:120" 
			TITLE="Click this button to apply a crop." 
			onclick="applycrop()">Crop
			</BUTTON>
			</TD>
			</TR>
			</TABLE>
			</TD>
			</TR>

			<TR>
			<TD ALIGN="left"> Opacity:
			<OBJECT ID="OpacityScrollImg" 
			STYLE="position:relative; left:26; top:0; width:112;height:20" STYLE="border:2px solid #696969;"
			CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D">
			<PARAM NAME="Max" VALUE="100">
			<PARAM NAME="Position" VALUE="100">
			<PARAM NAME="LargeChange" VALUE="10">
			<PARAM NAME="Orientation" VALUE="1">
			</OBJECT>
			</TD>
			</TR>
	
		</TABLE>
		</TD>
		<TD>
<!-- insert table 1 here -->
			<TABLE BORDERCOLOR="#AAAAAA" bgcolor="#FFFFFF" HEIGHT="100%">
				<TR>
					<TD Bgcolor="#DDDDDD" STYLE="border-width:1; border-style:solid; padding-left:5; padding-right:5">
						<CENTER><H3><A NAME="Image_Demo" IDX_CONCEPT="noindex; Image Demo; Demo, image">Images</A></H3></CENTER>
						Use the controls on the left to rotate, translate, scale or crop the image, as well as set its opacity. The JScript code used to generate the 
            animation appears below.
            <SPAN ID="noteTitle" STYLE="text-decoration:underline;" 
            onmouseover='this.style.cursor = "hand"' onclick="toggleNotes()">Show more 
            information. </SPAN><SPAN ID="notes" STYLE="display:none">
<BR><BR>
DirectAnimation can construct or import 2-D images (<B>DAImage</B> objects), and can perform sequences of operations on the images in any order. Images can be created by importing bitmaps from GIF, JPEG, and BMP formats, by drawing lines and polygons, by rendering 3-D geometries into images, by rendering text into images, by combining images, and by giving images an explicit Z-order to create montage effects. You can import images synchronously or asynchronously. &nbsp;
						</SPAN>
					</TD>
				</TR>
				<TR>
	    			<TD bgcolor="#FFFFFF" VALIGN="top">
					<!-- Display required object code -->
					<SPAN STYLE="font-size:11; font:Courier-New">
					&lt;HTML&gt;<BR>
					&lt;HEAD&gt;<BR>
					&lt;/HEAD&gt;<BR>
					&lt;BODY&gt;<BR>

					&lt;OBJECT ID="DAControl" STYLE="width:300;height:300"<BR>
					CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D"&gt;<BR>
					&lt;/OBJECT&gt;<BR>
          &lt;SCRIPT LANGUAGE="JScript"&gt;<BR>
          &lt;!--<BR>
          m = DAControl.MeterLibrary;<BR><BR>
          mediaBase = "../../../samples/multimedia/media/";<BR>
          imgBase = mediaBase + "image/";<BR>
          rawImg = m.ImportImage(imgBase + "tigerstripe.jpg");<BR><BR>
          imgTransScale = <SPAN id="ImgTransScale"></SPAN>;<BR>
          imgTransRot = <SPAN id="ImgTransRot"></SPAN>;<BR>
          imgTransTrans = <SPAN id="ImgTransTrans"></SPAN>;<BR>
          imgTransF = m.Compose2Array(new Array( imgTransScale, imgTransRot, imgTransTrans));<BR><BR>
          rawImg = rawImg.Transform(imgTransF);<BR><BR>
          <SPAN id="ImgCrop"></SPAN><BR><BR>
          DAControl.Image = finalImg;<BR>
          DAControl.Start();<BR>
          --&gt;<BR>
          &lt;/SCRIPT&gt;<BR>
					&lt;/BODY&gt;<BR>
					&lt;/HTML&gt;<BR>
					</SPAN>
					</TD>
				</TR>
			</TABLE>
		</TD>
	</TR>
</TABLE>
<!-- END_PAGE_FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>