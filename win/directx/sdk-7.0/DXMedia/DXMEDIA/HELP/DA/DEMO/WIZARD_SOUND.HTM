<HTML>
<HEAD><TITLE>Interactive Sound Demo</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="DirectAnimation Interactive Sound Demo">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->
</SCRIPT>

<!-- STYLE_START -->
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
<SCRIPT DEFER>
// Declare Globals
var chromeBrowser = "false";
var textObj;
var rotateObj;
var colorObj;
var playRotate = "onclick";
var playColor = "onmouseover";
var stopRotate = "ondblclick";
var stopColor = "onmouseout";

function toggleNotes() {
	if (notes.style.display == "none") {
		notes.style.display = "";
		noteTitle.innerText = "Hide information"
	}
	else {
		notes.style.display = "none";
		noteTitle.innerText = "Show more information."
	}
}
</SCRIPT>
<SCRIPT LANGUAGE="JScript">
<!--
// Declare Globals
var panPos1;
var panPos2;
var panPos3;
var panPos4;

var volPos1;
var volPos2;
var volPos3;
var volPos4;

-->
</SCRIPT>
<SCRIPT LANGUAGE="VBS">
<!--
Sub VolScroll1_change()
 ' Change volPos1 to the value property of the scrollbar.
  volPos1.SwitchToNumber(VolumeVal(VolScroll1.Value))
  Sound1Gain.innerHTML = VolumeVal(VolScroll1.Value)
End Sub

Sub PanScroll1_change()
  ' Change panPos1 to the value property of the scrollbar.
  panPos1.SwitchTo(m.DANumber(PanVal(PanScroll1.Value)))
  Sound1Pan.innerHTML = PanVal(PanScroll1.Value)
End Sub

Sub VolScroll2_change()
 ' Change volPos2 to the value property of the scrollbar.
  volPos2.SwitchToNumber(VolumeVal(VolScroll2.Value))
  Sound2Gain.innerHTML = VolumeVal(VolScroll2.Value)
End Sub

Sub PanScroll2_change()
  ' Change panPos2 to the value property of the scrollbar.
  panPos2.SwitchTo(m.DANumber(PanVal(PanScroll2.Value)))
  Sound2Pan.innerHTML = PanVal(PanScroll2.Value)
End Sub

Sub VolScroll3_change()
 ' Change volPos3 to the value property of the scrollbar.
  volPos3.SwitchToNumber(VolumeVal(VolScroll3.Value))
  Sound3Gain.innerHTML = VolumeVal(VolScroll3.Value)
End Sub

Sub PanScroll3_change()
  ' Change panPos3 to the value property of the scrollbar.
  panPos3.SwitchTo(m.DANumber(PanVal(PanScroll3.Value)))
  Sound3Pan.innerHTML = PanVal(PanScroll3.Value)
End Sub

Sub VolScroll4_change()
 ' Change volPos4 to the value property of the scrollbar.
  volPos4.SwitchToNumber(VolumeVal(VolScroll4.Value))
  Sound4Gain.innerHTML = VolumeVal(VolScroll4.Value)
End Sub

Sub PanScroll4_change()
  ' Change panPos4 to the value property of the scrollbar.
  panPos4.SwitchTo(m.DANumber(PanVal(PanScroll4.Value)))
  Sound4Pan.innerHTML = PanVal(PanScroll4.Value)
End Sub

Function VolumeVal(scrollVal)
  VolumeVal = -scrollVal*0.1 + 1
End Function

Function PanVal(scrollVal)
  PanVal = scrollVal*0.2 - 1
End Function
-->
</SCRIPT>

<SCRIPT LANGUAGE="JScript">
<!--
function update_opacity()  {
  if(Cropping == false)  {
    finalImg.SwitchTo(rawImg.Opacity(OpacityScrollImg.value/100));
    imgCrop = "finalImg = rawImg.Opacity(" + OpacityScrollImg.value/100 + ")" + ";";
  }
  else  {
    finalImg.SwitchTo(rawImg.Crop(m.Point2(-0.01,-0.01), m.Point2(0.01,0.01)).Opacity(OpacityScrollImg.value/100));
	  imgCrop = "finalImg = rawImg.Crop(m.Point2(-0.01,-0.01), m.Point2(0.01,0.01)).Opacity(" + OpacityScrollImg.value/100 + ")" + ";";
  }
  
  ImgCrop.innerHTML = "<B>" + imgCrop + "</B>";
}
-->
</SCRIPT>

<SCRIPT LANGUAGE="JScript">
<!--
function winLoad()  {
  m = DAControl.MeterLibrary;
if( m.VersionString != "5.01.15.1106" && m.VersionString != "6.00.03.0518")  {
 
  mediaBase = "../../../samples/multimedia/media/";
  soundBase = mediaBase + "sound/";

  volPos1 = m.ModifiableBehavior(m.DANumber(0));
  volPos2 = m.ModifiableBehavior(m.DANumber(0));
  volPos3 = m.ModifiableBehavior(m.DANumber(0));
  volPos4 = m.ModifiableBehavior(m.DANumber(0));

  panPos1 = m.ModifiableBehavior(m.DANumber(0));
  panPos2 = m.ModifiableBehavior(m.DANumber(0));
  panPos3 = m.ModifiableBehavior(m.DANumber(0));
  panPos4 = m.ModifiableBehavior(m.DANumber(0));


  rawSnd1 = m.ImportSound(soundBase + "16b_mn_11_01.wav").Sound.Loop();
  rawSnd2 = m.ImportSound(soundBase + "16b_mn_11_02.wav").Sound.Loop();
  rawSnd3 = m.ImportSound(soundBase + "16b_mn_11_03.wav").Sound.Loop();
  rawSnd4 = m.ImportSound(soundBase + "16b_mn_11_04.wav").Sound.Loop();

  Sound1Pan.innerHTML = PanVal(PanScroll1.Value);
  Sound2Pan.innerHTML = PanVal(PanScroll2.Value);
  Sound3Pan.innerHTML = PanVal(PanScroll3.Value);
  Sound4Pan.innerHTML = PanVal(PanScroll4.Value);

  Sound1Gain.innerHTML = VolumeVal(VolScroll1.Value)
  Sound2Gain.innerHTML = VolumeVal(VolScroll2.Value)
  Sound3Gain.innerHTML = VolumeVal(VolScroll3.Value)
  Sound4Gain.innerHTML = VolumeVal(VolScroll4.Value)

  finalSnd = m.MixArray(new Array(rawSnd1.PanAnim(panPos1).GainAnim(volPos1), 
    rawSnd2.PanAnim(panPos2).GainAnim(volPos2), 
	  rawSnd3.PanAnim(panPos3).GainAnim(volPos3), 
	    rawSnd4.PanAnim(panPos4).GainAnim(volPos4)));

  oscillatingNumber = m.Sin(m.LocalTime);
  txtCol = m.ColorHslAnim(m.Abs(oscillatingNumber), m.DANumber(0.5), m.DANumber(0.5));
  fontStyle = m.Font("Arial",-18, txtCol );

  sndImg =  m.StringImage("DirectAnimation Sound", fontStyle);

  DAControl.Image = m.Overlay(sndImg, m.SolidColorImage(m.Black));
  DAControl.Sound = finalSnd;
     
  DAControl.Start();
}
 else
    window.top.location.href = "demo_downlevel.htm"
}
-->
</SCRIPT>
<SCRIPT LANGUAGE="JavaScript">if((g_isIE == true) && (g_iMaj < 4)) window.location.href = 'demo_downlevel.htm'</SCRIPT>
</HEAD>
<BODY onload="InitPage();winLoad();" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="Image_Wiz"></A>
<!-- HEADGRAPH_START -->
<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Microsoft DirectAnimation SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/hdrdanim.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectAnimation Animated Header --Microsoft DirectAnimation SDK"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectAnimation Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectAnimation SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- DACONTROL_START -->
	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="demo_entry.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="wizard_image.htm">Interactive Image Demo</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" href="wizard_dxtransforms.htm" TARGET="_top">Interactive DirectX Transform Effect Demo</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<!-- START POP-UP GLOSSARY -->
<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<BLOCKQUOTE CLASS="body">




<!-- CONTENTS_START -->
<TABLE Border="2" bgcolor="#DDDDDD" Width="100%">
  <TR>
    <TD>
    <!--insert table2 here -->
  <TABLE>
        <TR Width="450">
		
 				  <TD ALIGN=CENTER BGCOLOR="#EEEEEE">
					  <OBJECT ID="DAControl"
					  STYLE="width:300;height:220" 
					  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
					  </OBJECT>
          </TD>
        </TR>
        <TR Bgcolor="#DDDDDD">
    		<TD ALIGN="LEFT">
				</TD>
			</TR>

			<TR>

<OBJECT ID="VolScroll1"   
 STYLE="position:absolute;left:105;top:478;width:10;height:90"
 CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D"
 CODEBASE="http://activex.microsoft.com/controls/mspert10.cab">
    <PARAM NAME="Min" VALUE="0">
    <PARAM NAME="Max" VALUE="10">
	<PARAM NAME="Position" VALUE="10">
    <PARAM NAME="LargeChange" VALUE="2">
    <PARAM NAME="Orientation" VALUE="0">
</OBJECT>

<DIV STYLE="position:absolute; left:75; top:458;width:50%;">
<B>VOLUME 1</B>
</DIV>


<OBJECT ID="PanScroll1"   
 STYLE="position:absolute;left:60;top:445;width:100;height:10"
 CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D" 
 CODEBASE="http://activex.microsoft.com/controls/mspert10.cab">
    <PARAM NAME="Max" VALUE="10">
	<PARAM NAME="Position" VALUE="5">
    <PARAM NAME="LargeChange" VALUE="2">
    <PARAM NAME="Orientation" VALUE="1">
</OBJECT>

<DIV STYLE="position:absolute; left:95; top:425;width:50%;">
<B>PAN 1</B>
</DIV>

<OBJECT ID="VolScroll2"   
 STYLE="position:absolute;left:240;top:478;width:10;height:90"
 CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D" 
 CODEBASE="http://activex.microsoft.com/controls/mspert10.cab">
    <PARAM NAME="Min" VALUE="0">
    <PARAM NAME="Max" VALUE="10">
	<PARAM NAME="Position" VALUE="10">
    <PARAM NAME="LargeChange" VALUE="2">
    <PARAM NAME="Orientation" VALUE="0">
</OBJECT>

<DIV STYLE="position:absolute; left:210; top:458;width:50%;">
<B>VOLUME 2</B>
</DIV>

<OBJECT ID="PanScroll2"   
 STYLE="position:absolute;left:195;top:445;width:100;height:10"
 CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D" 
 CODEBASE="http://activex.microsoft.com/controls/mspert10.cab">
    <PARAM NAME="Max" VALUE="10">
	<PARAM NAME="Position" VALUE="5">
    <PARAM NAME="LargeChange" VALUE="2">
    <PARAM NAME="Orientation" VALUE="1">
</OBJECT>

<DIV STYLE="position:absolute; left:230; top:425;width:50%;">
<B>PAN 2</B>
</DIV>

<OBJECT ID="VolScroll3"   
 STYLE="position:absolute;left:105;top:632;width:10;height:90"
 CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D" 
 CODEBASE="http://activex.microsoft.com/controls/mspert10.cab">
    <PARAM NAME="Min" VALUE="0">
    <PARAM NAME="Max" VALUE="10">
	<PARAM NAME="Position" VALUE="10">
    <PARAM NAME="LargeChange" VALUE="2">
    <PARAM NAME="Orientation" VALUE="0">
</OBJECT>

<DIV STYLE="position:absolute; left:75; top:613;width:50%;">
<B>VOLUME 3</B>
</DIV>

<OBJECT ID="PanScroll3"   
 STYLE="position:absolute;left:60;top:600;width:100;height:10"
 CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D" 
 CODEBASE="http://activex.microsoft.com/controls/mspert10.cab">
    <PARAM NAME="Min" VALUE="0">
    <PARAM NAME="Max" VALUE="10">
	<PARAM NAME="Position" VALUE="5">
    <PARAM NAME="LargeChange" VALUE="2">
    <PARAM NAME="Orientation" VALUE="1">
</OBJECT>

<DIV STYLE="position:absolute; left:95; top:580;width:50%;">
<B>PAN 3</B>

</DIV>

<OBJECT ID="VolScroll4"   
 STYLE="position:absolute;left:240;top:632;width:10;height:90"
 CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D" 
 CODEBASE="http://activex.microsoft.com/controls/mspert10.cab">
    <PARAM NAME="Min" VALUE="0">
    <PARAM NAME="Max" VALUE="10">
	<PARAM NAME="Position" VALUE="10">
    <PARAM NAME="LargeChange" VALUE="2">
    <PARAM NAME="Orientation" VALUE="0">
</OBJECT>

<DIV STYLE="position:absolute; left:210; top:613;width:50%;">
<B>VOLUME 4</B>
</DIV>

<OBJECT ID="PanScroll4"   
 STYLE="position:absolute;left:195;top:600;width:100;height:10"
 CLASSID="CLSID:DFD181E0-5E2F-11CE-A449-00AA004A803D" 
 CODEBASE="http://activex.microsoft.com/controls/mspert10.cab">
    <PARAM NAME="Min" VALUE="0">
    <PARAM NAME="Max" VALUE="10">
	<PARAM NAME="Position" VALUE="5">
    <PARAM NAME="LargeChange" VALUE="2">
    <PARAM NAME="Orientation" VALUE="1">
</OBJECT>

<DIV STYLE="position:absolute; left:230; top:580;width:50%;">
<B>PAN 4</B>

</DIV>

			</TR>
	
		</TABLE>

					</TD>
		<TD>
			<!-- insert table 1 -->
			<TABLE BORDERCOLOR="#AAAAAA" bgcolor="#FFFFFF" HEIGHT="100%">
				<TR>
					<TD Bgcolor="#DDDDDD" STYLE="border-width:1; border-style:solid; padding-left:5; padding-right:5">
						<CENTER><H3><A NAME="Sound_Demo" IDX_CONCEPT="noindex; Sound Demo; Demo, sound">Sound</A></H3></CENTER>
						Use the controls on the left to set the pan and volume of four different sounds. The JScript code used to generate the 
            animation appears below.

            <SPAN ID="noteTitle" STYLE="text-decoration:underline;" 
            onmouseover='this.style.cursor = "hand"' onclick="toggleNotes()">Show more 
            information.</SPAN><SPAN ID="notes" STYLE="display:none">
<BR><BR>
The sounds in this demo default to zero volume and zero pan. To hear them, increase the volume by pulling the volume slider up.
<p>You can import sound from many audio formats, including WAV, MIDI, and MP2 files, or synthesize sound using built-in synthesizer sound sources. You can mix different sounds even if they originated from files of different audio formats. You can also spatialize sound by embedding sounds in 3-D objects and rendering them with a microphone (<B>DAMicrophone</B>).
	</SPAN>		</TD>
				</TR>
				<TR>
	    			<TD bgcolor="#FFFFFF" VALIGN="top">
					<!-- Display required object code -->
					<SPAN STYLE="font-size:11; font:Courier-New">
					&lt;HTML&gt;<BR>
					&lt;HEAD&gt;<BR>
					&lt;/HEAD&gt;<BR>
					&lt;BODY&gt;<BR>

					&lt;OBJECT ID="DAControl" STYLE="width:300;height:250"<BR>
					CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D"&gt;<BR>
					&lt;/OBJECT&gt;<BR>
          &lt;SCRIPT LANGUAGE="JScript"&gt;<BR>
          &lt;!--<BR>
          m = DAControl.MeterLibrary;<BR><BR>
          mediaBase = "../../../samples/multimedia/media/";<BR>
          soundBase = mediaBase + "sound/";<BR><BR>
		  rawSnd1 = m.ImportSound(soundBase + "16b_mn_11_01.wav").Sound.Loop();<BR>
		  rawSnd2 = m.ImportSound(soundBase + "16b_mn_11_02.wav").Sound.Loop();<BR>
          rawSnd3 = m.ImportSound(soundBase + "16b_mn_11_03.wav").Sound.Loop();<BR>
          rawSnd4 = m.ImportSound(soundBase + "16b_mn_11_04.wav").Sound.Loop();<BR><BR>
          finalSnd = m.MixArray(new Array(rawSnd1.Pan(<B><SPAN id="Sound1Pan"></SPAN></B>).Gain(<B><SPAN id="Sound1Gain"></SPAN></B>), 
		  rawSnd2.Pan(<B><SPAN id="Sound2Pan"></SPAN></B>).Gain(<B><SPAN id="Sound2Gain"></SPAN></B>),
		  rawSnd3.Pan(<B><SPAN id="Sound3Pan"></SPAN></B>).Gain(<B><SPAN id="Sound3Gain"></SPAN></B>), 
		  rawSnd4.Pan(<B><SPAN id="Sound4Pan"></SPAN></B>).Gain(<B><SPAN id="Sound4Gain"></SPAN></B>)));<BR><BR>
		  oscillatingNumber = m.Sin(m.LocalTime);<BR>
          txtCol = m.ColorHslAnim(m.Abs(oscillatingNumber), m.DANumber(0.5), m.DANumber(0.5));<BR>
          fontStyle = m.Font("Arial",-18, txtCol );<BR>
		  sndImg =  m.StringImage("DirectAnimation Sound", fontStyle);<BR><BR>
          DAControl.Image = m.Overlay(sndImg, m.SolidColorImage(m.Black));<BR>
          DAControl.Sound = finalSnd;<BR>
          DAControl.Start();<BR>
          --&gt;<BR>
          &lt;/SCRIPT&gt;<BR>
					&lt;/BODY&gt;<BR>
					&lt;/HTML&gt;<BR>
					</SPAN>
					</TD>
				</TR>
	
				
	
			</TABLE>
		</TD>
	</TR>
</TABLE>
<!-- END_PAGE_FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>