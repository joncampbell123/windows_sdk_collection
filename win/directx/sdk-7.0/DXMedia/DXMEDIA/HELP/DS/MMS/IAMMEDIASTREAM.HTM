<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IAMMediaStream Interface</TITLE>
<SCRIPT> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IAMMediaStream Interface">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IAMMediaStream"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMMediaStream Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMMediaStream Interface"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="MMS_ref.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="MMS_ref.htm">Multimedia Streaming Reference</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IAMMultiMediaStream.htm">IAMMultiMediaStream Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">
<!-- CONTENTS_START -->


<H1>IAMMediaStream Interface</H1>

<P>The <B>IAMMediaStream</B> interface handles the internal connections between DirectShow <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> and <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graphs</A> in applications that use multimedia streaming. This enables applications to automatically negotiate the transfer and conversion of data from the source to the application without having to write code to handle the connection, transfer of data, data conversion, and actual data rendering or file storage. This provides a uniform and predictable method of data access and control.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>This interface isn't intended for implementation by application developers.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>This interface isn't intended for use by application developers.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../ref/iface/IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Retrieves pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="../ref/iface/IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="../ref/iface/IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR></TABLE>

<TABLE>
<TR><TH>IAMMediaStream methods</TH><TH>Description</TH></TR>

<TR><TD><A HREF="IAMMediaStream.htm#Initialize">Initialize</A>
 </TD><TD>Creates and initializes a new media stream with the specified stream type and purpose ID.
</TD></TR><TR><TD><A HREF="IAMMediaStream.htm#SetState">SetState</A>
 </TD><TD>Sets the filter state.
</TD></TR><TR><TD><A HREF="IAMMediaStream.htm#JoinAMMultiMediaStream">JoinAMMultiMediaStream</A>
 </TD><TD>The <A HREF="IAMMultiMediaStream.htm#AddMediaStream">IAMMultiMediaStream::AddMediaStream</A> method calls this method, which adds the specified media stream to the current multimedia stream.
</TD></TR><TR><TD><A HREF="IAMMediaStream.htm#JoinFilter">JoinFilter</A>
 </TD><TD>Connects a media stream to a media stream filter in the underlying filter graph.
</TD></TR><TR><TD><A HREF="IAMMediaStream.htm#JoinFilterGraph">JoinFilterGraph</A>
 </TD><TD>Connects a media stream filter to a filter graph.
</TD></TR></TABLE>




<H1><A NAME="Initialize">IAMMediaStream::Initialize</A><HR size=1></H1>
<A HREF="IAMMediaStream.htm">IAMMediaStream Interface</A>

<P>Creates and initializes a new media stream with the specified stream type and purpose ID.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>Initialize</B><B>(</B>
    <B>IUnknown</B> <I>*pSourceObject</I><B>,</B>
    <B>DWORD</B> <I>dwFlags</I><B>,</B>
    <B>REFMSPID</B> <I>PurposeID</I><B>,</B>
    <B>STREAM_TYPE</B> <I>StreamType</I>
    <B>)</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pSourceObject</I>
 </DT><DD>[in] Pointer to an <A HREF="../ref/iface/IUnknown.htm">IUnknown</A> source object.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Value that modifies the media stream's behavior; it is a combination of one or more of the following values.
<TABLE>
<TR><TD>AMMSF_ADDDEFAULTRENDERER
 </TD><TD>Add a default <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A>.
</TD></TR><TR><TD>AMMSF_CREATEPEER
 </TD><TD>Create a peer stream based on the same object as a <I>pStreamObject</I>.
</TD></TR>
<TR><TD>AMMSF_STOPIFNOSAMPLES
 </TD><TD>Terminates the stream if no samples were created or if the last sample is deleted.
</TD></TR>
</TABLE>
</DD><DT><I>PurposeID</I>
 </DT><DD>[in] Purpose ID for the new media stream.
</DD><DT><I>StreamType</I>
 </DT><DD>[in] <A HREF="Data_types_mms.htm#STREAM_TYPE">STREAM_TYPE</A> enumeration value that specifies the new media stream's media type.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns S_OK if successful or E_POINTER if one or more of the required parameters are invalid.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>If <I>dwFlags</I> specifies AMMSF_ADDDEFAULTRENDERER then the default renderer for the given purpose ID is created, if possible. Currently the only default renderer supported is for audio using DirectSound. In this case the <I>pStreamObject</I> parameter must be NULL and any calls to the <A HREF="IMultiMediaStream.htm#GetMediaStream">IMultiMediaStream::GetMediaStream</A> or <A HREF="IMultiMediaStream.htm#EnumMediaStreams">IMultiMediaStream::EnumMediaStreams</A> methods will not recognize the stream.

<P>If <I>dwFlags</I> specifies AMMSF_CREATEPEER, then a media stream is created using <I>pStreamObject</I> and added to the current multimedia stream. The <I>pStreamObject</I> parameter varies depending on the stream type. In general, <I>pStreamObject</I> can point to an <A HREF="IMediaStream.htm">IMediaStream</A> object, in which case a stream with the sample purpose ID and format is created. For <A HREF="../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> streams, it can also be a pointer to an <B>IDirectDraw</B> object.

<P>If <I>dwFlags</I> specifies AMMSF_STOPIFNOSAMPLES, then the stream is terminated. 

<P>If no flags are set, then <I>pStreamObject</I> can be one of the following.
<TABLE>
<TR><TD>An <A HREF="IAMMediaStream.htm">IAMMediaStream</A> object
 </TD><TD>This stream is then added to the streams in the multimedia stream.
</TD></TR><TR><TD>NULL
</TD><TD>In this case a default <A HREF="IMediaStream.htm">IMediaStream</A> object is added to the stream with a default underlying object, if required.
</TD></TR><TR><TD>A pointer to an underlying object
 </TD><TD>This is used to construct default streams. For video streams, this can be an <A HREF="../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> pointer.
</TD></TR></TABLE></BLOCKQUOTE>



<H1><A NAME="JoinAMMultiMediaStream">IAMMediaStream::JoinAMMultiMediaStream</A><HR size=1></H1>
<A HREF="IAMMediaStream.htm">IAMMediaStream Interface</A>

<P>The <A HREF="IAMMultiMediaStream.htm#AddMediaStream">IAMMultiMediaStream::AddMediaStream</A> method calls this method, which adds the specified media stream to the current multimedia stream.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>JoinAMMultiMediaStream</B><B>(</B>
    <B>IAMMultiMediaStream*</B> <I>pAMMultiMediaStream</I>
	    <B>)</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pAMMultiMediaStream</I>
 </DT><DD>[in] Specifies the <A HREF="IAMMultiMediaStream.htm">IAMMultiMediaStream</A> object to add the current media stream to. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns S_OK if successful or MS_E_SAMPLEALLOC if the media stream already has allocated stream samples.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Don't increment the reference count of the supplied multimedia stream because it is already accounted for when created.

<P>Applications should not call this method.</BLOCKQUOTE>



<H1><A NAME="JoinFilter">IAMMediaStream::JoinFilter</A><HR size=1></H1>
<A HREF="IAMMediaStream.htm">IAMMediaStream Interface</A>

<P>Connects a media stream to a media stream filter in the underlying filter graph.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<B>HRESULT</B> <B>JoinFilter</B><B>(</B> <B>)</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns S_OK if successful or E_POINTER if one or more of the required parameters are NULL.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Don't increment the reference count for the specified media stream filter.

<P>Applications should not call this method.</BLOCKQUOTE>



<H1><A NAME="JoinFilterGraph">IAMMediaStream::JoinFilterGraph</A><HR size=1></H1>
<A HREF="IAMMediaStream.htm">IAMMediaStream Interface</A>

<P>Connects a media stream filter to a filter graph.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>JoinFilterGraph</B><B>(</B>
    <B>IFilterGraph*</B> <I>pGraph</I>
	    <B>)</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pGraph</I>
 </DT><DD>[in] Indicates the current media stream filter to add to the specified filter graph.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns S_OK if successful or E_POINTER if one or more of the required parameters are NULL.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Don't increment the reference count of the specified filter graph.

<P>Applications should not call this method.</BLOCKQUOTE>



<H1><A NAME="SetState">IAMMediaStream::SetState</A><HR size=1></H1>
<A HREF="IAMMediaStream.htm">IAMMediaStream Interface</A>

<P>Sets the filter state.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>HRESULT</B> <B>SetState</B><B>(</B>
    <B>FILTER_STATE</B> <I>State</I>
    <B>)</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>State</I>
 </DT><DD>[in] Sets the filter's state, as specified by the <A HREF="../ref/dtypes.htm#FILTER_STATE">FILTER_STATE</A> enumerated type.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns S_OK if successful or E_INVALIDARG if the <I>State</I> parameter is invalid.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Applications should not call this method.</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
