<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IStreamSample Interface</TITLE>
<SCRIPT> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IStreamSample Interface">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IStreamSample"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IStreamSample Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IStreamSample Interface"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="MMS_ref.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IMultiMediaStream.htm">IMultiMediaStream Interface</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="Data_types_mms.htm">Multimedia Streaming Data Types</A>
</PRE></TD></TR></TABLE>
<BLOCKQUOTE CLASS="body">
    
<!-- NAV_LINKS_END -->

<!-- CONTENTS_START -->



<H1>IStreamSample Interface</H1>

<P>The <B>IStreamSample</B> interface provides control over the behavior of stream samples. You can retrieve the media stream that created the sample, set or retrieve sample start and stop times, check the sample's completion status, and perform a developer-specified function on the sample itself.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
    
<P>Implement this interface when you implement a media stream for a new media type. The interface is exposed on sample objects created by media streams.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
    
<P>Use this interface when you want to control data samples created by <A HREF="IMediaStream.htm">IMediaStream</A> or its derived interfaces.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="../ref/iface/IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Retrieves pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="../ref/iface/IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="../ref/iface/IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR></TABLE>

<TABLE>
<TR><TH>IStreamSample methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IStreamSample.htm#GetMediaStream">GetMediaStream</A>
 </TD><TD>Retrieves a pointer to the media stream object that created the current sample.
</TD></TR><TR><TD><A HREF="IStreamSample.htm#GetSampleTimes">GetSampleTimes</A>
 </TD><TD>Retrieves the current sample's start and end times.
</TD></TR><TR><TD><A HREF="IStreamSample.htm#SetSampleTimes">SetSampleTimes</A>
 </TD><TD>Sets the current sample's start and end times.
</TD></TR><TR><TD><A HREF="IStreamSample.htm#Update">Update</A>
 </TD><TD>Performs a synchronous or an asynchronous update on the current sample.
</TD></TR><TR><TD><A HREF="IStreamSample.htm#CompletionStatus">CompletionStatus</A>
 </TD><TD>Retrieves the status of the current sample's latest asynchronous update. If the update isn't complete, you can force it to complete.
</TD></TR></TABLE>



<H1><A NAME="CompletionStatus">IStreamSample::CompletionStatus</A><HR size=1></H1>
<A HREF="IStreamSample.htm">IStreamSample Interface</A>
<P>Retrieves the status of the current sample's latest asynchronous update. If the update isn't complete, you can force it to complete.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>CompletionStatus</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwMilliseconds</I><BR>&nbsp;&nbsp;<B>)</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>dwFlags</I>
 </DT><DD>[in] Value that specifies whether to forcibly complete the update. This value is a combination of one or more of the following flags.
<TABLE>
<TR><TD>COMPSTAT_NOUPDATEOK (0x01)
 </TD><TD>Force the update to complete as soon as possible, even if the sample update isn't yet complete. If the sample is updating and you didn't set the COMPSTAT_WAIT flag, the method returns MS_S_PENDING. If the sample is waiting to be updated, this method removes it from the queue and returns MS_S_NOTUPDATED.
</TD></TR><TR><TD>COMPSTAT_WAIT (0x02)
 </TD><TD>Wait until the sample finishes updating before returning from this method.
</TD></TR><TR><TD>COMPSTAT_ABORT (0x04)
 </TD><TD>Forces the update to complete, even if it's currently updating. This leaves the sample data in an undefined state. Combine this value with the COMPSTAT_WAITFORCOMPLETION flag to ensure that the update canceled.
</TD></TR></TABLE>
</DD><DT><I>dwMilliseconds</I>
 </DT><DD>[in] If the <I>dwFlags</I> parameter is COMPSTAT_WAIT, this value is the number of milliseconds to wait for the update to complete. Specify INFINITE to indicate that you want to wait until the sample updates before this call returns.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_ABORT
 </TD><TD>The update aborted.
</TD></TR><TR><TD>MS_S_ENDOFSTREAM
 </TD><TD>The sample wasn't updated because it reached the end of the stream.
</TD></TR><TR><TD>MS_S_NOUPDATE
 </TD><TD>The update was forcibly completed; the sample was not updated by the stream.
</TD></TR><TR><TD>MS_S_PENDING
 </TD><TD>An asynchronous update is pending.
</TD></TR><TR><TD>S_OK
 </TD><TD>Success.
</TD></TR></TABLE></BLOCKQUOTE>



<H1><A NAME="GetMediaStream">IStreamSample::GetMediaStream</A><HR size=1></H1>
<A HREF="IStreamSample.htm">IStreamSample Interface</A>
<P>Retrieves a pointer to the media stream object that created the current sample.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetMediaStream</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaStream**</B> <I>ppMediaStream</I><BR>&nbsp;&nbsp;<B>)</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>ppMediaStream</I>
 </DT><DD>[in] Address of a pointer to an <A HREF="IMediaStream.htm">IMediaStream</A> interface that will point to the media stream that created the current sample.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns S_OK if successful or E_POINTER if <I>ppMediaStream</I> is invalid.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>If successful, this method increments the reference count of the media stream specified by <I>ppMediaStream</I>.</BLOCKQUOTE>



<H1><A NAME="GetSampleTimes">IStreamSample::GetSampleTimes</A><HR size=1></H1>
<A HREF="IStreamSample.htm">IStreamSample Interface</A>
<P>Retrieves the current sample's start and end times. If the sample is updating, this method returns the times after the update completes.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetSampleTimes</B><B>(</B><BR>&nbsp;&nbsp;<B>STREAM_TIME*</B> <I>pStartTime</I><B>,</B><BR>&nbsp;&nbsp;<B>STREAM_TIME*</B> <I>pEndTime</I><B>,</B><BR>&nbsp;&nbsp;<B>STREAM_TIME*</B> <I>pCurrentTime</I><BR>&nbsp;&nbsp;<B>)</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pStartTime</I>
 </DT><DD>[out] Pointer to a <A HREF="Data_types_mms.htm#STREAM_TIME">STREAM_TIME</A> value that will contain the sample's start time.
</DD><DT><I>pEndTime</I>
 </DT><DD>[out] Pointer to a <A HREF="Data_types_mms.htm#STREAM_TIME">STREAM_TIME</A> value that will contain the sample's end time.
</DD><DT><I>pCurrentTime</I>
 </DT><DD>[out] Pointer to a <A HREF="Data_types_mms.htm#STREAM_TIME">STREAM_TIME</A> value that will contain the media stream's current <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#media_time')">media time</A>.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns S_OK if successful or E_POINTER if one of the parameters is invalid.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For streams that have a clock, the start and end times will be relative to the stream's current time. If the stream doesn't have a clock, the times are media-relative and the current time will be zero.
<P>The <I>pCurrentTime</I> parameter enables you to conveniently track the media stream's current time, so you don't have to call <A HREF="IMultiMediaStream.htm#GetTime">IMultiMediaStream::GetTime</A>. Unlike <A HREF="IMultiMediaStream.htm#GetTime">GetTime</A>, however, this method returns S_OK if the stream doesn't have a clock; <B>GetTime</B> returns S_FALSE. The value assigned to <I>pCurrentTime</I> is the same as the value produced by the following code fragment.

<PRE>
pSample-&gt;GetMediaStream(&amp;pMediaStream);
pMediaStream-&gt;GetMultiMediaStream(&amp;pMultiMediaStream);
pMediaStream-&gt;Release();
pMultiMediaStream-&gt;GetTime(&amp;pCurrentTime);
pMultiMediaStream-&gt;Release();
</PRE></BLOCKQUOTE>



<H1><A NAME="SetSampleTimes">IStreamSample::SetSampleTimes</A><HR size=1></H1>
<A HREF="IStreamSample.htm">IStreamSample Interface</A>
<P>Sets the current sample's start and end times. You can call this method prior to updating the sample.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetSampleTimes</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>STREAM_TIME*</B> <I>pStartTime</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>STREAM_TIME*</B> <I>pEndTime</I><BR>&nbsp;&nbsp;<B>)</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pStartTime</I>
 </DT><DD>[in] Pointer to a <A HREF="Data_types_mms.htm#STREAM_TIME">STREAM_TIME</A> value that contains the sample's new start time.
</DD><DT><I>pEndTime</I>
 </DT><DD>[in] Pointer to a <A HREF="Data_types_mms.htm#STREAM_TIME">STREAM_TIME</A> value that contains the sample's new end time.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns S_OK if successful or E_POINTER if one of the parameters is NULL.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For streams that have a clock, the times must be relative to the stream's current time. If the stream doesn't have a clock, the times should be relative to the media.

<P>This method applies only to writable streams.</BLOCKQUOTE>



<H1><A NAME="Update">IStreamSample::Update</A><HR size=1></H1>
<A HREF="IStreamSample.htm">IStreamSample Interface</A>
<P>Performs a synchronous or an asynchronous update on the current sample.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>Update</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>HANDLE</B> <I>hEvent</I><B>,</B><BR>&nbsp;&nbsp;<B>PAPCFUNC</B> <I>pfnAPC</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwAPCData</I><BR>&nbsp;&nbsp;<B>)</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>dwFlags</I>
 </DT><DD>[in] Flag that specifies whether the update is synchronous or asynchronous. The SSUPDATE_ASYNC flag specifies an asynchronous update, which you can set if both <I>hEvent</I> and <I>pfnAPC</I> are NULL. Use SSUPDATE_CONTINUOUS to continuously update the sample until you call the <A HREF="IStreamSample.htm#CompletionStatus">IStreamSample::CompletionStatus</A> method.
</DD><DT><I>hEvent</I>
 </DT><DD>[in] Handle to an event that this method will trigger when the update is complete.
</DD><DT><I>pfnAPC</I>
 </DT><DD>[in] Pointer to a Win32 asynchronous procedure call (APC) function that this method will call after it completes the sample update.
</DD><DT><I>dwAPCData</I>
 </DT><DD>[in] Value that this method passes to the function specified by the <I>pfnAPC</I> parameter.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_ABORT
 </TD><TD>The update aborted.
</TD></TR><TR><TD>E_INVALIDARG
 </TD><TD>One of the parameters is invalid.
</TD></TR><TR><TD>E_POINTER
 </TD><TD>One of the parameters is invalid.
</TD></TR><TR><TD>MS_E_BUSY
 </TD><TD>This sample already has a pending update.
</TD></TR><TR><TD>MS_S_ENDOFSTREAM
 </TD><TD>Reached the end of the stream; the sample wasn't updated.
</TD></TR><TR><TD>MS_S_PENDING
 </TD><TD>The asynchronous update is pending.
</TD></TR><TR><TD>S_OK
 </TD><TD>Success.
</TD></TR></TABLE></BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This method can be used to perform a synchronous or asynchronous update of a sample. If both <I>hEvent</I> and <I>pfnAPC</I> are NULL then the update will be synchronous unless either of the SSUPDATE_ASYNC or SSUPDATE_CONTINUOUS flags is specified. When a synchronous update returns, the result of the function contains the I/O completion status.

<P>You can't specify values for both <I>hEvent</I> and <I>pfnAPC</I>; the method will fail. 

<P>Asynchronous updates might complete before the update returns; in that case, the return value is S_OK. If you specify an event and the update returns S_OK, this method sets the event on return. If you specify an APC function and the update returns S_OK, the APC will not be queued and the function will not be called.

<P>Asynchronous updates that don't complete prior to returning will return a value of MS_S_PENDING.

<P>Applications that create multiple streams must read from each of them to avoid having their data blocked.</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
