<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IMediaControl Object</TITLE>
<SCRIPT> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IMediaControl Object">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IMediaControl_Object"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaControl Object"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaControl Object"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="VB_Object_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IFilterInfo_Object.htm">IFilterInfo Object</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IMediaEvent_Object.htm">IMediaEvent Object</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IMediaControl Object</H1>

<P>The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A> exposes the <A HREF="../ref/iface/IMediaControl.htm#IMediaControl">IMediaControl</A> object to allow applications to 
control the streaming of media through the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> in the graph. The interface provides methods 
for running, pausing, and stopping the streaming of data. It also provides 
applications with a simple method that builds graphs to play back media files. 
 
<A NAME="Properties"></A><P CLASS="ref">Properties</P>
<BLOCKQUOTE><TABLE CLASS="ref">
<TR><TD><A HREF="IMediaControl_Object.htm#IMediaControl_FilterCollection">FilterCollection</A>
 </TD><TD>Retrieves a collection of <A HREF="IFilterInfo_Object.htm">IFilterInfo</A> objects representing the 
current filters in the graph. 
</TD></TR><TR><TD><A HREF="IMediaControl_Object.htm#IMediaControl_RegFilterCollection">RegFilterCollection</A>
 </TD><TD>Retrieves a collection of <A HREF="IRegFilterInfo_Object.htm">IRegFilterInfo</A> objects representing the 
filters available in the registry. 
</TD></TR></TABLE></BLOCKQUOTE>

<A NAME="Methods"></A><P CLASS="ref">Methods</P>
<BLOCKQUOTE><TABLE CLASS="ref">
<TR><TD><A HREF="IMediaControl_Object.htm#IMediaControl_AddSourceFilter">AddSourceFilter</A>
 </TD><TD>Adds to the graph the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#source_filter')">source filter</A> that can read the given file name. 
</TD></TR><TR><TD><A HREF="IMediaControl_Object.htm#IMediaControl_GetState">GetState</A>
 </TD><TD>Retrieves the state of the filter graph. 
</TD></TR><TR><TD><A HREF="IMediaControl_Object.htm#IMediaControl_Pause">Pause</A>
 </TD><TD>Pauses all filters in the filter graph. 
</TD></TR><TR><TD><A HREF="IMediaControl_Object.htm#IMediaControl_RenderFile">RenderFile</A>
 </TD><TD>Adds and connects all filters needed to play the specified file. 
</TD></TR><TR><TD><A HREF="IMediaControl_Object.htm#IMediaControl_Run">Run</A>
 </TD><TD>Switches the entire filter graph into run mode. 
</TD></TR><TR><TD><A HREF="IMediaControl_Object.htm#IMediaControl_Stop">Stop</A>
 </TD><TD>Switches all filters in the filter graph to a stopped state. 
</TD></TR></TABLE></BLOCKQUOTE>

<H1><A NAME="IMediaControl_AddSourceFilter">AddSourceFilter Method (IMediaControl Object)</A><HR SIZE=1></H1>
<A HREF="IMediaControl_Object.htm">IMediaControl Object</A>
<P>Adds the source filter that can read the given file name to the graph 
and returns the created <A HREF="IFilterInfo_Object.htm">IFilterInfo</A> object. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaControl</I><B>.AddSourceFilter</B> <I>string</I><B>,</B> <I>objFilterInfo</I> <BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an <A HREF="IMediaControl_Object.htm">IMediaControl</A> object. 
</DD><DT><I>string</I> 
 </DT><DD>Name of the file containing the source media. 
</DD><DT><I>objFilterInfo</I> 
 </DT><DD><A HREF="IFilterInfo_Object.htm">IFilterInfo</A> object; the source filter created for the specified source file. 
</DD></DL></BLOCKQUOTE>
<H1><A NAME="IMediaControl_FilterCollection">FilterCollection Property (IMediaControl Object)</A><HR SIZE=1></H1>
<A HREF="IMediaControl_Object.htm">IMediaControl Object</A>
<P>Retrieves a collection of <A HREF="IFilterInfo_Object.htm">IFilterInfo</A> objects representing the 
filters in the graph. Returns an <A HREF="IAMCollection_Object.htm">IAMCollection</A> object. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><B>Set</B> <I>objCollection</I> <B>=</B> <I>objMediaControl</I><B>.FilterCollection</B><BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objCollection</I> 
 </DT><DD><A HREF="IAMCollection_Object.htm">IAMCollection</A> object that represents the collection of filters currently present in the filter graph. 
</DD><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaControl_Object.htm">IMediaControl</A> object. 
 
</DD></DL></BLOCKQUOTE>
<H1><A NAME="IMediaControl_GetState">GetState Method (IMediaControl Object)</A><HR SIZE=1></H1>
<A HREF="IMediaControl_Object.htm">IMediaControl Object</A>
<P>Returns a <A HREF="../appendixes/Further_Reading.htm#Long">Long</A> integer indicating the current state value.
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaControl</I><B>.GetState</B> <I>msTimeout</I><B>,</B> <I>State</I><BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an <A HREF="IMediaControl_Object.htm">IMediaControl</A> object. 
</DD><DT><I>msTimeout</I> 
 </DT><DD>Duration of the time-out, in milliseconds.
</DD><DT><I>State</I>
 </DT><DD><A HREF="../appendixes/Further_Reading.htm#Long">Long</A> value that will contain the current state. This argument will be one of the following:
<TABLE CLASS="ref">
<TR><TD>State_Paused
 </TD><TD>The media source is paused.
</TD></TR><TR><TD>State_Running
 </TD><TD>The media source is running.
</TD></TR><TR><TD>State_Stopped
 </TD><TD>The media source is stopped.
</TD></TR></TABLE>
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns run-time error 567 if the state transition is not complete, or 0 if it completed successfully.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Not all state transitions are synchronous. For example, even though the <A HREF="IMediaControl_Object.htm#IMediaControl_Pause">Pause</A> method returns immediately, the graph typically does not complete the transition into paused mode until data is ready at the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A>. This method will not return zero until the state transition has been completed.

<P>If you specify a nonzero time-out, the method waits up to that number of milliseconds for the graph to leave the intermediate state. If the time-out expires before the state transition is complete, the return code will be 567, and the returned state will be the state into which the graph is transitioning (either State_Stopped, State_Paused, or State_Running).</BLOCKQUOTE>


<H1><A NAME="IMediaControl_RegFilterCollection">RegFilterCollection Property (IMediaControl Object)</A><HR SIZE=1></H1>
<A HREF="IMediaControl_Object.htm">IMediaControl Object</A>
<P>Retrieves a collection of <A HREF="IRegFilterInfo_Object.htm">IRegFilterInfo</A> objects representing the 
filters available in the registry. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><B>Set</B> <I>objCollection</I> <B>=</B> <I>objMediaControl</I><B>.RegFilterCollection</B><BR>
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objCollection</I> 
 </DT><DD><A HREF="IAMCollection_Object.htm">IAMCollection</A> object that contains <A HREF="IRegFilterInfo_Object.htm">IRegFilterInfo</A> objects. 
</DD><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an <A HREF="IMediaControl_Object.htm">IMediaControl</A> object. 
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="IAMCollection_Object.htm">IAMCollection</A> object.</BLOCKQUOTE>
 
 
 

<H1><A NAME="IMediaControl_Pause">Pause Method (IMediaControl Object)</A><HR SIZE=1></H1>
<A HREF="IMediaControl_Object.htm">IMediaControl Object</A>
<P>Pauses all the filters in the filter graph. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaControl</I><B>.Pause</B> <BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaControl_Object.htm">IMediaControl</A> object. 
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>In the paused state, filters process data but do not render it. Data is pushed down the filter
graph and is processed by <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#transform_filter')">transform filters</A> as far as buffering permits. No data is rendered (except 
that media types capable of being rendered statically, such as video, have a static, poster frame 
rendered in paused mode). Therefore, putting a filter graph into a paused state cues the graph 
for immediate rendering when put into a running state.</BLOCKQUOTE> 
<H1><A NAME="IMediaControl_RenderFile">RenderFile Method (IMediaControl Object)</A><HR SIZE=1></H1>
<A HREF="IMediaControl_Object.htm">IMediaControl Object</A>
<P>Adds and connects filters needed to play the specified file. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaControl</I><B>.RenderFile</B> <I>string</I><BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaControl_Object.htm">IMediaControl</A> object. 
</DD><DT><I>string</I> 
 </DT><DD>Name of the file to render. 
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This method allows an application to pass the name of a media file that it wants rendered
to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A>. The filter graph manager will build a graph of the 
filters that are needed to play back this file.</BLOCKQUOTE> 
<H1><A NAME="IMediaControl_Run">Run Method (IMediaControl Object)</A><HR SIZE=1></H1>
<A HREF="IMediaControl_Object.htm">IMediaControl Object</A>
<P>Switches the entire filter graph into a running state. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaControl</I><B>.Run</B> <BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaControl_Object.htm">IMediaControl</A> object. 
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>If the filter graph is in the stopped state, this method first pauses the graph before running. 
 
<P>If an error value is returned, some filters within the graph might have 
successfully entered the running state. In a multistream graph, entire streams 
might be playing successfully. The application must determine whether 
to stop execution or not. </BLOCKQUOTE>
<H1><A NAME="IMediaControl_Stop">Stop Method (IMediaControl Object)</A><HR SIZE=1></H1>
<A HREF="IMediaControl_Object.htm">IMediaControl Object</A>
<P>Switches all filters in the filter graph to a stopped state. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaControl</I><B>.Stop</B> <BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaControl_Object.htm">IMediaControl</A> object. 
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>In this mode, filters release resources and no data is processed.
If the filters are in a running state, this method pauses them before stopping 
them. This allows video renderers to make a copy of the current frame for poster 
frame display while stopped.</BLOCKQUOTE> 

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
