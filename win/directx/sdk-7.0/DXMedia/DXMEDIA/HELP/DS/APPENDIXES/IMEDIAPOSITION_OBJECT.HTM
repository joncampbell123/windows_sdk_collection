<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IMediaPosition Object</TITLE>
<SCRIPT> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IMediaPosition Object">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IMediaPosition_Object"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaPosition Object"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaPosition Object"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="VB_Object_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IMediaEvent_Object.htm">IMediaEvent Object</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IMediaTypeInfo_Object.htm">IMediaTypeInfo Object</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IMediaPosition Object</H1>

<P>The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A> exposes the <B>IMediaPosition</B> object if any of the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> within the graph are seekable (can seek to an arbitrary position in the stream). Filters will expose 
<B>IMediaPosition</B> if they can seek their data or if they connect to an <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pin</A> that represents a seekable stream. 
 
<P>Applications that communicate with the filter graph can call methods on this interface to set or retrieve properties such as the stream's duration, the start and stop times, the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#preroll_time')">preroll time</A>, the rate, and the current position. The filter graph uses these properties on seekable filters to control the playback of streams within the graph; where there are multiple streams, the filter graph sets them all to play in parallel, beginning at the same position, and will report the duration as being the duration of the longest stream. The 

parameters used in this interface are <A HREF="../appendixes/Further_Reading.htm#double">double</A> values representing a fractional number of seconds. Internally, filters will store time to an accuracy of 100 nanoseconds. 
 
<A NAME="Properties"></A><P CLASS="ref">Properties</P>
<BLOCKQUOTE><TABLE CLASS="ref">
<TR><TD><A HREF="IMediaPosition_Object.htm#IMediaPosition_CurrentPosition">CurrentPosition</A>
 </TD><TD>Retrieves or sets the current position in terms of the total length of the media stream. 
</TD></TR><TR><TD><A HREF="IMediaPosition_Object.htm#IMediaPosition_Duration">Duration</A>
 </TD><TD>Retrieves the total duration of the media stream. 
</TD></TR><TR><TD><A HREF="IMediaPosition_Object.htm#IMediaPosition_PrerollTime">PrerollTime</A> 
 </TD><TD>Retrieves or sets the time prior to the start position at which nonrandom access devices should start rolling. 
</TD></TR><TR><TD><A HREF="IMediaPosition_Object.htm#IMediaPosition_Rate">Rate</A> 
 </TD><TD>Retrieves or sets the playback rate, relative to normal playback of the media stream. 
</TD></TR><TR><TD><A HREF="IMediaPosition_Object.htm#IMediaPosition_StopTime">StopTime</A> 
 </TD><TD>Retrieves or sets the position within the media stream at which playback should stop. 
</TD></TR></TABLE></BLOCKQUOTE>

<A NAME="Methods"></A><P CLASS="ref">Methods</P>
<BLOCKQUOTE><TABLE CLASS="ref">
<TR><TD><A HREF="IMediaPosition_Object.htm#IMediaPosition_CanSeekBackward">CanSeekBackward</A>
 </TD><TD>Retrieves whether or not you can seek backward in the current stream.
</TD></TR><TR><TD><A HREF="IMediaPosition_Object.htm#IMediaPosition_CanSeekForward">CanSeekForward</A>
 </TD><TD>Retrieves whether or not you can seek forward in the current stream.
</TD></TR></TABLE></BLOCKQUOTE>

<H1><A NAME="IMediaPosition_CurrentPosition">CurrentPosition Property (IMediaPosition Object)</A><HR SIZE=1></H1>
<A HREF="IMediaPosition_Object.htm">IMediaPosition Object</A>
<P>Retrieves or sets the current position in terms of the total length of the media stream. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaPosition</I><B>.CurrentPosition</B> [<I>=dblValue</I>]<BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaPosition</I>
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaPosition_Object.htm">IMediaPosition</A> object. 
</DD><DT><I>dblValue</I> 
 </DT><DD>Double value specifying the new current position.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The <B>CurrentPosition</B> property represents the position that playback has reached. 
It is a value between zero and the duration (that is, it has been adjusted for rate and start time). If the graph is paused, this is the position at which it will restart. 
 
<P>This property can also be used to set the start time. When used in this way, 
the current position indicates a position between zero and the duration of the media 
at which playback should begin when the <A HREF="IMediaControl_Object.htm#IMediaControl_Run">Run</A> method is called. 
 
<P>When the filter graph is stopped or paused, this property
returns the position at which playback will recommence. When the 
filter graph is running, the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> returns the position 
according to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_clock')">reference clock</A>. If an individual filter implements this, 
it should return the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#stream_time')">stream time</A> of the sample it is currently processing 
(that is, the offset time from the beginning) when paused or running. 
 
<P>After stopping or pausing, a run command causes playback to begin at 
the current position. This will be where playback stopped or paused, unless 
the application changes the <B>CurrentPosition</B> call in the meantime. 
 
<P>If this method is called when the filter graph manager is running, the filter graph manager 
will pause the graph, run the method, and then issue a new run command. 
 
<P>Setting the current position when paused or stopped causes playback to resume from the 
new start position when the run command is issued. 
 
<P>The current position is applied before the rate and therefore is the position at 
typical playback speed. </BLOCKQUOTE>
<H1><A NAME="IMediaPosition_Duration">Duration Property (IMediaPosition Object)</A><HR SIZE=1></H1>
<A HREF="IMediaPosition_Object.htm">IMediaPosition Object</A>
<P>Retrieves the total duration of the media stream. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaPosition</I><B>.Duration</B> <BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaPosition</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaPosition_Object.htm">IMediaPosition</A> object. 
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The duration assumes normal playback speed, and it is therefore unaffected by the rate. </BLOCKQUOTE>
<H1><A NAME="IMediaPosition_PrerollTime">PrerollTime Property (IMediaPosition Object)</A><HR SIZE=1></H1>
<A HREF="IMediaPosition_Object.htm">IMediaPosition Object</A>
<P>Retrieves or sets the time prior to the start position that devices should start rolling. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaPosition</I><B>.PrerollTime</B> [<B>=</B><I>dblValue</I>] <BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaPosition</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaPosition_Object.htm">IMediaPosition</A> object. 
</DD><DT><I>dblValue</I>
 </DT><DD>Double value for the <B>PrerollTime</B> property.
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Preroll time is the time prior to the start position at which nonrandom access
devices, such as tape players, should start rolling.</BLOCKQUOTE> 
<H1><A NAME="IMediaPosition_Rate">Rate Property (IMediaPosition Object)</A><HR SIZE=1></H1>
<A HREF="IMediaPosition_Object.htm">IMediaPosition Object</A>
<P>Retrieves or sets the playback rate relative to normal playback speed. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaPosition</I><B>.Rate</B> [<B>=</B> <I>dblValue</I>] <BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaPosition</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaPosition_Object.htm">IMediaPosition</A> object. 
</DD><DT><I>dblValue</I>
 </DT><DD>New value for the rate. <B>Double</B>.
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This property allows an application to speed up or slow down playback relative
to the normal default playback speed. A rate of 1.0 indicates normal playback 
speed. Specifying 2.0 causes playback at twice the normal rate: a video 
created for 10 frames per second (fps) will be played back at 20 fps, if resources permit. 
Audio streams played back at above-normal speed increase the pitch rather 
than drop samples. A rate of 0.5 indicates half speed.</BLOCKQUOTE> 
<H1><A NAME="IMediaPosition_StopTime">StopTime Property (IMediaPosition Object)</A><HR SIZE=1></H1>
<A HREF="IMediaPosition_Object.htm">IMediaPosition Object</A>
<P>Retrieves or sets the time at which the media stream stops. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaPosition</I><B>.StopTime</B> [ <B>=</B> <I>dblValue</I>] <BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaPosition</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="IMediaPosition_Object.htm">IMediaPosition</A> object. 
</DD><DT><I>dblValue</I> 
 </DT><DD>New value for the stop time. 
</DD></DL></BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The stop time is a position between zero and the duration of the media
at which playback should stop.
 
<P>The stop position is applied before the rate and therefore is the position at typical playback 
speed. </BLOCKQUOTE> 

<H1><A NAME="IMediaPosition_CanSeekBackward">CanSeekBackward Method (IMediaPosition Object)</A><HR SIZE=1></H1>
<A HREF="IMediaPosition_Object.htm">IMediaPosition Object</A>
<P>Retrieves whether you can seek backward through the current stream.
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaPosition</I><B>.CanSeekBackward</B><BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaPosition</I> 
 </DT><DD>Object expression that evaluates to an <A HREF="IMediaPosition_Object.htm">IMediaPosition</A> object. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The return value is of type Integer. If the value is 0, you cannot seek through the current stream. If the value is &shy;1, you can seek. If you cannot seek through the stream, you can still set the stream's current position with <A HREF="IMediaPosition_Object.htm#IMediaPosition_CurrentPosition">CurrentPosition</A>.

<P>This method can return only &shy;1 (True) with media streams that consist of a single media type, such as a WAV file or video-only MPEG file.</BLOCKQUOTE>


<H1><A NAME="IMediaPosition_CanSeekForward">CanSeekForward Method (IMediaPosition Object)</A><HR SIZE=1></H1>
<A HREF="IMediaPosition_Object.htm">IMediaPosition Object</A>
<P>Retrieves whether you can seek forward through the current stream.
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><P><I>objMediaPosition</I><B>.CanSeekForward</B><BR></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parts</P>
<BLOCKQUOTE><DL><DT><I>objMediaPosition</I> 
 </DT><DD>Object expression that evaluates to an <A HREF="IMediaPosition_Object.htm">IMediaPosition</A> object. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The return value is of type Integer. If the value is 0, you cannot seek through the current stream. If the value is &shy;1, you can seek. If you cannot seek through the stream, you can still set the stream's current position with <A HREF="IMediaPosition_Object.htm#IMediaPosition_CurrentPosition">CurrentPosition</A>.

<P>This method can return only &shy;1 (True) with media streams that consist of a single media type, such as a WAV file or video-only MPEG file.</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
