<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>Windows Media Player Control</TITLE>
<SCRIPT> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="Windows Media Player Control">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="fm_am_cntrl"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="amocx_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="amocx_intro.htm">Windows Media Player Control</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../Oview/Basics_Intro.htm">DirectShow Basics</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1><A NAME="mmp_redist" IDX_CONCEPT="Media Player Control, redistribution; redistribution, Media Player Control; control, Windows Media Player, redistribution">Microsoft Windows Media Player Redistribution Information</A></H1>

<P>The Microsoft&reg; Windows&reg; Media Player installation supports a number of switches and registry settings for your specific installation needs. As a standalone installation, the package normally displays a user interface (UI) and takes over the playback of multimedia file types. Applications that install the Windows&reg; Media Player can override this behavior by setting registry flags and command line switches.</P>

<p>Note: Before distributing any of the Windows Media Player packages you must comply with the License Agreement provided with this SDK. </P>

<p>This document covers the following topics.
<ul>
<li><a href="#MPSwitches">Command Line Switches</a>
<li><a href="#MPRegFlags">Registry Flags</a>
<li><a href="#MPPackages">Microsoft Windows Media Player Packages</a>
</ul>
<h2><a name="MPSwitches">Command Line Switches</a></h2>

<p>All of the Windows Media Player command line switches are optional. If you were to use all the Windows Media Player command line switches to launch the full Media Player package (mpfull) as the following example illustrates, then mpfull would launch with no user interface, without prompting for a reboot, and without taking over most multimedia file types.

<pre>
mpfull /Q:A /R:N /C:&quot;mp2wrap.exe /Quiet /ISVInstall&quot;
</pre>

<P>The Windows Media Player packages support the following Command Line Switches. 
<P><B>/Q:A&#9;&#9;Quiet Switch</B></P>

<P>The /Q:A is the quiet switch. Setting this flag turns off most of the UI. The exception to this would be the prompting of the user for a reboot. If the Windows Media Player requires a reboot, it will prompt the user with a dialog. If you would like to prevent the reboot dialog, simply add the following command line switch <B>/R:N</B>.</P>
<P><B>/R:N &#9;&#9;No Reboot Switch</B></P>
<P>The /R:N will prevent the user from seeing the reboot dialog. This means your application will be responsible for rebooting the user's machine, or prompting for it. If the Windows Media Player requires a reboot, your application must handle it.</P>

<P><B>/C:&quot;mp2wrap  &quot;&#9;&#9;The Command Switch</B></P>
<P>The Command switch allows you to override certain pieces of the Windows Media Player install. The Windows Media Player installer also provides the following support.</P>
<P><B>/Quiet&#9;&#9;Quiet Switch</B></P>

<P>The Quiet Switch will turn off the banner UI displaying which piece of the package is being installed. This switch is turned on automatically if you use the <B>/Q</B> switch on the MPFull package.</P>

<P><B>/ISVInstall&#9;&#9;Extension Take Over</B></P>
<P>The default behavior for the Windows Media Player packages is to take over various file extensions. As an application, you might wish to over-ride that behavior. To do so, simply add the /ISVInstall switch to the MP2Wrap installer. When the switch is used, only the following extensions will be taken over: ASF, ASX, LSX and LSF. Note: the registration of the Indeo 5.0 codecs might cause the Windows Media Player to take over the IVF file types. Please also note that the Windows Media Player registers itself for the ActiveMovie, Netshow, and Windows Media Player CLSIDs. Therefore in situations where the CLSID is used to play back a file, the Windows Media Player will still be called. </P>

<h2><a name="MPRegFlags">Registry Flags</A></h2>

<h3>Turning off the Windows Media Player URL</h3>
<P>If you do not wish to display the Windows Media Player URL at the end of setup, you can change this behavior through a registry setting. By adding a registry key to the user's machine prior to setup execution, you can prevent the Windows Media Player from displaying a URL or point the default URL to your own web site. Note: The Windows Media Player will remove this setting upon completion of setup, so you must set this registry key every time you install.</P>


<pre>
HKLM\Software\Microsoft\MediaPlayer\Setup, &quot;URLAtCompletion&quot;, &quot;[No|&lt;url&gt;]&quot;
</pre>

<P>If &quot;URLAtCompletion&quot; is set to &quot;no&quot;, the Windows Media Player will not launch a web page at the end of setup. If the &quot;URLAtCompletion&quot; is set to a Web page such as &quot;<U>http://www.microsoft.com</U>&quot; the Web page will be launched at the end of setup. Note: if the user must reboot their system on install, the Windows Media Player setup will not launch the Web page.</P>

<h3><P>Preventing users from uninstalling the Windows Media Player</h3>
<P>If your application depends on the Windows Media Player being installed, it is very important that you prevent users from accidentally uninstalling the Windows Media Player. To prevent users from uninstalling the Windows Media Player your setup program should add the following key to the registry.</P>

<pre>
HKEY_LOCAL_MACHINE, &quot;Software\Microsoft\MediaPlayer\DependentComponents&quot;, &quot;<I>&lt;Application Name&gt;</I>&quot;
</pre>

<p>where &quot;<I>&lt;Application Name&gt;</I>&quot; is a unique string indicating the name of your application.

<P>Once you have set this flag, the user will be warned before allowing the Windows Media Player uninstall to continue. If this flag is set, when the user chooses to uninstall, the Windows Media Player setup will not remove the files, but will restore the registry such that the Windows Media Player is no longer the default player. For compatibility reasons, the Windows Media Player will still own the CLSID for ActiveMovie, NetShow and the Windows Media Player. When your application uninstalls, it is important for your application to remove the &quot;<I>&lt;Application Name&gt;</I>&quot; entry it placed in the registry. 

<p>Do not remove the DependentComponents key itself, or you might break other applications.</P>

<h2><a name="MPPackages">Microsoft Windows Media Player Packages</a></h2>

<P>The Windows Media Player comes in six different packages. Review this document carefully to determine which package is appropriate for your application. </P>

<ul>
<li>mpfull.exe
<li>mpstd.exe
<li>mpmin.exe
<li>mpie4ful.exe
<li>mpie4std
<li>mpie4min.exe
</ul>

<P>Three of the packages are designed only for installation on machines on which Internet Explore 4.01 or greater is already installed. If your application is designed to use the Windows Media Player and Internet Explorer 4.01, and your target machine will have Windows 98, Windows 95 with Internet Explorer 4.01, or any future version of Windows, then you should use one of the following packages: MPIE4Ful.exe, MPIE4Std.exe, or MPIE4Min.exe.</P>
<P>These packages are smaller because they do not contain necessary Internet Explorer support files nor do they include the Netscape Plug-in.</P>
<P>The other 3 packages are designed for installations on systems lacking Internet Explorer 4.01 or later.</P>

<h3><P>Package Locations</P></h3>
<P>These Microsoft Windows Media Player packages are located under the redist\x86\MPlayer and redist\alpha\MPlayer subdirectories of this SDK. If you acquired this SDK via download from the Web, these packages require a separate download. See the download instructions on the download site for more information.</P>

<P>The packages that do not require Internet Explorer 4.0 are located in the following subdirectory.</P>

<pre>
redist\&lt;processor&gt;\MPlayer\&lt;lang&gt;\non-IE4
</pre>

<P>The packages that rely on Internet Explorer 4.0 are located in the following subdirectory.</P>

<pre>
redist\&lt;processor&gt;\MPlayer\&lt;lang&gt;\IE4orLaterRequired
</pre>

<P>Where &lt;processor&gt; is x86 or alpha and &lt;lang&gt; is the language of choice for example, English.</P>

<h3><P>Package Detail</P></h3>

<P><b>mpfull.exe&#9;(4.1 MB)</b></P>

<ul>
<li>For Windows 95, Windows 98, and Windows NT 4.0.
<li>Includes plug-in support for Netscape browsers.
<li>Includes support for use with NetShow Theater Server.
<li>Includes support for RealNetworks version 4.0 (or lower) content.
<li>Includes full codec package.
</ul>

<P><B>mpstd.exe&#9;(3.7 MB)&#9;</B></P>

<ul>
<li>For Windows 95, Windows 98, and Windows NT 4.0.
<li>Includes plug-in support for Netscape browsers.
<li>Includes support for use with NetShow Theater Server.
<li>Includes support for RealNetworks version 4.0 (or lower) content.
<li>Includes core codec package and RealNetworks related codecs.
</ul>

<P><B>mpmin.exe&#9;(3.3 MB)</B></P>

<ul>
<li>For Windows 95, Windows 98, and Windows NT 4.0.
<li>Includes plug-in support for Netscape browsers.
<li>Includes support for use with NetShow Theater Server.
<li>Includes support for RealNetworks version 4.0 (or lower) content.
<li>Includes RealNetworks related codecs.
</ul>

<P><B>mpie4ful.exe&#9;(2.4 MB)&#9;</B></P>

<ul>
<li>For Windows 95, Windows 98, and Windows NT 4.0 machines that  have Internet Explorer 4.0 loaded.
<li>Does NOT include plug-in support for Netscape browsers.
<li>Does NOT include support for NetShow Theater Server.
<li>Includes support for RealNetworks version 4.0 (or lower) content.
<li>Includes full codec package.
</ul>

<P><B>mpie4std.exe&#9;(1.2 MB)&#9;</B></P>

<ul>
<li>For Windows 95, Windows 98, and Windows NT 4.0 machines that  have Internet Explorer 4.0 loaded.
<li>Does NOT include plug-in support for Netscape browsers.
<li>Does NOT include support for NetShow Theater Server.
<li>Support for RealNetworks version 4.0 (or lower) content requires an additional download.
<li>Includes core codec package.
</ul>

<P><B>mpie4min.exe&#9;(1.1 MB)&#9;</B></P>

<ul>
<li>For Windows 95, Windows 98, and Windows NT 4.0 machines that  have Internet Explorer 4.0 loaded.
<li>Does NOT include plug-in support for Netscape browsers.
<li>Does NOT include support for NetShow Theater Server.
<li>Support for RealNetworks version 4.0 (or lower) content requires an additional download.
<li>Includes no codecs.
</ul>

<p><B>Codec Packages</B></p>

<P><B>Core Codec Package</B></P>

<ul>
<li>ACELP.net Audio Decoder
<li>ClearVideo Decoder
<li>MPEG Layer-3 Audio Decoder
<li>Lernout &amp; Hauspie
<li>Microsoft MPEG-4 Video Decoder
<li>Voxware MetaSound V2.0 VCT Plug-in
<li>Voxware MetaSound Audio Decoder
</ul>

<P><B>Full Codec Package (Core Codec Package plus the list below)</B></P>

<ul>
<li>ClearVideo&reg; Decompression Filter
<li>Voxware MetaVoice Plug-In
<li>Voxware MetaVoice Audio Decoder
<li>TrueMotion 2.0 Decompressor
<li>VDOnet Video Codecs
<li>Vivo Audio Decompressor Filter
<li>Vivo Video Decompressor Filter
</ul>

<P><B>Auto-Codec Download</B></P>
<P>The Windows Media Player provides an automatic codec download feature. When the Windows Media Player determines that a particular codec is needed to play a piece of content and that codec does not exist on the machine, this feature allows codecs to be automatically downloaded from the web. This feature is useful when the full codec package is not installed and the machine has Web access.</P>
<P>Note: Codec download only works for machines on which Internet Explorer 3.02 or above is installed.</P>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<BR><A HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>