<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CCmdQueue Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CCmdQueue Class">
<META NAME="Description" CONTENT="CCmdQueue (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::CCmdQueue">
<META NAME="Description" CONTENT="CheckTime (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::CheckTime">
<META NAME="Description" CONTENT="EndRun (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::EndRun">
<META NAME="Description" CONTENT="GetCommandDueFor (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::GetCommandDueFor">
<META NAME="Description" CONTENT="GetDueCommand (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::GetDueCommand">
<META NAME="Description" CONTENT="GetDueHandle (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::GetDueHandle">
<META NAME="Description" CONTENT="Insert (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::Insert">
<META NAME="Description" CONTENT="New (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::New">
<META NAME="Description" CONTENT="Remove (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::Remove">
<META NAME="Description" CONTENT="Run (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::Run">
<META NAME="Description" CONTENT="SetSyncSource (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::SetSyncSource">
<META NAME="Description" CONTENT="SetTimeAdvise (CCmdQueue)">
<META NAME="Description" CONTENT="CCmdQueue::SetTimeAdvise">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CCmdQueue"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CCmdQueue Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CCmdQueue Class"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CBasicAudio.htm">CBasicAudio Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CCritSec.htm">CCritSec Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CCmdQueue Class</H1>

<P><IMG SRC="../../art/cutil12.gif" WIDTH="179" HEIGHT="24" ALT="CCmdQueue class hierarchy">

<P>The <B>CCmdQueue</B> class is a base class that provides a queue of <A HREF="CDeferredCommand.htm">CDeferredCommand</A> objects and member functions to add, remove, check status, and invoke the queued commands. A <B>CCmdQueue</B> object is a part of an object that
implements <A HREF="../iface/IQueueCommand.htm">IQueueCommand</A> methods. The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> implements <B>IQueueCommand</B> methods so that applications can queue commands to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A>.
<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">Filters</A> that implement the <B>IQueueCommand</B> interface directly use this class. If you want to use <B>CDeferredCommand</B> objects, your queue must be derived from this class.

<P>There are two modes of synchronization: coarse and accurate. In coarse mode, the application waits until a specified time arrives and then executes the command. In accurate mode, the application waits until processing begins on the sample that appears at the time, and then executes the command. The filter determines which one it will implement. The filter graph manager always implements coarse mode for commands 
that are queued at the filter graph manager.

<P>If you want coarse synchronization, you probably want to wait until there is a command due, and then execute it. You can do this by calling <A HREF="CCmdQueue.htm#GetDueCommand">CCmdQueue::GetDueCommand</A>. If you have several things to wait for, get the event handle from <A HREF="CCmdQueue.htm#GetDueHandle">CCmdQueue::GetDueHandle</A> and then call
<B>CCmdQueue::GetDueCommand</B> when this is signaled. <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#stream_time')">stream time</A> will advance only between calls to the <A HREF="CCmdQueue.htm#Run">CCmdQueue::Run</A> and <A HREF="CCmdQueue.htm#EndRun">CCmdQueue::EndRun</A> member functions. There is no guarantee that if the handle is set, there will be a command ready. Each time the event is signaled, call the <B>CCmdQueue::GetDueCommand</B> member function (probably with a time-out of zero); this can return E_ABORT if no command is ready.

<P>If you want accurate synchronization, call the <A HREF="CCmdQueue.htm#getCommandDueFor">CCmdQueue::GetCommandDueFor</A> member function and pass the samples you are about to process as a parameter. This returns the following:

<UL><LI>A stream-time command due at or before that stream time.
<LI>A presentation-time command due at or before the presentation of the stream time.
Do this only between the <A HREF="CCmdQueue.htm#Run">CCmdQueue::Run</A> and <A HREF="CCmdQueue.htm#EndRun">CCmdQueue::EndRun</A> member
functions, because outside of this, the mapping from stream time to presentation
time is not known.
<LI>Any presentation-time command due now.
</UL>
<P>If you want accurate synchronization for samples that
might be processed during paused mode, you must use
stream-time commands.

<P>In all cases, commands remain queued until called or canceled. The 
setting and resetting of the event handle is managed entirely by this 
queue object.

<P CLASS="ref"><A NAME="Protected_Data_Membe"></A>Protected Data Members</P>
<TABLE><TR><TD><B><A NAME="m_bRunning">m_bRunning</A></B>
 </TD><TD>Flag for running state; set TRUE when running.
</TD></TR><TR><TD><B><A NAME="m_dwAdvise">m_dwAdvise</A></B>
 </TD><TD><A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#advise')">Advise</A> identifier from the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_clock')">reference clock</A> (zero if no outstanding advise).
</TD></TR><TR><TD><B><A NAME="m_evDue">m_evDue</A></B>
 </TD><TD>Sets the time when any commands are due.
</TD></TR><TR><TD><B><A NAME="m_listPresentation">m_listPresentation</A></B>
 </TD><TD>Stores commands queued in <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#presentation_time')">presentation time</A>.
</TD></TR><TR><TD><B><A NAME="m_listStream">m_listStream</A></B>
 </TD><TD>Stores commands queued in stream time.
</TD></TR><TR><TD><B><A NAME="m_Lock">m_Lock</A></B>
 </TD><TD>Protects access to lists.
</TD></TR><TR><TD><B><A NAME="m_pClock">m_pClock</A></B>
 </TD><TD>Current reference clock.
</TD></TR><TR><TD><B><A NAME="m_StreamTimeOffset">m_StreamTimeOffset</A></B>
 </TD><TD>Contains the stream time offset when <A HREF="CCmdQueue.htm#m_bRunning">m_bRunning</A> is true.
</TD></TR><TR><TD><B><A NAME="m_tCurrentAdvise">m_tCurrentAdvise</A></B>
 </TD><TD>Advise time is for this presentation time.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Member_Functions"></A>Member Functions</P>

<TABLE><TR><TD><A HREF="CCmdQueue.htm#CCmdQueue_CCmdQueue">CCmdQueue</A>
 </TD><TD>Constructs a <A HREF="CCmdQueue.htm">CCmdQueue</A> object.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#CheckTime">CheckTime</A>
 </TD><TD>Determines if a given time is due.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#GetDueHandle">GetDueHandle</A>
 </TD><TD>Returns the event handle that will be signaled.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Overridable_Member_F"></A>Overridable Member Functions</P>

<TABLE><TR><TD><A HREF="CCmdQueue.htm#EndRun">EndRun</A>
 </TD><TD>Switches to stopped or paused mode.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#getCommandDueFor">GetCommandDueFor</A>
 </TD><TD>Returns a pointer to a command that will be due for a given time.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#GetDueCommand">GetDueCommand</A>
 </TD><TD>Returns a pointer to the next command that is due.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#Insert">Insert</A>
 </TD><TD>Adds the <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object to the queue.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#New">New</A>
 </TD><TD>Initializes a command to be run and returns a new <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#Remove">Remove</A>
 </TD><TD>Removes the <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object from the queue.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#Run">Run</A>
 </TD><TD>Switches to running mode.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#SetSyncSource">SetSyncSource</A>
 </TD><TD>Sets the clock used for timing.
</TD></TR><TR><TD><A HREF="CCmdQueue.htm#SetTimeAdvise">SetTimeAdvise</A>
 </TD><TD>Creates an advise for the earliest time required.
</TD></TR></TABLE>



<H1><A NAME="CCmdQueue_CCmdQueue">CCmdQueue::CCmdQueue</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Constructs a <A HREF="CCmdQueue.htm">CCmdQueue</A> object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CCmdQueue</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>


<H1><A NAME="CheckTime">CCmdQueue::CheckTime</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Determines if a specified time is due.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>BOOL</B> <B>CheckTime</B><B>(</B><BR>&nbsp;&nbsp;<B>CRefTime</B> <I>time</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bStream</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>time</I>
 </DT><DD>Time to check.
</DD><DT><I>bStream</I>
 </DT><DD>TRUE if the <I>time</I> parameter is a stream-time value; FALSE if <I>time</I> is a 
presentation-time value.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns TRUE if the specified time has not yet passed.

</BLOCKQUOTE>


<H1><A NAME="EndRun">CCmdQueue::EndRun</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Switches to the stopped or paused mode.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>EndRun</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. The <B>HRESULT</B> indicates the error and can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Time mapping between stream time and presentation time is not known after this 
member function has been called. Call the <A HREF="CCmdQueue.htm#Run">CCmdQueue::Run</A> member function to 
carry out this mapping.
</BLOCKQUOTE>


<H1><A NAME="getCommandDueFor">CCmdQueue::GetCommandDueFor</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Returns a deferred command that is scheduled at a specified time.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>GetCommandDueFor</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStream</I><B>,</B><BR>&nbsp;&nbsp;<B>CDeferredCommand</B> <I>**ppCmd</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>tStream</I>
</DT><DD>Time for which the command is scheduled.
</DD><DT><I>ppCmd</I>
</DT><DD>Deferred command to be carried out at the time specified in the <I>tStream</I> parameter.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns <A HREF="../Error_Success_Codes.htm#VFW_E_NOT_FOUND">VFW_E_NOT_FOUND</A> if no commands are due; otherwise, returns S_OK.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function takes a stream time and returns the deferred
command scheduled at that time. The actual stream-time offset
is calculated when the command queue is run. Commands remain queued
until run or canceled. This member function will not block.
</BLOCKQUOTE>


<H1><A NAME="GetDueCommand">CCmdQueue::GetDueCommand</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Returns a pointer to the next command that is due.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>GetDueCommand</B><B>(</B><BR>&nbsp;&nbsp;<B>CDeferredCommand</B> <B>**</B> <I>ppCmd</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>msTimeout</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppCmd</I>
</DT><DD>Pointer to the deferred command.
</DD><DT><I>msTimeout</I>
</DT><DD>Amount of time to wait before carrying out the time-out.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_ABORT if a time-out occurs. Returns S_OK if successful; otherwise,
returns an error.
Returns an object that has been incremented using <A HREF="../iface/IUnknown.htm#AddRef">IUnknown::AddRef</A>.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function blocks until a pending command is due. The member function 
blocks for the amount of time, in milliseconds, specified in the <I>msTimeout</I> parameter.
Stream-time commands become due only between the <A HREF="CCmdQueue.htm#Run">CCmdQueue::Run</A> and
<A HREF="CCmdQueue.htm#EndRun">CCmdQueue::EndRun</A> member functions. The command remains queued until 
run or canceled.
</BLOCKQUOTE>


<H1><A NAME="GetDueHandle">CCmdQueue::GetDueHandle</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Returns the event handle to be signaled.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HANDLE</B> <B>GetDueHandle</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the event handle.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Return the event handle whenever there are deferred commands that are due for execution
(when <A HREF="CCmdQueue.htm#GetDueCommand">CCmdQueue::GetDueCommand</A> will not block).
</BLOCKQUOTE>


<H1><A NAME="Insert">CCmdQueue::Insert</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>The <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object calls this member function to add itself
to the queue.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>Insert</B><B>(</B><BR>&nbsp;&nbsp;<B>CDeferredCommand*</B> <I>pCmd</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCmd</I>
 </DT><DD>Pointer to the <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object to add to the queue.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK in the default implementation.


</BLOCKQUOTE>


<H1><A NAME="New">CCmdQueue::New</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Initializes a command to be run and returns a new <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>New</B><B>(</B><BR>&nbsp;&nbsp;<B>CDeferredCommand</B> <I>**ppCmd</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>time</I><B>,</B><BR>&nbsp;&nbsp;<B>GUID*</B> <I>iid</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dispidMethod</I><B>,</B><BR>&nbsp;&nbsp;<B>short</B> <I>wFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>cArgs</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT*</B> <I>pDispParams</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT*</B> <I>pvarResult</I><B>,</B><BR>&nbsp;&nbsp;<B>short*</B> <I>puArgErr</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bStream</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppCmd</I>
 </DT><DD><A HREF="CDeferredCommand.htm">CDeferredCommand</A> object by which an application can cancel the command, 
set a new presentation time for it, or retrieve estimate information.
</DD><DT><I>pUnk</I>
 </DT><DD>Pointer to the object that will run the command. 
</DD><DT><I>time</I>
 </DT><DD>Time at which to run the queued command or commands.
</DD><DT><I>iid</I>
 </DT><DD>Globally unique identifier (<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#GUID')">GUID</A>) of the interface to call.
</DD><DT><I>dispidMethod</I>
 </DT><DD>Method on the interface to be called.
</DD><DT><I>wFlags</I>
 </DT><DD>Flags describing the context of the call. This parameter supports the same flags as the 
OLE <A HREF="../../appendixes/Further_Reading.htm#IDispatch__Invoke">IDispatch::Invoke</A> method.
</DD><DT><I>cArgs</I>
 </DT><DD>Number of arguments passed. 
</DD><DT><I>pDispParams</I>
 </DT><DD>Pointer to the list of variant types associated with the dispatch parameters.
</DD><DT><I>pvarResult</I>
 </DT><DD>Pointer to the list where results, if any, are to be returned. 
</DD><DT><I>puArgErr</I>
 </DT><DD>Index within the <I>pDispParams</I> parameter list where the last error occurred.
</DD><DT><I>bStream</I>
 </DT><DD>TRUE if the <I>time</I> parameter is a stream-time value; FALSE if <I>time</I> is 
a presentation-time value.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if successful. Returns E_OUTOFMEMORY if <I>ppCmd</I> returns from creating the new <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object with a value of NULL. Otherwise, returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> that indicates an error from attempting to create a new <B>CDeferredCommand</B> object. If there is an error, no object has been queued.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The new <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object will be initialized with
the parameters and will be added to the queue during construction. This method is similar to the 
OLE <A HREF="../../appendixes/Further_Reading.htm#IDispatch__Invoke">IDispatch::Invoke</A> method.

<P>Values for the <I>wFlags</I> parameter include the following:
<TABLE>
<TR><TD>DISPATCH_METHOD
 </TD><TD>The member is being run as a method. If a property has the
same name, both this and the DISPATCH_PROPERTYGET flag can be set.
</TD></TR><TR><TD>DISPATCH_PROPERTYGET
 </TD><TD>The member is being retrieved as a property or data member.
</TD></TR><TR><TD>DISPATCH_PROPERTYPUT
 </TD><TD>The member is being changed as a property or data member.
</TD></TR><TR><TD>DISPATCH_PROPERTYPUTREF
 </TD><TD>The member is being changed via a reference assignment, rather than a value assignment. 
This value is valid only when the property accepts a reference to an object.
</TD></TR></TABLE>
</BLOCKQUOTE>


<H1><A NAME="Remove">CCmdQueue::Remove</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>The <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object calls this member function to remove itself
from the queue.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>Remove</B><B>(</B><BR>&nbsp;&nbsp;<B>CDeferredCommand*</B> <I>pCmd</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCmd</I>
 </DT><DD>Pointer to the <A HREF="CDeferredCommand.htm">CDeferredCommand</A> object to remove from the queue.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns VFW_E_NOT_FOUND if the object is not found in the queue. Otherwise, returns S_OK.


</BLOCKQUOTE>


<H1><A NAME="Run">CCmdQueue::Run</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Switches to running mode so that commands that are deferred by the stream time can be run.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>Run</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStreamTimeOffset</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>tStreamTimeOffset</I>
</DT><DD>Offset time.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK in the default implementation.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>During running mode, stream-time-to-presentation-time mapping is known.
</BLOCKQUOTE>


<H1><A NAME="SetSyncSource">CCmdQueue::SetSyncSource</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Sets the clock used for timing.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>SetSyncSource</B><B>(</B><BR>&nbsp;&nbsp;<B>IReferenceClock*</B> <I>pIrc</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pIrc</I>
</DT><DD>Pointer to the <A HREF="../iface/IReferenceClock.htm">IReferenceClock</A> interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK in the default implementation.


</BLOCKQUOTE>


<H1><A NAME="SetTimeAdvise">CCmdQueue::SetTimeAdvise</A><HR size=1></H1>
<A HREF="CCmdQueue.htm">CCmdQueue Class</A>
<P>Sets up a timer event with the reference clock.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>SetTimeAdvise</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function calls the <A HREF="../iface/IReferenceClock.htm#AdviseTime">IReferenceClock::AdviseTime</A>
method to set up a notification for the earliest time required in the
queue. Presentation-time commands that are deferred are always checked. If the
filter graph is in running mode, deferred commands using stream time are
also checked.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
