<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IMediaFilter Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IMediaFilter Interface">
<META NAME="Description" CONTENT="IMediaFilter::GetState">
<META NAME="Description" CONTENT="IMediaFilter::GetSyncSource">
<META NAME="Description" CONTENT="IMediaFilter::Pause">
<META NAME="Description" CONTENT="IMediaFilter::Run">
<META NAME="Description" CONTENT="IMediaFilter::SetSyncSource">
<META NAME="Description" CONTENT="IMediaFilter::Stop">
<META NAME="Description" CONTENT="GetState (IMediaFilter)">
<META NAME="Description" CONTENT="GetSyncSource (IMediaFilter)">
<META NAME="Description" CONTENT="Pause (IMediaFilter)">
<META NAME="Description" CONTENT="Run (IMediaFilter)">
<META NAME="Description" CONTENT="SetSyncSource (IMediaFilter)">
<META NAME="Description" CONTENT="Stop (IMediaFilter)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IMediaFilter"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IMediaEventSink.htm">IMediaEventSink Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IMediaPosition.htm">IMediaPosition Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IMediaFilter Interface</H1>

<P>Multimedia components that provide time-based data expose the <B>IMediaFilter</B>
interface. This interface abstracts an object that processes time-based data streams and
represents a multimedia device (possibly implemented in software). It
controls the active or running state of the object and the synchronization of this
state with other objects in the system.

<P>This interface inherits the <A HREF="../../appendixes/Further_Reading.htm#IPersist">IPersist</A> interface.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P><A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">Methods</A> on this interface should be implemented as part of any <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A>. This is
typically done by using the base class <A HREF="../class/CBaseFilter.htm#CBaseFilter">CBaseFilter</A>, which implements
<A HREF="IBaseFilter.htm">IBaseFilter</A> and <A HREF="IMediaFilter.htm">IMediaFilter</A>.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Because the <A HREF="IMediaFilter.htm">IMediaFilter</A> interface is inherited by the <A HREF="IBaseFilter.htm">IBaseFilter</A> interface,
which adds other necessary methods required to be exported by filters, this
interface is not normally used directly by the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> or other filters.
It can, however, be of use to <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#plug_in_distributor')">plug-in distributors</A>. For example, the filter graph manager internally exports <B>IMediaFilter</B>; its plug-in distributor exports <A HREF="IMediaControl.htm">IMediaControl</A> and calls the 
<B>IMediaFilter</B> methods to implement its own methods.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IMediaFilter methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IMediaFilter.htm#Stop">Stop</A>
</TD><TD>Informs the filter to transition to the new (stopped) state.
</TD></TR><TR><TD><A HREF="IMediaFilter.htm#Pause">Pause</A>
</TD><TD>Informs the filter to transition to the new (paused) state.
</TD></TR><TR><TD><A HREF="IMediaFilter.htm#Run">Run</A>
</TD><TD>Informs the filter to transition to the new (running) state.
</TD></TR><TR><TD><A HREF="IMediaFilter.htm#GetState">GetState</A>
</TD><TD>Determines the state of the filter.
</TD></TR><TR><TD><A HREF="IMediaFilter.htm#SetSyncSource">SetSyncSource</A>
</TD><TD>Identifies the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_clock')">reference clock</A> to which the filter should synchronize activity.
</TD></TR><TR><TD><A HREF="IMediaFilter.htm#GetSyncSource">GetSyncSource</A>
</TD><TD>Retrieves the current reference clock (or NULL if there is no clock).
Passes a time value to synchronize independent streams.
</TD></TR></TABLE>



<H1><A NAME="GetState">IMediaFilter::GetState</A><HR size=1></H1>
<A HREF="IMediaFilter.htm">IMediaFilter Interface</A>
<P>Determines the filter's state.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetState</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwMilliSecsTimeout</I><B>,</B><BR>&nbsp;&nbsp;<B>FILTER_STATE</B> <B>*</B> <I>State</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwMilliSecsTimeout</I>
</DT><DD>[in] Duration of the time-out, in milliseconds. To block indefinitely, pass INFINITE.
</DD><DT><I>State</I>
</DT><DD>[out] Returned state of the filter. States include stopped, paused,
running, or intermediate (in the process of changing).
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if the state is running, paused, or inactive; otherwise,
returns <A HREF="../Error_Success_Codes.htm#VFW_S_STATE_INTERMED">VFW_S_STATE_INTERMEDIATE</A> if the transition is not complete
(the time-out expired). The state returned in the latter case is the one being changed to.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Usually, <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> filters will return <A HREF="../Error_Success_Codes.htm#VFW_S_STATE_INTERMED">VFW_S_STATE_INTERMEDIATE</A> until they receive 
enough data to render at least one sample. In some circumstances, a filter will 
find that it can supply data on all of its output streams. This
condition usually occurs because of unusual or bad data. An example of unusual data 
might be an MPEG slide show, where video frames occur infrequently in the data but audio is 
continuous. In this case, 

a video frame in the video stream might not be found until
a certain spot in the audio stream. If the filter discovers that it cannot complete the 
state change (for this or any other reason), it can return <A HREF="../Error_Success_Codes.htm#VFW_S_CANT_CUE">VFW_S_CANT_CUE</A>. 

<P>When an application calls the filter graph manager's <A HREF="IMediaControl.htm#GetState">IMediaControl::GetState</A> method,
the filter graph manager calls <B>GetState</B> on the filter and
continues to poll. If the filter graph manager receives <A HREF="../Error_Success_Codes.htm#VFW_S_CANT_CUE">VFW_S_CANT_CUE</A> back from the filter, 
it returns this value to the application from its <B>IMediaControl::GetState</B> method. 

</BLOCKQUOTE>


<H1><A NAME="GetSyncSource">IMediaFilter::GetSyncSource</A><HR size=1></H1>
<A HREF="IMediaFilter.htm">IMediaFilter Interface</A>
<P>Retrieves the current reference clock in use by this filter.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetSyncSource</B><B>(</B><BR>&nbsp;&nbsp;<B>IReferenceClock</B> <B>**</B> <I>pClock</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pClock</I>
</DT><DD>[out] Pointer to a reference clock; it will be set to the <A HREF="IReferenceClock.htm">IReferenceClock</A> interface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The returned interface (if it is non-NULL) will have a reference added by the
<A HREF="IUnknown.htm#AddRef">IUnknown::AddRef</A> method. The calling application should release the interface
by calling the <A HREF="IUnknown.htm#Release">IUnknown::Release</A> method when it has finished with the pointer.
</BLOCKQUOTE>


<H1><A NAME="Pause">IMediaFilter::Pause</A><HR size=1></H1>
<A HREF="IMediaFilter.htm">IMediaFilter Interface</A>
<P>Informs the filter to transition to the new state.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Pause</B><B>(</B><B>void</B><B>)</B><B>;</B><BR>
</PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if the transition is complete; otherwise, returns one of the following values.

<TABLE>
<TR><TD><I>Error</I> value </TD><TD>Transition failed.
</TD></TR><TR><TD>S_FALSE </TD><TD>Transition is not complete, but no error has occurred.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The state transition might not be immediate (external mechanical activity
might be involved, for example). The state method might return before the transition has
completed.
</BLOCKQUOTE>


<H1><A NAME="Run">IMediaFilter::Run</A><HR size=1></H1>
<A HREF="IMediaFilter.htm">IMediaFilter Interface</A>
<P>Informs the filter to transition to the new (running) state.
Passes a time value to synchronize independent streams.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Run</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStart</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>tStart</I>
</DT><DD>Time value of the reference clock.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The <I>tStart</I> parameter is the amount to be added to the <A HREF="IMediaSample.htm">IMediaSample</A>
<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#time_stamp')">time stamp</A> to determine the time at which that sample should be rendered according to the
reference clock. That is, it is the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_time')">reference time</A> at which a sample with a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#stream_time')">stream time</A> of
zero should be rendered.

<P>For example, the time value for the beginning of the stream is the time at
which the first sample should appear. If the application restarts from paused mode in
midstream, <I>tStart</I> is the amount of time paused, plus the start time.

<P>The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A> provides this information to its filters. An application
calling the filter graph may pass a start time of zero, in which case the filter
graph calculates a time that will begin as soon as possible. Filter graphs accept zero to mean
as soon as possible; most filters do not.
</BLOCKQUOTE>


<H1><A NAME="SetSyncSource">IMediaFilter::SetSyncSource</A><HR size=1></H1>
<A HREF="IMediaFilter.htm">IMediaFilter Interface</A>
<P>Identifies the reference clock to which the filter should synchronize activity.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetSyncSource</B><B>(</B><BR>&nbsp;&nbsp;<B>IReferenceClock</B> <B>*</B> <I>pClock</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pClock</I>
</DT><DD>[in] Pointer to the <A HREF="IReferenceClock.htm">IReferenceClock</A> interface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method is of most importance to rendering filters and might not apply to other filters.
The <I>pClock</I> parameter can be NULL, meaning that the filter should run as fast as
possible at its current quality settings without any attempt to synchronize. For example, a
filter graph that is doing compression probably runs in this mode. Each filter
takes as long as it needs.
</BLOCKQUOTE>


<H1><A NAME="Stop">IMediaFilter::Stop</A><HR size=1></H1>
<A HREF="IMediaFilter.htm">IMediaFilter Interface</A>
<P>Informs the filter to transition to the new state.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Stop</B><B>(</B><B>void</B><B>)</B><B>;</B><BR>
</PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if the transition is complete; otherwise, returns one of the following values.

<TABLE>
<TR><TD><I>Error</I> value </TD><TD>Transition failed.
</TD></TR><TR><TD>S_FALSE </TD><TD>Transition is not complete, but no error has occurred.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The state transition might not be immediate (external mechanical activity might be involved,
for example). The state functions might return before the transition has completed.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
