<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CBasePropertyPage Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CBasePropertyPage Class">
<META NAME="Description" CONTENT="Activate (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::Activate">
<META NAME="Description" CONTENT="Apply (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::Apply">
<META NAME="Description" CONTENT="CBasePropertyPage (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::CBasePropertyPage">
<META NAME="Description" CONTENT="Deactivate (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::Deactivate">
<META NAME="Description" CONTENT="GetPageInfo (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::GetPageInfo">
<META NAME="Description" CONTENT="Help (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::Help">
<META NAME="Description" CONTENT="IsPageDirty (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::IsPageDirty">
<META NAME="Description" CONTENT="Move (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::Move">
<META NAME="Description" CONTENT="NonDelegatingAddRef (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::NonDelegatingAddRef">
<META NAME="Description" CONTENT="NonDelegatingQueryInterface (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::NonDelegatingQueryInterface">
<META NAME="Description" CONTENT="NonDelegatingRelease (CBasePropertyPage)">
<META NAME="Description" CONTENT="OnActivate (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::OnActivate">
<META NAME="Description" CONTENT="OnApplyChanges (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::OnApplyChanges">
<META NAME="Description" CONTENT="OnConnect (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::OnConnect">
<META NAME="Description" CONTENT="OnDeactivate (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::OnDeactivate">
<META NAME="Description" CONTENT="OnDisconnect (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::OnDisconnect">
<META NAME="Description" CONTENT="OnReceiveMessage (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::OnReceiveMessage">
<META NAME="Description" CONTENT="SetObjects (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::SetObjects">
<META NAME="Description" CONTENT="SetPageSite (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::SetPageSite">
<META NAME="Description" CONTENT="Show (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::Show">
<META NAME="Description" CONTENT="TranslateAccelerator (CBasePropertyPage)">
<META NAME="Description" CONTENT="CBasePropertyPage::TranslateAccelerator">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CBasePropertyPage"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CBasePin.htm">CBasePin Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CBasePropertyPage Class</H1>

<P><IMG SRC="../../art/cprop01.gif" WIDTH="259" HEIGHT="143" ALT="CBasePropertyPage class hierarchy">

<P>Property pages can be implemented on <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> to provide access to custom properties on the filter. This can be useful for developing and debugging the filter, because the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#Filter_Graph_Editor')">Filter Graph Editor</A> displays these property pages. Also, the Microsoft&reg; Windows&reg; Media Player Control queries filters in its underlying <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A> for the property pages they support and exposes them to the user. A good example is the video <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A>, which exposes quality management information (such as frame rate) through a property page.

<P>This class provides the framework for a property page associated with a filter and implements the <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage">IPropertyPage</A> interface. A property page is a Component Object Model (COM) object, which should be created with a resource ID for a dialog box that will be loaded when required. It should also be given a resource ID for a title string when created.

<P>In addition to implementing the <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage">IPropertyPage</A> interface methods, this class provides several virtual member functions that can be overridden and specialized by the derived class (they return NOERROR by default). These virtual member functions are called at specific events, such as when the property page is activated or deactivated, connected or disconnected, when the changes to properties are to be applied, or when messages to the dialog box are received.

<P>A filter exposing custom property pages should also expose the same functionality to an application through a custom interface. Otherwise, an application has no way to control the filter without displaying the property page. For example, the video renderer supports the <A HREF="../iface/IQualProp.htm">IQualProp</A> interface to access the same quality management information. In fact, the renderer property page uses that interface to get the information for its property page. To make it easier for applications to access their custom interfaces, filters should also implement their custom interfaces in a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#plug_in_distributor')">plug-in distributor</A> (PID), which is an object that is aggregated with the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A>. Typically, the PID implements its associated filter's interface by simply passing calls through from the application to the filter interface. 


<P CLASS="ref"><A NAME="Protected_Data_Membe"></A>Protected Data Members</P>
<TABLE><TR><TD><B><A NAME="m_bDirty">m_bDirty</A></B>
 </TD><TD>Flag to determine whether anything has changed.
</TD></TR><TR><TD><B><A NAME="m_DialogId">m_DialogId</A></B>
 </TD><TD>Resource identifier for the dialog box.
</TD></TR><TR><TD><B><A NAME="m_Dlg">m_Dlg</A></B>
 </TD><TD>Dialog box window handle for the property page.
</TD></TR><TR><TD><B><A NAME="CBasePropertyPage::m_hwnd">m_hwnd</A></B>
 </TD><TD>Window handle for the property page.
</TD></TR><TR><TD><B><A NAME="m_pPageSite">m_pPageSite</A></B>
 </TD><TD><A HREF="../../appendixes/Further_Reading.htm#IPropertyPage">IPropertyPage</A> interface pointer used to access the filter's property information.
</TD></TR><TR><TD><B><A NAME="m_TitleId">m_TitleId</A></B>
 </TD><TD>Resource identifier for the property page title.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Member_Functions"></A>Member Functions</P>

<TABLE><TR><TD><A HREF="CBasePropertyPage.htm#CBasePropertyPage_CBasePropertyPage">CBasePropertyPage</A>
 </TD><TD>Constructs a <A HREF="CBasePropertyPage.htm">CBasePropertyPage</A> object.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Overridable_Member_F"></A>Overridable Member Functions</P>

<TABLE><TR><TD><A HREF="CBasePropertyPage.htm#OnActivate">OnActivate</A>
 </TD><TD>Called when the property page is activated.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#OnApplyChanges">OnApplyChanges</A>
 </TD><TD> Called when the user applies changes to the property page.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#OnConnect">OnConnect</A>
 </TD><TD>Called when the property page is connected to the filter.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#OnDeactivate">OnDeactivate</A>
 </TD><TD>Called when the property page is dismissed.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#OnDisconnect">OnDisconnect</A>
 </TD><TD>Called when the property page is disconnected from the owning filter.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#OnReceiveMessage">OnReceiveMessage</A>
 </TD><TD>Called when a message is sent to the property page dialog box window.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Implemented_INonDele"></A>Implemented INonDelegatingUnknown Methods</P>

<TABLE><TR><TD><A HREF="CBasePropertyPage.htm#NonDelegatingAddRef">NonDelegatingAddRef</A>
 </TD><TD>Default implementation increments the owning filter's reference count.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#NonDelegatingQueryInterface">NonDelegatingQueryInterface</A>
 </TD><TD>Called to retrieve <A HREF="CBasePropertyPage.htm">CBasePropertyPage</A> interfaces. Override this member
 function to pass out pointers to any interfaces added by the derived class.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#NonDelegatingRelease">NonDelegatingRelease</A>
 </TD><TD>Default implementation decrements the owning filter's reference count.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_IPropert"></A>Implemented IPropertyPage Methods</P>


<TABLE><TR><TD><A HREF="CBasePropertyPage.htm#Activate">Activate</A>
 </TD><TD>Creates a dialog box window for the property page.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#Apply">Apply</A>
 </TD><TD>Applies current property page values to the underlying object.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#Deactivate">Deactivate</A>
 </TD><TD>Destroys the window created with <A HREF="CBasePropertyPage.htm#Activate">CBasePropertyPage::Activate</A>.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#GetPageInfo">GetPageInfo</A>
 </TD><TD>Returns information about the property page.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#Help">Help</A>
 </TD><TD>Invokes Help in response to user request.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#IsPageDirty">IsPageDirty</A>
 </TD><TD>Indicates whether the property page has changed since activated or since the most recent
call to <A HREF="CBasePropertyPage.htm#Apply">CBasePropertyPage::Apply</A>.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#Move">Move</A>
 </TD><TD>Positions and resizes the property page dialog box within the frame.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#SetObjects">SetObjects</A>
 </TD><TD>Provides the property page with an array of <A HREF="../iface/IUnknown.htm">IUnknown</A> pointers for objects associated
with this property page.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#SetPageSite">SetPageSite</A>
 </TD><TD>Initializes a property page and provides the page with a pointer to the <A HREF="../../appendixes/Further_Reading.htm#IPropertyPageSite">IPropertyPageSite</A> interface through which the property page communicates with the property frame.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#Show">Show</A>
 </TD><TD>Makes the property page dialog box visible or invisible.
</TD></TR><TR><TD><A HREF="CBasePropertyPage.htm#TranslateAccelerator">TranslateAccelerator</A>
 </TD><TD>Provides a pointer to an <A HREF="../../appendixes/Further_Reading.htm#MSG">MSG</A> structure that specifies a keystroke to process.
</TD></TR></TABLE>



<H1><A NAME="Activate">CBasePropertyPage::Activate</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Creates the property page dialog box.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Activate</B><B>(</B><BR>&nbsp;&nbsp;<B>HWND</B> <I>hwndParent</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCRECT</B> <I>prect</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>fModal</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>hwndParent</I>
 </DT><DD>Handle to the parent window of the dialog box.
</DD><DT><I>prect</I>
 </DT><DD>Pointer to the <A HREF="../../appendixes/Further_Reading.htm#RECT">RECT</A> structure that contains the dialog box's screen position.
</DD><DT><I>fModal</I>
 </DT><DD>Value that specifies a modal dialog box if TRUE, or a modeless dialog box if FALSE.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_OUTOFMEMORY if the dialog box creation fails, or E_UNEXPECTED if a property page already exists.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__Activ">IPropertyPage::Active</A> method, which creates a dialog box for the property page (without a frame, caption, system menu, or controls) using <I>hwndParent</I> as the parent window and <I>prect</I> as the positioning rectangle.

<P>The property page maintains the window handle created in this process, which it uses to destroy the dialog box within <A HREF="CBasePropertyPage.htm#Deactivate">CBasePropertyPage::Deactivate</A>.

</BLOCKQUOTE>


<H1><A NAME="Apply">CBasePropertyPage::Apply</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Applies current property page values to the underlying object.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Apply</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_UNEXPECTED if <A HREF="CBasePropertyPage.htm#SetObjects">CBasePropertyPage::SetObjects</A> has not been called or if the <A HREF="CBasePropertyPage.htm#m_pPageSite">m_pPageSite</A> data member has not been initialized with a pointer to the filter's property page.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__Apply">IPropertyPage::Apply</A> method. The object to be changed is provided through a previous call to <A HREF="CBasePropertyPage.htm#SetObjects">CBasePropertyPage::SetObjects</A>. This should be the filter's <A HREF="../iface/IUnknown.htm">IUnknown</A> interface. Therefore, this member function should not fail because of nonexistent interfaces.

<P>This member function sets the <A HREF="CBasePropertyPage.htm#m_bDirty">m_bDirty</A> data member to FALSE and calls the virtual <A HREF="CBasePropertyPage.htm#OnApplyChanges">CBasePropertyPage::OnApplyChanges</A> member function, which should be overridden in the derived class to apply the changes to the properties.

</BLOCKQUOTE>


<H1><A NAME="CBasePropertyPage_CBasePropertyPage">CBasePropertyPage::CBasePropertyPage</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Constructs a <A HREF="CBasePropertyPage.htm">CBasePropertyPage</A> object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CBasePropertyPage</B><B>(</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>DialogId</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>TitleId</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pName</I>
 </DT><DD>Name of the property page object for debugging purposes.
</DD><DT><I>pUnk</I>
 </DT><DD>Pointer to the COM delegating object.
</DD><DT><I>DialogId</I>
 </DT><DD>Resource ID for the dialog box.
</DD><DT><I>TitleId</I>
 </DT><DD>Resource ID for the dialog box title.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This constructor sets the <A HREF="CBasePropertyPage.htm">CBasePropertyPage</A> data members as follows:
<UL><LI><A HREF="CBasePropertyPage.htm#m_DialogId">m_DialogId</A> is set to <I>DialogId</I>.
<LI><A HREF="CBasePropertyPage.htm#m_TitleId">m_TitleId</A> is set to <I>TitleId</I>.
<LI><A HREF="CBasePropertyPage.htm#CBasePropertyPage::m_hwnd">m_hwnd</A> is set to NULL.
<LI><A HREF="CBasePropertyPage.htm#m_Dlg">m_Dlg</A> is set to NULL.
 <LI><A HREF="CBasePropertyPage.htm#m_pPageSite">m_pPageSite</A> is set to NULL.
 <LI><A HREF="CBasePropertyPage.htm#m_bDirty">m_bDirty</A> is set to FALSE.
</UL>
</BLOCKQUOTE>


<H1><A NAME="Deactivate">CBasePropertyPage::Deactivate</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Destroys the window created with <A HREF="CBasePropertyPage.htm#Activate">CBasePropertyPage::Activate</A>.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Deactivate</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_UNEXPECTED if the data member <A HREF="CBasePropertyPage.htm#CBasePropertyPage::m_hwnd">m_hwnd</A> does not contain a window handle for the property page.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__Deact">IPropertyPage::Deactivate</A> method. It calls the virtual <A HREF="CBasePropertyPage.htm#OnDeactivate">CBasePropertyPage::OnDeactivate</A> member function and then destroys the property page dialog box.

</BLOCKQUOTE>


<H1><A NAME="GetPageInfo">CBasePropertyPage::GetPageInfo</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Returns information about the property page.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetPageInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>LPPROPPAGEINFO</B> <I>pPageInfo</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPageInfo</I>
 </DT><DD>Pointer to the caller-allocated <A HREF="../../appendixes/Further_Reading.htm#PROPPAGEINFO">PROPPAGEINFO</A> structure in which the property page stores its page information. All allocations stored in this structure become the caller's responsibility.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_OUTOFMEMORY if the function cannot allocate memory for the property page title.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__GetPa">IPropertyPage::GetPageInfo</A> method. It calls the <A HREF="../utilfunct/Property_Page_Helper.htm#GetDialogSize">GetDialogSize</A> function to obtain the dialog box size and sets it to a default value in case this call fails.
</BLOCKQUOTE>


<H1><A NAME="Help">CBasePropertyPage::Help</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Invokes Help in response to user request.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Help</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpszHelpDir</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpszHelpDir</I>
 </DT><DD>Pointer to the string under the HelpDir key in the property page's CLSID information in the registry. If HelpDir does not exist, this will be the path found in the InProcServer32 entry minus the server file name. 
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_NOTIMPL by default.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__Help">IPropertyPage::Help</A> method, but only as a placeholder. The function does nothing but return E_NOTIMPL.

<P>Calls to this member function must occur between calls to <A HREF="CBasePropertyPage.htm#Activate">CBasePropertyPage::Activate</A> and <A HREF="CBasePropertyPage.htm#Deactivate">CBasePropertyPage::Deactivate</A>.

<P>If the page fails this member function (such as E_NOTIMPL), the frame will attempt to use the <I>pszHelpFile</I> and <I>dwHelpContext</I> <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#field')">fields</A> of the <A HREF="../../appendixes/Further_Reading.htm#PROPPAGEINFO">PROPPAGEINFO</A> structure obtained through <A HREF="CBasePropertyPage.htm#GetPageInfo">CBasePropertyPage::GetPageInfo</A>. Therefore, the derived class should either implement <B>CBasePropertyPage::Help</B> or return Help information through <B>CBasePropertyPage::GetPageInfo</B>.
</BLOCKQUOTE>


<H1><A NAME="IsPageDirty">CBasePropertyPage::IsPageDirty</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Indicates whether the property page has changed since activated or since the most recent call to <A HREF="CBasePropertyPage.htm#Apply">CBasePropertyPage::Apply</A>.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>IsPageDirty</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if the value state of the property page is dirty, that is, it has changed and is different from the state of the objects. Returns S_FALSE if the value state of the page has not changed and is current with that of the objects.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__IsPag">IPropertyPage::IsPageDirty</A> method. It returns the value of the <A HREF="CBasePropertyPage.htm#m_bDirty">m_bDirty</A> data member.

</BLOCKQUOTE>


<H1><A NAME="Move">CBasePropertyPage::Move</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Positions and resizes the property page dialog box within the frame.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Move</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCRECT</B> <I>prect</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>prect</I>
 </DT><DD>Pointer to the <A HREF="../../appendixes/Further_Reading.htm#RECT">RECT</A> structure containing the positioning information for the property page dialog box.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_UNEXPECTED if the <A HREF="CBasePropertyPage.htm#CBasePropertyPage::m_hwnd">m_hwnd</A> data member does not contain a window handle for the property page.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__Move">IPropertyPage::Move</A> method by calling the Microsoft&#174; Win32&#174; <A HREF="../../appendixes/Further_Reading.htm#MoveWindow">MoveWindow</A> function. This member function is called from the <A HREF="CBasePropertyPage.htm#Activate">CBasePropertyPage::Activate</A> member function to position the property page dialog box.

</BLOCKQUOTE>


<H1><A NAME="NonDelegatingAddRef">CBasePropertyPage::NonDelegatingAddRef</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Increments the reference count for an interface.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>ULONG</B> <B>NonDelegatingAddRef</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the object's reference count.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../utilfunct/INonDelegatingUnknown_iface.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingAddRef</A> method. It increments the owning filter's reference count.
</BLOCKQUOTE>


<H1><A NAME="NonDelegatingQueryInterface">CBasePropertyPage::NonDelegatingQueryInterface</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Returns an interface and increments the reference count.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>NonDelegatingQueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <B>**</B> <I>ppv</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>riid</I>
 </DT><DD>Reference identifier.
</DD><DT><I>ppv</I>
 </DT><DD>Pointer to the interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_POINTER if <I>ppv</I> is invalid. Returns NOERROR if the query is successful or E_NOINTERFACE if it is not. 

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../utilfunct/INonDelegatingUnknown_iface.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingQueryInterface</A> method and passes out references to the <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage">IPropertyPage</A> interface. It then calls the <A HREF="CUnknown.htm#NonDelegatingQueryInterface">CUnknown::NonDelegatingQueryInterface</A> base class member function. Override this class to return other interfaces on the object in the derived class.
</BLOCKQUOTE>


<H1><A NAME="NonDelegatingRelease">CBasePropertyPage::NonDelegatingRelease</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Decrements the reference count for an interface.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>ULONG</B> <B>NonDelegatingRelease</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the reference count.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../utilfunct/INonDelegatingUnknown_iface.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingRelease</A> method. It releases a reference count to the owning filter.
</BLOCKQUOTE>


<H1><A NAME="OnActivate">CBasePropertyPage::OnActivate</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Called when the property page is activated.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>OnActivate</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR by default. The overriding member function should return a valid <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called from the <A HREF="CBasePropertyPage.htm#Activate">CBasePropertyPage::Activate</A> member function to notify the derived class when the property page is displayed. Override this member function to initialize values in the dialog box. This can be done by calling the Win32 <A HREF="../../appendixes/Further_Reading.htm#SetDlgItemText">SetDlgItemText</A> function with data member values previously initialized when the property page was connected (in the overridden <A HREF="CBasePropertyPage.htm#OnConnect">CBasePropertyPage::OnConnect</A> member function).

<P>For example, the Vidprop.cpp file in the sample video renderer, SampVid, does this as follows:

<PRE>
// Set the text fields in the property page.

HRESULT CQualityProperties::OnActivate()
{
    SetEditFieldData();
    return NOERROR;
}


// Initialize the property page fields.

void CQualityProperties::SetEditFieldData()
{
    ASSERT(m_pQualProp);
    TCHAR buffer[50];

    wsprintf(buffer,"%d", m_iDropped);
    SendDlgItemMessage(m_Dlg, IDD_QDROPPED, WM_SETTEXT, 0, (DWORD) (LPSTR) buffer);
    wsprintf(buffer,"%d", m_iDrawn);
    SendDlgItemMessage(m_Dlg, IDD_QDRAWN, WM_SETTEXT, 0, (DWORD) (LPSTR) buffer);
    wsprintf(buffer,"%d.%02d", m_iFrameRate/100, m_iFrameRate%100);
    SendDlgItemMessage(m_Dlg, IDD_QAVGFRM, WM_SETTEXT, 0, (DWORD) (LPSTR) buffer);
    wsprintf(buffer,"%d", m_iFrameJitter);
    SendDlgItemMessage(m_Dlg, IDD_QJITTER, WM_SETTEXT, 0, (DWORD) (LPSTR) buffer);
    wsprintf(buffer,"%d", m_iSyncAvg);
    SendDlgItemMessage(m_Dlg, IDD_QSYNCAVG, WM_SETTEXT, 0, (DWORD) (LPSTR) buffer);
    wsprintf(buffer,"%d", m_iSyncDev);
    SendDlgItemMessage(m_Dlg, IDD_QSYNCDEV, WM_SETTEXT, 0, (DWORD) (LPSTR) buffer);
}
</PRE>
</BLOCKQUOTE>


<H1><A NAME="OnApplyChanges">CBasePropertyPage::OnApplyChanges</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Called when the user applies changes to the property page.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>OnApplyChanges</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR by default. The overriding member function should return a valid <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Override this member function if your property page allows users to set property values. When this member function is called, process the changed properties. For example, set appropriate data members in the derived class to the new values, or call methods in the filter to set the properties. The overriding member function is responsible for calling <A HREF="CBasePropertyPage.htm#IsPageDirty">CBasePropertyPage::IsPageDirty</A> to set the <A HREF="CBasePropertyPage.htm#m_bDirty">m_bDirty</A> data member to TRUE if the properties in the object do not reflect those in the property page when this member function
exits.
</BLOCKQUOTE>


<H1><A NAME="OnConnect">CBasePropertyPage::OnConnect</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Called when the property page is connected to the filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>OnConnect</B><B>(</B><BR>&nbsp;&nbsp;<B>IUnknown</B> <I>*pUnknown</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pUnknown</I>
 </DT><DD><A HREF="../iface/IUnknown.htm">IUnknown</A> interface of the filter associated with the property page.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR by default. The overriding member function should return a valid <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called from the <A HREF="CBasePropertyPage.htm#SetObjects">CBasePropertyPage::SetObjects</A> member function with the <I>ppUnk</I> parameter of that member function, which should be the filter's <A HREF="../iface/IUnknown.htm">IUnknown</A> interface. Override this member function to acquire property values to be sent to the property page dialog box later (in <A HREF="CBasePropertyPage.htm#OnActivate">CBasePropertyPage::OnActivate</A>).

<P>The following excerpt from the sample video renderer (SampVid) Vidprop.cpp file illustrates the use of this member function.

<PRE>
// Give us the filter to communicate with.

HRESULT CQualityProperties::OnConnect(IUnknown *pUnknown)
{
    ASSERT(m_pQualProp == NULL);

    // Ask the renderer for its IQualProp interface.

    HRESULT hr = pUnknown-&gt;QueryInterface(IID_IQualProp,(void **)&amp;m_pQualProp);
    if (FAILED(hr)) {
        return E_NOINTERFACE;
    }

    ASSERT(m_pQualProp);

    // Get quality data for the page.

    m_pQualProp-&gt;get_FramesDroppedInRenderer(&amp;m_iDropped);
    m_pQualProp-&gt;get_FramesDrawn(&amp;m_iDrawn);
    m_pQualProp-&gt;get_AvgFrameRate(&amp;m_iFrameRate);
    m_pQualProp-&gt;get_Jitter(&amp;m_iFrameJitter);
    m_pQualProp-&gt;get_AvgSyncOffset(&amp;m_iSyncAvg);
    m_pQualProp-&gt;get_DevSyncOffset(&amp;m_iSyncDev);
    return NOERROR;
}
</PRE>
</BLOCKQUOTE>


<H1><A NAME="OnDeactivate">CBasePropertyPage::OnDeactivate</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Called when the property page is dismissed.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>OnDeactivate</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR by default. The overriding member function should return a valid <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called from the <A HREF="CBasePropertyPage.htm#Deactivate">CBasePropertyPage::Deactivate</A> member function when the user closes the property page. Override this member function to handle any special requirements at that time.
</BLOCKQUOTE>


<H1><A NAME="OnDisconnect">CBasePropertyPage::OnDisconnect</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Called when the property page is disconnected from the owning filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>OnDisconnect</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR by default. The overriding member function should return a valid <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called from the <A HREF="CBasePropertyPage.htm#SetObjects">CBasePropertyPage::SetObjects</A> member function when the property page is disconnected from the filter. Override this member function to handle any special requirements at that time, such as releasing reference counts on underlying property interfaces.

<P>The following example, from the Vidprop.cpp file in the sample video renderer, SampVid, demonstrates an implementation of this member function in a derived class.

<PRE>
// Release any IQualProp interface you have.

HRESULT CQualityProperties::OnDisconnect()
{
    // Release the interface.

    if (m_pQualProp == NULL) {
        return E_UNEXPECTED;
    }

    m_pQualProp-&gt;Release();
    m_pQualProp = NULL;
    return NOERROR;
}

</PRE>
</BLOCKQUOTE>


<H1><A NAME="OnReceiveMessage">CBasePropertyPage::OnReceiveMessage</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Called when a message is sent to the property page dialog box.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>BOOL</B> <B>OnReceiveMessage</B><B>(</B><BR>&nbsp;&nbsp;<B>HWND</B> <I>hwnd</I><B>,</B><BR>&nbsp;&nbsp;<B>UINT</B> <I>uMsg</I><B>,</B><BR>&nbsp;&nbsp;<B>WPARAM</B> <I>wParam</I><B>,</B><BR>&nbsp;&nbsp;<B>LPARAM</B> <I>lParam</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>hwnd</I>
 </DT><DD>Window procedure that received the message.
</DD><DT><I>uMsg</I>
 </DT><DD>Message.
</DD><DT><I>wParam</I>
 </DT><DD>Additional message information. This parameter's content depends on the value of the <I>uMsg</I> parameter.
</DD><DT><I>lParam</I>
 </DT><DD>Additional message information. This parameter's content depends on the value of the <I>uMsg</I> parameter.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>By default, returns the value returned by the Win32 <A HREF="../../appendixes/Further_Reading.htm#DefWindowProc">DefWindowProc</A> function.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The default implementation of this member function calls <A HREF="../../appendixes/Further_Reading.htm#DefWindowProc">DefWindowProc</A> with the supplied parameters. Override this member function for special handling of messages.
</BLOCKQUOTE>


<H1><A NAME="SetObjects">CBasePropertyPage::SetObjects</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Provides the property page with an <A HREF="../iface/IUnknown.htm">IUnknown</A> pointer for objects associated with this property page.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetObjects</B><B>(</B><BR>&nbsp;&nbsp;<B>ULONG</B> <I>cObjects</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>*ppUnk</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>cObjects</I>
 </DT><DD>Number of <A HREF="../iface/IUnknown.htm">IUnknown</A> pointers in the array pointed to by <I>ppUnk</I>. This number should be 1 or 0. If it is 0, the property page must release any pointers previously passed to this method.
</DD><DT><I>ppUnk</I>
 </DT><DD>Pointer to a single <A HREF="../iface/IUnknown.htm">IUnknown</A> interface pointer identifying a unique object affected by the property sheet in which this (and possibly other) property page is displayed. The property page must cache this pointer by calling <A HREF="../iface/IUnknown.htm#AddRef">IUnknown::AddRef</A>.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_POINTER if <I>ppUnk</I> is null, E_UNEXPECTED if <I>cObjects</I> is greater than 1, and otherwise returns the value returned by the <A HREF="CBasePropertyPage.htm#OnConnect">CBasePropertyPage::OnConnect</A> or <A HREF="CBasePropertyPage.htm#OnDisconnect">CBasePropertyPage::OnDisconnect</A>
member function that it calls.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__SetOb">IPropertyPage::SetObjects</A> method. This member function calls the virtual <A HREF="CBasePropertyPage.htm#OnConnect">CBasePropertyPage::OnConnect</A> member function when the <I>cObjects</I> value is 1, or the virtual <A HREF="CBasePropertyPage.htm#OnDisconnect">CBasePropertyPage::OnDisconnect</A> member function when the <I>cObjects</I> value is 0. Override these virtual member functions to acquire (by calling <A HREF="../iface/IUnknown.htm#AddRef">IUnknown::AddRef</A>) or release (by calling <A HREF="../iface/IUnknown.htm#Release">IUnknown::Release</A>) interfaces to which the property page applies.

<P>Note that the caller must provide the property page with this object before calling <A HREF="CBasePropertyPage.htm#Activate">CBasePropertyPage::Activate</A>, and should call <B>CBasePropertyPage::SetObjects</B> with 0-v as the parameter when deactivating the page or when releasing the object entirely.

<P>This member function allows only one object to be associated with the property page.
</BLOCKQUOTE>


<H1><A NAME="SetPageSite">CBasePropertyPage::SetPageSite</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Initializes a property page and provides the page with a pointer to the <A HREF="../../appendixes/Further_Reading.htm#IPropertyPageSite">IPropertyPageSite</A> interface through which the property page communicates with the property frame.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetPageSite</B><B>(</B><BR>&nbsp;&nbsp;<B>LPPROPERTYPAGESITE</B> <I>pPageSite</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPageSite</I>
 </DT><DD>Pointer to the <A HREF="../../appendixes/Further_Reading.htm#IPropertyPageSite">IPropertyPageSite</A> interface of the page site that manages and provides services to this property page within the entire property sheet.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_UNEXPECTED if if the <A HREF="CBasePropertyPage.htm#m_pPageSite">m_pPageSite</A> data member has not been initialized with a pointer to the filter's property page.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__SetPa">IPropertyPage::SetPageSite</A> method. When passed an <A HREF="../../appendixes/Further_Reading.htm#IPropertyPageSite">IPropertyPageSite</A> interface, it reference counts the interface and assigns it to <A HREF="CBasePropertyPage.htm#m_pPageSite">m_pPageSite</A>. When passed a null value, it releases the reference count on the <B>IPropertyPageSite</B> interface.

</BLOCKQUOTE>


<H1><A NAME="Show">CBasePropertyPage::Show</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Makes the property page dialog box visible or invisible. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Show</B><B>(</B><BR>&nbsp;&nbsp;<B>UINT</B> <I>nCmdShow</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>nCmdShow</I>
 </DT><DD>Command describing whether to become visible. Only SW_SHOWNORMAL, SW_SHOW, and SW_HIDE are accepted.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_UNEXPECTED if the data member <A HREF="CBasePropertyPage.htm#CBasePropertyPage::m_hwnd">m_hwnd</A> does not contain a window handle for the property page. Returns E_INVALIDARG if the <I>nCmdShow</I> parameter is not equal to SW_SHOW or SW_SHOWNORMAL (show) or SW_HIDE (hide).

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If the page is made visible, the page should set the focus to itself, specifically to the first property on the page. This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__Show">IPropertyPage::Show</A> method. This is called just before exiting the <A HREF="CBasePropertyPage.htm#Activate">CBasePropertyPage::Activate</A> member function with the <I>nCmdShow</I> SHOW_NORMAL value.

</BLOCKQUOTE>


<H1><A NAME="TranslateAccelerator">CBasePropertyPage::TranslateAccelerator</A><HR size=1></H1>
<A HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<P>Provides a pointer to an <A HREF="../../appendixes/Further_Reading.htm#MSG">MSG</A> structure that specifies a keystroke to process.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>TranslateAccelerator</B><B>(</B><BR>&nbsp;&nbsp;<B>LPMSG</B> <I>lpMsg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpMsg</I>
 </DT><DD>Pointer to the <A HREF="../../appendixes/Further_Reading.htm#MSG">MSG</A> structure describing the keystroke to process.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_NOTIMPL by default.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the COM <A HREF="../../appendixes/Further_Reading.htm#IPropertyPage__Trans">IPropertyPage::TranslateAccelerator</A> method. Calls to this member function must occur after a call to <A HREF="CBasePropertyPage.htm#Activate">CBasePropertyPage::Activate</A> and before the corresponding call to <A HREF="CBasePropertyPage.htm#Deactivate">CBasePropertyPage::Deactivate</A>. Override this member function to implement keyboard accelerators for the property page.


</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
