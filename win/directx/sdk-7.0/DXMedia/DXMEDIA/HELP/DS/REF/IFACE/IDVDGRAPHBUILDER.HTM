<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IDvdGraphBuilder Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IDvdGraphBuilder Interface">
<META NAME="Description" CONTENT="IDvdGraphBuilder::GetDvdInterface">
<META NAME="Description" CONTENT="IDvdGraphBuilder::GetFiltergraph">
<META NAME="Description" CONTENT="IDvdGraphBuilder::RenderDvdVideoVolume">
<META NAME="Description" CONTENT="GetDvdInterface (IDvdGraphBuilder)">
<META NAME="Description" CONTENT="GetFiltergraph (IDvdGraphBuilder)">
<META NAME="Description" CONTENT="RenderDvdVideoVolume (IDvdGraphBuilder)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDvdGraphBuilder"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IDvdControl.htm">IDvdControl Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IDvdInfo.htm">IDvdInfo Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IDvdGraphBuilder Interface</H1>
<P>The <B>IDvdGraphBuilder</B> interface enables you to easily build a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A> for DVD-Video playback. This interface is implemented by the <B>CDvdGraphBuilder</B> COM object, which is part of Qdvd.dll. An application can instantiate this COM object by calling <B>CoCreateInstance</B> on CLSID_DvdGraphBuilder to get back a pointer to the <B>IDvdGraphBuilder</B> interface. The application can then build a DVD-Video playback graph by calling the <A HREF="IDvdGraphBuilder.htm#RenderDvdVideoVolume">RenderDvdVideoVolume</A> method, and thus get access to DVD-specific DirectShow interfaces such as <A HREF="IDvdInfo.htm">IDvdInfo</a> and <A HREF="IDvdControl.htm">IDvdControl</a> as well generic DirectShow interfaces such as <A HREF="IAMLine21Decoder.htm">IAMLine21Decoder</a>, <A HREF="IBasicVideo.htm">IBasicVideo</a>, <A HREF="IVideoWindow.htm">IVideoWindow</a>, and <A HREF="IBasicAudio.htm">IBasicAudio</a> (you only need this interface if an audio <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> is used to render audio). The application can also get a pointer to the filter graph created by calling the <A HREF="IDvdGraphBuilder.htm#RenderDvdVideoVolume">RenderDvdVideoVolume</A> method and then play, stop, or pause on the title. At the end, the application should release all the interfaces acquired through <B>IDvdGraphBuilder</B> methods as well as the <B>IDvdGraphBuilder</B> interface pointer.

<p>Generally, you should not add, remove, connect, disconnect or access individual <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> in the graph created by <A HREF="IDvdGraphBuilder.htm#RenderDvdVideoVolume">IDvdGraphBuilder::RenderDvdVideoVolume</A>, because doing so might confuse the cleanup code. This interface is intended to help develop DVD-Video playback applications easily. If you need a very specific type of graph built for a particular solution, you should build a custom graph rather than use this interface and then change the resulting filter graph.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>Do not implement this interface. DirectShow's DVD-Video graph builder object implements it for you.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Use this interface in your application to build a filter graph for DVD-Video playback.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IDvdGraphBuilder methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IDvdGraphBuilder.htm#GetFiltergraph">GetFiltergraph</A>
 </TD><TD>Retrieves the <A HREF="IGraphBuilder.htm">IGraphBuilder</A> interface for the filter graph used by the DVD-Video graph builder object.
</TD></TR><TR><TD><A HREF="IDvdGraphBuilder.htm#GetDvdInterface">GetDvdInterface</A>
 </TD><TD>Retrieves specific interface pointers in the DVD-Video playback graph to make DVD-Video playback development easier. 
</TD></TR><TR><TD><A HREF="IDvdGraphBuilder.htm#RenderDvdVideoVolume">RenderDvdVideoVolume</A>
 </TD><TD>Completes building a filter graph according to user specifications for playing back a DVD-Video volume.
</TD></TR></TABLE>



<H1><A NAME="GetDvdInterface">IDvdGraphBuilder::GetDvdInterface</A><HR size=1></H1>
<A HREF="IDvdGraphBuilder.htm">IDvdGraphBuilder Interface</A>
<P>Retrieves specific interface pointers in the DVD-Video playback graph to make
DVD-Video playback development easier.
The <A HREF="IMixerPinConfig2.htm">IMixerPinConfig2</A> interface can be retrieved from the first input pin (primary video
stream) of the OverlayMixer in the DVD-Video playback graph using this interface.
The <A HREF="IDDrawExclModeVideo.htm">IDDrawExclModeVideo</A> interface can also be retrieved from the OverlayMixer in the DVD-Video
playback graph. This interface is required to playback video in DirectDraw
exclusive mode (as some games require). Unlike other interfaces, it is not
necessary to build the graph using the <A HREF="IDvdGraphBuilder.htm#RenderDvdVideoVolume">RenderDvdVideoVolume()</A> method before calling
<A HREF="IDvdGraphBuilder.htm#GetDvdInterface">GetDvdInterface()</A>. This interface should be retrieved before using the <A HREF="IDvdGraphBuilder.htm#RenderDvdVideoVolume">RenderDvdVideoVolume()</A> method
to build the graph.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetDvdInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <I>**ppvIF</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> </PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>riid</I>
 </DT><DD>[in] IID of the required interface.
</DD><DT><I>ppvIF</I>
 </DT><DD>[out] Address of a pointer to the retrieved interface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

<P>The current DirectShow implementation return values include the following:
<TABLE>
<TR><TD>E_INVALIDARG </TD><TD>The <I>ppvIF</I> parameter is invalid.
</TD></TR><TR><TD>E_NOINTERFACE </TD><TD>The <I>riid</I> parameter value is not supported.
</TD></TR><TR><TD>VFW_E_DVD_GRAPHNOTREADY </TD><TD>Graph has not been built through the <A HREF="IDvdGraphBuilder.htm#RenderDvdVideoVolume">IDvdGraphBuilder::RenderDvdVideoVolume</A> method before retrieving this interface.
</TD></TR></TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>

<P>You typically use this method to get the <A HREF="IDvdControl.htm">IDvdControl</A> interface to control playback of a DVD-Video volume, or to get the <A HREF="IAMLine21Decoder.htm">IAMLine21Decoder</A> interface to turn closed captioning on and off. You also use this method to get the <A HREF="IDvdInfo.htm">IDvdInfo</a>, <A HREF="IBasicVideo.htm">IBasicVideo</a>, <A HREF="IVideoWindow.htm">IVideoWindow</a>, and <A HREF="IBasicAudio.htm">IBasicAudio</a> interfaces. You only need a pointer to <B>IBasicAudio</B> if an audio renderer is used to render audio..

<P>Remember to release the interface by using the following code when you're done with it:
<PRE>
*ppvIF-&gt;Release();
</PRE>
</BLOCKQUOTE>


<H1><A NAME="GetFiltergraph">IDvdGraphBuilder::GetFiltergraph</A><HR size=1></H1>
<A HREF="IDvdGraphBuilder.htm">IDvdGraphBuilder Interface</A>
<P>Retrieves the <A HREF="IGraphBuilder.htm">IGraphBuilder</A> interface for the filter graph used by the DVD-Video graph builder object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetFiltergraph</B><B>(</B><BR>&nbsp;&nbsp;<B>IGraphBuilder</B> <I>**ppGB</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppGB</I>
 </DT><DD>[out] Address of a pointer to the <A HREF="IGraphBuilder.htm">IGraphBuilder</A> interface that the DVD-Video graph builder object is using.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if <I>ppGB</I> is invalid.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Remember to release the <A HREF="IGraphBuilder.htm">IGraphBuilder</A> interface by using the following code when you're done with it:
<PRE>
*ppGB-&gt;Release();
</PRE>
</BLOCKQUOTE>


<H1><A NAME="RenderDvdVideoVolume">IDvdGraphBuilder::RenderDvdVideoVolume</A><HR size=1></H1>
<A HREF="IDvdGraphBuilder.htm">IDvdGraphBuilder Interface</A>
<P>Completes building a filter graph according to user specifications for playing back a DVD-Video volume.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>RenderDvdVideoVolume</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpcwszPathName</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>AM_DVD_RENDERSTATUS</B> <I>*pStatus</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpcwszPathName</I>
 </DT><DD>[in] Path name for the DVD-Video volume to play. Can be NULL.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Member of the <A HREF="../dtypes.htm#AM_DVD_GRAPH_FLAGS">AM_DVD_GRAPH_FLAGS</A> enumerated data type indicating the type of decoder (hardware or software or a mix of hardware and software) to include in the filter graph. Maximum hardware decoding (<A HREF="../dtypes.htm#AM_DVD_HWDEC_PREFER">AM_DVD_HWDEC_PREFER</A>) is the default.
</DD><DT><I>pStatus</I>
 </DT><DD>[out] Pointer to the retrieved <A HREF="../structs.htm#AM_DVD_RENDERSTATUS">AM_DVD_RENDERSTATUS</A> structure, which returns indication of any failure.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation return values include the following:
<TABLE>
<TR><TD>E_INVALIDARG </TD><TD>The <I>dwFlags</I> parameter specifies conflicting options or <I>pStatus</I> is a bad pointer.
</TD></TR><TR><TD>S_FALSE </TD><TD>Graph has been built, but not perfectly. The <I>pStatus</I> parameter provides details of the problem(s).
</TD></TR><TR><TD>S_OK </TD><TD>Success. Playback graph built successfully, all streams rendered, and the DVD-Video volume was specified or found.
</TD></TR><TR><TD>VFW_E_DVD_DECNOTENOUGH</TD>

<TD><A HREF="../dtypes.htm#AM_DVD_HWDEC_ONLY">AM_DVD_HWDEC_ONLY</A> or <A HREF="../dtypes.htm#AM_DVD_SWDEC_ONLY">AM_DVD_SWDEC_ONLY</A> was specified and there weren't enough hardware or software decoders to decode all streams. 

</TD></TR><TR><TD>VFW_E_DVD_RENDERFAIL</TD><TD>Some basic error occurred in building the graph. Possibilities include the DVD Navigator filter or the video or audio renderer not instantiating, a trivial connection or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> enumeration failing, or none of the streams rendering.
</TD></TR>
</TABLE>
</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The <A HREF="../structs.htm#AM_DVD_RENDERSTATUS">AM_DVD_RENDERSTATUS</A> structure reflects failure codes for this method. Reasons for this method returning S_FALSE include the following: 
<UL><LI>The graph has been completely built, but one of the following is true.
<UL><LI>Overlay mixing doesn't work (application didn't use the AM_DVD_NOVPE flag
and somehow the video stream couldn't be put through the OverlayMixer). In this
case, the application will have enough information to tell the user
that the video won't be visible at all if the video is decoded in software while hardware decoded 
video could be seen only on a TV connected to the NTSC out port of the hardware
video decoder.
<LI>Video decoder doesn't produce line 21 data. The application can put up a warning or informative message that closed captioning is not available because of the decoder.
<LI>No volume path specified and DVD Navigator didn't locate any DVD-Video volume to be played. Application can ask the user to insert a DVD-Video disc, if none is available in the drive when playback is started.
</UL>
<LI>Some streams didn't render or didn't render completely. Volume can be partially played back. The application can indicate to the user that some of the streams can't be played.
</UL>
<P>This method builds the graph without any knowledge of the DVD-Video file or volume to play back. The DVD-Video graph builder builds the graph even if <I>lpcwszPathName</I> is NULL or if the DVD Navigator filter does not find a default DVD-Video volume to play back. An application can later specify the volume by using the <A HREF="IDvdControl.htm#SetRoot">IDvdControl::SetRoot</A> method.
</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
