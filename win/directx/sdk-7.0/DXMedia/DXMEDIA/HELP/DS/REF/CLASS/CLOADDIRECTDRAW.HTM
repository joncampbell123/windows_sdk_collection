<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CLoadDirectDraw Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CLoadDirectDraw Class">
<META NAME="Description" CONTENT="CLoadDirectDraw (CLoadDirectDraw)">
<META NAME="Description" CONTENT="CLoadDirectDraw::CLoadDirectDraw">
<META NAME="Description" CONTENT="GetDirectDraw (CLoadDirectDraw)">
<META NAME="Description" CONTENT="CLoadDirectDraw::GetDirectDraw">
<META NAME="Description" CONTENT="IsDirectDrawLoaded (CLoadDirectDraw)">
<META NAME="Description" CONTENT="CLoadDirectDraw::IsDirectDrawLoaded">
<META NAME="Description" CONTENT="IsDirectDrawVersion1 (CLoadDirectDraw)">
<META NAME="Description" CONTENT="CLoadDirectDraw::IsDirectDrawVersion1">
<META NAME="Description" CONTENT="LoadDirectDraw (CLoadDirectDraw)">
<META NAME="Description" CONTENT="CLoadDirectDraw::LoadDirectDraw">
<META NAME="Description" CONTENT="ReleaseDirectDraw (CLoadDirectDraw)">
<META NAME="Description" CONTENT="CLoadDirectDraw::ReleaseDirectDraw">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CLoadDirectDraw"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CLoadDirectDraw Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CLoadDirectDraw Class"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CImageSample.htm">CImageSample Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CMediaControl.htm">CMediaControl Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CLoadDirectDraw Class</H1>

<P><IMG SRC="../../art/vctl05.gif" WIDTH="179" HEIGHT="25" ALT="CLoadDirectDraw class hierarchy">

<P>Microsoft&reg; DirectShow&#153; must work on multiple platforms; in particular, it also runs on Microsoft Windows NT&reg; 3.51, which does not have DirectDraw&reg; capabilities. The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> therefore cannot link statically to the DirectDraw library. To make the platform dependencies easier to handle, this class manages loading and unloading the library and creating the initial <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.

<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>

<TABLE><TR><TD><A HREF="CLoadDirectDraw.htm#CLoadDirectDraw_CLoadDirectDraw">CLoadDirectDraw</A>
 </TD><TD>Constructs a <A HREF="CLoadDirectDraw.htm">CLoadDirectDraw</A> object.
</TD></TR><TR><TD><A HREF="CLoadDirectDraw.htm#GetDirectDraw">GetDirectDraw</A>
 </TD><TD>Retrieves a pointer to the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.
</TD></TR><TR><TD><A HREF="CLoadDirectDraw.htm#IsDirectDrawLoaded">IsDirectDrawLoaded</A>
 </TD><TD>Verifies that DirectDraw is loaded.
</TD></TR><TR><TD><A HREF="CLoadDirectDraw.htm#IsDirectDrawVersion1">IsDirectDrawVersion1</A>
 </TD><TD>Checks the version of DirectDraw installed on the current system.
</TD></TR><TR><TD><A HREF="CLoadDirectDraw.htm#LoadDirectDraw">LoadDirectDraw</A>
 </TD><TD>Loads and initializes the DirectDraw library.
</TD></TR><TR><TD><A HREF="CLoadDirectDraw.htm#ReleaseDirectDraw">ReleaseDirectDraw</A>
 </TD><TD>Releases the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.
</TD></TR></TABLE>



<H1><A NAME="CLoadDirectDraw_CLoadDirectDraw">CLoadDirectDraw::CLoadDirectDraw</A><HR size=1></H1>
<A HREF="CLoadDirectDraw.htm">CLoadDirectDraw Class</A>
<P>Constructs a <A HREF="CLoadDirectDraw.htm">CLoadDirectDraw</A> object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CLoadDirectDraw</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>


<H1><A NAME="GetDirectDraw">CLoadDirectDraw::GetDirectDraw</A><HR size=1></H1>
<A HREF="CLoadDirectDraw.htm">CLoadDirectDraw Class</A>
<P>Retrieves the DirectDraw interface.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>LPDIRECTDRAW</B> <B>GetDirectDraw</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a pointer to the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Call <A HREF="CLoadDirectDraw.htm#LoadDirectDraw">CLoadDirectDraw::LoadDirectDraw</A> before calling this member function and call the <A HREF="CLoadDirectDraw.htm#ReleaseDirectDraw">CLoadDirectDraw::ReleaseDirectDraw</A> member function to release the interface when you are done.
</BLOCKQUOTE>


<H1><A NAME="IsDirectDrawLoaded">CLoadDirectDraw::IsDirectDrawLoaded</A><HR size=1></H1>
<A HREF="CLoadDirectDraw.htm">CLoadDirectDraw Class</A>
<P>Verifies that this object loaded DirectDraw.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>IsDirectDrawLoaded</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if loaded; otherwise, returns S_FALSE.

</BLOCKQUOTE>


<H1><A NAME="IsDirectDrawVersion1">CLoadDirectDraw::IsDirectDrawVersion1</A><HR size=1></H1>
<A HREF="CLoadDirectDraw.htm">CLoadDirectDraw Class</A>
<P>Checks the version of DirectDraw installed on the current system.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>BOOL</B> <B>IsDirectDrawVersion1</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns TRUE if the installed version of DirectDraw doesn't support the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw2">IDirectDraw2</A> interface, or FALSE if the <A HREF="CAggDirectDraw.htm#m_pDirectDraw">m_pDirectDraw</A> data member is NULL or the installed version of DirectDraw supports <B>IDirectDraw2</B>.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The video <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> must know what the installed version of DirectDraw is to perform certain tasks, such as full-screen playback, which the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw2">IDirectDraw2</A> interface supports.
</BLOCKQUOTE>


<H1><A NAME="LoadDirectDraw">CLoadDirectDraw::LoadDirectDraw</A><HR size=1></H1>
<A HREF="CLoadDirectDraw.htm">CLoadDirectDraw Class</A>
<P>Loads and initializes the DirectDraw library in the specified area.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>LoadDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>LPSTR</B> <I>szDevice</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>szDevice</I>
 </DT><DD>This parameter is optional; if omitted, this method loads DirectDraw to the base drawing area.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if DirectDraw loaded correctly or E_NOINTERFACE otherwise.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>DirectDraw is not always available, so applications can't statically link to the library. Therefore, this member function loads the library, gets the function entry point addresses, and calls them to create the driver objects. Call this member function before calling <A HREF="CLoadDirectDraw.htm#GetDirectDraw">CLoadDirectDraw::GetDirectDraw</A> to retrieve the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.
</BLOCKQUOTE>


<H1><A NAME="ReleaseDirectDraw">CLoadDirectDraw::ReleaseDirectDraw</A><HR size=1></H1>
<A HREF="CLoadDirectDraw.htm">CLoadDirectDraw Class</A>
<P>Releases the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>ReleaseDirectDraw</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called to release any <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface previously loaded. Call this only when all reference counts have been released.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
