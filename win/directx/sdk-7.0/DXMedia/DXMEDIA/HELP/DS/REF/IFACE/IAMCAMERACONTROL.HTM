<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IAMCameraControl Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>

<META NAME="Description" CONTENT="IAMCameraControl Interface">
<META NAME="Description" CONTENT="IAMCameraControl::GetRange">
<META NAME="Description" CONTENT="IAMCameraControl::Set">
<META NAME="Description" CONTENT="IAMCameraControl::Get">
<META NAME="Description" CONTENT="GetRange (IAMCameraControl)">
<META NAME="Description" CONTENT="Set (IAMCameraControl)">
<META NAME="Description" CONTENT="Get (IAMCameraControl)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>
<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IAMCameraControl"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IAMBufferNegotiation.htm">IAMBufferNegotiation Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IAMClockAdjust.htm">IAMClockAdjust Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">
<!-- CONTENTS_START -->


<H1>IAMCameraControl Interface</H1>
<P>The <B>IAMCameraControl</B> interface provides local or remote control over a camera.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>

<P>This interface should be implemented in DirectShow for filters that control camera devices that offer some form of device control such as zoom, pan, aperture adjustment, or shutter speed. Note that WDM capture drivers automatically expose this interface from KsProxy.ax if they support the associated kernel streaming property sets.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>

<P>Applications should use this interface to control device settings such as zoom, pan, aperture adjustment, or shutter speed.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>

<TABLE>
	<TR><TH>IUnknown methods</TH><TH>Description</TH></TR>
	<TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 	</TD><TD>Retrieves pointers to supported interfaces.
 	</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 	</TD><TD>Increments the reference count.
	</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 	</TD><TD>Decrements the reference count.
	</TD></TR><TR></TR>

	<TR><TH>IAMCameraControl methods</TH><TH>Description
 	</TH></TR><TR><TD><A HREF="IAMCameraControl.htm#GetRange">GetRange</A>
 	</TD><TD>Retrieves values associated with the range of a specified camera property.
 	</TD></TR><TR><TD><A HREF="IAMCameraControl.htm#Set">Set</A>
 	</TD><TD>Sets a camera property.
 	</TD></TR><TR><TD><A HREF="IAMCameraControl.htm#Get">Get</A>
 	</TD><TD>Retrieves the value of a specific camera control property.
</TD></TR></TABLE>



<H1><A NAME="Get">IAMCameraControl::Get</A><HR size=1></H1>
<A HREF="IAMCameraControl.htm">IAMCameraControl Interface</A>
<P>Retrieves the value of a specific camera control property.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
	<PRE><P><B>HRESULT</B> <B>Get</B> <B>(</B>
	 <B>long</B> <I>Property</I><B>,</B>
	 <B>long</B> <I>*lValue</I><B>,</B>
	 <B>long</B> <I>*Flags</I>
	<B>);</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
	<DL>
	<DT><I>Property</I></DT><DD>[in] Value that specifies which property from the <A HREF="../dtypes.htm#CameraControlProperty">CameraControlProperty</A> enumerated type to query. </DD>
	<DT><I>lValue</I></DT><DD>[out] Retrieved value of the specified property. See Remarks for a description of the possible ranges and values.</DD>


	<DT><I>Flags</I></DT><DD>[out] Pointer to a value from the <A HREF="../dtypes.htm#CameraControlFlags">CameraControlFlags</A> enumerated type that indicates whether the camera property is automatic or manual.</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
	<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.
<P><B>HRESULT</B> can include one of the following standard constants, or other values not listed.</P> 

	<TABLE>
		<TR><TD>E_FAIL </TD><TD>Failure.</TD></TR>
		<TR><TD>E_INVALIDARG </TD><TD>Argument is invalid.</TD></TR>
		<TR><TD>E_NOTIMPL </TD><TD>Method is not supported.</TD></TR>
		<TR><TD>E_POINTER </TD><TD>Null pointer argument.</TD></TR>
		<TR><TD>S_OK </TD><TD>Success.</TD></TR>
	</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Each property represented from the <B>CameraControlProperty</B> enumerated type can have an automatic or manual setting. If the <I>Flags</I> parameter is set to CameraControl_Flags_Auto from the <B>CameraControlFlags</B> enumerated type, then the <I>lValue</I> parameter is ignored. The <I>lValue</I> range and meaning depends on the property being queried. The following table describes possible values.</P>

<TABLE>
<TR><TH>Property</TH><TH>lValue range and meaning</TH></TR>
<TR><TD>Pan</TD><TD>Value that specifies the pan setting in degrees. Values range from &shy;180 to +180, with the default set to zero. Positive values are clockwise from the origin (the camera rotates clockwise when viewed from above), and negative values are counterclockwise from the origin. Note that a particular device might implement only a subset of this range.</TD></TR>

<TR><TD>Tilt</TD><TD>Value that specifies the tilt setting in degrees. Values range from &shy;180 to +180, with the default set to zero. Positive values point the imaging plane up, and negative values point the imaging plane down. Note that a particular device might implement only a subset of this range.</TD></TR>

<TR><TD>Roll</TD><TD>Value that specifies the roll setting in degrees. Values range from &shy;180 to +180, with the default being set to zero. Positive values cause a clockwise rotation of the camera along the image viewing axis, and negative values cause a counterclockwise rotation of the camera. Note that a particular device may only implement a subset of this range.</TD></TR>

<TR><TD>Zoom</TD><TD>Value that specifies the zoom setting in millimeter units. Values range from 10 to 600, and the default is device specific.</TD></TR>

<TR><TD>Exposure</TD><TD>Value that specifies the exposure setting in seconds, by using the following formula. For values less than zero, the exposure time is 1/2<SUP>n</SUP> seconds. For positive values and zero, the exposure time is 2<SUP>n</SUP> seconds. Note that a particular device might implement only a subset of this range. For example, a device advertises a range of &shy;7 to 1, with stepping set to 1. The corresponding exposure times are:
<table><tr>
<td><B>Value</B></td>
	<td>-7</td>
	<td>-6</td>
	<td>-5</td>
	<td>-4</td>
	<td>-3</td>
	<td>-2</td>
	<td>-1</td>
	<td>0</td>
	<td>1</td>
</tr><tr>
	<td><B>Seconds</B></td>
	<td>1/128</td>
	<td>1/64</td>
	<td>1/32</td>
	<td>1/16</td>
	<td>1/8</td>
	<td>1/4</td>
	<td>1/2</td>
	<td>1</td>
	<td>2</td>
</tr></table>
</TD></TR>

<TR><TD>Iris</TD><TD>Value that specifies the iris setting expressed as f<SUB>stop</SUB> * 10.</TD></TR>

<TR><TD>Focus</TD><TD>Value that specifies the focus setting as the distance to the optimally focused target, in millimeters. The range and default values are device specific. Note that a particular device might implement only a subset of this range.</TD></TR>
</TABLE>
</BLOCKQUOTE>



<H1><A NAME="GetRange">IAMCameraControl::GetRange</A><HR size=1></H1>
<A HREF="IAMCameraControl.htm">IAMCameraControl Interface</A>

<P>Retrieves values associated with the range of a specified camera property.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
	<PRE><P><B>HRESULT GetRange (&nbsp;&nbsp;</B>
	 <B>long</B> <I>property,</I>
	 <B>long</B> <I>*pMin,</I>
	 <B>long</B> <I>*pMax,</I>
	 <B>long</B> <I>*pSteppingDelta,</I>
	 <B>long</B> <I>*pDefault,</I>
	 <B>long</B> <I>*pCapsFlags</I>
	<B>);</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
	<DL>
	<DT><I>property</I></DT>
	<DD>[in] Value that specifies which property from the <A HREF="../dtypes.htm#CameraControlProperty">CameraControlProperty</A> enumerated type to query.</DD>
	<DT><I>pMin</I></DT>
	<DD>[out] Pointer to the minimum range for the specified property.</DD>
	<DT><I>pMax</I></DT>
	<DD>[out] Pointer to the maximum range for the specified property.</DD>
	<DT><I>pSteppingDelta</I></DT>
	<DD>[out] Pointer to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#step_size')">step size</A> for the specified property.</DD>
	<DT><I>pDefault</I></DT>
	<DD>[out] Pointer to the default value of the specified property.</DD>
	<DT><I>pCapsFlags</I></DT>
	<DD>[out] Pointer to a value from the <A HREF="../dtypes.htm#CameraControlFlags">CameraControlFlags</A> enumerated type indicating whether the camera property is automatic or manual.</DD>
	</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
	<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.
	<P><B>HRESULT</B> can include one of the following standard constants, or other values not listed.</P>
	
	<TABLE>
		<TR><TD>E_FAIL</TD><TD>Failure.</TD></TR>
		<TR><TD>E_INVALIDARG</TD><TD>Argument is invalid.</TD></TR>
		<TR><TD>E_NOTIMPL</TD><TD>Method is not supported.</TD></TR>
		<TR><TD>E_POINTER</TD><TD>Null pointer argument.</TD></TR>
		<TR><TD>S_OK</TD><TD>Success.</TD></TR>
	</TABLE>
</BLOCKQUOTE>



<H1><A NAME="Set">IAMCameraControl::Set</A><HR size=1></H1>
<A HREF="IAMCameraControl.htm">IAMCameraControl Interface</A>
<P>Sets the value of a specific camera control property.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
	<PRE><P><B>HRESULT</B> <B>Set</B> <B>(</B>
	 <B>long </B><I>Property</I><B>,</B>
	 <B>long</B><I> lValue</I><B>,</B>
	 <B>long</B><I> Flags</I>
	<B>);</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
	<DL>
	<DT><I>Property</I></DT>
	<DD>[in] Value that specifies which property from the <A HREF="../dtypes.htm#cameracontrolproperty">CameraControlProperty</A> enumerated type to change.</DD>
	<DT><I>lValue</I></DT><DD>[in] New value of the specified property.</DD>
	<DT><I>Flags</I></DT><DD>[in] Value from the <A HREF="../dtypes.htm#CameraControlFlags">CameraControlFlags</A> enumerated type specifying whether the camera property is automatic or manual.</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.
<P><B>HRESULT</B> can include one of the following standard constants, or other values not listed.</P> 

	<TABLE>
		<TR><TD>E_FAIL </TD><TD>Failure.</TD></TR>
		<TR><TD>E_INVALIDARG </TD><TD>Argument is invalid.</TD></TR>
		<TR><TD>E_NOTIMPL </TD><TD>Method is not supported.</TD></TR>
		<TR><TD>E_POINTER </TD><TD>Null pointer argument.</TD></TR>
		<TR><TD>S_OK </TD><TD>Success.</TD></TR>
	</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Each property represented from the <B>CameraControlProperty</B> enumerated type can have an automatic or manual setting. If the <I>Flags</I> parameter is set to CameraControl_Flags_Auto from the <B>CameraControlFlags</B> enumerated type, then the <I>lValue</I> parameter is ignored. The <I>lValue</I> range and meaning depends on the property being queried. The following table describes possible values.</P>

<TABLE>
<TR><TH>Property</TH><TH>lValue range and meaning</TH></TR>
<TR><TD>Pan</TD><TD>Value that specifies the pan setting in degrees. Values range from &shy;180 to +180, with the default set to zero. Positive values are clockwise from the origin (the camera rotates clockwise when viewed from above), and negative values are counterclockwise from the origin. Note that a particular device might implement only a subset of this range.</TD></TR>

<TR><TD>Tilt</TD><TD>Value that specifies the tilt setting in degrees. Values range from &shy;180 to +180, with the default set to zero. Positive values point the imaging plane up, and negative values point the imaging plane down. Note that a particular device might implement only a subset of this range.</TD></TR>

<TR><TD>Roll</TD><TD>Value that specifies the roll setting in degrees. Values range from &shy;180 to +180, with the default being set to zero. Positive values cause a clockwise rotation of the camera along the image viewing axis, and negative values cause a counterclockwise rotation of the camera. Note that a particular device may only implement a subset of this range.</TD></TR>

<TR><TD>Zoom</TD><TD>Value that specifies the zoom setting in millimeter units. Values range from 10 to 600, and the default is device specific.</TD></TR>

<TR><TD>Exposure</TD><TD>Value that specifies the exposure setting in seconds, by using the following formula. For values less than zero, the exposure time is 1/2<SUP>n</SUP> seconds. For positive values and zero, the exposure time is 2<SUP>n</SUP> seconds. Note that a particular device might implement only a subset of this range. For example, a device advertises a range of &shy;7 to 1, with stepping set to 1. The corresponding exposure times are:
<table><tr>
<td><B>Value</B></td>
	<td>-7</td>
	<td>-6</td>
	<td>-5</td>
	<td>-4</td>
	<td>-3</td>
	<td>-2</td>
	<td>-1</td>
	<td>0</td>
	<td>1</td>
</tr><tr>
	<td><B>Seconds</B></td>
	<td>1/128</td>
	<td>1/64</td>
	<td>1/32</td>
	<td>1/16</td>
	<td>1/8</td>
	<td>1/4</td>
	<td>1/2</td>
	<td>1</td>
	<td>2</td>
</tr></table>
</TD></TR>

<TR><TD>Iris</TD><TD>Value that specifies the iris setting expressed as f<SUB>stop</SUB> * 10.</TD></TR>

<TR><TD>Focus</TD><TD>Value that specifies the focus setting as the distance to the optimally focused target, in millimeters. The range and default values are device specific. Note that a particular device might implement only a subset of this range.</TD></TR>
</TABLE>
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>


<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
