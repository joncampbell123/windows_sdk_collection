<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->
<HTML>
<HEAD><TITLE>IMixerPinConfig Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IMixerPinConfig Interface">
<META NAME="Description" CONTENT="IMixerPinConfig::GetAspectRatioMode">
<META NAME="Description" CONTENT="IMixerPinConfig::GetBlendingParameter">
<META NAME="Description" CONTENT="IMixerPinConfig::GetColorKey">
<META NAME="Description" CONTENT="IMixerPinConfig::GetStreamTransparent">
<META NAME="Description" CONTENT="IMixerPinConfig::GetRelativePosition">
<META NAME="Description" CONTENT="IMixerPinConfig::GetZOrder">
<META NAME="Description" CONTENT="IMixerPinConfig::SetAspectRatioMode">
<META NAME="Description" CONTENT="IMixerPinConfig::SetBlendingParameter">
<META NAME="Description" CONTENT="IMixerPinConfig::SetColorKey">
<META NAME="Description" CONTENT="IMixerPinConfig::SetStreamTransparent">
<META NAME="Description" CONTENT="IMixerPinConfig::SetRelativePosition">
<META NAME="Description" CONTENT="IMixerPinConfig::SetZOrder">
<META NAME="Description" CONTENT="GetAspectRatioMode (IMixerPinConfig)">
<META NAME="Description" CONTENT="GetBlendingParameter (IMixerPinConfig)">
<META NAME="Description" CONTENT="GetColorKey (IMixerPinConfig)">
<META NAME="Description" CONTENT="GetStreamTransparent (IMixerPinConfig)">
<META NAME="Description" CONTENT="GetRelativePosition (IMixerPinConfig)">
<META NAME="Description" CONTENT="GetZOrder (IMixerPinConfig)">
<META NAME="Description" CONTENT="SetAspectRatioMode (IMixerPinConfig)">
<META NAME="Description" CONTENT="SetBlendingParameter (IMixerPinConfig)">
<META NAME="Description" CONTENT="SetColorKey (IMixerPinConfig)">
<META NAME="Description" CONTENT="SetStreamTransparent (IMixerPinConfig)">
<META NAME="Description" CONTENT="SetRelativePosition (IMixerPinConfig)">
<META NAME="Description" CONTENT="SetZOrder (IMixerPinConfig)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->

<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->
</SCRIPT>

<!-- SNIFF_END -->

<!-- STYLE_START -->
<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->

</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IMixerPinConfig"></A>

<!-- HEADGRAPH_START -->
<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->
<!-- NAV_LINKS_START -->
<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IMemInputPin.htm">IMemInputPin Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IMixerPinConfig2.htm">IMixerPinConfig2 Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->
<H1>IMixerPinConfig Interface</H1>

<P>The <B>IMixerPinConfig</B> interface is exposed on the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_I.htm#input_pin')">input pins</A> of overlay mixer <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> and contains <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">methods</A> that manipulate video streams in various ways. The overlay mixer filter contains multiple input pins that are dynamically created as video input streams are added. The video stream on the first <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> is known as the <I>primary stream</I> and subsequent streams are known as <I>secondary streams</I>. 

<P>Use this interface to manipulate the parameters involved in mixing various video streams. These parameters include getting and setting position, z-order, blending and transparency levels, aspect ratio correction, and color keys of streams.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>

<P>DirectShow implements this interface on the input pins of overlay mixer filters. Developers should implement this interface when they create filters that mix video streams.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>

<P>Applications use this interface to get and set attributes when mixing multiple video streams.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>

<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Retrieves pointers to supported interfaces.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IMixerPinConfig methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IMixerPinConfig.htm#SetRelativePosition">SetRelativePosition</A>
 </TD><TD>Sets the position of the stream in the display window.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#GetRelativePosition">GetRelativePosition</A>
 </TD><TD>Retrieves the position of the stream in the display window.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#SetZOrder">SetZOrder</A>
 </TD><TD>Sets the z-order of a particular video stream.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#GetZOrder">GetZOrder</A>
 </TD><TD>Retrieves the z-order of a particular video stream.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#SetColorKey">SetColorKey</A>
 </TD><TD>Sets the color key being used by a video stream.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#GetColorKey">GetColorKey</A>
 </TD><TD>Retrieves the color key being used by a video stream.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#SetBlendingParameter">SetBlendingParameter</A>
 </TD><TD>Sets the blending parameter that defines how a secondary stream is blended with a primary stream. 
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#GetBlendingParameter">GetBlendingParameter</A>
 </TD><TD>Retrieves the value of the blending parameter that defines how a secondary stream is blended with a primary stream.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#SetAspectRatioMode">SetAspectRatioMode</A>
 </TD><TD>Sets the aspect ratio correction mode for window resizing.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#GetAspectRatioMode">GetAspectRatioMode</A>
 </TD><TD>Retrieves the aspect ratio correction mode for window resizing.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#SetStreamTransparent">SetStreamTransparent</A>
 </TD><TD>Sets the stream to transparent.
 </TD></TR><TR><TD><A HREF="IMixerPinConfig.htm#GetStreamTransparent">SetStreamTransparent</A>
 </TD><TD>Determines whether a stream is transparent.
</TD></TR></TABLE>

<!--@ *************************************** -->
<H1><A NAME="GetAspectRatioMode">IMixerPinConfig::GetAspectRatioMode</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Retrieves the aspect ratio correction mode for window resizing.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetAspectRatioMode</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_ASPECT_RATIO_MODE*</B> <I>pamAspectRatioMode</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pamAspectRatioMode</I>
 </DT><DD>[out] Pointer to an <A HREF="../dtypes.htm#AM_ASPECT_RATIO_MODE">AM_ASPECT_RATIO_MODE</A> enumerated type member.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. Current DirectShow implementation return values include:
<TABLE>
<TR><TD>E_NOTIMPL </TD><TD>Method called on secondary stream.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Value invalid or NULL.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#SetAspectRatioMode">IMixerPinConfig::SetAspectRatioMode</A>

</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="GetBlendingParameter">IMixerPinConfig::GetBlendingParameter</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Retrieves the value of the blending parameter that defines how a secondary stream is blended with a primary stream. 
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetBlendingParameter</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwBlendingParameter</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pdwBlendingParameter</I>
 </DT><DD>[out] Value between 0 and 255 that indicates the amount of blending between a primary stream and a secondary stream. 
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. Current DirectShow implementation return values include:
<TABLE>
<TR><TD>E_UNEXPECTED </TD><TD>Method called on primary stream.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Value outside of possible range (0-255).
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>A value of zero indicates that the secondary stream is invisible; a value of 255 indicates the primary stream is invisible in the area that the secondary stream occupies.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#SetBlendingParameter">IMixerPinConfig::SetBlendingParameter</A>

</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="GetColorKey">IMixerPinConfig::GetColorKey</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Retrieves the color key being used by a video stream.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetColorKey</B><B>(</B><BR>&nbsp;&nbsp;<B>COLORKEY</B> <I>*pColorKey</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pColor</I> <B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pColorKey</I>
 </DT><DD>[out] Pointer to a <A HREF="../structs.htm#COLORKEY">COLORKEY</A> structure that contains the key type and a palette index. 
</DD><DT><I>pColor</I>
<!--@ WRITER: lee 7.24.98 following line changed -->
 </DT><DD>[out] Value indicating the 8-bit palette index of the <A HREF="../structs.htm#COLORKEY">COLORKEY</A> returned if the current display mode is 8-bit palettized. Otherwise it is a value representing the color key in the pixel format of the current display mode.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. Current DirectShow implementation return values include:
<TABLE>
<TR><TD>E_INVALIDARG </TD><TD>Invalid arguments, both parameters are NULL.
</TD></TR><TR><TD>E_FAIL </TD><TD><B>GetColorKey</B> failed because the color key isn't known.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Getting the value on the primary stream will retrieve the destination color key being used by the overlay surface. Getting this value on the secondary pin returns the color key being used by that particular stream.

<P>Current DirectShow implementation of this interface can return NULL for either the <I>pColorKey</I> or the <I>pColor</I> parameters; however, the method will fail and return E_INVALIDARG if both parameters are NULL.
 
<P><B>Note</B>  The <A HREF="../../appendixes/Further_Reading.htm#DWORD">DWORD</A> value returned by the <I>pColor</I> parameter is the actual color being used. So, if the bit depth of the display is 8, 16, 24, 32 the last 8, 16, 24 or 32 bits of the <B>DWORD</B> specify the actual value of the color key.</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#SetColorKey">IMixerPinConfig::SetColorKey</A>

</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="GetStreamTransparent">IMixerPinConfig::GetStreamTransparent</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Determines whether a stream is transparent.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetStreamTransparent</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>*pbStreamTransparent</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pbStreamTransparent</I>
 </DT><DD>[out] TRUE indicates transparent stream; FALSE indicates not a transparent stream.
 <!--@EDITOR: bj: this should be reworded to something like "Value indicating whether the stream is transparent; TRUE indicates..." -->
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. <B>HRESULT</B> can include one of the following standard constants, or other values not listed. 
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method is not supported.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#SetStreamTransparent">IMixerPinConfig::SetStreamTransparent</A>
</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="GetRelativePosition">IMixerPinConfig::GetRelativePosition</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Retrieves the position of the stream in the display window.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetRelativePosition</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwLeft</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwTop</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwRight</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwBottom</I> <B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<!--@EDITOR: bj: reword param descriptions to start with noun, such as "Value indicating..." -->
<DL><DT><I>pdwLeft</I>
 </DT><DD>[out] Indicates the x-coordinate in the top-left corner of the display window.
</DD><DT><I>pdwTop</I>
 </DT><DD>[out] Indicates the y-coordinate in the top-left corner of the display window.
</DD><DT><I>pdwRight</I>
 </DT><DD>[out] Indicates the x-coordinate in the bottom-right corner of the display window.
</DD><DT><I>pdwBottom</I>
 </DT><DD>[out] Indicates the y-coordinate in the bottom-right corner of the display window.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. Current DirectShow implementation return values include:
<TABLE>
<TR><TD>E_INVALIDARG </TD><TD>Coordinates not in the {0, 0, 10,000, 10,000} range.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method assumes window coordinates of {0, 0, 10,000, 10,000}. If the video stream is being rendered in the bottom right quarter of the display window, this method would return {5,000, 5,000, 10,000, 10,000}.
 
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#SetRelativePosition">IMixerPinConfig::SetRelativePosition</A>
</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="GetZOrder">IMixerPinConfig::GetZOrder</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Retrieves the z-order of a particular video stream.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetZOrder</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwZOrder</I> <B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pdwZOrder</I>
 </DT><DD>[out] Value indicating the order in which streams will clip each other.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. This method is not currently implemented and returns E_NOTIMPL.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Images with larger z-values are always in front of images with smaller z-values.
 
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#SetZOrder">IMixerPinConfig::SetZOrder</A>
</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="SetAspectRatioMode">IMixerPinConfig::SetAspectRatioMode</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Sets the aspect ratio correction mode for window resizing.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetAspectRatioMode</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_ASPECT_RATIO_MODE</B> <I>amAspectRatioMode</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>amAspectRatioMode</I>
 </DT><DD>[in] Specify one of the <A HREF="../dtypes.htm#AM_ASPECT_RATIO_MODE">AM_ASPECT_RATIO_MODE</A> enumerated type members.
<!--@EDITOR: bj: reword param descrip to start with a noun, per style. -->
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. Current DirectShow implementation return values include:
<TABLE>
<TR><TD>E_NOTIMPL </TD><TD>Method called on secondary stream.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Currently this function is implemented only on the primary pin of the <A HREF="../../filtsamp/Overlay_Mixer.htm#VP_Mixer">Overlay Mixer</A> filter. Calling it on a secondary pin will result in an error.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#GetAspectRatioMode">IMixerPinConfig::GetAspectRatioMode</A>

</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="SetBlendingParameter">IMixerPinConfig::SetBlendingParameter</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Sets the blending parameter that defines how a secondary stream is blended with a primary stream. 
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetBlendingParameter</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwBlendingParameter</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwBlendingParameter</I>
 </DT><DD>[in] Value between 0 and 255 that indicates the amount of blending between a primary stream and a secondary stream. 
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. Current DirectShow implementation return values include:
<TABLE>
<TR><TD>E_UNEXPECTED </TD><TD>Method called on primary stream.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Value outside of possible range (0 to 255).
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The value of the <I>dwBlendingParameter</I> parameter must be between 0 and 255, where 0 makes the secondary stream invisible and 255 makes the primary stream invisible in the area that the secondary stream occupies. If no value is set the default is 255.

<P>This method is not intended to be called on the primary stream.

<P><B>Note</B>  Current DirectShow implementation of this interface allows only values of 0 or 255 for the <I>dwBlendingParameter</I> parameter. Any other values are invalid.</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#GetBlendingParameter">IMixerPinConfig::GetBlendingParameter</A>

</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="SetColorKey">IMixerPinConfig::SetColorKey</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Sets the color key being used by a video stream.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetColorKey</B><B>(</B><BR>&nbsp;&nbsp;<B>COLORKEY</B> <I>*pColorKey</I> <B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pColorKey</I>
 </DT><DD>[in] Pointer to a <A HREF="../structs.htm#COLORKEY">COLORKEY</A> structure.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. This method is not currently implemented and returns E_NOTIMPL.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The term color key
<!--@ bj: make a glossary entry for color key? -->
 has different meanings depending on which stream it is referring to. The color key of the primary stream refers to the destination color key being used by the overlay surface. The color key of the secondary stream refers to the source color key used, when <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_B.htm#blit')">blitting</A> from an offscreen surface to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#primary_surface')">primary surface</A>. 

<P>Applications should set the color key of the primary pin to an obscure color (some color which, in all probability, will not be present on the desktop). Overlay mixer filters will try to pick an obscure color, but if the application knows that the specified color is part of some other content, then the application should change it.

<P>Setting the color key on the secondary stream can be used to make the stream transparent and enable nonrectangular images. For example, if the secondary stream is closed-captioned text, then the closed-captioned text decoder should paint a solid color in the background and then set the color key on the corresponding pin to that color. This ensures that all pixels are transferred except those specified by the color key. If possible, applications should set the color key of the secondary stream to the same as that of the primary stream to give a slight performance advantage.

<p>Setting this value on the primary stream sets the destination color key being used by the overlay surface. By default, the destination color key is used as the color key for all transparent (secondary) streams.

<p>Valid arguments for the <I>pColorKey</I> parameter include CK_INDEX	when video display mode is set to 256 colors, and CK_RGB when video display mode is set to a higher color depth such as hi-color, 24-bit, or 32-bit. The CK_RGB flag must be specified along with the CK_INDEX. If CK_INDEX flag is set then the index will be used as palette index in 256 color mode. But you must provide a COLORREF with a valid true color so that if the display mode is changed on the fly, DirectShow can switch to using the specified true color. This is because a number of true colors may be mapped to a single palette index, but going the other way from the palette index to a true color is not one-to-one.

<P><B>Note</B> Currently, this method is implemented only for the primary input pin. 

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#GetColorKey">IMixerPinConfig::GetColorKey</A>
</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="SetStreamTransparent">IMixerPinConfig::SetStreamTransparent</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Sets the stream to transparent.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetStreamTransparent</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bStreamTransparent</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>bStreamTransparent</I>
 </DT><DD>[in] Pass in TRUE to indicate stream is transparent; FALSE to indicate not a transparent stream.
<!--@EDITOR: bj: reword param description to begin with a noun, per style. -->
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. <B>HRESULT</B> can include one of the following standard constants, or other values not listed. 
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method is not supported.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#GetStreamTransparent">IMixerPinConfig::GetStreamTransparent</A>
</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="SetRelativePosition">IMixerPinConfig::SetRelativePosition</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Sets the position of the stream in the display window.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetRelativePosition</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwLeft</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwTop</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwRight</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwBottom</I> <B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<!--@EDITOR: bj: reword param description to begin with a noun, per style. -->
<DL><DT><I>dwLeft</I>
 </DT><DD>[in] Specifies the x-coordinate in the upper-left corner of the display window. 
</DD><DT><I>dwTop</I>
 </DT><DD>[in] Specifies the y-coordinate in the upper-left corner of the display window. 
</DD><DT><I>dwRight</I>
 </DT><DD>[in] Specifies the x-coordinate in the bottom-right corner of the display window. 
</DD><DT><I>dwBottom</I>
 </DT><DD>[in] Specifies the y-coordinate in the bottom-right corner of the display window.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. Current DirectShow implementation return values include:
<TABLE>
<TR><TD>E_INVALIDARG </TD><TD>Coordinates not in the {0, 0, 10,000, 10,000} range.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method assumes window coordinates of {0, 0, 10,000, 10,000}. Therefore, if you want your video stream to be rendered in the bottom right quarter of the display window, you would call this method with the parameters {5,000, 5,000, 10,000, 10,000}.

<P><B>Note</B>  Values greater than 10,000 are invalid and will cause an error.</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#GetRelativePosition">IMixerPinConfig::GetRelativePosition</A>
</BLOCKQUOTE>
<!--@ *************************************** -->
<H1><A NAME="SetZOrder">IMixerPinConfig::SetZOrder</A><HR size=1></H1>
<A HREF="IMixerPinConfig.htm">IMixerPinConfig Interface</A>
<P>Sets the z-order of a particular video stream. 
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetZOrder</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwZOrder</I> <B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwZOrder</I>
 </DT><DD>[in] Value indicating the order in which streams will clip each other.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. This method is not currently implemented and returns E_NOTIMPL.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The z-order indicates which streams can clip other streams. Images with larger z-values are always in front of images with smaller z-values.

<P>The relative order of multiple streams is significant only if the video images overlap.

<P>Specifying the same z-order for two overlapping streams can cause strange video artifacts.




</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IMixerPinConfig.htm#GetZOrder">IMixerPinConfig::GetZOrder</A>

</BLOCKQUOTE>
<!-- CONTENTS_END -->
<!-- START_PAGE_FOOTER -->

<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->
</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->
	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->
</BODY>
</HTML>
