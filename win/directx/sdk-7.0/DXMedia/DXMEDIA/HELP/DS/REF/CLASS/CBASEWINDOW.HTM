<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CBaseWindow Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CBaseWindow Class">
<META NAME="Description" CONTENT="ActivateWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::ActivateWindow">
<META NAME="Description" CONTENT="CBaseWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::CBaseWindow">
<META NAME="Description" CONTENT="DoneWithWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::DoneWithWindow">
<META NAME="Description" CONTENT="DoRealisePalette (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::DoRealisePalette">
<META NAME="Description" CONTENT="DoSetWindowForeground (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::DoSetWindowForeground">
<META NAME="Description" CONTENT="DoShowWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::DoShowWindow">
<META NAME="Description" CONTENT="GetClassWindowStyles (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::GetClassWindowStyles">
<META NAME="Description" CONTENT="GetDefaultRect (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::GetDefaultRect">
<META NAME="Description" CONTENT="GetMemoryHDC (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::GetMemoryHDC">
<META NAME="Description" CONTENT="GetWindowHDC (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::GetWindowHDC">
<META NAME="Description" CONTENT="GetWindowHeight (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::GetWindowHeight">
<META NAME="Description" CONTENT="GetWindowHWND (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::GetWindowHWND">
<META NAME="Description" CONTENT="GetWindowWidth (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::GetWindowWidth">
<META NAME="Description" CONTENT="InactivateWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::InactivateWindow">
<META NAME="Description" CONTENT="InitialiseWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::InitialiseWindow">
<META NAME="Description" CONTENT="OnClose (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::OnClose">
<META NAME="Description" CONTENT="OnPaletteChange (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::OnPaletteChange">
<META NAME="Description" CONTENT="OnReceiveMessage (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::OnReceiveMessage">
<META NAME="Description" CONTENT="OnSize (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::OnSize">
<META NAME="Description" CONTENT="PaintWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::PaintWindow">
<META NAME="Description" CONTENT="PerformanceAlignWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::PerformanceAlignWindow">
<META NAME="Description" CONTENT="PossiblyEatMessage (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::PossiblyEatMessage">
<META NAME="Description" CONTENT="PrepareWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::PrepareWindow">
<META NAME="Description" CONTENT="SetPalette (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::SetPalette">
<META NAME="Description" CONTENT="UninitialiseWindow (CBaseWindow)">
<META NAME="Description" CONTENT="CBaseWindow::UninitialiseWindow">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CBaseWindow"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CBaseWindow Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CBaseWindow Class"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CBaseVideoWindow.htm">CBaseVideoWindow Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CBasicAudio.htm">CBasicAudio Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CBaseWindow Class</H1>

<P><IMG SRC="../../art/wutil01.gif" WIDTH="179" HEIGHT="24" ALT="CBaseWindow class hierarchy">

<P>The <B>CBaseWindow</B> class creates a window and a worker thread. The worker thread pulls messages from the window's input queue and dispatches them as appropriate. The window and its thread are created by the <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A> member function and destroyed by the <A HREF="CBaseWindow.htm#DoneWithWindow">CBaseWindow::DoneWithWindow</A> member function. The window should also be initialized by the <A HREF="CBaseWindow.htm#InitialiseWindow">CBaseWindow::InitialiseWindow</A> member function and uninitialized by the <A HREF="CBaseWindow.htm#UninitialiseWindow">CBaseWindow::UninitialiseWindow</A> member function. After preparing and initializing a window, size it by using the <A HREF="CBaseWindow.htm#ActivateWindow">CBaseWindow::ActivateWindow</A> member function; hide the window using the <A HREF="CBaseWindow.htm#InactivateWindow">CBaseWindow::InactivateWindow</A> member function.

<A NAME="Protected_Data_Membe"></A><P CLASS="ref">Protected Data Members</P>
<TABLE><TR><TD><B><A NAME="m_bActivated">m_bActivated</A></B>
 </TD><TD>Flag to indicate window activation status.
</TD></TR><TR><TD><B><A NAME="m_bBackground">m_bBackground</A></B>
 </TD><TD>Flag to indicate if palettes are to be realized in the background.
</TD></TR><TR><TD><B><A NAME="m_bDoGetDC">m_bDoGetDC</A></B>
 </TD><TD>Flag to indicate if the window should get a DC.
</TD></TR><TR><TD><B><A NAME="m_ClassStyles">m_ClassStyles</A></B>
 </TD><TD>Class styles for the window.
</TD></TR><TR><TD><B><A NAME="m_hdc">m_hdc</A></B>
 </TD><TD>Device context (DC) for the window.
</TD></TR><TR><TD><B><A NAME="m_Height">m_Height</A></B>
 </TD><TD>Client window height.
</TD></TR><TR><TD><B><A NAME="m_hInstance">m_hInstance</A></B>
 </TD><TD>Global module instance handle.
</TD></TR><TR><TD><B><A NAME="m_hPalette">m_hPalette</A></B>
 </TD><TD>Handle to a palette belonging to this object.
</TD></TR><TR><TD><B><A NAME="m_hThread">m_hThread</A></B>
 </TD><TD>Worker thread for the window.
</TD></TR><TR><TD><B><A NAME="m_hwnd">m_hwnd</A></B>
 </TD><TD>Handle for this object's window.
</TD></TR><TR><TD><B><A NAME="m_MemoryDC">m_MemoryDC</A></B>
 </TD><TD>Memory DC used for fast bit-block transfer operations.
</TD></TR><TR><TD><B><A NAME="m_pClassName">m_pClassName</A></B>
 </TD><TD>Static string holding the class name.
</TD></TR><TR><TD><B><A NAME="m_RealizePalette">m_RealizePalette</A></B>
 </TD><TD>Message sent to indicate the window palette has changed.
</TD></TR><TR><TD><B><A NAME="m_ShowStageMessage">m_ShowStageMessage</A></B>
 </TD><TD>Message sent by <A HREF="../iface/IVideoWindow.htm#SetWindowForeground">IVideoWindow::SetWindowForeground</A> that moves the current window to the foreground and optionally gives it focus.
</TD></TR><TR><TD><B><A NAME="m_ShowStageTop">m_ShowStageTop</A></B>
 </TD><TD>Message sent to set the window to WS_EX_TOPMOST style.
</TD></TR><TR><TD><B><A NAME="m_SyncWorker">m_SyncWorker</A></B>
 </TD><TD><A HREF="CAMEvent.htm">CAMEvent</A> data member used to provide interthread synchronization.
</TD></TR><TR><TD><B><A NAME="m_SyncWorkerCreate">m_SyncWorkerCreate</A></B>
 </TD><TD><A HREF="CAMMsgEvent.htm">CAMMsgEvent</A> data member used to signal the constructor for the window class when to create the window.
</TD></TR><TR><TD><B><A NAME="m_ThreadSignal">m_ThreadSignal</A></B>
 </TD><TD>Data member used by the thread to signal errors.
</TD></TR><TR><TD><B><A NAME="m_Width">m_Width</A></B>
 </TD><TD>Client window width.
</TD></TR><TR><TD><B><A NAME="m_WindowLock">m_WindowLock</A></B>
 </TD><TD>Data member used to serialize window object access.
</TD></TR><TR><TD><B><A NAME="m_WindowStyles">m_WindowStyles</A></B>
 </TD><TD>Data member used to serialize the initial window styles.
</TD></TR><TR><TD><B><A NAME="m_WindowStylesEx">m_WindowStylesEx</A></B>
 </TD><TD>Data member used to serialize the initial extended window styles.
</TD></TR></TABLE>
<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>

<TABLE><TR><TD><A HREF="CBaseWindow.htm#CBaseWindow_CBaseWindow">CBaseWindow</A>
 </TD><TD>Constructs a <A HREF="CBaseWindow.htm">CBaseWindow</A> object.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#DoSetWindowForeground">DoSetWindowForeground</A>
 </TD><TD>Brings the window to the foreground.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#DoShowWindow">DoShowWindow</A>
 </TD><TD>Sets the show state of the specified window.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#GetMemoryHDC">GetMemoryHDC</A>
 </TD><TD>Retrieves the default offscreen memory device context (DC).
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#GetWindowHDC">GetWindowHDC</A>
 </TD><TD>Retrieves the default main window DC.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#GetWindowHeight">GetWindowHeight</A>
 </TD><TD>Retrieves the current window height.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#GetWindowHWND">GetWindowHWND</A>
 </TD><TD>Retrieves the window handle for the window.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#GetWindowWidth">GetWindowWidth</A>
 </TD><TD>Retrieves the current window width.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#PerformanceAlignWindow">PerformanceAlignWindow</A>
 </TD><TD>Aligns the window to a <A HREF="../../appendixes/Further_Reading.htm#DWORD">DWORD</A> boundary for maximum performance.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#PaintWindow">PaintWindow</A>
 </TD><TD>Invalidates the window client area.
</TD></TR></TABLE>
<A NAME="Overridable_Member_F"></A><P CLASS="ref">Overridable Member Functions</P>

<TABLE><TR><TD><A HREF="CBaseWindow.htm#ActivateWindow">ActivateWindow</A>
 </TD><TD>Sizes the window according to the requirements of the derived class.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#DoneWithWindow">DoneWithWindow</A>
 </TD><TD>Closes, deletes, and frees the window resources.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#DoRealisePalette">DoRealisePalette</A>
 </TD><TD>Maps palette entries from this window's palette to the system palette. The window's palette is set with <A HREF="CBaseWindow.htm#SetPalette">CBaseWindow::SetPalette</A>.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#PossiblyEatMessage">PossiblyEatMessage</A>
 </TD><TD>Forwards keyboard and mouse messages to a specified window. 
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#GetClassWindowStyles">GetClassWindowStyles</A>
 </TD><TD>Retrieves class and window information.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#GetDefaultRect">GetDefaultRect</A>
 </TD><TD>Retrieves the default size for the window.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#InactivateWindow">InactivateWindow</A>
 </TD><TD>Hides the window.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#InitialiseWindow">InitialiseWindow</A>
 </TD><TD>Creates the default device contexts.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#OnClose">OnClose</A>
 </TD><TD>Handles the WM_CLOSE message for the base class.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#OnPaletteChange">OnPaletteChange</A>
 </TD><TD>Handles WM_PALETTEISCHANGING and WM_PALETTECHANGED messages.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#OnSize">OnSize</A>
 </TD><TD>Handles WM_SIZE messages for the base class.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#OnReceiveMessage">OnReceiveMessage</A>
 </TD><TD>Indicates a base class implementation of a window procedure.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#PrepareWindow">PrepareWindow</A>
 </TD><TD>Initializes the window along with a worker thread.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#SetPalette">SetPalette</A>
 </TD><TD>Changes the palette that the window should realize.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#UninitialiseWindow">UninitialiseWindow</A>
 </TD><TD>Destroys the device contexts created for the window.
</TD></TR></TABLE>



<H1><A NAME="ActivateWindow">CBaseWindow::ActivateWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Sizes the window according to the requirements of the derived class.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>ActivateWindow</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. <B>HRESULT</B> can include one of the following standard constants, or other values not listed. 

<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method is not supported.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function calls <A HREF="CBaseWindow.htm#GetDefaultRect">CBaseWindow::GetDefaultRect</A>, which a
derived class should override to return the size of the images that will be
displayed. <B>ActivateWindow</B> then sizes the window so that the client area
matches this size.
</BLOCKQUOTE>


<H1><A NAME="CBaseWindow_CBaseWindow">CBaseWindow::CBaseWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Constructs a <A HREF="CBaseWindow.htm">CBaseWindow</A> object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CBaseWindow</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bDoGetDC</I> <B>=</B> <B>TRUE</B><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>bDoGetDC</I>
</DT><DD>Specifies if the window should get a device context.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The window and its worker thread are created by <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A>
and destroyed by <A HREF="CBaseWindow.htm#DoneWithWindow">CBaseWindow::DoneWithWindow</A>.
</BLOCKQUOTE>


<H1><A NAME="DoneWithWindow">CBaseWindow::DoneWithWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Destroys the window and its worker thread.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>DoneWithWindow</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. Current implementation returns NOERROR.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The base window class creates a window and a worker thread. The worker
thread is responsible for pulling messages from the window's input queue
and dispatching them as appropriate. The window and its thread are created
by <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A> and destroyed by <B>CBaseWindow::DoneWithWindow</B>.
The window should also be initialized using <A HREF="CBaseWindow.htm#InitialiseWindow">CBaseWindow::InitialiseWindow</A> and uninitialized using <A HREF="CBaseWindow.htm#UninitialiseWindow">CBaseWindow::UninitialiseWindow</A>. Having prepared a window and initialized it, the window can be sized using
<A HREF="CBaseWindow.htm#ActivateWindow">CBaseWindow::ActivateWindow</A> and subsequently hidden using
<A HREF="CBaseWindow.htm#InactivateWindow">CBaseWindow::InactivateWindow</A>.
</BLOCKQUOTE>


<H1><A NAME="DoRealisePalette">CBaseWindow::DoRealisePalette</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Maps palette entries from this window's palette to the system palette. The window's palette is set with <A HREF="CBaseWindow.htm#SetPalette">CBaseWindow::SetPalette</A>.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>DoRealisePalette</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bForceBackground</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>bForceBackground</I>
 </DT><DD>Value that specifies whether the palette is forced to the background.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if successful or S_FALSE if the <A HREF="../../appendixes/Further_Reading.htm#GdiFlush">GdiFlush</A> function could not flush the calling thread's current batch. 


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The window class is given a palette handle to use with the <A HREF="CBaseWindow.htm#SetPalette">CBaseWindow::SetPalette</A> member function. After a palette has been installed, it can be realized by calling this member function. The class will also call this member function when it gets WM_QUERYNEWPALETTE and WM_PALETTECHANGED messages from the Microsoft&#174; Windows&#174; operating system.

<P>Call this function with TRUE in response to WM_SETPALETTE and FALSE in response to WM_QUERYNEWPALETTE.

</BLOCKQUOTE>


<H1><A NAME="DoSetWindowForeground">CBaseWindow::DoSetWindowForeground</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Sets the video window to the foreground and optionally gives it focus.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>DoSetWindowForeground</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bFocus</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>bFocus</I>
 </DT><DD>Value that specifies whether the video window will have focus. A value of TRUE gives it focus and FALSE does not.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>DirectShow provides this method to make it easy for applications to move video windows to the foreground; usually, it is programatically complex for a thread associated with one window to affect a window associated with a different thread. This method passes the WM_SHOWWINDOW message to the video window's <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A>, so the application's window procedure must handle this message and bring the appropriate window to the foreground and give it focus, if specified.
</BLOCKQUOTE>


<H1><A NAME="DoShowWindow">CBaseWindow::DoShowWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Sets the show state of the specified window.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>DoShowWindow</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>ShowCmd</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ShowCmd</I>
</DT><DD>Specifies how the window is to be shown.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. Current implementation returns NOERROR.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function simply calls the Microsoft Win32&#174; <A HREF="../../appendixes/Further_Reading.htm#ShowWindow">ShowWindow</A> function.
</BLOCKQUOTE>


<H1><A NAME="GetClassWindowStyles">CBaseWindow::GetClassWindowStyles</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Retrieves class and window information.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>LPTSTR</B> <B>GetClassWindowStyles</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pClassStyles</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pWindowStyles</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pWindowStylesEx</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pClassStyles</I>
</DT><DD>Class styles.
</DD><DT><I>pWindowStyles</I>
</DT><DD>Window styles.
</DD><DT><I>pWindowStylesEx</I>
</DT><DD>Extended window styles.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a class name that is a static text string.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>A derived class must override this pure virtual member function to provide the default class and
window styles for the window. The information the derived class returns
is used in <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A> when the window is first created.
The class and window styles take the same parameters as their counterparts in the Microsoft Win32
<A HREF="../../appendixes/Further_Reading.htm#CreateWindowEx">CreateWindowEx</A> function. The string that is returned should be allocated as a
static string and should still be valid after the member function returns.
</BLOCKQUOTE>


<H1><A NAME="GetDefaultRect">CBaseWindow::GetDefaultRect</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Retrieves the default size for the window client area.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>RECT</B> <B>GetDefaultRect</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the default rectangle.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>When the window is activated, it calls
this member function to determine how large it should make the window's client area.
A video renderer will typically return the size of the native video image.
</BLOCKQUOTE>


<H1><A NAME="GetMemoryHDC">CBaseWindow::GetMemoryHDC</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Retrieves the default memory device context (DC).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HDC</B> <B>GetMemoryHDC</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the default memory DC.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The base window class creates a window with a worker thread when it
is prepared (in <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A>). It also creates two DCs that
can be used for drawing. The first is a normal window handle to a device context (HDC); the second is
an offscreen HDC that can be used as a source HDC in bit-block transfer functions.
</BLOCKQUOTE>


<H1><A NAME="GetWindowHDC">CBaseWindow::GetWindowHDC</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Retrieves the default window device context (DC).
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HDC</B> <B>GetWindowHDC</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the default window DC.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The base window class creates a window with a worker thread when it
is prepared (in <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A>). It also creates two DCs that
can be used for drawing. The first is a normal window handle to a device context (HDC); the second is
an offscreen HDC that can be used as a source HDC in bit-block transfer functions.
</BLOCKQUOTE>


<H1><A NAME="GetWindowHeight">CBaseWindow::GetWindowHeight</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Retrieves the current window height.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>LONG</B> <B>GetWindowHeight</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the window height in pixels.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is updated when the base class receives WM_SIZE messages.
</BLOCKQUOTE>


<H1><A NAME="GetWindowHWND">CBaseWindow::GetWindowHWND</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Retrieves the window handle associated with this object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HWND</B> <B>GetWindowHWND</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a window handle.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If called before issuing a <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A> call, this member
function returns NULL.
</BLOCKQUOTE>


<H1><A NAME="GetWindowWidth">CBaseWindow::GetWindowWidth</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Retrieves the current window width.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>LONG</B> <B>GetWindowWidth</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the window width in pixels.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is updated when the base class receives WM_SIZE messages.
</BLOCKQUOTE>


<H1><A NAME="InactivateWindow">CBaseWindow::InactivateWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Effectively hides the window (if it was visible).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>InactivateWindow</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR if successful; S_FALSE if the window is not currently active.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The base window class creates a window and a worker thread. The worker
thread is responsible for pulling messages from the window's input queue
and dispatching them as appropriate. The window and its thread are created
by <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A> and destroyed in <A HREF="CBaseWindow.htm#DoneWithWindow">CBaseWindow::DoneWithWindow</A>.
The window should be initialized through <A HREF="CBaseWindow.htm#InitialiseWindow">CBaseWindow::InitialiseWindow</A>
and uninitialized through
<A HREF="CBaseWindow.htm#UninitialiseWindow">CBaseWindow::UninitialiseWindow</A>. Having
prepared a window and initialized it, the window can be sized using
<A HREF="CBaseWindow.htm#ActivateWindow">CBaseWindow::ActivateWindow</A> and subsequently hidden using <B>CBaseWindow::InactivateWindow</B>.
</BLOCKQUOTE>


<H1><A NAME="InitialiseWindow">CBaseWindow::InitialiseWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Creates default device contexts for the window.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>InitialiseWindow</B><B>(</B><BR>&nbsp;&nbsp;<B>HWND</B> <I>hwnd</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>hwnd</I>
</DT><DD>Window handle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. Current implementation returns NOERROR.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The base window class creates a window and a worker thread. The worker
thread is responsible for pulling messages from the window's input queue
and dispatching them as appropriate. The window and its thread are created
by <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A> and destroyed in <A HREF="CBaseWindow.htm#DoneWithWindow">CBaseWindow::DoneWithWindow</A>.
The window should be initialized through <B>CBaseWindow::InitialiseWindow</B>
and uninitialized through <A HREF="CBaseWindow.htm#UninitialiseWindow">CBaseWindow::UninitialiseWindow</A>. Having
prepared a window and initialized it, the window can be sized using
<A HREF="CBaseWindow.htm#ActivateWindow">CBaseWindow::ActivateWindow</A> and subsequently hidden using <A HREF="CBaseWindow.htm#InactivateWindow">CBaseWindow::InactivateWindow</A>.

<P>The base class creates two device contexts that can be used for drawing. The
first is a standard handle to a device context (HDC) for the window; the second is an offscreen HDC. The
offscreen HDC often is useful for selecting bitmaps before calling
the Microsoft Win32 <A HREF="../../appendixes/Further_Reading.htm#BitBlt">BitBlt</A> or <A HREF="../../appendixes/Further_Reading.htm#StretchBlt">StretchBlt</A> function to copy the bitmap
to the main window. This member function also sets the default
stretch mode to be COLORONCOLOR. The member function is virtual so that derived classes
can change this default if desired.
</BLOCKQUOTE>


<H1><A NAME="OnClose">CBaseWindow::OnClose</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Handles the WM_CLOSE message.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>BOOL</B> <B>OnClose</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The default behavior for this member function is to simply hide the window. A derived
class should not destroy the window when it receives a WM_CLOSE message but should send
an <A HREF="../Event_Notification_Codes.htm#EC_USERABORT">EC_USERABORT</A> notification to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A>. This will
have the playback stopped, and in some cases will also have the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A>
disconnected and released. It is only when the filter that owns the window
is finally released (that is, destroyed) that the derived class should actually destroy the
window (using <A HREF="CBaseWindow.htm#DoneWithWindow">CBaseWindow::DoneWithWindow</A>).
</BLOCKQUOTE>


<H1><A NAME="OnPaletteChange">CBaseWindow::OnPaletteChange</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Handles WM_PALETTEISCHANGING and WM_PALETTECHANGED messages.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>LRESULT</B> <B>OnPaletteChange</B><B>(</B><BR>&nbsp;&nbsp;<B>HWND</B> <I>hwnd</I><B>,</B><BR>&nbsp;&nbsp;<B>UINT</B> <I>Message</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>hwnd</I>
 </DT><DD>Handle of the window causing the message.
</DD><DT><I>Message</I>
 </DT><DD>Message details passed on from the window procedure.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values.
<TABLE>
<TR><TD>0 </TD><TD>Message was not handled.
</TD></TR><TR><TD>1 </TD><TD>Message was processed.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>When the base class receives a WM_PALETTEISCHANGING message, it realizes its palette again. It must also do this when told, through WM_PALETTECHANGED, that the system palette has changed. In the latter case, however, the base class must be careful not to realize its palette if it was the window that caused the WM_PALETTECHANGED message (which is why the window that caused the message to be sent is passed into the member function).

<P>This is a protected member function.
</BLOCKQUOTE>


<H1><A NAME="OnReceiveMessage">CBaseWindow::OnReceiveMessage</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Indicates a base class implementation of a window procedure.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>LRESULT</B> <B>OnReceiveMessage</B><B>(</B><BR>&nbsp;&nbsp;<B>HWND</B> <I>hwnd</I><B>,</B><BR>&nbsp;&nbsp;<B>INT</B> <I>uMsg</I><B>,</B><BR>&nbsp;&nbsp;<B>WPARAM</B> <I>wParam</I><B>,</B><BR>&nbsp;&nbsp;<B>LPARAM</B> <I>lParam</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>hwnd</I>
</DT><DD>Handle to the window.
</DD><DT><I>uMsg</I>
</DT><DD>Message identifier.
</DD><DT><I>wParam</I>
</DT><DD>Message's <I>wParam</I> parameter.
</DD><DT><I>lParam</I>
</DT><DD>Message's <I>lParam</I> parameter.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../../appendixes/Further_Reading.htm#LRESULT">LRESULT</A> value, based on the <I>uMsg</I> parameter. If <I>uMsg</I> is not one of the specified values, <B>OnReceiveMessage</B> passes the message to the Win32 <A HREF="../../appendixes/Further_Reading.htm#DefWindowProc">DefWindowProc</A> function and forwards the resulting return value to the caller.

<TABLE>
<TR><TH>Message</TH><TH>Action</TH></TR>
<TR><TD><A HREF="CBaseWindow.htm#m_RealizePalette">m_RealizePalette</A>
 </TD><TD>Returns 0.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#m_ShowStageMessage">m_ShowStageMessage</A>
 </TD><TD>Returns 1.
</TD></TR><TR><TD><A HREF="CBaseWindow.htm#m_ShowStageTop">m_ShowStageTop</A>
 </TD><TD>Returns 1.
</TD></TR><TR><TD>WM_CLOSE
 </TD><TD>Returns 0.
</TD></TR><TR><TD>WM_PALETTECHANGED
 </TD><TD>Returns 0.
</TD></TR><TR><TD>WM_QUERYNEWPALETTE
 </TD><TD>Returns result of <A HREF="CBaseWindow.htm#OnPaletteChange">CBaseWindow::OnPaletteChange</A>
</TD></TR><TR><TD>WM_SIZE
 </TD><TD>Returns 0.
</TD></TR><TR><TD>WM_SYSCOLORCHANGE
 </TD><TD>Returns 1.
</TD></TR></TABLE>
</BLOCKQUOTE>


<H1><A NAME="OnSize">CBaseWindow::OnSize</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Handles the WM_SIZE message.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>BOOL</B> <B>OnSize</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>Width</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>Height</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>Width</I>
</DT><DD>Window width.
</DD><DT><I>Height</I>
</DT><DD>Window height.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function stores the window width and height so that they can be returned from
the <A HREF="CBaseWindow.htm#GetWindowHeight">CBaseWindow::GetWindowHeight</A> and <A HREF="CBaseWindow.htm#GetWindowWidth">CBaseWindow::GetWindowWidth</A>
member functions.
</BLOCKQUOTE>


<H1><A NAME="PaintWindow">CBaseWindow::PaintWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Invalidates the window client area.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>PaintWindow</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bErase</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>bErase</I>
</DT><DD>Determines if the background should be erased.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>


<H1><A NAME="PerformanceAlignWindow">CBaseWindow::PerformanceAlignWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Aligns the window to a <A HREF="../../appendixes/Further_Reading.htm#DWORD">DWORD</A> boundary for maximum performance.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>PerformanceAlignWindow</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function can be called, if the video is not owned by another window,
to align the left edge and the top of the window for best display performance.
</BLOCKQUOTE>


<H1><A NAME="PossiblyEatMessage">CBaseWindow::PossiblyEatMessage</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Forwards keyboard and mouse messages to a specified window. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>BOOL</B> <B>PossiblyEatMessage</B><B>(</B><BR>&nbsp;&nbsp;<B>UINT</B> <I>uMsg</I><B>,</B><BR>&nbsp;&nbsp;<B>WPARAM</B> <I>wParam</I><B>,</B><BR>&nbsp;&nbsp;<B>LPARAM</B> <I>lParam</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>uMsg</I>
</DT><DD>Message that was forwarded. 
</DD><DT><I>wParam</I>
</DT><DD>First message parameter. 
</DD><DT><I>lParam</I>
</DT><DD>Second message parameter. 
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns FALSE.


</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>

<P><A HREF="CBaseControlWindow.htm#PossiblyEatMessage">CBaseControlWindow::PossiblyEatMessage</A></BLOCKQUOTE>


<H1><A NAME="PrepareWindow">CBaseWindow::PrepareWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Creates a window and a worker thread.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>PrepareWindow</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR if successful; E_FAIL if unsuccessful.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The base window class creates a window and a worker thread. The worker
thread is responsible for pulling messages from the window's input queue
and dispatching them as appropriate. The window and its thread are created
by <B>CBaseWindow::PrepareWindow</B> and destroyed in <A HREF="CBaseWindow.htm#DoneWithWindow">CBaseWindow::DoneWithWindow</A>.
The window should also
be initialized and uninitialized through <A HREF="CBaseWindow.htm#InitialiseWindow">CBaseWindow::InitialiseWindow</A>
and <A HREF="CBaseWindow.htm#UninitialiseWindow">CBaseWindow::UninitialiseWindow</A>, respectively. Having
prepared a window and initialized it, the window can be sized using
<A HREF="CBaseWindow.htm#ActivateWindow">CBaseWindow::ActivateWindow</A> and subsequently hidden using <A HREF="CBaseWindow.htm#InactivateWindow">CBaseWindow::InactivateWindow</A>.
</BLOCKQUOTE>


<H1><A NAME="SetPalette">CBaseWindow::SetPalette</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Sets a palette for the window to use.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>SetPalette</B><B>(</B><BR>&nbsp;&nbsp;<B>HPALETTE</B> <I>hPalette</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>hPalette</I>
</DT><DD>Handle to the new palette.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function allows a filter to install a palette in the window object. The
palette handle passed in should be non-NULL. The palette is realized when it is installed. The window object does not
delete any previous palette that it was using; the client using the
window object should ensure it deletes the palette it creates at the
appropriate time.
</BLOCKQUOTE>


<H1><A NAME="UninitialiseWindow">CBaseWindow::UninitialiseWindow</A><HR size=1></H1>
<A HREF="CBaseWindow.htm">CBaseWindow Class</A>
<P>Flushes GDI and deletes the default device contexts.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>UninitialiseWindow</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. Current implementation returns NOERROR.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The base window class creates a window and a worker thread. The worker
thread is responsible for pulling messages from the window's input queue
and dispatching them as appropriate. The window and its thread are created
by <A HREF="CBaseWindow.htm#PrepareWindow">CBaseWindow::PrepareWindow</A> and destroyed in <A HREF="CBaseWindow.htm#DoneWithWindow">CBaseWindow::DoneWithWindow</A>.
The window should also
be initialized and uninitialized through <A HREF="CBaseWindow.htm#InitialiseWindow">CBaseWindow::InitialiseWindow</A>
and <B>CBaseWindow::UninitialiseWindow</B>, respectively. Having
prepared a window and initialized it, the window can be sized using
<A HREF="CBaseWindow.htm#ActivateWindow">CBaseWindow::ActivateWindow</A> and subsequently hidden using <A HREF="CBaseWindow.htm#InactivateWindow">CBaseWindow::InactivateWindow</A>.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
