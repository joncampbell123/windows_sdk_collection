<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IMediaEventEx Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IMediaEventEx Interface">
<META NAME="Description" CONTENT="IMediaEventEx::GetNotifyFlags">
<META NAME="Description" CONTENT="IMediaEventEx::SetNotifyFlags">
<META NAME="Description" CONTENT="IMediaEventEx::SetNotifyWindow">
<META NAME="Description" CONTENT="GetNotifyFlags (IMediaEventEx)">
<META NAME="Description" CONTENT="SetNotifyFlags (IMediaEventEx)">
<META NAME="Description" CONTENT="SetNotifyWindow (IMediaEventEx)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IMediaEventEx"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IMediaEvent.htm">IMediaEvent Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IMediaEventSink.htm">IMediaEventSink Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IMediaEventEx Interface</H1>

<P>This interface derives from <A HREF="IMediaEvent.htm">IMediaEvent</A> and adds a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">method</A> 
that allows registration of a window to receive messages when events occur. 


<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>This interface is implemented by the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A>.

<P>Unlike <A HREF="IMediaEvent.htm">IMediaEvent</A>, <A HREF="IMediaEventEx.htm">IMediaEventEx</A> is not available through 
Automation, and therefore cannot be called directly from Visual Basic. 

<P>The <A HREF="../class/CMediaEvent.htm#CMediaEvent">CMediaEvent Class</A> supports <A HREF="IMediaEventEx.htm">IMediaEventEx</A>.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>This interface is used by applications to receive notification that
an event has occurred. Applications can then avoid using a separate thread 
that waits until an event is set.

<P>For a list of system-defined <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_E.htm#event_notification')">event notifications</A>, see
<A HREF="../Event_Notification_Codes.htm#Events">DirectShow Event Notification Codes</A>.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IDispatch methods</TH><TH>Description</TH></TR><TR><TD><A HREF="../../appendixes/Further_Reading.htm#IDispatch__GetTypeIn">GetTypeInfoCount</A>
 </TD><TD>Determines whether there is type information available for this dispinterface.
</TD></TR><TR><TD><A HREF="../../appendixes/Further_Reading.htm#IDispatch__GetTypeIn">GetTypeInfo</A>
 </TD><TD>Retrieves the type information for this dispinterface if
 <A HREF="../../appendixes/Further_Reading.htm#IDispatch__GetTypeIn">GetTypeInfoCount</A> returned
successfully.
</TD></TR><TR><TD><A HREF="../../appendixes/Further_Reading.htm#IDispatch__GetIDsOfN">GetIDsOfNames</A>
 </TD><TD>Converts text names of properties and methods (including arguments) to
their corresponding DISPIDs.
</TD></TR><TR><TD><A HREF="../../appendixes/Further_Reading.htm#IDispatch__Invoke">Invoke</A>
 </TD><TD>Calls a method or accesses a property in this dispinterface if given a DISPID
and any other necessary parameters.
</TD></TR><TR></TR>
<TR><TH>IMediaEvent methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IMediaEvent.htm#GetEventHandle">GetEventHandle</A>
 </TD><TD>Retrieves a handle to a manual-reset event that will be signaled.
</TD></TR><TR><TD><A HREF="IMediaEvent.htm#GetEvent">GetEvent</A>
 </TD><TD>Retrieves the next notification event.
</TD></TR><TR><TD><A HREF="IMediaEvent.htm#WaitForCompletion">WaitForCompletion</A>
 </TD><TD>Waits until the graph's operation has completed.
</TD></TR><TR><TD><A HREF="IMediaEvent.htm#CancelDefaultHandling">CancelDefaultHandling</A>
 </TD><TD>Cancels any default handling of the specified event by the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A>.
</TD></TR><TR><TD><A HREF="IMediaEvent.htm#RestoreDefaultHandling">RestoreDefaultHandling</A>
 </TD><TD>Restores default handling for this event.
</TD></TR><TR><TD><A HREF="IMediaEvent.htm#FreeEventParams">FreeEventParams</A>
 </TD><TD>Frees resources associated with the parameters to an event.
 </TD></TR><TR></TR>
<TR><TH>IMediaEventEx methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IMediaEventEx.htm#SetNotifyWindow">SetNotifyWindow</A>
 </TD><TD>Registers a window that will handle messages when a specified event occurs.
</TD></TR><TR><TD><A HREF="IMediaEventEx.htm#SetNotifyFlags">SetNotifyFlags</A>
 </TD><TD>Turns event notifications on or off.
</TD></TR><TR><TD><A HREF="IMediaEventEx.htm#GetNotifyFlags">GetNotifyFlags</A>
 </TD><TD>Retrieves whether event notifications are on or off.
 </TD></TR></TABLE>



<H1><A NAME="GetNotifyFlags">IMediaEventEx::GetNotifyFlags</A><HR size=1></H1>
<A HREF="IMediaEventEx.htm">IMediaEventEx Interface</A>
<P>Retrieves whether event notifications are on or off. 
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetNotifyFlags</B><B>(</B><BR>&nbsp;&nbsp;<B>[out]</B> <B>long</B> <I>*lplNoNotifyFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> </PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplNoNotifyFlags</I>
 </DT><DD>[out] Pointer to a value indicating whether event notifications should be on or off. 0x00 indicates notifications are on and 0x01 indicates notifications are off.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns S_OK if successful or E_POINTER if <I>lplNoNotifyFlags</I> is NULL.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The handle returned by the <A HREF="IMediaEvent.htm#GetEventHandle">GetEventHandle</A> method will be signaled at end of stream.


</BLOCKQUOTE>



<H1><A NAME="SetNotifyFlags">IMediaEventEx::SetNotifyFlags</A><HR size=1></H1>
<A HREF="IMediaEventEx.htm">IMediaEventEx Interface</A>
<P>Turns event notifications on or off.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetNotifyFlags</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>lNoNotifyFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> </PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lNoNotifyFlags</I>
 </DT><DD>[in] Value indicating whether event notifications should be on or off. Specify 0x00 to turn notifications on or specify 0x01 to turn notification off.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns S_OK if successful or E_INVALIDARG if the argument is invalid.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>If notification has been turned off, the handle returned by the <A HREF="IMediaEvent.htm#GetEventHandle">GetEventHandle</A> method will be signaled at end of stream.
</BLOCKQUOTE>


<H1><A NAME="SetNotifyWindow">IMediaEventEx::SetNotifyWindow</A><HR size=1></H1>
<A HREF="IMediaEventEx.htm">IMediaEventEx Interface</A>
<P>Registers a window that will handle messages in response to all
events from an object.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetNotifyWindow</B><B>(</B><BR>&nbsp;&nbsp;<B>OAHWND</B> <I>hwnd</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>lMsg</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>lInstanceData</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>hwnd</I>
 </DT><DD>[in] Handle of window to notify. Pass NULL to stop notification.
</DD><DT><I>lMsg</I>
 </DT><DD>[in] The window message to be passed as the notification.

</DD><DT><I>lInstanceData</I>
 </DT><DD>[in] Value (instance data) to be passed as the <I>lParam</I> 
 parameter for the <I>lMsg</I> message.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if successful or E_INVALIDARG if an argument is invalid.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method designates a window as the recipient of messages generated by or sent 
to the current DirectShow object. You can use 
this method to monitor the messages from multiple sources in a single window, which lowers 
processing overhead.

<P>If an event occurs, DirectShow posts the notification message specified in <I>lMsg</I> 
to the window specified by <I>hwnd</I>. <B>SetNotifyWindow</B> sets the message's 
<I>lParam</I> parameter to <I>lInstanceData</I> and its <I>wParam</I> parameter to zero.

<P>You can retrieve the event information by calling the <A HREF="IMediaEvent.htm#GetEvent">GetEvent</A>
 method when the destination window receives the message.

<P>All event types post the message; when it arrives, any number of events, including zero, 
might actually be in the queue. If more than one event is in the queue when you call 
<B>SetNotifyWindow</B>, DirectShow posts only one message. If the application can receive the message after some other action has cleared events from the queue, there might be no events in the queue. For example, the
<A HREF="IMediaControl.htm#Stop">Stop</A> method clears all <A HREF="../Event_Notification_Codes.htm#EC_COMPLETE">EC_COMPLETE</A> events from the queue.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
