<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CBaseStreamControl Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CBaseStreamControl Class">
<META NAME="Description" CONTENT="CBaseStreamControl (CBaseStreamControl)">
<META NAME="Description" CONTENT="CBaseStreamControl::CBaseStreamControl">
<META NAME="Description" CONTENT="CheckStreamState (CBaseStreamControl)">
<META NAME="Description" CONTENT="CBaseStreamControl::CheckStreamState">
<META NAME="Description" CONTENT="Flushing (CBaseStreamControl)">
<META NAME="Description" CONTENT="CBaseStreamControl::Flushing">
<META NAME="Description" CONTENT="GetInfo (CBaseStreamControl)">
<META NAME="Description" CONTENT="CBaseStreamControl::GetInfo">
<META NAME="Description" CONTENT="NotifyFilterState (CBaseStreamControl)">
<META NAME="Description" CONTENT="CBaseStreamControl::NotifyFilterState">
<META NAME="Description" CONTENT="SetFilterGraph (CBaseStreamControl)">
<META NAME="Description" CONTENT="CBaseStreamControl::SetFilterGraph">
<META NAME="Description" CONTENT="SetSyncSource (CBaseStreamControl)">
<META NAME="Description" CONTENT="CBaseStreamControl::SetSyncSource">
<META NAME="Description" CONTENT="StartAt (CBaseStreamControl)">
<META NAME="Description" CONTENT="CBaseStreamControl::StartAt">
<META NAME="Description" CONTENT="StopAt (CBaseStreamControl)">
<META NAME="Description" CONTENT="CBaseStreamControl::StopAt">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CBaseStreamControl"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CBaseRenderer.htm">CBaseRenderer Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CBaseStreamControl Class</H1>

<P><IMG SRC="../../art/strmctl1.gif" WIDTH="205" HEIGHT="56" ALT="CBaseStreamControl class hierarchy">

<P>The <B>CBaseStreamControl</B> class implements the <A HREF="../iface/IAMStreamControl.htm">IAMStreamControl</A> interface on input and <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pins</A> in a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A>. This class provides control of the starting and stopping of various components of the stream. Various streams can




 be turned on or off without affecting the rest of the graph. For example, an audio stream can be turned off while a video stream continues, for muting. Or perhaps a capture stream can be turned off while preview continues to flow. This could be used to assist in frame accuracy when exact capture start or stop times are important.

<P><B>CBaseStreamControl</B> enables you to specify start and stop times in the <A HREF="CBaseStreamControl.htm#StartAt">StartAt</A> and <A HREF="CBaseStreamControl.htm#StopAt">StopAt</A> member functions and provides stream information in the <A HREF="CBaseStreamControl.htm#GetInfo">GetInfo</A> member function. <B>CBaseStreamControl</B> uses the <A HREF="../dtypes.htm#StreamControlState">StreamControlState</A> enumerated data type to describe the various states a stream is in. If a stream is flowing it is indicated by the STREAM_FLOWING setting, otherwise it is in a discarding state indicated by the STREAM_DISCARDING setting. 

<P><A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">Filters</A> that need to implement the interface on their own should typically inherit from <B>CBaseStreamControl</B> to obtain an implementation of the <A HREF="CBaseStreamControl.htm#StartAt">StartAt</A>, <A HREF="CBaseStreamControl.htm#StopAt">StopAt</A>, and <A HREF="CBaseStreamControl.htm#GetInfo">GetInfo</A> methods. The <B>CBaseStreamControl</B> class also maintains state information and decides what to do with the sample. To implement your own filter with pins that support <B>CBaseStreamControl</B> you must:
<UL><LI>Inform the filter object of all state changes through the <A HREF="CBaseStreamControl.htm#NotifyFilterState">NotifyFilterState</A> member function.
<LI>Inform the filter object of all <A HREF="CBaseStreamControl.htm#SetSyncSource">SetSyncSource</A> calls to the filter.
<LI>Inform the filter object when in a flushing state.




 and when flushing has completed, in the <A HREF="CBaseStreamControl.htm#Flushing">CBaseStreamControl::Flushing</A> member function.
<LI>Use the <A HREF="CBaseStreamControl.htm#CheckStreamState">CheckStreamState</A> function to make decisions about discarding or passing along samples.
<LI>Make sure output pins set discontinuity flags on the first sample flowed after samples have been discarded.
<LI>Tell your <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> what the sink is when your filter joins a filter graph, as shown in the following example.
<PRE>STDMETHODIMP CMyFilter::JoinFilterGraph(IFilterGraph * pGraph, LPCWSTR pName)
{
   HRESULT hr = CBaseFilter::JoinFilterGraph(pGraph, pName);
   if (hr == S_OK)
      m_pMyPin-&gt;SetFilterGraph(m_pSink);
   return hr;
}
</PRE>
</UL>
<P>If you are implementing the <A HREF="../iface/IAMStreamControl.htm">IAMStreamControl</A> interface without using <B>CBaseStreamControl</B>, the last two preceding points do not apply.

<P>For sample code, see the video capture sample in the  Samples\Multimedia\DShow\src\vidcap subdirectory of the DirectX Media SDK.

<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>
<TABLE>
<TR><TD><A HREF="CBaseStreamControl.htm#CBaseStreamControl_CBaseStreamControl">CBaseStreamControl</A> 
</TD><TD>Constructs a <A HREF="CBaseStreamControl.htm">CBaseStreamControl</A> object.
</TD></TR><TR><TD><A HREF="CBaseStreamControl.htm#CheckStreamState">CheckStreamState</A> 
</TD><TD>Retrieves a stream's current state.
</TD></TR><TR><TD><A HREF="CBaseStreamControl.htm#Flushing">Flushing</A> 
</TD><TD>Notifies the pin when the filter is flushing.
</TD></TR><TR><TD><A HREF="CBaseStreamControl.htm#GetInfo">GetInfo</A> 
</TD><TD>Retrieves information about the current streaming settings.
</TD></TR><TR><TD><A HREF="CBaseStreamControl.htm#NotifyFilterState">NotifyFilterState</A> 
</TD><TD>Notifies the pin of what state your filter is in.
</TD></TR><TR><TD><A HREF="CBaseStreamControl.htm#SetFilterGraph">SetFilterGraph</A> 
</TD><TD>Sets the event sink notification that your filter graph is using.
</TD></TR><TR><TD><A HREF="CBaseStreamControl.htm#SetSyncSource">SetSyncSource</A> 
</TD><TD>Identifies the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_clock')">reference clock</A> being used by the graph your filter is in.
</TD></TR><TR><TD><A HREF="CBaseStreamControl.htm#StartAt">StartAt</A> 
</TD><TD>Informs the pin when to start sending streaming data.
</TD></TR><TR><TD><A HREF="CBaseStreamControl.htm#StopAt">StopAt</A> 
</TD><TD>Informs the pin when to stop processing data and discard any new samples.
</TD></TR></TABLE>



<H1><A NAME="CBaseStreamControl_CBaseStreamControl">CBaseStreamControl::CBaseStreamControl</A><HR size=1></H1>
<A HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<P>Constructs a <A HREF="CBaseStreamControl.htm">CBaseStreamControl</A> object.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>CBaseStreamControl</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method initializes start time and stop time to MAX_TIME, which implies that times are unspecified.</BLOCKQUOTE>


<H1><A NAME="CheckStreamState">CBaseStreamControl::CheckStreamState</A><HR size=1></H1>
<A HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<P>Retrieves a stream's current state.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<B>enum StreamControlState CheckStreamState( IMediaSample *</B> <I>pSample</I> <B>);</B>
</PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSample</I>
</DT><DD>Pointer to an <A HREF="../iface/IMediaSample.htm">IMediaSample</A> interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a <A HREF="../dtypes.htm#StreamControlState">StreamControlState</A> enumeration type.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Your filter calls this member function when your pin receives a sample that it is about to forward. The first sample you forward after throwing one or more away should be marked as a discontinuity. 

<P>If your filter implements the <A HREF="../iface/IAMDroppedFrames.htm">IAMDroppedFrames</A> interface and is counting how many frames are dropped, it should not count a frame that is discarded as dropped. 

<P>The following example shows what you should include if your filter inherits from <A HREF="CBaseStreamControl.htm">CBaseStreamControl</A>.


<PRE>//Pin has been given a sample to pass on, pSample
//m_fLastSampleDiscarded is initialized to TRUE when streaming starts

int iStreamState = CheckStreamState(pSample);
if (iStreamState == STREAM_FLOWING) {
   if (m_fLastSampleDiscarded)
      pSample-&gt;SetDiscontinuity(TRUE);
   m_fLastSampleDiscarded = FALSE;
   //now deliver it or put it o a queue to be delivered, or whatever.
} else {
   m_fLastSampleDiscarded = TRUE;     //next one is discontinuity
   //Do NOT deliver this sample. Just throw it away.
}
</PRE>
</BLOCKQUOTE>


<H1><A NAME="Flushing">CBaseStreamControl::Flushing</A><HR size=1></H1>
<A HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<P>Notifies the pin that the filter is flushing.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>Flushing</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bInProgress</I> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>bInProgress</I>
</DT><DD>TRUE indicates flushing in progress; FALSE indicates not flushing.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If you are implementing your own filter, your pin must call this member function on <A HREF="../iface/IPin.htm#BeginFlush">BeginFlush</A> and <A HREF="../iface/IPin.htm#EndFlush">EndFlush</A> (<A HREF="CBaseOutputPin.htm#DeliverBeginFlush">DeliverBeginFlush</A> and <A HREF="CBaseOutputPin.htm#DeliverEndFlush">DeliverEndFlush</A> for output pins) to say when it is flushing, as shown in the following example.

<PRE>HRESULT CMyPin::BeginFlush()
{   
   Flushing(TRUE);
   //Or CBaseInputPin for input pins
   return CBaseOutputPin::BeginFlush();
}

HRESULT CMyPin::EndFlush()
{   
   Flushing(FALSE);
   //Or CBaseInputPin for input pins
   return CBaseOutputPin::EndFlush();
}
</PRE>
<P>Note that capture filters that do not support seeking do not call this method.
</BLOCKQUOTE>


<H1><A NAME="GetInfo">CBaseStreamControl::GetInfo</A><HR size=1></H1>
<A HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<P>Retrieves information about the current streaming settings.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_STREAM_INFO</B> <I>*pInfo</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pInfo</I>
</DT><DD>Pointer to an <A HREF="../structs.htm#AM_STREAM_INFO">AM_STREAM_INFO</A> structure.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IAMStreamControl.htm">IAMStreamControl</A> interface and is called by the user to find out if a pin is streaming and to obtain the stream's attributes.
</BLOCKQUOTE>


<H1><A NAME="NotifyFilterState">CBaseStreamControl::NotifyFilterState</A><HR size=1></H1>
<A HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<P>Notifies the pin of your filter's state.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>NotifyFilterState</B><B>(</B><BR>&nbsp;&nbsp;<B>FILTER_STATE</B> <I>new_state</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStart</I> <B>=</B> <B>0</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>new_state</I>
</DT><DD>Filter's new state.
</DD><DT><I>tStart</I>
</DT><DD>Time at which streaming starts (only valid when <I>new_state</I> is in <I>State_Running</I>).
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function notifies the pin of a filter's new state by setting a <A HREF="../dtypes.htm#FILTER_STATE">FILTER_STATE</A> enumeration type variable. 
<P>If you are implementing your own filter, inform your pin's <B>CBaseStreamControl::NotifyFilterState</B> member function what state your filter is in every time your filter changes state, as shown in the following example.

<PRE>STDMETHODIMP CMyFilter::Run(REFERENCE_TIME tStart)
{
   //once error check is successful
   m_pMyPin-&gt;NotifyFilterState(State_Running, tStart);
   
   //now continue with whatever should occur next, for example...
   return CBaseFilter::Run(tStart);
}

STDMETHODIMP CMyFilter::Pause()
{
   //Once error check is successful
   m_pMyPin-&gt;NotifyFilterState(State_Paused, 0);
   
   //Now continue with whatever should occur next, for example...
   return CBaseFilter::Pause();
}

STDMETHODIMP CMyFilter::Stop()
{
   //Once error check is successful
   m_pMyPin-&gt;NotifyFilterState(State_Stopped, 0);
   
   //Now continue with whatever should occur next, for example...
   return CBaseFilter::Stop(tStart);
}
</PRE>
</BLOCKQUOTE>


<H1><A NAME="SetFilterGraph">CBaseStreamControl::SetFilterGraph</A><HR size=1></H1>
<A HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<P>Sets the event sink notification your filter graph is using.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>SetFilterGraph</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaEventSink</B> <I>*pSink</I> <B>)</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSink</I>
</DT><DD>Pointer to an <A HREF="../iface/IMediaEventSink.htm">IMediaEventSink</A> interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>A filter calls this member function in its <A HREF="CBaseFilter.htm#JoinFilterGraph">JoinFilterGraph</A> member function after it creates the <A HREF="../iface/IMediaEventSink.htm">IMediaEventSink</A>.


</BLOCKQUOTE>


<H1><A NAME="SetSyncSource">CBaseStreamControl::SetSyncSource</A><HR size=1></H1>
<A HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<P>Identifies the reference clock being used by the graph your filter is in.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>SetSyncSource</B><B>(</B><BR>&nbsp;&nbsp;<B>IReferenceClock</B> <B>*</B> <I>pRefClock</I> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pRefClock</I>
</DT><DD>Pointer to the <A HREF="../iface/IReferenceClock.htm">IReferenceClock</A> interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Filters with pins that use this class should ensure that they pass sync source information



 to this member function, as shown in the following example.


<PRE>STDMETHODIMP CMyFilter::SetSyncSource(IReferenceClock *pClock)
{
   m_pMyPin-&gt;SetSyncSource(pClock);
   return CBaseFilter::SetSyncSource(pClock);
}
</PRE>
</BLOCKQUOTE>


<H1><A NAME="StartAt">CBaseStreamControl::StartAt</A><HR size=1></H1>
<A HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<P>Tells the pin when to start sending streaming data.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>StartAt</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>REFERENCE_TIME</B> <B>*</B> <I>ptStart</I> <B>=</B> <B>NULL</B><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwCookie</I> <B>=</B> <B>0</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ptStart</I>
</DT><DD><A HREF="../iface/IReferenceClock.htm#REFERENCE_TIME">REFERENCE_TIME</A> at which to start streaming. If NULL, start immediately (no notification). If MAX_TIME, start canceled or will have no effect.
</DD><DT><I>dwCookie</I>
</DT><DD>Specifies a particular value, other than 0, to be sent with the notification when the start occurs. (Only used if <I>ptStart</I> is non-NULL or MAX_TIME).
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Streams are enabled by default, so this member function will have no effect unless you have previously called <A HREF="CBaseStreamControl.htm#StopAt">StopAt</A>.

<P>After the stream is in a STREAM_FLOWING state, the filter will send an <A HREF="../Event_Notification_Codes.htm#EC_STREAM_CONTROL_STARTED">EC_STREAM_CONTROL_STARTED</A> <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_E.htm#event_notification')">event notification</A> to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A>.

<P><B>Note</B>  If start and stop are scheduled for a single point in time, the effect is as if the start occurred an infinitesimal time before the stop. You can use this effect to capture a single frame.
</BLOCKQUOTE>


<H1><A NAME="StopAt">CBaseStreamControl::StopAt</A><HR size=1></H1>
<A HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<P>Informs the pin when to stop processing data and to discard any new samples.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>StopAt</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>REFERENCE_TIME</B> <B>*</B> <I>ptStop</I> <B>=</B> <B>NULL</B><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bSendExtra</I> <B>=</B> <B>FALSE</B><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwCookie</I> <B>=</B> <B>0</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ptStop</I>
</DT><DD><A HREF="../iface/IReferenceClock.htm#REFERENCE_TIME">REFERENCE_TIME</A> at which to stop streaming. If NULL, stop immediately (no notification). If MAX_TIME, cancels stop.
</DD><DT><I>bSendExtra</I>
</DT><DD>Indicates whether to send an extra sample after scheduled <I>ptStop</I> time.
</DD><DT><I>dwCookie</I>
</DT><DD>Specifies a particular value to be sent with the notification when the stop occurs. (Only used if <I>ptStart</I> if not NULL or MAX_TIME).
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IAMStreamControl.htm#StopAt">IAMStreamControl::StopAt</A> method and is used by pins and filters that must support the stopping of streams. It sets the <A HREF="../dtypes.htm#StreamControlState">StreamControlState</A> enumeration type to STREAM_DISCARDING.

<P>In a video capture scenario, specify <A HREF="../iface/IAMStreamControl.htm#StopAt">StopAt</A> on both the output pin of a capture filter and an <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_I.htm#input_pin')">input pin</A> of a multiplexer and have the multiplexer send notification of completion. This ensures that the capture filter doesn't needlessly capture extra frames, while also guaranteeing that the multiplexer has written the last frame to disk.

<P>In addition, the capture output pin should specify TRUE for the <I>bSendExtra</I> variable while all other pins specify FALSE. If an extra frame is not sent the multiplexer will end up waiting for the stop time indefinitely and not realize it already has received all the capture information.

<P>If you are using <A HREF="../iface/ICaptureGraphBuilder.htm">ICaptureGraphBuilder</A>, the <A HREF="../iface/ICaptureGraphBuilder.htm#ControlStream">ICaptureGraphBuilder::ControlStream</A> method will accomplish all this for you automatically.

<P><B>Note</B>  If a stop time is given in the middle of a packet, the filter will deliver the whole packet before going into a discarding state. Also, if start and stop are scheduled for a single point in time, the effect is as if the start occurred an infinitesimal time before the stop. You can use this effect to capture a single frame. 

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
