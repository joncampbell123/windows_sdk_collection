<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IMediaSeeking Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IMediaSeeking Interface">
<META NAME="Description" CONTENT="IMediaSeeking::CheckCapabilities">
<META NAME="Description" CONTENT="IMediaSeeking::ConvertTimeFormat">
<META NAME="Description" CONTENT="IMediaSeeking::GetAvailable">
<META NAME="Description" CONTENT="IMediaSeeking::GetCapabilities">
<META NAME="Description" CONTENT="IMediaSeeking::GetCurrentPosition">
<META NAME="Description" CONTENT="IMediaSeeking::GetDuration">
<META NAME="Description" CONTENT="IMediaSeeking::GetPositions">
<META NAME="Description" CONTENT="IMediaSeeking::GetPreroll">
<META NAME="Description" CONTENT="IMediaSeeking::GetRate">
<META NAME="Description" CONTENT="IMediaSeeking::GetStopPosition">
<META NAME="Description" CONTENT="IMediaSeeking::GetTimeFormat">
<META NAME="Description" CONTENT="IMediaSeeking::IsFormatSupported">
<META NAME="Description" CONTENT="IMediaSeeking::IsUsingTimeFormat">
<META NAME="Description" CONTENT="IMediaSeeking::QueryPreferredFormat">
<META NAME="Description" CONTENT="IMediaSeeking::SetPositions">
<META NAME="Description" CONTENT="IMediaSeeking::SetRate">
<META NAME="Description" CONTENT="IMediaSeeking::SetTimeFormat">
<META NAME="Description" CONTENT="CheckCapabilities (IMediaSeeking)">
<META NAME="Description" CONTENT="ConvertTimeFormat (IMediaSeeking)">
<META NAME="Description" CONTENT="GetAvailable (IMediaSeeking)">
<META NAME="Description" CONTENT="GetCapabilities (IMediaSeeking)">
<META NAME="Description" CONTENT="GetCurrentPosition (IMediaSeeking)">
<META NAME="Description" CONTENT="GetDuration (IMediaSeeking)">
<META NAME="Description" CONTENT="GetPositions (IMediaSeeking)">
<META NAME="Description" CONTENT="GetPreroll (IMediaSeeking)">
<META NAME="Description" CONTENT="GetRate (IMediaSeeking)">
<META NAME="Description" CONTENT="GetStopPosition (IMediaSeeking)">
<META NAME="Description" CONTENT="GetTimeFormat (IMediaSeeking)">
<META NAME="Description" CONTENT="IsFormatSupported (IMediaSeeking)">
<META NAME="Description" CONTENT="IsUsingTimeFormat (IMediaSeeking)">
<META NAME="Description" CONTENT="QueryPreferredFormat (IMediaSeeking)">
<META NAME="Description" CONTENT="SetPositions (IMediaSeeking)">
<META NAME="Description" CONTENT="SetRate (IMediaSeeking)">
<META NAME="Description" CONTENT="SetTimeFormat (IMediaSeeking)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IMediaSeeking"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IMediaSample2.htm">IMediaSample2 Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IMediaTypeInfo.htm">IMediaTypeInfo Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IMediaSeeking Interface</H1>

<P>Although <A HREF="IMediaPosition.htm">IMediaPosition</A> allows applications a simple seeking interface on a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A>, it has a number of limitations. The <B>IMediaPosition</B> interface allows 
seeking only by using REFTIME time-based units; however, many filter graphs would prefer to seek 
on units of samples, video frames, or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#field')">fields</A> in a compressed stream. 
Also, the <B>IMediaPosition</B> interface uses separate <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">methods</A> to 
set and retrieve position properties, which can cause unnecessary <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> flushing.


<P>The <B>IMediaSeeking</B> interface improves on the <A HREF="IMediaPosition.htm">IMediaPosition</A> interface
by allowing arbitrary formats for seekable units, such as frames, bytes, and
100-second units of time. It also offers the ability to start and stop times
using a single method call, which is absent in <B>IMediaPosition</B>. 
When seeking to time units, <B>IMediaSeeking</B> expresses time as a 64-bit integer 
(<A HREF="../../appendixes/Further_Reading.htm#LONGLONG">LONGLONG</A>), providing greater accuracy than <B>IMediaPosition</B>, which expresses time 
in decimal seconds stored as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A>. 

However, because of this difference
in time unit data types, only <B>IMediaPosition</B> supports Automation.
<B>IMediaPosition</B> is maintained as an interface for this reason only. 
Applications not using Automation to seek the media stream should use the 
<B>IMediaSeeking</B> interface instead. 
 
<P>The <B>IMediaSeeking</B> interface is set by using a defined time format, such as 
TIME_FORMAT_MEDIA_TIME or TIME_FORMAT_SAMPLE, which then defines 
how parameters in other methods are interpreted. The format can 
be changed only when the filter graph is stopped (the default DirectShow
<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#plug_in_distributor')">plug-in distributor</A> method for this method takes care of this automatically,
effectively eliminating this restriction). 
Only one time format is available at any given time.

<P>When a filter is seeked in <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#media_time')">media time</A>, it must return a time at which the media seek positioned it.
For example, if a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#source_filter')">source filter</A> is seeked to frame 30, it might return 2 seconds if the
video is 15 frames per second. With that position time (of 2 seconds), the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> can then
seek all the other filters to that 2-second position so that the graph as a whole remains synchronized.

<P>Time formats are globally unique identifiers (<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#GUID')">GUIDs</A>), which are defined as follows:
<TABLE>
<TR><TH>GUID</TH><TH>Defined as</TH></TR>

<TR><TD>0L-0-0-0-0-0-0-0-0-0-0 </TD><TD>TIME_FORMAT_NONE
</TD></TR><TR><TD>7b785570-8c82-11cf-bc0c-00aa00ac74f6 </TD><TD>TIME_FORMAT_FRAME
</TD></TR><TR><TD>7b785571-8c82-11cf-bc0c-00aa00ac74f6 </TD><TD>TIME_FORMAT_BYTE
</TD></TR><TR><TD>7b785572-8c82-11cf-bc0c-00aa00ac74f6 </TD><TD>TIME_FORMAT_SAMPLE
</TD></TR><TR><TD>7b785573-8c82-11cf-bc0c-00aa00ac74f6 </TD><TD>TIME_FORMAT_FIELD
</TD></TR><TR><TD>7b785574-8c82-11cf-bc0c-00aa00ac74f6 </TD><TD>TIME_FORMAT_MEDIA_TIME
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>The filter graph manager exposes the <A HREF="IMediaSeeking.htm">IMediaSeeking</A> interface from the plug-in
distributor (PID) that handles this interface. If none of the filters within the graph 
support this interface, the PID will return E_NOINTERFACE; if at least one filter supports 
the interface, but all such filters return E_NOTIMPL, the PID will return E_NOTIMPL. 
Otherwise, the filter graph manager will return either a success or the first failure it encounters. 

<P>A success normally means that a seekable file source filter was found. 
Filters, such as a file source filter, will expose 
<A HREF="IMediaSeeking.htm">IMediaSeeking</A> if they can seek their data or if their <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pin</A> represents a seekable 
stream. The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> filter also should expose this interface. Output pins of <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#transform_filter')">transform filters</A> 
expose this interface to pass the positioning information upstream, from the renderer 
through each intermediate filter to the seekable filter. 

<P>Use the <A HREF="../class/CPosPassThru.htm#CPosPassThru">CPosPassThru</A> base class to implement this interface on output pins
of transform filters used to pass media positioning information upstream.
This is enabled by default in the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> base classes. Renderers can use the same class, 
although in most cases they should use <A HREF="../class/CRendererPosPassThru.htm#CRendererPosPassThru">CRendererPosPassThru</A>, 
which is derived from <B>CPosPassThru</B>, to implement this interface. 

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Applications can use this interface to set or retrieve properties such as the duration of the stream,
the current position, the stop time, and the media time format being used. Most commonly,
an application will use the methods on this interface to play a media stream for some duration
starting at some set position in the stream (for example, 10 seconds from the start). 

<P>A transform filter will call the <A HREF="IMediaSeeking.htm">IMediaSeeking</A> methods on the connected 
upstream pin when passing media times upstream from the renderer. 


<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IMediaSeeking methods</TH><TH>Description</TH></TR>

<TR><TD><A HREF="IMediaSeeking.htm#GetCapabilities">GetCapabilities</A>
 </TD><TD>Returns the seeking capabilities of the media stream.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#CheckCapabilities">CheckCapabilities</A>
 </TD><TD>Determines which capabilities exist on a media stream by
 applying seeking capability flags and checking the returned value.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#IsFormatSupported">IsFormatSupported</A>
 </TD><TD>Determines if a specified time format is supported.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#QueryPreferredFormat">QueryPreferredFormat</A>
 </TD><TD>Retrieves the preferred time format to be used by the interface.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#GetTimeFormat">GetTimeFormat</A>
 </TD><TD>Retrieves the current time format.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#IsUsingTimeFormat">IsUsingTimeFormat</A>
 </TD><TD>Determines if the time format being used in the call is the same as the 
 one currently in use by the interface.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#SetTimeFormat">SetTimeFormat</A>
 </TD><TD>Sets the time format, which determines the format of units used during seeking.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#GetDuration">GetDuration</A>
 </TD><TD>Retrieves the length of time that the media stream will play.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#GetStopPosition">GetStopPosition</A>
 </TD><TD>Retrieves the position within the media stream at which playback should stop.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#GetCurrentPosition">GetCurrentPosition</A>
 </TD><TD>Retrieves the current position within the media stream.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#ConvertTimeFormat">ConvertTimeFormat</A>
 </TD><TD>Converts a time from one time format to another.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#SetPositions">SetPositions</A>
 </TD><TD>Sets current and stop positions and applies flags to both.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#GetPositions">GetPositions</A>
 </TD><TD>Returns the current and stop position settings.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#GetAvailable">GetAvailable</A>
 </TD><TD>Returns the range of times in which seeking is efficient.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#SetRate">SetRate</A>
 </TD><TD>Sets a new playback rate.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#GetRate">GetRate</A>
 </TD><TD>Returns the current rate.

</TD></TR><TR><TD><A HREF="IMediaSeeking.htm#GetPreroll">GetPreroll</A>
 </TD><TD>Retrieves the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#preroll')">preroll</A> settings.


</TD></TR></TABLE>



<H1><A NAME="CheckCapabilities">IMediaSeeking::CheckCapabilities</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Determines which capabilities exist on a media stream by
applying seeking capability flags and checking the returned value.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>CheckCapabilities</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <B>*</B> <I>pCapabilities</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCapabilities</I></DT>
 <DD>[in, out] Pointer to an AM_SEEKING_SEEKING_CAPABILITIES <A HREF="../../appendixes/Further_Reading.htm#enum">enum</A> type containing the seeking capabilities flags to apply. These flags can be any combination of the following:
<UL>
<LI>AM_SEEKING_CanSeekAbsolute
<LI>AM_SEEKING_CanSeekForwards
<LI>AM_SEEKING_CanSeekBackwards
<LI>AM_SEEKING_CanGetCurrentPos
<LI>AM_SEEKING_CanGetStopPos
<LI>AM_SEEKING_CanGetDuration
<LI>AM_SEEKING_CanPlayBackwards
<LI>AM_SEEKING_CanDoSegments
<LI>AM_SEEKING_Source
</UL>
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if all capabilities in <I>pCapabilities</I> are present,
S_FALSE if some are present, or E_FAIL if none are present.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method determines which seeking capabilities are present
on a media stream. It applies the <I>pCapabilities</I> flags using a bitwise-AND
operation, and returns a value to indicate whether they match the capabilities of the
media stream. The value of <I>pCapabilities</I> is accumulated between successive 
calls to this method so that the value of <I>pCapabilities</I>
can be checked when an S_FALSE value is returned to find the capability that
does not match.

 


</BLOCKQUOTE>


<H1><A NAME="ConvertTimeFormat">IMediaSeeking::ConvertTimeFormat</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Converts a time from one format to another.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>ConvertTimeFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>pTarget</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>GUID</B> <B>*</B> <I>pTargetFormat</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <I>Source</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>GUID</B> <B>*</B> <I>pSourceFormat</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pTarget</I>
 </DT><DD>[out] Time in converted format. 
</DD><DT><I>pTargetFormat</I>
 </DT><DD>[in] <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#GUID')">GUID</A> of the format to convert to, or the currently selected format if NULL. 
</DD><DT><I>Source</I>
 </DT><DD>[in] Time in original format. 
</DD><DT><I>pSourceFormat</I>
 </DT><DD>[in] <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#GUID')">GUID</A> of the format to be converted from, or the currently selected format if NULL.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns NOERROR for success and E_NOTIMPL if the method is not implemented.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Time formats can be converted between any two of the following:
<UL>
<LI>TIME_FORMAT_FIELD
<LI>TIME_FORMAT_FRAME
<LI>TIME_FORMAT_MEDIA_TIME
<LI>TIME_FORMAT_NONE
<LI>TIME_FORMAT_SAMPLE
</UL>
</BLOCKQUOTE>



<H1><A NAME="GetAvailable">IMediaSeeking::GetAvailable</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Returns the range of times in which seeking is efficient.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetAvailable</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>pEarliest</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>pLatest</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pEarliest</I>
 </DT><DD>[out] Earliest time that can be efficiently seeked to.
</DD><DT><I>pLatest</I>
 </DT><DD>[out] Latest time that can be efficiently seeked to.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns S_OK for success and E_NOTIMPL if the method is not implemented.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method is intended primarily for seeking in media streams that
might have excessive latency, such as when playing back media "live" from 
an Internet server. The returned values indicate cached data that has already arrived, 
which can be easily seeked. It is assumed that seeking to values beyond these 
returned parameters will cause a delay while waiting for the data to arrive. 

</BLOCKQUOTE>


<H1><A NAME="GetCapabilities">IMediaSeeking::GetCapabilities</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Returns the seeking capabilities of the media stream.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetCapabilities</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <B>*</B> <I>pCapabilities</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCapabilities</I>
 </DT><DD>[out] Seeking capability flags, which can be 
 any combination of the following:
<UL>
<LI>AM_SEEKING_CanSeekAbsolute
<LI>AM_SEEKING_CanSeekForwards 
<LI>AM_SEEKING_CanSeekBackwards
<LI>AM_SEEKING_CanGetCurrentPos
<LI>AM_SEEKING_CanGetStopPos
<LI>AM_SEEKING_CanGetDuration
<LI>AM_SEEKING_CanPlayBackwards
<LI>AM_SEEKING_CanDoSegments
<LI>AM_SEEKING_Source
</UL>
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns S_OK.

</BLOCKQUOTE>


<H1><A NAME="GetCurrentPosition">IMediaSeeking::GetCurrentPosition</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Retrieves the current position in terms of the total length of the media stream.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetCurrentPosition</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG*</B> <I>pCurrent</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCurrent</I>
 </DT><DD>[out] Current position in current time format units.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns E_POINTER if the pointer argument is NULL, or another COM return code otherwise.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The current position is the position that playback has reached. It is a value 
between zero and the duration. If the filter graph is paused, this is the position at 
which it will restart.

<P>Since <A HREF="IMediaSeeking.htm">IMediaSeeking</A> uses media times for its time parameters, the current position
value is independent of any rate or start position that might have been set.

<P>When the filter graph is stopped or paused, this method returns the position at 
which playback will recommence. 
When the filter graph is running, the filter graph manager returns the position
according to the data arriving at the renderer. If an individual filter implements 
this method, it should return the media time of the sample it is currently processing 
when paused or running.

<P>After stopping or pausing, a run command causes playback to begin at
the current position. This will be where playback stopped or paused, unless
there has been an <A HREF="IMediaSeeking.htm#SetPositions">IMediaSeeking::SetPositions</A> call in the meantime
to reset the start position. 

</BLOCKQUOTE>


<H1><A NAME="GetDuration">IMediaSeeking::GetDuration</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Retrieves the length of time that the media stream will play.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetDuration</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG*</B> <I>pDuration</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pDuration</I>
 </DT><DD>[out] Returned length of the media stream.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns E_POINTER if the pointer argument is NULL, or another COM return code otherwise.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The duration assumes normal playback speed, and it is therefore unaffected 
by the rate. Although <A HREF="IMediaSeeking.htm">IMediaSeeking</A> allows filters to be seeked in media
time, it still requires that the media samples it sends downstream are <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#time_stamp')">time stamped</A>
appropriately. 
</BLOCKQUOTE>


<H1><A NAME="GetPositions">IMediaSeeking::GetPositions</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Returns the current and stop position settings.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetPositions</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>pCurrent</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>pStop</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCurrent</I>
 </DT><DD>[out] Start time in the current time format.
</DD><DT><I>pStop</I>
 </DT><DD>[out] Stop time in the current time format.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method is provided for efficiency so that just one call will retrieve 
both the current and stop position. 
</BLOCKQUOTE>


<H1><A NAME="GetPreroll">IMediaSeeking::GetPreroll</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Retrieves the preroll settings.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetPreroll</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>pllPreroll</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pllPreroll</I>
 </DT><DD>[out] Returned <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#preroll_time')">preroll time</A>. 
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns S_OK for success and E_NOTIMPL if the method is not implemented.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method retrieves the time prior to the start position that the filter graph
begins any nonrandom access device rolling.
</BLOCKQUOTE>


<H1><A NAME="GetRate">IMediaSeeking::GetRate</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Retrieves the current rate.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetRate</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <B>*</B> <I>dRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dRate</I>
 </DT><DD>[out] Current rate, where 1 is the normal rate. 
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.


</BLOCKQUOTE>


<H1><A NAME="GetStopPosition">IMediaSeeking::GetStopPosition</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Retrieves the time at which the media stream stops.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetStopPosition</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG*</B> <I>pStop</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pStop</I>
 </DT><DD>[out] Returned stop time.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns E_POINTER if the pointer argument is NULL, S_OK for success, or E_NOTIMPL if the method is not implemented.




</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The stop position is a time between zero and the duration of the media
at which playback should stop.

<P>The stop position is applied before the rate and therefore is the position at 
typical playback speed.
</BLOCKQUOTE>


<H1><A NAME="GetTimeFormat">IMediaSeeking::GetTimeFormat</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Retrieves the current time format, which determines the format of units used during seeking.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetTimeFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>GUID</B> <B>*</B> <I>pFormat</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pFormat</I>
 </DT><DD>[out] Time format currently supported by this interface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns S_OK for success, or E_NOTIMPL if the method is not implemented.




</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>See the <A HREF="IMediaSeeking.htm#IsFormatSupported">IsFormatSupported</A> method 
for a list of time formats. Only one time format can be
set on the filter graph at any one time.
</BLOCKQUOTE>


<H1><A NAME="IsFormatSupported">IMediaSeeking::IsFormatSupported</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Determines if a specified time format is supported.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>IsFormatSupported</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>GUID</B> <B>*</B> <I>pFormat</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pFormat</I>
 </DT><DD>[in] Time format to compare.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns S_OK if the time format is supported; otherwise returns S_FALSE.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Time formats are defined as follows:
<TABLE>
<TR><TD>TIME_FORMAT_NONE
 </TD><TD>Seeking is not supported.
</TD></TR><TR><TD>TIME_FORMAT_FRAME
 </TD><TD>Seeks to specific video frames.
</TD></TR><TR><TD>TIME_FORMAT_SAMPLE
 </TD><TD>Seeks to samples in the stream.
</TD></TR><TR><TD>TIME_FORMAT_FIELD
 </TD><TD>Seeks to interlaced video fields.
</TD></TR><TR><TD>TIME_FORMAT_BYTE
 </TD><TD>Seeks to a byte in the stream.
</TD></TR><TR><TD>TIME_FORMAT_MEDIA_TIME
 </TD><TD>Seeks to time stamps on the media samples. 
</TD></TR></TABLE>
<P>Third-party vendors are encouraged to add their own time formats to this
list.

</BLOCKQUOTE>


<H1><A NAME="IsUsingTimeFormat">IMediaSeeking::IsUsingTimeFormat</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Determines if the time format being used in the call is the same as the 
 one currently in use by the interface.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>IsUsingTimeFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>GUID</B> <B>*</B> <I>pFormat</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pFormat</I>
 </DT><DD>[in] Time format to check.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns S_OK if <I>pFormat</I> is the current time format; otherwise returns S_FALSE.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This can be used in place of <A HREF="IMediaSeeking.htm#GetTimeFormat">IMediaSeeking::GetTimeFormat</A> to compare time
formats, since it is faster and does not require copying the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#GUID')">GUID</A>.

</BLOCKQUOTE>


<H1><A NAME="QueryPreferredFormat">IMediaSeeking::QueryPreferredFormat</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Retrieves the preferred time format to be used by the interface.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryPreferredFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>GUID</B> <B>*</B> <I>pFormat</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pFormat</I>
 </DT><DD>[out] Time format preferred by the interface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns NOERROR.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>See the description for <A HREF="IMediaSeeking.htm#IsFormatSupported">IsFormatSupported</A> 
for a list of available time formats. If the time format returned is not satisfactory, use the
<B>IsFormatSupported</B> method to query for supported time formats that you can use.
</BLOCKQUOTE>


<H1><A NAME="SetPositions">IMediaSeeking::SetPositions</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Sets current and stop positions and applies flags to both.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetPositions</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>pCurrent</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwCurrentFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>pStop</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwStopFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCurrent</I>
 </DT><DD>[in,out] Start position if stopped, or position from which to continue if paused.
</DD><DT><I>dwCurrentFlags</I>
 </DT><DD>[in] When seeking, one of these flags must be set to indicate the type of seek.
The flags passed to this method should include one positioning value and 
(optionally) any of the nonpositioning values.
 <TABLE>
 <TR><TD><A NAME="AM_SEEKING_NoPositio">AM_SEEKING_NoPositioning</A></TD><TD>No change in positioning.
 </TD></TR><TR><TD><A NAME="AM_SEEKING_AbsoluteP">AM_SEEKING_AbsolutePositioning</A></TD><TD>Position supplied is absolute.
 </TD></TR><TR><TD><A NAME="AM_SEEKING_RelativeP">AM_SEEKING_RelativePositioning</A> </TD><TD>Position supplied is relative to the current position.
 </TD></TR><TR><TD><A NAME="AM_SEEKING_Increment">AM_SEEKING_IncrementalPositioning</A> </TD><TD>Stop position relative to current; 
 useful for seeking when paused
 (only valid in conjunction with stop times).
 </TD></TR><TR><TD><A NAME="AM_SEEKING_Positioni">AM_SEEKING_PositioningBitsMask</A> </TD><TD>Mask flag; determine if seeking is required by 
 performing a bitwise AND of the four flags
 listed above and this mask. If the resulting value
 is nonzero, some form of seeking is required. Check
 the value of the last two bits to determine which of the above flags are set.
 </TD></TR><TR><TD><A NAME="AM_SEEKING_SeekToKey">AM_SEEKING_SeekToKeyFrame</A> </TD><TD>Seek to the nearest key frame (not as accurate but quicker).
 </TD></TR><TR><TD><A NAME="AM_SEEKING_ReturnTim">AM_SEEKING_ReturnTime</A> </TD><TD>Return the media time equivalents for 
 <I>pCurrent</I> and <I>pStop</I> (overwriting these values with the returned values).
</TD></TR><TR><TD><A NAME="AM_SEEKING_Segment">AM_SEEKING_Segment</A> </TD><TD>At the end of the segment call EC_ENDOFSEGMENT instead of EndOfStream.
</TD></TR><TR><TD><A NAME="AM_SEEKING_NoFlush">AM_SEEKING_NoFlush</A> </TD><TD>Do not flush.
 
</TD></TR></TABLE>
</DD><DT><I>pStop</I>
 </DT><DD>[in,out] Position in the stream at which to quit.
</DD><DT><I>dwStopFlags</I>
 </DT><DD>[in] Stop position seeking options to be applied. These are the same 
as listed for <I>dwCurrentFlags</I>.
 
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns E_POINTER if the pointer argument is NULL, NOERROR for success, E_INVALIDARG if a parameter is out of range, or another COM return code otherwise.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The following code fragment checks for the type of seeking required.

<PRE>switch ( dwFlags &amp; AM_SEEKING_PositioningBitsMask )
{
&#009;case AM_SEEKING_IncrementalPositioning:
&#009;&#009;// Check this is on a stop time
&#009;&#009;// Get Current, add this delta, apply result as new stop time
&#009;&#009;break;
&#009;case AM_SEEKING_RelativePositioning:
&#009;&#009;// ...
&#009;&#009;break;
&#009;case AM_SEEKING_AbsolutePositioning:
&#009;&#009;// ...
&#009;&#009;break;
&#009;case AM_SEEKING_NoPositioning:
&#009;&#009;// Nothing to do.
&#009;&#009;break;
}
</PRE>
</BLOCKQUOTE>


<H1><A NAME="SetRate">IMediaSeeking::SetRate</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Sets a new playback rate.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetRate</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <I>dRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dRate</I>
 </DT><DD>[in] New rate, where 1 is the normal rate, 2 is twice as fast, and so on. 
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns S_OK for success, E_INVALIDARG if the parameter is invalid, or E_NOTIMPL if the method is not implemented.

</BLOCKQUOTE>


<H1><A NAME="SetTimeFormat">IMediaSeeking::SetTimeFormat</A><HR size=1></H1>
<A HREF="IMediaSeeking.htm">IMediaSeeking Interface</A>
<P>Sets the time format, which determines the format of units used during seeking.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetTimeFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>GUID</B> <B>*</B> <I>pFormat</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pFormat</I>
 </DT><DD>[in] Time format to be supported by this interface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The default DirectShow implementation returns S_OK for success, E_FAIL for failure, or E_NOTIMPL if the method is not implemented.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>See the <A HREF="IMediaSeeking.htm#IsFormatSupported">IsFormatSupported</A> method 
for a list of time formats.
<P>The filter graph must be stopped before calling this method or
a <A HREF="../Error_Success_Codes.htm#VFW_E_WRONG_STATE">VFW_E_WRONG_STATE</A> error will be returned.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
