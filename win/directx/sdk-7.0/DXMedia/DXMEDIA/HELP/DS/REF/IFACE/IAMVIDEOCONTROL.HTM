<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IAMVideoControl Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IAMVideoControl Interface">
<META NAME="Description" CONTENT="IAMVideoControl::GetCaps">
<META NAME="Description" CONTENT="IAMVideoControl::GetCurrentActualFrameRate">
<META NAME="Description" CONTENT="IAMVideoControl::GetFrameRateList">
<META NAME="Description" CONTENT="IAMVideoControl::GetMaxAvailableFrameRate">
<META NAME="Description" CONTENT="IAMVideoControl::GetMode">
<META NAME="Description" CONTENT="IAMVideoControl::SetMode">
<META NAME="Description" CONTENT="GetCaps (IAMVideoControl)">
<META NAME="Description" CONTENT="GetCurrentActualFrameRate (IAMVideoControl)">
<META NAME="Description" CONTENT="GetFrameRateList (IAMVideoControl)">
<META NAME="Description" CONTENT="GetMaxAvailableFrameRate (IAMVideoControl)">
<META NAME="Description" CONTENT="GetMode (IAMVideoControl)">
<META NAME="Description" CONTENT="SetMode (IAMVideoControl)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IAMVideoControl"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IAMVideoCutListElement.htm">IAMVideoCutListElement Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IAMVideoControl Interface</H1>
<P>The <B>IAMVideoControl</B> interface allows you to flip a picture horizontally and/or
 vertically, set up a stream so it can capture from an external trigger (such as a camera button that the user pushes), simulate an external trigger in software, and list the available frame rates.

<P>This interface uses the video control flags in the <A HREF="../dtypes.htm#VideoControlFlags">VideoControlFlags</A> enumeration.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>

<P>Implement this interface when your <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> needs to control the video image or to list the frame rates.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>

<P>Use this interface when your application runs on hardware that is capable of flipping and external triggering.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>

<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Retrieves pointers to supported interfaces.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IAMVideoControl methods</TH><TH>Description
 </TH></TR><TR><TD><A HREF="IAMVideoControl.htm#GetCaps">GetCaps</A>
 </TD><TD>Retrieves the capabilities of the underlying hardware.
 </TD></TR><TR><TD><A HREF="IAMVideoControl.htm#SetMode">SetMode</A>
 </TD><TD>Sets the video control mode of operation.
 </TD></TR><TR><TD><A HREF="IAMVideoControl.htm#GetMode">GetMode</A>
 </TD><TD>Retrieves the video control mode of operation.
 </TD></TR><TR><TD><A HREF="IAMVideoControl.htm#GetCurrentActualFrameRate">GetCurrentActualFrameRate</A>
 </TD><TD>Retrieves the actual frame rate at which the device is streaming. This method is used with devices, such as the Universal Serial Bus (USB) or cameras that use the IEEE 1394 serial standard, where the maximum frame rate can be limited by bandwidth availability. This is only available during video streaming.
 </TD></TR><TR><TD><A HREF="IAMVideoControl.htm#GetMaxAvailableFrameRate">GetMaxAvailableFrameRate</A>
 </TD><TD>Retrieves the maximum frame rate currently available based on bus bandwidth usage for connections such as USB and IEEE 1394 camera devices where the maximum frame rate can be limited by bandwidth availability.
 </TD></TR><TR><TD><A HREF="IAMVideoControl.htm#GetFrameRateList">GetFrameRateList</A>
</TD>
<TD>Retrieves a list of available frame rates.
</TD></TR></TABLE>



<H1><A NAME="GetCaps">IAMVideoControl::GetCaps</A><HR size=1></H1>
<A HREF="IAMVideoControl.htm">IAMVideoControl Interface</A>
<P>Retrieves the capabilities of the underlying hardware.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetCaps</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B><I>pCapsFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> to query capabilities from. 
</DD><DT><I>pCapsFlags</I>
 </DT><DD>[out] Pointer to a value representing a combination of the flags from the <A HREF="../dtypes.htm#VideoControlFlags">VideoControlFlags</A> enumeration. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Possible capabilities include one or more of the following: flipping the picture horizontally, flipping the picture vertically, enabling external triggers, and simulating external triggers.</BLOCKQUOTE> 



<H1><A NAME="GetCurrentActualFrameRate">IAMVideoControl::GetCurrentActualFrameRate</A><HR size=1></H1>
<A HREF="IAMVideoControl.htm">IAMVideoControl Interface</A>
<P>Retrieves the actual frame rate, expressed as a frame duration in 100-nanosecond units. USB (Universal Serial Bus) and IEEE 1394 cameras may provide lower frame rates than requested because of bandwidth availability. This is only available during video streaming.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetCurrentActualFrameRate</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B><I>ActualFrameRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to retrieve the frame rate from. 
</DD><DT><I>ActualFrameRate</I>
 </DT><DD>[out] Pointer to the frame rate in frame duration in 100-nanosecond units.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

</BLOCKQUOTE>


<H1><A NAME="GetFrameRateList">IAMVideoControl::GetFrameRateList</A><HR size=1></H1>
<A HREF="IAMVideoControl.htm">IAMVideoControl Interface</A>
<P>Retrieves a list of available frame rates.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetFrameRateList</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>iIndex</I><B>,</B><BR>&nbsp;&nbsp;<B>SIZE</B> <I>Dimensions</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B><I>ListSize</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>**</B> <I>FrameRates</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to query for the list of frame rates. 
</DD><DT><I>iIndex</I>
 </DT><DD>[in] Index of the format to query for frame rates. This index corresponds to the order in which formats are enumerated by <A HREF="IAMStreamConfig.htm#GetStreamCaps">IAMStreamConfig::GetStreamCaps</A>. The value must range between zero and the number of supported <A HREF="../structs.htm#VIDEO_STREAM_CONFIG_CAPS">VIDEO_STREAM_CONFIG_CAPS</A> structures returned by <A HREF="IAMStreamConfig.htm#GetNumberOfCapabilities">IAMStreamConfig::GetNumberOfCapabilities</A>) minus one.
</DD><DT><I>Dimensions</I>
 </DT><DD>[in] Frame image size (width and height) in pixels.  
</DD><DT><I>ListSize</I>
 </DT><DD>[out] Pointer to the number of elements in the list of frame rates.
</DD><DT><I>FrameRates</I>
 </DT><DD>[out] Array of frame rates in 100-nanosecond units. Can be NULL if you only need <I>ListSize</I>.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>

<p>The caller is responsible for freeing the memory through a call to <A HREF="../../Appendixes/Further_Reading.htm#CoTaskMemFree">CoTaskMemFree</A>.

</BLOCKQUOTE>


<H1><A NAME="GetMaxAvailableFrameRate">IAMVideoControl::GetMaxAvailableFrameRate</A><HR size=1></H1>
<A HREF="IAMVideoControl.htm">IAMVideoControl Interface</A>
<P>Retrieves the maximum frame rate currently available, based on bus bandwidth usage for connections, such as USB and IEEE 1394, where the maximum frame rate may be limited by bandwidth availability.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetMaxAvailableFrameRate</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>iIndex</I><B>,</B><BR>&nbsp;&nbsp;<B>SIZE</B> <I>Dimensions</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <B>*</B> <I>MaxAvailableFrameRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to retrieve the maximum frame rate from. 
</DD><DT><I>iIndex</I>
 </DT><DD>[in] Index of the format to query for maximum frame rate. This index corresponds to the order in which formats are enumerated by <A HREF="IAMStreamConfig.htm#GetStreamCaps">IAMStreamConfig::GetStreamCaps</A>. The value must range between zero and the number of supported <A HREF="../structs.htm#VIDEO_STREAM_CONFIG_CAPS">VIDEO_STREAM_CONFIG_CAPS</A> structures returned by <A HREF="IAMStreamConfig.htm#GetNumberOfCapabilities">IAMStreamConfig::GetNumberOfCapabilities</A>) minus one.
</DD><DT><I>Dimensions</I>
 </DT><DD>[in] Frame image size (width and height) in pixels.  
</DD><DT><I>MaxAvailableFrameRate</I>
 </DT><DD>[out] Pointer to the maximum available frame rate. The frame rate is expressed as frame duration in 100-nanosecond units.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

</BLOCKQUOTE>


<H1><A NAME="GetMode">IAMVideoControl::GetMode</A><HR size=1></H1>
<A HREF="IAMVideoControl.htm">IAMVideoControl Interface</A>
<P>Retrieves the video control mode of operation.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetMode</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B>  <B>*</B><I>Mode</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to retrieve the video control mode from. 
</DD><DT><I>Mode</I>
 </DT><DD>[out] Pointer to a value representing a combination of the flags from the <A HREF="../dtypes.htm#VideoControlFlags">VideoControlFlags</A> enumeration, which specify the video control mode. 
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>

<P>Possible modes of operation include one or more of the following:
flipping the picture horizontally, flipping the picture vertically, enabling external triggers, and simulating external triggers. 

</BLOCKQUOTE>


<H1><A NAME="SetMode">IAMVideoControl::SetMode</A><HR size=1></H1>
<A HREF="IAMVideoControl.htm">IAMVideoControl Interface</A>
<P>Sets the video control mode of operation.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetMode</B> <B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B><I>pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B>  <B>*</B><I>Mode</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
 </DT><DD>[in] Pointer to the pin to set the video control mode on. 
</DD><DT><I>Mode</I>
 </DT><DD>[in] Pointer to a value specifying a combination of the flags from the <A HREF="../dtypes.htm#VideoControlFlags">VideoControlFlags</A> enumeration to set the video control mode. 
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>

<P>Possible modes of operation include one or more of the following:
flipping the picture horizontally, flipping the picture vertically, enabling external triggers, and simulating external triggers. 
</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
