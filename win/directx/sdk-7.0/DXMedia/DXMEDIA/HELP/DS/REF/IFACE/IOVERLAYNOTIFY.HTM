<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IOverlayNotify Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IOverlayNotify Interface">
<META NAME="Description" CONTENT="IOverlayNotify::OnClipChange">
<META NAME="Description" CONTENT="IOverlayNotify::OnColorKeyChange">
<META NAME="Description" CONTENT="IOverlayNotify::OnPaletteChange">
<META NAME="Description" CONTENT="IOverlayNotify::OnPositionChange">
<META NAME="Description" CONTENT="OnClipChange (IOverlayNotify)">
<META NAME="Description" CONTENT="OnColorKeyChange (IOverlayNotify)">
<META NAME="Description" CONTENT="OnPaletteChange (IOverlayNotify)">
<META NAME="Description" CONTENT="OnPositionChange (IOverlayNotify)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IOverlayNotify"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IOverlay.htm">IOverlay Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IPin.htm">IPin Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IOverlayNotify Interface</H1>

<P>The <B>IOverlayNotify</B> interface provides an upstream <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A>, such as a decoder, with
notifications of changes to the rendering window. This includes notifications
of changes to the palette, color key, and window position, and visible region
(clipping) changes.

<P>Most software video decoders let the video <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> draw the decompressed
images they produce by passing the media samples to the <A HREF="IMemInputPin.htm">IMemInputPin</A>
interface on the renderer's <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_I.htm#input_pin')">input pin</A>.

<P>However, some video decoding filters (typically hardware decompression boards)
handle the drawing of the images themselves, perhaps by using a VGA connector.
These filters do not need to use <A HREF="IMemInputPin.htm">IMemInputPin</A>, but can instead use the
<A HREF="IOverlay.htm">IOverlay</A> interface provided by the renderer input pin.
Through this interface, the decoder can be notified when the window position
or size changes, or when the current system palette changes
in order to install and change color keys and palettes.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>To get notifications of when the window size or position changes, when the current
system palette changes, or when a different color key is used, decoders that
do their own drawing should implement an <A HREF="IOverlayNotify.htm">IOverlayNotify</A> interface.
A pointer to this interface can then be passed to the <A HREF="IOverlay.htm">IOverlay</A> interface on the renderer's input pin, through the <A HREF="IOverlay.htm#Advise">IOverlay::Advise</A> <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">method</A>, to set up an <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#advise')">advise</A> link (essentially a callback mechanism).
After the advise link is established, the renderer calls the decoder's <B>IOverlayNotify</B> methods when the appropriate events occur. An advise link can be canceled by calling <A HREF="IOverlay.htm#Unadvise">IOverlay::Unadvise</A>.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>The video renderer is the only filter that calls the methods on this
interface. This is done automatically by the default video renderer. If you
are writing a replacement video renderer, you will need to use the
methods on this interface if your filter supports <A HREF="IOverlay.htm">IOverlay</A> and
this interface is passed to your filter in an <A HREF="IOverlay.htm#Advise">IOverlay::Advise</A>
call.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IOverlayNotify methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IOverlayNotify.htm#OnPaletteChange">OnPaletteChange</A>
</TD><TD>Provides notification that the palette of the window has changed.
</TD></TR><TR><TD><A HREF="IOverlayNotify.htm#OnClipChange">OnClipChange</A>
</TD><TD>Provides notification that the visible region of the window has changed.
</TD></TR><TR><TD><A HREF="IOverlayNotify.htm#OnColorKeyChange">OnColorKeyChange</A>
</TD><TD>Provides notification that the chroma key has changed.


</TD></TR><TR><TD><A HREF="IOverlayNotify.htm#OnPositionChange">OnPositionChange</A>
</TD><TD>Provides notification that the position has changed.
</TD></TR></TABLE>



<H1><A NAME="OnClipChange">IOverlayNotify::OnClipChange</A><HR size=1></H1>
<A HREF="IOverlayNotify.htm">IOverlayNotify Interface</A>
<P>Provides notification that the window's visible region has changed. It is
essential that any overlay hardware be updated to reflect the change
to the visible region before returning from this method.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>OnClipChange</B><B>(</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pSourceRect</I><B>,</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pDestinationRect</I><B>,</B><BR>&nbsp;&nbsp;<B>RGNDATA</B> <I>*pRgnData</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSourceRect</I>
</DT><DD>[in] Region of the video to use.
</DD><DT><I>pDestinationRect</I>
</DT><DD>[in] Video destination.
</DD><DT><I>pRgnData</I>
</DT><DD>[in] Clipping information.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The calls to <B>OnClipChange</B> happen in synchronization with the window. It is
called with an empty clip list to freeze the video before the window moves, and then called again
when the window has stabilized with the new clip list.

<P>If the window rectangle is all zeros, the window is invisible. The
filter must take a copy of the information if it needs to store it.





</BLOCKQUOTE>


<H1><A NAME="OnColorKeyChange">IOverlayNotify::OnColorKeyChange</A><HR size=1></H1>
<A HREF="IOverlayNotify.htm">IOverlayNotify Interface</A>
<P>Provides notification that the window's color key has changed.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>OnColorKeyChange</B><B>(</B><BR>&nbsp;&nbsp;<B>COLORKEY</B> <B>*</B> <I>pColorKey</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pColorKey</I>
</DT><DD>[in] Defines the new chroma key.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>

</BLOCKQUOTE>


<H1><A NAME="OnPaletteChange">IOverlayNotify::OnPaletteChange</A><HR size=1></H1>
<A HREF="IOverlayNotify.htm">IOverlayNotify Interface</A>
<P>Provides notification that the palette of the window has changed.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>OnPaletteChange</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwColors</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>PALETTEENTRY</B> <B>*</B> <I>pPalette</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwColors</I>
</DT><DD>[in] Number of colors present.
</DD><DT><I>pPalette</I>
</DT><DD>[in] Array of palette colors.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Before returning, the filter should copy the array of <A HREF="../../appendixes/Further_Reading.htm#RGBQUAD">RGBQUAD</A> values, if necessary.
</BLOCKQUOTE>


<H1><A NAME="OnPositionChange">IOverlayNotify::OnPositionChange</A><HR size=1></H1>
<A HREF="IOverlayNotify.htm">IOverlayNotify Interface</A>
<P>Provides notification that the position has changed.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>OnPositionChange</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>RECT</B> <I>*pSourceRect</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>RECT</B> <I>*pDestinationRect</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSourceRect</I>
</DT><DD>[in] Source video rectangle.
</DD><DT><I>pDestinationRect</I>
</DT><DD>[in] Destination video rectangle. Note that this is not
clipped to the visible display area.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method is a callback intended for use by hardware overlay cards
that do not want the expense of synchronous clipping updates, and just want to know
when the source or destination video positions change.

<P>Unlike the <A HREF="IOverlayNotify.htm#OnClipChange">IOverlayNotify::OnClipChange</A> method, this method is not
called in synchronization with the window changing but, rather, at some point after the window
has changed (basically in time with WM_SIZE messages received).
This is therefore suitable for overlay cards that do not inlay their data to the frame buffer.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
