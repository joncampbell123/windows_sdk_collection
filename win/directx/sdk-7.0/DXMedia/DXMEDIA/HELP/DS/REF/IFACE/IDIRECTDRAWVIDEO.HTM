<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IDirectDrawVideo Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IDirectDrawVideo Interface">
<META NAME="Description" CONTENT="IDirectDrawVideo::CanUseOverlayStretch">
<META NAME="Description" CONTENT="IDirectDrawVideo::CanUseScanLine">
<META NAME="Description" CONTENT="IDirectDrawVideo::GetCaps">
<META NAME="Description" CONTENT="IDirectDrawVideo::GetDirectDraw">
<META NAME="Description" CONTENT="IDirectDrawVideo::GetEmulatedCaps">
<META NAME="Description" CONTENT="IDirectDrawVideo::GetFourCCCodes">
<META NAME="Description" CONTENT="IDirectDrawVideo::GetSurfaceDesc">
<META NAME="Description" CONTENT="IDirectDrawVideo::GetSurfaceType">
<META NAME="Description" CONTENT="IDirectDrawVideo::GetSwitches">
<META NAME="Description" CONTENT="IDirectDrawVideo::SetDefault">
<META NAME="Description" CONTENT="IDirectDrawVideo::SetDirectDraw">
<META NAME="Description" CONTENT="IDirectDrawVideo::SetSwitches">
<META NAME="Description" CONTENT="IDirectDrawVideo::UseOverlayStretch">
<META NAME="Description" CONTENT="IDirectDrawVideo::UseScanLine">
<META NAME="Description" CONTENT="IDirectDrawVideo::UseWhenFullScreen">
<META NAME="Description" CONTENT="IDirectDrawVideo::WillUseFullScreen">
<META NAME="Description" CONTENT="CanUseOverlayStretch (IDirectDrawVideo)">
<META NAME="Description" CONTENT="CanUseScanLine (IDirectDrawVideo)">
<META NAME="Description" CONTENT="GetCaps (IDirectDrawVideo)">
<META NAME="Description" CONTENT="GetDirectDraw (IDirectDrawVideo)">
<META NAME="Description" CONTENT="GetEmulatedCaps (IDirectDrawVideo)">
<META NAME="Description" CONTENT="GetFourCCCodes (IDirectDrawVideo)">
<META NAME="Description" CONTENT="GetSurfaceDesc (IDirectDrawVideo)">
<META NAME="Description" CONTENT="GetSurfaceType (IDirectDrawVideo)">
<META NAME="Description" CONTENT="GetSwitches (IDirectDrawVideo)">
<META NAME="Description" CONTENT="SetDefault (IDirectDrawVideo)">
<META NAME="Description" CONTENT="SetDirectDraw (IDirectDrawVideo)">
<META NAME="Description" CONTENT="SetSwitches (IDirectDrawVideo)">
<META NAME="Description" CONTENT="UseOverlayStretch (IDirectDrawVideo)">
<META NAME="Description" CONTENT="UseScanLine (IDirectDrawVideo)">
<META NAME="Description" CONTENT="UseWhenFullScreen (IDirectDrawVideo)">
<META NAME="Description" CONTENT="WillUseFullScreen (IDirectDrawVideo)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDirectDrawVideo"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IDeferredCommand.htm">IDeferredCommand Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IDirectSound3DBuffer.htm">IDirectSound3DBuffer Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IDirectDrawVideo Interface</H1>
<P>This interface is on the video <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> and provides information about Microsoft&#174; DirectDraw&#174;
with respect to its use by the renderer. For example, the interface allows an application to get
details of the surface and any available hardware capabilities. It also allows the application
to adjust the surfaces that the renderer should use, and even to set the DirectDraw instance.

There is some duplication in this interface with the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface; however, this
interface allows simple access to that information without calling the DirectDraw provider
directly.

<P>DirectDraw is not loaded by the renderer until it is connected, and likewise DirectDraw is unloaded
only when the renderer is disconnected. When the renderer has allocated the DirectDraw surfaces it will use
for video playback, an application can obtain a <A HREF="../../appendixes/Further_Reading.htm#DDSURFACEDESC">DDSURFACEDESC</A> structure describing it.
By passing in a pointer to a <B>DDSURFACEDESC</B> structure, the renderer will fill in the
structure with the details of the current surface. If DirectDraw has not been loaded, the renderer will return
E_FAIL. If the renderer is using DCI (the predecessor to DirectDraw), the <B>DDSURFACEDESC</B>
structure is not filled in but the call will return S_FALSE. The only type of DCI surfaces the renderer uses are <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#primary_surface')">primary surfaces</A>.


<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>This interface is implemented by the Microsoft&#174; DirectShow&#153; video renderer to provide information about
DirectDraw surfaces and hardware capabilities.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Applications can use this interface to get details of the surface and any available hardware capabilities, adjust the surfaces that the renderer should use, and set the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A>
instance. Applications are allowed to set the <B>IDirectDraw</B> instance because DirectDraw
can be opened only once per process; this helps resolve conflicts.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IDirectDrawVideo methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IDirectDrawVideo.htm#GetCaps">GetCaps</A>
 </TD><TD>Retrieves a DirectDraw-defined <A HREF="../../appendixes/Further_Reading.htm#DDCAPS">DDCAPS</A> structure containing the hardware
capabilities.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#GetEmulatedCaps">GetEmulatedCaps</A>
 </TD><TD>Retrieves a DirectDraw-defined <A HREF="../../appendixes/Further_Reading.htm#DDCAPS">DDCAPS</A> structure containing the emulated
capabilities.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#CanUseOverlayStretch">CanUseOverlayStretch</A>
 </TD><TD>Determines whether the renderer will check overlay restrictions.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#CanUseScanLine">CanUseScanLine</A>
 </TD><TD>Determines whether the renderer will check the current scan line when drawing.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#GetDirectDraw">GetDirectDraw</A>
 </TD><TD>Retrieves the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#GetFourCCCodes">GetFourCCCodes</A>
 </TD><TD>Retrieves the multimedia <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#format_type')">format type</A> <A HREF="../../appendixes/Further_Reading.htm#FOURCC">FOURCC</A> <A HREF="../../appendixes/Further_Reading.htm#DWORD">DWORD</A>.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#GetSurfaceDesc">GetSurfaceDesc</A>
 </TD><TD>Retrieves a description of the DirectDraw surface in use.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#GetSurfaceType">GetSurfaceType</A>
 </TD><TD>Retrieves the actual surface type.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#GetSwitches">GetSwitches</A>
 </TD><TD>Retrieves the surface types that the renderer is allowed to use.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#SetDefault">SetDefault</A>
 </TD><TD>Makes the current property settings the global default.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#SetDirectDraw">SetDirectDraw</A>
 </TD><TD>Passes the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface to a loaded driver.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#SetSwitches">SetSwitches</A>
 </TD><TD>Sets the surface types that the renderer is allowed to use.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#UseOverlayStretch">UseOverlayStretch</A>
 </TD><TD>Determines whether the renderer should check overlay stretch limitations.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#UseScanLine">UseScanLine</A>
 </TD><TD>Determines whether the renderer should check the current scan line when drawing a video.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#UseWhenFullScreen">UseWhenFullScreen</A>
 </TD><TD>Determines whether DirectShow might change display mode when going to full-screen mode.
</TD></TR><TR><TD><A HREF="IDirectDrawVideo.htm#WillUseFullScreen">WillUseFullScreen</A>
 </TD><TD>Determines whether DirectShow will change display mode when going to full-screen mode.
</TD></TR></TABLE>



<H1><A NAME="CanUseOverlayStretch">IDirectDrawVideo::CanUseOverlayStretch</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Determines whether the renderer will check overlay restrictions.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>CanUseOverlayStretch</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>UseOverlayStretch</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>UseOverlayStretch</I>
 </DT><DD>Set to OATRUE if the renderer can use overlay stretching; otherwise, set to OAFALSE.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>For a description of overlay stretching, see <A HREF="IDirectDrawVideo.htm#UseOverlayStretch">IDirectDrawVideo::UseOverlayStretch</A>.
</BLOCKQUOTE>


<H1><A NAME="CanUseScanLine">IDirectDrawVideo::CanUseScanLine</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Determines whether the renderer will check the current scan line when drawing.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>CanUseScanLine</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>UseScanLine</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>UseScanLine</I>
 </DT><DD>Set to OATRUE if the renderer can use scan line information; otherwise, set to OAFALSE.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>For a description of the use of scan line detection in the DirectShow video renderer,
see <A HREF="IDirectDrawVideo.htm#UseScanLine">IDirectDrawVideo::UseScanLine</A>.
</BLOCKQUOTE>


<H1><A NAME="GetCaps">IDirectDrawVideo::GetCaps</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Retrieves a DirectDraw-defined <A HREF="../../appendixes/Further_Reading.htm#DDCAPS">DDCAPS</A> structure containing the
hardware capabilities.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetCaps</B><B>(</B><BR>&nbsp;&nbsp;<B>DDCAPS</B> <I>*pCaps</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCaps</I>
 </DT><DD><A HREF="../../appendixes/Further_Reading.htm#DDCAPS">DDCAPS</A> structure containing the hardware capabilities.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>If the renderer has not loaded DirectDraw, this method returns E_FAIL.
DirectDraw is not loaded by the renderer until it is connected, and likewise is
unloaded only when the renderer is disconnected.
</BLOCKQUOTE>


<H1><A NAME="GetDirectDraw">IDirectDrawVideo::GetDirectDraw</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Retrieves the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTDRAW</B> <I>*ppDirectDraw</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppDirectDraw</I>
 </DT><DD><A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>If an application wants to load DirectDraw but allow the
renderer to also allocate surfaces, it can let the renderer load DirectDraw and then
obtain a reference-incremented interface to it through this method. The interface
returned should be released by the application when it is finished with it.
</BLOCKQUOTE>


<H1><A NAME="GetEmulatedCaps">IDirectDrawVideo::GetEmulatedCaps</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Retrieves a DirectDraw-defined <A HREF="../../appendixes/Further_Reading.htm#DDCAPS">DDCAPS</A> structure containing the
emulated capabilities.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetEmulatedCaps</B><B>(</B><BR>&nbsp;&nbsp;<B>DDCAPS</B> <I>*pCaps</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCaps</I>
 </DT><DD><A HREF="../../appendixes/Further_Reading.htm#DDCAPS">DDCAPS</A> structure containing the emulated capabilities.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>If the renderer has not loaded DirectDraw, this method returns E_FAIL.
</BLOCKQUOTE>


<H1><A NAME="GetFourCCCodes">IDirectDrawVideo::GetFourCCCodes</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Retrieves the multimedia format type.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetFourCCCodes</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pCount</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pCodes</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCount</I>
 </DT><DD>Number of <A HREF="../../appendixes/Further_Reading.htm#FOURCC">FOURCC</A> codes in the <I>pCodes</I> array.
</DD><DT><I>pCodes</I>
 </DT><DD>Array of <A HREF="../../appendixes/Further_Reading.htm#DWORD">DWORD</A> media tags formerly used for Microsoft multimedia types.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>In the original Microsoft&#174; Windows&#174; multimedia APIs, media types were tagged with
32-bit values created from four 8-bit characters and were known as <A HREF="../../appendixes/Further_Reading.htm#FOURCC">FOURCC</A> codes. Because
<B>FOURCC</B> codes are unique, a one-to-one mapping has been made possible
by allocating a range of 4 billion <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#GUID')">GUIDs</A> representing <B>FOURCC</B>s.

<P>This method retrieves the <A HREF="../../appendixes/Further_Reading.htm#FOURCC">FOURCC</A> codes that the current display driver can support.
The number available is obtained by calling the method with a valid <I>pCount</I>
pointer, but with <I>pCodes</I> set to NULL. In this case, the <I>pCount</I> variable will be
filled in with the number of <B>FOURCC</B> codes available. An application can then allocate enough
<A HREF="../../appendixes/Further_Reading.htm#DWORD">DWORD</A> values for this many <B>FOURCC</B> codes and call the method again with the array pointer in
<I>pCodes</I>.
</BLOCKQUOTE>


<H1><A NAME="GetSurfaceDesc">IDirectDrawVideo::GetSurfaceDesc</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Retrieves a <A HREF="../../appendixes/Further_Reading.htm#DDSURFACEDESC">DDSURFACEDESC</A> structure describing the current DirectDraw surface.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetSurfaceDesc</B><B>(</B><BR>&nbsp;&nbsp;<B>DDSURFACEDESC</B> <I>*pSurfaceDesc</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSurfaceDesc</I>
 </DT><DD><A HREF="../../appendixes/Further_Reading.htm#DDSURFACEDESC">DDSURFACEDESC</A> structure describing the current DirectDraw surface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>If no surface has been allocated, this method will return E_FAIL. If a
DCI primary surface is in use, the <A HREF="../../appendixes/Further_Reading.htm#DDSURFACEDESC">DDSURFACEDESC</A> structure will not be filled
in and the call will return S_FALSE. Surfaces are allocated only when
the renderer is paused. Once the renderer has been paused, it cannot
release the surfaces when stopped.
</BLOCKQUOTE>


<H1><A NAME="GetSurfaceType">IDirectDrawVideo::GetSurfaceType</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Retrieves the actual surface type as a DirectShow DirectDraw Surface (AMDDS) definition.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetSurfaceType</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pSurfaceType</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSurfaceType</I>
 </DT><DD><A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#field')">Field</A> filled in with one bit setting selected from the following list of AMDDS definitions.
<TABLE>
<TR><TD>AMDDS_NONE
 </TD><TD>No use for DCI/DirectDraw.
</TD></TR><TR><TD>AMDDS_DCIPS
 </TD><TD>Use DCI primary surface.
</TD></TR><TR><TD>AMDDS_PS
 </TD><TD>Use DirectDraw primary surface.
</TD></TR><TR><TD>AMDDS_RGBOVR
 </TD><TD>RGB overlay surfaces.
</TD></TR><TR><TD>AMDDS_YUVOVR
 </TD><TD>YUV overlay surfaces.
</TD></TR><TR><TD>AMDDS_RGBOFF
 </TD><TD>RGB off-screen surfaces.
</TD></TR><TR><TD>AMDDS_YUVOFF
 </TD><TD>YUV off-screen surfaces.
</TD></TR><TR><TD>AMDDS_RGBFLP
 </TD><TD>RGB flipping surfaces.
</TD></TR><TR><TD>AMDDS_YUVFLP
 </TD><TD>YUV flipping surfaces.
</TD></TR><TR><TD>AMDDS_ALL
 </TD><TD>All the previous flags.
</TD></TR><TR><TD>AMDDS_DEFAULT AMDDS_ALL
 </TD><TD>Use all available surfaces.
</TD></TR><TR><TD>AMDDS_YUV
 </TD><TD>(AMDDS_YUVOFF | AMDDS_YUVOVR | AMDDS_YUVFLP).
</TD></TR><TR><TD>AMDDS_RGB
 </TD><TD>(AMDDS_RGBOFF | AMDDS_RGBOVR | AMDDS_RGBFLP).
</TD></TR><TR><TD>AMDDS_PRIMARY
 </TD><TD>(AMDDS_DCIPS | AMDDS_PS).
</TD></TR></TABLE>
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>It is not always easy to discover which kind of surface is being used by looking at a
<A HREF="../../appendixes/Further_Reading.htm#DDSURFACEDESC">DDSURFACEDESC</A> structure. Therefore, an application can call <B>GetSurfaceType</B>
to retrieve the surface type. The field will be filled in with one bit setting selected from the
preceding list of AMDDS definitions.
</BLOCKQUOTE>



<H1><A NAME="GetSwitches">IDirectDrawVideo::GetSwitches</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Retrieves the surface types that the renderer is allowed to use.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetSwitches</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pSwitches</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSwitches</I>
 </DT><DD>Bit mask containing one or more of the following DirectShow DirectDraw
Surface (AMDDS) surface types.
<TABLE>
<TR><TD>AMDDS_NONE
 </TD><TD>No use for DCI/DirectDraw.
</TD></TR><TR><TD>AMDDS_DCIPS
 </TD><TD>Use DCI primary surface.
</TD></TR><TR><TD>AMDDS_PS
 </TD><TD>Use DirectDraw primary surface.
</TD></TR><TR><TD>AMDDS_RGBOVR
 </TD><TD>RGB overlay surfaces.
</TD></TR><TR><TD>AMDDS_YUVOVR
 </TD><TD>YUV overlay surfaces.
</TD></TR><TR><TD>AMDDS_RGBOFF
 </TD><TD>RGB off-screen surfaces.
</TD></TR><TR><TD>AMDDS_YUVOFF
 </TD><TD>YUV off-screen surfaces.
</TD></TR><TR><TD>AMDDS_RGBFLP
 </TD><TD>RGB flipping surfaces.
</TD></TR><TR><TD>AMDDS_YUVFLP
 </TD><TD>YUV flipping surfaces.
</TD></TR><TR><TD>AMDDS_ALL
 </TD><TD>All the previous flags.
</TD></TR><TR><TD>AMDDS_DEFAULT AMDDS_ALL
 </TD><TD>Use all available surfaces.
</TD></TR><TR><TD>AMDDS_YUV
 </TD><TD>(AMDDS_YUVOFF | AMDDS_YUVOVR | AMDDS_YUVFLP).
</TD></TR><TR><TD>AMDDS_RGB
 </TD><TD>(AMDDS_RGBOFF | AMDDS_RGBOVR | AMDDS_RGBFLP).
</TD></TR><TR><TD>AMDDS_PRIMARY
 </TD><TD>(AMDDS_DCIPS | AMDDS_PS).
</TD></TR></TABLE>
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>


<H1><A NAME="SetDefault">IDirectDrawVideo::SetDefault</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Makes the current property settings the global default.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetDefault</B><B>(</B> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>

<P>All properties set through <A HREF="IDirectDrawVideo.htm">IDirectDrawVideo</A> are specific to that
particular instance. Call this method to make properties set on this
instance of <B>IDirectDrawVideo</B> the global default of all DirectShow instances
of this interface. Once called, the current property settings will persist between
the subsequent starting of other DirectShow <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graphs</A> and
between any computer restarts.
</BLOCKQUOTE>


<H1><A NAME="SetDirectDraw">IDirectDrawVideo::SetDirectDraw</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Passes the <A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface to a loaded driver.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTDRAW</B> <I>pDirectDraw</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pDirectDraw</I>
 </DT><DD><A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface to be passed.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>To have the renderer release a DirectDraw interface previously passed in through
<B>SetDirectDraw</B>, an application can call <B>SetDirectDraw</B> and pass in NULL.
However, the renderer will continue using that DirectDraw interface until it is disconnected.
Therefore, calling <B>SetDirectDraw</B> with a null parameter does not make the renderer stop using it immediately.

<P>This method was created because only one instance of
<A HREF="../../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> could be loaded per process in DirectDraw 1.0.
If an application wanted to load <B>IDirectDraw</B> but allow the renderer
to also allocate surfaces, the application could open <B>IDirectDraw</B> itself
and then pass the interface to the loaded driver through
<B>IDirectDrawVideo::SetDirectDraw</B>.
Alternatively, the application could let the renderer load DirectDraw and then obtain a
reference-incremented interface to it through <A HREF="IDirectDrawVideo.htm#GetDirectDraw">IDirectDrawVideo::GetDirectDraw</A>.
Because DirectShow ships with the most recently shipped version of DirectDraw, however, this method is not required
unless the application wants to change display modes itself and pass in a DirectDraw
object, which the renderer can then use to allocate surfaces.
</BLOCKQUOTE>



<H1><A NAME="SetSwitches">IDirectDrawVideo::SetSwitches</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Sets the surface types that the renderer is allowed to use.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetSwitches</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>pSwitches</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSwitches</I>
 </DT><DD>Bit mask containing one or more of the following DirectShow DirectDraw
Surface (AMDDS) surface types.
<TABLE>
<TR><TD>AMDDS_NONE
 </TD><TD>No use for DCI/DirectDraw.
</TD></TR><TR><TD>AMDDS_DCIPS
 </TD><TD>Use DCI primary surface.
</TD></TR><TR><TD>AMDDS_PS
 </TD><TD>Use DirectDraw primary surface.
</TD></TR><TR><TD>AMDDS_RGBOVR
 </TD><TD>RGB overlay surfaces.
</TD></TR><TR><TD>AMDDS_YUVOVR
 </TD><TD>YUV overlay surfaces.
</TD></TR><TR><TD>AMDDS_RGBOFF
 </TD><TD>RGB off-screen surfaces.
</TD></TR><TR><TD>AMDDS_YUVOFF
 </TD><TD>YUV off-screen surfaces.
</TD></TR><TR><TD>AMDDS_RGBFLP
 </TD><TD>RGB flipping surfaces.
</TD></TR><TR><TD>AMDDS_YUVFLP
 </TD><TD>YUV flipping surfaces.
</TD></TR><TR><TD>AMDDS_ALL
 </TD><TD>All the previous flags.
</TD></TR><TR><TD>AMDDS_DEFAULT AMDDS_ALL
 </TD><TD>Use all available surfaces.
</TD></TR><TR><TD>AMDDS_YUV
 </TD><TD>(AMDDS_YUVOFF | AMDDS_YUVOVR | AMDDS_YUVFLP).
</TD></TR><TR><TD>AMDDS_RGB
 </TD><TD>(AMDDS_RGBOFF | AMDDS_RGBOVR | AMDDS_RGBFLP).
</TD></TR><TR><TD>AMDDS_PRIMARY
 </TD><TD>(AMDDS_DCIPS | AMDDS_PS).
</TD></TR></TABLE>
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>


<H1><A NAME="UseOverlayStretch">IDirectDrawVideo::UseOverlayStretch</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Determines whether the renderer should check overlay stretch limitations.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>UseOverlayStretch</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>UseOverlayStretch</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>UseOverlayStretch</I>
 </DT><DD>Set to OATRUE for the renderer to use overlay stretching; otherwise, set to OAFALSE.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Some display cards provide the use of overlay surfaces through DirectDraw.
An overlay surface is a block of video memory whose contents are overlaid onto the display during the monitor's vertical refresh. DirectShow uses all available overlay surfaces where possible because they typically offer higher-quality video and very fast performance. On some display cards set to relatively high bit depths, the overlay must be displayed on the screen larger than its real size (to accommodate certain display hardware bandwidth limitations). If the overlay is not displayed large enough, certain undesirable effects can be seen on the display (sometimes described as a "fleeting shimmering" effect).

<P>If <I>UseOverlayStretch</I> is set to On (the default), DirectShow will ensure the overlay is adequately stretched before displaying it. If it is set to Off, DirectShow will not check that the overlay is adequately stretched, and the user is likely to experience artifacts on the screen (although it will also guarantee that the overlay will be used if possible).
</BLOCKQUOTE>


<H1><A NAME="UseScanLine">IDirectDrawVideo::UseScanLine</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Determines whether the renderer should check the current scan line when drawing a video.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>UseScanLine</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>UseScanLine</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>UseScanLine</I>
 </DT><DD>Long integer value that specifies whether or not to use the scan line information. Set to OATRUE to use scan line information or OAFALSE to ignore it.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_INVALIDARG if the argument is invalid or NOERROR otherwise.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>If you <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_B.htm#blit')">blit</A> a video image to the screen while the monitor's scan line is scanning over a visible portion of the screen, the complete image will be a composite of the old and new images. This composite is known as a torn video image. You can avoid torn images by waiting until the previous image is complete before blitting the new image. Some video cards can retrieve the scan line's current position; if this information is available, you can have DirectShow try to reduce <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#tearing')">tearing</A> by waiting until the scan line is offscreen before blitting the new image. Note that checking the scan line location increases load on the processor and can reduce the amount of video frames delivered to the screen. If scan line information is available, DirectShow uses it by default. Set <I>UseScanLine</I> to OAFALSE if you want to save processing time at the expense of minor image degradation.
</BLOCKQUOTE>


<H1><A NAME="UseWhenFullScreen">IDirectDrawVideo::UseWhenFullScreen</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Determines whether DirectShow might change display mode when going to full-screen mode.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>UseWhenFullScreen</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>UseWhenFullScreen</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>UseWhenFullScreen</I>
 </DT><DD>Set to OATRUE to cause the renderer to use DirectX in full-screen mode;
 otherwise, set to OAFALSE.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>When asked to go to full-screen mode, DirectShow has a number of choices. The first choice is to determine if any <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> in the graph can support full-screen playback directly; if one can, it will be asked to do so.

<P>The second choice is to automatically add a special full-screen renderer to the filter graph that uses DirectDraw mode-changing services to play back the video. By changing display modes, the video effectively fills more (but not necessarily all) of the display. So, for example, if the current mode is 1024 x 768 pixels, a video might look relatively small, but when displayed in a 320 x 240 display mode it might look very presentable.

<P>The third and final choice is to simply take any renderer supporting the <A HREF="IVideoWindow.htm">IVideoWindow</A> interface and have its window stretched full-screen. This will typically offer lower performance than the second option (swapping in a full-screen DirectDraw-enabled renderer). If the <I>UseWhenFullScreen</I> parameter is set to On (OATRUE), the window will always be stretched full-screen for full-screen playback; if set to Off (the default), the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> is free to swap in the DirectDraw-enabled full-screen renderer.
</BLOCKQUOTE>


<H1><A NAME="WillUseFullScreen">IDirectDrawVideo::WillUseFullScreen</A><HR size=1></H1>
<A HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
<P>Determines whether DirectShow will change display mode when going to full-screen mode.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>WillUseFullScreen</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>UseWhenFullScreen</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>UseWhenFullScreen</I>
 </DT><DD>Set to OATRUE if DirectShow is set to use DirectX in full-screen mode;
 otherwise, set to OAFALSE.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>For a description of this feature, see <A HREF="IDirectDrawVideo.htm#UseWhenFullScreen">IDirectDrawVideo::UseWhenFullScreen</A>.
</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
