<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IMediaPosition Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IMediaPosition Interface">
<META NAME="Description" CONTENT="IMediaPosition::CanSeekBackward">
<META NAME="Description" CONTENT="IMediaPosition::CanSeekForward">
<META NAME="Description" CONTENT="IMediaPosition::get_CurrentPosition">
<META NAME="Description" CONTENT="IMediaPosition::get_Duration">
<META NAME="Description" CONTENT="IMediaPosition::get_PrerollTime">
<META NAME="Description" CONTENT="IMediaPosition::get_Rate">
<META NAME="Description" CONTENT="IMediaPosition::get_StopTime">
<META NAME="Description" CONTENT="IMediaPosition::put_CurrentPosition">
<META NAME="Description" CONTENT="IMediaPosition::put_PrerollTime">
<META NAME="Description" CONTENT="IMediaPosition::put_Rate">
<META NAME="Description" CONTENT="IMediaPosition::put_StopTime">
<META NAME="Description" CONTENT="CanSeekBackward (IMediaPosition)">
<META NAME="Description" CONTENT="CanSeekForward (IMediaPosition)">
<META NAME="Description" CONTENT="get_CurrentPosition (IMediaPosition)">
<META NAME="Description" CONTENT="get_Duration (IMediaPosition)">
<META NAME="Description" CONTENT="get_PrerollTime (IMediaPosition)">
<META NAME="Description" CONTENT="get_Rate (IMediaPosition)">
<META NAME="Description" CONTENT="get_StopTime (IMediaPosition)">
<META NAME="Description" CONTENT="put_CurrentPosition (IMediaPosition)">
<META NAME="Description" CONTENT="put_PrerollTime (IMediaPosition)">
<META NAME="Description" CONTENT="put_Rate (IMediaPosition)">
<META NAME="Description" CONTENT="put_StopTime (IMediaPosition)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IMediaPosition"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaPosition Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaPosition Interface"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IMediaFilter.htm">IMediaFilter Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IMediaPropertyBag.htm">IMediaPropertyBag Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IMediaPosition Interface</H1>

<P>Applications communicating with the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A> can call <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">methods</A> on the <B>IMediaPosition</B> interface to set or retrieve properties such as the duration of the stream, the start and stop times, the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#preroll_time')">preroll time</A>, the rate, and the current position. The filter graph uses these properties on seekable <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> to control the playback of streams within the graph; where there are multiple streams, the filter graph sets them all to play in parallel, beginning at the same position, and will report the duration as being the duration of the longest stream. The REFTIME parameters used in this interface are double value, representing a fractional
number of seconds. Internally, filters will store time to an accuracy of 100 nanoseconds.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> exposes the <A HREF="IMediaPosition.htm">IMediaPosition</A> interface if any of the filters
within the graph are seekable (can seek to an arbitrary position in the stream). This normally means
a seekable file <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#source_filter')">source filter</A>. Filters, such as a file source filter, will expose <B>IMediaPosition</B>
if they can seek their data or if their <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pin</A> represents a seekable stream. The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> filter
should also expose this interface. Output pins of <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#transform_filter')">transform filters</A> expose this interface to
pass the positioning information upstream from the renderer through each intermediate filter to the
seekable filter.

<P>Use the <A HREF="../class/CMediaPosition.htm#CMediaPosition">CMediaPosition</A> class to help implement this interface on a filter.
Use the <A HREF="../class/CPosPassThru.htm#CPosPassThru">CPosPassThru</A> base class to implement this interface on output pins of transform
filters used to pass media positioning information upstream. This is enabled by default
in the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> base classes.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Applications can use this interface to set or retrieve media positioning properties.
Most commonly, an application will use the methods on this interface to play a media stream for some duration
starting at some set position in the stream (for example, 10 seconds from the start).

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IDispatch methods</TH><TH>Description</TH></TR><TR><TD><A HREF="../../appendixes/Further_Reading.htm#IDispatch__GetTypeIn">GetTypeInfoCount</A>
 </TD><TD>Determines whether there is type information available for this dispinterface.
</TD></TR><TR><TD><A HREF="../../appendixes/Further_Reading.htm#IDispatch__GetTypeIn">GetTypeInfo</A>
 </TD><TD>Retrieves the type information for this dispinterface if
 <A HREF="../../appendixes/Further_Reading.htm#IDispatch__GetTypeIn">GetTypeInfoCount</A> returned
successfully.
</TD></TR><TR><TD><A HREF="../../appendixes/Further_Reading.htm#IDispatch__GetIDsOfN">GetIDsOfNames</A>
 </TD><TD>Converts text names of properties and methods (including arguments) to
their corresponding DISPIDs.
</TD></TR><TR><TD><A HREF="../../appendixes/Further_Reading.htm#IDispatch__Invoke">Invoke</A>
 </TD><TD>Calls a method or accesses a property in this dispinterface if given a DISPID
and any other necessary parameters.
</TD></TR><TR></TR>
<TR><TH>IMediaPosition methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IMediaPosition.htm#get_Duration">get_Duration</A>
 </TD><TD>Retrieves the total duration of the media stream.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#put_CurrentPosition">put_CurrentPosition</A>
 </TD><TD>Sets the time that the media stream begins.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#get_CurrentPosition">get_CurrentPosition</A>
 </TD><TD>Retrieves the current position in terms of the total length of the media stream.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#get_StopTime">get_StopTime</A>
 </TD><TD>Retrieves the position within the media stream at which playback should stop.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#put_StopTime">put_StopTime</A>
 </TD><TD>Sets the position within the media stream at which playback should stop.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#get_PrerollTime">get_PrerollTime</A>
 </TD><TD>Retrieves the time prior to the start position that the filter graph
begins any nonrandom access device rolling.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#put_PrerollTime">put_PrerollTime</A>
 </TD><TD>Sets the time prior to the start position that the filter graph begins any nonrandom access
device rolling.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#put_Rate">put_Rate</A>
 </TD><TD>Sets the playback rate, relative to normal playback of the media stream.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#get_Rate">get_Rate</A>
 </TD><TD>Retrieves the playback rate, relative to normal playback of the media stream.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#CanSeekForward">CanSeekForward</A>
 </TD><TD>Determines if the current position can be moved forward in the media stream.
</TD></TR><TR><TD><A HREF="IMediaPosition.htm#CanSeekBackward">CanSeekBackward</A>
 </TD><TD>Determines if the current position can be moved backward in the media stream.
</TD></TR></TABLE>



<H1><A NAME="CanSeekBackward">IMediaPosition::CanSeekBackward</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Determines if the current position can be moved backward in the media stream.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>CanSeekBackward</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>*pCanSeekBackward</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCanSeekBackward</I>
 </DT><DD>[out] Set to OATRUE if able to seek backward; otherwise set to OAFALSE.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.
</BLOCKQUOTE>


<H1><A NAME="CanSeekForward">IMediaPosition::CanSeekForward</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Determines if the current position can be moved forward in the media stream.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>CanSeekForward</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>*pCanSeekForward</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCanSeekForward</I>
 </DT><DD>[out] Set to OATRUE if able to seek forward; otherwise set to OAFALSE.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.
</BLOCKQUOTE>


<H1><A NAME="get_CurrentPosition">IMediaPosition::get_CurrentPosition</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Retrieves the current position in terms of the total length of the media stream.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_CurrentPosition</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME*</B> <I>pllTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pllTime</I>
 </DT><DD>[out] <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_time')">reference time</A> of the current position.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This is the position that playback has reached. It is a value between zero
and the total duration of the media (that is, it does not take into account
the rate and start time). If the
filter graph is paused, this is the position at which it will restart.

<P>When the filter graph is stopped or paused, this method returns the position at
which playback will recommence. When the
filter graph is running, the filter graph manager returns the position
according to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_clock')">reference clock</A>. If an individual filter implements this,
it should return the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#stream_time')">stream time</A> of the sample it is processing
(that is, the offset time from the beginning) when paused or running. If you
implement this using stream time or the reference clock, remember to adjust
the value you return for start position and playback rate so that the value
returned is in terms of the media's total duration.

<P>After stopping or pausing, a run command causes playback to begin at
the current position. This will be where playback stopped or paused, unless
there has been an <A HREF="IMediaPosition.htm#put_CurrentPosition">IMediaPosition::put_CurrentPosition</A> call in the meantime.
</BLOCKQUOTE>


<H1><A NAME="get_Duration">IMediaPosition::get_Duration</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Retrieves the total duration of the media stream.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_Duration</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME*</B> <I>plength</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>plength</I>
 </DT><DD>[out] Returned length of the media stream.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The duration assumes normal playback speed, and it is therefore unaffected by the rate.
</BLOCKQUOTE>


<H1><A NAME="get_PrerollTime">IMediaPosition::get_PrerollTime</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Retrieves the time prior to the start position that any nonrandom access device should start rolling.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_PrerollTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME*</B> <I>pllTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pllTime</I>
 </DT><DD>[out] Returned <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#preroll')">preroll</A> time as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A> pointer value.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Preroll time is the time prior to the start position at which nonrandom access
devices, such as tape players, should start rolling.
</BLOCKQUOTE>


<H1><A NAME="get_Rate">IMediaPosition::get_Rate</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Retrieves the rate of playback relative to normal playback speed.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_Rate</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <B>*</B> <I>pdRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pdRate</I>
</DT><DD>[out] Returned rate.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>A rate of 1.0 indicates normal playback speed. A rate of 0.5 indicates half
speed. A rate of &#150;1.0 indicates normal speed in reverse.
</BLOCKQUOTE>


<H1><A NAME="get_StopTime">IMediaPosition::get_StopTime</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Retrieves the time at which the media stream stops.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_StopTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME*</B> <I>pllTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pllTime</I>
 </DT><DD>[out] Returned stop time as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A> pointer value.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The stop time is a position between zero and the duration of the media
at which playback should stop.

<P>The stop position is applied before the rate and therefore is the position at typical playback
speed.
</BLOCKQUOTE>


<H1><A NAME="put_CurrentPosition">IMediaPosition::put_CurrentPosition</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Sets the time that the media stream begins.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_CurrentPosition</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>llTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>llTime</I>
 </DT><DD>[in] Start time expressed as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A> value.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The start time is a position between zero and the duration of the media
at which playback should begin when the next run command is issued.

<P> If this method is called when the filter graph manager is running, the filter graph manager will
pause the graph, run the method, and then issue a new run command.

<P>If called when the filter graph is paused, this method must flush existing
data by using <A HREF="IPin.htm#BeginFlush">IPin::BeginFlush</A> and <A HREF="IPin.htm#EndFlush">IPin::EndFlush</A> before pushing the new data
(at the new current position).

<P>Setting the current position when paused or stopped causes playback to resume from the
new start position when the run command is issued.

<P>The current position is applied before the rate and therefore is the position at
typical playback speed.
</BLOCKQUOTE>


<H1><A NAME="put_PrerollTime">IMediaPosition::put_PrerollTime</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Sets the time prior to the start position that any nonrandom access device should start rolling.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_PrerollTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>llTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>llTime</I>
</DT><DD>[in] Preroll time to be set.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Preroll time is the time prior to the start position at which nonrandom access
devices, such as tape players, should start rolling.
</BLOCKQUOTE>


<H1><A NAME="put_Rate">IMediaPosition::put_Rate</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Sets the rate of playback relative to normal speed.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_Rate</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <I>dRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dRate</I>
</DT><DD>[in] Rate to set.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method allows an application to speed up or slow down playback relative
to the normal default playback speed. A rate of 1.0 indicates normal playback
speed. Specifying 2.0 causes playback at twice the normal rate: a video
created for 10 frames per second (fps) will be played back at 20 fps, if resources permit.
Audio streams played back at above-normal speed increase the pitch rather
than drop samples.
</BLOCKQUOTE>


<H1><A NAME="put_StopTime">IMediaPosition::put_StopTime</A><HR size=1></H1>
<A HREF="IMediaPosition.htm">IMediaPosition Interface</A>
<P>Sets the time at which the media stream will stop.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_StopTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>llTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>llTime</I>
 </DT><DD>[in] Stop time as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A> value.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The stop time is a position between zero and the duration of the media
at which playback should stop.

<P>The stop position is applied before the rate and therefore is the position at typical
playback speed.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
