<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IMultiFileReader Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IMultiFileReader Interface">
<META NAME="Description" CONTENT="IMultiFileReader::SetFile">
<META NAME="Description" CONTENT="SetFile (IMultiFileReader)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IAMParse_iface"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMultiFileReader Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- MPEG-2 Support in DirectShow"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID=TOC HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A  STYLE="color:black" HREF="IMixerPinconfig.htm">IMixerPinConfig Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IOverlay.htm">IOverlay Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">
<!-- CONTENTS_START -->

<H1>IMultiFileReader Interface</H1>

<P>The <B>IMultiFileReader</B> interface is implemented by the Microsoft&reg; MultiFile reader <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A>. Applications that need to stream multiple files or file segments with identical media types with minimal delay between files use this interface.

<p>The interface supports two notifications:
<ul>
<li>File/file segment sourcing complete.
<li>Stream time for start of file or file segment.
</ul>

<P CLASS="ref"><A NAME="Methods">Methods</A></P>

<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="../../ref/iface/IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Retrieves pointers to supported interfaces.
 </TD></TR><TR><TD><A HREF="../../ref/iface/IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
 </TD></TR><TR><TD><A HREF="../../ref/iface/IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>

<TR><TH>IMultiFileReader methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IMultiFileReader.htm#SetFile">SetFile</A>
 </TD><TD>Implements sequenced playback of a set of file segments. 
 </TD></TR></TABLE>



<H1><A NAME="SetFile">IMultiFileReader::SetFile</A><HR size=1></H1>
<A HREF="IMultiFileReader.htm">IMultiFileReader Interface</A>
<P>Implements sequenced playback of a set of file segments by waiting for the end of source data notification before calling it again, and also by switching immediately to a new file.
 
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetFile</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpszFile</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <I>llOffset</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <I>llLength</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <I>rtOffset</I><B>,</B><BR>&nbsp;&nbsp;<B>HWND</B> <I>hwndNotify</I><B>,</B><BR>&nbsp;&nbsp;<B>UINT</B> <I>uiMsgNotify</I><B>,</B><BR>&nbsp;&nbsp;<B>WPARAM</B> <I>wParam</I><B>,</B><BR>&nbsp;&nbsp;<B>HANDLE</B> <I>hEvent</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpszFile</I> 
 </DT><DD>[in] File to use.
</DD><DT><I>llOffset</I>
 </DT><DD>[in] Start offset in file.
</DD><DT><I>llLength</I>
 </DT><DD>[in] Length of file segment to play in bytes. Zero means play the rest of the file starting at <I>llOffset</I>.
</DD><DT><I>rtOffset</I>
</DT><DD>[in] Offset time to be applied to the start time of the file for fine tuning.  For example, if rtOffset was 10000 (1 millisecond), then the time stamps used for the movie would be delayed by 1 millisecond.
</DD><DT><I>hwndNotify</I>
 </DT><DD>[in] Window to send notification messages to (can be NULL).
</DD><DT><I>uiMsgNotify</I>
 </DT><DD>[in] Window message to use for <B>PostMessage</B> notifications. Ignored if <I>hwndNotify</I> is NULL.
</DD><DT><I>wParam</I>
 </DT><DD>[in] Microsoft&reg; Windows&reg; <I>wParam</I> parameter in <B>PostMessage</B> notifications. Ignored if <I>hwndNotify</I> is NULL.
</DD><DT><I>hEvent</I>
 </DT><DD>[in] Event handle to signal when all data has been read. Can be NULL.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flags that specify how to mark the file. Can be one or both of the following values.
 	<DL>
	<DT>AM_MULTIFILE_READER_SEAMLESS<DD>Don't set discontinuity flag on sample at file join.</DD>
 	<DT>AM_MULTIFILE_READER_LAST<DD>Signal end of file at the end of this sample.</DD>
	</DL>
 </DD>
</DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../../ref/Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. <B>HRESULT</B> can include one of the following standard constants, or other values not listed. 
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Argument is invalid.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method is not supported.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>S_OK </TD><TD>Success.
</TD></TR></TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>The file <I>lpszFile</I> is used for the next data requested from the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#source_filter')">source filter</A>. <B>SetFile</B> can be used both to implement sequenced playback of a set of file segments by waiting for the end of source data notification before calling it again, or for switching immediately to a new file. In the latter case, from the user's point of view, the switch will not appear instantaneous because there will be data that has been read from the file that won't have been played yet, but the delay will be short.

<p>When <I>hwndNotify</I> is not NULL, two notifications are issued through <B>PostMessage</B> to <I>hwndNotify</I>, using the <I>uiMsgNotify</I> and <I>wParam</I> values specified for the current file segment:
<TABLE>
<TR><TH>Notification Meaning</TH><TH>wParam</TH></TR>


<TR><TD>Start time of current segment in 100-nanosecond units.</TD><TD>Pointer to REFERENCE_TIME. Must be freed by using <B>CoTaskMemFree</B>. This notification can't be called. For example, the MultiFile source filter relies on the filter connected to its output (such as the MPEG-2 splitter filter) to implement <A HREF="IAMPARSE.htm">IAMParse</A> to get this information.</TD></TR>
<TR><TD>All data for current segment has been read.</TD><TD>0</TD></TR>
</TABLE>

<p>To distinguish notifications for different segments, the <I>wParam</I> value chosen for each segment should be different.

</BLOCKQUOTE>



<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
