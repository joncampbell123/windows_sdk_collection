<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CBasePin Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CBasePin Class">
<META NAME="Description" CONTENT="Active (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::Active">
<META NAME="Description" CONTENT="AgreeMediaType (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::AgreeMediaType">
<META NAME="Description" CONTENT="AttemptConnection (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::AttemptConnection">
<META NAME="Description" CONTENT="BreakConnect (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::BreakConnect">
<META NAME="Description" CONTENT="CBasePin (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::CBasePin">
<META NAME="Description" CONTENT="CheckConnect (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::CheckConnect">
<META NAME="Description" CONTENT="CheckMediaType (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::CheckMediaType">
<META NAME="Description" CONTENT="CompleteConnect (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::CompleteConnect">
<META NAME="Description" CONTENT="Connect (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::Connect">
<META NAME="Description" CONTENT="ConnectedTo (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::ConnectedTo">
<META NAME="Description" CONTENT="ConnectionMediaType (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::ConnectionMediaType">
<META NAME="Description" CONTENT="CurrentRate (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::CurrentRate">
<META NAME="Description" CONTENT="CurrentStartTime (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::CurrentStartTime">
<META NAME="Description" CONTENT="CurrentStopTime (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::CurrentStopTime">
<META NAME="Description" CONTENT="Disconnect (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::Disconnect">
<META NAME="Description" CONTENT="DisplayPinInfo (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::DisplayPinInfo">
<META NAME="Description" CONTENT="DisplayTypeInfo (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::DisplayTypeInfo">
<META NAME="Description" CONTENT="EndOfStream (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::EndOfStream">
<META NAME="Description" CONTENT="EnumMediaTypes (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::EnumMediaTypes">
<META NAME="Description" CONTENT="GetConnected (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::GetConnected">
<META NAME="Description" CONTENT="GetMediaType (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::GetMediaType">
<META NAME="Description" CONTENT="GetMediaTypeVersion (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::GetMediaTypeVersion">
<META NAME="Description" CONTENT="Inactive (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::Inactive">
<META NAME="Description" CONTENT="IncrementTypeVersion (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::IncrementTypeVersion">
<META NAME="Description" CONTENT="IsConnected (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::IsConnected">
<META NAME="Description" CONTENT="IsStopped (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::IsStopped">
<META NAME="Description" CONTENT="Name (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::Name">
<META NAME="Description" CONTENT="NewSegment (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::NewSegment">
<META NAME="Description" CONTENT="NonDelegatingAddRef (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::NonDelegatingAddRef">
<META NAME="Description" CONTENT="NonDelegatingQueryInterface (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::NonDelegatingQueryInterface">
<META NAME="Description" CONTENT="NonDelegatingRelease (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::NonDelegatingRelease">
<META NAME="Description" CONTENT="Notify (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::Notify">
<META NAME="Description" CONTENT="QueryAccept (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::QueryAccept">
<META NAME="Description" CONTENT="QueryDirection (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::QueryDirection">
<META NAME="Description" CONTENT="QueryId (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::QueryId">
<META NAME="Description" CONTENT="QueryInternalConnections (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::QueryInternalConnections">
<META NAME="Description" CONTENT="QueryPinInfo (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::QueryPinInfo">
<META NAME="Description" CONTENT="ReceiveConnection (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::ReceiveConnection">
<META NAME="Description" CONTENT="Run (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::Run">
<META NAME="Description" CONTENT="SetMediaType (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::SetMediaType">
<META NAME="Description" CONTENT="SetSink (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::SetSink">
<META NAME="Description" CONTENT="TryMediaTypes (CBasePin)">
<META NAME="Description" CONTENT="CBasePin::TryMediaTypes">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CBasePin"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CBaseOutputPin.htm">CBaseOutputPin Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CBasePin Class</H1>

<P><IMG SRC="../../art/filter02.gif" WIDTH="277" HEIGHT="169" ALT="CBasePin class hierarchy">

<P><B>CBasePin</B> is an abstract base class from which all pins are derived. <B>CBasePin</B> 
supports the <A HREF="../iface/IPin.htm">IPin</A> interface.
You can derive from this if your <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> does not supply or use the <A HREF="../iface/IMemInputPin.htm">IMemInputPin</A> interface;
otherwise, derive from the <A HREF="CBaseInputPin.htm">CBaseInputPin</A> class or the 
<A HREF="CBaseOutputPin.htm">CBaseOutputPin</A> class.

<P>The connection process is crucial to the success of creating <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graphs</A>. The filter graph finds 
two <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> (and subsequently two pins) to connect. It calls the <A HREF="../iface/IPin.htm#Connect">IPin::Connect</A> method on
the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pin</A> (it can also call <A HREF="../iface/IPin.htm#Connect">Connect</A> on the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_I.htm#input_pin')">input pin</A> at the same time). 
The output pin then calls the virtual pin member function <A HREF="CBasePin.htm#CheckConnect">CBasePin::CheckConnect</A>. 
Derived classes should override this member function to use
<A HREF="../iface/IUnknown.htm#QueryInterface">QueryInterface</A> to return any interfaces required. The base class implementation of
<A HREF="CBasePin.htm#CheckConnect">CheckConnect</A>
queries the <A HREF="../iface/IMemInputPin.htm">IMemInputPin</A> interface to establish the default <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#transport')">transport</A> protocol.

<P>After calling <A HREF="CBasePin.htm#CheckConnect">CheckConnect</A>, the output pin calls
<A HREF="CBasePin.htm#AgreeMediaType">CBasePin::AgreeMediaType</A>; this is a worker member function not intended for overriding 
in derived classes. This gets the input pin's enumerator and calls 
<A HREF="CBasePin.htm#TryMediaTypes">CBasePin::TryMediaTypes</A> with it. <A HREF="CBasePin.htm#TryMediaTypes">TryMediaTypes</A> 
is another base pin 
worker member function that is not intended for derivation. It cycles through each media type 
provided by an enumerator to determine if a connection can be made with that type.

<P>If that process fails, <A HREF="CBasePin.htm#AgreeMediaType">AgreeMediaType</A> retrieves 
the output pin's media type enumerator and calls <A HREF="CBasePin.htm#GetMediaType">CBasePin::GetMediaType</A>, which cycles 
through the media types to agree on a connection type. If there is agreement, a media type with 
the input and output pins becomes the type used in the connection.

<P>If no media type can be agreed on, the connection between the pins cannot be made.
The base pin calls <A HREF="CBasePin.htm#SetMediaType">CBasePin::SetMediaType</A> to broadcast the format. The
<A HREF="CBasePin.htm#CBasePin::m_mt">m_mt</A> base pin variable is set during this process.

<P>The <A HREF="../iface/IPin.htm">IPin</A> interface provides a method called <A HREF="CBasePin.htm#QueryAccept">QueryAccept</A>. This method allows 
a connected filter to query whether the pin will accept a specified media type. The method is 
asynchronous so that a filter can call it at any time&#151;even when another filter is calling it. For this 
reason, its implementation in any override of the base class should not lock the filter. The base class 
implementation of <A HREF="../iface/IPin.htm#QueryAccept">IPin::QueryAccept</A> calls the overridden 
<A HREF="CBasePin.htm#CheckMediaType">CBasePin::CheckMediaType</A> member function on the derived pin class.

<P>All member functions in this class that return <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> and accept a pointer as a 
parameter return E_POINTER when passed a null pointer. 

<A NAME="Protected_Data_Membe"></A><P CLASS="ref">Protected Data Members</P>
<TABLE><TR><TD><B><A NAME="CBasePin::m_bRunTimeError">m_bRunTimeError</A></B> </TD><TD>Run-time error generated.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_Connected">m_Connected</A></B> 
 </TD><TD>Pin to which this pin is connected.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_dir">m_dir</A></B> </TD><TD>Direction of this pin.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_dRate">m_dRate</A></B> </TD><TD>Rate from the <A HREF="CBasePin.htm#NewSegment">CBasePin::NewSegment</A> call.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_mt">m_mt</A></B> 
 </TD><TD>Media type that this pin is using. This is established during the connection process.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_pFilter">m_pFilter</A></B> </TD><TD>Filter that created the pin.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_pLock">m_pLock</A></B> </TD><TD>Object used for locking.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_pQSink">m_pQSink</A></B> </TD><TD>Target for quality messages.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_pName">m_pName</A></B> 
 </TD><TD>Name of the pin.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_tStart">m_tStart</A></B> </TD><TD>Start time from the <A HREF="CBasePin.htm#NewSegment">CBasePin::NewSegment</A> call.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_tStop">m_tStop</A></B> </TD><TD>Stop time from the <A HREF="CBasePin.htm#NewSegment">CBasePin::NewSegment</A> call.
</TD></TR><TR><TD><B><A NAME="CBasePin::m_TypeVersion">m_TypeVersion</A></B> </TD><TD>Current media type version (see <A HREF="CBasePin.htm#GetMediaTypeVersion">CBasePin::GetMediaTypeVersion</A>).
</TD></TR></TABLE>
<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>

<TABLE><TR><TD><A HREF="CBasePin.htm#AttemptConnection">AttemptConnection</A>
 </TD><TD>Attempts to make a connection to another pin using a specified media type.
</TD></TR><TR><TD><A HREF="CBasePin.htm#CBasePin_CBasePin">CBasePin</A>
 </TD><TD>Constructs a <A HREF="CBasePin.htm">CBasePin</A> object.
</TD></TR><TR><TD><A HREF="CBasePin.htm#CurrentRate">CurrentRate</A>
</TD><TD>Returns the segment rate set by the <A HREF="CBasePin.htm#NewSegment">CBasePin::NewSegment</A> member function.
</TD></TR><TR><TD><A HREF="CBasePin.htm#CurrentStartTime">CurrentStartTime</A>
</TD><TD>Returns the segment start time set by the <A HREF="CBasePin.htm#NewSegment">CBasePin::NewSegment</A> member function.
</TD></TR><TR><TD><A HREF="CBasePin.htm#CurrentStopTime">CurrentStopTime</A>
</TD><TD>Returns the segment stop time set by the <A HREF="CBasePin.htm#NewSegment">CBasePin::NewSegment</A> member function.
</TD></TR><TR><TD><A HREF="CBasePin.htm#DisplayPinInfo">DisplayPinInfo</A>
 </TD><TD>Displays pin information on the debugging monitor.
</TD></TR><TR><TD><A HREF="CBasePin.htm#DisplayTypeInfo">DisplayTypeInfo</A>
 </TD><TD>Displays media type information on the debugging monitor.
</TD></TR><TR><TD><A HREF="CBasePin.htm#GetConnected">GetConnected</A>
 </TD><TD>Returns the pin that is connected to this pin.
</TD></TR><TR><TD><A HREF="CBasePin.htm#IncrementTypeVersion">IncrementTypeVersion</A>
 </TD><TD>Adds 1 to the current media type version. 
</TD></TR><TR><TD><A HREF="CBasePin.htm#IsConnected">IsConnected</A>
 </TD><TD>Determines whether the pin is connected.
</TD></TR><TR><TD><A HREF="CBasePin.htm#IsStopped">IsStopped</A>
 </TD><TD>Determines whether the filter owning this pin is in the State_Stopped state.
</TD></TR><TR><TD><A HREF="CBasePin.htm#Name">Name</A> 
 </TD><TD>Returns the <A HREF="CBasePin.htm#CBasePin::m_pName">m_pName</A> name of the pin.
</TD></TR></TABLE>
<A NAME="Overridable_Member_F"></A><P CLASS="ref">Overridable Member Functions</P>

<TABLE><TR><TD><A HREF="CBasePin.htm#Active">Active</A>
 </TD><TD>Switches the pin to the active (running) mode.
</TD></TR><TR><TD><A HREF="CBasePin.htm#AgreeMediaType">AgreeMediaType</A>
 </TD><TD>Agrees on the media type to be used by the pin.
</TD></TR><TR><TD><A HREF="CBasePin.htm#BreakConnect">BreakConnect</A>
 </TD><TD>Adds custom code when the connection quits.
This is also called when a stage in the connection process fails, so this member 
function should also clean up partial connection states.
</TD></TR><TR><TD><A HREF="CBasePin.htm#CheckConnect">CheckConnect</A>
 </TD><TD>Adds custom code when the connection is being made.
This is called at the start of the connection process.
</TD></TR><TR><TD><A HREF="CBasePin.htm#CheckMediaType">CheckMediaType</A>
 </TD><TD>Checks if the pin can support a specific media type.
</TD></TR><TR><TD><A HREF="CBasePin.htm#CompleteConnect">CompleteConnect</A>
 </TD><TD>Completes the connection.
</TD></TR><TR><TD><A HREF="CBasePin.htm#GetMediaType">GetMediaType</A>
 </TD><TD>Returns the media type used by the pin.
</TD></TR><TR><TD><A HREF="CBasePin.htm#GetMediaTypeVersion">GetMediaTypeVersion</A>
 </TD><TD>Returns the version of the pins that were created dynamically.
</TD></TR><TR><TD><A HREF="CBasePin.htm#Inactive">Inactive</A>
 </TD><TD>Switches the pin to the inactive (stopped) mode.
</TD></TR><TR><TD><A HREF="CBasePin.htm#SetMediaType">SetMediaType</A>
 </TD><TD>Sets the <A HREF="CBasePin.htm#CBasePin::m_mt">m_mt</A> data member to the established media type.
</TD></TR><TR><TD><A HREF="CBasePin.htm#TryMediaTypes">TryMediaTypes</A>
 </TD><TD>Tries to find an acceptable media type for a connection from the list 
returned by a media type enumerator.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Implemented_IPin_Met"></A>Implemented IPin Methods</P>

<TABLE><TR><TD><A HREF="CBasePin.htm#Connect">Connect</A>
 </TD><TD>Initiates a connection to another pin.
</TD></TR><TR><TD><A HREF="CBasePin.htm#ConnectedTo">ConnectedTo</A> 
 </TD><TD>Returns a pointer to the connecting pin.
</TD></TR><TR><TD><A HREF="CBasePin.htm#ConnectionMediaType">ConnectionMediaType</A> 
 </TD><TD>Returns the media type of this pin's connection.
</TD></TR><TR><TD><A HREF="CBasePin.htm#Disconnect">Disconnect</A>
 </TD><TD>Breaks a connection. 
</TD></TR><TR><TD><A HREF="CBasePin.htm#EndOfStream">EndOfStream</A>
 </TD><TD>Informs the input pin that no additional data is expected until a new run command is issued.
 (returns S_FALSE by default).
</TD></TR><TR><TD><A HREF="CBasePin.htm#EnumMediaTypes">EnumMediaTypes</A>
 </TD><TD>Returns an enumerator for this pin's preferred media types.
</TD></TR><TR><TD><A HREF="CBasePin.htm#NewSegment">NewSegment</A>
 </TD><TD>Specifies that samples following this call are grouped as a segment with a given start time, 
stop time, and rate.
</TD></TR><TR><TD><A HREF="CBasePin.htm#QueryAccept">QueryAccept</A>
 </TD><TD>Determines whether this pin accepts the media type.
</TD></TR><TR><TD><A HREF="CBasePin.htm#QueryDirection">QueryDirection</A>
 </TD><TD>Retrieves the pin direction of the pin.
</TD></TR><TR><TD><A HREF="CBasePin.htm#QueryId">QueryId</A>
 </TD><TD>Retrieves an identifier for the pin.
</TD></TR><TR><TD><A HREF="CBasePin.htm#QueryInternalConnections">QueryInternalConnections</A>
 </TD><TD>Returns an array of the pins to which this pin connects internally.
</TD></TR><TR><TD><A HREF="CBasePin.htm#QueryPinInfo">QueryPinInfo</A>
 </TD><TD>Retrieves information about the pin itself (the name, owning filter, or direction).
</TD></TR><TR><TD><A HREF="CBasePin.htm#ReceiveConnection">ReceiveConnection</A>
 </TD><TD>Called by a connecting pin to make a connection to this pin.
 Usually this does not need to be overridden, because the default implementation 
 calls <A HREF="CBasePin.htm#CheckConnect">CBasePin::CheckConnect</A>, <A HREF="CBasePin.htm#CheckMediaType">CBasePin::CheckMediaType</A>, and <A HREF="CBasePin.htm#BreakConnect">CBasePin::BreakConnect</A>.
</TD></TR><TR><TD><A HREF="CBasePin.htm#Run">Run</A>
 </TD><TD>Notifies the pin that the filter has changed state from paused to running.

</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Implemented_IQuality"></A>Implemented IQualityControl Methods</P>


<TABLE><TR><TD><A HREF="CBasePin.htm#Notify">Notify</A>
 </TD><TD>Notifies the recipient that a quality change is requested.
</TD></TR><TR><TD><A HREF="CBasePin.htm#SetSink">SetSink</A>
 </TD><TD>Sets the <A HREF="../iface/IQualityControl.htm">IQualityControl</A> object that will receive quality messages.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_INonDele"></A>Implemented INonDelegatingUnknown Methods</P>


<TABLE><TR><TD><A HREF="CBasePin.htm#NonDelegatingAddRef">NonDelegatingAddRef</A>
</TD><TD>Increments the owning filter's reference count.
</TD></TR><TR><TD><A HREF="CBasePin.htm#NonDelegatingQueryInterface">NonDelegatingQueryInterface</A>
</TD><TD>Retrieves <A HREF="CBasePin.htm">CBasePin</A> interfaces. Override this member function to pass out 
pointers to any interfaces added by the derived pin class.
</TD></TR><TR><TD><A HREF="CBasePin.htm#NonDelegatingRelease">NonDelegatingRelease</A>
</TD><TD>Decrements the owning filter's reference count.
</TD></TR></TABLE>



<H1><A NAME="Active">CBasePin::Active</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Called by the <A HREF="CBaseFilter.htm">CBaseFilter</A> implementation when the state changes from stopped
to either paused or running.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>Active</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. The default implementation returns
NOERROR.



</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Any class that requires notification of a change of state should override this member function.
This is called when the filter owning the pin exits the State_Stopped state.

<P>Note that the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager's</A> internal state variable is not updated until after this
member function returns, so testing the filter graph manager's state (directly or 
indirectly) from within this member function should be avoided. 

</BLOCKQUOTE>


<H1><A NAME="AgreeMediaType">CBasePin::AgreeMediaType</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Searches for a media type for the pin connection. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>AgreeMediaType</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <I>*pReceivePin</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>CMediaType</B> <I>*pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pReceivePin</I>
</DT><DD>Pointer to the receiving pin.
</DD><DT><I>pmt</I>
</DT><DD>Pointer to a media type object to be returned.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value, which can include one of the following values.


<TABLE>
<TR><TD>NOERROR
 </TD><TD>A media type was found.
</TD></TR><TR><TD><A HREF="../Error_Success_Codes.htm#VFW_E_NO_ACCEPTABLE_">VFW_E_NO_ACCEPTABLE_TYPES</A>
 </TD><TD>No agreement on a media type was reached.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called during the connection process. It calls <A HREF="CBasePin.htm#TryMediaTypes">CBasePin::TryMediaTypes</A> on both the owning pin
and the pin connected to the owning pin; it enumerates the preferred data types on the pin.
If one is found, <A HREF="CBasePin.htm#TryMediaTypes">TryMediaTypes</A> tries the media type with the
pin in a call to the <A HREF="CBasePin.htm#ReceiveConnection">CBasePin::ReceiveConnection</A> member function. If this pin proposes 
a media type, its support is still verified by calling <A HREF="CBasePin.htm#CheckMediaType">CBasePin::CheckMediaType</A>. The 
enumerator can list all the media types, even if some of them are not currently available.

<P>This member function is protected.
</BLOCKQUOTE>


<H1><A NAME="AttemptConnection">CBasePin::AttemptConnection</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Attempts to make a connection to another pin using a specified media type.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>AttemptConnection</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>pReceivePin</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>CMediaType</B> <I>*pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pReceivePin</I>
</DT><DD>Pointer to the receiving pin.
</DD><DT><I>pmt</I>
</DT><DD>Pointer to a media type object containing the preferred media type for the connection.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is used to attempt to connect with a given media
type. Its main purpose is to call the <A HREF="../iface/IPin.htm#ReceiveConnection">IPin::ReceiveConnection</A> method of the 
pin passed in the <I>pReceivePin</I> parameter. This member function is protected.
</BLOCKQUOTE>


<H1><A NAME="BreakConnect">CBasePin::BreakConnect</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Called when a connection is broken to allow for customization (intended for overriding).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>BreakConnect</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. The default implementation returns
NOERROR.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called when a connection to the pin cannot be made or
when <A HREF="CBasePin.htm#Disconnect">CBasePin::Disconnect</A> is called. In this case, it is necessary
to undo anything performed during the connection process.
You can override this member function to release any references to interfaces that were
made during the connection.
</BLOCKQUOTE>


<H1><A NAME="CBasePin_CBasePin">CBasePin::CBasePin</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Constructs a <A HREF="CBasePin.htm">CBasePin</A> object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CBasePin</B><B>(</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pObjectName</I><B>,</B><BR>&nbsp;&nbsp;<B>CBaseFilter</B> <I>*pFilter</I><B>,</B><BR>&nbsp;&nbsp;<B>CCritSec</B> <I>*pLock</I><B>,</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <I>*phr</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pName</I><B>,</B><BR>&nbsp;&nbsp;<B>PIN_DIRECTION</B> <I>dir</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pObjectName</I>
</DT><DD>Description of the object.
</DD><DT><I>pFilter</I>
</DT><DD>Owning filter that knows about pins.
</DD><DT><I>pLock</I>
</DT><DD>Object that implements the lock.
</DD><DT><I>phr</I>
</DT><DD>Pointer to a general COM return value. This value is changed only if this function fails.
</DD><DT><I>pName</I>
</DT><DD>Pin name.
</DD><DT><I>dir</I>
</DT><DD>Either PINDIR_INPUT or PINDIR_OUTPUT.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This is a standard class constructor.


</BLOCKQUOTE>


<H1><A NAME="CheckConnect">CBasePin::CheckConnect</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Allows for customization when the connection is first made (intended for overriding, if required).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>CheckConnect</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>pPin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
</DT><DD>Pointer to the connecting pin.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following arguments by default; if overridden, should return standard
<A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> values, including the following values.
<TABLE>
<TR><TD>E_INVALIDARG
</TD><TD>Pin directions do not match between pins.
</TD></TR><TR><TD>NOERROR
</TD><TD>Connection verified successfully.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called during a call to the <A HREF="../iface/IPin.htm#Connect">IPin::Connect</A> method to provide 
a virtual method that can do any specific check required for a connection, such as calling
<A HREF="CBasePin.htm#NonDelegatingQueryInterface">CBasePin::NonDelegatingQueryInterface</A>. This base class method determines if the pin 
directions match.
</BLOCKQUOTE>


<H1><A NAME="CheckMediaType">CBasePin::CheckMediaType</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Determines if the pin can support a specific media type.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>CheckMediaType</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>CMediaType</B> <B>*</B> <I>pmt</I><BR>&nbsp;&nbsp;<B>)</B><BR><B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pmt</I>
</DT><DD>Pointer to a media type object containing the proposed media type.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>The overriding member function should return S_OK if the proposed media type is accepted; otherwise, it should return an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> failure value, such as S_FALSE.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is typically called before calling the <A HREF="CBasePin.htm#SetMediaType">CBasePin::SetMediaType</A> member function. It is also called from several other member functions, including <A HREF="CBasePin.htm#ReceiveConnection">CBasePin::ReceiveConnection</A> and <A HREF="CBasePin.htm#QueryAccept">CBasePin::QueryAccept</A>.
</BLOCKQUOTE>


<H1><A NAME="CompleteConnect">CBasePin::CompleteConnect</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Completes a connection to another filter (intended for overriding).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>CompleteConnect</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <I>*pReceivePin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pReceivePin</I>
 </DT><DD>Pointer to the connected (receiving) pin.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. The default implementation returns
NOERROR.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Override this member function to check for required connection interfaces
on the <I>pReceivePin</I> parameter or its filter.
Failing this member function fails the connection and disconnects the other pin.
The <A HREF="CBaseOutputPin.htm">CBaseOutputPin</A> class overrides this member function to establish a local 
memory transport.
</BLOCKQUOTE>


<H1><A NAME="Connect">CBasePin::Connect</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Initiates a connection from this pin to the other pin.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Connect</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>pReceivePin</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>AM_MEDIA_TYPE</B> <I>*pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pReceivePin</I>
 </DT><DD>Input pin to connect to.
</DD><DT><I>pmt</I>
 </DT><DD>Optional media type parameter.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following arguments by default; if overridden, should return standard <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> values.
<TABLE>
<TR><TD><A HREF="../Error_Success_Codes.htm#VFW_E_ALREADY_CONNEC">VFW_E_ALREADY_CONNECTED</A>
</TD><TD>This output pin is already connected to another pin.
</TD></TR><TR><TD><A HREF="../Error_Success_Codes.htm#VFW_E_NOT_STOPPED">VFW_E_NOT_STOPPED</A>
</TD><TD>The filter graph is not in a stopped state and connection can't be performed.
</TD></TR><TR><TD>Other error value
</TD><TD>Returned from <A HREF="CBasePin.htm#AgreeMediaType">CBasePin::AgreeMediaType</A> or <A HREF="CBasePin.htm#CheckConnect">CBasePin::CheckConnect</A> or overridden versions of these member functions.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#Connect">IPin::Connect</A> method.
<B>IPin::Connect</B> is implemented on the output pin and calls the
<A HREF="../iface/IPin.htm#ReceiveConnection">IPin::ReceiveConnection</A> method for the connected input pin (implemented
in the base classes as <A HREF="CBasePin.htm#ReceiveConnection">CBasePin::ReceiveConnection</A>). This member
function calls the virtual <A HREF="CBasePin.htm#CheckConnect">CBasePin::CheckConnect</A> member function,
which can be overridden to verify that the connection is possible.
<B>CBasePin::CheckConnect</B> then calls <A HREF="CBasePin.htm#AgreeMediaType">CBasePin::AgreeMediaType</A>
to negotiate a common media type with the connected pin.

<P><A HREF="CBasePin.htm#AgreeMediaType">CBasePin::AgreeMediaType</A> calls <A HREF="CBasePin.htm#TryMediaTypes">CBasePin::TryMediaTypes</A> twice; once for
this pin's media type enumerator and once for the receiving pin's 
media type enumerator. For each media type found, <A HREF="CBasePin.htm#AttemptConnection">CBasePin::AttemptConnection</A>
is called, which in turn calls the receiving pin's <A HREF="../iface/IPin.htm#ReceiveConnection">IPin::ReceiveConnection</A>
method, and finally <A HREF="CBasePin.htm#CompleteConnect">CBasePin::CompleteConnect</A> if successful.
</BLOCKQUOTE>


<H1><A NAME="ConnectedTo">CBasePin::ConnectedTo</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves a pointer to the connected pin, if there is one.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>ConnectedTo</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>**</B> <I>ppPin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppPin</I>
 </DT><DD><A HREF="../iface/IPin.htm">IPin</A> interface of the other pin (if any) to
which this pin is connected.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>The base class returns S_OK if connected; otherwise, returns <A HREF="../Error_Success_Codes.htm#VFW_E_NOT_CONNECTED">VFW_E_NOT_CONNECTED</A>.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#ConnectedTo">IPin::ConnectedTo</A> method.
It adds a reference to the connected <A HREF="../iface/IPin.htm">IPin</A> interface
by calling the <A HREF="../iface/IUnknown.htm#AddRef">IUnknown::AddRef</A> method, because each copy of
an interface pointer has its reference incremented. The calling application
is responsible for calling <A HREF="../iface/IUnknown.htm#Release">IUnknown::Release</A> on this interface
when done with it.
</BLOCKQUOTE>


<H1><A NAME="ConnectionMediaType">CBasePin::ConnectionMediaType</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves the media type associated with the current connection of the pin. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>ConnectionMediaType</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_MEDIA_TYPE</B> <I>*pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pmt</I>
 </DT><DD>Pointer to an <A HREF="../structs.htm#AM_MEDIA_TYPE">AM_MEDIA_TYPE</A> structure. If the pin isn't connected,
this structure is initialized to zero. Otherwise, the media type is returned in this parameter.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#ConnectionMediaType">IPin::ConnectionMediaType</A> method. It
returns a copy of the <A HREF="../structs.htm#AM_MEDIA_TYPE">AM_MEDIA_TYPE</A> structure that was negotiated for the pin connection 
when the pin was connected. 

<P>This method fails if the pin is unconnected. The task allocator allocates the media type's format block. Use the task
allocator to free the format block, for example by calling the Microsoft Win32 
<A HREF="../../appendixes/Further_Reading.htm#CoTaskMemFree">CoTaskMemFree</A> function.

</BLOCKQUOTE>


<H1><A NAME="CurrentRate">CBasePin::CurrentRate</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves the segment rate set by the <A HREF="CBasePin.htm#NewSegment">CBasePin::NewSegment</A> member function.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>double</B> <B>CurrentRate</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the value of <A HREF="CBasePin.htm#CBasePin::m_dRate">m_dRate</A>.

</BLOCKQUOTE>


<H1><A NAME="CurrentStartTime">CBasePin::CurrentStartTime</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves the segment start time set by the <A HREF="CBasePin.htm#NewSegment">CBasePin::NewSegment</A> member function.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>REFERENCE_TIME</B> <B>CurrentStartTime</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the value of <A HREF="CBasePin.htm#CBasePin::m_tStart">m_tStart</A>.


</BLOCKQUOTE>


<H1><A NAME="CurrentStopTime">CBasePin::CurrentStopTime</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves the segment stop time set by the <A HREF="CBasePin.htm#NewSegment">CBasePin::NewSegment</A> member function.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>REFERENCE_TIME</B> <B>CurrentStopTime</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the value of <A HREF="CBasePin.htm#CBasePin::m_tStop">m_tStop</A>.


</BLOCKQUOTE>


<H1><A NAME="Disconnect">CBasePin::Disconnect</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Breaks a connection.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Disconnect</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR if there is no connection.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#Disconnect">IPin::Disconnect</A> method.
It calls the <A HREF="CBasePin.htm#BreakConnect">CBasePin::BreakConnect</A> member function and releases the 
<A HREF="../iface/IPin.htm">IPin</A> interface of the connected pin (held by <A HREF="CBasePin.htm#CBasePin::m_Connected">m_Connected</A>). 
There are no parameters because there is only one possible connection on this pin.
</BLOCKQUOTE>


<H1><A NAME="DisplayPinInfo">CBasePin::DisplayPinInfo</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Displays pin information during debugging.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>DisplayPinInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <I>*pReceivePin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pReceivePin</I>
</DT><DD>Pointer to the receiving pin.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>


<H1><A NAME="DisplayTypeInfo">CBasePin::DisplayTypeInfo</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Displays media type information during debugging.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>DisplayTypeInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <I>*pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>CMediaType</B> <I>*pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
</DT><DD>Pointer to the pin's <A HREF="../iface/IPin.htm">IPin</A> interface.

</DD><DT><I>pmt</I>
</DT><DD>Pointer to the media type object.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function displays the major and minor media types of the specified media type object.
</BLOCKQUOTE>


<H1><A NAME="EndOfStream">CBasePin::EndOfStream</A><HR size=1></H1>
<A HREF="../iface/IPin.htm">IPin Interface</A>
<P>Informs the input pin that no additional data is expected until a new run command is issued.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>EndOfStream</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_FALSE.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#EndOfStream">IPin::EndOfStream</A> method.
This is intended for input pins only.
</BLOCKQUOTE>


<H1><A NAME="EnumMediaTypes">CBasePin::EnumMediaTypes</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Provides an enumerator for this pin's preferred media types.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>EnumMediaTypes</B><B>(</B><BR>&nbsp;&nbsp;<B>IEnumMediaTypes</B> <B>**</B> <I>ppEnum</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppEnum</I>
</DT><DD>Pointer to an enumerator for the media types.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#EnumMediaTypes">IPin::EnumMediaTypes</A> method. It returns an enumerator object implemented by the <A HREF="CEnumMediaTypes.htm">CEnumMediaTypes</A> class and 
obtains the <A HREF="../iface/IEnumMediaTypes.htm">IEnumMediaTypes</A> interface, which adds a reference count to this enumerator. If an application receives an enumerator, the application must release this
when done with it by calling <A HREF="../iface/IUnknown.htm#Release">IUnknown::Release</A> on the enumerator.
</BLOCKQUOTE>


<H1><A NAME="GetConnected">CBasePin::GetConnected</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves the pin that is connected to this pin.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>IPin</B> <B>*</B> <B>GetConnected</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a pointer to an <A HREF="../iface/IPin.htm">IPin</A> interface.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The caller should call the <A HREF="CBasePin.htm#IsConnected">CBasePin::IsConnected</A> member function
before calling <B>CBasePin::GetConnected</B>.
</BLOCKQUOTE>


<H1><A NAME="GetMediaType">CBasePin::GetMediaType</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves the current type version, which is used by enumerators.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>GetMediaType</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>iPosition</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>CMediaType</B> <I>*pMediaType</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>iPosition</I>
 </DT><DD>Position in the media type list.
</DD><DT><I>pMediaType</I>
 </DT><DD>Returned pointer to the media type at this position.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_UNEXPECTED by default implementation; the overriding member function 
should return one of the following values, or an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> error value if the value could not be
set.
<TABLE>
<TR><TD>S_FALSE </TD><TD>Media type exists but is not currently usable.
</TD></TR><TR><TD>S_OK </TD><TD>Media type was set.
</TD></TR><TR><TD><A HREF="../Error_Success_Codes.htm#VFW_S_NO_MORE_ITEMS">VFW_S_NO_MORE_ITEMS</A> </TD><TD>End of the list of media types has been reached.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This is a virtual member function that returns a media type corresponding to
the position in the list specified by the <I>iPosition</I> parameter. This base class simply returns 
an error because no media types are supported by default. Derived classes should override this 
member function.
</BLOCKQUOTE>


<H1><A NAME="GetMediaTypeVersion">CBasePin::GetMediaTypeVersion</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves the current type version, which is used by enumerators.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>LONG</B> <B>GetMediaTypeVersion</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the value of <A HREF="CBasePin.htm#CBasePin::m_TypeVersion">m_TypeVersion</A> by default. To return new media types, 
override this member function.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This is a virtual member function that returns the current media type version.
The base class initializes the media type enumerators to 1. A derived class can change the list
of available media types. Each time it does, it should increment
the version in the overriding member function. The media type enumerators
call this member function when they are called to determine if they are out of date.
</BLOCKQUOTE>


<H1><A NAME="Inactive">CBasePin::Inactive</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Switches the pin to an inactive state.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>Inactive</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR for a base class implementation. The overriding member function
returns a standard <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value and should not fail if the pin is already set as inactive.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called by the <A HREF="../iface/IMediaFilter.htm">IMediaFilter</A> implementation when the state 
changes to inactive. This member function should be overridden to decommit allocators and free 
any hardware resources that were obtained in the <A HREF="CBasePin.htm#Active">CBasePin::Active</A> call. The default 
implementation of the base class member function does nothing.

<P>Note that the filter graph manager's internal state variable is not updated until after this
member function returns, so testing the filter graph manager's state (directly or 
indirectly) from within this member function should be avoided. 

</BLOCKQUOTE>


<H1><A NAME="IncrementTypeVersion">CBasePin::IncrementTypeVersion</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Adds 1 to the current media type version.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>IncrementTypeVersion</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The media type version is used to ensure that the filter has not changed the media type. If it changes the media type, the filter should call this member function. 
</BLOCKQUOTE>


<H1><A NAME="IsConnected">CBasePin::IsConnected</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Determines if the pin is connected to another pin.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>BOOL</B> <B>IsConnected</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns TRUE if the pin is connected; otherwise, returns FALSE.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function checks the value of the <A HREF="CBasePin.htm#CBasePin::m_Connected">m_Connected</A> protected data member.
</BLOCKQUOTE>


<H1><A NAME="IsStopped">CBasePin::IsStopped</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Determines if the filter is stopped.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>BOOL</B> <B>IsStopped</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns TRUE if the filter is stopped; otherwise, returns FALSE.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Note that this member function must not be used in the constructor of the pin, because the 
filter that is passed is often not initialized properly at that time (due to the convention of using a 
<B>this</B> pointer during the construction of data members).
</BLOCKQUOTE>


<H1><A NAME="Name">CBasePin::Name</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves the name of the pin.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>LPWSTR</B> <B>Name</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the value of the <A HREF="CBasePin.htm#CBasePin::m_pName">m_pName</A> data member.

</BLOCKQUOTE>


<H1><A NAME="NewSegment">CBasePin::NewSegment</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Specifies that samples following this call are grouped as a segment with a
given start time, stop time, and rate.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>NewSegment</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStart</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStop</I><B>,</B><BR>&nbsp;&nbsp;<B>double</B> <I>dRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>tStart</I>
</DT><DD>Start time of the segment.
</DD><DT><I>tStop</I>
</DT><DD>Stop time of the segment.
</DD><DT><I>dRate</I>
</DT><DD>Rate of the segment.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value (S_OK by default).

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#NewSegment">IPin::NewSegment</A> method.
The default implementation sets the <A HREF="CBasePin.htm#CBasePin::m_tStart">m_tStart</A>, <A HREF="CBasePin.htm#CBasePin::m_tStop">m_tStop</A>, and 
<A HREF="CBasePin.htm#CBasePin::m_dRate">m_dRate</A> data members to the values passed in as parameters. Overriding
member functions should pass this notification downstream. 
</BLOCKQUOTE>


<H1><A NAME="NonDelegatingAddRef">CBasePin::NonDelegatingAddRef</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Increments the reference count for an interface.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>ULONG</B> <B>NonDelegatingAddRef</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the reference count of the object.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../utilfunct/INonDelegatingUnknown_iface.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingAddRef</A>
method. It increments the reference count of the owning filter. 
</BLOCKQUOTE>


<H1><A NAME="NonDelegatingQueryInterface">CBasePin::NonDelegatingQueryInterface</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves an interface and increments the reference count.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>NonDelegatingQueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <B>**</B> <I>ppv</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>riid</I>
 </DT><DD>Reference identifier.
</DD><DT><I>ppv</I>
 </DT><DD>Pointer to the interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_POINTER if <I>ppv</I> is invalid. Returns NOERROR if the query is successful or E_NOINTERFACE if it is not. 

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the 
<A HREF="../utilfunct/INonDelegatingUnknown_iface.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingQueryInterface</A> method and passes out 
references to the <A HREF="../iface/IPin.htm">IPin</A>, <A HREF="../iface/IQualityControl.htm">IQualityControl</A>, and <A HREF="../iface/IUnknown.htm">IUnknown</A> interfaces. 
Override this class to return other interfaces on the object in the derived class.
</BLOCKQUOTE>


<H1><A NAME="NonDelegatingRelease">CBasePin::NonDelegatingRelease</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Decrements the reference count for an interface.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>ULONG</B> <B>NonDelegatingRelease</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the reference count.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../utilfunct/INonDelegatingUnknown_iface.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingRelease</A>
method. It releases a reference to the owning filter. 
</BLOCKQUOTE>


<H1><A NAME="Notify">CBasePin::Notify</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Notifies the recipient that a quality change is requested.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Notify</B><B>(</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <B>*</B> <I>pSelf</I><B>,</B><BR>&nbsp;&nbsp;<B>Quality</B> <I>q</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSelf</I>
 </DT><DD>Pointer to the filter that is sending the quality notification.
</DD><DT><I>q</I>
 </DT><DD>Quality notification structure.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>The default base class implementation returns E_FAIL.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function must be overridden to accept notifications. It is
typically overridden to implement this method on the output pin
because quality-control messages are passed upstream. The
<A HREF="CTransformOutputPin.htm#Notify">CTransformOutputPin::Notify</A> member function is one example of
how this member function is overridden to pass quality-control messages to the
next filter upstream.
</BLOCKQUOTE>


<H1><A NAME="QueryAccept">CBasePin::QueryAccept</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Determines whether the pin accepts the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#format_type')">format type</A>.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryAccept</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>AM_MEDIA_TYPE*</B> <I>pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pmt</I>
</DT><DD>Pointer to a proposed media type.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_TRUE if the format is accepted; otherwise, returns S_FALSE.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#QueryAccept">IPin::QueryAccept</A> method. It simply calls the pure virtual <A HREF="CBasePin.htm#CheckMediaType">CBasePin::CheckMediaType</A> member function, which the derived class must implement, and maps any returned codes from <A HREF="CBasePin.htm#CheckMediaType">CheckMediaType</A> other than S_OK to S_FALSE. 
</BLOCKQUOTE>


<H1><A NAME="QueryDirection">CBasePin::QueryDirection</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves the direction of the pin.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryDirection</B><B>(</B><BR>&nbsp;&nbsp;<B>PIN_DIRECTION*</B> <I>pPinDir</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPinDir</I>
</DT><DD>Pointer to a <A HREF="../dtypes.htm#PIN_DIRECTION">PIN_DIRECTION</A> structure to be filled in with the direction.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#QueryDirection">IPin::QueryDirection</A> method. <I>pPinDir</I> will contain PINDIR_INPUT or PINDIR_OUTPUT. The same information is available through the <A HREF="CBasePin.htm#QueryPinInfo">CBasePin::QueryPinInfo</A> member function, but this member function is more efficient.
</BLOCKQUOTE>


<H1><A NAME="QueryId">CBasePin::QueryId</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves an identifier for the pin.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryId</B><B>(</B><BR>&nbsp;&nbsp;<B>LPWSTR</B> <B>*</B> <I>Id</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>Id</I>
</DT><DD>Pin identifier.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#QueryId">IPin::QueryId</A> method. By default, this member function uses the pin name in the <A HREF="CBasePin.htm#CBasePin::m_pName">CBasePin::m_pName</A> data 
member, so implementing this member function in your derived filter class is not normally required.


</BLOCKQUOTE>


<H1><A NAME="QueryInternalConnections">CBasePin::QueryInternalConnections</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Provides an array of pointers to <A HREF="../iface/IPin.htm">IPin</A> objects. These are the pins to which this pin internally connects.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryInternalConnections</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>**</B> <I>apPin</I><B>,</B><BR>&nbsp;&nbsp;<B>ULONG</B> <B>*</B> <I>nPin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>apPin</I>
</DT><DD>Array of <A HREF="../iface/IPin.htm">IPin</A> pointers.
</DD><DT><I>nPin</I>
</DT><DD>Upon input, indicates the number of channels; upon output, indicates the number of pins.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> values.
<TABLE>
<TR><TD>E_FAIL 
 </TD><TD>Undetermined failure.
</TD></TR><TR><TD>E_NOTIMPL 
 </TD><TD>The filter graph manager interprets E_NOTIMPL as meaning all input pins connect to all output pins.
</TD></TR><TR><TD>S_FALSE 
 </TD><TD>Insufficient number of channels; returns no pins in <I>apPin</I>.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#QueryInternalConnections">IPin::QueryInternalConnections</A> method but only to return E_NOTIMPL. Override this if you want to provide mapping between specific input and output pins.

<P>The default implementation to return E_NOTIMPL implies that the caller can assume that all input pins feed all output pins. Overriding this member function allows a filter to specify when it is a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> for some of its input pins and not for others.
</BLOCKQUOTE>


<H1><A NAME="QueryPinInfo">CBasePin::QueryPinInfo</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Retrieves information about the pin.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryPinInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>PIN_INFO</B> <B>*</B> <I>pInfo</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pInfo</I>
</DT><DD>Pointer to a <A HREF="../structs.htm#PIN_INFO">PIN_INFO</A> structure.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#QueryPinInfo">IPin::QueryPinInfo</A> method. By default, the member function fills in the <A HREF="../structs.htm#PIN_INFO">PIN_INFO</A> structure with the
<A HREF="../iface/IBaseFilter.htm">IBaseFilter</A> interface of its owning filter, the pin name from <A HREF="CBasePin.htm#CBasePin::m_pName">m_pName</A>, and the pin direction from <A HREF="CBasePin.htm#CBasePin::m_dir">m_dir</A>.

<P>The <A HREF="../iface/IBaseFilter.htm">IBaseFilter</A> interface passed out by this member function is reference counted, and so must be released when the caller has finished with it. 

</BLOCKQUOTE>


<H1><A NAME="ReceiveConnection">CBasePin::ReceiveConnection</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Makes a connection to the calling output pin.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>ReceiveConnection</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>pConnector</I><B>,</B><BR>&nbsp;&nbsp;<B>AM_MEDIA_TYPE</B> <I>*pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pConnector</I>
 </DT><DD>Connecting pin.
</DD><DT><I>pmt</I>
 </DT><DD>Media type of the samples to be streamed.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IPin.htm#ReceiveConnection">IPin::ReceiveConnection</A> method. It calls 
<A HREF="CBasePin.htm#CheckConnect">CheckConnect</A> and, if successful, then calls 
<A HREF="CBasePin.htm#CheckMediaType">CheckMediaType</A> to verify if the media type is acceptable. If either of these calls fails, it calls 
<A HREF="CBasePin.htm#BreakConnect">BreakConnect</A> and exits. To finish the connection process, it calls 
<A HREF="CBasePin.htm#CompleteConnect">CompleteConnect</A>, which is implemented in <A HREF="CBasePin.htm">CBasePin</A> to return NOERROR, but can be overridden in the derived class.
</BLOCKQUOTE>


<H1><A NAME="Run">CBasePin::Run</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Notifies the pin that the filter has changed state from paused to running.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Run</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStart</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>tStart</I>
</DT><DD>Start time as passed to the filter's <A HREF="../iface/IMediaFilter.htm#Run">Run</A> method. 
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value (NOERROR_OK by default).


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function can be overridden in the derived class to perform 
activities such as committing memory or obtaining resources. For an overriding implementation
of this member function, see the <A HREF="CRenderedInputPin.htm#Run">CRenderedInputPin::Run</A> member function. 

<P>Note that the filter graph manager's internal state variable is not updated until after this
member function returns, so testing the filter graph manager's state (directly or 
indirectly) from within this member function should be avoided. 

</BLOCKQUOTE>


<H1><A NAME="SetMediaType">CBasePin::SetMediaType</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Sets the <A HREF="CBasePin.htm#CBasePin::m_mt">m_mt</A> data member to the established media type. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>SetMediaType</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>CMediaType</B> <B>*</B> <I>pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pmt</I>
</DT><DD>Pointer to a media type object that was previously agreed on.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR by default implementation. The overriding member functions return
an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called to establish the format for a pin connection. The
<A HREF="CBasePin.htm#CheckMediaType">CBasePin::CheckMediaType</A> member function
will have been called to check the connection format and, if it did not return an error value,
this virtual member function will be called. The default implementation sets the <A HREF="CBasePin.htm#CBasePin::m_mt">m_mt</A> 
protected data member to the value passed to this member function. Override to inform the derived class when the media type is set.
</BLOCKQUOTE>


<H1><A NAME="SetSink">CBasePin::SetSink</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Sets the object containing the <A HREF="../iface/IQualityControl.htm">IQualityControl</A> interface that will receive quality-control messages.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetSink</B><B>(</B><BR>&nbsp;&nbsp;<B>IQualityControl</B> <I>*piqc</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>piqc</I>
</DT><DD>Pointer to the <A HREF="../iface/IQualityControl.htm">IQualityControl</A> interface to which the notifications should be sent.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Base class returns NOERROR by default. The overriding member function should return an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IQualityControl.htm#SetSink">IQualityControl::SetSink</A> method. The default implementation sets the 
<A HREF="CBasePin.htm#CBasePin::m_pQSink">m_pQSink</A> data member to the <I>piqc</I> parameter passed in. 

<P>The <A HREF="../iface/IQualityControl.htm#SetSink">IQualityControl::SetSink</A> method tells a filter where to send quality-control messages it receives. When no sink has been explicitly set or if the last call to <B>CBasePin::SetSink</B> set the sink to NULL, the message should go upstream. The derived output pin class typically overrides <A HREF="CBasePin.htm#Notify">CBasePin::Notify</A> to enable this. 
</BLOCKQUOTE>


<H1><A NAME="TryMediaTypes">CBasePin::TryMediaTypes</A><HR size=1></H1>
<A HREF="CBasePin.htm">CBasePin Class</A>
<P>Determines a media type for a pin connection.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>TryMediaTypes</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <I>*pReceivePin</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>CMediaType</B> <I>*pmt</I><B>,</B><BR>&nbsp;&nbsp;<B>IEnumMediaTypes</B> <I>*pEnum</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pReceivePin</I>
</DT><DD>Pointer to the <A HREF="../iface/IPin.htm">IPin</A> interface of the receiving pin.
</DD><DT><I>pmt</I>
</DT><DD>Pointer to a returned media type.
</DD><DT><I>pEnum</I>
</DT><DD>Pointer to an <A HREF="../iface/IEnumMediaTypes.htm">IEnumMediaTypes</A> enumerator interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value, which can include the following.
<TABLE>
<TR><TD>FAILED
</TD><TD>Resetting of the enumerator failed.
</TD></TR><TR><TD>NOERROR
</TD><TD>Media type found.
</TD></TR><TR><TD><A HREF="../Error_Success_Codes.htm#VFW_E_NO_ACCEPTABLE_">VFW_E_NO_ACCEPTABLE_TYPES</A>
</TD><TD>No acceptable media types were found.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Given an enumerator, this member function cycles through all the media types proposed 
by the enumerator. Each type is suggested to the derived pin class and, if acceptable, is tried with the 
connected pin in a call to the <A HREF="../iface/IPin.htm#ReceiveConnection">IPin::ReceiveConnection</A> method. This means that if the 
owning pin proposes a media type, it is still checked to determine whether it is supported. This is 
deliberate so that, in simple cases, the enumerator can
hold all the media types, even if some of them are not currently available.

<P>This member function is protected.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
