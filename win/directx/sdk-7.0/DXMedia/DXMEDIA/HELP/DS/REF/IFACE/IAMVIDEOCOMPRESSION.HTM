<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IAMVideoCompression Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IAMVideoCompression Interface">
<META NAME="Description" CONTENT="IAMVideoCompression::GetInfo">
<META NAME="Description" CONTENT="IAMVideoCompression::get_KeyFrameRate">
<META NAME="Description" CONTENT="IAMVideoCompression::get_PFramesPerKeyFrame">
<META NAME="Description" CONTENT="IAMVideoCompression::get_Quality">
<META NAME="Description" CONTENT="IAMVideoCompression::get_WindowSize">
<META NAME="Description" CONTENT="IAMVideoCompression::OverrideFrameSize">
<META NAME="Description" CONTENT="IAMVideoCompression::OverrideKeyFrame">
<META NAME="Description" CONTENT="IAMVideoCompression::put_KeyFrameRate">
<META NAME="Description" CONTENT="IAMVideoCompression::put_PFramesPerKeyFrame">
<META NAME="Description" CONTENT="IAMVideoCompression::put_Quality">
<META NAME="Description" CONTENT="IAMVideoCompression::put_WindowSize">
<META NAME="Description" CONTENT="GetInfo (IAMVideoCompression)">
<META NAME="Description" CONTENT="get_KeyFrameRate (IAMVideoCompression)">
<META NAME="Description" CONTENT="get_PFramesPerKeyFrame (IAMVideoCompression)">
<META NAME="Description" CONTENT="get_Quality (IAMVideoCompression)">
<META NAME="Description" CONTENT="get_WindowSize (IAMVideoCompression)">
<META NAME="Description" CONTENT="OverrideFrameSize (IAMVideoCompression)">
<META NAME="Description" CONTENT="OverrideKeyFrame (IAMVideoCompression)">
<META NAME="Description" CONTENT="put_KeyFrameRate (IAMVideoCompression)">
<META NAME="Description" CONTENT="put_PFramesPerKeyFrame (IAMVideoCompression)">
<META NAME="Description" CONTENT="put_Quality (IAMVideoCompression)">
<META NAME="Description" CONTENT="put_WindowSize (IAMVideoCompression)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IAMVideoCompression"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IAMVfwCompressDialogs.htm">IAMVfwCompressDialogs Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IAMVideoControl.htm">IAMVideoControl Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IAMVideoCompression Interface</H1>
<P>The <B>IAMVideoCompression</B> <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> interface enables you to control compression parameters that aren't part of the media type.


<P>The <A HREF="IAMVideoCompression.htm#put_PFramesPerKeyFrame">put_PFramesPerKeyFrame</A> and 
<A HREF="IAMVideoCompression.htm#get_PFramesPerKeyFrame">get_PFramesPerKeyFrame</A> methods refer to predicted (P) frames and bidirectional (B) frames, which are MPEG concepts and not generally applicable to simpler types of compressors.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>Implement this interface on the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pin</A> of a video capture or video compressor <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> that provides compressed video data. 

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>An application can use this interface to control how video is compressed, including characteristics such as the number of key frames and frame quality. Use it to retrieve a textual description of the compressor and other available information, including the compressor's capabilities.

<P><B>Note</B> This interface is not always available unless the output pin of a capture filter is connected to another filter in the graph.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Retrieves pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IAMVideoCompression methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IAMVideoCompression.htm#put_KeyFrameRate">put_KeyFrameRate</A> </TD><TD>Sets the key frame rate.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#get_KeyFrameRate">get_KeyFrameRate</A> </TD><TD>Retrieves the key frame rate.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#put_PFramesPerKeyFrame">put_PFramesPerKeyFrame</A> </TD><TD>Sets the predicted (P) frame frequency.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#get_PFramesPerKeyFrame">get_PFramesPerKeyFrame</A> </TD><TD>Retrieves the P frame frequency.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#put_Quality">put_Quality</A> </TD><TD>Sets the quality of the video image compression.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#get_Quality">get_Quality</A> </TD><TD>Retrieves the current image quality setting.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#put_WindowSize">put_WindowSize</A> </TD><TD>Sets the number of frames over which the compressor must maintain an average data rate.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#get_WindowSize">get_WindowSize</A> </TD><TD>Retrieves the number of frames over which the compressor must maintain an average data rate.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#GetInfo">GetInfo</A> </TD><TD>Retrieves compressor information.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#OverrideKeyFrame">OverrideKeyFrame</A> </TD><TD>Forces a particular frame to be a key frame.
</TD></TR><TR><TD><A HREF="IAMVideoCompression.htm#OverrideFrameSize">OverrideFrameSize</A> </TD><TD>Overrides a particular frame's data rate.
</TD></TR></TABLE>


<H1><A NAME="GetInfo">IAMVideoCompression::GetInfo</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Retrieves compressor information.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>WCHAR</B> <B>*</B> <I>pszVersion</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>*pcbVersion</I><B>,</B><BR>&nbsp;&nbsp;<B>LPWSTR</B> <I>pszDescription</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>*pcbDescription</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pDefaultKeyFrameRate</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pDefaultPFramesPerKey</I><B>,</B><BR>&nbsp;&nbsp;<B>double</B> <I>*pDefaultQuality</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pCapabilities</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pszVersion</I>
</DT><DD>[out] Pointer to a version string, such as "Version 2.1.0".
</DD><DT><I>pcbVersion</I>
</DT><DD>[in,out] Size needed for a version string. Pointer to the number of bytes in the Unicode string, not the number of characters, so it must be twice the number of characters the string can hold. Call with this set to NULL to retrieve the current size.
</DD><DT><I>pszDescription</I>
</DT><DD>[out] Pointer to a description string, such as "Awesome Video Compressor". 
</DD><DT><I>pcbDescription</I>
</DT><DD>[in,out] Size needed for a description string. Pointer to the number of bytes in the Unicode string, not the number of characters, so it must be twice the number of characters the string can hold. Call with this set to NULL to retrieve the current size.
</DD><DT><I>pDefaultKeyFrameRate</I>
</DT><DD>[out] Pointer to receive the default key frame rate.
</DD><DT><I>pDefaultPFramesPerKey</I>
</DT><DD>[out] Pointer to receive the default predicted (P) frames per key frame.
</DD><DT><I>pDefaultQuality</I>
</DT><DD>[out] Pointer to receive the default quality.
</DD><DT><I>pCapabilities</I>
</DT><DD>[out] Pointer to receive the compression capabilities, which are a combination of the <A HREF="../dtypes.htm#CompressionCaps">CompressionCaps</A> data type flags.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 



<H1><A NAME="get_KeyFrameRate">IAMVideoCompression::get_KeyFrameRate</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Retrieves the current key frame rate.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>get_KeyFrameRate</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>pKeyFrameRate</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pKeyFrameRate</I>
</DT><DD>[out] Compressor's current key frame rate. A negative value means it is using the default frame rate for the video compressor. A zero value means only the first frame is a key frame.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>To determine if the compressor supports this method, check for the <A HREF="../dtypes.htm#CompressionCaps_CanK">CompressionCaps_CanKeyFrame</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="IAMVideoCompression.htm#GetInfo">IAMVideoCompression::GetInfo</A> method.</BLOCKQUOTE>
 
<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="iamvideocompression.htm#put_KeyFrameRate">IAMVideoCompression::put_KeyFrameRate</A></BLOCKQUOTE>



<H1><A NAME="get_PFramesPerKeyFrame">IAMVideoCompression::get_PFramesPerKeyFrame</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Retrieves the predicted (P) frame interval.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>get_PFramesPerKeyFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>pPFramesPerKeyFrame</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pPFramesPerKeyFrame</I>
</DT><DD>[out] Pointer to receive the number of P frames per key frame. A negative value means the compressor will use its default value.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The Video for Windows capture filter (<A HREF="../../filtsamp/VFW_Video_Capture.htm#VFW_Video_Capture">VFW Video Capture</A>) and the AVI <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#compression_filter')">compression filter</A> (<A HREF="../../filtsamp/AVI_Compressor.htm#AVI_Compressor">AVI Compressor</A>) do not currently support this interface and return E_NOTIMPL.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>To determine if the compressor supports this method,
check for the <A HREF="../dtypes.htm#CompressionCaps_CanB">CompressionCaps_CanBFrame</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="IAMVideoCompression.htm#GetInfo">IAMVideoCompression::GetInfo</A> method.

<P>As an example of the relationship between the types of frames, suppose a key frame occurs once in every 10 frames, and there are 3 P frames per key frame. The P frames will be spaced evenly between the key frames. The other 6 frames, which occur between the key frames and the P frames, will be bidirectional (B) frames.</BLOCKQUOTE>
 
<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="iamvideocompression.htm#put_KeyFrameRate">IAMVideoCompression::put_KeyFrameRate</A></BLOCKQUOTE>



<H1><A NAME="get_Quality">IAMVideoCompression::get_Quality</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Retrieves the current image quality setting.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>get_Quality</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <B>*</B> <I>pQuality</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pQuality</I>
</DT><DD>[out] Current quality setting.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The quality is a value between 0 and 1. One indicates the highest (best) quality and 0 indicates the lowest (worst) quality. A negative number means it is using the compressor default. The compressor interprets this number; this interpretation varies from compressor to compressor. When the compressor is not compressing to a specific data rate, the value will roughly determine the image size or quality.

<P>To determine if the compressor supports this method, check for the <A HREF="../dtypes.htm#CompressionCaps_CanQ">CompressionCaps_CanQuality</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="IAMVideoCompression.htm#GetInfo">IAMVideoCompression::GetInfo</A> method.

<P>If you are compressing to a fixed data rate, a high quality value means use all of the data rate, and a low quality value means you can use much lower than the data rate.</BLOCKQUOTE>
 



<H1><A NAME="get_WindowSize">IAMVideoCompression::get_WindowSize</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Retrieves the number of frames over which the compressor must maintain an average data rate.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>get_WindowSize</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORDLONG</B> <B>*</B> <I>pWindowSize</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pWindowSize</I>
</DT><DD>[out] Pointer to a DWORDLONG value that will receive the window size.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 


<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMVideoCompression.htm#put_WindowSize">IAMVideoCompression::put_WindowSize</A></BLOCKQUOTE>



<H1><A NAME="OverrideFrameSize">IAMVideoCompression::OverrideFrameSize</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Overrides a frame's data rate.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>OverrideFrameSize</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>FrameNumber</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>Size</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>FrameNumber</I>
</DT><DD>[in] Frame number for which to change the size.
</DD><DT><I>Size</I>
</DT><DD>[in] Desired size, in bytes, for the specified frame.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The Video for Windows capture filter (<A HREF="../../filtsamp/VFW_Video_Capture.htm#VFW_Video_Capture">VFW Video Capture</A>) and the AVI compression filter (<A HREF="../../filtsamp/AVI_Compressor.htm#AVI_Compressor">AVI Compressor</A>) do not currently support this interface and return E_NOTIMPL.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>To determine if the compressor might support this method, check for the <A HREF="../dtypes.htm#CompressionCaps_CanC">CompressionCaps_CanCrunch</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="IAMVideoCompression.htm#GetInfo">IAMVideoCompression::GetInfo</A> method. The flag might also be set to indicate that the 
<A HREF="../structs.htm#VIDEOINFOHEADER_dwBitRate">dwBitRate</A> value can be set in the <A HREF="../structs.htm#AM_MEDIA_TYPE">AM_MEDIA_TYPE</A>'s <A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure.

<P>The frame number refers to which frame goes out of the filter after it is streaming. For example, frame 0 means the first frame this pin delivers. Frame 11 means the twelfth frame it delivers. Be sure to call this method before the filter delivers the frame for which you want to provide a different size.

<P>Overriding the frame size (or "crunching" the frame) instructs the filter to make the frame size this many bytes or less instead of the originally planned size.</BLOCKQUOTE>
 



<H1><A NAME="OverrideKeyFrame">IAMVideoCompression::OverrideKeyFrame</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Forces a frame to be a key frame.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>OverrideKeyFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>FrameNumber</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>FrameNumber</I>
</DT><DD>[in] Number of the frame to be made a key frame when the graph runs, even if it wouldn't usually be a key frame.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The Video for Windows capture filter (<A HREF="../../filtsamp/VFW_Video_Capture.htm#VFW_Video_Capture">VFW Video Capture</A>) and the AVI compression filter (<A HREF="../../filtsamp/AVI_Compressor.htm#AVI_Compressor">AVI Compressor</A>) do not currently support this interface and return E_NOTIMPL.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>After a compressor creates a key frame, it might reset its count to determine when the next key frame should occur. For example, assume a key frame typically occurs once every 10 frames. If you mark frame 5 as a key frame using <B>OverrideKeyFrame</B>, the compressor might wait 10 more frames until creating the next key frame.</BLOCKQUOTE> 


<H1><A NAME="put_KeyFrameRate">IAMVideoCompression::put_KeyFrameRate</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Sets the key frame rate. 

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>put_KeyFrameRate</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>KeyFrameRate</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>KeyFrameRate</I>
</DT><DD>[in] Desired key frame rate. A negative value means use the default frame rate for the video compressor. A zero value means that only the first frame is a key frame.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>To determine if the compressor supports this method, check for the <A HREF="../dtypes.htm#CompressionCaps_CanK">CompressionCaps_CanKeyFrame</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="IAMVideoCompression.htm#GetInfo">IAMVideoCompression::GetInfo</A> method.</BLOCKQUOTE>
 



<H1><A NAME="put_PFramesPerKeyFrame">IAMVideoCompression::put_PFramesPerKeyFrame</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Sets predicted (P) frame interval.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>put_PFramesPerKeyFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>PFramesPerKeyFrame</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>PFramesPerKeyFrame</I>
</DT><DD>[in] Desired P frame interval. A negative value means use the default frame rate for the video compressor. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The Video for Windows capture filter (<A HREF="../../filtsamp/VFW_Video_Capture.htm#VFW_Video_Capture">VFW Video Capture</A>) and the AVI compression filter (<A HREF="../../filtsamp/AVI_Compressor.htm#AVI_Compressor">AVI Compressor</A>) do not currently support this interface and return E_NOTIMPL.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>To determine if the compressor supports this method, check for the <A HREF="../dtypes.htm#CompressionCaps_CanB">CompressionCaps_CanBFrame</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="IAMVideoCompression.htm#GetInfo">IAMVideoCompression::GetInfo</A> method.

<P>As an example of the relationship between the types of frames, suppose a key frame occurs once in every 10 frames, and there are 3 P frames per key frame. The P frames will be spaced evenly between the key frames. The other 6 frames, which occur between the key frames and the P frames, will be bidirectional (B) frames.</BLOCKQUOTE>

 


<H1><A NAME="put_Quality">IAMVideoCompression::put_Quality</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Sets the quality of the video image.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>put_Quality</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <I>Quality</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>Quality</I>
</DT><DD>[in] Desired quality.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The quality is a value between 0 and 1, inclusive. One indicates the highest (best) quality and 0 indicates the lowest (worst) quality. A negative number means use the compressor default. The compressor (<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#codec')">codec</A>) interprets this number; interpretation varies from codec to codec. When the compressor is not compressing to a specific data rate, the value will roughly determine the image size or quality.

<P>To determine if the compressor supports this method, check the <A HREF="../dtypes.htm#CompressionCaps_CanQ">CompressionCaps_CanQuality</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="IAMVideoCompression.htm#GetInfo">IAMVideoCompression::GetInfo</A> method.

<P>If you are compressing to a fixed data rate, a high quality value means use all of the data rate, and a low quality value means you can use much lower than the data rate.</BLOCKQUOTE>


<H1><A NAME="put_WindowSize">IAMVideoCompression::put_WindowSize</A><HR size=1></H1>
<A HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
<P>Sets the number of frames over which the compressor must maintain an average data rate.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>put_WindowSize</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORDLONG</B> <I>WindowSize</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>WindowSize</I>
</DT><DD>[in] Window size, or number of frames, whose average size cannot exceed the data rate that the compressor has been asked to provide.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>For a window of size <I>n</I>, the average frame size of any consecutive <I>n</I> frames will not exceed the stream's specified data rate, although individual frames can be larger or smaller. For example, if you have set a data rate of 100 kilobytes (KB) per second
 on a 10 frames per second (fps) movie, that will usually mean each frame must be less than or equal to 10 KB. However, by setting a window size of <I>n</I>, you are specifying that as long as the average length of those <I>n</I> frames is less than or equal to 10 KB, it doesn't matter how large the individual frames are. For example, some could be smaller and some could actually be larger than 10 KB, as long as the average is less than or equal to 10 KB.</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMVideoCompression.htm#get_WindowSize">IAMVideoCompression::get_WindowSize</A></BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
