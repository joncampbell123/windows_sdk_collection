<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IAMVfwCompressDialogs Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IAMVfwCompressDialogs Interface">
<META NAME="Description" CONTENT="IAMVfwCompressDialogs::GetState">
<META NAME="Description" CONTENT="IAMVfwCompressDialogs::SendDriverMessage">
<META NAME="Description" CONTENT="IAMVfwCompressDialogs::SetState">
<META NAME="Description" CONTENT="IAMVfwCompressDialogs::ShowDialog">
<META NAME="Description" CONTENT="GetState (IAMVfwCompressDialogs)">
<META NAME="Description" CONTENT="SendDriverMessage (IAMVfwCompressDialogs)">
<META NAME="Description" CONTENT="SetState (IAMVfwCompressDialogs)">
<META NAME="Description" CONTENT="ShowDialog (IAMVfwCompressDialogs)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IAMVfwCompressDialogs"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IAMVfwCaptureDialogs.htm">IAMVfwCaptureDialogs Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IAMVideoCompression.htm">IAMVideoCompression Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IAMVfwCompressDialogs Interface</H1>
<P>The <B>IAMVfwCompressDialogs</B> interface enables an application to display a Video for Windows <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#codec')">codec</A> (compressor/decompressor) Configure or About dialog box and to set and retrieve compressor status.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>Microsoft's video compression manager (VCM) compressor <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> (<A HREF="../../filtsamp/AVI_Compressor.htm#AVI_Compressor">AVI Compressor</A>) implements this interface. Other filters should not need to implement it.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>An application should use this interface when it must enable the user to change compression settings in an VCM compressor's Configure dialog box or to view the compressor's About dialog box. Applications also use this interface to set and retrieve compressor status.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR>
 <TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Retrieves pointers to supported interfaces.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IAMVfwCompressDialogs methods</TH><TH>Description</TH></TR>
 <TR><TD><A HREF="IAMVfwCompressDialogs.htm#ShowDialog">ShowDialog</A>
 </TD><TD>Displays the specified dialog box.
 </TD></TR><TR><TD><A HREF="IAMVfwCompressDialogs.htm#GetState">GetState</A>
 </TD><TD>Retrieves the current configuration settings for the VCM codec currently being used.
 </TD></TR><TR><TD><A HREF="IAMVfwCompressDialogs.htm#SetState">SetState</A>
 </TD><TD>Sets configuration for the VCM codec.
 </TD></TR><TR><TD><A HREF="IAMVfwCompressDialogs.htm#SendDriverMessage">SendDriverMessage</A>
 </TD><TD>Sends a driver-specific message.
</TD></TR></TABLE>


<H1><A NAME="GetState">IAMVfwCompressDialogs::GetState</A><HR size=1></H1>
<A HREF="IAMVfwCompressDialogs.htm">IAMVfwCompressDialogs Interface</A>
<P>Retrieves the current configuration settings for the VCM codec currently being used.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetState</B><B>(</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>pState</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <B>*pcbState</B></PRE></BLOCKQUOTE> 
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pState</I>
 </DT><DD>[out] State of the VCM codec.
</DD><DT><I>pcbState</I>
 </DT><DD>[in, out] Size of the state.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Return value varies depending on the implementation within each driver.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This method calls the COM <A HREF="../../appendixes/Further_Reading.htm#ICGetState">ICGetState</A> macro.</BLOCKQUOTE>



<H1><A NAME="SendDriverMessage">IAMVfwCompressDialogs::SendDriverMessage</A><HR size=1></H1>
<A HREF="IAMVfwCompressDialogs.htm">IAMVfwCompressDialogs Interface</A>
<P> Sends a driver-specific message.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SendDriverMessage</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>uMsg</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dw1</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dw2</I> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>uMsg</I>
 </DT><DD>[in] Message to send to the driver.
</DD><DT><I>dw1</I>
 </DT><DD>[in] Message data.
</DD><DT><I>dw2</I>
 </DT><DD>[in] Message data.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Return value varies depending on the implementation within each driver.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>You should never need to use this method. This method can send any private message to the video compressor (codec). Behavior might
be undetermined in response to arbitrary messages; use this method at your own risk.

<P>This method calls the Video for Windows video compression manager (VCM) <A HREF="../../appendixes/Further_Reading.htm#ICSendMessage">ICSendMessage</A> function to send the message.</BLOCKQUOTE>
 



<H1><A NAME="SetState">IAMVfwCompressDialogs::SetState</A><HR size=1></H1>
<A HREF="IAMVfwCompressDialogs.htm">IAMVfwCompressDialogs Interface</A>
<P>Sets configuration for the VCM codec.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetState</B><B>(</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>pState</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>cbState</I> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pState</I>
 </DT><DD>[in] State of the VCM codec.
</DD><DT><I>cbState</I>
 </DT><DD>[in] Size of the state.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Return value varies depending on the implementation within each driver.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This method calls the COM <B>ICSetState</B> macro, which notifies a video compression driver to set the state of the compressor.</BLOCKQUOTE>



<H1><A NAME="ShowDialog">IAMVfwCompressDialogs::ShowDialog</A><HR size=1></H1>
<A HREF="IAMVfwCompressDialogs.htm">IAMVfwCompressDialogs Interface</A>
<P> Displays the specified dialog box.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>ShowDialog</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>iDialog</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>hwnd</I> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>iDialog</I>
 </DT><DD>[in] Dialog box to display. This is a member of the <A HREF="../dtypes.htm#VfwCompressDialogs">VfwCompressDialogs</A> enumerated data type.
</DD><DT><I>hwnd</I>
 </DT><DD>[in] Handle of the dialog box's parent window.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This method returns an error when asked to display a dialog box while the driver is streaming or displaying another dialog box. While the driver displays the dialog box you can't stream (pause or run) the filter.

<P><B>IAMVfwCompressDialogs::ShowDialog</B> calls the Video for Windows video compression manager (VCM) functions <A HREF="../../appendixes/Further_Reading.htm#ICConfigure">ICConfigure</A>, <A HREF="../../appendixes/Further_Reading.htm#ICAbout">ICAbout</A>, <B>ICQueryConfigure</B>, and <B>ICQueryAbout</B> to display the appropriate dialog box or determine if one exists. 
<p>The VfwCompressDialog_QueryConfig and VfwCompressDialog_QueryAbout members of the <A HREF="../dtypes.htm#VfwCompressDialogs">VfwCompressDialogs</A> enumerated data type tell you whether or not the configure dialog or about dialog is available. If passed one of these flags, the filter will return S_OK if the dialog exists, and S_FALSE if it does not. If a dialog is available, you call <B>ShowDialog</B> with the value VfwCompressDialog_Config or VfwCompressDialog_About to bring up the dialog.</BLOCKQUOTE>


 
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
