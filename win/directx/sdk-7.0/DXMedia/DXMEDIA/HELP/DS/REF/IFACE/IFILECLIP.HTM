<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IFileClip Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IFileClip Interface">
<META NAME="Description" CONTENT="IFileClip::CreateCut">
<META NAME="Description" CONTENT="IFileClip::GetMediaType">
<META NAME="Description" CONTENT="IFileClip::SetFileAndStream">
<META NAME="Description" CONTENT="CreateCut (IFileClip)">
<META NAME="Description" CONTENT="GetMediaType (IFileClip)">
<META NAME="Description" CONTENT="SetFileAndStream (IFileClip)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IFileClip"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IEnumRegFilters.htm">IEnumRegFilters Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IFileSinkFilter.htm">IFileSinkFilter Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IFileClip Interface</H1>
<P>The <B>IFileClip</B> interface provides a simple way for an application to create one or more cuts from a single media file, or to create blank cuts. Blank (empty or null) cuts are useful to either stop playback for a specified time, or to make a placeholder for a cut that the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#cutlist')">cutlist</A> can't play.

<P>See <A HREF="../../appdev/About_Cutlists.htm">About Cutlists</A> and <A HREF="../../appdev/Using_Cutlists.htm">Using Cutlists</A> for more information.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>

<P>Do not implement this interface. DirectShow implements it for you.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>

<P>Use this interface in your application when you want to provide cutlist functionality to the user.

<P>When compiling a cutlist application, you must explicitly include the cutlist header file as follows:
<PRE>#include &lt;cutlist.h&gt;</PRE>
<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>

<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Retrieves pointers to supported interfaces.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IFileClip methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IFileClip.htm#SetFileAndStream">SetFileAndStream</A>
 </TD><TD>Initializes the clip object with the specified media file and stream number or makes an empty clip for producing null elements.
 </TD></TR><TR><TD><A HREF="IFileClip.htm#CreateCut">CreateCut</A>
 </TD><TD>Creates a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#cutlist_element')">cutlist element</A>.
 </TD></TR><TR><TD><A HREF="IFileClip.htm#GetMediaType">GetMediaType</A>
 </TD><TD>Retrieves the clip's media type structure.
</TD></TR></TABLE>



<H1><A NAME="CreateCut">IFileClip::CreateCut</A><HR size=1></H1>
<A HREF="IFileClip.htm">IFileClip Interface</A>
<P>Creates a cutlist element.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>CreateCut</B><B>(</B><BR>&nbsp;&nbsp;<B>IAMCutListElement</B> <I>**ppElement</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>mtTrimIn</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>mtTrimOut</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>mtOrigin</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>mtLength</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>mtOffset</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppElement</I>
 </DT><DD>[out] Address of a pointer to the <A HREF="IAMCutListElement.htm">IAMCutListElement</A> interface of the created cutlist element.
</DD><DT><I>mtTrimIn</I>
 </DT><DD>[in] <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#trimin')">Trimin</A> (beginning) position for the cut.
</DD><DT><I>mtTrimOut</I>
 </DT><DD>[in] <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#trimout')">Trimout</A> (ending) position for the cut.
</DD><DT><I>mtOrigin</I>
 </DT><DD>[in] Clip origin. Must be zero.
</DD><DT><I>mtLength</I>
 </DT><DD>[in] Length of clip. Must be <I>mtTrimOut</I> minus <I>mtTrimIn</I>.
</DD><DT><I>mtOffset</I>
 </DT><DD>[in] Offset of clip. Must be zero.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. <B>HRESULT</B> can include one of the following standard constants, or other values not listed. 

<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Argument is invalid.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method is not supported.
</TD></TR><TR><TD>E_OUTOFMEMORY </TD><TD>Could not allocate required memory.
</TD></TR><TR><TD>S_OK </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>All of the times specified in this method are relative to the media clip rather than to the cutlist. 

<P>To make an empty cut, first create an empty (null) clip by calling the <A HREF="IFileClip.htm#SetFileAndStream">IFileClip::SetFileAndStream</A> method as illustrated by the following code fragment. Then, create a cut of the desired duration (<I>n</I>) to indicate you want to do nothing for <I>n</I> units of time.

<PRE>
IAMCutListElement *pElement;

SetFileAndStream(NULL, -1);
CreteCut(&amp;pElement, 0, n, 0, n, 0);
</PRE>
<P>See <A HREF="../../appdev/Using_Cutlists.htm">Using Cutlists</A> for more information about using cutlists and the cutlist interfaces from an application.
</BLOCKQUOTE>


<H1><A NAME="GetMediaType">IFileClip::GetMediaType</A><HR size=1></H1>
<A HREF="IFileClip.htm">IFileClip Interface</A>
<P>Retrieves the clip's media type structure.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetMediaType</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_MEDIA_TYPE</B> <I>*pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pmt</I>
 </DT><DD>[out] Pointer to the <A HREF="../structs.htm#AM_MEDIA_TYPE">AM_MEDIA_TYPE</A> structure describing the video clip.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. <B>HRESULT</B> can include one of the following standard constants, or other values not listed. 

<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Argument is invalid.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method is not supported.
</TD></TR><TR><TD>E_OUTOFMEMORY </TD><TD>Could not allocate required memory.
</TD></TR><TR><TD>S_OK </TD><TD>Success.
</TD></TR></TABLE>

</BLOCKQUOTE>


<H1><A NAME="SetFileAndStream">IFileClip::SetFileAndStream</A><HR size=1></H1>
<A HREF="IFileClip.htm">IFileClip Interface</A>
<P>Initializes the clip object with the specified media file and stream number or makes an empty clip for producing null elements.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetFileAndStream</B><B>(</B><BR>&nbsp;&nbsp;<B>LPWSTR</B> <I>wstrFileName</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>streamNum</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>wstrFileName</I>
 </DT><DD>[in] Name of the file from which to initialize the clip. Must be an AVI or .wav file. Specify NULL to make an empty (null) clip.
</DD><DT><I>streamNum</I>
 </DT><DD>[in] Stream number (AVI files only) within the specified file from which to initialize the clip. Must be zero. AVI files with more than one stream of any type are not supported; clips must be from the first stream (stream 0). Specify &#150;1 for empty elements.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. <B>HRESULT</B> can include one of the following standard constants, or other values not listed. 

<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Argument is invalid.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method is not supported.
</TD></TR><TR><TD>E_OUTOFMEMORY </TD><TD>Could not allocate required memory.
</TD></TR><TR><TD>S_OK </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method opens the file to verify the format and media type (which you can find by using the <A HREF="IFileClip.htm#GetMediaType">IFileClip::GetMediaType</A> method).

<P>Use the following call to make an empty clip.
<PRE>
SetFileAndStream(NULL, -1);
</PRE>
</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
