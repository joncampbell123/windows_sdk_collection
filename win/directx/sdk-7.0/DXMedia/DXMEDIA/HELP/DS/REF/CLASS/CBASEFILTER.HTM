<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CBaseFilter Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CBaseFilter Class">
<META NAME="Description" CONTENT="CBaseFilter (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::CBaseFilter">
<META NAME="Description" CONTENT="EnumPins (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::EnumPins">
<META NAME="Description" CONTENT="FindPin (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::FindPin">
<META NAME="Description" CONTENT="GetClassID (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::GetClassID">
<META NAME="Description" CONTENT="GetFilterGraph (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::GetFilterGraph">
<META NAME="Description" CONTENT="GetPin (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::GetPin">
<META NAME="Description" CONTENT="GetPinCount (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::GetPinCount">
<META NAME="Description" CONTENT="GetPinVersion (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::GetPinVersion">
<META NAME="Description" CONTENT="GetSetupData (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::GetSetupData">
<META NAME="Description" CONTENT="GetState (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::GetState">
<META NAME="Description" CONTENT="GetSyncSource (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::GetSyncSource">
<META NAME="Description" CONTENT="IncrementPinVersion (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::IncrementPinVersion">
<META NAME="Description" CONTENT="IsActive (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::IsActive">
<META NAME="Description" CONTENT="JoinFilterGraph (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::JoinFilterGraph">
<META NAME="Description" CONTENT="NonDelegatingQueryInterface (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::NonDelegatingQueryInterface">
<META NAME="Description" CONTENT="NotifyEvent (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::NotifyEvent">
<META NAME="Description" CONTENT="Pause (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::Pause">
<META NAME="Description" CONTENT="QueryFilterInfo (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::QueryFilterInfo">
<META NAME="Description" CONTENT="QueryVendorInfo (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::QueryVendorInfo">
<META NAME="Description" CONTENT="ReconnectPin (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::ReconnectPin">
<META NAME="Description" CONTENT="Register (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::Register">
<META NAME="Description" CONTENT="Run (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::Run">
<META NAME="Description" CONTENT="SetSyncSource (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::SetSyncSource">
<META NAME="Description" CONTENT="Stop (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::Stop">
<META NAME="Description" CONTENT="StreamTime (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::StreamTime">
<META NAME="Description" CONTENT="Unregister (CBaseFilter)">
<META NAME="Description" CONTENT="CBaseFilter::Unregister">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CBaseFilter"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CBaseDispatch.htm">CBaseDispatch Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CBaseInputPin.htm">CBaseInputPin Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CBaseFilter Class</H1>

<P><IMG SRC="../../art/filter01.gif" WIDTH="275" HEIGHT="197" ALT="CBaseFilter class hierarchy">

<P><B>CBaseFilter</B> is an abstract base class from which all <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> are derived. It supports
the Component Object Model (COM) <A HREF="../iface/IBaseFilter.htm">IBaseFilter</A> interface and is derived from the <A HREF="CUnknown.htm">CUnknown</A> class. This class supports the enumeration of pins by calling the pure virtual member functions <A HREF="CBaseFilter.htm#GetPin">CBaseFilter::GetPin</A> and <A HREF="CBaseFilter.htm#GetPinCount">GetPinCount</A>. These member functions must be overridden by any derived class.

<P>The <B>CBaseFilter</B> class assumes that all the filter's pins are derived from the <A HREF="CBasePin.htm">CBasePin</A>
class. <A HREF="CBaseFilter.htm#GetPin">CBaseFilter::GetPin</A> must return a pointer to <B>CBasePin</B>.

<P>All member functions in this class that return <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> and accept a pointer as a 
parameter return E_POINTER when passed a null pointer. 

<A NAME="Protected_Data_Membe"></A><P CLASS="ref">Protected Data Members</P>
<TABLE><TR><TD><B><A NAME="CBaseFilter::m_clsid">m_clsid</A></B>
 </TD><TD>Class identifier (CLSID) used for serialization using <A HREF="../../appendixes/Further_Reading.htm#IPersist">IPersist</A>.
</TD></TR><TR><TD><B><A NAME="CBaseFilter::m_pClock">m_pClock</A></B>
 </TD><TD><A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">Filter graph's</A> <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_clock')">reference clock</A>.
</TD></TR><TR><TD><B><A NAME="CBaseFilter::m_pGraph">m_pGraph</A></B>
 </TD><TD>Pointer to a graph to which this filter belongs.
</TD></TR><TR><TD><B><A NAME="CBaseFilter::m_PinVersion">m_PinVersion</A></B>
 </TD><TD>Current version of the pins used on the filter.
</TD></TR><TR><TD><B><A NAME="CBaseFilter::m_pLock">m_pLock</A></B>
 </TD><TD>Pointer to the critical section used for locking.
</TD></TR><TR><TD><B><A NAME="CBaseFilter::m_pName">m_pName</A></B>
 </TD><TD>Filter name.
</TD></TR><TR><TD><B><A NAME="CBaseFilter::m_pSink">m_pSink</A></B>
 </TD><TD>Pointer to the <A HREF="../iface/IMediaEventSink.htm">IMediaEventSink</A> interface on the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A>.
</TD></TR><TR><TD><B><A NAME="CBaseFilter::m_State">m_State</A></B>
 </TD><TD>Current state: running or paused.
</TD></TR><TR><TD><B><A NAME="CBaseFilter::m_tStart">m_tStart</A></B>
 </TD><TD>Offset from the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#stream_time')">stream time</A> to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_time')">reference time</A>.
</TD></TR></TABLE>
<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>

<TABLE><TR><TD><A HREF="CBaseFilter.htm#CBaseFilter_CBaseFilter">CBaseFilter</A>
 </TD><TD>Constructs a <A HREF="CBaseFilter.htm">CBaseFilter</A> object.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#GetFilterGraph">GetFilterGraph</A>
 </TD><TD>Returns the filter graph associated with the filter. This is used in the implementation of <A HREF="CEnumPins.htm">CEnumPins</A>.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#IncrementPinVersion">IncrementPinVersion</A>
 </TD><TD>Adds 1 to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> version stored in <A HREF="CBaseFilter.htm#CBaseFilter::m_PinVersion">m_PinVersion</A>.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#IsActive">IsActive</A>
 </TD><TD>Determines if the filter is currently active (running or paused) or stopped.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#NotifyEvent">NotifyEvent</A>
 </TD><TD>Sends an <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_E.htm#event_notification')">event notification</A> to the filter graph.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#ReconnectPin">ReconnectPin</A>
 </TD><TD>Requests pin for a reconnect.
</TD></TR></TABLE>
<A NAME="Overridable_Member_F"></A><P CLASS="ref">Overridable Member Functions</P>

<TABLE><TR><TD><A HREF="CBaseFilter.htm#GetPin">GetPin</A>
 </TD><TD>Returns a pointer to the requested pin.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#GetPinCount">GetPinCount</A>
 </TD><TD>Returns the number of pins currently available on this object.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#GetPinVersion">GetPinVersion</A>
 </TD><TD>Returns the current version of the base filter for comparison with the version with 
which the pin was initialized. This member function can be overridden if pins 
are being created dynamically. 
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#GetSetupData">GetSetupData</A>
 </TD><TD>Retrieves the registration data associated with the filter.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#StreamTime">StreamTime</A>
 </TD><TD>Returns the current stream time.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_IPersist">Implemented IPersist Methods</A></P>
<TABLE><TR><TD><A HREF="CBaseFilter.htm#GetClassID">GetClassID</A>
 </TD><TD>Returns the class identifier of this filter.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_IMediaFi">Implemented IMediaFilter Methods</A></P>
<TABLE><TR><TD><A HREF="CBaseFilter.htm#GetState">GetState</A>
 </TD><TD>Retrieves the current state of the filter.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#GetSyncSource">GetSyncSource</A>
 </TD><TD>Retrieves the current reference clock in use by this filter.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#Pause">Pause</A>
 </TD><TD>Instructs the filter to transition to State_Paused state.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#Run">Run</A>
 </TD><TD>Instructs the filter to transition to State_Running state.
Passes a time value to synchronize independent streams.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#SetSyncSource">SetSyncSource</A>
 </TD><TD>Informs the filter of the reference clock with which it should synchronize activity.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#Stop">Stop</A>
 </TD><TD>Instructs the filter to transition to the State_Stopped state.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_IBaseFil"></A>Implemented IBaseFilter Methods</P>
<TABLE><TR><TD><A HREF="CBaseFilter.htm#EnumPins">EnumPins</A>
 </TD><TD>Provides an enumerator for this pin's preferred media types (implemented by this class).
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#FindPin">FindPin</A>
 </TD><TD>Retrieves the pin with the specified identifier.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#JoinFilterGraph">JoinFilterGraph</A>
 </TD><TD>Notifies a filter that it has joined a filter graph (implemented by this class).
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#QueryFilterInfo">QueryFilterInfo</A>
 </TD><TD>Gets information about the specified filter (implemented by this class).
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#QueryVendorInfo">QueryVendorInfo</A>
 </TD><TD>Retrieves optional information supplied by a vendor for the specified filter. 
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_IAMovieS"></A>Implemented IAMovieSetup Methods</P>
<TABLE><TR><TD><A HREF="CBaseFilter.htm#Register">Register</A>
 </TD><TD>Adds the filter to the registry.
</TD></TR><TR><TD><A HREF="CBaseFilter.htm#Unregister">Unregister</A>
 </TD><TD>Removes the filter from the registry.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_INonDele"></A>Implemented INonDelegatingUnknown Methods</P>
<TABLE><TR><TD><A HREF="CBaseFilter.htm#NonDelegatingQueryInterface">NonDelegatingQueryInterface</A>
</TD><TD>Passes out pointers to any interfaces added to the derived filter class.
</TD></TR></TABLE>



<H1><A NAME="CBaseFilter_CBaseFilter">CBaseFilter::CBaseFilter</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Constructs a <A HREF="CBaseFilter.htm">CBaseFilter</A> object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CBaseFilter</B><B>(</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>CCritSec</B> <I>*pLock</I><B>,</B><BR>&nbsp;&nbsp;<B>REFCLSID</B> <I>clsid</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pName</I>
</DT><DD>Pointer to an object description.
</DD><DT><I>pUnk</I>
</DT><DD><A HREF="../iface/IUnknown.htm">IUnknown</A> interface of the delegating object.
</DD><DT><I>pLock</I>
</DT><DD>Pointer to an object that maintains the lock.
</DD><DT><I>clsid</I>
</DT><DD>Class identifier to be used to serialize this filter.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>


<H1><A NAME="EnumPins">CBaseFilter::EnumPins</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves an <A HREF="../iface/IEnumPins.htm">IEnumPins</A> pointer that can be used to enumerate 
all the pins available on this filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>EnumPins</B><B>(</B><BR>&nbsp;&nbsp;<B>IEnumPins</B> <B>**</B> <I>ppEnum</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppEnum</I>
</DT><DD>Pointer to the <A HREF="../iface/IEnumPins.htm">IEnumPins</A> interface to retrieve.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_OUTOFMEMORY if a new enumerate could not be created or NOERROR if successful.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBaseFilter.htm#EnumPins">IBaseFilter::EnumPins</A> method.
It uses the <A HREF="CEnumPins.htm">CEnumPins</A> object to construct an enumerator and retrieves
the <A HREF="../iface/IEnumPins.htm">IEnumPins</A> interface from the <B>CEnumPins</B> object. The
implementation of <A HREF="CEnumPins.htm#Next">CEnumPins::Next</A> calls the <A HREF="CBaseFilter.htm#GetPin">CBaseFilter::GetPin</A>
member function, which the derived class must provide. The <B>IEnumPins</B>
interface is used by the filter graph manager when adding the filter to the filter graph.
</BLOCKQUOTE>


<H1><A NAME="FindPin">CBaseFilter::FindPin</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves the pin with the specified identifier.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>FindPin</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>Id</I><B>,</B><BR>&nbsp;&nbsp;<B>IPin</B> <I>**ppPin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>Id</I>
</DT><DD>Identifier of the pin.
</DD><DT><I>ppPin</I>
</DT><DD>Pointer to the <A HREF="../iface/IPin.htm">IPin</A> interface for this pin after the filter has been restored.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>The default implementation by this member function returns S_OK if the pin name
was found or <A HREF="../Error_Success_Codes.htm#VFW_E_NOT_FOUND">VFW_E_NOT_FOUND</A> otherwise. 

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function provides a base class definition of the <A HREF="../iface/IBaseFilter.htm#FindPin">IBaseFilter::FindPin</A>
method that, along with the <A HREF="../iface/IPin.htm#QueryId">IPin::QueryId</A> method, is used to implement
persistent filter graphs. A filter must be able to translate the <A HREF="../iface/IPin.htm">IPin</A>
interface pointers to its pins into identifiers that can be saved along
with the configuration of the filter graph. It does this by using the <B>IPin::QueryId</B>
method. It must then be able to convert those identifiers back into <B>IPin</B> interface
pointers when the filter and its connections are restored as part of a persistent
filter graph. This is accomplished using the <B>IBaseFilter::FindPin</B> method.

<P>By default, the base classes use the
pin name in the <A HREF="CBasePin.htm#CBasePin::m_pName">CBasePin::m_pName</A> data member, so implementing this member
function in your derived filter class is not normally required.

<P>The <I>ppPin</I> parameter is set to NULL if the identifier cannot be matched.
</BLOCKQUOTE>


<H1><A NAME="GetClassID">CBaseFilter::GetClassID</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Fills the <I>pClsID</I> parameter with the class identifier of this filter
(from <A HREF="CBaseFilter.htm#CBaseFilter::m_clsid">m_clsid</A>).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetClassID</B><B>(</B><BR>&nbsp;&nbsp;<B>CLSID</B> <I>*pClsID</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pClsID</I>
</DT><DD>Pointer to the class identifier to be filled out.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Return NOERROR.

</BLOCKQUOTE>


<H1><A NAME="GetFilterGraph">CBaseFilter::GetFilterGraph</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves the filter graph associated with the filter.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>IFilterGraph</B> <B>*GetFilterGraph</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the value of <A HREF="CBaseFilter.htm#CBaseFilter::m_pGraph">m_pGraph</A>.

</BLOCKQUOTE>


<H1><A NAME="GetPin">CBaseFilter::GetPin</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves a <A HREF="CBasePin.htm">CBasePin</A> object on the filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>CBasePin</B> <B>*GetPin</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>n</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>n</I>
</DT><DD>Number of the specified pin.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a pointer to the pin specified by the <I>n</I> parameter.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Override this member function to return a pointer to the <I>n</I>th pin on this filter.
<A HREF="CBaseFilter.htm">CBaseFilter</A> adds a reference to it, when necessary, before passing it to
any other object. This member function is called by the base class <A HREF="CEnumPins.htm#Next">CEnumPins::Next</A>
member function to retrieve pins for the <A HREF="../iface/IEnumPins.htm">IEnumPins</A> interface, which is used by the filter
graph manager.
</BLOCKQUOTE>


<H1><A NAME="GetPinCount">CBaseFilter::GetPinCount</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves the number of supported pins.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>int</B> <B>GetPinCount</B><B>(</B> <B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the pin count.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Override this member function to return the count of pins currently available on this object.
</BLOCKQUOTE>


<H1><A NAME="GetPinVersion">CBaseFilter::GetPinVersion</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves the version number of the pin.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>long</B> <B>GetPinVersion</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>By default, returns the value of <A HREF="CBaseFilter.htm#CBaseFilter::m_PinVersion">m_PinVersion</A>. If overridden, this member function 
should return the pin version number.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Returns the current version of the filter that matches the version used to 
initialize the pin. The enumerator calling this member function performs the matching.

<P>A filter provides an enumerator to gain access to the input and <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pins</A> it keeps. 
Each time a pin enumerator's method is called, the pin enumerator
calls the <B>CBaseFilter::GetPinVersion</B> member function to ensure that the base filter's 
version matches the version with which the pin enumerator was initialized.

<P>A filter class can override <B>CBaseFilter::GetPinVersion</B>
if there is a need to increment the version by changing the available pins
dynamically. Or, it can more easily call 
<A HREF="CBaseFilter.htm#IncrementPinVersion">IncrementPinVersion</A>.

<P><B>GetPinVersion</B> does not lock the filter because the enumerators
are designed to be separate objects. The derived class's
<B>GetPinVersion</B> will likely have to do some specialized locking with the
part of the object responsible for creating and deleting pins.
</BLOCKQUOTE>


<H1><A NAME="GetSetupData">CBaseFilter::GetSetupData</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves the registration data associated with the filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>LPAMOVIESETUP_FILTER</B> <B>GetSetupData</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a pointer to an <A HREF="../structs.htm#AMOVIESETUP_FILTER">AMOVIESETUP_FILTER</A> structure containing registration information for the filter.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>You must override this member function and implement it to return an <A HREF="../structs.htm#AMOVIESETUP_FILTER">AMOVIESETUP_FILTER</A> structure containing its associated 
<A HREF="../structs.htm#AMOVIESETUP_PIN">AMOVIESETUP_PIN</A> and <A HREF="../structs.htm#AMOVIESETUP_MEDIATYPE">AMOVIESETUP_MEDIATYPE</A> structures for pin and media type information. This member function is called from
the <A HREF="CBaseFilter.htm#Register">CBaseFilter::Register</A> member function.
</BLOCKQUOTE>


<H1><A NAME="GetState">CBaseFilter::GetState</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves the current state of the filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetState</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwMilliSecsTimeout</I><B>,</B><BR>&nbsp;&nbsp;<B>FILTER_STATE</B> <B>*</B> <I>State</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwMilliSecsTimeout</I>
</DT><DD>Duration of the time-out, in milliseconds. 
</DD><DT><I>State</I>
</DT><DD>Returned state of the filter.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK. 

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IMediaFilter.htm#GetState">IMediaFilter::GetState</A> method. 
It returns the value of the <A HREF="CBaseFilter.htm#CBaseFilter::m_State">m_State</A> data member. Override this member function if the 
state changes in your filter are not synchronous. 
</BLOCKQUOTE>


<H1><A NAME="GetSyncSource">CBaseFilter::GetSyncSource</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves the current reference clock in use by this filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetSyncSource</B><B>(</B><BR>&nbsp;&nbsp;<B>IReferenceClock</B> <B>**</B> <I>pClock</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pClock</I>
</DT><DD>Pointer to a reference clock; will be set to the <A HREF="../iface/IReferenceClock.htm">IReferenceClock</A> interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IMediaFilter.htm#GetSyncSource">IMediaFilter::GetSyncSource</A> method. 
It returns the value of <A HREF="CBaseFilter.htm#CBaseFilter::m_pClock">m_pClock</A> after adding a reference to it. 
Be sure to release the interface by calling the <A HREF="../iface/IUnknown.htm#Release">IUnknown::Release</A> method 
when finished with the pointer.
</BLOCKQUOTE>


<H1><A NAME="IncrementPinVersion">CBaseFilter::IncrementPinVersion</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Adds 1 to the version number of the pin.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>void</B> <B>IncrementPinVersion</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>By default, increments the value of <A HREF="CBaseFilter.htm#CBaseFilter::m_PinVersion">m_PinVersion</A>. 

</BLOCKQUOTE>


<H1><A NAME="IsActive">CBaseFilter::IsActive</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Determines if the filter is currently active (running or paused) or stopped.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>BOOL</B> <B>IsActive</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns TRUE if the filter is paused or running, or FALSE if the filter is stopped.

</BLOCKQUOTE>


<H1><A NAME="JoinFilterGraph">CBaseFilter::JoinFilterGraph</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Notifies a filter that it has joined a filter graph.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>JoinFilterGraph</B><B>(</B><BR>&nbsp;&nbsp;<B>IFilterGraph</B> <B>*</B> <I>pGraph</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pName</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pGraph</I>
</DT><DD>Pointer to the filter graph to join.
</DD><DT><I>pName</I>
</DT><DD>[in, string] Name of the filter being added.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBaseFilter.htm#JoinFilterGraph">IBaseFilter::JoinFilterGraph</A> method. It assigns the <I>pGraph</I> filter graph pointer to the <A HREF="CBaseFilter.htm#CBaseFilter::m_pGraph">m_pGraph</A> data member and obtains the <A HREF="../iface/IMediaEventSink.htm">IMediaEventSink</A> interface from the filter graph manager to allow the filter to post event notifications to the filter graph manager.

<P>The filter should store the <A HREF="../iface/IMediaEventSink.htm">IMediaEventSink</A> interface for later use, because it might need to notify the interface about events, but it should
not increase the reference count on the filter graph manager object. A null pointer indicates that the filter is no longer part of a graph.
</BLOCKQUOTE>


<H1><A NAME="NonDelegatingQueryInterface">CBaseFilter::NonDelegatingQueryInterface</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves an interface and increments the reference count.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>NonDelegatingQueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <B>**</B> <I>ppv</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>riid</I>
 </DT><DD>Reference identifier.
</DD><DT><I>ppv</I>
 </DT><DD>Pointer to the interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_POINTER if <I>ppv</I> is invalid. Returns NOERROR if the query is successful or E_NOINTERFACE if it is not. 

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the 
<A HREF="../utilfunct/INonDelegatingUnknown_iface.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingQueryInterface</A> method and passes out 
references to the <A HREF="../iface/IBaseFilter.htm">IBaseFilter</A>, <A HREF="../iface/IMediaFilter.htm">IMediaFilter</A>, <A HREF="../../appendixes/Further_Reading.htm#IPersist">IPersist</A>, 
<A HREF="../iface/IAMovieSetup.htm">IAMovieSetup</A>, and <A HREF="../iface/IUnknown.htm">IUnknown</A> interfaces. 
Override this class to return other interfaces on the object in the derived class.
</BLOCKQUOTE>


<H1><A NAME="NotifyEvent">CBaseFilter::NotifyEvent</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Sends an event notification to the filter graph.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>NotifyEvent</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>EventCode</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>EventParam1</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>EventParam2</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>EventCode</I>
 </DT><DD>Identifier of the event.
</DD><DT><I>EventParam1</I>
 </DT><DD>First parameter of the event.
</DD><DT><I>EventParam2</I>
 </DT><DD>Second parameter of the event.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if delivered, S_FALSE if the filter graph does not sink
events, or an error otherwise.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>For a list of notification codes and event parameter values, see 
<A HREF="../Event_Notification_Codes.htm#Events">Event Notification Codes</A>.
</BLOCKQUOTE>


<H1><A NAME="Pause">CBaseFilter::Pause</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Transitions the filter to State_Paused state if it is not in this state already. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Pause</B> <B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. 


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IMediaFilter.htm#Pause">IMediaFilter::Pause</A> method. If the filter is in 
State_Stopped state, the <A HREF="CBasePin.htm#Active">CBasePin::Active</A> member function is called for each of the 
filter's pins to which 
it is connected. If this member function succeeds, the filter's <A HREF="CBaseFilter.htm#CBaseFilter::m_State">m_State</A> member variable
is set to State_Paused. If any pin returns a failure return value from its <A HREF="CBasePin.htm#Active">Active</A> method, 
the function fails and the state is not changed. 

<P>This member function holds the filter's lock.
</BLOCKQUOTE>


<H1><A NAME="QueryFilterInfo">CBaseFilter::QueryFilterInfo</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves information about the filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryFilterInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>FILTER_INFO</B> <B>*</B> <I>pInfo</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pInfo</I>
</DT><DD>Pointer to a <A HREF="../structs.htm#FILTER_INFO">FILTER_INFO</A> structure to fill in.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBaseFilter.htm#QueryFilterInfo">IBaseFilter::QueryFilterInfo</A> method.
It copies the filter's name from <A HREF="CBaseFilter.htm#CBaseFilter::m_pName">m_pName</A>, and copies 
the pointer to the filter
graph interface from <A HREF="CBaseFilter.htm#CBaseFilter::m_pGraph">m_pGraph</A> into the <A HREF="../structs.htm#FILTER_INFO">FILTER_INFO</A> structure before
returning.

<P>Note that the <A HREF="../iface/IFilterGraph.htm">IFilterGraph</A> interface passed out by this member function
is reference counted, and so must be released when the caller has finished 
with it. 

</BLOCKQUOTE>


<H1><A NAME="QueryVendorInfo">CBaseFilter::QueryVendorInfo</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves a vendor information string.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryVendorInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>LPWSTR</B> <B>*</B> <I>pVendorInfo</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pVendorInfo</I>
</DT><DD>Pointer to a string containing vendor information.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value (E_NOTIMPL by default).

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBaseFilter.htm#QueryVendorInfo">IBaseFilter::QueryVendorInfo</A> method,
but only to return E_NOTIMPL. Filters that want to expose vendor information must 
override this member function. If implemented in a derived class, callers should free memory 
when they are done using it by calling the Microsoft&#174; Win32&#174; <A HREF="../../appendixes/Further_Reading.htm#CoTaskMemFree">CoTaskMemFree</A> function.
</BLOCKQUOTE>


<H1><A NAME="ReconnectPin">CBaseFilter::ReconnectPin</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Requests pin for a reconnect.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>ReconnectPin</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <I>*pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>AM_MEDIA_TYPE</B> <B>const</B> <I>*pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
</DT><DD>Pointer to the pin to reconnect.
</DD><DT><I>pmt</I>
</DT><DD><A HREF="../structs.htm#AM_MEDIA_TYPE">AM_MEDIA_TYPE</A> media type to reconnect with. This can be NULL.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This function calls the <A HREF="../iface/IFilterGraph2.htm#ReconnectEx">IFilterGraph2::ReconnectEx</A> method on the filter graph.
</BLOCKQUOTE>


<H1><A NAME="Register">CBaseFilter::Register</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Adds the filter to the registry.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Register</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IAMovieSetup.htm#Register">IAMovieSetup::Register</A> method and registers the filter, its pins, and the media type associated with the pins. 
It does this by first calling <A HREF="CBaseFilter.htm#GetSetupData">GetSetupData</A> to retrieve the setup data, and then calling the <A HREF="../iface/IFilterMapper.htm#RegisterFilter">IFilterMapper::RegisterFilter</A>, <A HREF="../iface/IFilterMapper.htm#RegisterPin">IFilterMapper::RegisterPin</A>, and <A HREF="../iface/IFilterMapper.htm#UnregisterPin">IFilterMapper::RegisterPinType</A> methods. 
</BLOCKQUOTE>


<H1><A NAME="Run">CBaseFilter::Run</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Transitions the filter from paused to running state if it is not in this state already. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Run</B> <B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStart</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>tStart</I>
 </DT><DD>Reference time value corresponding to stream time 0.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. The default implementation returns
NOERROR.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If the filter is in State_Stopped state, the <A HREF="CBaseFilter.htm#Pause">CBaseFilter::Pause</A> method is called first 
to transition the filter to State_Paused state, which has the effect of activating any of the filter's 
connected pins. If any pin returns a failure return code from its <A HREF="CBasePin.htm#Active">Active</A> method, the 
function fails and the state is not changed. 
If this member function succeeds, the filter's <A HREF="CBaseFilter.htm#CBaseFilter::m_State">m_State</A> member variable
is set to State_Running. 

<P>This member function holds the filter's lock.
</BLOCKQUOTE>


<H1><A NAME="SetSyncSource">CBaseFilter::SetSyncSource</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Identifies the reference clock to which the filter should synchronize activity.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetSyncSource</B> <B>(</B><BR>&nbsp;&nbsp;<B>IReferenceClock</B> <B>*</B> <I>pClock</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pClock</I>
</DT><DD>Pointer to the <A HREF="../iface/IReferenceClock.htm">IReferenceClock</A> interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. The default implementation returns
NOERROR.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IMediaFilter.htm#SetSyncSource">IMediaFilter::SetSyncSource</A> method.
It sets the <A HREF="CBaseFilter.htm#CBaseFilter::m_pClock">m_pClock</A> data member to the <I>pClock</I> parameter and increments the
reference count on the <A HREF="../iface/IReferenceClock.htm">IReferenceClock</A> interface passed in. 

<P>This member function is most important to rendering filters and might not apply to other filters.
</BLOCKQUOTE>


<H1><A NAME="Stop">CBaseFilter::Stop</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Transitions the filter to State_Stopped state if it is not in this state already.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Stop</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IMediaFilter.htm#Stop">IMediaFilter::Stop</A> method.
It first calls the <A HREF="CBasePin.htm#Inactive">CBasePin::Inactive</A> member function on all its pins that have a 
connection, and then sets the filter's <A HREF="CBaseFilter.htm#CBaseFilter::m_State">m_State</A> member variable to State_Stopped.

<P>This member function holds the filter's lock.
</BLOCKQUOTE>


<H1><A NAME="StreamTime">CBaseFilter::StreamTime</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Retrieves the current stream time.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>StreamTime</B><B>(</B><BR>&nbsp;&nbsp;<B>CRefTime&amp;</B> <I>rtStream</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rtStream</I>
</DT><DD>Current stream time.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value, which can include the following values.
<TABLE>
<TR><TD>E_FAIL
 </TD><TD>Unable to get time from clock.
</TD></TR><TR><TD>S_OK
 </TD><TD>Stream time returned in the <I>rtStream</I> parameter.
</TD></TR><TR><TD><A HREF="../Error_Success_Codes.htm#VFW_E_NO_CLOCK">VFW_E_NO_CLOCK</A>
 </TD><TD>No reference clock is available.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Current stream time is the reference clock time minus the stream time offset.
All samples with <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#time_stamp')">time stamps</A> less than or equal to this time should have been presented.
</BLOCKQUOTE>


<H1><A NAME="Unregister">CBaseFilter::Unregister</A><HR size=1></H1>
<A HREF="CBaseFilter.htm">CBaseFilter Class</A>
<P>Removes the filter from the registry.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Unregister</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IAMovieSetup.htm#Unregister">IAMovieSetup::Unregister</A> method and 
calls the <A HREF="../iface/IFilterMapper.htm#UnregisterFilter">IFilterMapper::UnregisterFilter</A> method to remove the filter from the registry.
This effectively removes the pins and media types as well. 

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
