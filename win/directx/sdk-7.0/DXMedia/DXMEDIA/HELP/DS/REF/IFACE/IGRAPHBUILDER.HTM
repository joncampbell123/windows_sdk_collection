<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IGraphBuilder Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IGraphBuilder Interface">
<META NAME="Description" CONTENT="IGraphBuilder::AddSourceFilter">
<META NAME="Description" CONTENT="IGraphBuilder::Connect">
<META NAME="Description" CONTENT="IGraphBuilder::Render">
<META NAME="Description" CONTENT="IGraphBuilder::RenderFile">
<META NAME="Description" CONTENT="IGraphBuilder::SetLogFile">
<META NAME="Description" CONTENT="AddSourceFilter (IGraphBuilder)">
<META NAME="Description" CONTENT="Connect (IGraphBuilder)">
<META NAME="Description" CONTENT="Render (IGraphBuilder)">
<META NAME="Description" CONTENT="RenderFile (IGraphBuilder)">
<META NAME="Description" CONTENT="SetLogFile (IGraphBuilder)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IGraphBuilder"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IFullScreenVideo.htm">IFullScreenVideo Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IGraphVersion.htm">IGraphVersion Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IGraphBuilder Interface</H1>

<P>The <B>IGraphBuilder</B> interface allows applications to call upon the filter
graph manager to attempt to build a complete <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A>, or parts of a filter graph given only partial information, such as the name of a file or the interfaces of two separate pins. The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> mapper looks up filters in the
registry to configure the filter graph in a meaningful way.

<P><B>IGraphBuilder</B> inherits from the <A HREF="IFilterGraph.htm">IFilterGraph</A> interface and
exposes all its <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">methods</A>. For this reason, <B>IFilterGraph</B> should normally
not be used directly.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>This interface is implemented on the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> and is not intended
for implementation by developers.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Applications use this interface to create a filter graph, add filters to
or remove filters from a filter graph, enumerate all the filters in a filter graph,
and force connections when adding a filter. Filters typically use the interface to
reconnect pins during the connection and negotiation process of building a filter graph.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IFilterGraph methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IFilterGraph.htm#AddFilter">AddFilter</A>
</TD><TD>Adds a filter to the graph and gives it a name.
</TD></TR><TR><TD><A HREF="IFilterGraph.htm#RemoveFilter">RemoveFilter</A>
</TD><TD>Removes a filter from the graph.
</TD></TR><TR><TD><A HREF="IFilterGraph.htm#EnumFilters">EnumFilters</A>
</TD><TD>Provides an enumerator for all filters in the graph.
</TD></TR><TR><TD><A HREF="IFilterGraph.htm#FindFilterByName">FindFilterByName</A>
</TD><TD>Finds a filter that was added with a specified name.
</TD></TR><TR><TD><A HREF="IFilterGraph.htm#ConnectDirect">ConnectDirect</A>
</TD><TD>Connects the two <A HREF="IPin.htm">IPin</A> objects directly (without intervening filters).
</TD></TR><TR><TD><A HREF="IFilterGraph.htm#Reconnect">Reconnect</A>
</TD><TD>Breaks the existing <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> connection and reconnects it to the same pin.
</TD></TR><TR><TD><A HREF="IFilterGraph.htm#Disconnect">Disconnect</A>
</TD><TD>Disconnects this pin, if connected.
</TD></TR><TR><TD><A HREF="IFilterGraph.htm#SetDefaultSyncSource">SetDefaultSyncSource</A>
</TD><TD>Sets the default synchronization source (a clock).
</TD></TR><TR></TR>
<TR><TH>IGraphBuilder methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IGraphBuilder.htm#Connect">Connect</A>
 </TD><TD>Connects two <A HREF="IPin.htm">IPin</A> objects. If they will not connect directly, this method
connects them with intervening transforms.
</TD></TR><TR><TD><A HREF="IGraphBuilder.htm#Render">Render</A>
 </TD><TD>Adds a chain of filters to this <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pin</A> to render it.
</TD></TR><TR><TD><A HREF="IGraphBuilder.htm#RenderFile">RenderFile</A>
 </TD><TD>Builds a filter graph that renders the specified file.
</TD></TR><TR><TD><A HREF="IGraphBuilder.htm#AddSourceFilter">AddSourceFilter</A>
 </TD><TD>Adds a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#source_filter')">source filter</A> to the filter graph for a specific file. The <A HREF="IGraphBuilder.htm#RenderFile">IGraphBuilder::RenderFile</A> method calls this to find the source filter.
</TD></TR><TR><TD><A HREF="IGraphBuilder.htm#SetLogFile">SetLogFile</A>
 </TD><TD>Sets the log file into which actions taken in attempting to perform an operation are logged.
</TD></TR></TABLE>



<H1><A NAME="AddSourceFilter">IGraphBuilder::AddSourceFilter</A><HR size=1></H1>
<A HREF="IGraphBuilder.htm">IGraphBuilder Interface</A>
<P>Adds a source filter to the filter graph for a specific file.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>AddSourceFilter</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpwstrFileName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpwstrFilterName</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter*</B> <B>*</B> <I>ppFilter</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpwstrFileName</I>
</DT><DD>[in] Pointer to the file.
</DD><DT><I>lpwstrFilterName</I>
</DT><DD>[in] Name to give the source filter when it is added.
</DD><DT><I>ppFilter</I>
</DT><DD>[out] Pointer to an <A HREF="IBaseFilter.htm">IBaseFilter</A> interface on the filter that was added.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method allows you to obtain and retain more control over building
the rest of the graph. For example, you can use the <A HREF="IFilterGraph.htm#AddFilter">IFilterGraph::AddFilter</A> method
to add a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> of your choice, and then use the <A HREF="IGraphBuilder.htm#Connect">IGraphBuilder::Connect</A> method
to connect the two filters. The <A HREF="IBaseFilter.htm">IBaseFilter</A> interface exposed by the source filter is returned
in the <I>ppFilter</I> parameter, and the reference is already added by the
<A HREF="IUnknown.htm#AddRef">IUnknown::AddRef</A> method. The <I>lpwstrFilterName</I> parameter is used to allow the
filter to be identified by this name in this filter graph. For more information, see <A HREF="IFilterGraph.htm#FindFilterByName">FindFilterByName</A>.

<P>It is the application's responsibility to find the output pin of the
added source filter in order to build the rest of the filter graph,
which can be done by calling <A HREF="IGraphBuilder.htm#Render">IGraphBuilder::Render</A> on the output pin,
to build the entire filter graph automatically, or by adding and connecting
filters individually. Note that, when adding filters individually, the asynchronous
file reader source filter and the URL <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#moniker')">moniker</A> source filter do not parse the data,
so the output pins of these source filters can be connected only to a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#parser_filter')">parser filter</A>,
such as the MPEG splitter filter.

<P>Note that the <A HREF="IGraphBuilder.htm#RenderFile">IGraphBuilder::RenderFile</A> method adds the same source filter.
</BLOCKQUOTE>


<H1><A NAME="Connect">IGraphBuilder::Connect</A><HR size=1></H1>
<A HREF="IGraphBuilder.htm">IGraphBuilder Interface</A>
<P>Connects the two pins, using intermediates if necessary.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Connect</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppinOut</I><B>,</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppinIn</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppinOut</I>
</DT><DD>[in] Output pin.
</DD><DT><I>ppinIn</I>
</DT><DD>[in] <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_I.htm#input_pin')">input pin</A>.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method connects these two pins directly or indirectly, using <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#transform_filter')">transform filters</A> if
necessary. The method either succeeds or leaves the filter graph unchanged.
The filter graph manager attempts a direct connection. If that fails, it attempts
to use any available transforms provided by filters that are already in the filter graph.
(It enumerates these in an arbitrary order.) If that fails, it attempts to find filters
from the registry to provide a transform. These will be tried in order of <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#merit')">merit</A>.
</BLOCKQUOTE>


<H1><A NAME="Render">IGraphBuilder::Render</A><HR size=1></H1>
<A HREF="IGraphBuilder.htm">IGraphBuilder Interface</A>
<P>Builds a filter graph that renders the data from this output pin.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Render</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppinOut</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppinOut</I>
</DT><DD>[in] Output pin.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value, which can include one of the following:
<UL>
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_AUDIO_NOT_REND">VFW_S_AUDIO_NOT_RENDERED</A>
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_DUPLICATE_NAME">VFW_S_DUPLICATE_NAME</A> 
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_PARTIAL_RENDER">VFW_S_PARTIAL_RENDER</A>
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_RPZA">VFW_S_RPZA</A>
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_VIDEO_NOT_REND">VFW_S_VIDEO_NOT_RENDERED</A>
</UL>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method connects this output pin directly or indirectly to a filter or filters
that will render it, using transform filters as intermediary filters if necessary.
Filters are tried in the same order as for the <A HREF="IGraphBuilder.htm#Connect">IGraphBuilder::Connect</A> method.
</BLOCKQUOTE>


<H1><A NAME="RenderFile">IGraphBuilder::RenderFile</A><HR size=1></H1>
<A HREF="IGraphBuilder.htm">IGraphBuilder Interface</A>
<P>Builds a filter graph that renders the specified file.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>RenderFile</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpwstrFile</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpwstrPlayList</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpwstrFile</I>
</DT><DD>[in] Name of the file containing the data to be rendered.
</DD><DT><I>lpwstrPlayList</I>
</DT><DD>[in] Playlist name. Reserved; must be NULL.
(This parameter is currently unimplemented.)
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value, which can include one of the following:
<UL>
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_AUDIO_NOT_REND">VFW_S_AUDIO_NOT_RENDERED</A>
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_DUPLICATE_NAME">VFW_S_DUPLICATE_NAME</A> 
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_PARTIAL_RENDER">VFW_S_PARTIAL_RENDER</A>
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_RPZA">VFW_S_RPZA</A>
<LI><A HREF="../Error_Success_Codes.htm#VFW_S_VIDEO_NOT_REND">VFW_S_VIDEO_NOT_RENDERED</A>
</UL>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>If the <I>lpwstrPlayList</I> parameter is NULL, this method would use the
default playlist, which typically renders the entire file.
</BLOCKQUOTE>


<H1><A NAME="SetLogFile">IGraphBuilder::SetLogFile</A><HR size=1></H1>
<A HREF="IGraphBuilder.htm">IGraphBuilder Interface</A>
<P>Sets the file into which actions taken in attempting to perform an operation are logged.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetLogFile</B><B>(</B><BR>&nbsp;&nbsp;<B>HANDLE</B> <I>hFile</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>hFile</I>
 </DT><DD>Handle to the log file.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>The <I>hFile</I> parameter must be an open file handle. After calling this method with a valid
file handle, actions taken by <A HREF="IGraphBuilder.htm">IGraphBuilder</A> methods when attempting to build a filter graph
are logged to this file. This is intended to help you determine the cause of any failure to automatically
 build a filter graph.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
