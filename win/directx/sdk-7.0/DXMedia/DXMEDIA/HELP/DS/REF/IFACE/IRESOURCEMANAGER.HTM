<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IResourceManager Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IResourceManager Interface">
<META NAME="Description" CONTENT="IResourceManager::CancelRequest">
<META NAME="Description" CONTENT="IResourceManager::NotifyAcquire">
<META NAME="Description" CONTENT="IResourceManager::NotifyRelease">
<META NAME="Description" CONTENT="IResourceManager::Register">
<META NAME="Description" CONTENT="IResourceManager::RegisterGroup">
<META NAME="Description" CONTENT="IResourceManager::ReleaseFocus">
<META NAME="Description" CONTENT="IResourceManager::RequestResource">
<META NAME="Description" CONTENT="IResourceManager::SetFocus">
<META NAME="Description" CONTENT="CancelRequest (IResourceManager)">
<META NAME="Description" CONTENT="NotifyAcquire (IResourceManager)">
<META NAME="Description" CONTENT="NotifyRelease (IResourceManager)">
<META NAME="Description" CONTENT="Register (IResourceManager)">
<META NAME="Description" CONTENT="RegisterGroup (IResourceManager)">
<META NAME="Description" CONTENT="ReleaseFocus (IResourceManager)">
<META NAME="Description" CONTENT="RequestResource (IResourceManager)">
<META NAME="Description" CONTENT="SetFocus (IResourceManager)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IResourceManager"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IResourceConsumer.htm">IResourceConsumer Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="ISeekingPassThru.htm">ISeekingPassThru Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IResourceManager Interface</H1>

<P>The <B>IResourceManager</B> interface implements a resource manager to
resolve contentions for named resources.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>Implement this interface on any object that performs the services of a resource manager.
The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> acts as a resource manager for Microsoft&#174; DirectShow&#153;
and delegates to any existing system-wide resource manager. The filter graph manager implements
the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">methods</A> on this interface.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Use this interface if your object requires resources that other objects are likely to use. The wave <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> uses this interface to resolve contentions
for the wave-output device to enable sound to follow focus.

<P>An object can use the resource manager supporting this interface
to resolve possible contention between existing resources. This is carried out by registering
the resource with the interface and then requesting it from this interface
whenever needed.

<P>Use this interface if your object detects user focus
changes that might affect resource usage. Notifying the resource manager
of a change of focus will cause the resource manager to switch contended
resources to the objects that have the focus of the user.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IResourceManager methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IResourceManager.htm#Register">Register</A>
</TD><TD>Registers a single named resource with the resource manager.
</TD></TR><TR><TD><A HREF="IResourceManager.htm#RegisterGroup">RegisterGroup</A>
</TD><TD>Registers a named resource group with the resource manager.
</TD></TR><TR><TD><A HREF="IResourceManager.htm#RequestResource">RequestResource</A>
</TD><TD>Requests the use of a given registered resource.
</TD></TR><TR><TD><A HREF="IResourceManager.htm#NotifyAcquire">NotifyAcquire</A>
</TD><TD>Notifies the resource manager that an attempt to acquire a resource has completed.
</TD></TR><TR><TD><A HREF="IResourceManager.htm#NotifyRelease">NotifyRelease</A>
</TD><TD>Notifies the resource manager that a resource consumer has released a resource.
</TD></TR><TR><TD><A HREF="IResourceManager.htm#CancelRequest">CancelRequest</A>
</TD><TD>Cancels the request for a resource.
</TD></TR><TR><TD><A HREF="IResourceManager.htm#SetFocus">SetFocus</A>
</TD><TD>Notifies the resource manager that a specified object has been given the focus of the user.
</TD></TR><TR><TD><A HREF="IResourceManager.htm#ReleaseFocus">ReleaseFocus</A>
</TD><TD>Sets the focus object to NULL in the resource manager if the object of the current
focus object is the one specified in this method.
</TD></TR></TABLE>



<H1><A NAME="CancelRequest">IResourceManager::CancelRequest</A><HR size=1></H1>
<A HREF="IResourceManager.htm">IResourceManager Interface</A>
<P>Cancels the request for a resource.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>CancelRequest</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>idResource</I><B>,</B><BR>&nbsp;&nbsp;<B>IResourceConsumer*</B> <I>pConsumer</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>idResource </I>
</DT><DD>[in] Resource identifier of a pending request.
</DD><DT><I>pConsumer </I>
</DT><DD>[in] <A HREF="IResourceConsumer.htm">IResourceConsumer</A> interface that made the request.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method should be called when the <A HREF="IResourceConsumer.htm">IResourceConsumer</A> object that requested the
resource has not received it and no longer requires it. If it has already received the
resource, it should use the <A HREF="IResourceManager.htm#NotifyRelease">IResourceManager::NotifyRelease</A> method.
</BLOCKQUOTE>


<H1><A NAME="NotifyAcquire">IResourceManager::NotifyAcquire</A><HR size=1></H1>
<A HREF="IResourceManager.htm">IResourceManager Interface</A>
<P>Notifies the resource manager that an attempt to acquire a resource has completed.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>NotifyAcquire</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>idResource</I><B>,</B><BR>&nbsp;&nbsp;<B>IResourceConsumer*</B> <I>pConsumer</I><B>,</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <I>hr</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>idResource</I>
</DT><DD>[in] Token for the registered resource.
</DD><DT><I>pConsumer</I>
</DT><DD>[in] <A HREF="IResourceConsumer.htm">IResourceConsumer</A> interface of the object requesting the resource.
</DD><DT><I>hr</I>
</DT><DD>[in] Success of the acquisition; S_OK if the resource was acquired, or an error value if not.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Use this method after an <A HREF="IResourceConsumer.htm#AcquireResource">IResourceConsumer::AcquireResource</A>
method returns an S_FALSE value, indicating that the acquisition will be asynchronous
(that is, handled by a callback mechanism). If the <I>hr</I> parameter is S_OK, the resource
manager will assume that the resource is now held by the caller. If the <I>hr</I>
parameter is anything other than S_OK, the resource manager will assume that the
attempt to acquire the resource failed and will reassign the resource elsewhere.
</BLOCKQUOTE>


<H1><A NAME="NotifyRelease">IResourceManager::NotifyRelease</A><HR size=1></H1>
<A HREF="IResourceManager.htm">IResourceManager Interface</A>
<P>Notifies the resource manager that <A HREF="IResourceConsumer.htm">IResourceConsumer</A> has released a resource.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>NotifyRelease</B> <B>LONG</B> <I>idResource</I><B>,</B><BR><BR>&nbsp;&nbsp;<B>IResourceConsumer*</B> <I>pConsumer</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bStillWant</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>idResource</I>
</DT><DD>[in] Resource token.
</DD><DT><I>pConsumer</I>
</DT><DD>[in] Object releasing the resource.
</DD><DT><I>bStillWant</I>
</DT><DD>[in] Flag specifying whether the resource is still required or not.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Use this method in response to an <A HREF="IResourceConsumer.htm#ReleaseResource">IResourceConsumer::ReleaseResource</A>
method, or when you have finished using the resource. The <I>bStillWant</I>
parameter should be set TRUE if you still want the resource when it is next available,
or FALSE if you no longer want the resource.
</BLOCKQUOTE>


<H1><A NAME="Register">IResourceManager::Register</A><HR size=1></H1>
<A HREF="IResourceManager.htm">IResourceManager Interface</A>
<P>Registers a single named resource with the resource manager.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Register</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>cResource</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG*</B> <I>plToken</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pName </I>
</DT><DD>[in] Named resource.
</DD><DT><I>cResource</I>
</DT><DD>[in] Number of resources.
</DD><DT><I>plToken</I>
</DT><DD>[out] Returned token identifying the resource to be used in additional calls.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>This method registers a named resource, which can contain a number
of resources, and returns a token to be used when requesting this resource.
It is not an error if the resource is already registered; if the number in the <I>cResource</I>
parameter is less than what is already registered, resources will be deallocated to the new
count. To unregister the resource, pass a count of zero in <I>cResource</I>.
</BLOCKQUOTE>


<H1><A NAME="RegisterGroup">IResourceManager::RegisterGroup</A><HR size=1></H1>
<A HREF="IResourceManager.htm">IResourceManager Interface</A>
<P>Registers a named resource group with the resource manager.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>RegisterGroup</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>cResource</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG*</B> <I>palTokens</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG*</B> <I>plToken</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pName</I>
</DT><DD>[in] Named resource group.
</DD><DT><I>cResource</I>
</DT><DD>[in] Number of resources in the group.
</DD><DT><I>palTokens</I>
</DT><DD>[in, size_is(cResource)] Array of resources in the group.
</DD><DT><I>plToken</I>
</DT><DD>[out] Returned group resource identifier.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>

</BLOCKQUOTE>


<H1><A NAME="ReleaseFocus">IResourceManager::ReleaseFocus</A><HR size=1></H1>
<A HREF="IResourceManager.htm">IResourceManager Interface</A>
<P>Sets the focus object to NULL in the resource manager if the current
focus object is the one specified in this method.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>ReleaseFocus</B><B>(</B><BR>&nbsp;&nbsp;<B>IUnknown*</B> <I>pFocusObject</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pFocusObject</I>
</DT><DD>[in] Focus object.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Use this method when the object of focus is about to be destroyed to ensure that
the focus is not still being referenced.
</BLOCKQUOTE>


<H1><A NAME="RequestResource">IResourceManager::RequestResource</A><HR size=1></H1>
<A HREF="IResourceManager.htm">IResourceManager Interface</A>
<P>Requests the use of a given registered resource.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>RequestResource</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>idResource</I><B>,</B><BR>&nbsp;&nbsp;<B>IUnknown*</B> <I>pFocusObject</I><B>,</B><BR>&nbsp;&nbsp;<B>IResourceConsumer*</B> <I>pConsumer</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>idResource</I>
</DT><DD>[in] Resource token retrieved when the resource was registered.
</DD><DT><I>pFocusObject</I>
</DT><DD>[in] <A HREF="IUnknown.htm">IUnknown</A> interface of a focus object associated with a request
(normally the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter's</A> <B>IUnknown</B> interface).
</DD><DT><I>pConsumer</I>
</DT><DD>[in] <A HREF="IResourceConsumer.htm">IResourceConsumer</A> interface on the object requesting the resource.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. Returns S_OK if the requested resource is returned, or
S_FALSE if the resource is not available, in which case the resource manager
will call the requesting object back when the resource becomes available.
Any other return is an error.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>When there is more than one request for the resource, the resource manager
will decide the priority by using the object of focus passed with each request and
comparing it to the object of focus passed in the most recent <A HREF="IResourceManager.htm#SetFocus">IResourceManager::SetFocus</A> method.

<P>Requests will be filled in the following order of priority.
<OL><LI>Requests made with exactly the same object of focus as the last <A HREF="IResourceManager.htm#SetFocus">SetFocus</A> method.
<LI>Requests whose object of focus shares a common <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#source_filter')">source filter</A>.
<LI>Requests whose object of focus shares a common <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A>.
<LI>Requests in the same process as the focus.
</OL>
<P>While checking this priority, the resource manager will use <A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> on the focus object for IID_IFilter. If found, the resource manager will use <A HREF="IBaseFilter.htm">IBaseFilter</A> methods to check the filter graph and look for common source filters with the current focus object.

<P>A filter should pass the <A HREF="IUnknown.htm">IUnknown</A> interface of the filter in the <I>pFocusObject</I> parameter.
The filter graph manager matches filters to the filter graph and will attempt to trace filters to common source filters when checking objects of focus.

<P>The focus object must be valid for the entire lifetime of the request&#151;until either the
<A HREF="IResourceManager.htm#CancelRequest">IResourceManager::CancelRequest</A> method is called, or the
<A HREF="IResourceManager.htm#NotifyRelease">IResourceManager::NotifyRelease</A> method is called with the
<I>bStillWant</I> parameter set to FALSE.
</BLOCKQUOTE>


<H1><A NAME="SetFocus">IResourceManager::SetFocus</A><HR size=1></H1>
<A HREF="IResourceManager.htm">IResourceManager Interface</A>
<P>Notifies the resource manager that a specified object has been given the
focus of the user.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetFocus</B><B>(</B><BR>&nbsp;&nbsp;<B>IUnknown*</B> <I>pFocusObject</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pFocusObject</I>
</DT><DD>[in] Object that has been given the focus of the user.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE>
<TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>In DirectShow, the object given the user's focus is typically
a video renderer whose window has received the focus. The resource manager
gives priority to requests for resources in the following order.

<OL><LI>Requests made with the focus object specified in the <I>pFocusObject</I> parameter.
<LI>Requests whose focus object shares a common source filter.
<LI>Requests whose focus object shares a common filter graph.
<LI>Requests in the same process as the focus.
</OL>
<P>Once a focus has been set, the resource manager must maintain a focus object
until <A HREF="IResourceManager.htm#ReleaseFocus">ReleaseFocus</A> is called.
That is, after calling this method, you must use
<B>ReleaseFocus</B>
before the <A HREF="IUnknown.htm">IUnknown</A> interface of the focus object becomes invalid, unless you can
guarantee that <B>SetFocus</B>
is called by a different object in the meantime. No reference count is held on the
focus object.

<P>The resource manager will hold this pointer until replaced or canceled,
and will use it to resolve resource contention. It will use <A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
for the <A HREF="IBaseFilter.htm">IBaseFilter</A> interface at least and, if found, will use methods on that interface.
It calls methods on <B>IBaseFilter</B> to decide which audio renderer to use if
there are two (it will choose the one with a source filter common to the focus object),
and also to determine if the two objects are within the same filter graph.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
