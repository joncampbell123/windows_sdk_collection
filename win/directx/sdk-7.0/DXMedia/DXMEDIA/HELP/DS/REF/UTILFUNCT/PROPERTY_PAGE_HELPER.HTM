<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>Property Page Helper Functions</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="Property Page Helper Functions">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<META NAME="KEYWORDS" CONTENT="Property Page Helper Functions">
<META NAME="DESCRIPTION" CONTENT="DirectShow Property Page Helper Functions">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="PropertyPageFunctions"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- Property Page Helper Functions"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- Property Page Helper Functions"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="UtilFunct_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Performance_Macros.htm">Performance Macros</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="Reference_Time_functs.htm">Reference Time Function</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>Property Page Helper Functions</H1>

<P>The Videoctl.h header file in the DirectShow base classes provides functions to help with property page implementations.</P>

<BLOCKQUOTE><TABLE CLASS="ref">
<TR><TD><A HREF="Property_Page_Helper.htm#GetDialogSize">GetDialogSize</A>
 </TD><TD>Retrieves the size of a resource dialog box in screen pixels.
</TD></TR><TR><TD><A HREF="Property_Page_Helper.htm#StringFromResource">StringFromResource</A>
 </TD><TD>Loads a string from a resource file with the given resource identifier.
</TD></TR><TR><TD><A HREF="Property_Page_Helper.htm#WideStringFromResource">WideStringFromResource</A>
 </TD><TD>Loads a Unicode string from a resource file with the given resource identifier.
</TD></TR></TABLE></BLOCKQUOTE>

<H1><A NAME="GetDialogSize">GetDialogSize</A><HR size=1></H1>
<A HREF="Property_Page_Helper.htm">Property Page Helper Functions</A>
<P>Retrieves the size of a resource dialog box.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>BOOL</B> <B>WINAPI</B> <B>GetDialogSize</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>iResourceID</I><B>,</B><BR>&nbsp;&nbsp;<B>DLGPROC</B> <I>pDlgProc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPARAM</B> <I>lParam</I><B>,</B><BR>&nbsp;&nbsp;<B>SIZE</B> <I>*pResult</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>iResourceID</I>
 </DT><DD>Dialog box resource identifier.
</DD><DT><I>pDlgProc</I>
 </DT><DD>Pointer to the dialog box procedure.
</DD><DT><I>lParam</I>
 </DT><DD>Any user data wanted in <I>pDlgProc</I>.
</DD><DT><I>pResult</I>
 </DT><DD>Size of the dialog box, in screen pixels.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns TRUE if the dialog box resource was found, or FALSE otherwise.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Property pages can use this function to return the actual display size they require. Most property pages are dialog boxes and, as such, have dialog box templates stored in resource files. Templates use dialog box units that do not map directly onto screen pixels. When a property page has its <A HREF="../class/CBasePropertyPage.htm#GetPageInfo">GetPageInfo</A> function called, it must return the actual display size in pixels. This <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">method</A> is passed the resource ID for the dialog box and will return its size in pixels.

<P>To make the calculation, the function creates an instance of the dialog box. To avoid the dialog box appearing on the screen temporarily, the dialog box's template in the resource file should not have a WS_VISIBLE property.
</BLOCKQUOTE>

<H1><A NAME="StringFromResource">StringFromResource</A><HR size=1></H1>
<A HREF="Property_Page_Helper.htm">Property Page Helper Functions</A>
<P>Loads a string from a resource file with the given resource identifier.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>TCHAR</B> <B>*</B> <B>WINAPI</B> <B>StringFromResource</B><B>(</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pBuffer</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>iResourceID</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pBuffer</I>
 </DT><DD>String corresponding to <I>iResourceID</I>.
</DD><DT><I>iResourceID</I>
 </DT><DD>Resource identifier of the string to retrieve.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the same string as <I>pBuffer</I>. If the function is not successful, returns a null string.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The <I>pBuffer</I> buffer must be at least STR_MAX_LENGTH bytes.
</BLOCKQUOTE>

<H1><A NAME="WideStringFromResource">WideStringFromResource</A><HR size=1></H1>
<A HREF="Property_Page_Helper.htm">Property Page Helper Functions</A>
<P>Loads a Unicode string from a resource file with the given resource identifier.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>WCHAR</B> <B>*</B> <B>WINAPI</B> <B>WideStringFromResource</B><B>(</B><BR>&nbsp;&nbsp;<B>WCHAR</B> <I>*pBuffer</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>iResourceID</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pBuffer</I>
 </DT><DD>String corresponding to <I>iResourceID</I>.
</DD><DT><I>iResourceID</I>
 </DT><DD>Resource identifier of the string to retrieve.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the same string as <I>pBuffer</I>. If the function is not successful, returns a null string.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Property pages are typically called through their COM interfaces, which use Unicode strings regardless of how the binary is built. This function allows you to convert a resource string to a Unicode string. The function converts the resource to a Unicode string (if it is not already one) after loading it.
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
