<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CEnumPins Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CEnumPins Class">
<META NAME="Description" CONTENT="AddRef (CEnumPins)">
<META NAME="Description" CONTENT="CEnumPins::AddRef">
<META NAME="Description" CONTENT="CEnumPins (CEnumPins)">
<META NAME="Description" CONTENT="CEnumPins::CEnumPins">
<META NAME="Description" CONTENT="Clone (CEnumPins)">
<META NAME="Description" CONTENT="CEnumPins::Clone">
<META NAME="Description" CONTENT="Next (CEnumPins)">
<META NAME="Description" CONTENT="CEnumPins::Next">
<META NAME="Description" CONTENT="QueryInterface (CEnumPins)">
<META NAME="Description" CONTENT="CEnumPins::QueryInterface">
<META NAME="Description" CONTENT="Release (CEnumPins)">
<META NAME="Description" CONTENT="CEnumPins::Release">
<META NAME="Description" CONTENT="Reset (CEnumPins)">
<META NAME="Description" CONTENT="CEnumPins::Reset">
<META NAME="Description" CONTENT="Skip (CEnumPins)">
<META NAME="Description" CONTENT="CEnumPins::Skip">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CEnumPins"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CEnumPins Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CEnumPins Class"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CEnumMediaTypes.htm">CEnumMediaTypes Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CFactoryTemplate.htm">CFactoryTemplate Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CEnumPins Class</H1>

<P><IMG SRC="../../art/filter03.gif" WIDTH="195" HEIGHT="52" ALT="CEnumPins class hierarchy">

<P>This class supports the <A HREF="../iface/IEnumPins.htm">IEnumPins</A> enumeration interface by calling
<A HREF="CBaseFilter.htm">CBaseFilter</A> methods. The <B>CBaseFilter</B> class supports the <A HREF="../iface/IBaseFilter.htm#EnumPins">IBaseFilter::EnumPins</A> method. Each time one of this interface's methods is called, the <B>CBaseFilter</B> class checks to see if the pins that it enumerates have changed; it does this by calling <A HREF="CBaseFilter.htm#GetPinVersion">CBaseFilter::GetPinVersion</A> and matching the version the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> is keeping with the version that it
 
 stores during construction.

<P>If a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> enumerator becomes stale, there is no mechanism for resynchronizing it with 
the filter. The user must release the interface and retrieve another one. 

<P>Because the enumeration operation is likely to fail if the pin version changes
(indicating that the filter might have added or removed pins), 
all member functions in this class check the version by calling a private
member function, which calls the owning filter's <A HREF="CBaseFilter.htm#GetPinVersion">CBaseFilter::GetPinVersion</A>
member function. These member functions then return <A HREF="../Error_Success_Codes.htm#VFW_E_ENUM_OUT_OF_SY">VFW_E_ENUM_OUT_OF_SYNC</A> if the version has changed. This should always work unless the filter has overridden
<B>CBaseFilter::GetPinVersion</B> to do something unexpected.

<P>All member functions in this class that return <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> and accept a pointer as a 
parameter return E_POINTER when passed a null pointer. 

<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>

<TABLE><TR><TD><A HREF="CEnumPins.htm#CEnumPins_CEnumPins">CEnumPins</A>
</TD><TD>Constructs a <A HREF="CEnumPins.htm">CEnumPins</A> object.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Implemented_IUnknown"></A>Implemented IUnknown Methods</P>
<TABLE><TR><TD><A HREF="CEnumPins.htm#CEnumPins_AddRef">AddRef</A> 
 </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="CEnumPins.htm#CEnumPins_QueryInterface">QueryInterface</A> 
 </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="CEnumPins.htm#CEnumPins_Release">Release</A> 
 </TD><TD>Decrements the reference count.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Implemented_IEnumPin"></A>Implemented IEnumPins Methods</P>
<TABLE><TR><TD><A HREF="CEnumPins.htm#Clone">Clone</A>
 </TD><TD>Creates a duplicate <A HREF="CEnumPins.htm">CEnumPins</A> object 
with the same initial state.
</TD></TR><TR><TD><A HREF="CEnumPins.htm#Next">Next</A>
 </TD><TD>Returns the next pin after the current position.
</TD></TR><TR><TD><A HREF="CEnumPins.htm#Reset">Reset</A>
 </TD><TD>Sets the current position back to the beginning.
</TD></TR><TR><TD><A HREF="CEnumPins.htm#Skip">Skip</A>
 </TD><TD>Skips over one or more entries in the enumerator.
</TD></TR></TABLE>



<H1><A NAME="CEnumPins_AddRef">CEnumPins::AddRef</A><HR size=1></H1>
<A HREF="CEnumPins.htm">CEnumPins Class</A>
<P>Increments the reference count for the calling interface on an object.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>ULONG</B> <B>AddRef</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an integer from 1 to <I>n</I>, the value of the new reference count.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IUnknown.htm#AddRef">IUnknown::AddRef</A> method.
</BLOCKQUOTE>


<H1><A NAME="CEnumPins_CEnumPins">CEnumPins::CEnumPins</A><HR size=1></H1>
<A HREF="CEnumPins.htm">CEnumPins Class</A>
<P>Constructor for the <A HREF="CEnumPins.htm">CEnumPins</A> class.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CEnumPins</B><B>(</B><BR>&nbsp;&nbsp;<B>CBaseFilter</B> <I>*pFilter</I><B>,</B><BR>&nbsp;&nbsp;<B>CEnumPins</B> <I>*pEnumPins</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pFilter</I>
</DT><DD>Pointer to the filter on which to enumerate the pins.
</DD><DT><I>pEnumPins</I>
</DT><DD>Returned pointer to an <A HREF="../iface/IEnumPins.htm">IEnumPins</A> interface object.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>


<H1><A NAME="Clone">CEnumPins::Clone</A><HR size=1></H1>
<A HREF="CEnumPins.htm">CEnumPins Class</A>
<P>Makes a copy of the enumerator. This allows the calling application to
retain two positions in the list of pins.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Clone</B><B>(</B><BR>&nbsp;&nbsp;<B>IEnumPins</B> <B>**</B> <I>ppEnum</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppEnum</I>
 </DT><DD>New enumerator that is a copy of this enumerator.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IEnumPins.htm#Clone">IEnumPins::Clone</A> method.
</BLOCKQUOTE>


<H1><A NAME="Next">CEnumPins::Next</A><HR size=1></H1>
<A HREF="CEnumPins.htm">CEnumPins Class</A>
<P>Places pointers to <A HREF="../iface/IPin.htm">IPin</A> interfaces into the specified array.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Next</B><B>(</B><BR>&nbsp;&nbsp;<B>ULONG</B> <I>cPins</I><B>,</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>**</B> <I>ppPins</I><B>,</B><BR>&nbsp;&nbsp;<B>ULONG</B> <B>*</B> <I>pcFetched</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>cPins</I>
 </DT><DD>Number of pins to place.
</DD><DT><I>ppPins</I>
 </DT><DD>Array in which to place the interface pointers.
</DD><DT><I>pcFetched</I>
 </DT><DD>Actual number of pins placed in the array.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IEnumPins.htm#Next">IEnumPins::Next</A> method.
The derived class is responsible for implementing <A HREF="CBaseFilter.htm#GetPin">CBaseFilter::GetPin</A>,
which this member function calls to retrieve the next pin. 

<P>Because this member function returns one or more interfaces that have had their reference
counts incremented, the caller of this member function must be sure to release
the interfaces by calling <A HREF="../iface/IUnknown.htm#Release">IUnknown::Release</A> on the interfaces when done with them. 
</BLOCKQUOTE>


<H1><A NAME="CEnumPins_QueryInterface">CEnumPins::QueryInterface</A><HR size=1></H1>
<A HREF="CEnumPins.htm">CEnumPins Class</A>
<P>Retrieves a pointer to a specified interface on a component to which a
client currently holds an interface pointer. This method must call
<A HREF="../iface/IUnknown.htm#AddRef">IUnknown::AddRef</A> on the pointer it returns.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>iid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <B>**</B> <I>ppvObject</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>iid</I>
 </DT><DD>Specifies the IID of the interface being requested.
</DD><DT><I>ppvObject</I>
 </DT><DD>Receives a pointer to an interface pointer to the object on return.
 If the interface specified in <I>iid</I> is not supported
 by the object, <I>ppvObject</I> is set to NULL.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if the interface is supported, S_FALSE if not.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IUnknown.htm#QueryInterface">IUnknown::QueryInterface</A> method
and passes out references to the <A HREF="../iface/IEnumPins.htm">IEnumPins</A> interface.
</BLOCKQUOTE>


<H1><A NAME="CEnumPins_Release">CEnumPins::Release</A><HR size=1></H1>
<A HREF="CEnumPins.htm">CEnumPins Class</A>
<P>Decrements the reference count for the calling interface on an object.
If the reference count on the object falls to zero, the object is freed from memory.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>ULONG</B> <B>Release</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the resulting value of the reference count, which is used for
diagnostic/testing purposes only. If you need to know that resources have been freed,
use an interface with higher-level semantics.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IUnknown.htm#Release">IUnknown::Release</A> method.</BLOCKQUOTE>


<H1><A NAME="Reset">CEnumPins::Reset</A><HR size=1></H1>
<A HREF="CEnumPins.htm">CEnumPins Class</A>
<P>Resets the enumerator to the beginning so that the next call to the <A HREF="../iface/IEnumPins.htm#Next">IEnumPins::Next</A> 
method will return, at a minimum, the first pin of the filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Reset</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IEnumPins.htm#Reset">IEnumPins::Reset</A> method.
</BLOCKQUOTE>


<H1><A NAME="Skip">CEnumPins::Skip</A><HR size=1></H1>
<A HREF="CEnumPins.htm">CEnumPins Class</A>
<P>Skips the next specified number of pins.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Skip</B><B>(</B><BR>&nbsp;&nbsp;<B>ULONG</B> <I>cPins</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>cPins</I>
 </DT><DD>Number of pins to skip.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IEnumPins.htm#Skip">IEnumPins::Skip</A> method.
This member function affects the next call to the <A HREF="../iface/IEnumPins.htm#Next">IEnumPins::Next</A> method.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
