<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IQueueCommand Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IQueueCommand Interface">
<META NAME="Description" CONTENT="IQueueCommand::InvokeAtPresentationTime">
<META NAME="Description" CONTENT="IQueueCommand::InvokeAtStreamTime">
<META NAME="Description" CONTENT="InvokeAtPresentationTime (IQueueCommand)">
<META NAME="Description" CONTENT="InvokeAtStreamTime (IQueueCommand)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IQueueCommand"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IQualProp.htm">IQualProp Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IReferenceClock.htm">IReferenceClock Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IQueueCommand Interface</H1>

<P>The <B>IQueueCommand</B> interface provides a way to defer
commands and property changes.
The deferred command mechanism allows <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> themselves to handle deferred
commands. When they do not, the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> queues the command until the requested
time and then calls the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">method</A> on the filter (this would result in coarse rather than accurate
synchronization). Note that a filter that does handle deferred commands must make them apply
to data appearing at that time. Thus, a contrast filter asked to change the contrast at time x must
ensure that it applies the change when processing data time-stamped to be rendered at time x;
these samples will be processed by the filter somewhat before time x.

<P>The <B>IQueueCommand</B> interface provides two methods,
<A HREF="IQueueCommand.htm#InvokeAtStreamTime">InvokeAtStreamTime</A>, which queues commands at <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#stream_time')">stream time</A>, and
<A HREF="IQueueCommand.htm#InvokeAtPresentationTime">InvokeAtPresentationTime</A>, which queues commands at <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#presentation_time')">presentation time</A>. Both
return an <A HREF="IDeferredCommand.htm">IDeferredCommand</A> interface to the queued command, by which the
application can cancel the command, set a new presentation time for it, or get back an estimate
of the likelihood of the filter graph manager being able to run the command on time.

<P>Both presentation time and stream time commands will run once, and then be removed
from the queue. Both the queue and the application will hold a reference count on the object
(represented to the application by the <A HREF="IDeferredCommand.htm">IDeferredCommand</A> interface), and the object
will not be destroyed until both are released. Similarly, calling <A HREF="IUnknown.htm#Release">IUnknown::Release</A>
on the <B>IDeferredCommand</B> interface is not sufficient to cancel the command,
because the queue also holds a reference count.

<P>Rather than add optional stream time and presentation time constraints to every method
and property on every control interface, the application uses <A HREF="../../appendixes/Further_Reading.htm#IDispatch">IDispatch</A> to provide a single
interface where these time parameters can be specified. <B>IQueueCommand</B> provides
<A HREF="IQueueCommand.htm#InvokeAtStreamTime">InvokeAtStreamTime</A> and <A HREF="IQueueCommand.htm#InvokeAtPresentationTime">InvokeAtPresentationTime</A> methods that are similar
in style to the <A HREF="../../appendixes/Further_Reading.htm#IDispatch__Invoke">IDispatch::Invoke</A> method.



<P>Filters can implement <B>IQueueCommand</B> themselves. In this case, they parse the
command and queue it for action when the relevant samples arrive or when the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_clock')">reference clock</A>
reaches the correct point, as appropriate. For filters that do not support this, the filter graph manager
will run the command when the reference clock reaches the specified time, regardless of the
samples being processed at the filter.




<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>This method is implemented by the filter graph manager to allow queuing of
deferred commands.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Applications can use this interface, along with the <A HREF="IDeferredCommand.htm">IDeferredCommand</A> interface,
to queue commands for deferred processing.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IQueueCommand methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IQueueCommand.htm#InvokeAtStreamTime">InvokeAtStreamTime</A>
 </TD><TD>Queues a method or property change for execution at a specified stream time (that is,
presentation time relative to the current stream time offset).
</TD></TR><TR><TD><A HREF="IQueueCommand.htm#InvokeAtPresentationTime">InvokeAtPresentationTime</A>
 </TD><TD>Queues a method or property change for execution at a specified presentation time.
</TD></TR></TABLE>



<H1><A NAME="InvokeAtPresentationTime">IQueueCommand::InvokeAtPresentationTime</A><HR size=1></H1>
<A HREF="IQueueCommand.htm">IQueueCommand Interface</A>
<P>Queues a method or property change for execution at a specified presentation time.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>InvokeAtPresentationTime</B><B>(</B><BR>&nbsp;&nbsp;<B>IDeferredCommand</B> <B>*</B> <I>pCmd</I><B>,</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>time</I><B>,</B><BR>&nbsp;&nbsp;<B>GUID*</B> <I>iid</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dispidMember</I><B>,</B><BR>&nbsp;&nbsp;<B>short</B> <I>wFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>cArgs</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT</B> <I>*pDispParams</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT</B> <I>*pvarResult</I><B>,</B><BR>&nbsp;&nbsp;<B>short</B> <I>*puArgErr</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCmd</I>
 </DT><DD>[out] Pointer to the place to return an interface on the deferred command
if it is successfully created.
</DD><DT><I>time</I>
 </DT><DD>[in] Time at which to invoke the command.
</DD><DT><I>iid</I>
 </DT><DD>[in] Interface to be called.
</DD><DT><I>dispidMember</I>
 </DT><DD>[in] Method or property to call on the interface.
</DD><DT><I>wFlags</I>
 </DT><DD>[in] Method or property flag.
</DD><DT><I>cArgs</I>
 </DT><DD>[in] Number of arguments on <I>pDispParams</I>.
</DD><DT><I>pDispParams</I>
 </DT><DD>[in] Parameters to this method.
</DD><DT><I>pvarResult</I>
 </DT><DD>[in,out] Return value.
</DD><DT><I>puArgErr</I>
 </DT><DD>[out] Index to the arguments in error.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>


<H1><A NAME="InvokeAtStreamTime">IQueueCommand::InvokeAtStreamTime</A><HR size=1></H1>
<A HREF="IQueueCommand.htm">IQueueCommand Interface</A>
<P>Queues a method or property change for execution at a specified stream time (that is, presentation time relative to the current stream time offset).

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>InvokeAtStreamTime</B><B>(</B><BR>&nbsp;&nbsp;<B>IDeferredCommand</B> <B>**</B> <I>pCmd</I><B>,</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>time</I><B>,</B><BR>&nbsp;&nbsp;<B>GUID</B> <I>*iid</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dispidMember</I><B>,</B><BR>&nbsp;&nbsp;<B>short</B> <I>wFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>cArgs</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT</B> <I>*pDispParams</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT</B> <I>*pvarResult</I><B>,</B><BR>&nbsp;&nbsp;<B>short</B> <I>*puArgErr</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pCmd</I>
 </DT><DD>[out] Pointer to the place to return an interface on the deferred command
if it is successfully created.
</DD><DT><I>time</I>
 </DT><DD>[in] Time at which to invoke the command.
</DD><DT><I>iid</I>
 </DT><DD>[in] Interface to be called.
</DD><DT><I>dispidMember</I>
 </DT><DD>[in] Method or property to call on the interface.
</DD><DT><I>wFlags</I>
 </DT><DD>[in] Method or property flag.
</DD><DT><I>cArgs</I>
 </DT><DD>[in] Number of arguments in <I>pDispParams</I>.
</DD><DT><I>pDispParams</I>
 </DT><DD>[in] Parameters to this method.
</DD><DT><I>pvarResult</I>
 </DT><DD>[in, out] Return value of the called method.
</DD><DT><I>puArgErr</I>
 </DT><DD>[out] Index to the arguments in error.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.



</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Run this command to affect the presentation that occurs after the specified stream time.
The interface IID is an interface that can be obtained by calling
<A HREF="IUnknown.htm#QueryInterface">IUnknown::QueryInterface</A> on this same <A HREF="IQueueCommand.htm">IQueueCommand</A> interface.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
