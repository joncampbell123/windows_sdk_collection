<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CFactoryTemplate Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CFactoryTemplate Class">
<META NAME="Description" CONTENT="CreateInstance (CFactoryTemplate)">
<META NAME="Description" CONTENT="CFactoryTemplate::CreateInstance">
<META NAME="Description" CONTENT="CFactoryTemplate::IsClassID">
<META NAME="Description" CONTENT="IsClassID (CFactoryTemplate)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CFactoryTemplate"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CFactoryTemplate Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CFactoryTemplate Class"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CEnumPins.htm">CEnumPins Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CGenericList.htm">CGenericList Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CFactoryTemplate Class</H1>

<P><IMG SRC="../../art/cbase03.gif" WIDTH="179" HEIGHT="24" ALT="CFactoryTemplate class hierarchy">


<P>This class provides a template used by the default <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#class_factory')">class factory</A> code.

<P>Create one <B>CFactoryTemplate</B> object in an array for every object class so that the 
default class factory code can create new instances.

<P>This class holds the name of the object, the object's class identifier (CLSID), 
and a pointer to the creation function for the corresponding object. Initialize one of these in an array called g_Templates for each CLSID the application's dynamic-link library (DLL) supports. The creation function should take an LPUNKNOWN parameter and an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> pointer and return an object derived from the <A HREF="CBaseObject.htm">CBaseObject</A> class. Set the <B>HRESULT</B> to a failed value if there is any error in construction.
An example declaration (from the Gargle sample <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A>) follows:

<PRE>// list of class ids and creator functions for class factory

CFactoryTemplate g_Templates[2]= { { L"Gargle filter"         // CFactoryTemplate.m_name
                                   , &amp;CLSID_Gargle            // CFactoryTemplate.m_ClsID 
                                   , CGargle::CreateInstance  // CFactoryTemplate.m_lpfnNew
&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;   , NULL                     // CFactoryTemplate.m_lpfnInit
&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;   , &amp;sudGargle               // CFactoryTemplate.m_pAMovieSetup_Filter
                                   }
                                 , { L"Gargle filter property page"
                                   , &amp;CLSID_GargProp
                                   , CGargleProperties::CreateInstance
                                   }
                                 };

int g_cTemplates = sizeof(g_Templates) / sizeof(g_Templates[0]);
</PRE>
<P>Note that the name of the object is strictly necessary only if you are using the <A HREF="../../appendixes/Further_Reading.htm#DllRegisterServer">DllRegisterServer</A> setup routine to implement self-registering of your filter. If you are not using this feature, you can set the first element of the g_Templates instance (<A HREF="CFactoryTemplate.htm#m_Name">m_Name</A>) to NULL or L"".


<A NAME="Protected_Data_Membe"></A><P CLASS="ref">Protected Data Members</P>
<TABLE><TR><TD><B><A NAME="m_ClsID">m_ClsID</A></B> 
 </TD><TD>Pointer to the CLSID of the object class.
</TD></TR><TR><TD><B><A NAME="m_lpfnNew">m_lpfnNew</A></B> 
 </TD><TD>Pointer to a function that creates an instance of the object class.
</TD></TR><TR><TD><B><A NAME="m_lpfnInit">m_lpfnInit</A></B> 
 </TD><TD>Pointer to a function that initializes a new instance of the object class.
</TD></TR><TR><TD><B><A NAME="m_Name">m_Name</A></B> 
 </TD><TD>Name of the filter; required when using filter self-registration services. 
</TD></TR><TR><TD><B><A NAME="m_pAMovieSetup_Filte">m_pAMovieSetup_Filter</A></B>
 </TD><TD>Pointer to an <A HREF="../structs.htm#AMOVIESETUP_FILTER">AMOVIESETUP_FILTER</A> structure; required when using filter self-registration services.

</TD></TR></TABLE>
<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>

<TABLE><TR><TD><A HREF="CFactoryTemplate.htm#CreateInstance">CreateInstance</A>
 </TD><TD>Calls the object-creation function for the class.
</TD></TR><TR><TD><A HREF="CFactoryTemplate.htm#IsClassID">IsClassID</A> 
 </TD><TD>Determines whether a CLSID matches this class template.
</TD></TR></TABLE>



<H1><A NAME="CreateInstance">CFactoryTemplate::CreateInstance</A><HR size=1></H1>
<A HREF="CFactoryTemplate.htm">CFactoryTemplate Class</A>
<P>Calls the object-creation function for the class.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CUnknown</B> <B>*CreateInstance</B><B>(</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <I>*phr</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pUnk</I>
</DT><DD>Pointer to the <A HREF="../iface/IUnknown.htm">IUnknown</A> interface.
</DD><DT><I>phr</I>
</DT><DD>Pointer to the <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value into which to place resulting information.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an instance of the class object.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The implementer of the class code registered using this factory template class is responsible
for providing the code that creates an instance of the class object and assigning
it to the <A HREF="CFactoryTemplate.htm#m_lpfnNew">m_lpfnNew</A> data member. This member function simply calls that function 
and returns a new object of that type.
</BLOCKQUOTE>


<H1><A NAME="IsClassID">CFactoryTemplate::IsClassID</A><HR size=1></H1>
<A HREF="CFactoryTemplate.htm">CFactoryTemplate Class</A>
<P>Determines if the class identifier (CLSID) passed matches the CLSID 
assigned to this class template.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>BOOL</B> <B>IsClassID</B><B>(</B><BR>&nbsp;&nbsp;<B>REFCLSID</B> <I>rclsid</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rclsid</I>
</DT><DD>CLSID being tested.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns TRUE if the CLSIDs are the same; otherwise, returns FALSE.



</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
