<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>String Functions</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="String Functions">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<META NAME="KEYWORDS" CONTENT="String Functions">
<META NAME="DESCRIPTION" CONTENT="DirectShow String Functions">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="StringFunctions"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- String Functions"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- String Functions"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="UtilFunct_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Stream_Integer_functs.htm">Stream Integer Functions</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../debug/Debugging_intro.htm">Debugging</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>String Functions</H1>

<P>The Wxutil.h header file in the DirectShow base classes provides wide string functions, if they are not already provided by the Microsoft&#174; Win32&#174; environment.</P>

<BLOCKQUOTE>
<TABLE CLASS="ref">
<TR><TD><A HREF="String_functs.htm#AMGetWideString">AMGetWideString</A>
 </TD><TD>Allocates and creates a wide string version of an existing nonwide string.
</TD></TR><TR><TD><A HREF="String_functs.htm#lstrcmpiW">lstrcmpiW</A>
 </TD><TD>Compares two wide strings, ignoring case.
</TD></TR><TR><TD><A HREF="String_functs.htm#lstrcmpW">lstrcmpW</A>
 </TD><TD>Compares two wide strings.
</TD></TR><TR><TD><A HREF="String_functs.htm#lstrcpynW">lstrcpynW</A>
 </TD><TD>Copies one wide string to another, with a maximum length.
</TD></TR><TR><TD><A HREF="String_functs.htm#lstrcpyW">lstrcpyW</A>
 </TD><TD>Copies one wide string to another.
</TD></TR><TR><TD><A HREF="String_functs.htm#lstrlenW">lstrlenW</A>
 </TD><TD>Gets the length of a wide string in wide characters.
</TD></TR></TABLE></BLOCKQUOTE>

<H1><A NAME="AMGetWideString">AMGetWideString</A><HR size=1></H1>
<A HREF="String_functs.htm">String Functions</A>
<P>Allocates and creates a Unicode version of an existing non-Unicode string.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>STDAPI</B> <B>AMGetWideString</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pszString</I><B>,</B><BR>&nbsp;&nbsp;<B>LPWSTR</B> <I>*ppszReturn</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pszString</I>
 </DT><DD>Non-Unicode source string.
</DD><DT><I>ppszReturn</I>
 </DT><DD>Address of a Unicode string that will contain <I>pszString</I>.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if successful, E_POINTER if <I>ppszReturn</I> is NULL, or E_OUTOFMEMORY if not enough memory is available.
</BLOCKQUOTE>

<H1><A NAME="lstrcmpiW">lstrcmpiW</A><HR size=1></H1>
<A HREF="String_functs.htm">String Functions</A>
<P>Compares two wide-character strings. The comparison is not case sensitive.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>int</B> <B>lstrcmpiW</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpszString1</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpszString2</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpszString1</I>
 </DT><DD>Pointer to the first null-terminated wide string to be compared.
</DD><DT><I>lpszString2</I>
 </DT><DD>Pointer to the second null-terminated wide string to be compared.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a negative value if the function succeeds and the string that <I>lpszString1</I> points to is less than the string that <I>lpszString2</I> points to. Returns a positive value if the string that <I>lpszString1</I> points to is greater than the string that <I>lpszString2</I> points to. Returns zero if the strings are equal.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The <B>lstrcmpiW</B> function compares two wide strings by checking the first characters against each other, the second characters against each other, and so on until it finds an inequality or reaches the ends of the strings.

<P>The function returns the difference of the values of the first unequal characters it encounters. For instance, <B>lstrcmpiW</B> determines that L"abcz" is greater than L"abcdefg" and returns the difference of L'z' and L'd'.

<P>The language (locale) is treated as always being English.
</BLOCKQUOTE>

<H1><A NAME="lstrcmpW">lstrcmpW</A><HR size=1></H1>
<A HREF="String_functs.htm">String Functions</A>
<P>Compares two wide-character strings. The comparison is case sensitive.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>int</B> <B>lstrcmpW</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpszString1</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpszString2</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpszString1</I>
 </DT><DD>Pointer to the first null-terminated wide string to be compared.
</DD><DT><I>lpszString2</I>
 </DT><DD>Pointer to the second null-terminated wide string to be compared.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a negative value if the function succeeds and the string that <I>lpszString1</I> points to is less than the string that <I>lpszString2</I> points to. Returns a positive value if the string that <I>lpszString1</I> points to is greater than the string that <I>lpszString2</I> points to. Returns zero if the strings are equal.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The <B>lstrcmpW</B> function compares two wide strings by checking the first characters against each other, the second characters against each other, and so on until it finds an inequality or reaches the ends of the strings.

<P>The function returns the difference of the values of the first unequal characters it encounters. For instance, <B>lstrcmpW</B> determines that L"abcz" is greater than L"abcdefg" and returns the difference of L'z' and L'd'.

<P>The language (locale) is treated as always being English.
</BLOCKQUOTE>

<H1><A NAME="lstrcpyW">lstrcpyW</A><HR size=1></H1>
<A HREF="String_functs.htm">String Functions</A>
<P>Copies a wide string to a buffer.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>LPWSTR</B> <B>lstrcpyW</B><B>(</B><BR>&nbsp;&nbsp;<B>LPWSTR</B> <I>lpszString1</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpszString2</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpszString1</I>
 </DT><DD>Pointer to a buffer to receive the contents of the string pointed to by the <I>lpszString2</I> parameter. The buffer must be large enough to contain the string, including the terminating wide null character.
</DD><DT><I>lpszString2</I>
 </DT><DD>Pointer to the null-terminated wide string to be copied.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a pointer to the buffer.
</BLOCKQUOTE>

<H1><A NAME="lstrcpynW">lstrcpynW</A><HR size=1></H1>
<A HREF="String_functs.htm">String Functions</A>
<P>Copies a wide string to a buffer, up to a specified number of wide characters.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>LPWSTR</B> <B>lstrcpynW</B><B>(</B><BR>&nbsp;&nbsp;<B>LPWSTR</B> <I>lpszString1</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpszString2</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>iMaxLength</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpszString1</I>
 </DT><DD>Pointer to a buffer to receive the contents of the string that the <I>lpszString2</I> parameter points to. The buffer must be large enough to contain the string, including the terminating wide null character.
</DD><DT><I>lpszString2</I>
 </DT><DD>Pointer to the null-terminated wide string to be copied.
</DD><DT><I>iMaxLength</I>
 </DT><DD>Maximum number of wide characters to copy, including a terminating null character.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a pointer to the buffer.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If <I>iMaxLength</I> is nonzero, <B>lstrcpynW</B> always inserts a terminating null wide character in the destination string, which could result in the source string being truncated.
</BLOCKQUOTE>

<H1><A NAME="lstrlenW">lstrlenW</A><HR size=1></H1>
<A HREF="String_functs.htm">String Functions</A>
<P>Retrieves the length of the specified wide string.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE><B>int</B> <B>lstrlenW</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpszString</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpszString</I>
 </DT><DD>Pointer to a null-terminated wide string.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>If the function succeeds, the return value specifies the length of the string, in wide characters.
</BLOCKQUOTE>


<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
