<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>CBaseReferenceClock Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CBaseReferenceClock Class">
<META NAME="Description" CONTENT="AdvisePeriodic (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::AdvisePeriodic">
<META NAME="Description" CONTENT="AdviseTime (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::AdviseTime">
<META NAME="Description" CONTENT="CBaseReferenceClock (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::CBaseReferenceClock">
<META NAME="Description" CONTENT="GetPrivateTime (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::GetPrivateTime">
<META NAME="Description" CONTENT="GetSchedule (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::GetSchedule">
<META NAME="Description" CONTENT="GetTime (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::GetTime">
<META NAME="Description" CONTENT="NonDelegatingQueryInterface (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::NonDelegatingQueryInterface">
<META NAME="Description" CONTENT="SetTimeDelta (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::SetTimeDelta">
<META NAME="Description" CONTENT="TriggerThread (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::TriggerThread">
<META NAME="Description" CONTENT="Unadvise (CBaseReferenceClock)">
<META NAME="Description" CONTENT="CBaseReferenceClock::Unadvise">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CBaseReferenceClock"></A>
<!-- TOOLBAR_START-->

<!-- TOOLBAR_END -->





<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CBasePropertyPage.htm">CBasePropertyPage Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CBaseRenderer.htm">CBaseRenderer Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CBaseReferenceClock Class</H1>

<P><IMG SRC="../../art/rclock01.gif" WIDTH="283" HEIGHT="169" ALT="CBaseReferenceClock class hierarchy">

<P>This base class implements the <A HREF="../iface/IReferenceClock.htm">IReferenceClock</A> interface.

<P>The <B>CBaseReferenceClock</B> class provides a full implementation of 
<A HREF="../iface/IReferenceClock.htm">IReferenceClock</A>. It uses <A HREF="CCritSec.htm">CCritSec</A> locking support 
and <A HREF="CAMSchedule.htm">CAMSchedule</A> scheduler support.

<P>Each <I><A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#advise')">advise</A></I> call defines a point in time when the caller
wants to be notified. A <I>periodic advise</I> is a regular series
of such events. A list of these advise requests is maintained
by the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_clock')">reference clock</A>. The clock calculates the delay until the
first requested advise, and signals an event at the due time.

<P>Clients are not advised through callbacks. One-shot clients have an
event set, while periodic clients have a semaphore released for each
<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_E.htm#event_notification')">event notification</A>. A semaphore allows a client to know exactly how
many events were actually triggered, because multiple time periods might


 elapse before the client code executes.

<P>During class construction, a worker thread is created. This thread
executes a series of Microsoft&#174; Win32&#174; <A HREF="../../appendixes/Further_Reading.htm#WaitForSingleObject">WaitForSingleObject</A> calls,
waking up when a command is given to the thread or the next wake-up
point is reached. The wake-up points are determined by clients making
advise calls.

<A NAME="Protected_Data_Membe"></A><P CLASS="ref">Protected Data Members</P>
<TABLE BORDER=0>
<TR><TD><B><A NAME="CBaseReferenceClock::m_pSchedule">m_pSchedule</A></B>
 </TD><TD>Pointer to the <A HREF="CAMSchedule.htm">CAMSchedule</A> object associated with this <A HREF="CBaseReferenceClock.htm">CBaseReferenceClock</A> object.
</TD></TR></TABLE>

<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>
<TABLE>
<TR><TD><A HREF="CBaseReferenceClock.htm#CBaseReferenceClock_">CBaseReferenceClock</A>
 </TD><TD>Constructs a <A HREF="CBaseReferenceClock.htm">CBaseReferenceClock</A> object.
</TD></TR><TR><TD><A HREF="CBaseReferenceClock.htm#GetSchedule">GetSchedule</A>
 </TD><TD>Returns the <A HREF="CAMSchedule.htm">CAMSchedule</A> pointer stored in the <A HREF="CBaseReferenceClock.htm#CBaseReferenceClock::m_pSchedule">CBaseReferenceClock::m_pSchedule</A> data member.
</TD></TR><TR><TD><A HREF="CBaseReferenceClock.htm#SetTimeDelta">SetTimeDelta</A>
 </TD><TD>Adjusts the values returned from <A HREF="CBaseReferenceClock.htm#GetPrivateTime">CBaseReferenceClock::GetPrivateTime</A>
by the amount specified in this member function.
</TD></TR><TR><TD><A HREF="CBaseReferenceClock.htm#TriggerThread">TriggerThread</A>
 </TD><TD>Triggers the advise thread's event. If you override <A HREF="CBaseReferenceClock.htm#GetPrivateTime">CBaseReferenceClock::GetPrivateTime</A>, you should either reuse or abandon this method.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_IReferen"></A>Implemented IReferenceClock Methods</P>
<TABLE>
<TR><TD><A HREF="CBaseReferenceClock.htm#AdvisePeriodic">AdvisePeriodic</A>
 </TD><TD>Requests an asynchronous periodic notification that a time has elapsed.
</TD></TR><TR><TD><A HREF="CBaseReferenceClock.htm#AdviseTime">AdviseTime</A>
 </TD><TD>Requests an asynchronous notification that a time has elapsed.
</TD></TR><TR><TD><A HREF="CBaseReferenceClock.htm#GetTime">GetTime</A>
 </TD><TD>Returns a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_time')">reference time</A>.
</TD></TR><TR><TD><A HREF="CBaseReferenceClock.htm#Unadvise">Unadvise</A>
 </TD><TD>Removes a previously established advise link.
</TD></TR></TABLE>
<A NAME="Overridable_Member_F"></A><P CLASS="ref">Overridable Member Functions</P>

<TABLE>
<TR><TD><A HREF="CBaseReferenceClock.htm#GetPrivateTime">GetPrivateTime</A>
 </TD><TD>Gets the current time from the real clock.
Override this member function to implement your own clock.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Implemented_INonDele"></A>Implemented INonDelegatingUnknown Methods</P>

<TABLE>
<TR><TD><A HREF="CBaseReferenceClock.htm#CBaseReferenceClock_">NonDelegatingQueryInterface</A>
 </TD><TD>Returns a pointer to interfaces supported, that is, <A HREF="../iface/IReferenceClock.htm">IReferenceClock</A>.
</TD></TR></TABLE>



<H1><A NAME="AdvisePeriodic">CBaseReferenceClock::AdvisePeriodic</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Sets up a recurring advise with the reference clock.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>AdvisePeriodic</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>StartTime</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>PeriodTime</I><B>,</B><BR>&nbsp;&nbsp;<B>HSEMAPHORE</B> <I>hSemaphore</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwAdviseToken</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>StartTime</I>
 </DT><DD>Start at this time.
</DD><DT><I>PeriodTime</I>
 </DT><DD>Time between notifications.
</DD><DT><I>hSemaphore</I>
 </DT><DD>Advise through a semaphore.
</DD><DT><I>pdwAdviseToken</I>
 </DT><DD>Advise token that identifies the link with the clock.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> values:
<TABLE>
<TR><TD>E_OUTOFMEMORY </TD><TD>Failure.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE></BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This member function implements the <A HREF="../iface/IReferenceClock.htm#AdvisePeriodic">IReferenceClock::AdvisePeriodic</A> method.
A semaphore is used, rather than an event, to ensure that multiple notifications can be seen by the
user. Each time an amount of time specified in the <I>PeriodTime</I> parameter elapses, the
semaphore will be released.

<P>When no further notifications are required, call <A HREF="CBaseReferenceClock.htm#Unadvise">CBaseReferenceClock::Unadvise</A>
and pass the <I>pdwAdviseToken</I> value returned from this call.

<P>For example, the following code extract sets up an advise link that fires its first advise five
seconds from now and then signals every second until <A HREF="CBaseReferenceClock.htm#Unadvise">Unadvise</A> is called. By using a
semaphore with a count of 10, the clock is effectively able to cache 10 events.

<PRE>HANDLE hSemaphore = CreateSemaphore(NULL, 0, 10, NULL);
    // Assume pRefClock is an IReferenceClock* variable.

    REFERENCE_TIME rtPeriodTime = 1000 * (UNITS / MILLISECONDS);
        // A one-second interval
    REFERENCE_TIME rtNow;
    DWORD    dwAdviseToken;
    pRefClock-&gt;GetTime(&amp;rtNow);

    pRefClock-&gt;AdvisePeriodic(rtNow+(5*rtPeriodTime),
        PeriodTime, hSemaphore, &amp;dwAdviseToken);
</PRE>
</BLOCKQUOTE>



<H1><A NAME="AdviseTime">CBaseReferenceClock::AdviseTime</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Sets up a one-shot notification with the clock.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>AdviseTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>baseTime</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>streamTime</I><B>,</B><BR>&nbsp;&nbsp;<B>HEVENT</B> <I>hEvent</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwAdviseToken</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>baseTime</I>
 </DT><DD>Base reference time.
</DD><DT><I>streamTime</I>
 </DT><DD>Stream offset time.
</DD><DT><I>hEvent</I>
 </DT><DD>Advise through this event.
</DD><DT><I>pdwAdviseToken</I>
 </DT><DD>Where the advise token goes.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> values.
<TABLE>
<TR><TD>E_OUTOFMEMORY </TD><TD>Failure.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>NOERROR </TD><TD>No error.
</TD></TR></TABLE></BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This member function implements the <A HREF="../iface/IReferenceClock.htm#AdviseTime">IReferenceClock::AdviseTime</A> method.
At the time specified in the <I>baseTime</I> plus the <I>streamTime</I> parameters, the
event specified in <I>hEvent</I> will be set. It is correct to call
<A HREF="CBaseReferenceClock.htm#Unadvise">CBaseReferenceClock::Unadvise</A> to remove the link after the event has occurred,
but it is not necessary. One-shot notifications are automatically cleared by the clock
once they have signaled.

<P>To cancel a one-shot notification before the time is reached, call 
<A HREF="CBaseReferenceClock.htm#Unadvise">Unadvise</A>
and pass the <I>pdwAdviseToken</I> value returned from this call.</BLOCKQUOTE>


<H1><A NAME="CBaseReferenceClock_">CBaseReferenceClock::CBaseReferenceClock</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Constructs a <A HREF="CBaseReferenceClock.htm">CBaseReferenceClock</A> object.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>CBaseReferenceClock</B><B>(</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <I>*phr</I><B>,</B><BR>&nbsp;&nbsp;<B>CAMSchedule</B> <B>*</B> <I>pSched</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pName</I>
 </DT><DD>Name of the <A HREF="CBaseReferenceClock.htm">CBaseReferenceClock</A> object.
</DD><DT><I>pUnk</I>
 </DT><DD><A HREF="../iface/IUnknown.htm">IUnknown</A> interface of the delegating object.
</DD><DT><I>phr</I>
 </DT><DD>Address of an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.
</DD><DT><I>pSched</I>
 </DT><DD>Address of a <A HREF="CAMSchedule.htm">CAMSchedule</A> object that will be associated with this <A HREF="CBaseReferenceClock.htm">CBaseReferenceClock</A> object. If <I>pSched</I> is NULL, the constructor creates a new <B>CAMSchedule</B> object and associates it with this <B>CBaseReferenceClock</B> object.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>No return value.</BLOCKQUOTE>


<H1><A NAME="GetPrivateTime">CBaseReferenceClock::GetPrivateTime</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Retrieves the current reference time.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>REFERENCE_TIME</B> <B>GetPrivateTime</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns the current reference time, in 100-nanosecond units.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P><B>GetPrivateTime</B> represents the actual clock.
<A HREF="CBaseReferenceClock.htm#GetTime">GetTime</A> is the externally used member function.
Derived classes will probably override this method,
but not <B>GetTime</B> itself.
The important point about <B>GetPrivateTime</B>
is that it is allowed to go backward.
This class's <B>GetTime</B> member function will keep 
returning the last time returned by <B>GetTime</B>
until <B>GetPrivateTime</B> catches up.</BLOCKQUOTE>


<H1><A NAME="GetSchedule">CBaseReferenceClock::GetSchedule</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Retrieves the <A HREF="CAMSchedule.htm">CAMSchedule</A> pointer stored in the <A HREF="CBaseReferenceClock.htm#CBaseReferenceClock::m_pSchedule">CBaseReferenceClock::m_pSchedule</A> data member.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>CAMSchedule</B> <B>*</B> <B>GetSchedule</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>



<H1><A NAME="GetTime">CBaseReferenceClock::GetTime</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Retrieves the current reference time, in 100-nanosecond units.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>*pTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pTime</I>
 </DT><DD>Where the current time is returned.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> values.
<TABLE>
<TR><TD>E_POINTER </TD><TD>NULL pointer argument.
</TD></TR><TR><TD>S_FALSE </TD><TD>Failure.
</TD></TR><TR><TD>S_OK</TD><TD>Success.
</TD></TR></TABLE></BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This member function implements the <A HREF="../iface/IReferenceClock.htm#GetTime">IReferenceClock::GetTime</A> method.
It reads the time from the implemented clock and returns the current time.</BLOCKQUOTE>


<H1><A NAME="CBaseReferenceClock_">CBaseReferenceClock::NonDelegatingQueryInterface</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Accesses supported interfaces.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>NonDelegatingQueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <B>**</B> <I>ppv</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>riid</I>
 </DT><DD>IID of the interface being requested. Only IID_IReferenceClock
is supported by the clock interface.
</DD><DT><I>ppv</I>
 </DT><DD>Where the <A HREF="../iface/IReferenceClock.htm">IReferenceClock</A> pointer is returned.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns E_POINTER if <I>ppv</I> is invalid. Returns NOERROR if the query is successful or E_NOINTERFACE if it is not.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This member function implements the
<A HREF="../utilfunct/INonDelegatingUnknown_iface.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingQueryInterface</A> method.</BLOCKQUOTE>


<H1><A NAME="SetTimeDelta">CBaseReferenceClock::SetTimeDelta</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Sets a delta on the time that <A HREF="CBaseReferenceClock.htm#GetPrivateTime">CBaseReferenceClock::GetPrivateTime</A> will return.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetTimeDelta</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>REFERENCE_TIME&amp;</B> <I>TimeDelta</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>TimeDelta</I>
 </DT><DD>REFERENCE_TIME delta to be added.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns NOERROR.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Note that <A HREF="CBaseReferenceClock.htm#GetTime">CBaseReferenceClock::GetTime</A> will never
return a time earlier than a previously returned time.
Thus, if you set the clock to a time in the past, successive calls
to <B>CBaseReferenceClock::GetTime</B>
will return the current value until this new time is reached, and the clock will start to increment
again.</BLOCKQUOTE>


<H1><A NAME="TriggerThread">CBaseReferenceClock::TriggerThread</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Triggers the advise thread's event.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>TriggerThread</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>No return value.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The clock uses a worker thread that should wake up and call <A HREF="CAMSchedule.htm#Advise">CAMSchedule::Advise</A> at the appropriate time. If the clock adds an event that should be fired earlier than any currently outstanding event, the worker thread needs to be awoken in order to reevaluate its wait time. The <B>TriggerThread</B> member function will wake up the worker thread so this can take place. If a derived clock causes time to jump forward for some reason, <B>TriggerThread</B> should be called so that the wait time can be reevaluated; otherwise, the events will fire late.</BLOCKQUOTE>


<H1><A NAME="Unadvise">CBaseReferenceClock::Unadvise</A><HR size=1></H1>
<A HREF="CBaseReferenceClock.htm">CBaseReferenceClock Class</A>
<P>Removes a previously established advise link.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Unadvise</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwAdviseToken</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>dwAdviseToken</I>
 </DT><DD>Identifier (token) of the link that is being reset. This is the same value
that was returned on <A HREF="CBaseReferenceClock.htm#AdviseTime">CBaseReferenceClock::AdviseTime</A> or
<A HREF="CBaseReferenceClock.htm#AdvisePeriodic">CBaseReferenceClock::AdvisePeriodic</A>.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns S_OK if the successful, S_FALSE if not.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IReferenceClock.htm#Unadvise">IReferenceClock::Unadvise</A> method.
Call <B>Unadvise</B> to remove the previously established clock advise links. It is mandatory
to call <B>Unadvise</B> on periodic advises in order to stop further calls. It is recommended to
call <B>Unadvise</B> for single-shot advise links.
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
