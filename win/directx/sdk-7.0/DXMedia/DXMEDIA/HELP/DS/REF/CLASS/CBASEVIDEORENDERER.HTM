<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CBaseVideoRenderer Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CBaseVideoRenderer Class">
<META NAME="Description" CONTENT="CBaseVideoRenderer (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::CBaseVideoRenderer">
<META NAME="Description" CONTENT="get_AvgFrameRate (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::get_AvgFrameRate">
<META NAME="Description" CONTENT="get_AvgSyncOffset (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::get_AvgSyncOffset">
<META NAME="Description" CONTENT="get_DevSyncOffset (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::get_DevSyncOffset">
<META NAME="Description" CONTENT="get_FramesDrawn (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::get_FramesDrawn">
<META NAME="Description" CONTENT="get_FramesDroppedInRenderer (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::get_FramesDroppedInRenderer">
<META NAME="Description" CONTENT="get_Jitter (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::get_Jitter">
<META NAME="Description" CONTENT="GetStdDev (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::GetStdDev">
<META NAME="Description" CONTENT="JoinFilterGraph (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::JoinFilterGraph">
<META NAME="Description" CONTENT="NonDelegatingQueryInterface (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::NonDelegatingQueryInterface">
<META NAME="Description" CONTENT="Notify (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::Notify">
<META NAME="Description" CONTENT="OnDirectRender (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::OnDirectRender">
<META NAME="Description" CONTENT="OnRenderEnd (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::OnRenderEnd">
<META NAME="Description" CONTENT="OnRenderStart (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::OnRenderStart">
<META NAME="Description" CONTENT="OnStartStreaming (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::OnStartStreaming">
<META NAME="Description" CONTENT="OnStopStreaming (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::OnStopStreaming">
<META NAME="Description" CONTENT="OnWaitEnd (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::OnWaitEnd">
<META NAME="Description" CONTENT="OnWaitStart (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::OnWaitStart">
<META NAME="Description" CONTENT="PreparePerformanceData (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::PreparePerformanceData">
<META NAME="Description" CONTENT="RecordFrameLateness (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::RecordFrameLateness">
<META NAME="Description" CONTENT="ResetStreamingTimes (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::ResetStreamingTimes">
<META NAME="Description" CONTENT="ScheduleSample (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::ScheduleSample">
<META NAME="Description" CONTENT="SendQuality (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::SendQuality">
<META NAME="Description" CONTENT="SetSink (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::SetSink">
<META NAME="Description" CONTENT="ShouldDrawSampleNow (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::ShouldDrawSampleNow">
<META NAME="Description" CONTENT="ThrottleWait (CBaseVideoRenderer)">
<META NAME="Description" CONTENT="CBaseVideoRenderer::ThrottleWait">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CBaseVideoRenderer"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CBaseVideoRenderer Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CBaseVideoRenderer Class"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CBaseStreamControl.htm">CBaseStreamControl Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CBaseVideoWindow.htm">CBaseVideoWindow Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CBaseVideoRenderer Class</H1>

<P><IMG SRC="../../art/rbase03.gif" WIDTH="355" HEIGHT="315" ALT="CBaseVideoRenderer class hierarchy">

<P>This base class is used for building video <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A>.

<P CLASS="ref"><A NAME="Protected_Data_Membe"></A>Protected Data Members</P>
<TABLE><TR><TD><B><A NAME="m_bDrawLateFrames">m_bDrawLateFrames</A></B>
 </TD><TD>Flag to signal that no frames are to be dropped. Debug only. This destroys synchronization.

</TD></TR><TR><TD><B><A NAME="m_bSupplierHandlingQ">m_bSupplierHandlingQuality</A></B>
 </TD><TD>TRUE indicates quality control messages are being handled. This lets
 the renderer know to wait until as late as possible to drop frames itself, and to
 display the next frame very early after the supplier has dropped a frame.

</TD></TR><TR><TD><B><A NAME="m_cFramesDrawn">m_cFramesDrawn</A></B>
 </TD><TD>Total number of frames that have been drawn since streaming started.

</TD></TR><TR><TD><B><A NAME="m_cFramesDropped">m_cFramesDropped</A></B>
 </TD><TD>Cumulative frames that have been dropped in the renderer since streaming started.
 Frames can also be dropped upstream without the renderer recognizing them.



</TD></TR><TR><TD><B><A NAME="m_idDecision">m_idDecision</A></B>
 </TD><TD>MSR_id.


 for the decision code of 
<A HREF="CBaseVideoRenderer.htm#ShouldDrawSampleNow">ShouldDrawSampleNow</A>.
</TD></TR><TR><TD><B><A NAME="m_idDuration">m_idDuration</A></B>
 </TD><TD>MSR_id for the duration of a frame.
</TD></TR><TR><TD><B><A NAME="m_idFrameAccuracy">m_idFrameAccuracy</A></B>
 </TD><TD>Performance log identifier for the time in milliseconds that the frame was late.
</TD></TR><TR><TD><B><A NAME="m_idFrameAvg">m_idFrameAvg</A></B>
 </TD><TD>Performance log identifier for the average frame time that is used for synchronization
and quality control.
</TD></TR><TR><TD><B><A NAME="m_idQualityRate">m_idQualityRate</A></B>
 </TD><TD>MSR_id for the quality rate requested.
</TD></TR><TR><TD><B><A NAME="m_idQualityTime">m_idQualityTime</A></B>
 </TD><TD>MSR_id for the quality time requested.
</TD></TR><TR><TD><B><A NAME="m_idRenderAvg">m_idRenderAvg</A></B>
 </TD><TD>Performance log identifier for the average renderer time recorded.
</TD></TR><TR><TD><B><A NAME="m_idSchLateTime">m_idSchLateTime</A></B>
 </TD><TD>MSR_id for how late the frame was when scheduled.
</TD></TR><TR><TD><B><A NAME="m_idSendQuality">m_idSendQuality</A></B>
 </TD><TD>MSR_id for timing the notifications (unused). 
</TD></TR><TR><TD><B><A NAME="m_idTimeStamp">m_idTimeStamp</A></B>
 </TD><TD>MSR_id for a frame <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#time_stamp')">time stamp</A>.
</TD></TR><TR><TD><B><A NAME="m_idWait">m_idWait</A></B>
 </TD><TD>Performance log identifier for the recorded wait time (unused). 
</TD></TR><TR><TD><B><A NAME="m_idWaitReal">m_idWaitReal</A></B>
 </TD><TD>Performance log identifier for the true wait time.
</TD></TR><TR><TD><B><A NAME="m_iSumFrameTime">m_iSumFrameTime</A></B>
 </TD><TD>Sum of the interframe times; needed for the property page.
</TD></TR><TR><TD><B><A NAME="m_iSumSqAcc">m_iSumSqAcc</A></B>
 </TD><TD>Sum of the squares of the accuracies (in milliseconds) needed for the property page.
</TD></TR><TR><TD><B><A NAME="m_iSumSqFrameTime">m_iSumSqFrameTime</A></B>
 </TD><TD>Sum of the squares of interframe times; needed for the property page.
</TD></TR><TR><TD><B><A NAME="m_iTotAcc">m_iTotAcc</A></B>
 </TD><TD>Sum of the accuracies (in milliseconds) needed for the property page.
</TD></TR><TR><TD><B><A NAME="m_nNormal">m_nNormal</A></B>
 </TD><TD>Number of consecutive frames drawn at their scheduled time.
A negative number indicates that a frame has just been dropped by the renderer.

</TD></TR><TR><TD><B><A NAME="m_trDuration">m_trDuration</A></B>
 </TD><TD>Duration of the last frame (difference between the start and end times).

</TD></TR><TR><TD><B><A NAME="m_trEarliness">m_trEarliness</A></B>
 </TD><TD>How early a frame is allowed to be played when a frame has just been dropped.
</TD></TR><TR><TD><B><A NAME="m_trFrame">m_trFrame</A></B>
 </TD><TD>Most recently recorded time between frames. Used in statistical measurements.

</TD></TR><TR><TD><B><A NAME="m_trFrameAvg">m_trFrameAvg</A></B>
 </TD><TD>Average interframe time in <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_time')">reference time</A> units.
</TD></TR><TR><TD><B><A NAME="m_trLastDraw">m_trLastDraw</A></B>
 </TD><TD>Time of previous frame. Used for interframe time references.

</TD></TR><TR><TD><B><A NAME="m_trLate">m_trLate</A></B>
 </TD><TD>Amount of time that the current frame was late. Used in statistical measurements.
</TD></TR><TR><TD><B><A NAME="m_trRenderAvg">m_trRenderAvg</A></B>
 </TD><TD>Time that frames are taking to perform the bit-block transfer.
</TD></TR><TR><TD><B><A NAME="m_trRenderLast">m_trRenderLast</A></B>
 </TD><TD>Time for the last frame bit-block transfer.
</TD></TR><TR><TD><B><A NAME="m_trRenderStart">m_trRenderStart</A></B>
 </TD><TD>Time the bit-block transfer started. Used to get <A HREF="CBaseVideoRenderer.htm#m_trRenderLast">m_trRenderLast</A>.
</TD></TR><TR><TD><B><A NAME="m_trThrottle">m_trThrottle</A></B>
 </TD><TD>Period to insert after rendering each frame, typically used when audio quality
has been increased and video performance must be decreased to allow this.


</TD></TR><TR><TD><B><A NAME="m_trWaitAvg">m_trWaitAvg</A></B>
 </TD><TD>Average wait time in reference time units.
</TD></TR><TR><TD><B><A NAME="m_tStreamingStart">m_tStreamingStart</A></B>
 </TD><TD>Used for property page statistics. Represents the start time of the current
 streaming process or the previous streaming process if not currently streaming.

</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Member_Functions"></A>Member Functions</P>

<TABLE><TR><TD><A HREF="CBaseVideoRenderer.htm#CBaseVideoRenderer_CBaseVideoRenderer">CBaseVideoRenderer</A>
 </TD><TD>Constructs a <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A> object.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#GetStdDev">GetStdDev</A>
 </TD><TD>Estimates the standard deviation in milliseconds between when each frame is due and when it is actually rendered, for per-frame statistics.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#PreparePerformanceData">PreparePerformanceData</A>
 </TD><TD>Sets the <A HREF="CBaseVideoRenderer.htm#m_trLate">m_trLate</A> and <A HREF="CBaseVideoRenderer.htm#m_trFrame">m_trFrame</A> values of the current frame.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#ThrottleWait">ThrottleWait</A>
 </TD><TD>Inserts a wait period after each frame.

</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Overridable_Member_F"></A>Overridable Member Functions</P>

<TABLE><TR><TD><A HREF="CBaseVideoRenderer.htm#JoinFilterGraph">JoinFilterGraph</A>
 </TD><TD>Sends <A HREF="../Event_Notification_Codes.htm#EC_WINDOW_DESTROYED">EC_WINDOW_DESTROYED</A> <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_E.htm#event_notification')">event notification</A> when filter is removed from the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A>.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#OnDirectRender">OnDirectRender</A>
 </TD><TD> Collects timing information that controls synchronization and quality control.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#OnRenderEnd">OnRenderEnd</A>
 </TD><TD>Records information for quality control and synchronization.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#OnRenderStart">OnRenderStart</A>
 </TD><TD>Records information for quality control and synchronization.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#OnStartStreaming">OnStartStreaming</A>
 </TD><TD>Resets all times that control streaming.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#OnStopStreaming">OnStopStreaming</A>
 </TD><TD>Called at the end of streaming to fix times for the property page report.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#OnWaitEnd">OnWaitEnd</A>
 </TD><TD>Called when a wait time ends. Performance logging only.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#OnWaitStart">OnWaitStart</A>
 </TD><TD>Updates times spent waiting and not waiting. Performance logging only.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#RecordFrameLateness">RecordFrameLateness</A>
 </TD><TD>Records how timely the rendering occurred and gathers statistics for the property page.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#ResetStreamingTimes">ResetStreamingTimes</A>
 </TD><TD>Resets all times that control the streaming.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#ScheduleSample">ScheduleSample</A>
 </TD><TD>Sets up an <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#advise')">advise</A> link with the clock.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#SendQuality">SendQuality</A>
 </TD><TD>Sends a quality message to indicate what the supplier should do about quality.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#ShouldDrawSampleNow">ShouldDrawSampleNow</A>
 </TD><TD>Determines if the video should be drawn when it is due, without setting a
timer <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#advise')">advise</A> link with the clock.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_IQualPro"></A>Implemented IQualProp Methods</P>
<TABLE><TR><TD><A HREF="CBaseVideoRenderer.htm#get_AvgFrameRate">get_AvgFrameRate</A>
 </TD><TD>Retrieves the average frame rate since streaming started in frames per 100 seconds.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#get_AvgSyncOffset">get_AvgSyncOffset</A>
 </TD><TD>Retrieves the average of the time in milliseconds between when each frame was due
and when it was actually rendered. This applies to all frames since streaming started.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#get_DevSyncOffset">get_DevSyncOffset</A>
 </TD><TD>Retrieves the standard deviation of the time in milliseconds between when
each frame was due and when it was actually rendered for all frames since streaming started.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#get_FramesDrawn">get_FramesDrawn</A>
 </TD><TD>Retrieves the number of frames drawn since streaming started.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#get_FramesDroppedInRenderer">get_FramesDroppedInRenderer</A>
 </TD><TD>Retrieves the number of frames dropped by the renderer. Frames can also be dropped
upstream.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#get_Jitter">get_Jitter</A>
 </TD><TD>Retrieves the standard deviation of the time in milliseconds between each frame and
the next. This applies to all frames since streaming started.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_INonDele"></A>Implemented INonDelegatingUnknown Methods</P>

<TABLE><TR><TD><A HREF="CBaseVideoRenderer.htm#NonDelegatingQueryInterface">NonDelegatingQueryInterface</A>
 </TD><TD>Provides access to other interfaces, particularly the property page.
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_IQuality"></A>Implemented IQualityControl Methods</P>

<TABLE><TR><TD><A HREF="CBaseVideoRenderer.htm#Notify">Notify</A>
 </TD><TD>Notifies the recipient that a quality change is requested.
</TD></TR><TR><TD><A HREF="CBaseVideoRenderer.htm#SetSink">SetSink</A>
 </TD><TD>Sets the <A HREF="../iface/IQualityControl.htm">IQualityControl</A> object that will receive quality messages.
</TD></TR></TABLE>



<H1><A NAME="CBaseVideoRenderer_CBaseVideoRenderer">CBaseVideoRenderer::CBaseVideoRenderer</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Constructs a <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A> object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CBaseVideoRenderer</B><B>(</B><BR>&nbsp;&nbsp;<B>REFCLSID</B> <I>RenderClass</I><B>,</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <I>*phr</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>RenderClass</I>
 </DT><DD>Class identifier for this renderer.
</DD><DT><I>pName</I>
 </DT><DD>Description used for debugging purposes.
</DD><DT><I>pUnk</I>
 </DT><DD>Pointer to the aggregated owner object.
</DD><DT><I>phr</I>
 </DT><DD>Pointer to an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>


<H1><A NAME="get_AvgFrameRate">CBaseVideoRenderer::get_AvgFrameRate</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Calculates and retrieves the average frame rate achieved.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_AvgFrameRate</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>*piAvgFrameRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>piAvgFrameRate</I>
 </DT><DD>Number of frames per second since streaming began.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IQualProp.htm#get_AvgFrameRate">IQualProp::get_AvgFrameRate</A> method.
</BLOCKQUOTE>


<H1><A NAME="get_AvgSyncOffset">CBaseVideoRenderer::get_AvgSyncOffset</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Retrieves the average of the time in milliseconds between when
each frame was due and when it was actually rendered for all frames since streaming started.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_AvgSyncOffset</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>*piAvg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>piAvg</I>
 </DT><DD>Pointer to the average of the time as previously described.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IQualProp.htm#get_AvgSyncOffset">IQualProp::get_AvgSyncOffset</A> method.
</BLOCKQUOTE>


<H1><A NAME="get_DevSyncOffset">CBaseVideoRenderer::get_DevSyncOffset</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Retrieves the standard deviation of the time in milliseconds between when
each frame was due and when it was actually rendered, for all frames since streaming started.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_DevSyncOffset</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>*piDev</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>piDev</I>
 </DT><DD>Pointer to the standard deviation of the time as previously described.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IQualProp.htm#get_DevSyncOffset">IQualProp::get_DevSyncOffset</A> method.
</BLOCKQUOTE>


<H1><A NAME="get_FramesDrawn">CBaseVideoRenderer::get_FramesDrawn</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Retrieves the <A HREF="CBaseVideoRenderer.htm#m_cFramesDrawn">m_cFramesDrawn</A> member variable, giving the number of frames
drawn since streaming started.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_FramesDrawn</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>*pcFramesDrawn</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pcFramesDrawn</I>
 </DT><DD>Number of frames drawn.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IQualProp.htm#get_FramesDrawn">IQualProp::get_FramesDrawn</A> method.
</BLOCKQUOTE>


<H1><A NAME="get_FramesDroppedInRenderer">CBaseVideoRenderer::get_FramesDroppedInRenderer</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Retrieves the number of frames dropped by the renderer.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_FramesDroppedInRenderer</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>*pcFramesDropped</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pcFramesDropped</I>
 </DT><DD>Number of frames dropped.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IQualProp.htm#get_FramesDroppedInRenderer">IQualProp::get_FramesDroppedInRenderer</A>
method. This is how the property page retrieves the data from the scheduler.
Note that frames can also be dropped upstream without the renderer even seeing them.
</BLOCKQUOTE>


<H1><A NAME="get_Jitter">CBaseVideoRenderer::get_Jitter</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Retrieves the standard deviation of time in milliseconds between each frame and the next
for all frames since streaming started.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_Jitter</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>*piJitter</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>piJitter</I>
 </DT><DD>Standard deviation of the interframe time in milliseconds.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IQualProp.htm#get_Jitter">IQualProp::get_Jitter</A> method.
</BLOCKQUOTE>


<H1><A NAME="GetStdDev">CBaseVideoRenderer::GetStdDev</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Estimates the standard deviation in milliseconds between when each frame is due and when it is actually rendered, for per-frame statistics.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetStdDev</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>nSamples</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>*piResult</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <I>llSumSq</I><B>,</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <I>iTot</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>nSamples</I>
 </DT><DD>Integer value that contains the number of video samples received by the video renderer.
</DD><DT><I>piResult</I>
 </DT><DD>Pointer to an integer value that will contain the standard deviation.
</DD><DT><I>llSumSq</I>
 </DT><DD>Value that represents the standard deviation, in milliseconds, of all rendered video samples. The lower the value, the more consistent the rendering.
</DD><DT><I>iTot</I>
 </DT><DD>Value that represents the mean value, in milliseconds, between the stamped time and rendered time for all rendered video samples.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR.

</BLOCKQUOTE>


<H1><A NAME="JoinFilterGraph">CBaseVideoRenderer::JoinFilterGraph</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Sends <A HREF="../Event_Notification_Codes.htm#EC_WINDOW_DESTROYED">EC_WINDOW_DESTROYED</A> event notification when a filter is removed from the filter graph.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>JoinFilterGraph</B><B>(</B><BR>&nbsp;&nbsp;<B>IBaseFilterGraph</B> <B>*</B> <I>pGraph</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pName</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pGraph</I>
</DT><DD>Pointer to the filter graph to join.
</DD><DT><I>pName</I>
</DT><DD>[in, string] Name of the filter being added.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function overrides the <A HREF="CBaseFilter.htm#JoinFilterGraph">CBaseFilter::JoinFilterGraph</A>
member function. If this function determines that the filter is being notified
that it is leaving the filter graph (<I>pGraph</I> is null, but <A HREF="CBaseFilter.htm#CBaseFilter::m_pGraph">m_pGraph</A> is not),
it sends an <A HREF="../Event_Notification_Codes.htm#EC_WINDOW_DESTROYED">EC_WINDOW_DESTROYED</A> event notification so that the resource manager does
not hold on to the renderer as a focus object.
</BLOCKQUOTE>


<H1><A NAME="NonDelegatingQueryInterface">CBaseVideoRenderer::NonDelegatingQueryInterface</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Returns an interface and increments the reference count.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>NonDelegatingQueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>VOID</B> <I>**ppv</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>riid</I>
 </DT><DD>Reference identifier.
</DD><DT><I>ppv</I>
 </DT><DD>Pointer to the interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_POINTER if <I>ppv</I> is invalid. Returns NOERROR if the query is successful or E_NOINTERFACE if it is not. 

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Override this member function to publish the interface.

<P>This member function implements the
<A HREF="../utilfunct/INonDelegatingUnknown_iface.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingQueryInterface</A> method.
It exposes the <A HREF="../iface/IQualProp.htm">IQualProp</A> interface and then calls
<A HREF="CBaseRenderer.htm#NonDelegatingQueryInterface">CBaseRenderer::NonDelegatingQueryInterface</A>
to expose interfaces implemented in the base classes.
</BLOCKQUOTE>


<H1><A NAME="Notify">CBaseVideoRenderer::Notify</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Receives a notification that a quality change is requested.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Notify</B><B>(</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <B>*</B> <I>pSelf</I><B>,</B><BR>&nbsp;&nbsp;<B>Quality</B> <I>q</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSelf</I>
 </DT><DD>[in] Pointer to the filter that is sending the quality notification.
</DD><DT><I>q</I>
 </DT><DD>[in] Quality notification structure.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IQualityControl.htm#Notify">IQualityControl::Notify</A>
method on the video renderer. This is called, typically by the filter
graph manager, when the quality must be cut back. This might occur
when the quality of audio playback has been increased to the point that
the video playback quality must be decreased.

<P><B>Notify</B> sets the
<A HREF="CBaseVideoRenderer.htm#m_trThrottle">m_trThrottle</A> data member to a delay value to be inserted between
frames by <A HREF="CBaseVideoRenderer.htm#ThrottleWait">ThrottleWait</A>.
</BLOCKQUOTE>


<H1><A NAME="OnDirectRender">CBaseVideoRenderer::OnDirectRender</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Collects timing information that controls synchronization and quality control.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>void</B> <B>OnDirectRender</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaSample</B> <I>*pMediaSample</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pMediaSample</I>
 </DT><DD>Media sample.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Call this member function instead of
<A HREF="CBaseVideoRenderer.htm#OnRenderStart">OnRenderStart</A> and
<A HREF="CBaseVideoRenderer.htm#OnRenderEnd">OnRenderEnd</A>. This is used by
the Microsoft&#174; DirectDraw&#174; video renderer.
</BLOCKQUOTE>


<H1><A NAME="OnRenderEnd">CBaseVideoRenderer::OnRenderEnd</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Performs smoothing for cases where the rendering time varies due to interruptions.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>OnRenderEnd</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaSample</B> <I>*pMediaSample</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pMediaSample</I>
 </DT><DD>Media sample.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function should be called just after drawing an image.

<P>This member function overrides <A HREF="CBaseRenderer.htm#OnRenderEnd">CBaseRenderer::OnRenderEnd</A>.
</BLOCKQUOTE>


<H1><A NAME="OnRenderStart">CBaseVideoRenderer::OnRenderStart</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Sets information for rendering.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>OnRenderStart</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaSample</B> <I>*pMediaSample</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pMediaSample</I>
 </DT><DD>Media sample.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function retrieves the current clock time from the system and
stores it in a member variable to be used when the drawing is complete. The
function also performs performance logging. This member function should be called just
before drawing starts.

<P>This member function overrides <A HREF="CBaseRenderer.htm#OnRenderStart">CBaseRenderer::OnRenderStart</A>.
</BLOCKQUOTE>


<H1><A NAME="OnStartStreaming">CBaseVideoRenderer::OnStartStreaming</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Resets all times that control streaming.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>OnStartStreaming</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function overrides <A HREF="CBaseRenderer.htm#OnStartStreaming">CBaseRenderer::OnStartStreaming</A>.
</BLOCKQUOTE>


<H1><A NAME="OnStopStreaming">CBaseVideoRenderer::OnStopStreaming</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Called at the end of streaming to fix times for the property page report.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>OnStopStreaming</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called twice, once when pausing and again
when the stream is actually stopped.

<P>This member function overrides <A HREF="CBaseRenderer.htm#OnStopStreaming">CBaseRenderer::OnStopStreaming</A>.
</BLOCKQUOTE>


<H1><A NAME="OnWaitEnd">CBaseVideoRenderer::OnWaitEnd</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Called when a wait time ends.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>OnWaitEnd</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function does only performance logging.
It is called when the thread is awoken from waiting
in the window, or when the next sample is due to be rendered.
It could eventually be used to gather information that controls synchronization.
</BLOCKQUOTE>


<H1><A NAME="OnWaitStart">CBaseVideoRenderer::OnWaitStart</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Updates times spent waiting and not waiting.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>OnWaitStart</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called when starting to wait for a rendering event. It
is used only for performance measurements.

</BLOCKQUOTE>


<H1><A NAME="PreparePerformanceData">CBaseVideoRenderer::PreparePerformanceData</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Sets the <A HREF="CBaseVideoRenderer.htm#m_trLate">m_trLate</A> and <A HREF="CBaseVideoRenderer.htm#m_trFrame">m_trFrame</A> values of the current frame.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>PreparePerformanceData</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>trLate</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>trFrame</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>trLate</I>
 </DT><DD>How late the sample was beyond its due time, in reference time units.
</DD><DT><I>trFrame</I>
 </DT><DD>Interframe time, in reference time units.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function sets <A HREF="CBaseVideoRenderer.htm#m_trLate">m_trLate</A> to the value of <I>trLate</I> and
<A HREF="CBaseVideoRenderer.htm#m_trFrame">m_trFrame</A> to the value of <I>trFrame</I>.

<P>When the <A HREF="CBaseVideoRenderer.htm#RecordFrameLateness">CBaseVideoRenderer::RecordFrameLateness</A> member function is called
from either <A HREF="CBaseVideoRenderer.htm#OnRenderStart">CBaseVideoRenderer::OnRenderStart</A> or
<A HREF="CBaseVideoRenderer.htm#OnDirectRender">CBaseVideoRenderer::OnDirectRender</A>, it passes the values of <A HREF="CBaseVideoRenderer.htm#m_trLate">m_trLate</A>
and <A HREF="CBaseVideoRenderer.htm#m_trFrame">m_trFrame</A> for it to update the statistics.
<B>PreparePerformanceData</B> is called from <A HREF="CBaseVideoRenderer.htm#OnWaitEnd">CBaseVideoRenderer::OnWaitEnd</A>
to set these data member values.
</BLOCKQUOTE>


<H1><A NAME="RecordFrameLateness">CBaseVideoRenderer::RecordFrameLateness</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Records how timely the rendering occurred and gathers statistics for the property page.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>void</B> <B>RecordFrameLateness</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>trLate</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>trFrame</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>trLate</I>
 </DT><DD>How late the sample was beyond its due time, in reference time units.
</DD><DT><I>trFrame</I>
 </DT><DD>Interframe time, in reference time units.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>


<H1><A NAME="ResetStreamingTimes">CBaseVideoRenderer::ResetStreamingTimes</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Resets all times that control the streaming.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>ResetStreamingTimes</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The times are set so that frames will not be initially dropped and so that
the first frame will be drawn.
</BLOCKQUOTE>


<H1><A NAME="ScheduleSample">CBaseVideoRenderer::ScheduleSample</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Overrides the base class that does the main work to keep a count of
samples drawn and dropped (which are used by the <A HREF="../iface/IQualProp.htm">IQualProp</A> implementation).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>BOOL</B> <B>ScheduleSample</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaSample</B> <I>*pMediaSample</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pMediaSample</I>
 </DT><DD>Media sample.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns TRUE if the sample is scheduled; otherwise, returns FALSE. 
</BLOCKQUOTE>


<H1><A NAME="SendQuality">CBaseVideoRenderer::SendQuality</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Sends a quality message to indicate what the supplier should do about quality.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>SendQuality</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>trLate</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>trRealStream</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>trLate</I>
 </DT><DD>Amount of time by which the frame is late.
</DD><DT><I>trRealStream</I>
</DT><DD>Current <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#stream_time')">stream time</A>.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function sends a quality control message upstream to control quality
management. The nature of the quality message (that is, whether to reduce or increase the number
of samples) is determined in the quality management implementation in this
derived class (see <A HREF="CBaseVideoRenderer.htm#ShouldDrawSampleNow">CBaseVideoRenderer::ShouldDrawSampleNow</A>).
</BLOCKQUOTE>


<H1><A NAME="SetSink">CBaseVideoRenderer::SetSink</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Sets the <A HREF="../iface/IQualityControl.htm">IQualityControl</A> object that will receive quality messages.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetSink</B><B>(</B><BR>&nbsp;&nbsp;<B>IQualityControl</B> <I>*piqc</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>piqc</I>
</DT><DD>Pointer to the <A HREF="../iface/IQualityControl.htm">IQualityControl</A> object to which the notifications should be sent.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IQualityControl.htm#SetSink">IQualityControl::SetSink</A>
method on the video renderer. 
</BLOCKQUOTE>


<H1><A NAME="ShouldDrawSampleNow">CBaseVideoRenderer::ShouldDrawSampleNow</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Determines if the video should be drawn without setting a timer advise
link with the clock.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>ShouldDrawSampleNow</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaSample</B> <I>*pMediaSample</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>*ptrStart</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>*ptrEnd</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pMediaSample</I>
 </DT><DD><A HREF="../iface/IMediaSample.htm">IMediaSample</A> interface for the sample.
</DD><DT><I>ptrStart</I>
 </DT><DD>Time to begin rendering.
</DD><DT><I>ptrEnd</I>
 </DT><DD>Time to stop rendering.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.
Returns S_OK to mean draw at once without waiting,
S_FALSE to mean draw at time <I>ptrStart</I>, or
error to mean do not draw the sample; that is, skip it to save time.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function overrides <A HREF="CBaseRenderer.htm#ShouldDrawSampleNow">CBaseRenderer::ShouldDrawSampleNow</A>.
</BLOCKQUOTE>


<H1><A NAME="ThrottleWait">CBaseVideoRenderer::ThrottleWait</A><HR size=1></H1>
<A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer Class</A>
<P>Inserts a wait period after each frame.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>ThrottleWait</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function waits for a time period obtained from the
<A HREF="CBaseVideoRenderer.htm#m_trThrottle">m_trThrottle</A> data member.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
