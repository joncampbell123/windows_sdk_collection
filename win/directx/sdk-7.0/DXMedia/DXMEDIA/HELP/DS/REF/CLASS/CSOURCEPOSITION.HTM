<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CSourcePosition Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CSourcePosition Class">
<META NAME="Description" CONTENT="ChangeRate (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::ChangeRate">
<META NAME="Description" CONTENT="ChangeStart (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::ChangeStart">
<META NAME="Description" CONTENT="ChangeStop (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::ChangeStop">
<META NAME="Description" CONTENT="CSourcePosition (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::CSourcePosition">
<META NAME="Description" CONTENT="get_CurrentPosition (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::get_CurrentPosition">
<META NAME="Description" CONTENT="get_Duration (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::get_Duration">
<META NAME="Description" CONTENT="get_PrerollTime (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::get_PrerollTime">
<META NAME="Description" CONTENT="get_Rate (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::get_Rate">
<META NAME="Description" CONTENT="get_StopTime (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::get_StopTime">
<META NAME="Description" CONTENT="put_CurrentPosition (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::put_CurrentPosition">
<META NAME="Description" CONTENT="put_PrerollTime (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::put_PrerollTime">
<META NAME="Description" CONTENT="put_Rate (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::put_Rate">
<META NAME="Description" CONTENT="put_StopTime (CSourcePosition)">
<META NAME="Description" CONTENT="CSourcePosition::put_StopTime">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CSourcePosition"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CSourcePosition Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CSourcePosition Class"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CSource.htm">CSource Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CSourceSeeking.htm">CSourceSeeking Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CSourcePosition Class</H1>

<P><IMG SRC="../../art/cutil10.gif" WIDTH="283" HEIGHT="201" ALT="CSourcePosition class hierarchy">

<P><B>CSourcePosition</B> is an abstract class that assists source <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> with
the implementation of <A HREF="../iface/IMediaPosition.htm">IMediaPosition</A> methods.

<P>Derive from this class and set the duration and default stop positions.
This class supports <A HREF="../iface/IMediaPosition.htm">IMediaPosition</A>, and calls the pure virtual member functions
<A HREF="CSourcePosition.htm#ChangeStart">CSourcePosition::ChangeStart</A>, <A HREF="CSourcePosition.htm#ChangeStop">CSourcePosition::ChangeStop</A>, and 
<A HREF="CSourcePosition.htm#ChangeRate">CSourcePosition::ChangeRate</A> when <A HREF="CSourcePosition.htm#put_CurrentPosition">CSourcePosition::put_CurrentPosition</A>, 
<A HREF="CSourcePosition.htm#put_StopTime">CSourcePosition::put_StopTime</A>, or <A HREF="CSourcePosition.htm#put_Rate">CSourcePosition::put_Rate</A> is called, 
to allow a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#source_filter')">source filter</A> to handle these commands and start sending new data. 

<P>Override the <A HREF="CSourcePosition.htm#ChangeStart">CSourcePosition::ChangeStart</A>, <A HREF="CSourcePosition.htm#ChangeStop">CSourcePosition::ChangeStop</A>, 
and <A HREF="CSourcePosition.htm#ChangeRate">CSourcePosition::ChangeRate</A> member functions to do something when the 
properties change.

<A NAME="Protected_Data_Membe"></A><P CLASS="ref">Protected Data Members</P>
<TABLE><TR><TD><B><A NAME="m_Duration">m_Duration</A></B> </TD><TD>Duration of the stream.
</TD></TR><TR><TD><B><A NAME="m_pLock">m_pLock</A></B> </TD><TD>Pointer to a <A HREF="CCritSec.htm">CCritSec</A> object for locking.
</TD></TR><TR><TD><B><A NAME="m_Rate">m_Rate</A></B> </TD><TD>Sample rate.
</TD></TR><TR><TD><B><A NAME="m_Start">m_Start</A></B> </TD><TD>Start time.
</TD></TR><TR><TD><B><A NAME="m_Stop">m_Stop</A></B> </TD><TD>Stop time.
</TD></TR></TABLE>
<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>

<TABLE><TR><TD><A HREF="CSourcePosition.htm#CSourcePosition_CSourcePosition">CSourcePosition</A>
 </TD><TD>Constructs a <A HREF="CSourcePosition.htm">CSourcePosition</A> object.
</TD></TR></TABLE>
<A NAME="Overridable_Member_F"></A><P CLASS="ref">Overridable Member Functions</P>

<TABLE><TR><TD><A HREF="CSourcePosition.htm#ChangeRate">ChangeRate</A>
 </TD><TD>Override this pure virtual to handle notification that the rate property has changed.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#ChangeStart">ChangeStart</A>
 </TD><TD>Override this pure virtual to handle notification that the start position property has changed.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#ChangeStop">ChangeStop</A>
 </TD><TD>Override this pure virtual to handle notification that the stop position property has changed.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Implemented_IMediaPo"></A>Implemented IMediaPosition Methods</P>
<TABLE><TR><TD><A HREF="CSourcePosition.htm#get_CurrentPosition">get_CurrentPosition</A>
 </TD><TD>Not currently implemented.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#get_Duration">get_Duration</A>
 </TD><TD>Retrieves the total duration of the media.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#get_PrerollTime">get_PrerollTime</A>
 </TD><TD>Not currently implemented.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#get_Rate">get_Rate</A>
 </TD><TD>Retrieves the playback rate, relative to normal playback of the media.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#get_StopTime">get_StopTime</A>
 </TD><TD>Retrieves the position within the media at which playback should stop.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#put_CurrentPosition">put_CurrentPosition</A>
 </TD><TD>Sets the position within the media at which playback should start.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#put_PrerollTime">put_PrerollTime</A>
 </TD><TD>Not currently implemented.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#put_Rate">put_Rate</A>
 </TD><TD>Sets the playback rate, relative to normal playback of the media.
</TD></TR><TR><TD><A HREF="CSourcePosition.htm#put_StopTime">put_StopTime</A>
 </TD><TD>Sets the position within the media at which playback should stop.
</TD></TR></TABLE>



<H1><A NAME="ChangeRate">CSourcePosition::ChangeRate</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Override this member function to handle notification of a change of sample rate.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>ChangeRate</B><B>(</B> <B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE><TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called when a change to the rate has been made by a call
to <A HREF="../iface/IMediaPosition.htm#put_Rate">IMediaPosition::put_Rate</A>. Override this and change the rate of 
data sent; typically, this will be by a call to 
<A HREF="CBaseInputPin.htm#BeginFlush">CBaseInputPin::BeginFlush</A> and <A HREF="CBaseInputPin.htm#EndFlush">CBaseInputPin::EndFlush</A>, and then 
sending samples marked with new <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#time_stamp')">time stamps</A>.
</BLOCKQUOTE>


<H1><A NAME="ChangeStart">CSourcePosition::ChangeStart</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Override this member function to handle notification of a change of start time.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>ChangeStart</B><B>(</B> <B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE><TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called when a new start position has been requested by a call
to <A HREF="../iface/IMediaPosition.htm#put_CurrentPosition">IMediaPosition::put_CurrentPosition</A>. Override this and change the data sent;
typically, this will be by a call to <A HREF="CBaseInputPin.htm#BeginFlush">CBaseInputPin::BeginFlush</A> and 
<A HREF="CBaseInputPin.htm#EndFlush">CBaseInputPin::EndFlush</A>, and then sending samples marked with new time stamps.
</BLOCKQUOTE>


<H1><A NAME="ChangeStop">CSourcePosition::ChangeStop</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Override this member function to handle notification of a change in stop time.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>ChangeStop</B><B>(</B> <B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation. <B>HRESULT</B> can be one of the following standard constants, or other values not listed.
<TABLE><TR><TD>E_FAIL </TD><TD>Failure.
</TD></TR><TR><TD>E_POINTER </TD><TD>Null pointer argument.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>Invalid argument.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>Method isn't supported.
</TD></TR><TR><TD>S_OK or NOERROR </TD><TD>Success.
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is called when a change to the stop position has been made by a call
to <A HREF="../iface/IMediaPosition.htm#put_StopTime">IMediaPosition::put_StopTime</A>. Override this and ensure that the correct stop
time is being observed; typically, this will be a call to <A HREF="CBaseInputPin.htm#BeginFlush">CBaseInputPin::BeginFlush</A> and 
<A HREF="CBaseInputPin.htm#EndFlush">CBaseInputPin::EndFlush</A>, and then resending data.
</BLOCKQUOTE>


<H1><A NAME="CSourcePosition_CSourcePosition">CSourcePosition::CSourcePosition</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Constructs a <A HREF="CSourcePosition.htm">CSourcePosition</A> object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CSourcePosition</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>TCHAR</B> <B>*</B> <I>pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <B>*</B> <I>phr</I><B>,</B><BR>&nbsp;&nbsp;<B>CCritSec</B> <B>*</B> <I>pLock</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pName</I>
 </DT><DD>Name of the object used in the <A HREF="CSourcePosition.htm">CSourcePosition</A> constructor for debugging purposes.
</DD><DT><I>pUnk</I>
 </DT><DD>Pointer to the owner of this object.
</DD><DT><I>phr</I>
 </DT><DD>Pointer to an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value for resulting information.
</DD><DT><I>pLock</I>
 </DT><DD>Pointer to a <A HREF="CCritSec.htm">CCritSec</A> object used for locking.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Allocate the <I>pName</I> parameter in static memory. This name appears on
the debugging terminal upon creation and deletion of the object.
</BLOCKQUOTE>


<H1><A NAME="get_CurrentPosition">CSourcePosition::get_CurrentPosition</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Currently not implemented.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_CurrentPosition</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME*</B> <I>pllTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pllTime</I>
 </DT><DD>Returned start time as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A> value in seconds.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_NOTIMPL.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Override this method if you can return the data you are actually working on. The start position is applied before the rate and therefore is the position at typical playback
speed.
</BLOCKQUOTE>


<H1><A NAME="get_Duration">CSourcePosition::get_Duration</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Retrieves the total duration of the media stream.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_Duration</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME*</B> <I>plength</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>plength</I>
 </DT><DD>Returned length of the media stream.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_POINTER if <I>pLength</I> is invalid. Otherwise, returns S_OK.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The duration assumes normal playback speed; it is therefore unaffected by the rate.
</BLOCKQUOTE>


<H1><A NAME="get_PrerollTime">CSourcePosition::get_PrerollTime</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Validates the pointer, but the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#preroll')">preroll</A> retrieval is not currently implemented.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_PrerollTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME*</B> <I>pllTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pllTime</I>
 </DT><DD>Returned <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#preroll_time')">preroll time</A> as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A> value in seconds.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_POINTER if <I>pllTime</I> is invalid. Otherwise, returns E_NOTIMPL.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Preroll time is the time prior to the start position at which nonrandom access
devices, such as tape players, should start rolling.
</BLOCKQUOTE>


<H1><A NAME="get_Rate">CSourcePosition::get_Rate</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Retrieves the rate of playback relative to normal playback speed.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_Rate</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <B>*</B> <I>pdRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pdRate</I>
</DT><DD>Returned rate.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_POINTER if <I>pdRate</I> is invalid. Otherwise, returns S_OK.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>A rate of 1.0 indicates normal playback speed. A rate of 0.5 indicates half
speed. A rate of &#150;1.0 indicates normal speed in reverse.

</BLOCKQUOTE>


<H1><A NAME="get_StopTime">CSourcePosition::get_StopTime</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Retrieves the time at which the media stream stops.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_StopTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME*</B> <I>pllTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pllTime</I>
 </DT><DD>Returned stop time as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A> value in seconds.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_POINTER if <I>pllTime</I> is invalid. Otherwise, returns S_OK.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The stop time is a position between zero and the duration of the media
at which playback should stop.

<P>The stop position is applied before the rate and therefore is the position at typical playback
speed.
</BLOCKQUOTE>


<H1><A NAME="put_CurrentPosition">CSourcePosition::put_CurrentPosition</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Sets the time within the media stream that playback should begin.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_CurrentPosition</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>llTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>llTime</I>
 </DT><DD>Start time expressed as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A> value in seconds.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value from the call to <A HREF="CSourcePosition.htm#ChangeStart">CSourcePosition::ChangeStart</A>.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The start time is a position between zero and the duration of the media
at which playback should begin when the next run command is issued.

<P>Setting the start position when paused causes playback to resume from the
new start position when the run command is issued.

<P>The start position is applied before the rate and therefore is the position at typical playback speed.
</BLOCKQUOTE>


<H1><A NAME="put_PrerollTime">CSourcePosition::put_PrerollTime</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Not currently implemented.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_PrerollTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>llTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>llTime</I>
</DT><DD>Preroll time to be set.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_NOTIMPL.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Preroll time is the time prior to the start position at which nonrandom access
devices, such as tape players, should start rolling.
</BLOCKQUOTE>


<H1><A NAME="put_Rate">CSourcePosition::put_Rate</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Sets the rate of playback relative to normal speed.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_Rate</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <I>dRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dRate</I>
</DT><DD>Rate to set.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value from the call to <A HREF="CSourcePosition.htm#ChangeRate">CSourcePosition::ChangeRate</A>.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This property allows an application to speed up or slow down playback relative
to the normal default playback speed. A rate of 1.0 indicates normal playback
speed. Specifying 2.0 causes playback at twice the normal rate: a video
created for 10 frames per second (fps) will be played back at 20 fps, if resources permit.
Audio streams played back at above-normal speed increase the pitch rather
than drop frames.

<P>Negative rates indicate reverse play. Not all media will support reverse play.
</BLOCKQUOTE>


<H1><A NAME="put_StopTime">CSourcePosition::put_StopTime</A><HR size=1></H1>
<A HREF="CSourcePosition.htm">CSourcePosition Class</A>
<P>Sets the time at which the media stream will stop.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_StopTime</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>llTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>llTime</I>
 </DT><DD>Stop time as a <A HREF="../../appendixes/Further_Reading.htm#double">double</A> value in seconds.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value from the call to <A HREF="CSourcePosition.htm#ChangeStop">CSourcePosition::ChangeStop</A>.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The stop time is a position between zero and the duration of the media
at which playback should stop.

<P>The stop position is applied before the rate and therefore is the position at typical playback speed.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
