<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>Summary of DirectShow COM Interfaces</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="Summary of DirectShow COM Interfaces">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="intrface"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="ifaces_intro.htm">DirectShow COM Interfaces</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="ifaces_by_category.htm">DirectShow Interfaces by Category</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>Summary of DirectShow COM Interfaces</H1>

<P>This article groups the Microsoft&#174; DirectShow&#153; interfaces according to the objects that expose them. It explains which object implements each interface and what is likely to call the interface <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">methods</A> implemented on each type of object. The information is presented as a series of tables of Component Object Model (COM) interfaces relating to each object, and so provides a summary and quick reference for understanding the DirectShow interfaces. 

<P>This article contains the following sections.
<UL>
<LI><A HREF="Summary_ifaces.htm#intrface_1">Introducing the DirectShow COM Interfaces</A>
<LI><A HREF="Summary_ifaces.htm#intrface_10">Interfaces on a Typical Filter Graph</A>
</UL>

<H2><A NAME="intrface_1" IDX_CONCEPT="noindex; COM Interfaces in DirectShow, Introducing">Introducing the DirectShow COM Interfaces</A></H2>
<P>The DirectShow COM interfaces comprise the schematic of an architecture for streaming time-stamped media. The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A>, through which media flows, is composed of objects, such as <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A>, pins, media samples, allocators, and enumerators, that work together. COM interfaces are implemented on these objects and are called by other objects with which they interact. The filter is the only filter graph COM object that has a CLSID; all other objects in the filter graph support COM interfaces, and are created as needed by the filter. Filters and their supporting object must implement their COM interfaces and a class library is available for help in that task. The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A>, on the other hand, has a CLSID and supports several fully implemented interfaces, as do <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#plug_in_distributor')">plug-in distributors</A>, which are aggregated by the filter graph manager. (Microsoft-provided plug-in distributors are referred to as the filter graph manager in this article.) 

<P>This section contains the following topics.
<UL>
<LI><A HREF="Summary_ifaces.htm#intrface_2">Filter Graph Manager Interfaces</A>
<LI><A HREF="Summary_ifaces.htm#intrface_3">Filter and Pin Interfaces</A>
<LI><A HREF="Summary_ifaces.htm#intrface_6">Media Sample and Enumerator Interfaces</A>
<LI><A HREF="Summary_ifaces.htm#intrface_9">Control Interfaces</A>
</UL>

<P>The DirectShow COM interfaces can be categorized as follows:
<UL>
<LI>Filter graph manager interfaces, which are fully implemented and used by applications to create, connect, and control filter graphs and by filters within the filter graph to post <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_E.htm#event_notification')">event notifications</A> and to force reconnections when needed. 
<LI>Filter and <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> interfaces, which must be implemented by the filter. They comprise the methods exposed by filters for communicating with the filter graph manager, connecting with other filters, passing data downstream (from <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#source_filter')">source filter</A> to <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> filter) and passing quality control and media positioning information upstream (from renderer to source).
<LI>Enumerator and media sample interfaces, which are interfaces on objects created temporarily 
for passing information.
<LI>Control interfaces, which are exposed by filters and the filter graph manager to enable the 
starting, stopping, and positioning of media in the stream. The control interfaces on the filters 
must be implemented when writing a filter, whereas they are already implemented on the filter graph manager.
</UL>

<H3><A NAME="intrface_2">Filter Graph Manager Interfaces</A></H3>
<P>Most filter graph manager interfaces fall in the category of control interfaces, also listed separately in this article; however, some are unique to the filter graph manager.

<TABLE>
<TR><TH>Interface</TH><TH>What calls methods</TH><TH>What methods do</TH><TH>Comments</TH></TR>

<TR><TD><A HREF="IAMClockAdjust.htm">IAMClockAdjust</A>
</TD>
<TD>Application.
</TD>
<TD>Gives timing information from an external source to the filter graph. 
</TD>
<TD>Implemented in <A HREF="../../mms/IAMMultimediaStream.htm">IAMMultiMediaStream</A> and by the default clock object. 
</TD></TR>

<TR><TD><A HREF="IAMCollection.htm">IAMCollection</A>
</TD>
<TD>An Automation client such as Microsoft&#174; Visual Basic&#174;.
</TD>
<TD>Retrieve the number of items in the collection and retrieve an indexed item.
</TD>
<TD>Implemented by the filter graph manager. Not used by C or C++ applications.
</TD></TR>

<TR><TD><A HREF="../../mms/IAMMultimediaStream.htm">IAMMultimediaStream</A>
</TD>
<TD>Application.</TD>
<TD>Exposes Microsoft&#174; DirectShow&#153; functionality to multimedia stream developers. You can use its methods to automatically generate <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graphs</A>, open files or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#moniker')">monikers</A> for playback or capture of incoming data, and render a given filter graph.</TD>
<TD> </TD>
</TR>

<TR><TD><A HREF="IDeferredCommand.htm">IDeferredCommand</A></TD>
<TD>The application that sent a deferred command using <A HREF="IQueueCommand.htm">IQueueCommand</A>.
</TD>
<TD>Retrieve confidence information, postpone or cancel a deferred command, and return <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> values from an invoked command.</TD>
<TD>Implemented by the filter graph manager and returned to any application that calls <A HREF="IQueueCommand.htm">IQueueCommand</A> methods.</TD>
</TR>

<TR><TD><A HREF="IEnumFilters.htm">IEnumFilters</A>
</TD>
<TD>Application or possibly a filter that needs to know what other filters are in the graph.
</TD>
<TD>Retrieve filters, skip filters, or clone the enumerator.
</TD>
<TD>Implemented in the filter graph manager.
</TD>
</TR>

<TR><TD><A HREF="IEnumRegFilters.htm">IEnumRegFilters</A>
</TD>
<TD>Filter mapper.
</TD>
<TD>Retrieve filters, skip items, or clone the enumerator.
</TD>
<TD>Implemented by the filter graph manager.
</TD>
</TR>

<TR><TD><A HREF="IFilterGraph.htm">IFilterGraph</A>
</TD>
<TD>Not usually called directly.
</TD>
<TD>Add, connect, and reconnect filters in a filter graph.
</TD>
<TD>Use <A HREF="IGraphBuilder.htm">IGraphBuilder</A> instead, because it inherits from this interface.
</TD>
</TR>

<TR><TD><A HREF="IFilterGraph2.htm">IFilterGraph2</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Extend filter graph functionality.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IFilterInfo.htm">IFilterInfo</A>
</TD>
<TD>An Automation client such as Visual Basic.
</TD>
<TD>Retrieve name, vendor information, <A HREF="IBaseFilter.htm">IBaseFilter</A> interface, file name (for source filters), specified pin object, or collection of associated pin objects. 
</TD>
<TD>Implemented by the filter graph manager. Not used by C or C++ applications.
</TD>
</TR>

<TR><TD><A HREF="IGraphBuilder.htm">IGraphBuilder</A>
</TD>
<TD>Application.
</TD>
<TD>Create filter graphs dynamically from stream media type or re-create stored filter graph. 
</TD>
<TD>Inherits from <A HREF="IFilterGraph.htm">IFilterGraph</A>. Also uses a filter mapper object to look up filters in the registry.
</TD>
</TR>

<TR><TD><A HREF="IGraphVersion.htm">IGraphVersion</A>
</TD>
<TD>Application and plug-in distributors in the filter graph manager.
</TD>
<TD>Retrieve the current filter graph version and determine when a filter graph has had filters added, deleted, or reconnected.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IMediaControl.htm">IMediaControl</A>
</TD>
<TD>Application.
</TD>
<TD>Run, pause, and stop the filter graph, and retrieve the state.
</TD>
<TD>Has many of the same methods as the <A HREF="IMediaFilter.htm">IMediaFilter</A> interface, which is implemented on filters.
</TD>
</TR>

<TR><TD><A HREF="IMediaEvent.htm">IMediaEvent</A>
</TD>
<TD>Applications that need to retrieve events passed to the filter graph manager from filters.
</TD>
<TD>Get events, get event handles, block until completion, and block or unblock default handling of events by the filter graph manager.
</TD>
<TD>Implemented by the filter graph manager.
</TD>
</TR>

<TR><TD><A HREF="IMediaEventSink.htm">IMediaEventSink</A>
</TD>
<TD>Filters that need to pass events to the application.
</TD>
<TD>Receive event notifications from filters.
</TD>
<TD>Implemented by the filter graph manager.
</TD>
</TR>

<TR><TD><A HREF="IMediaPosition.htm">IMediaPosition</A>
</TD>
<TD>Applications.
</TD>
<TD>Get duration and position properties, and get and set start time, stop time, <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#preroll_time')">preroll time</A>, and rate properties.
</TD>
<TD>Implemented on the filter graph manager and also on filters.
</TD>
</TR>

<TR><TD><A HREF="IMediaSeeking.htm">IMediaSeeking</A>
</TD>
<TD>Applications.
</TD>
<TD>Set and retrieve current position and stop position in units other than time (such as sample or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#field')">field</A>).
</TD>
<TD>Implemented on the filter graph manager and also on filters.
</TD>
</TR>

<TR><TD><A HREF="IMediaTypeInfo.htm">IMediaTypeInfo</A>
</TD>
<TD>An Automation client such as Visual Basic.
</TD>
<TD>Retrieve the major and minor media types. 
</TD>
<TD>Implemented by the filter graph manager. Not used by C or C++ applications.
</TD>
</TR>

<TR><TD><A HREF="IPinInfo.htm">IPinInfo</A>
</TD>
<TD>An Automation client such as Visual Basic.
</TD>
<TD>Retrieve pin information such as name, direction, connections, and collection of associated media type objects. Also includes methods to connect and disconnect pins.
</TD>
<TD>Implemented by the filter graph manager. Not used by C or C++ applications.
</TD>
</TR>

<TR><TD><A HREF="IQueueCommand.htm">IQueueCommand</A>
</TD>
<TD>Application needing to send a deferred command.
</TD>
<TD>Cue commands to run at <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#stream_time')">stream time</A> (offset from start) or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#presentation_time')">presentation time</A>.
</TD>
<TD>Implemented by the filter graph manager and used by applications. Filters can implement this.
</TD>
</TR>

<TR><TD><A HREF="IRegFilterInfo.htm">IRegFilterInfo</A>
</TD>
<TD>An Automation client such as Visual Basic.
</TD>
<TD>Retrieve a filter name and add it to the filter graph.
</TD>
<TD>Implemented by the filter graph manager. Not used by C or C++ applications.
</TD>
</TR>

<TR><TD><A HREF="ISeekingPassThru.htm">ISeekingPassThru</A>
</TD>
<TD>Applications.
</TD>
<TD>Instantiate and initialize a <A HREF="../class/CRendererPosPassThru.htm#CRendererPosPassThru">CRendererPosPassThru</A> object. You can use this object to keep track of <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_time')">reference times</A> and stream times.
</TD>
<TD>Implemented on video renderer filters that need to keep track of reference time and stream time. 
</TD>
</TR>

</TABLE>

<H3><A NAME="intrface_3">Filter and Pin Interfaces</A></H3>
<P>Filters are composed of one filter object and one or more pin objects. Although only the <A HREF="IUnknown.htm">IUnknown</A> and <A HREF="IBaseFilter.htm">IBaseFilter</A> interfaces are strictly required on a filter, filters can support other filter and pin interfaces, as discussed in <A HREF="Summary_ifaces.htm#intrface_4">Filter Interfaces</A>.

<P>This topic contains the following subtopics.
<UL>
<LI><A HREF="Summary_ifaces.htm#intrface_4">Filter Interfaces</A>
<LI><A HREF="Summary_ifaces.htm#intrface_5">Pin Interfaces</A>
</UL>

<H4><A NAME="intrface_4">Filter Interfaces</A></H4>
<P>The following interfaces are exposed by filter objects in order to be integrated with the filter graph manager. The filter is the main COM object and has a class ID (CLSID) and name registered in the registry. Filters must provide access to their pins and otherwise communicate with the filter graph. They must also allow the filter graph manager to manage the data flow by accepting state change messages.

<TABLE>
<TR><TH>Interface</TH><TH>What calls methods</TH><TH>What methods do</TH><TH>Comments</TH></TR>

<TR><TD><A HREF="IAMovieSetup.htm">IAMovieSetup</A>
</TD>
<TD>Entry-point routines in Dllentry.cpp.
</TD>
<TD>Register and unregister the object.
</TD>
<TD>This is implemented by the base classes for most of what is required to make a filter self-registrable. Need to override one base member function to provide setup structures.
</TD>
</TR>

<TR><TD><A HREF="IBaseFilter.htm">IBaseFilter</A>
</TD>
<TD>Filter graph manager.
</TD>
<TD>Same as <A HREF="IMediaFilter.htm">IMediaFilter</A> plus enumerate pins, retrieve filter and vendor information, and locate pins when rebuilding a persistent filter graph.
</TD>
<TD>Inherits methods from the <A HREF="IMediaFilter.htm">IMediaFilter</A> interface. Implemented by the <A HREF="../class/CBaseFilter.htm#CBaseFilter">CBaseFilter</A> class.
</TD>
</TR>

<TR><TD><A HREF="IMediaFilter.htm">IMediaFilter</A>
</TD>
<TD>Nothing directly.
</TD>
<TD>Put the filter in run, stop, or pause state, get and set the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#reference_clock')">reference clock</A>, and retrieve the filter state.
</TD>
<TD>Inherited by the <A HREF="IBaseFilter.htm">IBaseFilter</A> interface, which should be used instead of referencing this directly.
</TD>
</TR>

<TR><TD><A HREF="../../appendixes/Further_Reading.htm#IPersist">IPersist</A>
</TD>
<TD>Filter graph manager when loading pre configured filter graph files.
</TD>
<TD>Retrieve the filter's class identifier.
</TD>
<TD>Inherited by <A HREF="IBaseFilter.htm">IBaseFilter</A> along with <A HREF="IMediaFilter.htm">IMediaFilter</A>.
</TD>
</TR>

<TR><TD><A HREF="IUnknown.htm">IUnknown</A>
</TD>
<TD>Filter graph manager.
</TD>
<TD>Retrieve a pointer to the interface, add and delete references to the interface.
</TD>
<TD>Implemented by the <A HREF="../class/CUnknown.htm#CUnknown">CUnknown</A> base class.
</TD>
</TR>

</TABLE>
<P>The following additional filter interfaces can be exposed by filters such as source filters, and by video and audio renderers. Source filters are notified by means of a quality control mechanism so that they can adjust the amount of data introduced to the stream according to the renderer's performance. Audio renderers are usually called upon to provide a reference clock, since audio hardware generates this. The video renderer filter supplied by Microsoft exposes interfaces to 
handle both the video window and the transferring of video frames into video buffers.

<TABLE>
<TR><TH>Interface</TH><TH>What calls methods</TH><TH>What methods do</TH><TH>Comments</TH></TR>

<TR><TD><A HREF="IAMAnalogVideoDecoder.htm">IAMAnalogVideoDecoder</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Specify and retrieve information about the process of video digitization.
</TD>
<TD>
</TD>
</TR>

<TR><TD><A HREF="IAMCameraControl.htm">IAMCameraControl</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Control a camera. 
</TD>
<TD>
</TD>
</TR>

<TR><TD><A HREF="IAMCrossbar.htm">IAMCrossbar</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Route messages from an analog or digital audio or video source to a video capture filter.
</TD>
<TD>Exposed on analog video crossbar filters.
</TD>
</TR>

<TR><TD><A HREF="IAMExtDevice.htm">IAMExtDevice</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Control external devices.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IAMExtTransport.htm">IAMExtTransport</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Control specific behaviors of an external VCR. 
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IAMFilterMiscFlags.htm">IAMFilterMiscFlags</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Can be used as a definitive way to determine which filters are being used as renderer filters and, thus, how many <A HREF="../../ref/Event_Notification_Codes.htm#EC_COMPLETE">EC_COMPLETE</A> notifications to expect before a movie is done. 
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IAMParse.htm">IAMParse</A>
</TD>
<TD>Parser filters.
</TD>
<TD>Retrieve or set the current stream parse time or to clear the data buffer of its current data.
</TD>
<TD></TD>
</TR>


<TR><TD><A HREF="IAMTimecodeDisplay.htm">IAMTimecodeDisplay</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Define behavior of an external SMPTE/MIDI <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#timecode')">timecode</A> display device.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IAMTimecodeGenerator.htm">IAMTimecodeGenerator</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Specify how an external SMPTE/MIDI timecode generator should supply data to the filter graph, and the formats in which timecode should be supplied.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IAMTimecodeReader.htm">IAMTimecodeReader</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Specify the timecode format that an external device should read and how it is embedded in the media.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IAMTVTuner.htm">IAMTVTuner</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Enables applications to set TV transmission types.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IAMVideoControl.htm">IAMVideoControl</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Enables control of video mode of operation, including flipping the picture horizontally or vertically and enabling external triggers. Also retrieves the actual and maximum frame rates.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IAMVideoProcAmp.htm">IAMVideoProcAmp</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Control video quality settings.
</TD>
<TD>Exposed on WDM video capture filters.
</TD>
</TR>

<TR><TD><A HREF="IAsyncReader.htm">IAsyncReader</A>
</TD>
<TD>Downstream <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#parser_filter')">parser filter</A>.
</TD>
<TD>Perform synchronized reads, request data, request allocator, begin and end flushing, and retrieve file's total length.
</TD>
<TD>Implemented on the <A HREF="../../filtsamp/Source_Filters.htm#AsyncSample">Async Sample (Asynchronous Reader Filter)</A>, which reads media types with a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#major_type')">major type</A> of MEDIATYPE_Stream.
</TD>
</TR>

<TR><TD><A HREF="IBasicAudio.htm">IBasicAudio</A>
</TD>
<TD>Applications and Automation clients such as Visual Basic.
</TD>
<TD>Get and set the properties of the audio renderer filter.
</TD>
<TD>Can be implemented on an audio renderer filter. Supports Automation.
</TD>
</TR>

<TR><TD><A HREF="IBasicVideo.htm">IBasicVideo</A>
</TD>
<TD>Applications and Automation clients such as Visual Basic.
</TD>
<TD>Get and set the source video rectangle, and retrieve video size, palette values, and the current image.
</TD>
<TD>Usually implemented on a video renderer filter. Supports Automation.
</TD>
</TR>


<TR><TD><A HREF="IBasicVideo2.htm">IBasicVideo2</A>
</TD>
<TD>Applications and Automation clients such as Visual Basic.
</TD>
<TD>Same as <B>IBasicVideo</B>, along with the ability to retrieve the preferred video aspect ratio.
</TD>
<TD>Usually implemented on a video renderer filter. Supports Automation.
</TD>
</TR>


<TR><TD><A HREF="ICreateDevEnum.htm">ICreateDevEnum</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Enumerate hardware devices.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IDDrawExclModeVideo.htm">IDDrawExclModeVideo</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Enables games to play video while in Microsoft DirectDraw&reg; exclusive full-screen mode. For an example, see the DDRAWXCL sample in the Samples\Multimedia\DShow\src\DDrawXCL subdirectory.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IDDrawExclModeVideoCallback.htm">IDDrawExclModeVideoCallback</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Enables applications to get synchronous notification about changes to the overlay position, size, visibility, and so on, so that the application can adjust its video visibility, size, and position.</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IDirectDrawVideo.htm">IDirectDrawVideo</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Set and retrieve DirectDraw&#174; hardware and emulated capabilities and surface types.
</TD>
<TD>Usually implemented on a video renderer filter.
</TD>
</TR>

<TR><TD><A HREF="IFileSinkFilter.htm">IFileSinkFilter</A>
</TD>
<TD>Any application that needs to set the name of the file from which the file source filter will read. 
</TD>
<TD>Set or retrieve the file name.
</TD>
<TD>Implemented on a file writer filter, as used in a video capture filter graph.
</TD>
</TR>

<TR><TD><A HREF="IFileSinkFilter2.htm">IFileSinkFilter2</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Set or retrieve the file name, optionally overwriting an existing file.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IFileSourceFilter.htm">IFileSourceFilter</A>
</TD>
<TD>Any application that needs to set the name of the file into which the file sink filter will write. 
</TD>
<TD>Set or retrieve the file name.
</TD>
<TD>Implemented on any source filter that needs a file name from the user.
</TD>
</TR>

<TR><TD><A HREF="IFullScreenVideo.htm">IFullScreenVideo</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Set and retrieve full-screen modes, message drain, icon caption, and other information.
</TD>
<TD>Usually implemented on a video renderer filter.
</TD>
</TR>

<TR><TD><A HREF="IMediaPropertyBag.htm">IMediaPropertyBag</A>
</TD>
<TD>C or C++ applications.
</TD>
<TD>Expose copyright information on filters.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IMediaSample2.htm">IMediaSample2</A>
</TD>
<TD>Filters.
</TD>
<TD>Expose sample properties.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IOverlay.htm">IOverlay</A>
</TD>
<TD>Filters upstream from the renderer that need to be notified of window changes.
</TD>
<TD>Set and retrieve palette and color key information; get window handle, clip list, window position; set up <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#advise')">advise</A> link with <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_U.htm#upstream_filter')">upstream filter</A>.
</TD>
<TD>Usually implemented on a video renderer filter.
</TD>
</TR>

<TR><TD><A HREF="IQualityControl.htm">IQualityControl</A>
</TD>
<TD>Filter graph manager, upstream filter, or pin.
</TD>
<TD>Receive a quality message and receive the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_Q.htm#quality_sink')">quality sink</A> location.
</TD>
<TD>Normally implemented on filters that can affect the quality when they receive the message.
</TD>
</TR>

<TR><TD><A HREF="IQualProp.htm">IQualProp</A>
</TD>
<TD>Property page objects.
</TD>
<TD>Retrieve rendering quality properties of the video renderer, such as the number of frames drawn, jitter, and so on.
</TD>
<TD>Supports Automation.
</TD>
</TR>

<TR><TD><A HREF="IReferenceClock.htm">IReferenceClock</A>
</TD>
<TD>Filters that need to be synchronous with a reference clock.
</TD>
<TD>Register for time notifications from the filter, convert real to reference time, and retrieve the current time.
</TD>
<TD>Implemented on a filter that can generate a reference clock, typically an audio renderer. Provides services similar to the <A HREF="../../appendixes/Further_Reading.htm#timeBeginPeriod">timeBeginPeriod</A> and <A HREF="../../appendixes/Further_Reading.htm#timeSetEvent">timeSetEvent</A> Win32&#174; functions.
</TD>
</TR>

<TR><TD><A HREF="IVideoWindow.htm">IVideoWindow</A>
</TD>
<TD>Applications and Automation clients such as Visual Basic.
</TD>
<TD>Control the window aspects of a video renderer.
</TD>
<TD>Usually implemented on a video renderer filter.
</TD>
</TR>
</TABLE>

<P>DirectShow provides filters that implement particular interfaces for you. Applications typically use those interfaces, but filters do so as well.
<TABLE>
<TR><TH>Interface</TH><TH>What calls methods</TH><TH>What methods do</TH><TH>Comments</TH></TR>

<TR><TD><A HREF="IAMAudioCutListElement.htm">IAMAudioCutListElement</A>
</TD>
<TD>Applications and filters.
</TD>
<TD>Provide support for a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#cutlist_element')">cutlist element</A> for an audio file stream in a WAV or AVI file. 
</TD>
<TD>The <A HREF="../../appendixes/CLSIDs.htm#CLSID_AudioFileClip">CLSID_AudioFileClip</A> object implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IAMCutListElement.htm">IAMCutListElement</A>
</TD>
<TD>Filters.
</TD>
<TD>Describe a base object, which represents an element in a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#cutlist')">cutlist</A>.
</TD>
<TD>DirectShow provides the <A HREF="../../appendixes/CLSIDs.htm#CLSID_VideoFileClip">CLSID_VideoFileClip</A> and <A HREF="../../appendixes/CLSIDs.htm#CLSID_AudioFileClip">CLSID_AudioFileClip</A> objects, which can create an object that implements it for you.
</TD>
</TR>

<TR><TD><A HREF="IAMDirectSound.htm">IAMDirectSound</A>
</TD>
<TD>DirectSound audio renderer.
</TD>
<TD>Set and retrieve the window that will handle the sound playback.
</TD>
<TD>DirectSound audio renderer implements and uses this interface.
</TD>
</TR>

<TR><TD><A HREF="IAMFileCutListElement.htm">IAMFileCutListElement</A>
</TD>
<TD>Filters.
</TD>
<TD>Provide support for a cutlist element for a file stream.
</TD>
<TD>DirectShow provides the <A HREF="../../appendixes/CLSIDs.htm#CLSID_VideoFileClip">CLSID_VideoFileClip</A> and <A HREF="../../appendixes/CLSIDs.htm#CLSID_AudioFileClip">CLSID_AudioFileClip</A> objects that implement it for you. 
</TD>
</TR>

<TR><TD><A HREF="IAMVideoCutListElement.htm">IAMVideoCutListElement</A>
</TD>
<TD>Filters.
</TD>
<TD>Provide support for a cutlist element from an AVI video file stream. 
</TD>
<TD>DirectShow provides the <A HREF="../../appendixes/CLSIDs.htm#CLSID_VideoFileClip">CLSID_VideoFileClip</A> object that implements it for you.
</TD>
</TR>

<TR><TD><A HREF="IAMLine21Decoder.htm">IAMLine21Decoder</A>
</TD>
<TD>Applications or video mixer filter.
</TD>
<TD>Provide access to closed caption settings.
</TD>
<TD>Line 21 decoder implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IAMStreamSelect.htm">IAMStreamSelect</A>
</TD>
<TD>Applications.
</TD>
<TD>Control which logical streams are played and retrieve information about them. 
</TD>
<TD>The MPEG splitter implements this interface. 
</TD>
</TR>

<TR><TD><A HREF="IAMVfwCaptureDialogs.htm">IAMVfwCaptureDialogs</A>
</TD>
<TD>Applications.
</TD>
<TD>Provide access to dialog boxes exposed by Video for Windows capture drivers.
</TD>
<TD>Video for Windows capture filter implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IAMVfwCompressDialogs.htm">IAMVfwCompressDialogs</A>
</TD>
<TD>Applications.
</TD>
<TD>Provide access to dialog boxes exposed by Video for Windows compressors.
</TD>
<TD>Video for Windows video compression manager (VCM) filter implements this interface.
</TD>
</TR>

<TR><TD><A HREF="ICaptureGraphBuilder.htm">ICaptureGraphBuilder</A>
</TD>
<TD>Applications.
</TD>
<TD>Simplify building capture filter graphs.
</TD>
<TD>Capture graph builder object implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IConfigAviMux.htm">IConfigAviMux</A>
</TD>
<TD>Applications.
</TD>
<TD>Control how the AVI multiplexer filter writes files to disk.
</TD>
<TD>AVI multiplexer filter implements this interface on its property page.
</TD>
</TR>

<TR><TD><A HREF="IConfigInterleaving.htm">IConfigInterleaving</A>
</TD>
<TD>Applications.
</TD>
<TD>Control how the AVI multiplexer filter writes files to disk and set <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_I.htm#interleaving')">interleaving</A> configuration information.
</TD>
<TD>AVI multiplexer filter implements this interface on its property page.
</TD>
</TR>

<TR><TD><A HREF="ICutListGraphBuilder.htm">ICutListGraphBuilder</A>
</TD>
<TD>Applications.
</TD>
<TD>Enable you to easily implement one or more cutlist filter graphs.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IDvdControl.htm">IDvdControl</A>
</TD>
<TD>Applications.
</TD>
<TD>Control playback and searching on DVD discs.
</TD>
<TD>DVD navigator filter implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IDvdGraphBuilder.htm">IDvdGraphBuilder</A>
</TD>
<TD>Applications.
</TD>
<TD>Simplify building DVD filter graphs.
</TD>
<TD>DVD graph builder object implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IDvdInfo.htm">IDvdInfo</A>
</TD>
<TD>Applications.
</TD>
<TD>Query for DVD attributes and DVD player status.
</TD>
<TD>DVD navigator filter implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IFileClip.htm">IFileClip</A>
</TD>
<TD>Applications.
</TD>
<TD>Provide a simple way for an application to create one or more cuts from a single media file, or to create blank cuts.
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IStandardCutList.htm">IStandardCutList</A>
</TD>
<TD>Applications.
</TD>
<TD>Provide a simple way for an application to feed a cutlist into a cutlist provider (filter). 
</TD>
<TD></TD>
</TR>

<TR><TD><A HREF="IVPBaseConfig.htm">IVPBaseConfig</A>
</TD>
<TD>Video port mixer filter.
</TD>
<TD>Enable a video port (VP) mixer filter to communicate with a VP driver.
</TD>
<TD>Ksproxy filter implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IVPBaseNotify.htm">IVPBaseNotify</A>
</TD>
<TD>Applications.
</TD>
<TD>Control properties of a filter that uses a video port.
</TD>
<TD>Video port mixer filter implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IVPConfig.htm">IVPConfig</A>
</TD>
<TD>Video port mixer filter.
</TD>
<TD>Enable a video port (VP) mixer filter to communicate with a VP driver.
</TD>
<TD>Ksproxy filter implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IVPNotify.htm">IVPNotify</A>
</TD>
<TD>Applications.
</TD>
<TD>Control properties of a filter that uses a video port.
</TD>
<TD>Video port mixer filter implements this interface.
</TD>
</TR>

</TABLE>

<H4><A NAME="intrface_5"></A>Pin Interfaces</H4>
<P>Pin objects expose these interfaces. Pins do not usually have registered class identifiers and are usually created by the filter object on which they reside. They are exposed externally by the filter, which includes a method (<A HREF="IBaseFilter.htm#EnumPins">IBaseFilter::EnumPins</A>) to hand out pointers to the <A HREF="IPin.htm">IPin</A> interfaces of its pins, usually to the filter graph manager. The filter graph manager is responsible for connecting pins by calling an <B>IPin</B> method on one of the pins with a pointer to the other pin. Once pins are connected, each pin holds a pointer to the pin to which it is connected. 

<TABLE>
<TR><TH>Interface</TH><TH>What calls methods</TH><TH>What methods do</TH><TH>Comments</TH></TR>

<TR><TD><A HREF="IAMAudioInputMixer.htm">IAMAudioInputMixer</A>
</TD>
<TD>Applications.
</TD>
<TD>Adjust audio input characteristics.
</TD>
<TD><A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_I.htm#input_pin')">Input pin</A> of an audio capture filter typically implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IAMBufferNegotiation.htm">IAMBufferNegotiation</A>
</TD>
<TD>Applications.
</TD>
<TD>Set and retrieve buffer properties.
</TD>
<TD>The <A HREF="IAMBufferNegotiation.htm">IAMBufferNegotiation</A> interface informs a pin what kind of buffer specifications it should use when connected.
</TD>
</TR>

<TR><TD>
<A HREF="IAMDevMemoryAllocator.htm">IAMDevMemoryAllocator</A>
</TD>
<TD>Applications.
</TD>
<TD>Provide creation of third-party memory allocators.
</TD>
<TD>Makes use of on-board memory manager objects.
</TD>
</TR>

<TR><TD><A HREF="IAMDevMemoryControl.htm">IAMDevMemoryControl</A>
</TD>
<TD>Applications.
</TD>
<TD>Control and identify on-board <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#codec')">codec</A> memory.
</TD>
<TD>This interface is supported by a device memory control object.
</TD>
</TR>

<TR><TD><A HREF="IAMDroppedFrames.htm">IAMDroppedFrames</A>
</TD>
<TD>Applications.
</TD>
<TD>Provide information about the number of dropped frames, frame rate, and data rate.
</TD>
<TD>Capture filter's video <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pin</A> should implement this interface.
</TD>
</TR>

<TR><TD><A HREF="IAMStreamConfig.htm">IAMStreamConfig</A>
</TD>
<TD>Applications or filters.
</TD>
<TD>Provide types of formats an output pin can connect with.
</TD>
<TD>Output pins of capture and <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#compression_filter')">compression filters</A> typically implement this interface.
</TD>
</TR>

<TR><TD><A HREF="IAMStreamControl.htm">IAMStreamControl</A>
</TD>
<TD>Applications.
</TD>
<TD>Enable control of streams in a filter graph.
</TD>
<TD>Implemented by any input or output pins.
</TD>
</TR>

<TR><TD><A HREF="IAMVideoCompression.htm">IAMVideoCompression</A>
</TD>
<TD>Applications.
</TD>
<TD>Control compression parameters that aren't part of the media type.
</TD>
<TD>Output pin of a video capture or compression filter typically implements this interface.
</TD>
</TR>

<TR><TD><A HREF="IKsPropertySet.htm">IKsPropertySet</A>
</TD>
<TD>Applications or filters.
</TD>
<TD>Sets and retrieves device properties.
</TD>
<TD>Expose device properties and enable an application or filter to change the properties.
</TD>
</TR>

<TR><TD><A HREF="IMediaPosition.htm">IMediaPosition</A>
</TD>
<TD>Filter graph manager or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#downstream_filter')">downstream filter</A>.
</TD>
<TD>Get duration and position properties, and get and set start time, stop time, preroll time, and rate properties.
</TD>
<TD>Downstream filters call methods on output pins supporting this to pass a requested media position upstream. Implemented in <A HREF="../class/CPosPassThru.htm#CPosPassThru">CPosPassThru</A> on pins.
</TD>
</TR>

<TR><TD><A HREF="IMediaSeeking.htm">IMediaSeeking</A>
</TD>
<TD>Applications.
</TD>
<TD>Set and retrieve current position and stop position in units other than time (such as sample or field).
</TD>
<TD>Downstream filters call methods on output pins supporting this to pass a requested media position upstream. Implemented in <A HREF="../class/CPosPassThru.htm#CPosPassThru">CPosPassThru</A> on pins.
</TD>
</TR>

<TR><TD><A HREF="IMemAllocator.htm">IMemAllocator</A>
</TD>
<TD>Owning filter and output pin of connected filter.
</TD>
<TD>Allocate one or more buffers based on required size, retrieve a buffer for a media sample, commit memory when in use, and release it (decommit) when not in use.
</TD>
<TD>Appears on allocator object usually created by <A HREF="IMemInputPin.htm">IMemInputPin</A>. Implemented by the <A HREF="../class/CMemAllocator.htm#CMemAllocator">CMemAllocator</A> class.
</TD>
</TR>

<TR><TD><A HREF="IMemInputPin.htm">IMemInputPin</A>
</TD>
<TD>Filter graph manager, output pin of a connected filter.
</TD>
<TD>Retrieve a preferred allocator, receive the allocator provided by output pin, receive media samples, and tell whether the pin will block on receive.
</TD>
<TD>Usually only on input pins. Implemented by the <A HREF="../class/CBaseInputPin.htm#CBaseInputPin">CBaseInputPin</A> base class.
</TD>
</TR>

<TR><TD><A HREF="IPin.htm">IPin</A>
</TD>
<TD>Filter graph manager, other pins, the owning filter.
</TD>
<TD>Connect and disconnect the pin, retrieve information on external and internal pin connections, retrieve preferred media types enumerator, negotiate preferred media types, receive flush and end-of-stream notifications.
</TD>
<TD>Implemented on all pins by the <A HREF="../class/CBasePin.htm#CBasePin">CBasePin</A> base class.
</TD>
</TR>

<TR><TD><A HREF="IQualityControl.htm">IQualityControl</A>
</TD>
<TD>Downstream filter or pin on downstream filter.
</TD>
<TD>Receive a quality message and receive the quality sink to send quality messages to. 
</TD>
<TD>Implemented on output pins by the <A HREF="../class/CBaseOutputPin.htm#CBaseOutputPin">CBaseOutputPin</A> base class, where it is used to pass the message upstream.
</TD>
</TR>

<TR><TD><A HREF="IUnknown.htm">IUnknown</A>
</TD>
<TD>Filter graph manager, other pins, the owning filter.
</TD>
<TD>Retrieve a pointer to the interface, add and delete references to the interface.
</TD>
<TD>Implemented on all pins by the <A HREF="../class/CUnknown.htm#CUnknown">CUnknown</A> base class.
</TD>
</TR>

</TABLE>

<P>In addition, the Microsoft video renderer's input pin supports the <A HREF="IOverlay.htm">IOverlay</A> interface, which allows the connected upstream pin to effectively register its <A HREF="IOverlayNotify.htm">IOverlayNotify</A> interface in order to receive notifications of video window changes. Replacement video renderers can also implement this if they are intended to connect to the same filters as the video renderer provided with DirectShow.

<H3><A NAME="intrface_6">Media Sample and Enumerator Interfaces</A></H3>
<P>Media sample and enumerator interfaces are temporary objects created to pass information or data between objects. They do not have class identifiers.
<P>This topic contains the following subtopics.
<UL>
<LI><A HREF="Summary_ifaces.htm#intrface_7">Media Sample Interfaces</A>
<LI><A HREF="Summary_ifaces.htm#intrface_8">Enumerator Interfaces</A>
</UL>

<H4><A NAME="intrface_7">Media Sample Interfaces</A></H4>
<P>The media sample interface, <A HREF="IMediaSample.htm">IMediaSample</A>, is created from the memory allocator, which uses the media sample object as its unit of exchange. It has no class identifier. It is the unit of media data that is passed from one filter to the next via the memory allocator shared by two connected pins.

<TABLE>
<TR><TH>Interface</TH><TH>What calls methods</TH><TH>What methods do</TH><TH>Comments</TH></TR>

<TR><TD><A HREF="IMediaSample.htm">IMediaSample</A>
</TD>
<TD>Pins or filters that need to manipulate the media sample data or examine its properties.
</TD>
<TD>Retrieve a pointer to data, and get and set properties on the media sample such as buffer size, <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#time_stamp')">time stamp</A>, data length, type, synchronization point, <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#preroll')">preroll</A>, and end-of-stream properties.
</TD>
<TD>Implemented on media samples by the <A HREF="../class/CMediaSample.htm#CMediaSample">CMediaSample</A> base class.
</TD>
</TR>

<TR><TD><A HREF="IUnknown.htm">IUnknown</A>
</TD>
<TD>Pin or filter.
</TD>
<TD>Retrieve pointer to the interface, add and delete references to the interface.
</TD>
<TD>Implemented on media samples by the <A HREF="../class/CUnknown.htm#CUnknown">CUnknown</A> base class.
</TD>
</TR>
</TABLE>

<H4><A NAME="intrface_8">Enumerator Interfaces</A></H4>
<P>Enumerators in DirectShow are based on the COM <A HREF="../../appendixes/Further_Reading.htm#IEnumXXXX">IEnumXXXX</A> interfaces. They include the <B>Next</B> and <B>Prev</B> methods, which tell the enumerator what item or items to return; the <B>Skip</B> method, which skips one or more items; and the <B>Clone</B> method, which makes a copy of the enumerator. Enumerators are used to present lists of items such as filters in a filter graph, pins on a filter, or media types that are preferred by a pin.

<TABLE>
<TR><TH>Interface</TH><TH>What calls methods</TH><TH>What methods do</TH><TH>Comments</TH></TR>

<TR><TD><A HREF="IEnumFilters.htm">IEnumFilters</A>
</TD>
<TD>Application or possibly a filter that needs to know what other filters are in the graph.
</TD>
<TD>Retrieve filters, skip filters, or clone the enumerator.
</TD>
<TD>Implemented in the filter graph manager.
</TD>
</TR>

<TR><TD><A HREF="IEnumMediaTypes.htm">IEnumMediaTypes</A>
</TD>
<TD>Filter graph manager or connected pin negotiating a media type.
</TD>
<TD>Retrieve media types, skip media types, or clone the enumerator.
</TD>
<TD>Implemented by the <A HREF="../class/CEnumMediaTypes.htm#CEnumMediaTypes">CEnumMediaTypes</A> class.
</TD>
</TR>

<TR><TD><A HREF="IEnumPins.htm">IEnumPins</A>
</TD>
<TD>Filter graph manager.
</TD>
<TD>Retrieve pins, skip pins, or clone the enumerator.
</TD>
<TD>Implemented by the <A HREF="../class/CEnumPins.htm#CEnumPins">CEnumPins</A> class.
</TD>
</TR>

<TR><TD><A HREF="IEnumRegFilters.htm">IEnumRegFilters</A>
</TD>
<TD>Filter mapper.
</TD>
<TD>Retrieve filters, skip items, or clone the enumerator.
</TD>
<TD>Implemented by the filter graph manager.
</TD>
</TR>
</TABLE>

<H3><A NAME="intrface_9">Control Interfaces</A></H3>
<P>Control interfaces allow the filter graph manager to coordinate the activities of the data stream with filters. Interfaces described previously in both the <A HREF="Summary_ifaces.htm#intrface_2">Filter Graph Manager Interfaces</A> and <A HREF="Summary_ifaces.htm#intrface_3">Filter and Pin Interfaces</A> sections are repeated here so that all control interfaces can be viewed together.

<TABLE>
<TR><TH>Interface</TH><TH>What calls methods</TH><TH>What methods do</TH><TH>Comments</TH></TR>

<TR><TD><A HREF="IBaseFilter.htm">IBaseFilter</A>
</TD>
<TD>Filter graph manager.
</TD>
<TD>Same as <A HREF="IMediaFilter.htm">IMediaFilter</A> plus enumerate pins, retrieve filter and vendor information, and locate pins when rebuilding a persistent filter graph.
</TD>
<TD>Inherits methods from the <A HREF="IMediaFilter.htm">IMediaFilter</A> interface. Implemented by the <A HREF="../class/CBaseFilter.htm#CBaseFilter">CBaseFilter</A> class.
</TD>
</TR>

<TR><TD><A HREF="IMediaControl.htm">IMediaControl</A>
</TD>
<TD>Application.
</TD>
<TD>Run, pause, and stop the filter graph, and retrieve the state.
</TD>
<TD>Implemented by the filter graph manager.
</TD>
</TR>

<TR><TD><A HREF="IMediaFilter.htm">IMediaFilter</A>
</TD>
<TD>Nothing directly.
</TD>
<TD>Put the filter in run, stop, or pause state, get and set the reference clock and retrieve the filter state.
</TD>
<TD>Inherited by <A HREF="IBaseFilter.htm">IBaseFilter</A>, which should be used instead of referencing this directly.
</TD>
</TR>

<TR><TD><A HREF="IMediaPosition.htm">IMediaPosition</A>
</TD>
<TD>Application, when exposed on the filter graph manager; filter graph manager or downstream filter, when exposed on a filter.
</TD>
<TD>Get duration and position properties, and get and set start time, stop time, preroll time, and 
rate properties.
</TD>
<TD>Implemented on the filter graph manager and on filters.
</TD>
</TR>

<TR><TD><A HREF="IMediaSeeking.htm">IMediaSeeking</A>
</TD>
<TD>Applications.
</TD>
<TD>Set and retrieve current position and stop position in units other than time (such as sample or field).
</TD>
<TD>Implemented on the filter graph manager and on filters.
</TD>
</TR>
</TABLE>

<P>Because DirectShow objects are COM-based objects, it is a natural extension to use other COM interfaces published in the COM specifications to perform functions such as listing property pages or accessing files. Following are some of the COM interfaces that are commonly used in DirectShow filters. 

<UL>
<LI><A HREF="../../appendixes/Further_Reading.htm#IPersistFile">IPersistFile</A>
<LI><A HREF="../../appendixes/Further_Reading.htm#ISpecifyPropertyPage">ISpecifyPropertyPages</A>
</UL>

<H2><A NAME="intrface_10" IDX_CONCEPT="Filter Graph, Typical Interfaces on">Interfaces on a Typical Filter Graph</A></H2>
<P>Perhaps the best way to put the DirectShow interfaces into perspective is to look at the interfaces exposed in a simple filter graph. The example chosen here is a filter graph that plays back audio data stored on a disk. It is composed of a source filter and an audio renderer filter (no transforms are done, so this is a very simple graph).

<P>The basic source filter consists of an <A HREF="IBaseFilter.htm">IBaseFilter</A> interface, and one output pin that can be found by using the <A HREF="IBaseFilter.htm#EnumPins">IBaseFilter::EnumPins</A> method. The COM <A HREF="../../appendixes/Further_Reading.htm#IPersist">IPersist</A> interface might also be present on the filter (not shown here) to enable the filter to be stored as part of a persistent filter graph. 

<P>The output pin supports <A HREF="IPin.htm">IPin</A> and <A HREF="IMediaPosition.htm">IMediaPosition</A>, since the source filter is a seekable filter (that is, it can be told to move to a particular position in the media stream). The following illustration shows the interfaces on the source filter and its output pin. 

<P>Note that quality management is not implemented in this example, but could be by including the <A HREF="IQualityControl.htm">IQualityControl</A> interface on the output pin as well. 

<P><IMG SRC="../../art/intr_00.gif" WIDTH="339" HEIGHT="131" ALT="Basic source filter">

<P>The basic renderer filter consists of a COM driver supporting the <A HREF="IBaseFilter.htm">IBaseFilter</A> (and, again, <A HREF="IMediaFilter.htm">IMediaFilter</A> by inheritance) and <A HREF="IMediaPosition.htm">IMediaPosition</A> interfaces, as well as having one input pin through the <A HREF="IBaseFilter.htm#EnumPins">EnumPins</A> method of the <B>IBaseFilter</B> interface. 
The COM <A HREF="../../appendixes/Further_Reading.htm#IPersistFile">IPersistFile</A> interface might also be present on the filter (not shown here) in order load the file. The renderer can support additional interfaces, such as <A HREF="IReferenceClock.htm">IReferenceClock</A> (as a master for synchronization) or <A HREF="IBasicAudio.htm">IBasicAudio</A>, for an audio renderer as shown here.

<P>The input pin supports the <A HREF="IPin.htm">IPin</A> and <A HREF="IMemInputPin.htm">IMemInputPin</A> interfaces. Methods of the <A HREF="IMediaPosition.htm">IMediaPosition</A> interface on the renderer filter can call the <B>IMediaPosition</B> interface methods of the output pin that is connected to the renderer's input pin.

<P><IMG SRC="../../art/intr_01.gif" WIDTH="303" HEIGHT="131" ALT="Basic renderer filter">

<P>A basic representation of the connection of a source filter to a renderer filter follows:

<P><IMG SRC="../../art/intr_02.gif" WIDTH="634" HEIGHT="131" ALT="Source and renderer connection">

<P>After the pins are enumerated and connected, it is the implementation of the output and input pins that defines the interactions of the two pins.

<P>After the filters are connected, the control available to the user (filter graph manager) is indicated through the bold interfaces. This continues with the example of connecting an audio source to an audio renderer. 

<P><IMG SRC="../../art/intr_03.gif" WIDTH="612" HEIGHT="131" ALT="Illustration of filter connection, showing some bold interfaces">

<P>The following interfaces are those that would likely be used during a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_T.htm#transport')">transport</A>.

<UL>
<LI><A HREF="IMediaPosition.htm">IMediaPosition</A> supports the ability to seek to a position and change the rate.
<LI><A HREF="IBasicAudio.htm">IBasicAudio</A> supports the ability to set the volume.
<LI><A HREF="IBaseFilter.htm">IBaseFilter</A> supports such methods as <A HREF="IMediaControl.htm#Run">Run</A> and 
<A HREF="IMediaControl.htm#Pause">Pause</A> (methods on the filter graph manager's <A HREF="IMediaControl.htm">IMediaControl</A> interface).
</UL>

<P>Special (custom) interfaces that the filters would support must be obtained directly from the filters. Usage of these interfaces implies that the user is aware of their identifiers.

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
