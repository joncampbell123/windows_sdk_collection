<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IAMDirectSound Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IAMDirectSound Interface">
<META NAME="Description" CONTENT="IAMDirectSound::GetDirectSoundInterface">
<META NAME="Description" CONTENT="IAMDirectSound::GetPrimaryBufferInterface">
<META NAME="Description" CONTENT="IAMDirectSound::GetSecondaryBufferInterface">
<META NAME="Description" CONTENT="IAMDirectSound::GetWindowFocus">
<META NAME="Description" CONTENT="IAMDirectSound::ReleaseDirectSoundInterface">
<META NAME="Description" CONTENT="IAMDirectSound::ReleasePrimaryBufferInterface">
<META NAME="Description" CONTENT="IAMDirectSound::ReleaseSecondaryBufferInterface">
<META NAME="Description" CONTENT="IAMDirectSound::SetWindowFocus">
<META NAME="Description" CONTENT="GetDirectSoundInterface (IAMDirectSound)">
<META NAME="Description" CONTENT="GetPrimaryBufferInterface (IAMDirectSound)">
<META NAME="Description" CONTENT="GetSecondaryBufferInterface (IAMDirectSound)">
<META NAME="Description" CONTENT="GetWindowFocus (IAMDirectSound)">
<META NAME="Description" CONTENT="ReleaseDirectSoundInterface (IAMDirectSound)">
<META NAME="Description" CONTENT="ReleasePrimaryBufferInterface (IAMDirectSound)">
<META NAME="Description" CONTENT="ReleaseSecondaryBufferInterface (IAMDirectSound)">
<META NAME="Description" CONTENT="SetWindowFocus (IAMDirectSound)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IAMDirectSound"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IAMDevMemoryControl.htm">IAMDevMemoryControl Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IAMDroppedFrames.htm">IAMDroppedFrames Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IAMDirectSound Interface</H1>

<P>The <B>IAMDirectSound</B> interface can be used to determine whether sounds played by the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> should always be heard, or only when the application is in focus.  You can also pass your window handle to the filter so it knows when your application is in focus.

<p>The <A HREF="../../filtsamp/DSound_Audio_Renderer.htm#DSound_Audio_Renderer">DSound Audio Renderer</A> filter implements this interface. 

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>This interface is implemented by the <A HREF="../../filtsamp/DSound_Audio_Renderer.htm#DSound_Audio_Renderer">DSound Audio Renderer</A> filter.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Use this interface to control whether or not sounds made by your DirectShow application will still be audible when other sound applications are in the foreground, and to control which of your application's Windows is associated with sound.



<P><B>Note</B> Only the <A HREF="IAMDirectSound.htm#GetWindowFocus">GetWindowFocus</A> and <A HREF="IAMDirectSound.htm#SetWindowFocus">SetWindowFocus</A> methods are currently implemented for this interface.


<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IAMDirectSound methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IAMDirectSound.htm#GetDirectSoundInterface">GetDirectSoundInterface</A>
 </TD><TD>Not currently implemented.
</TD></TR><TR><TD><A HREF="IAMDirectSound.htm#GetPrimaryBufferInterface">GetPrimaryBufferInterface</A>
 </TD><TD>Not currently implemented.
</TD></TR><TR><TD><A HREF="IAMDirectSound.htm#GetSecondaryBufferInterface">GetSecondaryBufferInterface</A>
 </TD><TD>Not currently implemented.
</TD></TR><TR><TD><A HREF="IAMDirectSound.htm#ReleaseDirectSoundInterface">ReleaseDirectSoundInterface</A>
 </TD><TD>Not currently implemented.
</TD></TR><TR><TD><A HREF="IAMDirectSound.htm#ReleasePrimaryBufferInterface">ReleasePrimaryBufferInterface</A>
 </TD><TD>Not currently implemented.
</TD></TR><TR><TD><A HREF="IAMDirectSound.htm#ReleaseSecondaryBufferInterface">ReleaseSecondaryBufferInterface</A>
 </TD><TD>Not currently implemented.
</TD></TR><TR><TD><A HREF="IAMDirectSound.htm#SetWindowFocus">SetWindowFocus</A>
 </TD><TD>Sets the window that will handle sound playback for the current media file.
</TD></TR><TR><TD><A HREF="IAMDirectSound.htm#GetWindowFocus">GetWindowFocus</A>
 </TD><TD>Retrieves the window that is handling sound playback for the current media file.
</TD></TR></TABLE>



<H1><A NAME="GetDirectSoundInterface">IAMDirectSound::GetDirectSoundInterface</A><HR size=1></H1>
<A HREF="IAMDirectSound.htm">IAMDirectSound Interface</A>
<P>Not currently implemented.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetDirectSoundInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTSOUND</B> <I>*lplpds</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lplpds</I>
 </DT><DD>Address of a pointer to an <A HREF="../../appendixes/Further_Reading.htm#IDirectSound">IDirectSound</A> interface that will point to the current sound device's interface.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_FAIL</TD><TD>No sound device is available.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>The <I>lplpds</I> parameter is null.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>DirectSound isn't installed.
</TD></TR><TR><TD>NOERROR </TD><TD>The method succeeded.
</TD></TR></TABLE></BLOCKQUOTE>



<H1><A NAME="GetPrimaryBufferInterface">IAMDirectSound::GetPrimaryBufferInterface</A><HR size=1></H1>
<A HREF="IAMDirectSound.htm">IAMDirectSound Interface</A>
<P>Not currently implemented.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetDirectSoundInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTSOUNDBUFFER</B> <I>*lplpdsb</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lplpdsb</I>
 </DT><DD>Address of a pointer to an <A HREF="../../appendixes/Further_Reading.htm#IDirectSoundBuffer">IDirectSoundBuffer</A> interface that will point to the current sound device's primary sound buffer.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_FAIL</TD><TD>No sound device is available.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>The <I>lplpdsb</I> parameter is null.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>DirectSound isn't installed.
</TD></TR><TR><TD>NOERROR </TD><TD>The method succeeded.
</TD></TR></TABLE></BLOCKQUOTE>



<H1><A NAME="GetSecondaryBufferInterface">IAMDirectSound::GetSecondaryBufferInterface</A><HR size=1></H1>
<A HREF="IAMDirectSound.htm">IAMDirectSound Interface</A>
<P>Not currently implemented.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetSecondaryBufferInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTSOUNDBUFFER</B> <I>*lplpdsb</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lplpdsb</I>
 </DT><DD>Address of a pointer to an <A HREF="../../appendixes/Further_Reading.htm#IDirectSoundBuffer">IDirectSoundBuffer</A> interface. On exit, it will point to the current sound device's secondary sound buffer.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_FAIL</TD><TD>No sound device is available.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>The <I>lplpdsb</I> parameter is null.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>DirectSound isn't installed.
</TD></TR><TR><TD>NOERROR </TD><TD>The method succeeded.
</TD></TR></TABLE></BLOCKQUOTE>



<H1><A NAME="GetWindowFocus">IAMDirectSound::GetWindowFocus</A><HR size=1></H1>
<A HREF="IAMDirectSound.htm">IAMDirectSound Interface</A>
<P>Retrieves the window that is handling sound playback for the current media file. 
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetWindowFocus</B><B>(</B><BR>&nbsp;&nbsp;<B>HWND*</B> <I>hWnd</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bMixingOnOrOff</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>hWnd</I>
 </DT><DD>Handle to the sound playback window. If this value is null, the sound isn't associated with a window; note that Windows NT 4.0 does not currently support windowless sound playback.
</DD><DT><I>bMixingOnOrOff</I>
 </DT><DD>Value indicating whether to mix the sound (TRUE) or not (FALSE).
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_FAIL</TD><TD>No sound device is available.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>The <I>hWnd</I> argument is invalid.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>DirectSound isn't installed.
</TD></TR><TR><TD>NOERROR </TD><TD>The method succeeded.
</TD></TR></TABLE></BLOCKQUOTE>



<H1><A NAME="ReleaseDirectSoundInterface">IAMDirectSound::ReleaseDirectSoundInterface</A><HR size=1></H1>
<A HREF="IAMDirectSound.htm">IAMDirectSound Interface</A>
<P>Not currently implemented.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>ReleaseDirectSoundInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTSOUND</B> <I>lpds</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpds</I>
 </DT><DD>Pointer to the <A HREF="../../appendixes/Further_Reading.htm#IDirectSound">IDirectSound</A> interface to release.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_FAIL</TD><TD>There are no references to the specified <A HREF="../../appendixes/Further_Reading.htm#IDirectSound">IDirectSound</A> interface, so it can't be released.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>The <I>lpds</I> parameter is null.
</TD></TR><TR><TD>NOERROR </TD><TD>The method succeeded.
</TD></TR></TABLE></BLOCKQUOTE>



<H1><A NAME="ReleasePrimaryBufferInterface">IAMDirectSound::ReleasePrimaryBufferInterface</A><HR size=1></H1>
<A HREF="IAMDirectSound.htm">IAMDirectSound Interface</A>
<P>Not currently implemented.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>ReleasePrimaryBufferInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTSOUNDBUFFER</B> <I>lpdsb</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpdsb</I>
 </DT><DD>Pointer to the <A HREF="../../appendixes/Further_Reading.htm#IDirectSoundBuffer">IDirectSoundBuffer</A> interface to release.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_FAIL</TD><TD>There are no references to the specified <A HREF="../../appendixes/Further_Reading.htm#IDirectSoundBuffer">IDirectSoundBuffer</A> interface, so it can't be released.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>The <I>lpdsb</I> parameter is null.
</TD></TR><TR><TD>NOERROR </TD><TD>The method succeeded.
</TD></TR></TABLE></BLOCKQUOTE>



<H1><A NAME="ReleaseSecondaryBufferInterface">IAMDirectSound::ReleaseSecondaryBufferInterface</A><HR size=1></H1>
<A HREF="IAMDirectSound.htm">IAMDirectSound Interface</A>
<P>Not currently implemented.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>ReleaseSecondaryBufferInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTSOUNDBUFFER</B> <I>lpdsb</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpdsb</I>
 </DT><DD>Pointer to the <A HREF="../../appendixes/Further_Reading.htm#IDirectSoundBuffer">IDirectSoundBuffer</A> interface to release.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_FAIL</TD><TD>There are no references to the specified <A HREF="../../appendixes/Further_Reading.htm#IDirectSoundBuffer">IDirectSoundBuffer</A> interface, so it can't be released.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>The <I>lpdsb</I> parameter is null.
</TD></TR><TR><TD>NOERROR </TD><TD>The method succeeded.
</TD></TR></TABLE></BLOCKQUOTE>



<H1><A NAME="SetWindowFocus">IAMDirectSound::SetWindowFocus</A><HR size=1></H1>
<A HREF="IAMDirectSound.htm">IAMDirectSound Interface</A>
<P>Sets the window that will handle sound playback for the current media file.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>SetWindowFocus</B><B>(</B><BR>&nbsp;&nbsp;<B>HWND</B> <I>hWnd</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bMixingOnOrOff</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>hWnd</I>
 </DT><DD>Handle to the sound playback window. If this value is null, the sound will not be associated with any window; note that Windows NT 4.0 does not currently support windowless sound playback.
</DD><DT><I>bMixingOnOrOff</I>
 </DT><DD>Value indicating whether to mix the sound (TRUE) or not (FALSE).
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns one of the following values.
<TABLE>
<TR><TD>E_FAIL</TD><TD>No sound device is available.
</TD></TR><TR><TD>E_INVALIDARG </TD><TD>The <I>hWnd</I> argument is invalid.
</TD></TR><TR><TD>E_NOTIMPL </TD><TD>DirectSound isn't installed.
</TD></TR><TR><TD>NOERROR </TD><TD>The method succeeded.
</TD></TR></TABLE></BLOCKQUOTE>


<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
