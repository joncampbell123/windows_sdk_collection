<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IAMDroppedFrames Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IAMDroppedFrames Interface">
<META NAME="Description" CONTENT="IAMDroppedFrames::GetAverageFrameSize">
<META NAME="Description" CONTENT="IAMDroppedFrames::GetDroppedInfo">
<META NAME="Description" CONTENT="IAMDroppedFrames::GetNumDropped">
<META NAME="Description" CONTENT="IAMDroppedFrames::GetNumNotDropped">
<META NAME="Description" CONTENT="GetAverageFrameSize (IAMDroppedFrames)">
<META NAME="Description" CONTENT="GetDroppedInfo (IAMDroppedFrames)">
<META NAME="Description" CONTENT="GetNumDropped (IAMDroppedFrames)">
<META NAME="Description" CONTENT="GetNumNotDropped (IAMDroppedFrames)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IAMDroppedFrames"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IAMDirectSound.htm">IAMDirectSound Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IAMExtDevice.htm">IAMExtDevice Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IAMDroppedFrames Interface</H1>

<P>The <B>IAMDroppedFrames</B> interface provides information to an application from a capture <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> about frames that the filter dropped (that is, did not send), the frame rate achieved (the length of time the graph ran divided by the number of frames not dropped), and the data rate achieved (the length of time the graph ran divided by the average frame size). A high number of dropped frames can detract from the smoothness of the video clip.

<p>If your application uses the <A HREF="IAMStreamControl.htm">IAMStreamControl</A>
interface or <A HREF="ICaptureGraphBuilder.htm#ControlStream">ICaptureGraphBuilder::ControlStream</A> to turn a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> off, a video capture driver may still be counting dropped and non-dropped frames, whose counts probably don't interest you. If your application is interested in the number of dropped and non-dropped frames only while the pin is ON, you can ask for the dropped and non-dropped counts by calling <A HREF="IAMDroppedFrames.htm#GetNumDropped">IAMDroppedFrames::GetNumDropped</A> and <A HREF="IAMDroppedFrames.htm#GetNumNotDropped">IAMDroppedFrames::GetNumNotDropped</A> immediately after turning on a pin with <A HREF="IAMStreamControl.htm#StartAt">IAMStreamControl::StartAt</A> or <A HREF="ICaptureGraphBuilder.htm#ControlStream">ICaptureGraphBuilder::ControlStream</A>, and then subtract those numbers from the numbers returned from subsequent calls to <B>GetNumDropped</B> or <B>GetNumNotDropped</B> to find out just the number dropped while the pin was on (which is probably the figure you are interested in). If your call to <A HREF="IAMStreamControl.htm#StartAt">IAMStreamControl::StartAt</A> or <A HREF="ICaptureGraphBuilder.htm#ControlStream">ICaptureGraphBuilder::ControlStream</A> is not a call to turn the pin on immediately, but instead turns the pin on at some specified time in the future, then you should wait until you get the notification (EC_STREAM_CONTROL_STARTED) before calling <B>GetNumDropped</B> and <B>GetNumNotDropped</B> initially. See the documentation on <A HREF="IAMStreamControl.htm">IAMStreamControl</A> for more information on this.  See the CAPTURE sample for an example of a capture application that uses both interfaces correctly.


<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>A capture filter's video <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_O.htm#output_pin')">output pin</A> should always implement this interface.

<P>Every time a capture filter goes from <A HREF="../dtypes.htm#State_Stopped">State_Stopped</A> to <A HREF="../dtypes.htm#State_Paused">State_Paused</A>, it should reset all counts to zero.

<p>For more implementation details regarding this interface, see <A HREF="../../filtdev/Write_Video_Capture_Filter.htm#caprules_7">Write a Video Capture Filter</A>. 


<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Applications should use this interface all the time when capturing to update the current capture status. After capturing is done, applications should use this interface to determine the final capture results.

<P><B>Note</B> Not all methods of this interface may be implemented.  Many filters only implement <A HREF="IAMDroppedFrames.htm#GetNumDropped">GetNumDropped</A> and <A HREF="IAMDroppedFrames.htm#GetNumNotDropped">GetNumNotDropped</A>.


<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Retrieves pointers to supported interfaces.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IAMDroppedFrames methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IAMDroppedFrames.htm#GetNumDropped">GetNumDropped</A>
 </TD><TD> Retrieves the total number of frames that the pin dropped since it last started streaming.
 </TD></TR><TR><TD><A HREF="IAMDroppedFrames.htm#GetNumNotDropped">GetNumNotDropped</A>
 </TD><TD> Retrieves the total number of frames that the pin delivered downstream (did not drop).
 </TD></TR><TR><TD><A HREF="IAMDroppedFrames.htm#GetDroppedInfo">GetDroppedInfo</A>
 </TD><TD>Retrieves an array of frame numbers that were dropped.
 </TD></TR><TR><TD><A HREF="IAMDroppedFrames.htm#GetAverageFrameSize">GetAverageFrameSize</A>
 </TD><TD>Retrieves the average size of frames that were not dropped.
</TD></TR></TABLE>



<H1><A NAME="GetAverageFrameSize">IAMDroppedFrames::GetAverageFrameSize</A><HR size=1></H1>
<A HREF="IAMDroppedFrames.htm">IAMDroppedFrames Interface</A>
<P>Retrieves the average size of frames that the pin dropped.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetAverageFrameSize</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plAverageSize</I> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>plAverageSize</I>
 </DT><DD>[out, retval] Average size of frames sent out the pin since the pin started streaming, in bytes.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 



<H1><A NAME="GetDroppedInfo">IAMDroppedFrames::GetDroppedInfo</A><HR size=1></H1>
<A HREF="IAMDroppedFrames.htm">IAMDroppedFrames Interface</A>
<P>Retrieves an array of frame numbers that the pin dropped.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetDroppedInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>lSize</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plArray</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plNumCopied</I> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lSize</I>
 </DT><DD>[in] Requested number of elements in the array.
</DD><DT><I>plArray</I>
 </DT><DD>[out] Pointer to the array.
</DD><DT><I>plNumCopied</I>
 </DT><DD>[out, retval] Pointer to the number of array elements filled in. This number can
differ from <I>lSize</I> because the filter determines an arbitrary number of elements to save and it might not save this information for as many frames as you requested. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The filter will fill the array with the frame numbers of up to the first <I>lSize</I> number of frames dropped, and it will set <I>plNumCopied</I> accordingly.</BLOCKQUOTE>
 



<H1><A NAME="GetNumDropped">IAMDroppedFrames::GetNumDropped</A><HR size=1></H1>
<A HREF="IAMDroppedFrames.htm">IAMDroppedFrames Interface</A>
<P>Retrieves the total number of frames that the pin dropped since it last started streaming.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetNumDropped</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plDropped</I> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>plDropped</I>
 </DT><DD>[out] Pointer to the total number of dropped frames.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 



<H1><A NAME="GetNumNotDropped">IAMDroppedFrames::GetNumNotDropped</A><HR size=1></H1>
<A HREF="IAMDroppedFrames.htm">IAMDroppedFrames Interface</A>
<P>Retrieves the total number of frames that the pin delivered downstream (did not drop).
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetNumNotDropped</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plNotDropped</I> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>plNotDropped</I>
 </DT><DD>[out] Pointer to the total number of frames that weren't dropped.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.</BLOCKQUOTE> 


<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
