<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CBaseControlVideo Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CBaseControlVideo Class">
<META NAME="Description" CONTENT="CBaseControlVideo (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::CBaseControlVideo">
<META NAME="Description" CONTENT="CheckSourceRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::CheckSourceRect">
<META NAME="Description" CONTENT="CheckTargetRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::CheckTargetRect">
<META NAME="Description" CONTENT="CopyImage (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::CopyImage">
<META NAME="Description" CONTENT="get_AvgTimePerFrame (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_AvgTimePerFrame">
<META NAME="Description" CONTENT="get_BitErrorRate (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_BitErrorRate">
<META NAME="Description" CONTENT="get_BitRate (CBaseControlVideo)">
<META NAME="Description" CONTENT="GetCurrentImage (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::GetCurrentImage">
<META NAME="Description" CONTENT="get_DestinationHeight (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_DestinationHeight">
<META NAME="Description" CONTENT="get_DestinationLeft (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_DestinationLeft">
<META NAME="Description" CONTENT="GetDestinationPosition (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::GetDestinationPosition">
<META NAME="Description" CONTENT="get_DestinationTop (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_DestinationTop">
<META NAME="Description" CONTENT="get_DestinationWidth (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_DestinationWidth">
<META NAME="Description" CONTENT="GetImageSize (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::GetImageSize">
<META NAME="Description" CONTENT="get_SourceHeight (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_SourceHeight">
<META NAME="Description" CONTENT="get_SourceLeft (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_SourceLeft">
<META NAME="Description" CONTENT="GetSourcePosition (CBaseControlVideo)">
<META NAME="Description" CONTENT="GetSourceRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::GetSourceRect">
<META NAME="Description" CONTENT="get_SourceTop (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_SourceTop">
<META NAME="Description" CONTENT="get_SourceWidth (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_SourceWidth">
<META NAME="Description" CONTENT="GetStaticImage (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::GetStaticImage">
<META NAME="Description" CONTENT="GetTargetRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::GetTargetRect">
<META NAME="Description" CONTENT="GetVideoFormat (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::GetVideoFormat">
<META NAME="Description" CONTENT="get_VideoHeight (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_VideoHeight">
<META NAME="Description" CONTENT="GetVideoPaletteEntries (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::GetVideoPaletteEntries">
<META NAME="Description" CONTENT="GetVideoSize (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::GetVideoSize">
<META NAME="Description" CONTENT="get_VideoWidth (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::get_VideoWidth">
<META NAME="Description" CONTENT="IsDefaultSourceRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::IsDefaultSourceRect">
<META NAME="Description" CONTENT="IsDefaultTargetRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::IsDefaultTargetRect">
<META NAME="Description" CONTENT="IsUsingDefaultSource (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::IsUsingDefaultSource">
<META NAME="Description" CONTENT="IsUsingDefaultDestination (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::IsUsingDefaultDestination">
<META NAME="Description" CONTENT="OnUpdateRectangles (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::OnUpdateRectangles">
<META NAME="Description" CONTENT="OnVideoSizeChange (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::OnVideoSizeChange">
<META NAME="Description" CONTENT="put_DestinationHeight (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::put_DestinationHeight">
<META NAME="Description" CONTENT="put_DestinationLeft (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::put_DestinationLeft">
<META NAME="Description" CONTENT="put_DestinationTop (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::put_DestinationTop">
<META NAME="Description" CONTENT="put_DestinationWidth (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::put_DestinationWidth">
<META NAME="Description" CONTENT="put_SourceHeight (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::put_SourceHeight">
<META NAME="Description" CONTENT="put_SourceLeft (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::put_SourceLeft">
<META NAME="Description" CONTENT="put_SourceTop (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::put_SourceTop">
<META NAME="Description" CONTENT="put_SourceWidth (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::put_SourceWidth">
<META NAME="Description" CONTENT="SetControlVideoPin (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::SetControlVideoPin">
<META NAME="Description" CONTENT="SetDefaultDestinationPosition (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::SetDefaultDestinationPosition">
<META NAME="Description" CONTENT="SetDefaultSourcePosition (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::SetDefaultSourcePosition">
<META NAME="Description" CONTENT="SetDefaultSourceRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::SetDefaultSourceRect">
<META NAME="Description" CONTENT="SetDefaultTargetRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::SetDefaultTargetRect">
<META NAME="Description" CONTENT="SetDestinationPosition (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::SetDestinationPosition">
<META NAME="Description" CONTENT="SetSourcePosition (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::SetSourcePosition">
<META NAME="Description" CONTENT="SetSourceRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::SetSourceRect">
<META NAME="Description" CONTENT="SetTargetRect (CBaseControlVideo)">
<META NAME="Description" CONTENT="CBaseControlVideo::SetTargetRect">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CBaseControlVideo"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CBaseBasicVideo.htm">CBaseBasicVideo Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CBaseControlWindow.htm">CBaseControlWindow Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CBaseControlVideo Class</H1>

<P><IMG SRC="../../art/wctrl02.gif" WIDTH="283" HEIGHT="201" ALT="CBaseControlVideo class hierarchy">

<P>The <B>CBaseControlVideo</B> class implements the <A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> dual interface and controls the video properties of a generic video window. Generally, a <B>CBaseControlVideo</B> object is a video <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> that draws video into a window on the display.

<P>The <B>CBaseControlVideo</B> class supports both properties and methods. Properties are more easily accessible from many Automation controllers (such as the Microsoft&#174; Visual Basic&#174; programming system). However, some operations require applications to be able to change several properties simultaneously; for this reason, methods are provided that enable a number of related properties to be changed. 

<P>Many <B>CBaseControlVideo</B> member functions require only that the video renderer be connected to a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A>. If it is not connected, member functions will return <A HREF="../Error_Success_Codes.htm#VFW_E_NOT_CONNECTED">VFW_E_NOT_CONNECTED</A>. Properties set on a video renderer persist between successive connections and disconnections. All applications should ensure that they reset the renderer properties before starting a presentation. 

<P>When working with video, the application can select a portion of the video to use. This portion is the source rectangle that the <B>CBaseControlVideo</B> object controls. <B>CBaseControlVideo</B> enables your application to set and retrieve the source rectangle. All the rectangles that <B>CBaseControlVideo</B> uses employ top, left, width, and height rather than top, left, right, and bottom, which is favored in Microsoft Win32&#174; programming. When no source rectangle has been set, the properties of the source rectangle return the full, native video size. 

<A NAME="Protected_Data_Membe"></A><P CLASS="ref">Protected Data Members</P>
<TABLE><TR><TD><B><A NAME="CBaseControlVideo::m_pFilter">m_pFilter</A></B>
 </TD><TD>Pointer to an owning media <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A>.
</TD></TR><TR><TD><B><A NAME="CBaseControlVideo::m_pInterfaceLock">m_pInterfaceLock</A></B>
 </TD><TD>Externally defined critical section.
</TD></TR><TR><TD><B><A NAME="CBaseControlVideo::m_pPin">m_pPin</A></B>
 </TD><TD>Control of the media types for connection.
</TD></TR></TABLE>
<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>

<TABLE><TR><TD><A HREF="CBaseControlVideo.htm#CBaseControlVideo_CBaseControlVideo">CBaseControlVideo</A>
 </TD><TD>Constructs a <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A> object.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#CopyImage">CopyImage</A>
 </TD><TD>Creates a memory copy of a video image.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetImageSize">GetImageSize</A>
 </TD><TD>Retrieves video image size information.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#SetControlVideoPin">SetControlVideoPin</A>
 </TD><TD>Sets the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> with which this object should synchronize.
</TD></TR></TABLE>
<A NAME="Overridable_Member_F"></A><P CLASS="ref">Overridable Member Functions</P>

<TABLE><TR><TD><A HREF="CBaseControlVideo.htm#CheckSourceRect">CheckSourceRect</A>
 </TD><TD>Determines if a source rectangle is valid.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#CheckTargetRect">CheckTargetRect</A>
 </TD><TD>Determines if a target rectangle is valid.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetSourceRect">GetSourceRect</A>
 </TD><TD>Retrieves the current source video rectangle (pure virtual).
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetStaticImage">GetStaticImage</A>
 </TD><TD>Returns the current image in a memory buffer (pure virtual).
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetTargetRect">GetTargetRect</A>
 </TD><TD>Retrieves the current target video rectangle (pure virtual).
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetVideoFormat">GetVideoFormat</A>
 </TD><TD>Retrieves the <A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure containing the video format.

</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#IsDefaultSourceRect">IsDefaultSourceRect</A>
 </TD><TD>Determines if the renderer is using the default source rectangle (pure virtual).
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#IsDefaultTargetRect">IsDefaultTargetRect</A>
 </TD><TD>Determines if the renderer is using the default target rectangle (pure virtual).
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#OnUpdateRectangles">OnUpdateRectangles</A>
 </TD><TD>Called when the source or target rectangle changes.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#OnVideoSizeChange">OnVideoSizeChange</A>
 </TD><TD>Passes EC_VIDEO_SIZE_CHANGED to the application.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#SetDefaultSourceRect">SetDefaultSourceRect</A>
 </TD><TD>Sets the default source video rectangle (pure virtual).
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#SetDefaultTargetRect">SetDefaultTargetRect</A>
 </TD><TD>Sets the default target video rectangle (pure virtual).
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#SetSourceRect">SetSourceRect</A>
 </TD><TD>Sets the current source video rectangle (pure virtual).
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#SetTargetRect">SetTargetRect</A>
 </TD><TD>Sets the current target rectangle (pure virtual).
</TD></TR></TABLE>

<P CLASS="ref"><A NAME="Implemented_IBasicVi"></A>Implemented IBasicVideo Methods</P>
<TABLE><TR><TD><A HREF="CBaseControlVideo.htm#get_AvgTimePerFrame">get_AvgTimePerFrame</A>
 </TD><TD>Retrieves an approximate average time per frame.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_BitErrorRate">get_BitErrorRate</A>
 </TD><TD>Retrieves an approximate bit error rate.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_BitRate">get_BitRate</A>
 </TD><TD>Retrieves an approximate bit rate for the video.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetCurrentImage">GetCurrentImage</A>
 </TD><TD>Retrieves a memory rendering of the current image.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_DestinationHeight">get_DestinationHeight</A>
 </TD><TD>Retrieves the current destination rectangle's height.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_DestinationLeft">get_DestinationLeft</A>
 </TD><TD>Retrieves the current destination rectangle's left coordinate.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetDestinationPosition">GetDestinationPosition</A>
 </TD><TD>Retrieves the current destination position.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_DestinationTop">get_DestinationTop</A>
 </TD><TD>Retrieves the current destination rectangle's top coordinate.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_DestinationWidth">get_DestinationWidth</A>
 </TD><TD>Retrieves the current destination rectangle's width.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_SourceHeight">get_SourceHeight</A>
 </TD><TD>Retrieves the current source rectangle's height.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_SourceLeft">get_SourceLeft</A>
 </TD><TD>Retrieves the current source rectangle's left coordinate.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetSourcePosition">GetSourcePosition</A>
 </TD><TD>Retrieves the current source position.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_SourceTop">get_SourceTop</A>
 </TD><TD>Retrieves the current source rectangle's top coordinate.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_SourceWidth">get_SourceWidth</A>
 </TD><TD>Retrieves the current source rectangle's width.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_VideoHeight">get_VideoHeight</A>
 </TD><TD>Retrieves the native video height.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetVideoPaletteEntries">GetVideoPaletteEntries</A>
 </TD><TD>Retrieves a range of palette entries for the video.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#GetVideoSize">GetVideoSize</A>
 </TD><TD>Retrieves the width and height of the native video.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#get_VideoWidth">get_VideoWidth</A>
 </TD><TD>Retrieves the native video width.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#IsUsingDefaultDestination">IsUsingDefaultDestination</A>
 </TD><TD>Determines if the renderer is using the default destination window.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#IsUsingDefaultSource">IsUsingDefaultSource</A>
 </TD><TD>Determines if the renderer is using the default source window.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#put_DestinationHeight">put_DestinationHeight</A>
 </TD><TD>Sets the destination rectangle's height.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#put_DestinationLeft">put_DestinationLeft</A>
 </TD><TD>Sets the destination rectangle's left coordinate.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#put_DestinationTop">put_DestinationTop</A>
 </TD><TD>Sets the destination rectangle's top coordinate.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#put_DestinationWidth">put_DestinationWidth</A>
 </TD><TD>Sets the destination rectangle's width.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#put_SourceHeight">put_SourceHeight</A>
 </TD><TD>Sets the source rectangle's height.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#put_SourceLeft">put_SourceLeft</A>
 </TD><TD>Sets the source rectangle's left coordinate.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#put_SourceTop">put_SourceTop</A>
 </TD><TD>Sets the source rectangle's top coordinate.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#put_SourceWidth">put_SourceWidth</A>
 </TD><TD>Sets the source rectangle's width.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#SetDefaultDestinationPosition">SetDefaultDestinationPosition</A>
 </TD><TD>Sets the default destination position again.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#SetDefaultSourcePosition">SetDefaultSourcePosition</A>
 </TD><TD>Sets the default source position again.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#SetDestinationPosition">SetDestinationPosition</A>
 </TD><TD>Sets the destination rectangle position.
</TD></TR><TR><TD><A HREF="CBaseControlVideo.htm#SetSourcePosition">SetSourcePosition</A>
 </TD><TD>Sets the source rectangle position.
</TD></TR></TABLE>



<H1><A NAME="CBaseControlVideo_CBaseControlVideo">CBaseControlVideo::CBaseControlVideo</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Constructs a <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A> object.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>CBaseControlVideo</B><B>(</B><BR>&nbsp;&nbsp;<B>CBaseFilter</B> <I>*pFilter</I><B>,</B><BR>&nbsp;&nbsp;<B>CCritSec</B> <I>*pInterfaceLock</I><B>,</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <I>*phr</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pFilter</I>
 </DT><DD>Owning media filter object.
</DD><DT><I>pInterfaceLock</I>
 </DT><DD>Critical section to use for locking.
</DD><DT><I>pName</I>
 </DT><DD>Object description.
</DD><DT><I>pUnk</I>
 </DT><DD>Typical COM ownership.
</DD><DT><I>phr</I>
 </DT><DD>COM return value.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The object implements the <A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> control interface.

<P>All the interface methods from <A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> that this class implements require that the filter be connected correctly. For this reason, the class is passed a pin with which it should synchronize with. Whenever an interface method is called, the object determines that the pin is still connected.
</BLOCKQUOTE>


<H1><A NAME="CheckSourceRect">CBaseControlVideo::CheckSourceRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Determines if a source rectangle is valid.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>CheckSourceRect</B><B>(</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pSourceRect</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR>
</PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSourceRect</I>
 </DT><DD>Source rectangle to check.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_INVALIDARG if not valid; otherwise, returns NOERROR (S_OK).

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function checks that the source rectangle requested does not exceed
the available source video. The left and top coordinates cannot be
negative, and the width and height cannot exceed the right and bottom of the video.
</BLOCKQUOTE>


<H1><A NAME="CheckTargetRect">CBaseControlVideo::CheckTargetRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Determines if a target rectangle is valid.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>CheckTargetRect</B><B>(</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pTargetRect</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR>
</PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pTargetRect</I>
 </DT><DD>Target rectangle to check.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns E_INVALIDARG if not valid; otherwise, returns NOERROR (S_OK).

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function determines if the target rectangle requested is valid. Because
the destination rectangle specifies a position in the logical client of the
window, the coordinates can be negative, although the overall width and height
cannot be zero or a negative value.
</BLOCKQUOTE>


<H1><A NAME="CopyImage">CBaseControlVideo::CopyImage</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Creates a memory copy of an image.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>CopyImage</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaSample</B> <I>*pMediaSample</I><B>,</B><BR>&nbsp;&nbsp;<B>VIDEOINFOHEADER</B> <I>*pVideoInfo</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>*pBufferSize</I><B>,</B><BR>&nbsp;&nbsp;<B>BYTE</B> <I>*pVideoImage</I><B>,</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pSourceRect</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pMediaSample</I>
 </DT><DD>Sample containing the video image.
</DD><DT><I>pVideoInfo</I>
 </DT><DD>Format representing the video image.
</DD><DT><I>pBufferSize</I>
 </DT><DD>Size of the output buffer.
</DD><DT><I>pVideoImage</I>
 </DT><DD>Pointer to the output buffer.
</DD><DT><I>pSourceRect</I>
 </DT><DD>Source video rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>If the <I>pVideoImage</I> parameter is NULL, the <I>pBufferSize</I> parameter is filled in with the number of bytes the output buffer requires to store the image. If the buffer passed in is too small or the member function fails to allocate sufficient memory, the member function returns E_OUTOFMEMORY.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The member function retrieves the image from the sample and copies it into the output buffer. The section of video copied into the output buffer reflects the source rectangle that is set through the <A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface (although it does not reflect the destination rectangle).
</BLOCKQUOTE>


<H1><A NAME="get_AvgTimePerFrame">CBaseControlVideo::get_AvgTimePerFrame</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the average time per frame.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_AvgTimePerFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>*pAvgTimePerFrame</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pAvgTimePerFrame</I>
 </DT><DD>Average time per frame.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR if successful or E_OUTOFMEMORY if there is not enough memory available.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_AvgTimePerFrame">IBasicVideo::get_AvgTimePerFrame</A>
method. It calls the pure virtual <A HREF="CBaseControlVideo.htm#GetVideoFormat">CBaseControlVideo::GetVideoFormat</A> member function
 to retrieve the <A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure from the derived class.
</BLOCKQUOTE>


<H1><A NAME="get_BitErrorRate">CBaseControlVideo::get_BitErrorRate</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves an approximate bit error rate for the video.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_BitErrorRate</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pBitErrorRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pBitErrorRate</I>
 </DT><DD>Bit error rate (one error for approximately this many bits).
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR if successful or E_OUTOFMEMORY if there is not enough memory available.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_BitErrorRate">IBasicVideo::get_BitErrorRate</A>
method. It calls the pure virtual <A HREF="CBaseControlVideo.htm#GetVideoFormat">CBaseControlVideo::GetVideoFormat</A> to retrieve the
<A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure from the derived class.

</BLOCKQUOTE>


<H1><A NAME="get_BitRate">CBaseControlVideo::get_BitRate</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves an approximate bit rate for the video.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_BitRate</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pBitRate</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pBitRate</I>
 </DT><DD>Bit rate in bits per second.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR if successful or E_OUTOFMEMORY not enough memory is available.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_BitRate">IBasicVideo::get_BitRate</A>
method. It calls the pure virtual <A HREF="CBaseControlVideo.htm#GetVideoFormat">CBaseControlVideo::GetVideoFormat</A> to retrieve the
<A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure from the derived class.

</BLOCKQUOTE>


<H1><A NAME="GetCurrentImage">CBaseControlVideo::GetCurrentImage</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves a copy of the current image at the renderer.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetCurrentImage</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pBufferSize</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pVideoImage</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pBufferSize</I>
 </DT><DD>Size of the output buffer.
</DD><DT><I>pVideoImage</I>
 </DT><DD>Pointer to the output buffer for the image.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function retrieves the image from the sample and copies it into the output
buffer. The section of video copied into the output buffer reflects
the source rectangle set through the <A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. It
does not reflect the destination rectangle.
</BLOCKQUOTE>


<H1><A NAME="get_DestinationHeight">CBaseControlVideo::get_DestinationHeight</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the current destination rectangle height.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_DestinationHeight</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pDestinationHeight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pDestinationHeight</I>
 </DT><DD>Holds the destination height.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_DestinationHeight">IBasicVideo::get_DestinationHeight</A>
method.

<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where it will be played.
The destination rectangle is relative to the client area of the window that
it is playing in. The upper-left corner of the window is coordinate (0,0).

</BLOCKQUOTE>


<H1><A NAME="get_DestinationLeft">CBaseControlVideo::get_DestinationLeft</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the left coordinate of the current destination rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_DestinationLeft</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pDestinationLeft</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR>
</PRE></BLOCKQUOTE>


<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pDestinationLeft</I>
 </DT><DD>Contains the left coordinate of the destination rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_DestinationLeft">IBasicVideo::get_DestinationLeft</A>
method.

<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="GetDestinationPosition">CBaseControlVideo::GetDestinationPosition</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the destination rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<B>HRESULT</B> <B>GetDestinationPosition</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pLeft</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pTop</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pWidth</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pHeight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pLeft</I>
 </DT><DD>Contains the left coordinate.
</DD><DT><I>pTop</I>
 </DT><DD>Contains the top coordinate.
</DD><DT><I>pWidth</I>
 </DT><DD>Contains the width.
</DD><DT><I>pHeight</I>
 </DT><DD>Contains the height.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function can be used in place of separate calls to the
<A HREF="CBaseControlVideo.htm#get_DestinationLeft">CBaseControlVideo::get_DestinationLeft</A>,
<A HREF="CBaseControlVideo.htm#get_DestinationTop">CBaseControlVideo::get_DestinationTop</A>,
<A HREF="CBaseControlVideo.htm#get_DestinationWidth">CBaseControlVideo::get_DestinationWidth</A>,
and <A HREF="CBaseControlVideo.htm#get_DestinationHeight">CBaseControlVideo::get_DestinationHeight</A> member functions.
An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="get_DestinationTop">CBaseControlVideo::get_DestinationTop</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the top coordinate of the current destination rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<B>HRESULT</B> <B>get_DestinationTop</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pDestinationTop</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>

</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pDestinationTop</I>
 </DT><DD>Top coordinate of the destination rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_DestinationTop">IBasicVideo::get_DestinationTop</A>
method.

<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="get_DestinationWidth">CBaseControlVideo::get_DestinationWidth</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the width of the current destination rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_DestinationWidth</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pDestinationWidth</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pDestinationWidth</I>
 </DT><DD>Destination width.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_DestinationWidth">IBasicVideo::get_DestinationWidth</A>
method.

<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="GetImageSize">CBaseControlVideo::GetImageSize</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves video image size information.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetImageSize</B><B>(</B><BR>&nbsp;&nbsp;<B>VIDEOINFOHEADER</B> <I>*pVideoInfo</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pBufferSize</I><B>,</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pSourceRect</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pVideoInfo</I>
 </DT><DD>Pointer to a <A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure to be filled in.
</DD><DT><I>pBufferSize</I>
 </DT><DD>Size of the video buffer.
</DD><DT><I>pSourceRect</I>
 </DT><DD>Rectangle dimensions of the source video.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function is a helper function used for creating memory image
renderings of DIB images. It is called from the base class implementation of 
<A HREF="CBaseControlVideo.htm#GetCurrentImage">CBaseControlVideo::GetCurrentImage</A> when a null <I>pVideoImage</I> parameter
is passed to that member function. As a result, this member function constructs and returns a <A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure, using the information in <I>pBufferSize</I> and <I>pSourceRect</I>. 

</BLOCKQUOTE>


<H1><A NAME="get_SourceHeight">CBaseControlVideo::get_SourceHeight</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the height of the current source rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_SourceHeight</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pSourceHeight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSourceHeight</I>
 </DT><DD>Height of the source rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_SourceHeight">IBasicVideo::get_SourceHeight</A>
method.

<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="get_SourceLeft">CBaseControlVideo::get_SourceLeft</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the left coordinate of the current source rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_SourceLeft</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pSourceLeft</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSourceLeft</I>
 </DT><DD>Left coordinate of the current source rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="GetSourcePosition">CBaseControlVideo::GetSourcePosition</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the source rectangle in one atomic operation.


<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetSourcePosition</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pLeft</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pTop</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pWidth</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pHeight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pLeft</I>
 </DT><DD>Left coordinate.
</DD><DT><I>pTop</I>
 </DT><DD>Top coordinate.
</DD><DT><I>pWidth</I>
 </DT><DD>Width.
</DD><DT><I>pHeight</I>
 </DT><DD>Height.
</DD></DL>


</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="GetSourceRect">CBaseControlVideo::GetSourceRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the source rectangle. This is an internal method.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>GetSourceRect</B><B>(</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pSourceRect</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSourceRect</I>
 </DT><DD>Retrieved source rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function must be overridden in the derived class to return the
source rectangle held by the video renderer.
It is called from the following <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A> member functions.
<UL><LI><A HREF="CBaseControlVideo.htm#GetSourcePosition">CBaseControlVideo::GetSourcePosition</A>
<LI><A HREF="CBaseControlVideo.htm#put_SourceLeft">CBaseControlVideo::put_SourceLeft</A>
<LI><A HREF="CBaseControlVideo.htm#get_SourceLeft">CBaseControlVideo::get_SourceLeft</A>
<LI><A HREF="CBaseControlVideo.htm#put_SourceWidth">CBaseControlVideo::put_SourceWidth</A>
<LI><A HREF="CBaseControlVideo.htm#get_SourceWidth">CBaseControlVideo::get_SourceWidth</A>
<LI><A HREF="CBaseControlVideo.htm#put_SourceTop">CBaseControlVideo::put_SourceTop</A>
<LI><A HREF="CBaseControlVideo.htm#get_SourceTop">CBaseControlVideo::get_SourceTop</A>
<LI><A HREF="CBaseControlVideo.htm#put_SourceHeight">CBaseControlVideo::put_SourceHeight</A>
<LI><A HREF="CBaseControlVideo.htm#get_SourceHeight">CBaseControlVideo::get_SourceHeight</A>
</UL>
<P>The following example from the video renderer sample, SampVid, demonstrates
an implementation of this function in a derived class.

<PRE>
// Return the current source rectangle

HRESULT CVideoText::GetSourceRect(RECT *pSourceRect)
{
    ASSERT(pSourceRect);
    m_pRenderer-&gt;m_DrawImage.GetSourceRect(pSourceRect);
    return NOERROR;
}
</PRE>
<P>In this example, CVideoText is a class derived from <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A>,
m_pRenderer holds an object of a class derived from <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A>,
and the m_DrawImage data member, defined in the derived class, holds a <A HREF="CDrawImage.htm">CDrawImage</A>
object.

</BLOCKQUOTE>


<H1><A NAME="get_SourceTop">CBaseControlVideo::get_SourceTop</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the top coordinate of the current source rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_SourceTop</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pSourceTop</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSourceTop</I>
 </DT><DD>Top coordinate of the source rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_SourceTop">IBasicVideo::get_SourceTop</A>
method.

<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="get_SourceWidth">CBaseControlVideo::get_SourceWidth</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the width of the current source rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_SourceWidth</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pSourceWidth</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSourceWidth</I>
 </DT><DD>Width of the current source rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_SourceWidth">IBasicVideo::get_SourceWidth</A>
method.

<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="GetStaticImage">CBaseControlVideo::GetStaticImage</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Pure virtual method that derived classes override.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>GetStaticImage</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pBufferSize</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pDIBImage</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pBufferSize</I>
 </DT><DD>Size of the output buffer.
</DD><DT><I>pDIBImage</I>
 </DT><DD>Pointer to output buffer.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Through the <A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface, an application can request that it be given a copy
of the current image in a memory buffer (some renderers can return E_NOTIMPL
to this if they do not support it). The derived class determines how to retrieve the image.
When the application calls <B>CBaseControlVideo::GetStaticImage</B>,
it calls this pure virtual method that the derived class should override to implement it.
This is also called by the <A HREF="CBaseControlVideo.htm#GetCurrentImage">CBaseControlVideo::GetCurrentImage</A> member function.

<P>The class provides a helper member function, <A HREF="CBaseControlVideo.htm#CopyImage">CBaseControlVideo::CopyImage</A>,
that can be given a sample
that contains an image, and the member function will copy the relevant section of it (based on the
current source rectangle) into the output buffer supplied by the application.

<P>The following example from the video renderer sample, SampVid, demonstrates
an implementation of this member function in a derived class. In this
example, m_pRenderer holds an object of a class derived from <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A>.

<PRE>
// Return a copy of the current image in the video renderer

HRESULT CVideoText::GetStaticImage(long *pBufferSize,long *pDIBImage)
{
    // Get any sample the renderer may be holding.

    IMediaSample *pMediaSample = m_pRenderer-&gt;GetCurrentSample();
    if (pMediaSample == NULL) {
        return E_UNEXPECTED;
    }

    // Call the base class helper method to do the work.

    HRESULT hr = CopyImage(pMediaSample,          // Buffer containing image
                           &amp;m_pRenderer-&gt;m_mtIn,                // Type representing bitmap
                           pBufferSize,                                     // Size of buffer for DIB
                           (BYTE*) pDIBImage);                   // Data buffer for output

    pMediaSample-&gt;Release();
    return hr;
}
</PRE>
</BLOCKQUOTE>


<H1><A NAME="GetTargetRect">CBaseControlVideo::GetTargetRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the destination rectangle. This is an internal helper member function.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>GetTargetRect</B><B>(</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pTargetRect</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pTargetRect</I>
 </DT><DD>Destination rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function must be overridden in the derived class to return the
target rectangle held by the video renderer.
It is called from the following <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A> member functions.
<UL><LI><A HREF="CBaseControlVideo.htm#GetDestinationPosition">CBaseControlVideo::GetDestinationPosition</A>
<LI><A HREF="CBaseControlVideo.htm#put_DestinationLeft">CBaseControlVideo::put_DestinationLeft</A>
<LI><A HREF="CBaseControlVideo.htm#get_DestinationLeft">CBaseControlVideo::get_DestinationLeft</A>
<LI><A HREF="CBaseControlVideo.htm#put_DestinationWidth">CBaseControlVideo::put_DestinationWidth</A>
<LI><A HREF="CBaseControlVideo.htm#get_DestinationWidth">CBaseControlVideo::get_DestinationWidth</A>
<LI><A HREF="CBaseControlVideo.htm#put_DestinationTop">CBaseControlVideo::put_DestinationTop</A>
<LI><A HREF="CBaseControlVideo.htm#get_DestinationTop">CBaseControlVideo::get_DestinationTop</A>
<LI><A HREF="CBaseControlVideo.htm#put_DestinationHeight">CBaseControlVideo::put_DestinationHeight</A>
<LI><A HREF="CBaseControlVideo.htm#get_DestinationHeight">CBaseControlVideo::get_DestinationHeight</A>
</UL>
<P>The following example from the video renderer sample, SampVid, demonstrates
an implementation of this function in a derived class.

<PRE>
// Return the current destination rectangle.

HRESULT CVideoText::GetTargetRect(RECT *pTargetRect)
{
    ASSERT(pTargetRect);
    m_pRenderer-&gt;m_DrawImage.GetTargetRect(pTargetRect);
    return NOERROR;
}

</PRE>
<P>In this example, CVideoText is a class derived from <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A>, 
m_pRenderer holds an object of a class derived from <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A>,
and the m_DrawImage data member, defined in the derived class, holds a <A HREF="CDrawImage.htm">CDrawImage</A>
object.

</BLOCKQUOTE>


<H1><A NAME="GetVideoFormat">CBaseControlVideo::GetVideoFormat</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves a video sample that represents the current video format.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>VIDEOINFOHEADER</B> <B>*</B> <B>GetVideoFormat</B><B>(</B> <B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a pointer to a <A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure that contains the current video format.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>To return and check certain information through <A HREF="../iface/IBasicVideo.htm">IBasicVideo</A>, the object must know the current video format. It gets this information by calling this pure virtual method that derived classes must override. This member function is called by the following <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A> member functions.

<UL><LI><A HREF="CBaseControlVideo.htm#OnVideoSizeChange">CBaseControlVideo::OnVideoSizeChange</A>
<LI><A HREF="CBaseControlVideo.htm#get_AvgTimePerFrame">CBaseControlVideo::get_AvgTimePerFrame</A>
<LI><A HREF="CBaseControlVideo.htm#get_BitRate">CBaseControlVideo::get_BitRate</A>
<LI><A HREF="CBaseControlVideo.htm#get_BitErrorRate">CBaseControlVideo::get_BitErrorRate</A>
<LI><A HREF="CBaseControlVideo.htm#get_VideoWidth">CBaseControlVideo::get_VideoWidth</A>
<LI><A HREF="CBaseControlVideo.htm#get_VideoHeight">CBaseControlVideo::get_VideoHeight</A>
<LI><A HREF="CBaseControlVideo.htm#GetVideoPaletteEntries">CBaseControlVideo::GetVideoPaletteEntries</A>
<LI><A HREF="CBaseControlVideo.htm#GetVideoSize">CBaseControlVideo::GetVideoSize</A>
</UL>
</BLOCKQUOTE>


<H1><A NAME="get_VideoHeight">CBaseControlVideo::get_VideoHeight</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the height of the native video.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_VideoHeight</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pVideoHeight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pVideoHeight</I>
 </DT><DD>Height of the native video, in pixels.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR if successful or E_OUTOFMEMORY if there is not enough memory available.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_VideoHeight">IBasicVideo::get_VideoHeight</A>
method. It calls the pure virtual <A HREF="CBaseControlVideo.htm#GetVideoFormat">CBaseControlVideo::GetVideoFormat</A> to retrieve the
<A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure from the derived class.
</BLOCKQUOTE>


<H1><A NAME="GetVideoPaletteEntries">CBaseControlVideo::GetVideoPaletteEntries</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves a range of palette entries for the video.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetVideoPaletteEntries</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>StartIndex</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>Entries</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pRetrieved</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pPalette</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>StartIndex</I>
 </DT><DD>Zero-based start palette entry.
</DD><DT><I>Entries</I>
 </DT><DD>Number of entries required.
</DD><DT><I>pRetrieved</I>
 </DT><DD>Number of colors obtained.
</DD><DT><I>pPalette</I>
 </DT><DD>Pointer to output buffer for colors.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR if successful, VFW_E_NO_PALETTE_AVAILABLE if the video samples has no color palette, E_OUTOFMEMORY if there is not enough memory available, E_INVALIDARG if <I>StartIndex</I> is invalid, or S_FALSE if there are no colors in the palette.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function returns the current palette of the video as an array allocated by the user. To remain consistent, use the members in the Win32 <A HREF="../../appendixes/Further_Reading.htm#PALETTEENTRY">PALETTEENTRY</A> structure to return the
colors, rather than the members in the <A HREF="../../appendixes/Further_Reading.htm#RGBQUAD">RGBQUAD</A> structure (although the parameter is a <A HREF="../../appendixes/Further_Reading.htm#LONG">LONG</A>). The memory is allocated by the caller, so simply copy each in turn. Determine that the number of entries requested and the start position offset are both valid. If the number of entries evaluates to zero, return an S_FALSE code.
</BLOCKQUOTE>


<H1><A NAME="GetVideoSize">CBaseControlVideo::GetVideoSize</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the native video's width and height.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>GetVideoSize</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pWidth</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pHeight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pWidth</I>
 </DT><DD>Video width.
</DD><DT><I>pHeight</I>
 </DT><DD>Video height.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>


<H1><A NAME="get_VideoWidth">CBaseControlVideo::get_VideoWidth</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Retrieves the width of the native video.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>get_VideoWidth</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pVideoWidth</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pVideoWidth</I>
 </DT><DD>Width of the native video, in pixels.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns NOERROR if successful or E_OUTOFMEMORY if there is not enough memory available.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IBasicVideo.htm#get_VideoWidth">IBasicVideo::get_VideoWidth</A>
method. It calls the pure virtual <A HREF="CBaseControlVideo.htm#GetVideoFormat">CBaseControlVideo::GetVideoFormat</A> to retrieve the
<A HREF="../structs.htm#VIDEOINFOHEADER">VIDEOINFOHEADER</A> structure from the derived class.
</BLOCKQUOTE>


<H1><A NAME="IsDefaultSourceRect">CBaseControlVideo::IsDefaultSourceRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Determines if the renderer is using the default source rectangle (pure virtual).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>IsDefaultSourceRect</B><B>(</B><B>void</B><B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function must be implemented in the derived class. It is called by the
<A HREF="CBaseControlVideo.htm#IsUsingDefaultSource">CBaseControlVideo::IsUsingDefaultSource</A> member function.
<P>The following example from the video renderer sample, SampVid, demonstrates
an implementation of this function in a derived class.

<PRE>
// Return S_OK if using the default source; otherwise, S_FALSE.

HRESULT CVideoText::IsDefaultSourceRect()
{
    RECT SourceRect;

    VIDEOINFO *pVideoInfo = (VIDEOINFO *) m_pRenderer-&gt;m_mtIn.Format();
    BITMAPINFOHEADER *pHeader = HEADER(pVideoInfo);
    m_pRenderer-&gt;m_DrawImage.GetSourceRect(&amp;SourceRect);

    // Check the coordinates that match the video dimensions.

    if (SourceRect.left != 0 || SourceRect.top != 0 ||
            SourceRect.right != pHeader-&gt;biWidth ||
                SourceRect.bottom != pHeader-&gt;biHeight) {
                    return S_FALSE;
    }
    return S_OK;
}
</PRE>
<P>In this example, CVideoText is a class derived from <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A>,
m_pRenderer holds an object of a class derived from <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A>,
and the m_DrawImage data member, defined in the derived class, holds a <A HREF="CDrawImage.htm">CDrawImage</A>
object. The m_mtIn data member, also defined in the derived class, holds a <A HREF="CMediaType.htm">CMediaType</A>
object with the media type of the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_I.htm#input_pin')">input pin</A>.
</BLOCKQUOTE>


<H1><A NAME="IsDefaultTargetRect">CBaseControlVideo::IsDefaultTargetRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Determines if the renderer is using the default target rectangle (pure virtual).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>IsDefaultTargetRect</B><B>(</B><B>void</B><B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function must be implemented in the derived class. It is called by the
<A HREF="CBaseControlVideo.htm#IsUsingDefaultDestination">CBaseControlVideo::IsUsingDefaultDestination</A> member function.

<P>The following example from the video renderer sample, SampVid, demonstrates
an implementation of this function in a derived class.

<PRE>
// Return S_OK if using the default target; otherwise, S_FALSE.

HRESULT CVideoText::IsDefaultTargetRect()
{
    RECT TargetRect;

    VIDEOINFO *pVideoInfo = (VIDEOINFO *) m_pRenderer-&gt;m_mtIn.Format();
    BITMAPINFOHEADER *pHeader = HEADER(pVideoInfo);
    m_pRenderer-&gt;m_DrawImage.GetTargetRect(&amp;TargetRect);

    // Check the destination that matches the initial client area.

    if (TargetRect.left != 0 || TargetRect.top != 0 ||
            TargetRect.right != m_Size.cx ||
                TargetRect.bottom != m_Size.cy) {
                    return S_FALSE;
    }
    return S_OK;
}

</PRE>
<P>In this example, CVideoText is a class derived from <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A>,
m_pRenderer holds an object of a class derived from <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A>,
and the m_DrawImage data member, defined in the derived class, holds a <A HREF="CDrawImage.htm">CDrawImage</A>
object. The m_mtIn data member, also defined in the derived class, holds a <A HREF="CMediaType.htm">CMediaType</A>
object with media type of the input pin.
</BLOCKQUOTE>


<H1><A NAME="IsUsingDefaultSource">CBaseControlVideo::IsUsingDefaultSource</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Determines if the renderer is using the default source window.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>IsUsingDefaultSource</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>


<H1><A NAME="IsUsingDefaultDestination">CBaseControlVideo::IsUsingDefaultDestination</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Determines if the renderer is using the default destination window.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>IsUsingDefaultDestination</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value. Returns S_OK if using the default destination;
otherwise, returns S_FALSE.


</BLOCKQUOTE>


<H1><A NAME="OnUpdateRectangles">CBaseControlVideo::OnUpdateRectangles</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Called when either the source or destination rectangle changes.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>OnUpdateRectangles</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>


<H1><A NAME="OnVideoSizeChange">CBaseControlVideo::OnVideoSizeChange</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Passes an EC_VIDEO_SIZE_CHANGED message to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A>.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>OnVideoSizeChange</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>A video renderer should call this member function each time the video size is changed; this
will typically be called once after initial connection. If the renderer can
support dynamic format changes (from 320 x 240 to 160 x 120), it should
also call it after each change.
</BLOCKQUOTE>


<H1><A NAME="put_DestinationHeight">CBaseControlVideo::put_DestinationHeight</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the destination rectangle height.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_DestinationHeight</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>DestinationHeight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>DestinationHeight</I>
 </DT><DD>New destination height.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="put_DestinationLeft">CBaseControlVideo::put_DestinationLeft</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the left coordinate of the destination rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_DestinationLeft</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>DestinationLeft</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>DestinationLeft</I>
 </DT><DD>New left coordinate of destination rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="put_DestinationTop">CBaseControlVideo::put_DestinationTop</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the top coordinate of the destination rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_DestinationTop</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>DestinationTop</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>DestinationTop</I>
 </DT><DD>New top coordinate of the destination rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="put_DestinationWidth">CBaseControlVideo::put_DestinationWidth</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the width of the destination rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_DestinationWidth</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>DestinationWidth</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>DestinationWidth</I>
 </DT><DD>New destination width.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="put_SourceHeight">CBaseControlVideo::put_SourceHeight</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the source rectangle height.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_SourceHeight</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>SourceHeight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>SourceHeight</I>
 </DT><DD>Source height.
 

</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="put_SourceLeft">CBaseControlVideo::put_SourceLeft</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the source rectangle left coordinate.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_SourceLeft</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>SourceLeft</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>SourceLeft</I>
 </DT><DD>New left coordinate of the source rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="put_SourceTop">CBaseControlVideo::put_SourceTop</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the top coordinate of the source rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_SourceTop</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>SourceTop</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>SourceTop</I>
 </DT><DD>New top coordinate of the source rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="put_SourceWidth">CBaseControlVideo::put_SourceWidth</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the width of the source rectangle.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>put_SourceWidth</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>SourceWidth</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>SourceWidth</I>
 </DT><DD>New width of the source rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="SetControlVideoPin">CBaseControlVideo::SetControlVideoPin</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the pin used by the filter.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>void</B> <B>SetControlVideoPin</B><B>(</B><BR>&nbsp;&nbsp;<B>CBasePin</B> <I>*pPin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
 </DT><DD>Pin with which the interface is synchronized.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The interface can be called only when
the filter has been connected successfully. The object is passed through
this method to the pin with which it is synchronized; in most cases it will
determine if the pin is connected when it has an interface method called and
will return VFW_E_NOT_CONNECTED if it fails.
</BLOCKQUOTE>


<H1><A NAME="SetDefaultDestinationPosition">CBaseControlVideo::SetDefaultDestinationPosition</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the renderer back to using the default destination position
(typically the entire window client area).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetDefaultDestinationPosition</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="SetDefaultSourcePosition">CBaseControlVideo::SetDefaultSourcePosition</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the renderer back to using the default source position (typically
all the native video).

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetDefaultSourcePosition</B><B>(</B> <B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="SetDefaultSourceRect">CBaseControlVideo::SetDefaultSourceRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the default source video rectangle (pure virtual). This in an internal member function
 that gets called when the source rectangle is reset.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>SetDefaultSourceRect</B><B>(</B> <B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Derived classes should override this to reset the source rectangle.
It is called from <A HREF="CBaseControlVideo.htm#SetDefaultSourcePosition">CBaseControlVideo::SetDefaultSourcePosition</A>.

<P>The following example from the video renderer sample, SampVid, demonstrates
an implementation of this function in a derived class.
<PRE>
// This is called when you reset the default source rectangle.

HRESULT CVideoText::SetDefaultSourceRect()
{
    VIDEOINFO *pVideoInfo = (VIDEOINFO *) m_pRenderer-&gt;m_mtIn.Format();
    BITMAPINFOHEADER *pHeader = HEADER(pVideoInfo);
    RECT SourceRect = {0,0,pHeader-&gt;biWidth,pHeader-&gt;biHeight};
    m_pRenderer-&gt;m_DrawImage.SetSourceRect(&amp;SourceRect);
    return NOERROR;
}
</PRE>
<P>In this example, CVideoText is a class derived from <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A>,
m_pRenderer holds an object of a class derived from <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A>,
and the m_DrawImage data member, defined in the derived class, holds a <A HREF="CDrawImage.htm">CDrawImage</A>
object. The m_mtIn data member, also defined in the derived class, holds a <A HREF="CMediaType.htm">CMediaType</A>
object with media type of the input pin.
</BLOCKQUOTE>


<H1><A NAME="SetDefaultTargetRect">CBaseControlVideo::SetDefaultTargetRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the default target video rectangle (pure virtual). This is an internal member function
 that gets called when the source rectangle is reset.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>SetDefaultTargetRect</B><B>(</B> <B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Derived classes should override this to reset the destination video rectangle.
It is called from the <A HREF="CBaseControlVideo.htm#SetDefaultDestinationPosition">CBaseControlVideo::SetDefaultDestinationPosition</A> member function.
<P>The following example from the video renderer sample, SampVid, demonstrates
an implementation of this function in a derived class.

<PRE>
// This is called when you reset the default target rectangle.

HRESULT CVideoText::SetDefaultTargetRect()
{
    VIDEOINFO *pVideoInfo = (VIDEOINFO *) m_pRenderer-&gt;m_mtIn.Format();
    BITMAPINFOHEADER *pHeader = HEADER(pVideoInfo);
    RECT TargetRect = {0,0,m_Size.cx,m_Size.cy};
    m_pRenderer-&gt;m_DrawImage.SetTargetRect(&amp;TargetRect);
    return NOERROR;
}
</PRE>
<P>In this example, CVideoText is a class derived from <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A>,
m_pRenderer holds an object of a class derived from <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A>,
and the m_DrawImage data member, defined in the derived class, holds a <A HREF="CDrawImage.htm">CDrawImage</A>
object. The m_mtIn data member, also defined in the derived class, holds a <A HREF="CMediaType.htm">CMediaType</A>
object with the media type of the input pin.
</BLOCKQUOTE>


<H1><A NAME="SetDestinationPosition">CBaseControlVideo::SetDestinationPosition</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the destination rectangle for the video.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetDestinationPosition</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>Left</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>Top</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>Width</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>Height</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>Left</I>
 </DT><DD>New left coordinate.
</DD><DT><I>Top</I>
 </DT><DD>New top coordinate.
</DD><DT><I>Width</I>
 </DT><DD>New width.
</DD><DT><I>Height</I>
 </DT><DD>New height.
</DD></DL>


</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="SetSourcePosition">CBaseControlVideo::SetSourcePosition</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets a new source position for the video.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>SetSourcePosition</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>Left</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>Top</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>Width</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>Height</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>Left</I>
 </DT><DD>New left coordinate.
</DD><DT><I>Top</I>
 </DT><DD>New top coordinate.
</DD><DT><I>Width</I>
 </DT><DD>New width.
</DD><DT><I>Height</I>
 </DT><DD>New height.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application can change the source and destination rectangles for the video through the
<A HREF="../iface/IBasicVideo.htm">IBasicVideo</A> interface. The source rectangle affects which
section of the native video source will appear on the display; the destination
rectangle affects where the video will appear when played.
The destination rectangle is relative to the client area of the window in which it is playing.
The upper-left corner of the window is coordinate (0,0).
</BLOCKQUOTE>


<H1><A NAME="SetSourceRect">CBaseControlVideo::SetSourceRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the current source video rectangle (pure virtual). This is an internal member
function that gets called when the source rectangle changes.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>SetSourceRect</B><B>(</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pSourceRect</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSourceRect</I>
 </DT><DD>Source rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Derived classes should override this member function to know when the
source rectangle changes.
It is called from the following member functions.
<UL><LI><A HREF="CBaseControlVideo.htm#SetSourcePosition">CBaseControlVideo::SetSourcePosition</A>
<LI><A HREF="CBaseControlVideo.htm#put_SourceLeft">CBaseControlVideo::put_SourceLeft</A>
<LI><A HREF="CBaseControlVideo.htm#put_SourceWidth">CBaseControlVideo::put_SourceWidth</A>
<LI><A HREF="CBaseControlVideo.htm#put_SourceTop">CBaseControlVideo::put_SourceTop</A>
<LI><A HREF="CBaseControlVideo.htm#put_SourceHeight">CBaseControlVideo::put_SourceHeight</A>
</UL>
<P>The following example from the video renderer sample, SampVid, demonstrates
an implementation of this function in a derived class.

<PRE>
HRESULT CVideoText::SetSourceRect(RECT *pSourceRect)
{
    m_pRenderer-&gt;m_DrawImage.SetSourceRect(pSourceRect);
    return NOERROR;
}

</PRE>
<P>In this example, CVideoText is a class derived from <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A>,
m_pRenderer holds an object of a class derived from <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A>,
and the m_DrawImage data member, defined in the derived class, holds a <A HREF="CDrawImage.htm">CDrawImage</A>
object.
</BLOCKQUOTE>


<H1><A NAME="SetTargetRect">CBaseControlVideo::SetTargetRect</A><HR size=1></H1>
<A HREF="CBaseControlVideo.htm">CBaseControlVideo Class</A>
<P>Sets the current target rectangle (pure virtual). This is an internal member
function that gets called when the destination rectangle changes.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>virtual</B> <B>HRESULT</B> <B>SetTargetRect</B><B>(</B><BR>&nbsp;&nbsp;<B>RECT</B> <I>*pTargetRect</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pTargetRect</I>
 </DT><DD>Destination rectangle.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Derived classes should override this to know when the destination rectangle changes.
It is called from the following member functions.
<UL><LI><A HREF="CBaseControlVideo.htm#SetDestinationPosition">CBaseControlVideo::SetDestinationPosition</A>
<LI><A HREF="CBaseControlVideo.htm#put_DestinationLeft">CBaseControlVideo::put_DestinationLeft</A>
<LI><A HREF="CBaseControlVideo.htm#put_DestinationWidth">CBaseControlVideo::put_DestinationWidth</A>
<LI><A HREF="CBaseControlVideo.htm#put_DestinationTop">CBaseControlVideo::put_DestinationTop</A>
<LI><A HREF="CBaseControlVideo.htm#put_DestinationHeight">CBaseControlVideo::put_DestinationHeight</A>
</UL>
<P>The following example from the video renderer sample, SampVid, demonstrates
an implementation of this function in a derived class.

<PRE>
HRESULT CVideoText::SetTargetRect(RECT *pTargetRect)
{
    m_pRenderer-&gt;m_DrawImage.SetTargetRect(pTargetRect);
    return NOERROR;
}
</PRE>
<P>In this example, CVideoText is a class derived from <A HREF="CBaseControlVideo.htm">CBaseControlVideo</A>,
m_pRenderer holds an object of a class derived from <A HREF="CBaseVideoRenderer.htm">CBaseVideoRenderer</A>,
and the m_DrawImage data member, defined in the derived class, holds a <A HREF="CDrawImage.htm">CDrawImage</A>
object.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
