<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IFilterGraph2 Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IFilterGraph2 Interface">
<META NAME="Description" CONTENT="IFilterGraph2::AddSourceFilterForMoniker">
<META NAME="Description" CONTENT="IFilterGraph2::ReconnectEx">
<META NAME="Description" CONTENT="AddSourceFilterForMoniker (IFilterGraph2)">
<META NAME="Description" CONTENT="ReconnectEx (IFilterGraph2)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IFilterGraph2"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IFilterGraph.htm">IFilterGraph Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IFilterInfo.htm">IFilterInfo Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IFilterGraph2 Interface</H1>

<P>The <B>IFilterGraph2</B> interface adds new functionality to the <A HREF="IGraphBuilder.htm">IGraphBuilder</A> and <A HREF="IFilterGraph.htm">IFilterGraph</A> interfaces. It inherits from both interfaces and exposes all their <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#method')">methods</A>. This interface also includes a method to add a source for a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#moniker')">moniker</A>, and an improved version of the <A HREF="IFilterGraph.htm#Reconnect">IFilterGraph::Reconnect</A> method. For this reason, you should usually use <B>IFilterGraph2</B> instead of the other two.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>

<P>The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A> implements this interface so it isn't intended that you implement it.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>

<P>Use this interface in applications that previously called <A HREF="IFilterGraph.htm#Reconnect">IFilterGraph::Reconnect</A> and in applications that need a source <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> for a moniker.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>

<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Retrieves pointers to supported interfaces.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IFilterGraph methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IFilterGraph2.htm#AddSourceFilterForMoniker">AddSourceFilterForMoniker</A>
 </TD><TD>Adds a source for a moniker.
 </TD></TR><TR><TD><A HREF="IFilterGraph2.htm#ReconnectEx">ReconnectEx</A>
 </TD><TD>Specifies a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> and a media type to reconnect with.
</TD></TR></TABLE>



<H1><A NAME="AddSourceFilterForMoniker">IFilterGraph2::AddSourceFilterForMoniker</A><HR size=1></H1>
<A HREF="IFilterGraph2.htm">IFilterGraph2 Interface</A>
<P>Adds a source for a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_M.htm#moniker')">moniker</A>.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>AddSourceFilterForMoniker</B><B>(</B><BR>&nbsp;&nbsp;<B>IMoniker</B> <I>*pMoniker</I><B>,</B><BR>&nbsp;&nbsp;<B>IBindCtx</B> <I>*pCtx</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpcwstrFilterName</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <I>**ppFilter</I> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pMoniker</I>
 </DT><DD>[in] Pointer to an <A HREF="../../appendixes/Further_Reading.htm#IMoniker">IMoniker</A> interface.
</DD><DT><I>pCtx</I>
 </DT><DD>[in] Pointer to an <A HREF="../../appendixes/Further_Reading.htm#IBindCtx">IBindCtx</A> bind context interface.
</DD><DT><I>lpcwstrFilterName</I>
 </DT><DD>[in] Pointer to the filter's name.
</DD><DT><I>ppFilter</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="IBaseFilter.htm">IBaseFilter</A> interface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>When adding a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#source_filter')">source filter</A> for the given moniker to the graph, the COM <A HREF="../../appendixes/Further_Reading.htm#IMoniker__BindToStor">IMoniker::BindToStorage</A> member function will query for an <A HREF="../../appendixes/Further_Reading.htm#IStream">IStream</A> interface. If this fails, <A HREF="../../appendixes/Further_Reading.htm#IMoniker__BindToObje">IMoniker::BindToObject</A> will try to retrieve an <A HREF="IBaseFilter.htm">IBaseFilter</A> interface.

</BLOCKQUOTE>


<H1><A NAME="ReconnectEx">IFilterGraph2::ReconnectEx</A><HR size=1></H1>
<A HREF="IFilterGraph2.htm">IFilterGraph2 Interface</A>
<P>Specifies a pin and a media type to reconnect with.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>ReconnectEx</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppin</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>AM_MEDIA_TYPE</B> <I>*pmt</I> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppin</I>
 </DT><DD>[in] Pin to disconnect and reconnect.
</DD><DT><I>pmt</I>
 </DT><DD>[in] Media type to reconnect with. Specify NULL to use the existing media type.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.


</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>


<BLOCKQUOTE>

<P>Like the <A HREF="IFilterGraph.htm#Reconnect">IFilterGraph::Reconnect</A> method, the <B>ReconnectEx</B> method schedules a reconnection of the pin with the pin it is currently connected to. By specifying a media type when this method is called, the pins don't have to check what type they were originally connected with or enumerate possible new types. This makes the reconnection more likely to succeed.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>

<BLOCKQUOTE>
<P><A HREF="IFilterGraph.htm#Reconnect">IFilterGraph::Reconnect</A>
</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
