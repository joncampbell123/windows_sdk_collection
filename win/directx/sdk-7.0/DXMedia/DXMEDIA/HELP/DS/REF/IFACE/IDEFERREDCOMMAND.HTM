<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IDeferredCommand Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IDeferredCommand Interface">
<META NAME="Description" CONTENT="IDeferredCommand::Cancel">
<META NAME="Description" CONTENT="IDeferredCommand::Confidence">
<META NAME="Description" CONTENT="IDeferredCommand::GetHResult">
<META NAME="Description" CONTENT="IDeferredCommand::Postpone">
<META NAME="Description" CONTENT="Cancel (IDeferredCommand)">
<META NAME="Description" CONTENT="Confidence (IDeferredCommand)">
<META NAME="Description" CONTENT="GetHResult (IDeferredCommand)">
<META NAME="Description" CONTENT="Postpone (IDeferredCommand)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDeferredCommand"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IDDrawExclModeVideoCallback.htm">IDDrawExclModeVideoCallback Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IDirectDrawVideo.htm">IDirectDrawVideo Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IDeferredCommand Interface</H1>
<P>The deferred command mechanism allows <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> themselves to handle deferred commands.
Where they do not, the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph_manager')">filter graph manager</A> queues the command until the requested time
and then calls the method on the filter (this would result in coarse rather than accurate
synchronization). Note that a filter that does handle deferred commands must make them apply
to data appearing at that time. Thus a contrast filter asked to change the contrast at time <I>x</I>
must ensure that it applies the change when processing data time-stamped to be rendered at time
<I>x</I>; these samples will be processed by the filter somewhat before time <I>x</I>.

<P>The <A HREF="IQueueCommand.htm">IQueueCommand</A> interface provides two methods,
<A HREF="IQueueCommand.htm#InvokeAtStreamTime">InvokeAtStreamTime</A>, which queues commands at <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#stream_time')">stream time</A>, and
<A HREF="IQueueCommand.htm#InvokeAtPresentationTime">InvokeAtPresentationTime</A>, which queues commands at <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#presentation_time')">presentation time</A>. Both
return an <B>IDeferredCommand</B> interface to the queued command, by which the
application can cancel the command, set a new presentation time for it, or get back an estimate
of the likelihood of the filter graph manager being able to run the command on time
(implementation of this last method is likely to be highly simplistic in the first release of
Microsoft&#174; DirectShow&#153;).

<P>Both the queue and the application will hold a reference count on the object
(represented to the application by the <B>IDeferredCommand</B> interface), and the object
will not be destroyed until both are released. Similarly, calling Release on the
<B>IDeferredCommand</B> interface is not sufficient to cancel the command
because the queue also holds a reference count.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>This method is implemented by the filter graph manager to allow deferred
processing of commands. It is implemented through a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#plug_in_distributor')">plug-in distributor</A>
to pass deferred commands from the application to the filters
(through the plug-in distributor for the command that has been queued). You can implement it
within your filter if your filter supports queued commands; in this case, applications
will need to obtain an <A HREF="IQueueCommand.htm">IQueueCommand</A> interface directly from your filter.
You can use the <A HREF="../class/CDeferredCommand.htm#CDeferredCommand">CDeferredCommand</A> class to help implement this interface.


<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Applications can use this interface to cancel, postpone, get return values from, or determine a
confidence level for commands that have been queued for deferred execution by using the
<A HREF="IQueueCommand.htm">IQueueCommand</A> interface.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Returns pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IDeferredCommand methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IDeferredCommand.htm#Cancel">Cancel</A>
 </TD><TD>Cancels a previously queued <A HREF="IQueueCommand.htm#InvokeAtStreamTime">IQueueCommand::InvokeAtStreamTime</A> or
<A HREF="IQueueCommand.htm#InvokeAtPresentationTime">IQueueCommand::InvokeAtPresentationTime</A> request.
</TD></TR><TR><TD><A HREF="IDeferredCommand.htm#Confidence">Confidence</A>
 </TD><TD>Returns a confidence value that describes the probability of the deferred command being
run on time.
</TD></TR><TR><TD><A HREF="IDeferredCommand.htm#Postpone">Postpone</A>
 </TD><TD>Specifies a new invocation time for a previously queued command.
</TD></TR><TR><TD><A HREF="IDeferredCommand.htm#GetHResult">GetHResult</A>
 </TD><TD>Retrieves the return value from the invoked command.
</TD></TR></TABLE>



<H1><A NAME="Cancel">IDeferredCommand::Cancel</A><HR size=1></H1>
<A HREF="IDeferredCommand.htm">IDeferredCommand Interface</A>
<P>Cancels a previously queued <A HREF="IQueueCommand.htm#InvokeAtStreamTime">IQueueCommand::InvokeAtStreamTime</A> or
<A HREF="IQueueCommand.htm#InvokeAtPresentationTime">IQueueCommand::InvokeAtPresentationTime</A> request.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>Cancel</B><B>(</B> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.
</BLOCKQUOTE>



<H1><A NAME="Confidence">IDeferredCommand::Confidence</A><HR size=1></H1>
<A HREF="IDeferredCommand.htm">IDeferredCommand Interface</A>
<P>Returns a confidence value on a scale of 0 to 100 that describes the probability that
the deferred command will be run on time.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>Confidence</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>*pConfidence</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pConfidence</I>
</DT><DD>Confidence level.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.
</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>

<P>Higher confidence values indicate a greater probability of timely execution.
For example, a command queued at a presentation time that has already passed will return
a value of 0. A value of 100 would indicate, with absolute certainty, that the command
can be run on time. Commands that are not directly supported by the filter but are
queued by the filter graph manager will return a lower confidence value than commands
queued directly by the filters that run them. Commands that are queued with times too close
to other commands are likely to return lower confidence values.
The initial implementation of this method relies mostly on the reporting of the
individual filter commands rather than an attempt to estimate resource availability
on a filter graph-wide basis.
</BLOCKQUOTE>


<H1><A NAME="GetHResult">IDeferredCommand::GetHResult</A><HR size=1></H1>
<A HREF="IDeferredCommand.htm">IDeferredCommand Interface</A>
<P>Retrieves the return value from the invoked command.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>GetHResult</B><B>(</B><BR>&nbsp;&nbsp;<B>HRESULT*</B> <I>phrResult</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>phrResult</I>
</DT><DD>Retrieved <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.
</DD></DL>
</BLOCKQUOTE>


<H1><A NAME="Postpone">IDeferredCommand::Postpone</A><HR size=1></H1>
<A HREF="IDeferredCommand.htm">IDeferredCommand Interface</A>
<P>Specifies a new presentation time for a previously queued command.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><P><B>HRESULT</B> <B>Postpone</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>newtime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>newtime</I>
</DT><DD>New presentation time.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Return value is S_OK if completed. Also, if completed, the
<I>phrResult</I> parameter is set to the result of the deferred command.
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
