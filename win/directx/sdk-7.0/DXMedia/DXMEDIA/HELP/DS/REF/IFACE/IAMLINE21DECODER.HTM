<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IAMLine21Decoder Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IAMLine21Decoder Interface">
<META NAME="Description" CONTENT="IAMLine21Decoder::GetBackgroundColor">
<META NAME="Description" CONTENT="IAMLine21Decoder::GetCurrentService">
<META NAME="Description" CONTENT="IAMLine21Decoder::GetDecoderLevel">
<META NAME="Description" CONTENT="IAMLine21Decoder::GetDrawBackgroundMode">
<META NAME="Description" CONTENT="IAMLine21Decoder::GetOutputFormat">
<META NAME="Description" CONTENT="IAMLine21Decoder::GetRedrawAlways">
<META NAME="Description" CONTENT="IAMLine21Decoder::GetServiceState">
<META NAME="Description" CONTENT="IAMLine21Decoder::SetBackgroundColor">
<META NAME="Description" CONTENT="IAMLine21Decoder::SetCurrentService">
<META NAME="Description" CONTENT="IAMLine21Decoder::SetDrawBackgroundMode">
<META NAME="Description" CONTENT="IAMLine21Decoder::SetOutputFormat">
<META NAME="Description" CONTENT="IAMLine21Decoder::SetRedrawAlways">
<META NAME="Description" CONTENT="IAMLine21Decoder::SetServiceState">
<META NAME="Description" CONTENT="GetBackgroundColor (IAMLine21Decoder)">
<META NAME="Description" CONTENT="GetCurrentService (IAMLine21Decoder)">
<META NAME="Description" CONTENT="GetDecoderLevel (IAMLine21Decoder)">
<META NAME="Description" CONTENT="GetDrawBackgroundMode (IAMLine21Decoder)">
<META NAME="Description" CONTENT="GetOutputFormat (IAMLine21Decoder)">
<META NAME="Description" CONTENT="GetRedrawAlways (IAMLine21Decoder)">
<META NAME="Description" CONTENT="GetServiceState (IAMLine21Decoder)">
<META NAME="Description" CONTENT="SetBackgroundColor (IAMLine21Decoder)">
<META NAME="Description" CONTENT="SetCurrentService (IAMLine21Decoder)">
<META NAME="Description" CONTENT="SetDrawBackgroundMode (IAMLine21Decoder)">
<META NAME="Description" CONTENT="SetOutputFormat (IAMLine21Decoder)">
<META NAME="Description" CONTENT="SetRedrawAlways (IAMLine21Decoder)">
<META NAME="Description" CONTENT="SetServiceState (IAMLine21Decoder)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IAMLine21Decoder"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IAMFilterMiscFlags.htm">IAMFilterMiscFlags Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IAMovie.htm">IAMovie Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IAMLine21Decoder Interface</H1>
<P>The <B>IAMLine21Decoder</B> interface provides access to closed-captioned information and settings. Closed-captioned information is transmitted in the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_V.htm#vertical_blanking_in')">vertical blanking interval</A> (VBI) of television signals, specifically on line 21 of <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#field')">field</A> 1 in the VBI. Video cassette recorders record this information on video tape, and you can use Microsoft&#174; DirectShow&#153; <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filters</A> to capture the Line 21 data and save it on disk in a media file format such as audio-video interleaved (AVI). The closed-captioned information appears as a separate stream within the media file.

<P>Closed-captioned text is currently used mainly in DVD movies. DVD movies contain line 21 data as part of the user data section of each Group of Pictures (GOP) in the video stream. Capture cards with Windows Driver Model (WDM) drivers will provide line 21 data.

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>Do not implement this interface. DirectShow provides the <A HREF="../../filtsamp/Line_21_Decoder.htm#Line_21_Decoder">Line 21 Decoder</A> in the DirectX Media SDK, which implements it for you.

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Applications use this interface when they want to provide closed-captioned text, primarily to turn closed-captioned capabilities on and off. Use this interface in your application or in the filter immediately downstream of the Line 21 Decoder filter (typically a mixer filter) to change closed-captioned options, such as the output video's size and whether to make the caption background opaque or transparent. Mixer filters can also change the physical color used for the background color key.

<P>Applications can call the <A HREF="IAMLine21Decoder.htm#GetDrawBackgroundMode">GetDrawBackgroundMode</A> and <A HREF="IAMLine21Decoder.htm#SetDrawBackgroundMode">SetDrawBackgroundMode</A> methods so the user can select transparent or opaque captioning.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A>
 </TD><TD>Retrieves pointers to supported interfaces.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A>
 </TD><TD>Increments the reference count.
 </TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A>
 </TD><TD>Decrements the reference count.
</TD></TR><TR></TR>
<TR><TH>IAMLine21Decoder methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IAMLine21Decoder.htm#GetDecoderLevel">GetDecoderLevel</A>
</TD><TD>Retrieves the closed-captioned decoder level.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#GetCurrentService">GetCurrentService</A>
</TD><TD>Retrieves the current closed captioning service selected by the user.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#SetCurrentService">SetCurrentService</A>
</TD><TD>Sets the current closed captioning service.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#GetServiceState">GetServiceState</A>
</TD><TD>Retrieves the closed captioning service state (on or off). 
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#SetServiceState">SetServiceState</A>
</TD><TD>Sets the closed captioning service state. 
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#GetOutputFormat">GetOutputFormat</A>
</TD><TD>Retrieves information about output video characteristics such as size and bit depth.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#SetOutputFormat">SetOutputFormat</A>
</TD><TD>Sets information that describes output video characteristics such as size and bit depth.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#GetBackgroundColor">GetBackgroundColor</A>
</TD><TD>Retrieves the physical color to use as background for overlays.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#SetBackgroundColor">SetBackgroundColor</A>
</TD><TD>Sets the physical color to use as background for overlays.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#GetRedrawAlways">GetRedrawAlways</A>
</TD><TD>Retrieves whether the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_R.htm#renderer')">renderer</A> should redraw the whole output bitmap for each sample.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#SetRedrawAlways">SetRedrawAlways</A>
</TD><TD>Sets whether the renderer should redraw the whole output bitmap for each sample.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#GetDrawBackgroundMode">GetDrawBackgroundMode</A>
</TD><TD>Retrieves whether the caption text background should be opaque or transparent.
</TD></TR><TR><TD><A HREF="IAMLine21Decoder.htm#SetDrawBackgroundMode">SetDrawBackgroundMode</A>
</TD><TD>Sets whether to make the caption text background opaque or transparent.
</TD></TR></TABLE>



<H1><A NAME="GetBackgroundColor">IAMLine21Decoder::GetBackgroundColor</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Retrieves the physical color to use as background for overlays.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>GetBackgroundColor</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwPhysColor</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>pdwPhysColor</I>
 </DT><DD>Pointer to the retrieved <A HREF="../../appendixes/Further_Reading.htm#DWORD">DWORD</A> value. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Magenta is the default background color.</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#SetBackgroundColor">IAMLine21Decoder::SetBackgroundColor</A></BLOCKQUOTE>


<H1><A NAME="GetCurrentService">IAMLine21Decoder::GetCurrentService</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Retrieves the current closed captioning service selected by the user.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>GetCurrentService</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCSERVICE</B> <I>*lpService</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpService</I>
 </DT><DD>Pointer to the current service. This value is a member of the <A HREF="../dtypes.htm#AM_LINE21_CCSERVICE">AM_LINE21_CCSERVICE</A> enumerated data type. The default service is <A HREF="../dtypes.htm#AM_L21_CCSERVICE_Cap">AM_L21_CCSERVICE_Caption1</A>.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#SetCurrentService">IAMLine21Decoder::SetCurrentService</A></BLOCKQUOTE>


<H1><A NAME="GetDecoderLevel">IAMLine21Decoder::GetDecoderLevel</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Retrieves the closed-captioned decoder level.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>GetDecoderLevel</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCLEVEL</B> <I>*lpLevel</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpLevel</I>
 </DT><DD>Pointer to the retrieved decoder level. <A HREF="../dtypes.htm#AM_L21_CCLEVEL_TC2">AM_L21_CCLEVEL_TC2</A> (TC2) is the only supported operating channel level and is an enhanced and backward-compatible version of the original TC1 level.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>This method is for informational purposes only. 

<P>TC1 and TC2 are television set decoder levels that represent whether the television can handle some closed-captioned byte pairs and produce the desired captioning results. The Line 21 Decoder is capable of TC2 level decoding, which includes all TC1 decoding. Only the first 100,000 television sets manufactured that included closed-captioned capability were TC1 compliant; the later TV sets are TC2 compliant.</BLOCKQUOTE>


<H1><A NAME="GetDrawBackgroundMode">IAMLine21Decoder::GetDrawBackgroundMode</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Retrieves whether the caption text background should be opaque or transparent.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>GetDrawBackgroundMode</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_DRAWBGMODE</B> <I>*lpMode</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpMode</I>
 </DT><DD>Retrieved mode. Supported mode values are <A HREF="../dtypes.htm#AM_L21_DRAWBGMODE_Op">AM_L21_DRAWBGMODE_Opaque</A> and <A HREF="../dtypes.htm#AM_L21_DRAWBGMODE_Tr">AM_L21_DRAWBGMODE_Transparent</A>.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>By default, the caption background is opaque.</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#SetDrawBackgroundMode">IAMLine21Decoder::SetDrawBackgroundMode</A></BLOCKQUOTE>


<H1><A NAME="GetOutputFormat">IAMLine21Decoder::GetOutputFormat</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Retrieves information about output video characteristics such as size and bit depth.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>GetOutputFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>LPBITMAPINFOHEADER</B> <I>lpbmih</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpbmih</I>
 </DT><DD>Pointer to the retrieved <A HREF="../../filtdev/DV_Data_AVI_File_Format.htm#BITMAPINFOHEADER_AVI">BITMAPINFOHEADER</A> structure.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

<P>If successful, the default implementation returns S_FALSE if <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#downstream_filter')">downstream filters</A> haven't defined an output format, or S_OK if an output format has been defined.</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The default video output size is 320 &#215; 240 pixels.</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#SetOutputFormat">IAMLine21Decoder::SetOutputFormat</A></BLOCKQUOTE>


<H1><A NAME="GetRedrawAlways">IAMLine21Decoder::GetRedrawAlways</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Retrieves whether the renderer should redraw the whole output bitmap for each sample.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>GetRedrawAlways</B><B>(</B><BR>&nbsp;&nbsp;<B>LPBOOL</B> <I>lpbOption</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpbOption</I>
 </DT><DD>Pointer to a value indicating whether the whole bitmap should be redrawn; FALSE by default, indicating don't always redraw. TRUE means always redraw.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#SetRedrawAlways">IAMLine21Decoder::SetRedrawAlways</A></BLOCKQUOTE>


<H1><A NAME="GetServiceState">IAMLine21Decoder::GetServiceState</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Retrieves the closed captioning service state (on or off). 
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>GetServiceState</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCSTATE</B> <I>*lpState</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpState</I>
 </DT><DD>Pointer to the retrieved state. Supported state values are <A HREF="../dtypes.htm#AM_L21_CCSTATE_On">AM_L21_CCSTATE_On</A> and <A HREF="../dtypes.htm#AM_L21_CCSTATE_Off">AM_L21_CCSTATE_Off</A>. Closed-captioned text is off by default.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#SetServiceState">IAMLine21Decoder::SetServiceState</A></BLOCKQUOTE>


<H1><A NAME="SetBackgroundColor">IAMLine21Decoder::SetBackgroundColor</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Sets the physical color to use as background for overlays.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>SetBackgroundColor</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwPhysColor</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>dwPhysColor</I>
 </DT><DD><A HREF="../../appendixes/Further_Reading.htm#DWORD">DWORD</A> value that specifies the physical background color. 
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Magenta is the default background color.</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#GetBackgroundColor">IAMLine21Decoder::GetBackgroundColor</A></BLOCKQUOTE>


<H1><A NAME="SetCurrentService">IAMLine21Decoder::SetCurrentService</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Sets the current closed captioning service.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>SetCurrentService</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCSERVICE</B> <I>Service</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>Service</I>
 </DT><DD>Specified service. This value is a member of the <A HREF="../dtypes.htm#AM_LINE21_CCSERVICE">AM_LINE21_CCSERVICE</A> enumerated data type. The default service is <A HREF="../dtypes.htm#AM_L21_CCSERVICE_Cap">AM_L21_CCSERVICE_Caption1</A>.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#GetCurrentService">IAMLine21Decoder::GetCurrentService</A></BLOCKQUOTE>


<H1><A NAME="SetDrawBackgroundMode">IAMLine21Decoder::SetDrawBackgroundMode</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Sets whether to make the caption text background opaque or transparent.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>SetDrawBackgroundMode</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_DRAWBGMODE</B> <I>Mode</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>Mode</I>
 </DT><DD>Mode to set. Supported mode values are <A HREF="../dtypes.htm#AM_L21_DRAWBGMODE_Op">AM_L21_DRAWBGMODE_Opaque</A> and <A HREF="../dtypes.htm#AM_L21_DRAWBGMODE_Tr">AM_L21_DRAWBGMODE_Transparent</A>.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>By default, the caption background is opaque.</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#GetDrawBackgroundMode">IAMLine21Decoder::GetDrawBackgroundMode</A></BLOCKQUOTE>


<H1><A NAME="SetOutputFormat">IAMLine21Decoder::SetOutputFormat</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Sets information that describes output video characteristics such as size and bit depth.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>SetOutputFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>LPBITMAPINFO</B> <I>lpbmi</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>lpbmi</I>
 </DT><DD>Pointer to the specified <A HREF="../../filtdev/DV_Data_AVI_File_Format.htm#BITMAPINFO">BITMAPINFO</A> structure containing the desired output format.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. </BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>The default video output size is 320 &#215; 240 pixels.</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#GetOutputFormat">IAMLine21Decoder::GetOutputFormat</A></BLOCKQUOTE>


<H1><A NAME="SetRedrawAlways">IAMLine21Decoder::SetRedrawAlways</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Sets whether the renderer should redraw the whole output bitmap for each sample.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>SetRedrawAlways</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bOption</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>bOption</I>
 </DT><DD>Value indicating whether the whole bitmap should be redrawn. TRUE indicates redraw always, FALSE means do not redraw always.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE><P>Call this method from your filter if it dirties the buffer that it provides to the Line 21 Decoder filter. Typically, a mixer filter resides in the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A> directly downstream from the Line 21 Decoder filter. The mixer filter should call this method and set <I>bOption</I> to TRUE to ensure the entire bitmap is redrawn properly.

<P>A downstream mixer (or any filter that needs to do so) should only call this method with <I>bOption</I> set to TRUE if it provides the same buffer to the Line 21 Decoder as it uses to mix secondary video streams(s).

<P> Redrawing (setting <I>bOption</I> to TRUE) degrades performance and increases CPU load, because it negates any potential optimizations.</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#GetRedrawAlways">IAMLine21Decoder::GetRedrawAlways</A></BLOCKQUOTE>


<H1><A NAME="SetServiceState">IAMLine21Decoder::SetServiceState</A><HR size=1></H1>
<A HREF="IAMLine21Decoder.htm">IAMLine21Decoder Interface</A>
<P>Sets the closed captioning service state. 
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE><B>HRESULT</B> <B>SetServiceState</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCSTATE</B> <I>State</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE><DL><DT><I>State</I>
 </DT><DD>Specified state. Supported state values are <A HREF="../dtypes.htm#AM_L21_CCSTATE_On">AM_L21_CCSTATE_On</A> and <A HREF="../dtypes.htm#AM_L21_CCSTATE_Off">AM_L21_CCSTATE_Off</A>. Closed-captioned text is off by default.
</DD></DL></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE><P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE><P><A HREF="IAMLine21Decoder.htm#GetServiceState">IAMLine21Decoder::GetServiceState</A></BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
