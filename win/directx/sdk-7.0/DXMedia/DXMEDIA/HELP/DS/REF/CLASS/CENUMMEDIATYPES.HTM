<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CEnumMediaTypes Class</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CEnumMediaTypes Class">
<META NAME="Description" CONTENT="AddRef (CEnumMediaTypes)">
<META NAME="Description" CONTENT="CEnumMediaTypes::AddRef">
<META NAME="Description" CONTENT="CEnumMediaTypes (CEnumMediaTypes)">
<META NAME="Description" CONTENT="CEnumMediaTypes::CEnumMediaTypes">
<META NAME="Description" CONTENT="Clone (CEnumMediaTypes)">
<META NAME="Description" CONTENT="CEnumMediaTypes::Clone">
<META NAME="Description" CONTENT="Next (CEnumMediaTypes)">
<META NAME="Description" CONTENT="CEnumMediaTypes::Next">
<META NAME="Description" CONTENT="QueryInterface (CEnumMediaTypes)">
<META NAME="Description" CONTENT="CEnumMediaTypes::QueryInterface">
<META NAME="Description" CONTENT="Release (CEnumMediaTypes)">
<META NAME="Description" CONTENT="CEnumMediaTypes::Release">
<META NAME="Description" CONTENT="Reset (CEnumMediaTypes)">
<META NAME="Description" CONTENT="CEnumMediaTypes::Reset">
<META NAME="Description" CONTENT="Skip (CEnumMediaTypes)">
<META NAME="Description" CONTENT="CEnumMediaTypes::Skip">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CEnumMediaTypes"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CEnumMediaTypes Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CEnumMediaTypes Class"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="CDrawImage.htm">CDrawImage Class</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CEnumPins.htm">CEnumPins Class</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>CEnumMediaTypes Class</H1>

<P><IMG SRC="../../art/filter04.gif" WIDTH="195" HEIGHT="52" ALT="CEnumMediaTypes class hierarchy">

<P>This class provides the mechanism for enumerating the pin's preferred media types.
Its constructor must be passed to an object from a class derived from <A HREF="CBasePin.htm">CBasePin</A>.
It uses the virtual member function <A HREF="CBasePin.htm#GetMediaType">GetMediaType</A> to
retrieve each of the media types in turn. It also uses the pin's
<A HREF="CBasePin.htm#GetMediaTypeVersion">CBasePin::GetMediaTypeVersion</A> member function to determine if the
number or type of media types has changed.

<P>The base <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#pin')">pin</A> class does not support dynamic media type changes. <A HREF="CBaseFilter.htm#GetPinVersion">CBaseFilter::GetPinVersion</A>
always returns the same value, for example.

<P>The media type enumerator must fill in a list of pointers to media type structures. 
The memory for those media type structures must be released by the callers when they have 
finished with it. However, the memory must not be allocated from any language-specific heap; otherwise, problems might occur between a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> written in C and another written in C++. 
For this reason, the base classes provide generic functions (not member functions of a class) 
to create and delete media types: <A HREF="../utilfunct/Media_Type_functs.htm#CreateMediaType">CreateMediaType</A> and <A HREF="../utilfunct/Media_Type_functs.htm#DeleteMediaType">DeleteMediaType</A>. These manage memory allocation from the task allocator.

<P>All member functions in this class that return <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> and accept a pointer as a 
parameter return E_POINTER when passed a null pointer. 

<A NAME="Member_Functions"></A><P CLASS="ref">Member Functions</P>

<TABLE><TR><TD><A HREF="CEnumMediaTypes.htm#CEnumMediaTypes_CEnumMediaTypes">CEnumMediaTypes</A>
</TD><TD>Constructs a <A HREF="CEnumMediaTypes.htm">CEnumMediaTypes</A> object.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Implemented_IUnknown"></A>Implemented IUnknown Methods</P>
<TABLE><TR><TD><A HREF="CEnumMediaTypes.htm#CEnumMediaTypes_AddRef">AddRef</A> 
 </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="CEnumMediaTypes.htm#CEnumMediaTypes_QueryInterface">QueryInterface</A> 
 </TD><TD>Retrieves pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="CEnumMediaTypes.htm#CEnumMediaTypes_Release">Release</A> 
 </TD><TD>Decrements the reference count.
</TD></TR></TABLE>
<P CLASS="ref"><A NAME="Implemented_IEnumMed"></A>Implemented IEnumMediaTypes Methods</P>
<TABLE><TR><TD><A HREF="CEnumMediaTypes.htm#Clone">Clone</A>
 </TD><TD>Creates a duplicate <A HREF="CEnumMediaTypes.htm">CEnumMediaTypes</A> object with the same state.
</TD></TR><TR><TD><A HREF="CEnumMediaTypes.htm#Next">Next</A>
 </TD><TD>Returns the next media type after the current position.
</TD></TR><TR><TD><A HREF="CEnumMediaTypes.htm#Reset">Reset</A>
 </TD><TD>Sets the current position back to the beginning.
</TD></TR><TR><TD><A HREF="CEnumMediaTypes.htm#Skip">Skip</A>
 </TD><TD>Skips over one or more entries in the enumerator.
</TD></TR></TABLE>



<H1><A NAME="CEnumMediaTypes_AddRef">CEnumMediaTypes::AddRef</A><HR size=1></H1>
<A HREF="CEnumMediaTypes.htm">CEnumMediaTypes Class</A>
<P>Increments the reference count for the calling interface on an object.
It should be called for every new copy of a pointer to an interface on a given object.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>ULONG</B> <B>AddRef</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an integer from 1 to <I>n</I>, the value of the new reference count.
This information is meant to be used for diagnostic/testing purposes only,
because, in certain situations, the value might be unstable.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IUnknown.htm#AddRef">IUnknown::AddRef</A> method.
</BLOCKQUOTE>


<H1><A NAME="CEnumMediaTypes_CEnumMediaTypes">CEnumMediaTypes::CEnumMediaTypes</A><HR size=1></H1>
<A HREF="CEnumMediaTypes.htm">CEnumMediaTypes Class</A>
<P>Constructs a <A HREF="CEnumMediaTypes.htm">CEnumMediaTypes</A> object.
<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<P><B>CEnumMediaTypes</B><B>(</B><BR>&nbsp;&nbsp;<B>CBasePin</B> <I>*pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>CEnumMediaTypes</B> <I>*pEnumMediaTypes</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pPin</I>
</DT><DD>Pointer to the pin on which the enumeration is to be performed.
</DD><DT><I>pEnumMediaTypes</I>
</DT><DD>Pointer to the instantiated <A HREF="CEnumMediaTypes.htm">CEnumMediaTypes</A> object.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This is a standard class constructor.


</BLOCKQUOTE>


<H1><A NAME="Clone">CEnumMediaTypes::Clone</A><HR size=1></H1>
<A HREF="CEnumMediaTypes.htm">CEnumMediaTypes Class</A>
<P>Retrieves another enumerator containing the same enumeration state as the current one.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Clone</B><B>(</B><BR>&nbsp;&nbsp;<B>IEnumMediaTypes</B> <B>**</B> <I>ppEnum</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ppEnum</I>
</DT><DD>New copy of the enumerator.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IEnumMediaTypes.htm#Clone">IEnumMediaTypes::Clone</A> method.
</BLOCKQUOTE>


<H1><A NAME="Next">CEnumMediaTypes::Next</A><HR size=1></H1>
<A HREF="CEnumMediaTypes.htm">CEnumMediaTypes Class</A>
<P>Retrieves the specified number of items in the enumeration sequence.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Next</B><B>(</B><BR>&nbsp;&nbsp;<B>ULONG</B> <I>cMediaTypes</I><B>,</B><BR>&nbsp;&nbsp;<B>AM_MEDIA_TYPE**</B> <I>ppMediaTypes</I><B>,</B><BR>&nbsp;&nbsp;<B>ULONG</B> <B>*</B> <I>pcFetched</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>cMediaTypes</I>
 </DT><DD>Number of media types to place.
</DD><DT><I>ppMediaTypes</I>
 </DT><DD>Array in which to place the next media type or types.
</DD><DT><I>pcFetched</I>
 </DT><DD>Actual count passed.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IEnumMediaTypes.htm#Next">IEnumMediaTypes::Next</A> method.
To call this method, pass a pointer's address to a
media type. The base class implementation relies on the existence of an
overridden <A HREF="CBasePin.htm#GetMediaType">CBasePin::GetMediaType</A> member function in the derived
class that will provide the next media type.

<P>Free each media type acquired by calling <A HREF="../utilfunct/Media_Type_functs.htm#DeleteMediaType">DeleteMediaType</A>, which will free the
format block and the media type itself.

</BLOCKQUOTE>


<H1><A NAME="CEnumMediaTypes_QueryInterface">CEnumMediaTypes::QueryInterface</A><HR size=1></H1>
<A HREF="CEnumMediaTypes.htm">CEnumMediaTypes Class</A>
<P>Retrieves a pointer to a specified interface on a component to which a
client currently holds an interface pointer. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>QueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>iid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <B>**</B> <I>ppvObject</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>iid</I>
 </DT><DD>Specifies the IID of the interface being requested.
</DD><DT><I>ppvObject</I>
 </DT><DD>Receives a pointer to an interface pointer to the object on return.
If the interface specified in <I>iid</I> is not supported
by the object, <I>ppvObject</I> is set to NULL.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if the interface is supported, S_FALSE if not.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IUnknown.htm#QueryInterface">IUnknown::QueryInterface</A> method
and passes out references to the <A HREF="../iface/IEnumMediaTypes.htm">IEnumMediaTypes</A> interface.
Override this class to return other interfaces on the object in the derived class.
</BLOCKQUOTE>


<H1><A NAME="CEnumMediaTypes_Release">CEnumMediaTypes::Release</A><HR size=1></H1>
<A HREF="CEnumMediaTypes.htm">CEnumMediaTypes Class</A>
<P>Decrements the reference count for the calling interface on an object.
If the reference count on the object falls to zero, the object is freed from memory.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>ULONG</B> <B>Release</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the resulting value of the reference count, which is used for
diagnostic/testing purposes only. If you need to know that resources have been freed,
use an interface with higher-level semantics.


</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IUnknown.htm#Release">IUnknown::Release</A> method.
</BLOCKQUOTE>


<H1><A NAME="Reset">CEnumMediaTypes::Reset</A><HR size=1></H1>
<A HREF="CEnumMediaTypes.htm">CEnumMediaTypes Class</A>
<P>Resets the enumerator to the beginning so that the next call to the
<A HREF="../iface/IEnumMediaTypes.htm#Next">IEnumMediaTypes::Next</A> method will return, at a minimum,
the first media type in the enumeration.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Reset</B><B>(</B><B>void</B><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK if successful; otherwise, returns S_FALSE.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IEnumMediaTypes.htm#Reset">IEnumMediaTypes::Reset</A> method.
</BLOCKQUOTE>


<H1><A NAME="Skip">CEnumMediaTypes::Skip</A><HR size=1></H1>
<A HREF="CEnumMediaTypes.htm">CEnumMediaTypes Class</A>
<P>Skips a specified number of elements in the enumeration sequence.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE><PRE>
<P><B>HRESULT</B> <B>Skip</B><B>(</B><BR>&nbsp;&nbsp;<B>ULONG</B> <I>cMediaTypes</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>cMediaTypes</I>
</DT><DD>Number of media type elements to skip.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This member function implements the <A HREF="../iface/IEnumMediaTypes.htm#Skip">IEnumMediaTypes::Skip</A> method.

</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
