<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IDDrawExclModeVideoCallback Interface</TITLE>
<SCRIPT> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IDDrawExclModeVideoCallback">
<META NAME="Description" CONTENT="IDDrawExclModeVideoCallback::OnUpdateOverlay">
<META NAME="Description" CONTENT="IDDrawExclModeVideoCallback::OnColorKeyChange">
<META NAME="Description" CONTENT="OnUpdateOverlay (IDDrawExclModeVideoCallback)">
<META NAME="Description" CONTENT="OnColorKeyChange (IDDrawExclModeVideoCallback)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDDrawExclModeVideoCallback"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="iddrawexclmodevideo.htm">IDDrawExclModeVideo Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IDeferredCommand.htm">IDeferredCommand Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->


<H1>IDDrawExclModeVideoCallback Interface</H1>

<P>The <B>IDDrawExclModeVideoCallback</B> interface enables applications to get synchronous notification about changes to the overlay position, size, visibility, and so on, so that the application can adjust its video visibility, size, and position. This avoids any color key flash at the beginning, end, or during playback. The application must implement a COM object supporting this interface. For an example application, see the DDrawXcl sample application in Samples\Multimedia\DShow\src\DDrawXcl subdirectory. For more information, see the description of the example in <A HREF="../../FiltSamp/C_C++_Samp_Apps.htm#DDrawXcl">DDrawXcl Sample (DirectDraw Exclusive Mode Video Playback Application)</A>. 

<P CLASS="ref"><A NAME="When_to_Implement">When to Implement</A></P>
<P>Implement this interface if you are using an <A HREF="iddrawexclmodevideo.htm">IDDrawExclModeVideo</A>
interface and want the callback information (presumably always).

<P CLASS="ref"><A NAME="When_to_Use">When to Use</A></P>
<P>Use this interface if you're using the Microsoft&reg; DirectShow&#153; <A HREF="../../FiltSamp/Overlay_Mixer.htm">Overlay Mixer</A> filter, and more generally if you are writing a filter that supports <B>IDDrawExclModeVideo</B> or needs to generate callbacks to enable an application to draw color keys at the right time.

<P CLASS="ref"><A NAME="Methods_in_Vtable_Or">Methods in Vtable Order</A></P>
<TABLE>
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR><TR><TD><A HREF="IUnknown.htm#QueryInterface">QueryInterface</A></TD><TD>Retrieves pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="IUnknown.htm#AddRef">AddRef</A></TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="IUnknown.htm#Release">Release</A></TD><TD>Decrements the reference count.
</TD></TR><TR></TR>

<TR><TH>IDDrawExclModeVideoCallback methods</TH><TH>Description</TH></TR>

<TR><TD><A HREF="IDDrawExclModeVideoCallback.htm#OnUpdateOverlay">OnUpdateOverlay</A>
 </TD><TD>Informs the application when the overlay surface for the video is about to change.
</TD></TR>
<TR><TD><A HREF="IDDrawExclModeVideoCallback.htm#OnColorKeyChange">OnColorKeyChange</A>
 </TD><TD>Informs the application that the color key has changed so that the application can use the new color key to overlay graphics on the video.
</TD></TR>
</TABLE>




<H1><A NAME="OnColorKeyChange">IDDrawExclModeVideoCallback::OnColorKeyChange</A><HR size=1></H1>
<A HREF="IDDrawExclModeVideoCallback.htm">IDDrawExclModeVideoCallback Interface</A>

<P>Informs the application that the color key has changed so that the application can use the new color key to overlay graphics on the video.

<P CLASS="ref">Syntax</P><BLOCKQUOTE><PRE>
<B>HRESULT</B> <B>OnColorKeyChange (</B><BR>&nbsp;&nbsp;<B>COLORKEY</B> const <I>*pKey</I>,<BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwColor</I><BR><B>)</B><B>;</B>
</PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pKey</I>
 </DT><DD>[out] Pointer to a <A HREF="../structs.htm#COLORKEY">COLORKEY</A> structure that contains the key type and a palette index. 
</DD><DT><I>dwColor</I>
 </DT><DD>[out] Value indicating the 8-bit palette index of the <A HREF="../structs.htm#COLORKEY">COLORKEY</A> returned in <I>pKey</I>, if the current display mode is 8-bit palettized. Otherwise, it is a value representing the color key in the pixel format of the current display mode.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

<P>The current DirectShow implementation return values include the following:
<TABLE>
<TR><TD>S_OK</TD><TD>Success.
</TD></TR>
<TR><TD>E_INVALIDARG</TD><TD>One of the parameters is invalid.</TD></TR>
</TABLE>
</BLOCKQUOTE>



<H1><A NAME="OnUpdateOverlay">IDDrawExclModeVideoCallback::OnUpdateOverlay</A><HR size=1></H1>
<A HREF="IDDrawExclModeVideoCallback.htm">IDDrawExclModeVideoCallback Interface</A>

<P>Informs the application when the overlay surface for the video is about to become visible, invisible, change size, or change position, so that the application can repaint its window appropriately. 

<P CLASS="ref">Syntax</P><BLOCKQUOTE>
<PRE>
<B>HRESULT</B>&nbsp;&nbsp;<B>OnUpdateOverlay(</B> <BR>&nbsp;&nbsp;<B>BOOL</B>&nbsp;&nbsp;<I>bBeforeChange</I>,<BR>&nbsp;&nbsp;<B>DWORD</B>&nbsp;&nbsp;<I>dwFlags</I>,<BR>&nbsp;&nbsp;<B>BOOL</B>&nbsp;&nbsp;<I>bOldVisible</I>, <BR>&nbsp;&nbsp;<B>LPRECT</B>&nbsp;&nbsp;<I>*prcSrcOld</I>,<BR>&nbsp;&nbsp;<B>LPRECT</B>&nbsp;&nbsp;<I>*prcDestOld</I>,<BR>&nbsp;&nbsp;<B>BOOL</B>&nbsp;&nbsp;<I>bNewVisible</I>,<BR>&nbsp;&nbsp;<B>LPRECT</B>&nbsp;&nbsp;<I>*prcSrcNew</I>,<BR>&nbsp;&nbsp;<B>LPRECT</B>&nbsp;&nbsp;<I>*prcDestNew</I>,<B><BR>)</B><B>;</B> </PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>bBeforeChange</I>
 </DT><DD>[in] Boolean value specifying whether the call is being made before or after the overlay-related change. TRUE specifies before, FALSE specifies after.
<DT><I>dwFlags</I>
 </DT><DD>[in] Value from the <A HREF="../dtypes.htm#AM_OVERLAY_NOTIFY_FLAGS">AM_OVERLAY_NOTIFY_FLAGS</A> data type that specifies what is about to change or what changed.
<DT><I>bOldVisible</I>
 </DT><DD>[in] Boolean value specifying whether the old window is visible. TRUE means the old window is visible.
<DT><I>prcSrcOld</I>
 </DT><DD>[in] Pointer to the rectangle representing the old source position of the DirectDraw surface.
<DT><I>prcDestOld</I>
 </DT><DD>[in] Pointer to the rectangle representing the old destination position of the rectangle in the overlay surface.
<DT><I>bNewVisible</I>
 </DT><DD>[in] Boolean specifying whether the new window is visible. TRUE means the new window is visible.
<DT><I>prcSrcNew</I>
 </DT><DD>[in] Pointer to the rectangle representing the new source position of the DirectDraw surface.
<DT><I>prcDestNew</I>
 </DT><DD>[in] Pointer to the rectangle representing the new destination position of the rectangle in the overlay surface.
</DD></DL>

</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../Error_Success_Codes.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

<P>The current DirectShow implementation return values include the following:

<TABLE>
<TR><TD>S_OK </TD><TD>Success.
</TD></TR>
<TR><TD>E_INVALIDARG </TD><TD>Invalid parameter.</TD></TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<P>The application should call this method once before the overlay-related change occurs and once after the changes are done. In the call before the change, the overlay change doesn't happen until the application completes executing this method.

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
