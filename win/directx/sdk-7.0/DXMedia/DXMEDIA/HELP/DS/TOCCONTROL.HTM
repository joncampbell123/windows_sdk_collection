<!-- This document was created with HomeSite 2.5 -->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<HTML>
<HEAD>
<TITLE>Toc Control Scriptlet</TITLE>
<SCRIPT LANGUAGE="JavaScript">
var doc = new Object();
var win = new Object();
var image_on = '';
var image_off = '';
public_description = new TocControl();

function TocControl(){
	this.printStr = printStr;
	this.setTarget = setTarget;
	this.setVar = setVar;
	this.tree = tree;
}

function printStr(str){
	debug(str);
}

//

function setVar(WINDOW, DOCUMENT, IMAGE_ON, IMAGE_OFF){
	win = WINDOW;
	doc = DOCUMENT;
	image_on = IMAGE_ON;
	image_off = IMAGE_OFF;
}

//

function setTarget(str){
	if (win.top != self) {
		if (win.top.frames.length > 1 && win.top.frames[1].name==str) {
			for (i=0; i<doc.links.length; i++) {
				if (doc.links(i).target=="")
					doc.links(i).target=str;
			}
		}
	}
}

//

function tree(src){
	//

	if ((src.tagName == "A")||(src.tagName == "IMG")) {
		var i = 0;
		
		//

		for (var TAG_PARENT = src.parentElement; TAG_PARENT != null; TAG_PARENT = TAG_PARENT.parentElement) {
			
			//

			if(TAG_PARENT.tagName == "LI") { 
				setIfNode(TAG_PARENT);
				break;
			}
			
			//

			if (i == 4) break;
			i++;
		}
	}
}

//

function setIfNode(src){
	var i = 0;
	
	//

	while (src.children(i) != null){
	
		//

		if (src.children(i).tagName == "A") { 
			if (src.children(i).children(0)) 
				if (src.children(i).children(0).className == "FLIP" )
					var IMAGE = src.children(i).children(0)
		}
		
		//

		if (src.children(i).tagName == "DIV") {
			if (src.children(i).className == "Outline"){
				var NODE = src.children(i);
				break;
			}else {alert("Improper DIV CLASS for this request!"); break;}
		}
		
		//

		if (i==4) break;
		i++
	}
	if (NODE) displayMode(NODE,IMAGE);
}

//

function displayMode(src,image){
	if (src){
		
		if ('none' == src.style.display) {
			src.style.display = '';
			//

			if(image) image.src = image_on; 
		}
		else{ 
			src.style.display = 'none';
			//

			if(image) image.src = image_off ;
			
			//<!-- Colapse all children elements -->

			collapseChildren(src);
		}
	}
	
}

//

function collapseChildren(src) {
    var i;
    var div = doc.all.tags("DIV");
    for (i=0; i<div.length; i++) {
        if (div(i).sourceIndex < src.sourceIndex) continue;
        if (src.contains(div(i)) != true) return;
        if (div(i).className == "Outline") {div(i).style.display = "none" };
    }
}

function debug(str){
	div_debug.innerText = div_debug.innerText + " \n" + str
}



	//

	

	/* src.tagName : Get tag name*/ 
	/* src.className : Returns Class Name*/ 
	/* src.parentElement : returns patern elemnt */
	/* src.sourceIndex : index position for this element */
	/* (parentDiv.contains(div(i)) != true) ?? how does "contains" work */
</SCRIPT>
</HEAD>
<BODY>
<DIV ID=div_debug><DIV>


<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
</BODY>
</HTML>
