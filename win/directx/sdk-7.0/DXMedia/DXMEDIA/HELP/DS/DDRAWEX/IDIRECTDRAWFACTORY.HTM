<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>IDirectDrawFactory Interface</TITLE>
<SCRIPT> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IDirectDrawFactory Interface">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<META NAME="DESCRIPTION" CONTENT="Create and enumerate DirectDraw objects that support the extended features of DirectDrawEx">
<META NAME="KEYWORDS" CONTENT="IDirectDrawFactory">

<META NAME="Description" CONTENT="IDirectDrawFactory::CreateDirectDraw">
<META NAME="Description" CONTENT="IDirectDrawFactory::DirectDrawEnumerate">
<META NAME="Description" CONTENT="CreateDirectDraw (IDirectDrawFactory)">
<META NAME="Description" CONTENT="DirectDrawEnumerate (IDirectDrawFactory)">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDirectDrawFactory"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IDirectDrawFactory Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IDirectDrawFactory Interface"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="DDrawEx_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Using_DDrawEx.htm">Using DirectDrawEx</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IDirectDraw3.htm">IDirectDraw3 Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IDirectDrawFactory Interface</H1>

<P>The <B>IDirectDrawFactory</B> interface is used to create and enumerate DirectDraw objects that support the extended features of DirectDrawEx (see <A HREF="Using_DDrawEx.htm">Using DirectDrawEx</A> for more information). 

<A NAME="When_to_Implement"></A><P CLASS="ref">When to Implement</P>
<P>Do not implement this interface; DirectDrawEx implements it for you.

<A NAME="When_to_Use"></A><P CLASS="ref">When to Use</P>
<P>Use this interface in an application when you want to create a DirectDrawEx object.

<A NAME="Methods_in_Vtable_Or"></A><P CLASS="ref">Methods in Vtable Order</P>
<BLOCKQUOTE><TABLE CLASS="ref">
<TR><TH>IUnknown methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../ref/iface/IUnknown.htm#QueryInterface">QueryInterface</A> </TD><TD>Retrieves pointers to supported interfaces.
</TD></TR><TR><TD><A HREF="../ref/iface/IUnknown.htm#AddRef">AddRef</A> </TD><TD>Increments the reference count.
</TD></TR><TR><TD><A HREF="../ref/iface/IUnknown.htm#Release">Release</A> </TD><TD>Decrements the reference count.
</TD></TR>
<TR></TR>
<TR><TH>IDirectDrawFactory methods</TH><TH>Description</TH></TR>
<TR><TD><A HREF="IDirectDrawFactory.htm#CreateDirectDraw">CreateDirectDraw</A>
 </TD><TD>Creates a DirectDraw object and retrieves pointers to the <A HREF="../ref/iface/IUnknown.htm">IUnknown</A> and the <A HREF="../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interfaces.
</TD></TR><TR><TD><A HREF="IDirectDrawFactory.htm#DirectDrawEnumerate">DirectDrawEnumerate</A>
 </TD><TD>Enumerates the DirectDraw surfaces installed on the system.
</TD></TR></TABLE></BLOCKQUOTE>

<H1><A NAME="CreateDirectDraw">IDirectDrawFactory::CreateDirectDraw</A><HR size=1></H1>
<A HREF="IDirectDrawFactory.htm">IDirectDrawFactory Interface</A>
<P>Creates a DirectDraw object and retrieves a pointer to its <A HREF="../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>STDMETHOD</B> <B>CreateDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>GUID</B> <B>*</B> <I>pGUID</I><B>,</B><BR>&nbsp;&nbsp;<B>HWND</B> <I>hWnd</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwCoopLevelFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwReserved</I><B>,</B><BR>&nbsp;&nbsp;<B>IUnknown</B> <I>*pUnkOuter</I><B>,</B><BR>&nbsp;&nbsp;<B>IDirectDraw</B> <I>**ppDirectDraw</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pGUID</I>
 </DT><DD>[out] Pointer to the globally unique identifier (<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#GUID')">GUID</A>) that represents the driver to be created. Set this to NULL to indicate the active display driver, or you can pass one of the following flags to restrict the active display driver's behavior for debugging purposes.
<TABLE>
<TR><TD>DDCREATE_EMULATIONONLY
 </TD><TD>The DirectDraw object will use emulation for all features; it will not take advantage of any hardware-supported features.
</TD></TR><TR><TD>DDCREATE_HARDWAREONLY 
 </TD><TD>The DirectDraw object will never emulate features not supported by the hardware. Attempts to call methods that require unsupported features will fail, returning DDERR_UNSUPPORTED (operation not supported).
</TD></TR></TABLE>
</DD><DT><I>hWnd</I>
 </DT><DD>[in] Window handle to the application.
</DD><DT><I>dwCoopLevelFlags</I>
 </DT><DD>[in] Application's top-level behavior. Specify one or more of the following flags.
<TABLE>
<TR><TD>DDSCL_ALLOWMODEX 
 </TD><TD>Enables the use of Mode X display modes. You must use this flag with the DDSCL_EXCLUSIVE and DDSCL_FULLSCREEN flags. </TD></TR><TR><TD>DDSCL_ALLOWREBOOT 
 </TD><TD>Enables the user to reboot by pressing <SMALL>CTRL+ALT+DEL</SMALL> while the application is in full-screen exclusive mode.
</TD></TR><TR><TD>DDSCL_EXCLUSIVE 
 </TD><TD>Requests the exclusive level. You must use this flag with the DDSCL_FULLSCREEN flag. At the full screen and exclusive cooperative level, you can use the hardware to its fullest. In this mode, you can set custom and dynamic palettes, change display resolutions, compact memory, and implement page flipping. The exclusive (full-screen) mode does not prevent other applications from allocating surfaces, nor does it exclude them from using DirectDraw or GDI. However, it does prevent applications other than the one currently with exclusive access from changing the display mode or palette. 
</TD></TR><TR><TD>DDSCL_FULLSCREEN 
 </TD><TD>Indicates that the exclusive-mode owner will be in control of the entire <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#primary_surface')">primary surface</A>. You must use this flag with the DDSCL_EXCLUSIVE flag. 
</TD></TR><TR><TD>DDSCL_NORMAL 
 </TD><TD>Indicates that the application will function as a regular Windows&#174; application. You can't use this flag with the DDSCL_ALLOWMODEX, DDSCL_EXCLUSIVE, or DDSCL_FULLSCREEN flags. 
</TD></TR><TR><TD>DDSCL_NOWINDOWCHANGES 
 </TD><TD>Indicates that DirectDraw can't minimize or restore the application window when the application is activated.
</TD></TR></TABLE>
</DD><DT><I>dwReserved</I>
 </DT><DD>[in] Reserved for future use. Must be NULL.
</DD><DT><I>pUnkOuter</I>
 </DT><DD>[in] Must be NULL. Created for future compatibility with COM aggregation features. Currently, <B>CreateDirectDraw</B> returns an error if this parameter is anything but NULL.
</DD><DT><I>ppDirectDraw</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interface.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns DD_OK if successful, or one of the following error values otherwise.</P>
<TABLE>
<TR><TD>E_OUTOFMEMORY </TD><TD>There isn't enough memory available to create a DirectDraw object.
</TD></TR><TR><TD>DDERR_GENERIC </TD><TD>There is an undefined error condition. 
</TD></TR><TR><TD>DDERR_UNSUPPORTED </TD><TD>DirectDraw doesn't support the operation.
</TD></TR><TR><TD>DDERR_DIRECTDRAWALREADYCREATED </TD><TD>A DirectDrawEx object representing this driver has already been created for this process. 
</TD></TR><TR><TD>DDERR_INVALIDDIRECTDRAWGUID </TD><TD>The <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_G.htm#GUID')">GUID</A> passed to this method is not a valid DirectDrawEx driver identifier. 
</TD></TR><TR><TD>DDERR_INVALIDPARAMS </TD><TD>One or more of the parameters passed to the method are incorrect. 
</TD></TR><TR><TD>DDERR_NODIRECTDRAWHW </TD><TD>Hardware-only DirectDrawEx object creation isn't possible; the driver doesn't support any hardware. 
</TD></TR></TABLE>

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>

<P>This method creates DirectDraw objects in the same way that the <A HREF="../appendixes/Further_Reading.htm#DirectDrawCreate">DirectDrawCreate</A> function is used to create DirectDraw objects, and sets <A HREF="../appendixes/Further_Reading.htm#cooperative_level">cooperative level</A>s the same way the <A HREF="../appendixes/Further_Reading.htm#IDirectDraw2__SetCoo">IDirectDraw2::SetCooperativeLevel</A> method sets cooperative levels. However, in addition to creating a DirectDraw object, successful calls to the <B>IDirectDrawFactory::CreateDirectDraw</B> method will obtain a pointer to the <A HREF="../ref/iface/IUnknown.htm">IUnknown</A> and <A HREF="../appendixes/Further_Reading.htm#IDirectDraw">IDirectDraw</A> interfaces, which are exposed on the DirectDraw object. Applications can now query the DirectDraw object to obtain the address of a pointer to an <A HREF="IDirectDraw3.htm">IDirectDraw3</A> interface. 
</BLOCKQUOTE>

<H1><A NAME="DirectDrawEnumerate">IDirectDrawFactory::DirectDrawEnumerate</A><HR size=1></H1>
<A HREF="IDirectDrawFactory.htm">IDirectDrawFactory Interface</A>
<P>Enumerates the available DirectDraw compatible devices in the system.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>STDMETHOD</B> <B>DirectDrawEnumerate</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDDENUMCALLBACK</B> <I>lpCallback</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpContext</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B></PRE></BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpCallback</I>
 </DT><DD>[in] Pointer to a <A HREF="../appendixes/Further_Reading.htm#DDEnumCallback">DDEnumCallback</A> function that will be called with a description of each DirectDrawEx-enabled hardware abstraction layer (HAL) installed in the system.
</DD><DT><I>lpContext</I>
 </DT><DD>[in] Address of an application-defined structure that the system will pass to the callback function each time the function is called.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>

<P>Returns DD_OK if successful, or DDERR_INVALIDPARAMS otherwise.
</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>

<P>This method functions in a similar manner to the <B>DirectDraw</B> function <B>DirectDrawEnumerate</B>, defined in the DirectX SDK.
</BLOCKQUOTE>



<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
