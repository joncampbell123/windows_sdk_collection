<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>C/C++-based Sample Applications</TITLE>
<SCRIPT> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="C/C++-based Sample Applications">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>

<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicsdkIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicsdkIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicsdkNAV';
   }
   else
   {
	   sCSS += 'dxm_basicsdkIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="C/C++-basedSampleApplications"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- C/C++-based Sample Applications"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdshow.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- C/C++-based Sample Applications"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectShow Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ds_Samples_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Cutlist_Samp_Apps.htm">Cutlist Sample Applications</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="VB_Samp_Apps.htm">Visual Basic-based Sample Applications</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>C/C++-based Sample Applications</H1>

<P>This article details sample applications that are written in C++ or C. The sample applications implement media players or perform other application-related functions. The differences between them are mainly the different programming languages, API, or frameworks used.

<P>Some of these samples use the Microsoft&#174; Foundation Classes (MFC).
<P>This article contains the following sections.
<UL><LI><A HREF="C_C++_Samp_Apps.htm#AMCap">AMCap Sample (DirectShow Capture Application)</A> 
<LI><A HREF="C_C++_Samp_Apps.htm#CPlay">CPlay Sample (C/COM-based Media Player Application)</A>
<LI><A HREF="C_C++_Samp_Apps.htm#DDrawXcl">DDrawXcl Sample (DirectDraw Exclusive Mode Video Playback Application)</A>
<LI><A HREF="C_C++_Samp_Apps.htm#dvdsampl">Dvdsampl Sample (DVD Player Application)</A>
<LI><A HREF="C_C++_Samp_Apps.htm#inwindow">InWindow Sample (Window Playback Application)</A>
<LI><A HREF="C_C++_Samp_Apps.htm#Indeo_Player">IPlay Sample (Indeo Player Application)</A>
<LI><A HREF="C_C++_Samp_Apps.htm#MFCPlay">MFCPlay Sample (C++/COM-based Media Player Application)</A>
<LI><A HREF="C_C++_Samp_Apps.htm#MPEGProp">MPEGProp Sample (MPEG Property Page Display Application)</A>
<LI><A HREF="C_C++_Samp_Apps.htm#playfile">PlayFile Sample (Simple Playback Application)</A>
<LI><A HREF="C_C++_Samp_Apps.htm#ShowStrm">ShowStrm Sample (Multimedia Streaming Application)</A>
<LI><A HREF="C_C++_Samp_Apps.htm#VidClip">VidClip Sample (Video Editing Application)</A>
</UL>
<H2><A NAME="AMCap">AMCap Sample (DirectShow Capture Application)</A></H2>
<P>The DirectShow capture sample, AMCap, demonstrates the basics of capturing audio and video from a hardware source to a specified output file or to a preview window.

<P>To see a list of the hardware capture devices on your system, choose the <B>Devices</B> menu; DirectShow uses the <A HREF="../ref/iface/ICreateDevEnum.htm">ICreateDevEnum</A> interface to create the list of devices that appears. After choosing a device, choose the <B>Set Frame Rate</B> command from the <B>Capture</B> menu and set the desired frame rate; the default value is 30 frames per second. To set an output file for your capture, pick the <B>Set Capture File</B> command from the <B>File</B> menu. DirectShow uses the <A HREF="File_Writer.htm">File Writer</A> <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_f.htm#filter')">filter</A> to associate your specified file with the capture session.

<P>If you want to turn audio capturing on or off, choose the <B>Capture Audio</B> command from the <B>Capture</B> menu. To turn capture previewing on or off, choose the Preview command from the Options menu. When you are ready to begin capturing, choose the <B>Start Capture</B> command from the <B>Capture</B> menu. If you want to save your captured data to a file other than the specified output file, choose the <B>Save Captured Video As</B> command from the <B>File</B> menu.

<P><B>Note:</B>  Before you begin capturing for the first time, choose Allocate File Space from the File menu to preallocate the capture file. Preallocating the file improves capture performance. AMCap calls <A HREF="../ref/iface/ICaptureGraphBuilder.htm#AllocCapFile">AllocCapFile</A> to preallocate the capture file.<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>



<H2><A NAME="CPlay">CPlay Sample (C/COM-based Media Player Application)</A></H2>
<P>This C/COM-based media player sample, CPlay, is a simple application that renders multimedia files using DirectShow&#153; from within the C language. The CPlay sample does not use Microsoft Foundation Classes (MFC). If you want to see a sample that uses MFC, see <A HREF="C_C++_Samp_Apps.htm#MFCPlay">MFCPlay Sample (C++/COM-based Media Player Application)</A>. The CPlay sample shows how to utilize the DirectShow components without using the base classes provided with DirectShow. The sample creates a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_F.htm#filter_graph')">filter graph</A> (by calling <A HREF="../appendixes/Further_Reading.htm#CoCreateInstance">CoCreateInstance</A> to get a pointer to the <A HREF="../ref/iface/IGraphBuilder.htm">IGraphBuilder</A> interface), and requests the filter graph to render a file. The filter graph is then controlled by using the <A HREF="../ref/iface/IMediaControl.htm">IMediaControl</A> interface. This sample also uses the <A HREF="../ref/iface/IMediaEvent.htm">IMediaEvent</A> and <A HREF="../ref/iface/IMediaPosition.htm">IMediaPosition</A> interfaces. 

<P>CPlay is a minimal application that implements the following menu commands: Open, Play, Pause, Stop, and Exit on the File menu, and About on the Help menu.

<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>

<H2><A NAME="DDrawXcl" IDX_CONCEPT="DirectDraw Exclusive Mode Video Playback Application; exclusive full-screen mode, DirectDraw, playing video in">DDrawXcl Sample (DirectDraw Exclusive Mode Video Playback Application)</A></H2>

<P>In Microsoft&reg; DirectShow&#153; 6.<I>x</I>, you can play back video from AVI and MPEG files, as well as DVD titles, even in Microsoft DirectDraw&reg; exclusive full-screen mode. This enables game developers and interactive content developers to create content in full-screen mode and still play back video within it; for example, to play a movie in a certain room within a game.

<P>DirectShow 6.<I>x</I> includes several new components that together offer this capability.
<ul>
<li>An updated <A HREF="Overlay_mixer.htm">Overlay Mixer</A> filter that can now use a DirectDraw object and primary surface provided by an application. Previously, the filter could only use its own surface.

<li>A new COM interface, <A HREF="../ref/iface/iddrawexclmodevideo.htm">IDDrawExclModeVideo</A>, has been added. An application should implement an object that supports this interface to notify the
Overlay Mixer about any changes to the overlay size, position, color key, and so on.

<li>The DVD graph builder object has been updated. Methods in the <A HREF="../ref/iface/IDvdGraphBuilder.htm">IDvdGraphBuilder</A> interface have also been updated to enable applications to use the updated DVD graph builder object to pass the DirectDraw-related information to the
Overlay Mixer for use in DVD playback filter graph building operation. Using methods available on the <B>IDDrawExclModeVideo</B> interface, applications can get the color key information for superimposing graphics on video playing in the background.
</ul>

<P>A sample application, DDrawXcl, has also been added to the SDK samples. This application consists of:
<UL>
<LI>A DirectDraw object (DDrawObj.h, .cpp) that wraps all DirectDraw functionality by using <B>IDirectDraw</B> COM interfaces and the <B>IDDrawExclModeVideo</B> interface.
<LI>A video playback object (VidPlay.h, VidPlay.cpp) that implements the details of building a filter graph to playback AVI and MPEG files and DVD titles.
<LI>A Microsoft Windows&reg; application that uses the preceding two objects.
</UL>

<P>After successfully building the sample, run the application and choose <B>File</B> from the <B>Options</B> menu to load an AVI or MPEG file, or choose <B>DVD</B> from the <B>Options</B> menu to load a DVD file. Then choose <B>Start Play</B> from the <B>Options</B> menu. The sample application will perform the following steps.
<OL>
  <LI>Switch into exclusive full-screen mode at 800 &times; 600 resolution with 256 colors (this mode was picked arbitrarily), and create a primary surface with one back buffer.
  <LI>Build a filter graph to play back the selected type of video by using the DirectDraw object and surface provided by the application, start playing the multimedia file, and set a timer to fire every 0.1 second.
  <LI>On the timer event, draw the color key of the required dimension on the back buffer, draw a ball that can be moved by using keystrokes, draw an updated number of flips done, and then flip the surfaces.
  </OL>
  
<P>For more information on how to get application-created DirectDraw parameters used by the Overlay Mixer filter, as well as miscellaneous information, see the following topics.
<ul>
<li><A HREF="C_C++_Samp_Apps.htm#Ddrawxcl_DVD">How to Get DirectDraw Parameters for DVD</A>
<li><A HREF="C_C++_Samp_Apps.htm#Ddrawxcl_AVI">How to Get DirectDraw Parameters for AVI and MPEG</A>
<li><a href="#DDrawXcl_Misc">Miscellaneous Issues</a>
</uL>


<H3><A NAME="DDrawXcl_DVD" IDX_CONCEPT="noindex; DDrawXcl sample, how to get DirectDraw parameters for DVD">How to Get DirectDraw Parameters for DVD</a></H3>

<P>Use the following sequence of calls to get the application-created DirectDraw parameters used by the Overlay Mixer filter.
<OL>
	<LI>Create the DVD graph builder object. For an example, see the CDVDPlayer::BuildGraph function in the Vidplay.cpp file.
	<LI>Call the <A HREF="../ref/iface/IDvdGraphBuilder.htm#GetDvdInterface">IDvdGraphBuilder::GetDvdInterface</A> method for the <A HREF="../ref/iface/IDDrawExclModeVideo.htm">IDDrawExclModeVideo</A> interface. This returns the <B>IDDrawExclModeVideo</B> interface of the Overlay Mixer in the DVD playback filter graph.
	<LI>Call <A HREF="../ref/iface/IDDrawExclModeVideo.htm#SetDDrawObject">IDDrawExclModeVideo::SetDDrawObject</A> to set the DirectDraw object.
	<LI>Call <A HREF="../ref/iface/IDDrawExclModeVideo.htm#SetDDrawSurface">IDDrawExclModeVideo::SetDDrawSurface</A> to set the DirectDraw surface.
 	<LI>Call <A HREF="../ref/iface/IDvdGraphBuilder.htm#RenderDvdVideoVolume">IDvdGraphBuilder::RenderDvdVideoVolume</A> to build the DVD graph.
	<LI>Call <A HREF="../ref/iface/IDvdGraphBuilder.htm#GetDvdInterface">IDvdGraphBuilder::GetDvdInterface</A> to get an <A HREF="../ref/iface/IMixerPinConfig.htm">IMixerPinConfig</A> or <A HREF="../ref/iface/IMixerPinConfig2.htm">IMixerPinConfig2</A> interface pointer to the first (and only) input pin of the Overlay Mixer.
	<LI>Get color key and other information by using the <A HREF="../ref/iface/IMixerPinConfig.htm#GetColorKey">IMixerPinConfig::GetColorKey</A> method and similar methods, such as <A HREF="../ref/iface/IMixerPinConfig.htm#GetZOrder">GetZOrder</A>, <A HREF="../ref/iface/IMixerPinConfig.htm#GetBlendingParameter">GetBlendingParameter</A>, and so on.
	<LI>Call <A HREF="../ref/iface/IDDrawExclModeVideo.htm#SetCallbackInterface">IDDrawExclModeVideo::SetCallbackInterface</A> with a pointer to the object that implements the <A HREF="../ref/iface/IDDrawExclModeVideoCallback.htm">IDDrawExclModeVideoCallback</A> interface.
	<LI>Get the native video size and aspect ratio through the <A HREF="../ref/iface/IDDrawExclModeVideo.htm#GetNativeVideoProps">IDDrawExclModeVideo::GetNativeVideoProps</A> method. Transform the width and height based on the retrieved aspect ratio, and set the final video size and position by using the <A HREF="../ref/iface/IDDrawExclModeVideo.htm#SetDrawParameters">IDDrawExclModeVideo::SetDrawParameters</A> method.
</OL>

<H3><A NAME="DDrawXcl_AVI" IDX_CONCEPT="noindex; DDrawXcl sample, how to get DirectDraw parameters for AVI/MPEG">How to Get DirectDraw Parameters for AVI and MPEG</a></H3>
<P>Use the following sequence of calls to get the application-created DirectDraw parameters used by Overlay Mixer filter.
<OL>
	<LI>Create an empty filter graph. For an example, see the CFilePlayer::Initialize function in the Vidplay.cpp file.
	<LI>Call <A HREF="../ref/iface/IGraphBuilder.htm#RenderFile">IGraphBuilder::RenderFile</A> on the specified file to build the graph.
	<LI>Instantiate the Overlay Mixer filter and add it to the graph. For an example, see the CFilePlayer::AddOvMToGraph function in the Vidplay.cpp file.
	<LI>Call <A HREF="../ref/iface/IDDrawExclModeVideo.htm#SetDDrawObject">IDDrawExclModeVideo::SetDDrawObject</A> to set the DirectDraw object.
	<LI>Call <A HREF="../ref/iface/IDDrawExclModeVideo.htm#SetDDrawSurface">IDDrawExclModeVideo::SetDDrawSurface</A> to set the DirectDraw surface.
	<LI>Connect the decoded video to the Overlay Mixer's first input pin.
	<LI>Remove the Video Renderer filter (it's only a windowless playback case).
	<LI>Get the <B>IMixerPinConfig</B> or <B>IMixerPinConfig2</B> interface from the first input pin of the Overlay Mixer to get the color key through the <A HREF="../ref/iface/IMixerPinConfig.htm#GetColorKey">GetColorKey</A> method.
	<LI>Call <A HREF="../ref/iface/IDDrawExclModeVideo.htm#SetCallbackInterface">IDDrawExclModeVideo::SetCallbackInterface</A> with a pointer to the object that implements the <A HREF="../ref/iface/IDDrawExclModeVideoCallback.htm">IDDrawExclModeVideoCallback</A> interface.
	<LI>Get the native video size and aspect ratio through the <A HREF="../ref/iface/IDDrawExclModeVideo.htm#GetNativeVideoProps">IDDrawExclModeVideo::GetNativeVideoProps</A> method. Transform the width and height based on the retrieved aspect ratio, and set the final video size and position by using the <A HREF="../ref/iface/IDDrawExclModeVideo.htm#SetDrawParameters">IDDrawExclModeVideo::SetDrawParameters</A> method.
</OL>

<H3><A NAME="DDrawXcl_Misc" IDX_CONCEPT="noindex; DDrawXcl sample, miscellaneous issues">Miscellaneous Issues</a></H3>

<p>The object implementing the <A HREF="../ref/iface/IDDrawExclModeVideoCallback.htm">IDDrawExclModeVideoCallback</A> interface is implemented in the COverlayCallback class in the Ddrawobj.cpp file. It stops color keying of the video area on the back buffer when it gets the COverlayCallback::OnUpdateOverlay call with input parameter <I>bBefore</I>=TRUE. The color keying is turned on again when another <B>OnUpdateOverlay</B> call is made with <I>bBefore</I>=FALSE and the <I>dwFlags</I> parameter indicating that the overlay is visible. (For the definition of this method, see <A HREF="../ref/iface/IDDrawExclModeVideoCallback.htm#OnUpdateOverlay">IDDrawExclModeVideoCallback::OnUpdateOverlay</A>.)

<p>The <B>SetDDrawObject</B> and <B>SetDDrawSurface</B> methods can be called only when the pins of the Overlay Mixer are not connected. Otherwise, the calls will fail.

<p>The application has to draw the color key at the correct position on the primary surface (actually, the back buffer of the primary surface) to get the video to appear. In the exclusive mode, the Overlay Mixer doesn't draw the color key at all.

<P>In the case of DVD playback, after the DirectDraw object and surface are set through the <B>SetDDrawObject</B> and <B>SetDDrawSurface</B> methods, the graph is dismantled to avoid an inconsistent graph state. Call <A HREF="../ref/iface/IdvdGraphbuilder.htm#RenderDvdVideoVolume">RenderDvdVideoVolume</A> to rebuild 
the graph using the new DirectDraw parameters. 

<p>For DVDs, the subpicture and line 21 (closed caption) data are intentionally not rendered in exclusive full-screen mode. The DVD graph builder should not return S_FALSE simply because it cannot render these.

<P>The following list describes issues specific to the DDrawXcl sample.
<ul>
<li>The ball drawn on top of the video only moves when an arrow key is pressed and released. Holding the arrow key down doesn't move the ball. This is by design.
<li>When the user presses ALT+TAB, the application switches out of exclusive full-screen mode, stops playing the video, and tears down the filter graph. Playback doesn't resume even if the application is reactivated.
<li>The application fills the whole back buffer with black color and then <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_b.htm#blit')">blit</A>s the color key to the target video rectangle. This is not required unless the video is continually changing position. For video playing at the same position, erasing the previous position of the ball with the color key should be sufficient. For an example, see the CDDrawObject::FillSurface method in the Ddrawobj.cpp file within the DdrawXcl sample folder.
</ul>

<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>




<H2><A NAME="dvdsampl">Dvdsampl Sample (DVD Player Application)</A></H2>
<P>The DirectShow DVD sample player, Dvdsampl, is a simple application that plays DVD Video content. It uses the <A HREF="../ref/iface/IDvdGraphBuilder.htm">IDvdGraphBuilder</A> interface to build a DVD filter graph and to obtain interface pointers for <A HREF="../ref/iface/IAMLine21Decoder.htm">IAMLine21Decoder</A>, <A HREF="../ref/iface/IDvdControl.htm">IDvdControl</A>, and <A HREF="../ref/iface/IDvdInfo.htm">IDvdInfo</A>. It uses those interfaces and enables you to turn closed captioning on and off, play in full screen mode, and display and select from DVD menus.

<P><B>Note:</B>  Your system must include DVD playback hardware to run this sample.<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>



<H2><A NAME="inwindow">InWindow Sample (Window Playback Application)</A></H2>
<P>The InWindow application is a simple sample that shows minimal code required to play back a media file into a specific window. It builds on the <A HREF="C_C++_Samp_Apps.htm#playfile">PlayFile sample</A>. Like PlayFile, it provides a file Open dialog box that enables you to open media files. It also uses <A HREF="../ref/iface/IGraphBuilder.htm">IGraphBuilder</A>, <A HREF="../ref/iface/IMediaEventEx.htm">IMediaEventEx</A>, and <A HREF="../ref/iface/IMediaControl.htm">IMediaControl</A> as PlayFile does. InWindow expands on the PlayFile functionality by calling <A HREF="../ref/iface/IVideoWindow.htm#put_Owner">IVideoWindow::put_Owner</A>, <A HREF="../ref/iface/IVideoWindow.htm#put_WindowStyle">IVideoWindow::put_WindowStyle</A>, and <A HREF="../ref/iface/IVideoWindow.htm#SetWindowPosition">IVideoWindow::SetWindowPosition</A> to direct playback into the main application window.

<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>




<H2><A NAME="Indeo_Player">IPlay Sample (Indeo Player Application)</A></H2>
<P>The Intel&#174; Indeo player sample, IPlay, uses DirectShow to render multimedia files and demonstrates the Indeo Video Interactive application programming interfaces (API). IPlay demonstrates how to access the advanced features of the Indeo Video Interactive (IVI) <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#codec')">codec</A>. It is a simple application written in C++ using Microsoft Foundation Classes (MFC). If the file is an IVI format file, it enables controls for the IVI advanced features. The advanced features include local decoding, a decoding time limit, and the ability to adjust brightness, <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#saturation')">saturation</A>, and contrast.

<P>The Ax_spec.h file defines the interfaces of the IVI codec. The CIPlayDoc::OnOpenDocument function demonstrates how to determine if a file is an IVI format file. The CIPlayDoc::Getxxx and CIPlayDoc::Setxxx functions demonstrate how to get and set the IVI playback parameters for the advanced features.

<P>This sample uses the following interfaces:
<UL><LI><A HREF="../ref/iface/IGraphBuilder.htm">IGraphBuilder</A>&#151;to create a filter graph and render a file
<LI><A HREF="../ref/iface/IFilterGraph.htm">IFilterGraph</A>&#151;to enumerate the filters in the filter graph
<LI><A HREF="../ref/iface/IMediaControl.htm">IMediaControl</A>&#151;to play/pause/stop the playback
<LI><A HREF="../ref/iface/IMediaEvent.htm">IMediaEvent</A>&#151;to be notified of <A HREF="../ref/Event_Notification_Codes.htm#EC_COMPLETE">EC_COMPLETE</A> (playback complete) and other events
<LI><A HREF="../ref/iface/IMediaPosition.htm">IMediaPosition</A>&#151;to set the time that the media stream begins
<LI><A HREF="../ref/iface/IVideoWindow.htm">IVideoWindow</A>&#151;to set the window size/caption/position
<LI><A HREF="../ref/iface/IBasicVideo.htm">IBasicVideo</A>&#151;to get the native window size.
</UL>
<P>IPlay also implements and uses the <B>IIndeoDecode</B> interface (not part of DirectShow).


<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>



<H2><A NAME="MFCPlay">MFCPlay Sample (C++/COM-based Media Player Application)</A></H2>
<P>The C++/COM-based media player sample, MFCPlay, is a simple application that renders multimedia files using DirectShow from within C++ and Microsoft Foundation Classes (MFC). It demonstrates how to connect the DirectShow components by using the interfaces provided with DirectShow and MFC. The sample creates a filter graph (by calling <A HREF="../appendixes/Further_Reading.htm#CoCreateInstance">CoCreateInstance</A> to get a pointer to the <A HREF="../ref/iface/IGraphBuilder.htm">IGraphBuilder</A> interface), and requests the filter graph to render a file. The filter graph is then controlled by using the <A HREF="../ref/iface/IMediaControl.htm">IMediaControl</A> interface. This sample also uses the <A HREF="../ref/iface/IMediaEvent.htm">IMediaEvent</A> and <A HREF="../ref/iface/IMediaPosition.htm">IMediaPosition</A> interfaces.

<P>The MFCPlay application implements the following menu commands: Open, Play, Pause, Stop, and Exit on the File menu, and About on the Help menu.

<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>




<H2><A NAME="MPEGProp">MPEGProp Sample (MPEG Property Page Display Application)</A></H2>
<P>The MPEGProp sample application demonstrates how to display a filter's property page.

<P>When you open MPEGProp, choose Open from the File menu and select an MPEG media file from the standard Open dialog box. After you select an appropriate file, MPEGProp calls <A HREF="../appendixes/Further_Reading.htm#CoCreateInstance">CoCreateInstance</A> to create a new filter graph and renders the chosen source file. MPEGProp calls <A HREF="../ref/iface/IFilterGraph.htm#FindFilterByName">IFilterGraph::FindFilterByName</A> to locate the <A HREF="MPEG_Video_Decoder.htm">MPEG Video Codec</A> filter, and then calls <A HREF="../appendixes/Further_Reading.htm#OleCreatePropertyFra">OleCreatePropertyFrame</A> with the codec pointer to display the filter's property page.

<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>



<H2><A NAME="playfile">PlayFile Sample (Simple Playback Application)</A></H2>
<P>The PlayFile application is a simple sample that shows minimal code required to play back a media file. It provides a file Open dialog box that enables you to open files including file types such as AVI, MPEG, MOV, and QT. PlayFile uses the <A HREF="../ref/iface/IGraphBuilder.htm#RenderFile">IGraphBuilder::RenderFile</A> method to render the filter graph for the chosen media file, <A HREF="../ref/iface/IMediaEventEx.htm">IMediaEventEx</A> to handle signaling of events, <A HREF="../ref/iface/IMediaControl.htm#Run">IMediaControl::Run</A> to play the resulting filter graph, and <A HREF="../ref/iface/IMediaControl.htm#Stop">IMediaControl::Stop</A> to stop playback. The sample calls <A HREF="../ref/iface/IVideoWindow.htm">IVideoWindow</A> to control whether the playback window is visible. Video follows the default behavior and plays back in a separate window rather than in the main application window.

<P>See <A HREF="C_C++_Samp_Apps.htm#inwindow">InWindow Sample (Window Playback Application)</A> for a sample that builds on PlayFile and plays back video into the main application window.

<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>


<H2><A NAME="ShowStrm">ShowStrm Sample (Multimedia Streaming Application)</A></H2>
<P>The ShowStrm application demonstrates how to use a Microsoft&#174; DirectDraw&#174; surface to <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_B.htm#blit')">blit</A> a multimedia stream. It is a console application that sends a movie out to the surface when invoked from the command line with the following syntax.

<PRE>
SHOWSTRM Name_of_Movie
</PRE>
<P>For example, to play Angry.avi, you could use the command:

<PRE>
C:\&gt;SHOWSTRM angry.avi
</PRE>

<p>This sample demonstrates the <A HREF="../mms/IAMMultiMediaStream.htm">IAMMultiMediaStream</A> and <A HREF="../mms/IMultiMediaStream.htm">IMultiMediaStream</A> interfaces.

<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>


<H2><A NAME="VidClip">VidClip Sample (Video Editing Application)</A></H2>
<P>The VidClip application demonstrates how to use the multimedia streaming interfaces and how to support rudimentary video editing. The VidClip sample reads from multiple streams and writes to a single stream. For more information on the multimedia streaming interfaces, see <A HREF="../mms/mms_iface.htm#mms_iface_list">List of Multimedia Streaming Interfaces</A>.

<P>On the <B>Video</B> menu in the VidClip application, choose the <B>Add Clip</B> command to add clips to your list; you can include start and stop times, if you want to add only a portion of a clip. Choose the <B>Edit Clip</B> command to edit existing clips in the list, and the <B>Delete Clip</B> command to delete clips. The <B>Make a Movie</B> command combines the clips into one stream. 

<P>On the <B>File</B> menu, choose the <B>Settings</B> command to set the height, width, depth, and compression for the stream data. Choose the <B>Save</B> command to save the settings to a file in your project. 

<P><A HREF="DS_Samples_intro.htm#sample_locations">Sample Locations</A>



<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A Class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT>if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
