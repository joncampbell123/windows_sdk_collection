<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IUnknown Interface</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../' </SCRIPT>
<META NAME="Description" CONTENT="IUnknown">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>
<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->

</HEAD>


<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IUnknown"></A>
<!--TOOLBAR_START-->

<!--TOOLBAR_EXEMPT-->

<!--TOOLBAR_END-->



<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectX Transform Animated Header -- Microsoft DirectX Transform SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ifaces/interface_intro.htm">Topic Contents</A>
</PRE></TD></TR>

<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="ifaces/idxtscaleoutput.htm">IDXTScaleOutput Interface</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="helpers/helper_intro.htm">Helper Functions</A>
</PRE></TD></TR></TABLE>

<!-- NAV_LINKS_END -->





<BLOCKQUOTE class="body">

<!-- CONTENTS_START -->


<H1>IUnknown Interface<hr size=1></H1>
The <B>IUnknown</B> interface enables clients to retrieve pointers to other interfaces on a given object through its <A HREF="IUnknown.htm#QueryInterface">QueryInterface</A> method, and manage the lifetime of the object through the <A HREF="IUnknown.htm#AddRef">IUnknown::AddRef</A> and <A HREF="IUnknown.htm#Release">IUnknown::Release</A> methods.
All other Component Object Model (COM) interfaces are inherited, directly or indirectly, from <B>IUnknown</B>. Therefore, the three methods of <B>IUnknown</B> are the first entries in the vtable for every Microsoft&reg; DirectX&reg; Transform
interface. 
<P>You must implement <B>IUnknown</B> as part of every interface. Use <B>IUnknown</B> methods to switch between interfaces on an object, to add references, and to release objects. 


<P CLASS="ref">IUnknown Methods</P>
<BLOCKQUOTE>
<TABLE CLASS="ref">
<TR><TD><A HREF="iunknown.htm#addref">AddRef</A></TD>
	<TD>Increments the reference count.
</TD></TR>
<TR><TD><A HREF="iunknown.htm#queryinterface">QueryInterface</A></TD>
	<TD>Retrieves pointers to supported interfaces.
</TD></TR>
<TR><TD><A HREF="iunknown.htm#Release">Release</A></TD>
	<TD>Decrements the reference count.
</TD></TR>
</TABLE>
</BLOCKQUOTE>




<H1><A NAME="AddRef" IDX_CONCEPT="AddRef (IUnknown Interface)">IUnknown::AddRef</A><HR size=1></H1>
<P>Increments the reference count for the calling interface on an object. This method
should be used for every new copy of a pointer to an interface on a given object. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>ULONG AddRef(
    void
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<p>Returns an integer from 1 to n, which is the value of the new reference count. This information is intended to be used for diagnostic/testing


purposes only, because, in certain situations,


 the value might be unstable. 
</BLOCKQUOTE>


<H1><A NAME="QueryInterface" IDX_CONCEPT="QueryInterface (IUnknown Interface)">IUnknown::QueryInterface</A><HR size=1></H1>
<P>Retrieves a pointer to a specified interface on a component to which a client currently holds an interface pointer.


This method must use <A HREF="iunknown.htm#AddRef">IUnknown::AddRef</A> on the pointer it returns. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT QueryInterface(
	REFIID iid,
	void **ppvObject
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>


<BLOCKQUOTE>
<DL><DT><I>iid</I> 
 </DT><DD>[in] Interface ID (IID) of the requested interface. 
</DD></DL>
<DL><DT><I>ppvObject</I> 
 </DT><DD>[out] Receives a pointer to an interface pointer to the object on return.


If the interface specified in the IID is not supported by the object, <I>ppvObject</I> is set to NULL.  
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<p>Returns S_OK if the interface is supported, S_FALSE otherwise. 
</BLOCKQUOTE>

<H1><A NAME="Release" IDX_CONCEPT="Release (IUnknown Interface)">IUnknown::Release</A><HR size=1></H1>
<P>Decrements the reference count for the calling interface on an object.
If the reference count on the object falls to zero, the object is freed from memory.  

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>ULONG Release(
    void
);
</PRE>
</BLOCKQUOTE>


<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<p>Returns the resulting value of the reference count, which is used for diagnostic/testing purposes only.


If you need to know that resources have been freed, use an interface with higher-level semantics. 
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A CLASS="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A CLASS="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>
