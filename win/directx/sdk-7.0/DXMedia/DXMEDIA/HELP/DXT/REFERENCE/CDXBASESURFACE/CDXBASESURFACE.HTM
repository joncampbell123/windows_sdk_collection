<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>CDXBaseSurface Class</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="CDXBaseSurface Class">
<META NAME="Description" CONTENT="CDXBaseSurface::CreateARBGPointer">
<META NAME="Description" CONTENT="CDXBaseSurface::DeleteARGBPointer">
<META NAME="Description" CONTENT="CDXBaseSurface::OnGetObjectSize">
<META NAME="Description" CONTENT="CDXBaseSurface::OnSetSize">
<META NAME="Description" CONTENT="CDXBaseSurface::OnSurfacePick">
<META NAME="Description" CONTENT="CDXBaseSurface::SampleFormatEnum">
<META NAME="Description" CONTENT="CDXBaseSurface::SurfaceCLSID">
<META NAME="Description" CONTENT="CDXBaseSurface::WorkProc">
<META NAME="Description" CONTENT="CreateARBGPointer (CDXBaseSurface)">
<META NAME="Description" CONTENT="DeleteARGBPointer (CDXBaseSurface)">
<META NAME="Description" CONTENT="OnGetObjectSize (CDXBaseSurface)">
<META NAME="Description" CONTENT="OnSetSize (CDXBaseSurface)">
<META NAME="Description" CONTENT="OnSurfacePick (CDXBaseSurface)">
<META NAME="Description" CONTENT="SampleFormatEnum (CDXBaseSurface)">
<META NAME="Description" CONTENT="SurfaceCLSID (CDXBaseSurface)">
<META NAME="Description" CONTENT="WorkProc (CDXBaseSurface)">


<META NAME="KEYWORDS" CONTENT="CDXBaseSurface Class">

<META NAME="PRODUCT" CONTENT="DirectX Transform">

<META NAME="CATEGORY" CONTENT="Technical documentation; download">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>
<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="CDXBaseSurface_class"></A>
<!--TOOLBAR_START-->

<!--TOOLBAR_EXEMPT-->

<!--TOOLBAR_END-->


<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectX Transform Animated Header -- Microsoft DirectX Transform SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../classes_intro.htm">Topic Contents</A>
</PRE></TD></TR>

<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="../CDXBaseNTo1/CDXBaseNTo1_helpers.htm">CDXBaseNTo1 Helper Functions</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../CDXBnds/CDXBnds_intro.htm">CDXBnds Class</A>
</PRE></TD></TR></TABLE>

<!-- NAV_LINKS_END -->


<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->


<H1>CDXBaseSurface Class</H1>

<p>The <b>CDXBaseSurface</b> class is used to simplify the creation of <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_p.htm#gloss_proceduralsurface')">procedural surfaces</A>. An Active Template Library (ATL) COM object derived from this class inherits most of the default functionality of an object that can be used as both a transform and a surface. Procedural surfaces are usually created by calling the <a href="../ifaces/idxsurfacefactory.htm#CreateSurface">IDXSurfaceFactory::CreateSurface</a> method, specifying the <i>pFormatID</i> parameter equal to the object's CLSID, and specifying DXSF_FORMAT_IS_CLSID in the <i>dwFlags</i> parameter.

<p>To use this base class, you must override the <A HREF="CDXBaseSurface.htm#CreateARGBPointer">CreateARGBPointer</A>, <A HREF="CDXBaseSurface.htm#DeleteARGBPointer">DeleteARGBPointer</A>, and <A HREF="CDXBaseSurface.htm#SurfaceCLSID">SurfaceCLSID</A> member functions. All other function overrides are optional.

<p>This class inherits from the <a href="../cdxbasento1/cdxbasento1_intro.htm">CDXBaseNTo1</a> class and the <a href="../ifaces/idxsurface.htm">IDXSurface</a> and <a href="../ifaces/idxsurfaceinit.htm">IDXSurfaceInit</a> interfaces.

<P CLASS="ref">Member Functions</P>
<BLOCKQUOTE>
<TABLE CLASS="ref">
<TR><TD><A HREF="CDXBaseSurface.htm#CreateARGBPointer">CreateARGBPointer</A></TD>
	<TD>Allocates an ARGB read pointer object.
</TD></TR>
<TR><TD><A HREF="CDXBaseSurface.htm#DeleteARGBPointer">DeleteARGBPointer</A></TD>
	<TD>Frees an ARGB read pointer object.
</TD></TR>
<TR><TD><A HREF="CDXBaseSurface.htm#OnGetObjectSize">OnGetObjectSize</A></TD>
	<TD>Called by the base class to determine the object's size, in bytes.
</TD></TR>
<TR><TD><A HREF="CDXBaseSurface.htm#OnSetSize">OnSetSize</A></TD>
	<TD>Sets the width and height of the surface.
</TD></TR>
<TR><TD><A HREF="CDXBaseSurface.htm#OnSurfacePick">OnSurfacePick</A></TD>
	<TD>Determines whether any part of the surface is located at the specified point.
</TD></TR>
<TR><TD><A HREF="CDXBaseSurface.htm#SampleFormatEnum">SampleFormatEnum</A></TD>
	<TD>Retrieves the native pixel format of the surface.
</TD></TR>
<TR><TD><A HREF="CDXBaseSurface.htm#SurfaceCLSID">SurfaceCLSID</A></TD>
	<TD>Retrieves the CLSID of the surface.
</TD></TR>
<TR><TD><A HREF="CDXBaseSurface.htm#WorkProc">WorkProc</A></TD>
	<TD>Called by the transform base class to enable the surface to function as a transform.
</TD></TR>
</TABLE>
</BLOCKQUOTE>



<H1><A NAME="CreateARGBPointer">CDXBaseSurface::CreateARGBPointer</A><HR size=1></H1>
<P>Allocates an ARGB read pointer object.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>virtual HRESULT CreateARGBPointer(
	CDXBaseSurface * pSurface,
	CDXBaseARGBPtr ** ppPtr
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>

<DL><DT><I>pSurface</I> 
 </DT><DD>[in] Pointer to the <b>CDXBaseSurface</b> object.
</DD>

<DT><I>ppPtr</I> 
 </DT><DD>[out] Address of a pointer to the newly created <B>CDXBaseARGBPtr</B> class object.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Derived classes must override this virtual function.

<p>A procedural surface object is required to define an ARGB sample access object that supports the <A HREF="../Ifaces/idxargbreadptr.htm">IDXARGBReadPtr</A> interface. The <A HREF="../CDXBaseARGBPtr/CDXBaseARGBPtr.htm">CDXBaseARGBPtr</A> class can be used to simplify this. 
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><a href="../cdxbaseargbptr/cdxbaseargbptr.htm">CDXBaseARGBPtr</a>, <a href="#DeleteARGBPointer">CDXBaseSurface::DeleteARGBPointer</a> 
</BLOCKQUOTE>



<H1><A NAME="DeleteARGBPointer">CDXBaseSurface::DeleteARGBPointer</A><HR size=1></H1>
<P>Frees an ARGB read pointer object.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>virtual void DeleteARGBPointer(
	CDXBaseARGBPtr *pPtr
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT>[in] <I>pPtr</I></DT>
<DD>Pointer to the <A HREF="../CDXBaseARGBPtr/CDXBaseARGBPtr.htm">CDXBaseARGBPtr</A> object to delete.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>No return value.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Derived classes must override this virtual function.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><a href="#CreateARGBPointer">CDXBaseSurface::CreateARGBPointer</a>

</BLOCKQUOTE>



<H1><A NAME="OnGetObjectSize">CDXBaseSurface::OnGetObjectSize</A><HR size=1></H1>
<P>Called by the base class to determine the object's size, in bytes.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>virtual ULONG OnGetObjectSize(void)
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the size of the surface, in bytes. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The default implementation returns <code class="text">sizeof( *this )</code>. If the object allocates resources, the derived class should override this method to provide more accurate information. This information helps the container manage memory more accurately.
</BLOCKQUOTE>



<H1><A NAME="OnSetSize">CDXBaseSurface::OnSetSize</A><HR size=1></H1>
<P>Sets the width and height of the surface.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>virtual HRESULT OnSetSize(
	ULONG Width,
	ULONG Height
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>

<DL><DT><I>Width</I> 
 </DT><DD>[in] New width of the surface, in pixels.
</DD>

<DT><I>Height</I> 
 </DT><DD>[in] New height of the surface, in pixels.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The derived class can override this virtual function to perform necessary computations when the size of the surface changes. The base class will only call this function from the <a href="../ifaces/idxsurfaceinit.htm#InitSurface">IDXSurfaceInit::InitSurface</a> method. You can call it from other interfaces you implement (for example, <A HREF="../Ifaces/idxtscaleoutput.htm">IDXTScaleOutput</A>). The default implementation stores the width and height in the <b>m_Width</b> and <b>m_Height</b> data members of <B>CDXBaseSurface</B>, and calls <a href="../cdxbasento1/cdxbasento1_helpers.htm#SetDirty">CDXBaseNto1::SetDirty</a> to increment the generation ID.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><a href="../cdxbasento1/cdxbasento1_helpers.htm#setdirty">CDXBaseNTo1::SetDirty</a>, <a href="../ifaces/idxsurfaceinit.htm#InitSurface">IDXSurfaceInit::InitSurface</a>, <a href="../ifaces/IDXTScaleOutput.htm">IDXTScaleOutput</a>
</BLOCKQUOTE>



<H1><A NAME="OnSurfacePick">CDXBaseSurface::OnSurfacePick</A><HR size=1></H1>
<P>Determines whether any part of the surface is located at the specified point.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>virtual HRESULT OnSurfacePick(
	const CDXDBnds &amp; OutPoint,
	ULONG &amp; ulInputIndex,
	CDXDVec &amp; InVec
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>

<DL><DT><I>OutPoint</I> 
 </DT><DD>Coordinates of the point on the output surface to test.
</DD></dl>

<DL><DT><I>ulInputIndex</I> 
 </DT><DD>Not used for procedural surfaces.
</DD></dl>

<DL><DT><I>InVec</I> 
 </DT><DD>Not used for procedural surfaces.
</DD></dl>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>If the sample in the output space has an alpha value greater than zero, DXT_S_HITOUTPUT should be returned. Otherwise, S_FALSE should be returned, indicating a miss.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Procedural surfaces can only know if there is a sample located at the specified point. There is no input surface to map the point back to, so <i>ulInputIndex</i> and <i>InVec</i> should return NULL.
</BLOCKQUOTE>


<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><a href="../ifaces/idxsurfacepick.htm">IDXSurfacePick</a>
</BLOCKQUOTE>



<H1><A NAME="SampleFormatEnum">CDXBaseSurface::SampleFormatEnum</A><HR size=1></H1>
<P>Retrieves the native pixel format of the surface.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>virtual DXSAMPLEFORMATENUM SampleFormatEnum()
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the pixel format for your surface as a member of the <a href="../enums/dxsampleformatenum_enum.htm">DXSAMPLEFORMATENUM</a> enumeration. The base class default value is (DXPF_NONSTANDARD | DXPF_TRANSPARENCY | DXPF_TRANSLUCENCY).

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Procedural surfaces should return DXPF_NONSTANDARD. This indicates that users cannot get direct access to the samples because they are procedurally generated when read. This is all that is needed if the output samples will always have an alpha value of 255. If the output samples can have alpha values of 0 or 255, then the DXPF_TRANSPARENCY flag should be set for the return value. If the output samples can have alpha values ranging from 0 through 255, then the DXPF_TRANSLUCENCY flag should be set as well. This information is used to optimize sample processing in other routines.
</BLOCKQUOTE>



<H1><A NAME="SurfaceCLSID">CDXBaseSurface::SurfaceCLSID</A><HR size=1></H1>
<P>Retrieves the CLSID of the surface.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>virtual const GUID &amp; SurfaceCLSID()
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a <B>GUID</B> for the derived surface's CLSID. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Derived classes must override this virtual function.

<p>The base class calls this method to determine the class identifier of the derived class. This is used mainly for COM persistence support. 
</BLOCKQUOTE>



<H1><A NAME="WorkProc">CDXBaseSurface::WorkProc</A><HR size=1></H1>
<P>Called by the transform base class to enable the surface to function as a transform.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>virtual HRESULT WorkProc(
	const CDXTWorkInfoNTo1 &amp; WI,
	BOOL* pbContinueProcessing)
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>

<DL><DT><I>WI</I> 
 </DT><DD>[in] Work procedure information structure that contains the rendering request details. 
</DD>

<DT><I>pbContinueProcessing</I> 
 </DT><DD>[in] Pointer to a Boolean value that is TRUE as long as the function is supposed to continue the rendering request.
</DD>

</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns S_OK for success, or an implementation-dependent value on error.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The base class calls this method when the procedural surface is being used as a transform. It is called to generate a block of output samples and write them to the specified destination surface. The default implementation of this method simply calls the <a href="../helpers/composite_helpers.htm#DXBitBlt">DXBitBlt</a> helper function with the specified input and output regions. In turn, this object is locked like a procedural surface and pixels are generated through the <a href="../ifaces/IDXARGBReadPtr.htm">IDXARGBReadPtr</a> interface. Usually, you don't need to override this method.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><a href="../cdxbasento1/cdxbasento1_virtuals.htm#WorkProc">CDXBaseNTo1::WorkProc</a>
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A CLASS="line" HREF="#pagetop"><IMG SRC="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A CLASS="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>
