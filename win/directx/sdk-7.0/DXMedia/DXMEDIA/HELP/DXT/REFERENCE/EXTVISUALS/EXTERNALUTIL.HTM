<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirect3DRMExternalUtil Interface</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IDirect3DRMExternalUtil">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::AddDestroyCallback">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::Clone">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::DeleteDestroyCallback">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::DestroyDeviceTexture">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::FindDeviceTexture">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::GetAppData">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::GetClassName">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::GetName">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::GetTextureHandle">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::SetAppData">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::SetExtents">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::SetName">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::UpdateBounds">
<META NAME="Description" CONTENT="IDirect3DRMExternalUtil::ValidateDeviceTextures">
<META NAME="Description" CONTENT="AddDestroyCallback (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="Clone (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="DeleteDestroyCallback (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="DestroyDeviceTexture (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="FindDeviceTexture (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="GetAppData (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="GetClassName (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="GetName (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="GetTextureHandle (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="SetAppData (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="SetExtents (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="SetName (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="UpdateBounds (IDirect3DRMExternalUtil)">
<META NAME="Description" CONTENT="ValidateDeviceTextures (IDirect3DRMExternalUtil)">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>
<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>

<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="ExternalUtil"></A>
<!--TOOLBAR_START-->

<!--TOOLBAR_EXEMPT-->

<!--TOOLBAR_END-->


<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform Animated Header --IDirect3DRMExternalUtil"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform Animated Header --IDirect3DRMExternalUtil"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ExtVisuals_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="ExtVisuals_intro.htm">External Visuals</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="ExternalVisual.htm">IDirect3DRMExternalVisual Interface</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->





<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->

<H1><A NAME="IDirect3DRMExternalUtil"></A>IDirect3DRMExternalUtil Interface</H1>



<P>The <B>IDirect3DRMExternalUtil</B> interface provides some general helper methods for external visuals. It is primarily useful for texture caching, and because it provides access to the <B>IDirect3DRMObject</B> interface methods. 
<p><B>IDirect3DRMExternalUtil</B> inherits from <B>IDirect3DRMObject</B>. If you create your external visual with <B>IDirect3DRM3::CreateObject</B> or <B>IDirect3DRM3::Load</B>, your external visual is aggregated with <B>IDirect3DRMObject</B>, and you can access the <B>IDirect3DRMObject</B> methods. However, if you create your external visual some other way, for example, with <B>CoCreateInstance</B>, you cannot access the <B>IDirect3DRMObject</B> methods and if you call them, you will get a D3DRMERR_NOTAGGREGATED error. 
<P CLASS="ref">IDirect3DRMExternalUtil Methods</P>
<BLOCKQUOTE>
<TABLE CLASS="ref">
<TR><TD><A HREF="ExternalUtil.htm#DestroyDeviceTexture">DestroyDeviceTexture</A>
 </TD><TD>Destroys the Microsoft&reg; Direct3D&reg; Retained Mode internal representation of the device-dependent texture.
</TD></TR>
<TR><TD><A HREF="ExternalUtil.htm#FindDeviceTexture">FindDeviceTexture</A>
 </TD><TD>Enables you to obtain a device-dependent texture ID.</TD>
 </TR>
 <TR><TD><A HREF="ExternalUtil.htm#GetTextureHandle">GetTextureHandle</A>
 </TD><TD>Enables you to obtain a D3DTEXTUREHANDLE texture handle with which to render textures from a device-dependent texture ID.</TD>
 </TR>

<TR><TD><A HREF="ExternalUtil.htm#SetExtents">SetExtents</A>
 </TD><TD>Updates the current viewport's two-dimensional (2-D) extents.</TD></TR>

 <TR><TD><A HREF="ExternalUtil.htm#UpdateBounds">UpdateBounds</A>
 </TD><TD>Enables the external visual to set the current bounding box stored for it 
by Direct3D Retained Mode.</TD>
 </TR>
<TR><TD><A HREF="ExternalUtil.htm#ValidateDeviceTextures">ValidateDeviceTextures</A>
 </TD><TD>Validates textures to ensure they are supported by the device.</TD>
 </TR>
 </TABLE>
</BLOCKQUOTE>
 <P CLASS="ref">Methods Inherited from IDirect3DRMObject</P>
<BLOCKQUOTE>
<TABLE CLASS="ref">
<TR><TD><A HREF="ExternalUtil.htm#AddDestroyCallback">AddDestroyCallback</A>
 </TD><TD>
</TD></TR>
<TR><TD><A HREF="ExternalUtil.htm#Clone">Clone</A>
 </TD><TD>
</TD></TR>
<TR><TD><A HREF="ExternalUtil.htm#DeleteDestroyCallback">DeleteDestroyCallback</A>
</TD><TD>
</TD></TR>
 <TR><TD><A HREF="ExternalUtil.htm#GetAppData">GetAppData</A>
</TD><TD>
</TD>
</TR>
<TR><TD><A HREF="ExternalUtil.htm#GetClassName">GetClassName</A>
 </TD><TD>
</TD></TR>
<TR><TD><A HREF="ExternalUtil.htm#GetName">GetName</A>
 </TD><TD>
</TD></TR>
<TR><TD><A HREF="ExternalUtil.htm#SetAppData">SetAppData</A>
 </TD><TD>
</TD></TR>
<TR><TD><A HREF="ExternalUtil.htm#SetName">SetName</A>
 </TD><TD>
</TD></TR>
</TABLE>
</BLOCKQUOTE>
<H1><A NAME="AddDestroyCallback">IDirect3DRMExternalUtil::AddDestroyCallback</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Registers a function that will be called when an object is destroyed.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>AddDestroyCallback</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMOBJECTCALLBACK</B> <I>lpCallback</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpCallback</I>
</DT><DD>User-defined callback function that will be used when the object is destroyed.

</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to the callback function. Because this function is used after the object has been destroyed, you should not use this function with the object as an argument.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. Returns D3DRMERR_NOTAGGREGATED if the external visual was not created with <B>IDirect3DRM3::CreateObject</B> or <B>IDirect3DRM3::Load</B> and thus is not aggregated onto <B>IDirect3DRMObject</B>.

</BLOCKQUOTE>
<H1><A NAME="Clone">IDirect3DRMExternalUtil::Clone</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Creates a copy of an object.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>Clone</B><B>(</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnkOuter</I><B>,</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>*ppvObj</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pUnkOuter</I>

</DT><DD>Pointer to the outer <B>IUnknown</B> interface that allows COM aggregation features. 
</DD><DT><I>riid</I>
</DT><DD>Identifier of the object being copied.
</DD><DT><I>ppvObj</I>
</DT><DD>Address that will contain the copy of the object when the method returns.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. Returns D3DRMERR_NOTAGGREGATED if the external visual was not created with <B>IDirect3DRM3::CreateObject</B> or <B>IDirect3DRM3::Load</B> and is not aggregated onto <B>IDirect3DRMObject</B>.
</BLOCKQUOTE>

<H1><A NAME="DeleteDestroyCallback">IDirect3DRMExternalUtil::DeleteDestroyCallback</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Removes a function previously registered with the <A HREF="ExternalUtil.htm#AddDestroyCallback">IDirect3DRMExternalUtil::AddDestroyCallback</A> method.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>DeleteDestroyCallback</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMOBJECTCALLBACK</B> <I>d3drmObjProc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>d3drmObjProc</I>
</DT><DD>User-defined callback function that was to be used when the object was destroyed.

</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to the callback function.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. Returns D3DRMERR_NOTAGGREGATED if the external visual was not created with <B>IDirect3DRM3::CreateObject</B> or <B>IDirect3DRM3::Load</B> and is not aggregated onto <B>IDirect3DRMObject</B>.


</BLOCKQUOTE>


<H1><A NAME="DestroyDeviceTexture">IDirect3DRMExternalUtil::DestroyDeviceTexture</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Destroys the Microsoft&reg; Direct3D&reg; Retained Mode internal representation of the device-dependent texture.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT DestroyDeviceTexture(
  DWORD dwDevTexId);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>dwDevTexId</I></DT>
<DD> [in] Valid device-dependent texture ID, as returned by
	<a href="#FindDeviceTexture">IDirect3DRMExternalUtil::FindDeviceTexture</a>.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>


<H1><A NAME="FindDeviceTexture">IDirect3DRMExternalUtil::FindDeviceTexture</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Enables you


to obtain a device-dependent texture ID. You should use this method every time the current device changes
and you want to obtain a D3DTEXTUREHANDLE texture handle

to render with. Use <A HREF="ExternalUtil.htm#GetTextureHandle">GetTextureHandle</A> to get the texture handle for the texture ID.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT FindDeviceTexture(
  LPDIRECT3DRMDEVICE2 lpRMDev, 
  LPDIRECT3DRMTEXTURE lpRMTex,
  LPDWORD dwDevTexId);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>lpRMDev</I></DT>
<DD> [in] Pointer to a valid Direct3D Retained Mode device.</DD>

<DT><I>lpRMTex</I></DT>
<DD> [in] Pointer to a valid Direct3D Retained Mode texture.</DD>

<DT><I>dwDevTexId</I></DT>
<DD> [out] Device-dependent texture ID.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<H1><A NAME="GetAppData">IDirect3DRMExternalUtil::GetAppData</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Retrieves the 32 bits of application-specific data in the object. The default value of the data is 0.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>DWORD</B> <B>GetAppData</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the data value defined by the application.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="ExternalUtil.htm#SetAppData">IDirect3DRMExternalUtil::SetAppData</A>
</BLOCKQUOTE>

<H1><A NAME="GetClassName">IDirect3DRMExternalUtil::GetClassName</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Retrieves the name of the object's class.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>GetClassName</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDWORD</B> <I>lpdwSize</I><B>,</B><BR>&nbsp;&nbsp;<B>LPSTR</B> <I>lpName</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpdwSize</I>
 </DT><DD>Address of a variable containing the size, in bytes, of the buffer pointed to by the <I>lpName</I> parameter.
</DD><DT><I>lpName</I>
 </DT><DD>Address of a variable that will contain a null-terminated string identifying the class name when the method returns. If this parameter is NULL, the <I>lpdwSize</I> parameter will contain the required size for the string when the method returns.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. Returns D3DRMERR_NOTAGGREGATED if the external visual was not created with <B>IDirect3DRM3::CreateObject</B> or <B>IDirect3DRM3::Load</B> and is not aggregated onto <B>IDirect3DRMObject</B>.

</BLOCKQUOTE>
<H1><A NAME="GetName">IDirect3DRMExternalUtil::GetName</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Retrieves the object's name.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>GetName</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDWORD</B> <I>lpdwSize</I><B>,</B><BR>&nbsp;&nbsp;<B>LPSTR</B> <I>lpName</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpdwSize</I>
 </DT><DD>Address of a variable containing the size, in bytes, of the buffer pointed to by the <I>lpName</I> parameter.
</DD><DT><I>lpName</I>
 </DT><DD>Address of a variable that will contain a null-terminated string identifying the object's name when the method returns. If this parameter is NULL, the <I>lpdwSize</I> parameter will contain the required size for the string when the method returns.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. Returns D3DRMERR_NOTAGGREGATED if the external visual was not created with <B>IDirect3DRM3::CreateObject</B> or <B>IDirect3DRM3::Load</B> and is not aggregated onto <B>IDirect3DRMObject</B>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="ExternalUtil.htm#SetName">IDirect3DRMExternalUtil::SetName</A>
</BLOCKQUOTE>


<H1><A NAME="GetTextureHandle">IDirect3DRMExternalUtil::GetTextureHandle</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Enables you to obtain a D3DTEXTUREHANDLE texture handle with which to render textures from a device-dependent texture ID. <a href="#FindDeviceTexture">IDirect3DRMExternalUtil::FindDeviceTexture</a> supplies the texture ID.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT GetTextureHandle(
  DWORD dwDevTexId,
  LPDWORD pdwHandle);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>dwDevTexId</I></DT>
<DD> [in] Valid device-dependent texture ID, as returned by <a href="#FindDeviceTexture">IDirect3DRMExternalUtil::FindDeviceTexture</a>.</DD>
	
<DT><I>pdwHandle</I></DT>
<DD> [out] D3DTEXTUREHANDLE that the external visual developer uses to render.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
A texture handle identifies the coupling of a texture map with a device. A texture can be associated with more than one device. 
</BLOCKQUOTE>

<H1><A NAME="SetAppData">IDirect3DRMExternalUtil::SetAppData</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Sets the 32 bits of application-specific data in the object.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetAppData</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>ulData</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ulData</I>
</DT><DD>User-defined data to be stored with the object.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. Returns D3DRMERR_NOTAGGREGATED if the external visual was not created with <B>IDirect3DRM3::CreateObject</B> or <B>IDirect3DRM3::Load</B> and is not aggregated onto <B>IDirect3DRMObject</B>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="ExternalUtil.htm#GetAppData">IDirect3DRMExternalUtil::GetAppData</A>
</BLOCKQUOTE>

<H1><A NAME="SetExtents">IDirect3DRMExternalUtil::SetExtents</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Updates the current viewport's two-dimensional (2-D) extents. The <a href="externalvisual.htm#render">IDirect3DRMExternalVisual::Render</a> method uses this method.

<p>You can pass an array of values returned by the Microsoft&reg; Direct3D&reg; Immediate Mode <b>IDirect3DDevice::GetClipStatus</b> method to this function.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT SetExtents(
  LPDIRECT3DRMVIEWPORT2 lpRMView,
  DWORD dwNumExtents, 
  LPD3DCLIPSTATUS pExtents);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>lpRMView</I></DT>
<DD> [in] Viewport whose extents are going to be updated.</DD>

<DT><I>dwNumExtents</I></DT>
<DD> [in] Number of extents in the array <i>pExtents</i>.</DD>

<DT><I>pExtents</I></DT>
<DD>[in] Pointer to an array of 2-D extents, as returned by
	<b>IDirect3DDevice2::GetClipStatus</b>.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<H1><A NAME="SetName">IDirect3DRMExternalUtil::SetName</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Sets the object's name.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetName</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>char</B> <B>*</B> <I>lpName</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpName</I>
</DT><DD>User-defined data to name the object.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. Returns D3DRMERR_NOTAGGREGATED if the external visual was not created with <B>IDirect3DRM3::CreateObject</B> or <B>IDirect3DRM3::Load</B> and is not aggregated onto <B>IDirect3DRMObject</B>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="ExternalUtil.htm#GetName">IDirect3DRMExternalUtil::GetName</A>
</BLOCKQUOTE>


<H1><A NAME="UpdateBounds">IDirect3DRMExternalUtil::UpdateBounds</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Enables the external visual to set the current bounding box stored for it 
by Direct3D Retained Mode.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT UpdateBounds(
  DWORD dwFlags,
  LPD3DVECTOR dvMin,
  LPD3DVECTOR dvMax);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>dwFlags</I></DT>
<DD> [in] Valid flag values include the following:
<DL>
<DT>D3DRMEXTUTIL_BOUNDSVALID</DT>
<DD>Indicates the values passed in <i>dvMin</i> and <i>dvMax</i> are used to set the new bounding box.</DD>

<DT>D3DRMEXTUTIL_BOUNDSINVALIDATE</DT>
<DD>Indicates the current bounding box is cleared.</DD>
</DL>
</DD>

<DT><I>dvMin, dvMax</I></DT>
<DD> [in] Bounding box values.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>


<H1><A NAME="ValidateDeviceTextures">IDirect3DRMExternalUtil::ValidateDeviceTextures</A><HR size=1></H1>
<A HREF="ExternalUtil.htm">IDirect3DRMExternalUtil</A>
<P>Validates device textures. A texture is validated to ensure that the device can support the specified type of texture format and dimensions. This method should be used for every frame in which a texture is going to be used when rendering an external visual. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT ValidateDeviceTextures(
  LPDIRECT3DRMDEVICE2 lpRMDev,
  LPDWORD dwDevTexIds,
  DWORD dwNumIds);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>lpRMDev</I></DT>
<DD> [in] Pointer to a valid Direct3D Retained Mode device.</DD>

<DT><I>dwDevTexIds</I></DT>
<DD> [in] Array containing each of the device-dependent texture ID's that are being used. This array is passed to Direct3D Retained Mode.</DD>

<DT><I>dwNumIds</I></DT>
<DD> [in] Number of device-dependent texture ID's in the array <i>dwDevTexIds</i>.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A CLASS="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A CLASS="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>
