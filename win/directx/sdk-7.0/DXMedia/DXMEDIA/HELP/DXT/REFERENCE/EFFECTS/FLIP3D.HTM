<!-- DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN" -->

<HTML>
<HEAD><TITLE>Flip3D Transform</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../../' </SCRIPT>




<META NAME="Description" CONTENT="Flip3d transform">

<META NAME="KEYWORDS" CONTENT="Flip3d transform">

<META NAME="PRODUCT" CONTENT="DirectX Transform">

<META NAME="CATEGORY" CONTENT="Technical documentation; download">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>
<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="Effect_flip3d"></A>
<!--TOOLBAR_START-->

<!--TOOLBAR_EXEMPT-->

<!--TOOLBAR_END-->


<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectX Transform Animated Header -- Microsoft DirectX Transform SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="effects.htm">Topic Contents</A>
</PRE></TD></TR>

<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="flashpix.htm">FlashPix Transform</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="FlowMotion_meta.htm">FlowMotion Transform</A>
</PRE></TD></TR></TABLE>

<!-- NAV_LINKS_END -->





<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->


<h1>Flip3D Transform</h1>



<P>Provides a transition between two images by using a three-dimensional (3-D) animation that takes two surfaces as inputs and textures them on two 3-D rectangles. The first rectangle appears in front of the second, and the transform animates them by bending the first surface toward the back and the second surface toward the front, and then swapping between the two.


          

<CENTER>
<INPUT TYPE=BUTTON VALUE="Show Transform" ID=btnStart OnClick="start()"><BR><P>
<DIV ID=controlDiv align="center"> &nbsp; </DIV>
</CENTER>

<SCRIPT LANGUAGE="JavaScript">
  var FlagNotStarted = true;
  var FlagSCNotVisible = true;
  var DACONTROL = '<OBJECT ID="DAControl_flip3D" STYLE="width:230;height:180" \n'+
'CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D"> \n'+
'</OBJECT> ';
 
function CreateDA() {
	controlDiv.innerHTML = DACONTROL;
}

function start(){
   if (FlagNotStarted){
   	CreateDA();
	runthis();
	show();
    }
    else {
    	hide();
    }
}

function show(){
	FlagNotStarted = false;
	btnStart.value="Hide Transform";
	btnStart.style.display='';
}
function hide(){
	FlagNotStarted=true;
	controlDiv.innerHTML = '';
	btnStart.value="Show Transform";
	controlDiv.innerHTML = '';
}
</SCRIPT>
<SCRIPT LANGUAGE="JScript">
<!--
function runthis()
    { 
m = DAControl_flip3D.MeterLibrary;
mediaBase = "../../art/";
geoBase = mediaBase + "geometry/";
imageBase = mediaBase + "image/";

swGeo = m.ModifiableBehavior(m.EmptyGeometry);
swImg = m.ModifiableBehavior(m.EmptyImage);

rawImg1 = m.ImportImage(imageBase + "tigerstripe.jpg");
rawImg2 = m.ImportImage(imageBase + "mndscp2.jpg");

xf =new ActiveXObject("DX3DTransform.Microsoft.Flip");
holdTime = m.DANumber(0).Duration(1);
forward = m.Interpolate(0, 1, 3);
back = m.Interpolate(1, 0, 3);
evaluator = m.Sequence(holdTime, m.Sequence(forward, back)).RepeatForever();

result = m.ApplyDXTransform(xf, new Array(rawImg1, rawImg2), evaluator);
realGeo = result.OutputBvr;

realTransScale = m.Scale3Uniform(0.020);
realTransRotY = m.Rotate3Degrees( m.YVector3 ,45);
realTransF = m.Compose3Array(new Array( realTransScale, realTransRotY));

realGeo = realGeo.Transform(realTransF);

swGeo.SwitchTo(realGeo);

camera = m.PerspectiveCamera(0.06, 0.033);
light = m.UnionGeometry(m.AmbientLight, m.DirectionalLight.Transform(m.Rotate3Degrees(m.XVector3,-90)));
lightAndGeo = m.UnionGeometry(swGeo, light);

swImg.SwitchTo(lightAndGeo.render(camera));

DAControl_flip3D.Image = swImg;
DAControl_flip3D.Start();
}
-->

</SCRIPT>
<BR><P>


<p class="ref">Transform Specifications</p>
<p>The following table contains the information you need in order to use this transform in C++ and script.</p>
<TABLE>
<TR><TH>Class identifier (CLSID)
</TH><TD>CLSID_Flip
</TD></TR>

<TR><TH>Globally unique identifier (GUID)
</TH><TD>3A5EA1BA-3C28-11D1-9039-00C04FD9189D
</TD></TR>

<TR><TH>Programmatic identifier (ProgId)
</TH><TD>DX3DTransform.Microsoft.Flip
</TD></TR>

<TR><TH>Category identifier (CATID)
</TH><TD>CATID_DX3DTransform
</TD></TR>


<TR><TH>Custom interfaces
</TH><TD><B>IFlip</B>
</TD></TR>

<TR><TH>Supported interfaces
</TH><TD><A HREF="../../reference/Ifaces/idxeffect.htm">IDXEffect</A>
</TD></TR>

<TR><TH>Inputs
</TH><TD>One is required, of type <A HREF="../../reference/Ifaces/idxsurface.htm">IDXSurface</A> (preferred) or <B>IDirectDrawSurface</B>. The optimal <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_pixelformat')">pixel format</A> is DDPF_PMARGB32. The optional second input is of the same type as the first. If supplied, it results with a transition from the first input to the second input.
</TD></TR>

<TR><TH>Output
</TH><TD><A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_d3drmmeshbuilder')">Direct3DRMMeshBuilder3</A>
</TD></TR>

</TABLE>


<p class="ref">Custom Properties</p>
<p>The following table lists the custom properties that control the transform output.</p>
<P>
<TABLE>
<TR><TH>Property</th>
<TH>Type</TH>
<TH>Default</TH>
<TH>Description</TH>
</TR>

<TR><TD>Height</TD>
<TD>float</TD>
<TD>2.0</TD>
<TD>The height of the rectangle.


</TD></tr>

<TR><TD>Width</TD>
<TD>float</TD>
<TD>2.0</TD>
<td>The width of the rectangle.</td>
</tr>

<TR><TD>Depth</TD>
<TD>float</TD>
<TD>1.0</TD>
<td>The distance between the two images.</td>
</tr>




</TABLE>



<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->



<H6><HR size=1></H6>
<P><A CLASS="line" HREF="#pagetop"><IMG SRC="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A CLASS="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>
