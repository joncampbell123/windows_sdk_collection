<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDXEffect Interface</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../../' </SCRIPT>



<META NAME="Description" CONTENT="IDXEffect">
<META NAME="Description" CONTENT="IDXEffect::get_Capabilities">
<META NAME="Description" CONTENT="IDXEffect::get_Duration">
<META NAME="Description" CONTENT="IDXEffect::get_Progress">
<META NAME="Description" CONTENT="IDXEffect::get_StepResolution">
<META NAME="Description" CONTENT="IDXEffect::put_Duration">
<META NAME="Description" CONTENT="IDXEffect::put_Progress">
<META NAME="Description" CONTENT="get_Capabilities (IDXEffect)">
<META NAME="Description" CONTENT="get_Duration (IDXEffect)">
<META NAME="Description" CONTENT="get_Progress (IDXEffect)">
<META NAME="Description" CONTENT="get_StepResolution (IDXEffect)">
<META NAME="Description" CONTENT="put_Duration (IDXEffect)">
<META NAME="Description" CONTENT="put_Progress (IDXEffect)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>

<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>


<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDXEffect"></A>
<!-- TOOLBAR_START -->

<!-- TOOLBAR_END -->

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectX Transform Animated Header -- Microsoft DirectX Transform SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="interface_intro.htm">Topic Contents</A>
</PRE></TD></TR>

<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IDXDCLock.htm">IDXDCLock Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="idxgradient.htm">IDXGradient Interface</A>
</PRE></TD></TR></TABLE>

<!-- NAV_LINKS_END -->





<BLOCKQUOTE class="body">

<!-- CONTENTS_START -->


<H1>IDXEffect Interface</H1>


The <b>IDXEffect</b> interface is used to generically control transition settings on all transform objects. These transitions often produce animated images from static images or meshes. There could be other animation properties that the transform needs to produce its output. In these cases, the you should add these properties to the transform custom interface.

<p>
There are two variables that control the development of the effect. The <i>Progress</i> variable is a number from 0.0 to 1.0 that controls the percentage of the transition to be  completed. Animation effects are often produced by looping over increasing values for <i>Progress</i>, producing transform output at each step.

<p>
The <i>Duration</i> variable is a suggested time in seconds that such a  stepwise transition should take. In general, it only provides storage of the time value, and has no control over the transform output. It is up to the transform user to see that the transition over <i>Progress</i> values happens in the suggested time.

<p>
This interface inherits from <B>IDispatch</B>.


<P CLASS="ref">IDXEffect Methods</P>
<BLOCKQUOTE>
<TABLE CLASS="ref">
<TR><TD><A HREF="IDXEffect.htm#get_Capabilities">get_Capabilities</A></TD>
	<TD>Retrieves a value indicating the specific capabilities of a transition.
</TD></TR>
<TR><TD><A HREF="IDXEffect.htm#get_Duration">get_Duration</A></TD>
	<TD>Retrieves the recommended length of time for performing a transition.
</TD></TR>
<TR><TD><A HREF="IDXEffect.htm#get_Progress">get_Progress</A></TD>
	<TD>Retrieves the current setting of the transform's progress. 
</TD></TR>
<TR><TD><A HREF="IDXEffect.htm#get_StepResolution">get_StepResolution</A></TD>
	<TD>Retrieves the step size corresponding to the smallest meaningful change for <i>Progress</i>.
</TD></TR>
<TR><TD><A HREF="IDXEffect.htm#put_Duration">put_Duration</A></TD>
	<TD>Sets the suggested duration for the transition.
</TD></TR>
<TR><TD><A HREF="IDXEffect.htm#put_Progress">put_Progress</A></TD>
	<TD>Sets the requested progress made on the transform.
</TD></TR>
</TABLE>
</BLOCKQUOTE>


<H1><A NAME="get_Capabilities">IDXEffect::get_Capabilities</A><HR size=1></H1>
<P>Retrieves a value indicating specific capabilities of a transition.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT get_Capabilities(
	long *pVal
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pVal</I> 
 </DT><DD>[out] Value indicating the type (or types) of image transform.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>
If the return value has no flags set, the transform type is unknown.

<p>
If DXTET_PERIODIC is set, the transform produces the same result at <i>Progress</i> = 0 and at <i>Progress</i> = 1.





<p>
If DXTET_MORPH is set, and when the transform is set up with two inputs, the result at <i>progress </i> = 0 will be equal to the first input, and the result at <i>Progress</i> = 1 will equal the second. This flag will be set for all image 1 to image 2 transitions. For transforms that take two <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_dxsurface')">DXSurface</A> inputs and produce a three-dimensional (3-D) mesh, getting this flag indicates the transform will produce a mesh with a texture containing the image of input one at <i>Progress</i> = 0.  When <i>Progress</i> = 1, the transform must produce a mesh with a texture containing the image of input two.



<p>
Note that if both PERIODIC and MORPH are specified, the transform will be periodic if set up with only one input, and the transform will act as a morph if set up with two inputs.






</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P> <a href="../enums/dxeffecttype_enum.htm">DXEFFECTTYPE Enumeration</a>
</BLOCKQUOTE>




<H1><A NAME="get_Duration">IDXEffect::get_Duration</A><HR size=1></H1>
<P>Retrieves the recommended length of time for performing a transition.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT get_Duration(
	float *pVal
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pVal</I> 
 </DT><DD>[out] Amount of time (in seconds) the transition should take.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>This method retrieves the most recently suggested value for the transform duration. This value is only a suggestion, and for some transforms is completely ignored. 

</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="idxeffect.htm#put_duration">IDXEffect::put_Duration</A>
</BLOCKQUOTE>



<H1><A NAME="get_Progress">IDXEffect::get_Progress</A><HR size=1></H1>
<P>Retrieves the current setting of the transform's progress. 


<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT get_Progress(
	float *pVal
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pVal</I> 
 </DT><DD>[out] Value indicating the current progress setting of the transform.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The return value will be a float value from zero to one, with one signifying completion. 
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="idxeffect.htm#put_Progress">IDXEffect::put_Progress</A>
</BLOCKQUOTE>



<H1><A NAME="get_StepResolution">IDXEffect::get_StepResolution</A><HR size=1></H1>
<P>Retrieves the step size corresponding to the smallest meaningful change for <i>Progress</i>.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT get_StepResolution(
	float *pVal
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pVal</I> 
 </DT><DD>[out] Value indicating the smallest meaningful step size for the transform's transition.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Some transforms may not have a natural step resolution, or may be unable to compute their resolution. In these cases, the transform will return a value of zero.

<p>
The value returned by this method can be used to determine the maximum number of times a transform must <A HREF="idxtransform.htm#Execute">Execute</A> for a complete transition. For example, if the transform is alpha fading from 0 to 255 (clear to fully opaque), the step resolution will be 0.00392, or 1/255. 

<p>Executing the transform in smaller steps than <i>pVal</i> will not affect the outcome of the transform. You can use this to skip unnecessary executions of transforms.
</BLOCKQUOTE>




<H1><A NAME="put_Duration">IDXEffect::put_Duration</A><HR size=1></H1>
<P>Sets the suggested duration for the transition. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT put_Duration(
	float newVal
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>newVal</I> 
 </DT><DD>[in] Amount of time in seconds the effect should take.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>
This method enables you to suggest a reasonable default duration for transforms to use. This value is only a suggestion, and in some cases is completely ignored.

<p>
You can use this method while authoring content to force the transform to store the duration. When a transform is persisted, it saves the current value of the duration. Later, when it is restored from the persisted information, <B>get_Duration</B> will return the duration that was set earlier.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="idxeffect.htm#get_duration">IDXEffect::get_Duration</A>
</BLOCKQUOTE>




<H1><A NAME="put_Progress">IDXEffect::put_Progress</A><HR size=1></H1>
<P>Sets the requested progress made on the transform.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT put_Progress(
	float newVal
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>newVal</I> 
 </DT><DD>[in] Value from zero to one that indicates how much of the transition should be completed.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>
Effects use this value to determine what output to generate. For example, an image 1 to image 2 fade transform would produce an output of image 1 at <i>Progress</i> = 0 and an output of image 2 at <i>Progress</i> = 1. For <i>Progress</i> = 0.5, the resulting image is a blend of 50 percent image 1 and 50 percent image 2.



<p>
A user doesn't need to modify <i>Progress</i> in a linear fashion, as it is possible to go through a random sequence of values for this parameter.   If not initialized by this method, the value of <i>Progress</i> is undefined and could produce unexpected output.  





</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<p><A HREF="idxeffect.htm#get_Progress">IDXEffect::get_Progress</A>
</BLOCKQUOTE>


<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A CLASS="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A CLASS="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>
