<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirect3DRMExternalVisual Interface</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IDirect3DRMExternalVisual">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::BeginScene">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::CanSee">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::DeviceChange">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::EndScene">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::GetAge">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::GetBox">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::Initialize">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::Load">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::Pick">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::RayPick">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::Render">
<META NAME="Description" CONTENT="IDirect3DRMExternalVisual::SetRenderContext">
<META NAME="Description" CONTENT="BeginScene (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="CanSee (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="DeviceChange (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="EndScene (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="GetAge (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="GetBox (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="Initialize (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="Load (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="Pick (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="RayPick (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="Render (IDirect3DRMExternalVisual)">
<META NAME="Description" CONTENT="SetRenderContext (IDirect3DRMExternalVisual)">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>
<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>

<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="ExternalVisual_int"></A>
<!--TOOLBAR_START-->

<!--TOOLBAR_EXEMPT-->

<!--TOOLBAR_END-->


<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK --IDirect3DRMExternalVisual"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK --IDirect3DRMExternalVisual"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="ExtVisuals_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="ExternalUtil.htm">IDirect3DRMExternalUtil Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../errorandsuccess.htm">Error and Success Codes</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->





<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->





<H1><A NAME="IDirect3DRMExternalVisual"></A>IDirect3DRMExternalVisual Interface</H1>



<P>This interface is implemented by the external visual object, and is called by Direct3D Retained Mode to allow the object to interact with the visual hierarchy as a first-class object.
<P CLASS="ref">IDirect3DRMExternalVisual Methods</P>
<BLOCKQUOTE>
<TABLE CLASS="ref">
 <TR><TD><A HREF="#BeginScene">BeginScene</A>
 </TD><TD>Begins the scene.</TD></tr>

 <TR><TD><A HREF="#CanSee">CanSee</A>
 </TD><TD>Specifies whether the external visual should be rendered.</TD>
 </TR>

 <TR><TD><A HREF="#DeviceChange">DeviceChange</A>
 </TD><TD>Responds to device changes. Direct3D Retained Mode uses this method when the <b>IDirect3DRMDevice2</b> object that the external visual is being rendered with changes.</TD>
 </TR>

 <TR><TD><A HREF="#EndScene">EndScene</A>
 </TD><TD>Ends the scene.</TD>
 </TR>
 <TR><TD><A HREF="#GetAge">GetAge</A>
 </TD><TD>Supplies the external visual's current age
to Direct3D Retained Mode.</TD></tr>

 <TR><TD><A HREF="#GetBox">GetBox</A>
 </TD><TD>Supplies the external visual's bounding box to Direct3D Retained Mode.</TD>
 </TR>
 
<TR><TD><A HREF="#Initialize">Initialize</A>
 </TD><TD>Initializes the external visual.</TD></TR>
 
  <TR><TD><A HREF="#Load">Load</A>
 </TD><TD>Handles loading of an external visual from a DirectX file.</TD>
 </tr>

  <TR><TD><A HREF="#Pick">Pick</A>
 </TD><TD>Determines whether the external visual has been picked.</TD></tr>

 <TR><TD><A HREF="#RayPick">RayPick</A>
 </TD><TD>Determines whether the external visual has been picked by the specified ray.</TD>
 </TR>


 <TR><TD><A HREF="#Render">Render</A>
 </TD><TD>Renders the external visual.</TD>
 </TR>

 <TR><TD><A HREF="#SetRenderContext">SetRenderContext</A>
 </TD><TD>Provides the external visual with the current context in which to render.</TD>
 </TR>
</TABLE>
</BLOCKQUOTE>


<H1><A NAME="BeginScene">IDirect3DRMExternalVisual::BeginScene</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Begins the scene. The Direct3D Retained Mode <B>IDirect3DRMViewport2::Render</B> method calls this method immediately after calling the Microsoft Direct3D&reg; Immediate Mode <b>IDirect3DDevice::BeginScene</b> method.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT BeginScene(void);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>





<H1><A NAME="CanSee">IDirect3DRMExternalVisual::CanSee</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Specifies whether the external visual should be rendered. This method is called when an external visual is rendered. You can set the bounding box around the external visual with <A HREF="ExternalUtil.htm#UpdateBounds">IDirect3DRMExternalUtil::UpdateBounds</A>. Before rendering, the bounding box is checked to see if it is within the viewport. If it is, <B>CanSee</B> is called and should return D3DRMEXTVIS_CANSEE if the external visual should be rendered. If it shouldn't be rendered, <B>CanSee</B> should return D3DRMEXTVIS_CANNOTSEE. 



<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT CanSee(
  LPDIRECT3DRMDEVICE2 pRMDev,
  LPDIRECT3DRMVIEWPORT2 pRMView,
  LPDWORD pdwCanSee);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pRMDev</I></DT>
<DD> [in] Pointer to the Direct3D Retained Mode device.</DD>
<DT><I>pRMDev</I></DT>
<DD> [in] Pointer to the Direct3D Retained Mode viewport.</DD>
<DT><I>pdwCanSee</I></DT>
<DD> [out] Pointer to the value indicating whether the external visual's should be rendered or not. This value should be either D3DRMEXTVIS_CANSEE or D3DRMEXTVIS_CANNOTSEE. </DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>






<H1><A NAME="DeviceChange">IDirect3DRMExternalVisual::DeviceChange</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Responds to device changes. Direct3D Retained Mode uses this method when the <b>IDirect3DRMDevice2</b> 
object that the external visual is being rendered with changes. The next 
<a href="#Render">IDirect3DRMExternalVisual::Render</a> call will pass the new <b>IDirect3DRMDevice2</b> object.



<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT DeviceChange(void);</PRE>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>




<H1><A NAME="EndScene">IDirect3DRMExternalVisual::EndScene</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Ends the scene. The Direct3D Retained Mode <B>IDirect3DRMDevice3::Update</B> method uses <B>EndScene</B> immediately before using the Direct3D Immediate Mode <b>IDirect3DDevice::EndScene</b> method.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT EndScene(void);</PRE>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>




<H1><A NAME="GetAge">IDirect3DRMExternalVisual::GetAge</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Supplies the external visual's current age


to Direct3D Retained Mode. Age is a number that is incremented every time the external visual changes. Direct3D Retained Mode determines that the external visual has changed by examining its age. The external visual should increment its current age whenever an internal state changes. Note that the age must be incremented. It cannot simply be changed (for example, decremented).

 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT GetAge(
  LPDWORD pdwAge);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pdwAge</I></DT>
<DD> [out] Return pointer in which the external visual should fill in its 
	current	age.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>


<H1><A NAME="GetBox">IDirect3DRMExternalVisual::GetBox</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Supplies the external visual's bounding box to Direct3D Retained Mode.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT GetBox(LPD3DRMBOX pRMBox);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pRMBox</I></DT>
<DD> [out] Return pointer in which the external visual should fill in 
	its current bounding box values.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>



<H1><A NAME="Initialize">IDirect3DRMExternalVisual::Initialize</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Initializes the external visual. Direct3D Retained Mode uses this method for all external visuals 
that it instantiates. The external visual is passed pointers to the creating Direct3D Retained Mode <B>IDirect3DRM</B> object and to an <a href="externalutil.htm">IDirect3DRMExternalUtil</a> object.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT Initialize(
  LPDIRECT3DRM pD3DRM, 
  LPDIRECT3DRMEXTERNALUTIL pExtUtil,
  DWORD dwFlags);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pD3DRM</I></DT>
<DD> [in] Pointer to the <B>IDirect3DRM</B> object. The reference count for this object has already been incremented for the external visual. The object should be released by the external visual when it is no longer required.</DD>

<DT><I>pExtUtil</I></DT>
<DD> [in] Pointer to the <a href="externalutil.htm">IDirect3DRMExternalUtil</a> object. The reference count for this object has already been incremented for the external visual. The object should be released by the external visual when it is no longer required. The <b>IDirect3DRMExternalUtil</b> object implements helper functions for texture caching.</DD>

<DT><I>dwFlags</I></DT>
<DD> [in] Must be zero.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>


<H1><A NAME="Load">IDirect3DRMExternalVisual::Load</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Handles loading of


an external visual from a DirectX file. The Direct3D Retained Mode DirectX file loader


first uses <b>CoCreateInstance</b> on the external visual using the CLSID specified by the external visual's DirectX file object


(hence the file loader calls <a href="#Initialize">IDirect3DRMExternalVisual::Initialize</a> before calling this method). The loader then loads any properties contained by the external visual object and calls this method to load the external visual. Any properties are passed to the external visual in the <B>IPropertyBag</B> object,


 <i>pPropBag</i>. 

<p>The Direct3D Retained Mode <B>IDirectXFileData</B> object can be used to parse and create any data specific to external visual that is stored in the DirectX file.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT Load(
  IDirectXFileData *dObject,
  IPropertyBag *pPropBag,
  DWORD dwFlags);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>dObject</I></DT>
<DD>[in] Pointer to the current External Visual DirectX file object. 
	The external visual can call the <B>IDirectXFileData::GetNextObject</B> method
	to parse through any DirectX File objects that it requires.</DD>

<DT><I>pPropBag</I></DT>
<DD> [in] Property bag containing any text properties.</DD>

<DT><I>dwFlags</I></DT>
<DD> [in] Must be zero.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>


<H1><A NAME="Pick">IDirect3DRMExternalVisual::Pick</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Determines whether the external visual has been picked. <B>IDirect3DRMViewport::Pick</B> calls this method. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT Pick(
  LPDIRECT3DRMVIEWPORT2 pViewIn,
  LPDIRECT3DRMFRAME3 pFrameIn,
  DWORD dwXIn,
  DWORD dwYIn,
  LPD3DVALUE pdvZOut,
  LPDWORD pdwPicked);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pViewIn</I></DT>
<DD> [in] Pointer to a valid Direct3D Retained Mode viewport.</DD>

<DT><I>pFrameIn</I></DT>
<DD> [in] Pointer to the Direct3D Retained Mode frame containing the external visual.</DD>

<DT><I>dwXIn</I></DT>
<DD> [in] X screen coordinate used for picking.</DD>

<DT><I>dwYIn</I></DT>
<DD> [in] Y screen coordinate used for picking.</DD>

<DT><I>pdvZOut</I></DT>
<DD> [out] Z value for where the pick hit the external visual.</DD>



<DT><I>pdwPicked</I></DT>


<DD> [out] Pointer to a value specifying whether the external visual was picked or not. Set to D3DRMEXTVIS_PICK if the ray hits the external
	visual, otherwise set to D3DRMEXTVIS_NOTPICKED.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>


<H1><A NAME="RayPick">IDirect3DRMExternalVisual::RayPick</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Determines whether the external visual has been picked by the specified ray. The Direct3D Retained Mode <B>IDirect3DRMFrame3::RayPick</B> calls this method. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT RayPick(
  LPDIRECT3DRMFRAME3 pFrameIn,
  LPD3DRMRAY pRayIn,
  DWORD dwFlags,
  DWORD pdwPicked,
  LPD3DRMEXTVISRAYPICKINFO pPickInfo);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pFrameIn</I></DT>
<DD> [in] Pointer to a valid Direct3D Retained Mode frame from which the ray originates.</DD>

<DT><I>pRayIn</I></DT>
<DD> [in] Pointer to the specified ray.</DD>

<DT><I>dwFlags</I></DT>
<DD> [in] Must be zero.</DD>

<DT><I>pdwPicked</I></DT>


<DD> [out] Pointer to a value specifying whether the external visual was picked or not. Set to D3DRMEXTVIS_PICK if the ray hits the external
	visual, otherwise set to D3DRMEXTVIS_NOTPICKED.</DD>
	
<DT><I>pPickInfo</I></DT>
<DD> [out] Pointer to the D3DRMEXTVISRAYPICKINFO structure containing information about the point at which the ray hit. See <B>Remarks</B> for a description of the structure.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref"><A NAME="D3DRMEXTVISRAYPICKINFO" IDX_CONCEPT="D3DRMEXTVISRAYPICKINFO"></A>Remarks</P>
<BLOCKQUOTE>
<p>The D3DRMEXTVISRAYPICKINFO structure contains information about the point the ray hit and is defined as follows.
<PRE>
typedef struct
{
    D3DVALUE  dDistance;
    D3DVECTOR dvPosition;
    D3DVECTOR dvNormal;
    D3DVALUE  tu;
    D3DVALUE  tv;
    D3DCOLOR  dcColor;
} D3DRMEXTVISRAYPICKINFO, *LPD3DRMEXTVISRAYPICKINFO;
</PRE>
</BLOCKQUOTE>
<P CLASS="ref">Members</P>
<BLOCKQUOTE>
<DL><DT><B><A NAME="dDistance">dDistance</A></B>
</DT><DD>Distance between origin of the ray and the point where it hits
the object being picked. 
</DD><DT><B><A NAME="dvPosition">dvPosition</A></B>
</DT><DD>Position of ray when it hits the object.
</DD><DT><B><A NAME="dvNormal">dvNormal</A></B>
</DT><DD>Normal on the object at the point the ray hits the object. 
</DD><DT><B><A NAME="tu_and_tv">tu, tv</A></B>
</DT><DD>Texture coordinate values at the point the ray hits the object.
</DD><DT><B><A NAME="dcColor">dcColor</A></B>
</DT><DD>Color at the point the ray hits the object.
</DD></DL>
</BLOCKQUOTE>


<H1><A NAME="Render">IDirect3DRMExternalVisual::Render</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Renders the external visual. Direct3D Retained Mode calls this method when it requires the external
visual to render itself. Direct3D Retained Mode guarantees to pass the external visual an <b>IDirect3DRMDevice2</b> interface from which the external visual can obtain a Direct3D Immediate Mode <b>IDirect3DDevice2</b> interface.
The external visual can then use the DirectX <b>DrawPrimitive</b> interface. Similarly, the external visual can obtain a Direct3D Immediate Mode <b>IDirect3DViewport2</b> interface from the Direct3D Retained Mode <B>IDirect3DRMViewport2</B> interface. The external visual should set any required render states (unless an override is in effect).



<p><b>Render</b> should call the <a href="externalutil.htm#SetExtents">IDirect3DRMExternalUtil::SetExtents</a> method when it has finished rendering. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT Render(
  LPDIRECT3DRMDEVICE2 pRMDev,
  LPDIRECT3DRMVIEWPORT2 pRMView, 
  DWORD dwFlags);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pRMDev</I></DT>
<DD> [in] Direct3D Retained Mode device to render with. </DD>

<DT><I>pRMView</I></DT>
<DD> [in] Direct3D Retained Mode viewport to render with.</DD>

<DT><I>dwFlags</I></DT>
<DD> [in] Must be zero.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>



<H1><A NAME="SetRenderContext">IDirect3DRMExternalVisual::SetRenderContext</A><HR size=1></H1>
<A HREF="ExternalVisual.htm">IDirect3DRMExternalVisual</A>
<P>Provides the external visual with the current context in which to render. Direct3D Retained Mode calls this method immediately before calling <a href="#Render">IDirect3DRMExternalVisual::Render</a>. The current context includes any material overrides that are in effect.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT SetRenderContext(
  LPD3DRMEXTVISRENDERCONTEXT pCntx,
  DWORD dwFlags);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pCntx</I></DT>
<DD> [in] Pointer to the current render context.</DD>

<DT><I>dwFlags</I></DT>
<DD> [in] Must be zero.</DD>
</DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>


<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If the data members <i>pCntx.hMat</i> or <i>pCntx.hTex</i>


are valid 
	(indicated with the D3DRMEXTVIS_RENDERCONTEXT_OVERRIDEMATERIAL and
	D3DRMEXTVIS_RENDERCONTEXT_OVERRIDETEXTURE flags), the external
	visual should use these handles to set the current material light state
	and texture render state. If D3DRMEXTVIS_RENDERCONTEXT_NEWUSEROVERRIDE
	is set, the <i>pCntx.dmUserOverride</i>


is valid, and the external visual
	should override the individual material attributes. See 
	Direct3D Retained Mode's <B>IDirect3DRMFrame3::SetMaterialOverride</B> for more information.
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A CLASS="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A CLASS="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>
