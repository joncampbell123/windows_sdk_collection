<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDXSurfaceFactory Interface</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../../' </SCRIPT>


<META NAME="Description" CONTENT="IDXSurfaceFactory">
<META NAME="Description" CONTENT="IDXSurfaceFactory::BitBlt">
<META NAME="Description" CONTENT="IDXSurfaceFactory::CopySurfaceToNewFormat">
<META NAME="Description" CONTENT="IDXSurfaceFactory::CreateD3DRMTexture">
<META NAME="Description" CONTENT="IDXSurfaceFactory::CreateFromDDSurface">
<META NAME="Description" CONTENT="IDXSurfaceFactory::CreateSurface">
<META NAME="Description" CONTENT="IDXSurfaceFactory::LoadImage">
<META NAME="Description" CONTENT="IDXSurfaceFactory::LoadImageFromStream">
<META NAME="Description" CONTENT="BitBlt (IDXSurfaceFactory)">
<META NAME="Description" CONTENT="CopySurfaceToNewFormat (IDXSurfaceFactory)">
<META NAME="Description" CONTENT="CreateD3DRMTexture (IDXSurfaceFactory)">
<META NAME="Description" CONTENT="CreateFromDDSurface (IDXSurfaceFactory)">
<META NAME="Description" CONTENT="CreateSurface (IDXSurfaceFactory)">
<META NAME="Description" CONTENT="LoadImage (IDXSurfaceFactory)">
<META NAME="Description" CONTENT="LoadImageFromStream (IDXSurfaceFactory)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../../ver.js"></SCRIPT>
<SCRIPT SRC="../../gloss.js"></SCRIPT>
<!-- SNIFF_END -->


<SCRIPT DEFER SRC="../../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>


<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDXSurfaceFactory"></A>
<!--TOOLBAR_START-->

<!--TOOLBAR_EXEMPT-->

<!--TOOLBAR_END-->


<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectX Transform Animated Header -- Microsoft DirectX Transform SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../../contents.htm">Contents</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../../index.htm">Index</A>  <IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="interface_intro.htm">Topic Contents</A>
</PRE></TD></TR>

<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IDXSurface.htm">IDXSurface Interface</A>
<IMG SRC="../../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IDXSurfaceInit.htm">IDXSurfaceInit Interface</A>
</PRE></TD></TR></TABLE>

<!-- NAV_LINKS_END -->





<BLOCKQUOTE class="body">


<!-- CONTENTS_START -->


<H1>IDXSurfaceFactory Interface</H1>
<p>The <B>IDXSurfaceFactory</B> interface provides support services






for the creation of <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_dxsurface')">DXSurface</A> data objects. This interface is exposed by  the <b>IDXTransformFactory</b> interface. The recommended way to access this interface is by using the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_Q.htm#gloss_queryservice')">QueryService</A> method on the <A HREF="idxtransformfactory.htm">IDXTransformFactory</A> with SID_DXSurfaceFactory as the service ID.






<p>
You can create <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_proceduralsurface')">Procedural Surfaces</A> by specifying the CLSID of the procedural surface


in the pixel format member


and by using the standard <B>CreateSurface</B> method.


 In this case, you would not need to use a <B>SurfaceFactory</B> object to create <B>DXSurface</B> objects.



<P CLASS="ref">IDXSurfaceFactory Methods</P>
<BLOCKQUOTE>
<TABLE CLASS="ref">
<TR><TD><A HREF="IDXSurfaceFactory.htm#bitblt">BitBlt</A></TD>
	<TD>Copies samples from one <b>DXSurface</b> to another. 
</TD></TR>
<TR><TD><A HREF="IDXSurfaceFactory.htm#copysurfacetonewformat">CopySurfaceToNewFormat</A></TD>
	<TD>Copies one surface to another and changes its pixel format.
</TD></TR>
<TR><TD><A HREF="IDXSurfaceFactory.htm#CreateD3DRMTexture">CreateD3DRMTexture</A></TD>
	<TD>Creates a Microsoft&reg; Direct3D&reg; Retained Mode texture from a <B>DXSurface</B>.
</TD></TR>
<TR><TD><A HREF="IDXSurfaceFactory.htm#CreateFromDDSurface">CreateFromDDSurface</A></TD>
	<TD>Creates a <B>DXSurface</B> object that is aggregated to a specified Microsoft DirectDraw&reg; surface.
</TD></TR>
<TR><TD><A HREF="IDXSurfaceFactory.htm#CreateSurface">CreateSurface</A></TD>
	<TD>Creates a <B>DXSurface</B> object of the specified size and format.
</TD></TR>
<TR><TD><A HREF="IDXSurfaceFactory.htm#LoadImage">LoadImage</A></TD>
	<TD>Binds the specified file name or URL and returns a <B>DXSurface</B> containing the image data.
</TD></TR>
<TR><TD><A HREF="IDXSurfaceFactory.htm#LoadImageFromStream">LoadImageFromStream</A></TD>
	<TD>Loads an image from a specified stream and returns a <B>DXSurface</B>.
</TD></TR>

</TABLE>
</BLOCKQUOTE>


<H1><A NAME="bitblt">IDXSurfaceFactory::BitBlt</A><HR size=1></H1>
<p>Copies samples from one <b>DXSurface</b> to another.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT BitBlt(
     IDXSurface *pDest,
     const DXVEC *pPlacement,
     IDXSurface *pSrc,
     const DXBNDS *pPortionBounds,
     DWORD dwFlags
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pDest</I> 
 </DT><DD>[in] Pointer to the destination <B>DXSurface</B>.
</DD>
<DT><I>pPlacement</I> 
</DT><DD>[in] Pointer to a <A HREF="../structs/DXVEC_struct.htm">DXVEC</A> structure corresponding to the displaced position of the source surface on the destination surface. If this parameter is NULL, the data will be placed at the origin of the destination surface. 
<DT><I>pSrc</I> 
 </DT><DD>[in] Pointer to the source <B>DXSurface</B>.
</DD>
<DT><I>pPortionBounds</I> 
 </DT><DD>[in] Pointer to a <A HREF="../structs/DXBNDS_struct.htm">DXBNDS</A> structure corresponding to the portion of the source surface to copy to the destination. If this parameter is NULL, the entire source surface is copied. 
</DD>
<DT><I>dwFlags</I> 
 </DT><DD>[in] One of the <a href="../enums/dxbltoptions_enum.htm">DXBLTOPTIONS</a> used to specify what type of blit operation to perform. 
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>
This method performs all necessary clipping for the specified placement and/or clipping bounds.


If no data is transferred (that is, the clipping results in an empty region), the call returns S_FALSE.
<p>
DXBOF_DO_OVER and DXBOF_DITHER are the two valid flags for this method. These flags can be used independently or in combination. If no flags are specified, the data is simply copied from the source to the destination. If the DXBOF_DO_OVER flag is set, the source data is blended with the destination data by <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#gloss_alphablending')">alpha-blending</A>. If DXBOF_DITHER is set and the destination's pixel format has fewer bits per pixel of color information than the source, the data will be dithered before being copied to or blended with the destination.

 
<p>
There is a similar helper function


provided in DXHELPER.H called <b>DXBitBlt</b>.
Some transforms may find it more convenient to call that helper function directly rather than use this function.


For example, the bounds provided in the WORKINFO structure


can be used to directly call <b>DXBitBlt</b>. However, <b>DXBitBlt</b> doesn't clip or validate parameters as this function does. 

<p>This method supports
<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#gloss_alphablending)">alpha blending</a> 
during blit operations on <B>DXSurfaces</B>. Coordinates for both clipping and displacement are relative to the upper-left corner of the surfaces. 
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P>DXBLTOPTIONS enumeration


</BLOCKQUOTE>



<H1><A NAME="CopySurfaceToNewFormat">IDXSurfaceFactory::CopySurfaceToNewFormat</A><HR size=1></H1>
<p>Copies one surface to another surface and changes its pixel format.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT CopySurfaceToNewFormat(
    IDXSurface *pSrc,
    IUnknown *pDirectDraw,
    const DDSURFACEDESC *pDDSurfaceDesc,
    const GUID *pDestFormatId,
    IDXSurface **ppNewSurface
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSrc</I> 
 </DT><DD>[in] Pointer to a <B>DXSurface</B> to copy.
</DD>
<DT><I>pDirectDraw</I> 
 </DT><DD>[in] Optional pointer to the DirectDraw object from which the <B>DXSurface</B> was created. Used only to copy DirectDraw information when multiple DirectDraw objects exist, for example, with dual monitors.
</DD>
<DT><I>pDDSurfaceDesc</I> 
 </DT><DD>[in] Optional pointer to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_ddsurfacedesc')">DDSURFACEDESC</A> structure that describes the underlying <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_ddsurf')">DirectDrawSurface</a>. For more information, see the Remarks section.
</DD>
<DT><I>pDestFormatId</I> 
 </DT><DD>[in] Pixel format of the destination surface. If NULL, the pixel format for the current monitor display setting is used.
</DD>
<DT><I>ppNewSurface</I> 
 </DT><DD>[out] Address of a pointer that will contain the new <B>DXSurface</B> interface when the function returns.


</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method creates a new <B>DirectDrawSurface</B> of the same height and width as the source and returns the interface pointer in <i>ppNew</i>. If no pixel format is specified by <i>pDestFormatId</i> and none is specified by <i>pDDSurfaceDesc</i>, the surface is created by using the standard DirectDraw pixel format that matches the current display pixel format. 
<p>


     <table>
        <tr>
          <td>Flag(s)</td>
          <td>Not set in <I>dwFlags</I>.</td>
          <td>Set in <I>dwFlags</I>.</td>
        </tr>
        <tr>
          <td>DDSD_CAPS</td>
          <td>Surface will be created in system memory.</td>
          <td>The Caps specified in the surface description will be used.</td>


        </tr>
        <tr>
          <td>DDSD_PIXELFORMAT</td>
          <td>If <i>pFormatId</i> is NULL, the surface will be created with the <B>DirectDrawSurface</B>
          object's default pixel format.&nbsp; If <i>pFormatId</i> is specified, the surface is created with that format.</td>
          <td>Surface will be created with the pixel format specified in the surface
          description.&nbsp; IMPORTANT:&nbsp; If <i>pFormatId</i> is specified but does not match the format in
          the surface description, the <B>DXSurface</B> will create the surface using the surface description's pixel
          format but will treat the surface as though it has the format specified by <i>pFormatId</i>.&nbsp; For more information, see the
          Remarks section.</td>
        </tr>
        <tr>
          <td>DDSD_HEIGHT | DDSD_WIDTH</td>
          <td>Surface will be created with the same height and width as the source surface.</td>
          <td><i>dwHeight</i> and <i>dwWidth</i> fields


must match the height and width of the source
          surface.</td>
        </tr>
      </table>


<p>
If the <i>pDDSurfaceDesc</i> parameter specifies a pixel format, and a <i>pFormatId</i> is specified, the surface is created with DirectDraw by using the pixel format specified in <i>pDDSurfaceDesc</i>. However, the <B>DXSurface</B> treats the surface as though it has the format specified by <i>pFormatId</i>. This feature is used internally by the DXTransform core


to provide alpha channel support on versions of DirectDraw that do not support per-pixel alpha. You should never use this feature unless you fully understand the implications of the interaction between <B>DirectDraw</B> and <B>DXSurfaces</B>. In general, it is best to only specify a <i>pFormatId</i> and not to specify a pixel format in <i>pDDSurfaceDesc</i>.
<p>
If the source surface has more bits per color channel than the destination, the function


dithers the source image when copying to the new surface. If the source surface has transparency, and the new surface's pixel format does not support an alpha channel, a color key of 0xFFFF00FF (cyan) is set on the destination surface to preserve the transparency.


</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="../enums/DXSAMPLEFORMATENUM_enum.htm">DXSAMPLEFORMATENUM enumeration</a>, <A HREF="../../overview/pixelformats.htm">Supported Pixel Formats</a>
</BLOCKQUOTE>



<H1><A NAME="CreateD3DRMTexture">IDXSurfaceFactory::CreateD3DRMTexture</A><HR size=1></H1>
<p>Creates a Microsoft&reg; Direct3D&reg; Retained Mode texture from a <B>DXSurface</B>.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT CreateD3DRMTexture(
    IDxSurface *pSrc,
    IUnknown *pDirectDraw,
    IUnknown *pD3DRM3,
    REFIID riid,
    void **ppTexture3
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pSrc</I>
 </DT><DD>[in] Pointer to the <B>DXSurface</B> to use to create the texture.
</DD><DT><I>pDirectDraw</I> 
 </DT><DD>[in] Optional pointer to the DirectDraw object to use to create the texture.
</DD>
<DT><I>pD3DRM</I>
</DT><DD>[in] Pointer to the <B>IDirect3DRMMeshBuilder3</B> interface on the Direct3D Retained Mode object to use for creating the texture.
</DD>
<DT><I>riid</I> 
</DT><DD>[in] Interface identifier (IID) of the interface to return from the newly created surface.
</DD>
<DT><I>ppTexture3</I> 


 </DT><DD>[out] Pointer to the <B>IDirect3DRMTexture3</B> interface on the created texture object.

</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method creates a copy of the <B>DXSurface</B>. The resulting <B>D3DRMTexture</B> pointer refers to the new surface.
</BLOCKQUOTE>


<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="IDXSurfaceFactory.htm#CreateSurface">IDXSurfaceFactory::CreateSurface</A>, <A HREF="IDXSurfaceFactory.htm#CreateFromDDSurface">IDXSurfaceFactory::CreateFromDDSurface</A>
</BLOCKQUOTE>


<H1><A NAME="CreateFromDDSurface">IDXSurfaceFactory::CreateFromDDSurface</A><HR size=1></H1>
<p>Creates a <B>DXSurface</B> that contains a specified <B>DirectDrawSurface</B>.







<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT CreateFromDDSurface(
    IUnknown *pDDrawSurface,
    const GUID *pFormatID,
    DWORD dwFlags,
    IUnknown *punkOuter,
    REFIID riid, 
    void **ppDXSurface
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pDDrawSurface</I> 
 </DT><DD>[in] Pointer to a <B>DirectDrawSurface</B> to wrap with a new <B>DXSurface</B>.
</DD>
<DT><I>pFormatID</I> 


 </DT><DD>[in] Optional, usually NULL. If this field


is non-NULL, the pixel format of the <B>DirectDrawSurface</B> is ignored, and the data is treated as though it were the format specified by this globally unique identifier (GUID).


 This is usually used to force a <B>DirectDrawSurface</B> that has no alpha channel to be treated as a 32-bit surface with alpha. 
</DD>
<DT><I>dwFlags</I> 
</DT><DD>[in] <A HREF="../enums/DXSFCREATE_enum.htm">DXSFCREATE</A> creation flags. A value of DXSF_FORMAT_IS_CLSID specifies that the <I>pFormatID</I> parameter is the class identifier (CLSID) of a custom surface implementation.
</DD>
<DT><I>punkOuter</I> 


 </DT><DD>[in] Optional outer <B>IUnknown</B> interface pointer for aggregation.


</DD>
<DT><I>riid</I> 
 </DT><DD>[in] Interface to return from the newly created surface.
</DD>
<DT><I>ppDXSurface</I> 
 </DT><DD>[out] Address of a pointer to the newly created interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>
The default behavior for a system memory <b>DXSurface</b> is to do all lock arbitration at the <b>DXSurface</b> level for performance and correct lock behavior. The <B>DirectDrawSurface</B> is locked once to obtain a memory pointer and then released. If the user plans to access the underlying <b>IDirectDrawSurface::Lock</b> method directly (not via the <b>DXSurface</b> interface), DXSF_NO_LAZY_DDRAW_LOCK must be used. In this case, a lock to the <b>DXSurface</b> will always lock the underlying <B>DirectDrawSurface</B> assuring safe access. This is the default for video memory based surfaces. 
<p>

The resulting <B>DXSurface</B> uses the source color key of the underlying <B>DirectDrawSurface</B>.
</BLOCKQUOTE>


<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="IDXSurfaceFactory.htm#CreateSurface">IDXSurfaceFactory::CreateSurface</A>, <A HREF="IDXSurfaceFactory.htm#CreateD3DRMTexture">IDXSurfaceFactory::CreateD3DRMTexture</A>, <A HREF="../enums/DXSFCREATE_enum.htm">DXSFCREATE enumeration</A>
</BLOCKQUOTE>


<H1><A NAME="CreateSurface">IDXSurfaceFactory::CreateSurface</A><HR size=1></H1>
<p>Creates a <B>DXSurface</B> object of the specified size and format.


<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT CreateSurface(
    IUnknown *pDirectDraw,
    const DDSURFACEDESC *pDDSurfaceDesc,
    const GUID *pFormatID,
    const DXBNDS *pBounds,
    DWORD dwFlags,
    IUnknown *punkOuter,
    REFIID riid, 
    void **ppDXSurface
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pDirectDraw</I> 
 </DT><DD>[in] Optional pointer to the DirectDraw object to use to create the surface. If NULL, the DirectDraw object is obtained from the Transform Factory's service provider. 
</DD>
<DT><I>pDDSurfaceDesc</I> 
 </DT><DD>[in] Pointer to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_ddsurfacedesc')">DDSURFACEDESC</A> structure that describes the underlying <B>DirectDrawSurface</B>. For more information, see the Remarks section.
</DD>
<DT><I>pFormatID</I> 


 </DT><DD>[in] Pixel format of the <B>DirectDrawSurface</B>. If NULL, a surface matching the display's pixel format is created.
</DD>
<DT><I>pBounds</I> 


 </DT><DD>[in] <A HREF="../structs/DXBNDS_struct.htm">DXBNDS</A> structure value that specifies the height, width, and depth of the surface, in <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#gloss_sample')">samples</A>.
</DD>
<DT><I>dwFlags</I> 
</DT><DD>[in] <A HREF="../enums/DXSFCREATE_enum.htm">DXSFCREATE</A> creation flags. If DXSF_FORMAT_IS_CLSID is set, it specifies that the <i>pFormatID</i> parameter


is the CLSID of a custom surface implementation. If DXSF_NO_LAZY_DDRAW_LOCK is set, all calls to <a href="idxsurface.htm#LockSurface">IDXSurface::LockSurface</a> will always call the <B>DirectDrawSurface</B>'s lock method, even for system memory surfaces. If this flag is not set, system memory surfaces will not be locked through the <B>DirectDrawSurface</B> interface when the <B>DXSurface</B> is locked. In general, this flag should only be set if you plan on locking <B>DirectDrawSurfaces</B>.

</DD>
<DT><I>punkOuter</I> 


 </DT><DD>[in] Optional outer <B>IUnknown</B> interface pointer for aggregation.


</DD>
<DT><I>riid</I> 
 </DT><DD>[in] Interface to return from the newly created surface.
</DD>
<DT><I>ppDXSurface</I> 
 </DT><DD>[out] Address of a pointer to the newly created interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If the system


is using a version of DirectDraw that allows aggregation, the <B>DXSurface</B> object will aggregate with a <B>DirectDrawSurface</B>. 
<p>
If the flag DXSF_FORMAT_IS_CLSID is set, this method calls <B>CoCreateInstance</B> by using the <i>pFormatId</i> parameter


as the CLSID to create a surface object of this class.
After creating the surface object, this method calls the <a href="idxsurfaceinit.htm#InitSurface">IDXSurfaceInit::InitSurface</a> method on the object to initialize it. This is the case for <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_proceduralsurface')">Procedural Surfaces</A>, such as Surface Modifiers.
<p>
It is important to understand the relationship between fields


specified in the <i>pDDSurfaceDesc</i>, <i>pBounds</i>, and <i>pFormatId</i> parameters. The <i>pDDSurfaceDesc</i> parameter is not required. If it is NULL, the surface will be created as a system memory <B>DirectDrawSurface</B> with the height and width specified by the <i>pBounds</i> parameter, and optionally, the format specified by the <i>pFormatId</i> parameter. If a <i>pDDSurfaceDesc</i> is provided, it does not need to be a complete <B>DirectDrawSurface</B> description. The caller


should set the flags for the fields that are valid in the <b>DDSURFACEDESC</b> structure that need to be overridden and can allow other flags to be set by the <B>CreateSurface</B> call.

<P>The following table describes the flags and their interaction with other parameters.
<p>


    <table>
      <tr>
        <td>Flag(s)</td>
        <td>Not set in <I>dwFlags</I></td>
        <td>Set in <I>dwFlags</I></td>
      </tr>
      <tr>
        <td>DDSD_CAPS</td>
        <td>Surface will be created in system memory.</td>
        <td>The Caps specified in the surface description will be used.</td>
      </tr>
      <tr>
        <td>DDSD_PIXELFORMAT</td>
        <td>If <i>pFormatId</i> is NULL, the surface is created with the DirectDraw
        object's default pixel format.&nbsp; If <i>pFormatId</i> is specified, the surface is
        created with the specified format.</td>
        <td>Surface is created with the pixel format specified in the surface
        description.&nbsp; IMPORTANT:&nbsp; If <I>pFormatId</I> is specified but does not match the format in
        the surface description, the <B>DXSurface</B> creates the surface by using the surface description's pixel
        format, but treats the surface as though it has the format specified by <i>pFormatId</i>.&nbsp; For more information, see the Remarks section.</td>
      </tr>
      <tr>
        <td>DDSD_HEIGHT | DDSD_WIDTH</td>
        <td><I>pBounds</I> is required.&nbsp; Surfaces are created with height and width
        specified by <I>pBounds</I>.</td>
        <td><I>pBounds</I> can be NULL.&nbsp; If <i>pBounds</i> is not NULL, the heights and
        widths of the surface description and the bounds structure must match.</td>
      </tr>
    </table>


<p>
If the <i>pDDSurfaceDesc</i> specifies a pixel format and a <i>pFormatId</i> is specified, the surface is created with DirectDraw using the pixel format specified in <i>pDDSurfaceDesc</i>, but the <B>DXSurface</B> treats the surface as though it has the format specified by <i>pFormatId</i>. This feature is used internally by the DXTransform core


to provide alpha channel support on versions of DirectDraw that do not support per-pixel alpha. You should never use this feature unless you fully understand the implications of the interaction between DirectDraw and <B>DXSurfaces</B>. In general, it is best to only specify a <i>pFormatId</i>, not to specify a pixel format in the <i>pDDSurfaceDesc</i>.



</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="IDXSurfaceFactory.htm#CreateD3DRMTexture">IDXSurfaceFactory::CreateD3DRMTexture</A>, <A HREF="IDXSurfaceFactory.htm#CreateFromDDSurface">IDXSurfaceFactory::CreateFromDDSurface</A>, <A HREF="../enums/DXSFCREATE_enum.htm">DXSFCREATE enumeration</A>
</BLOCKQUOTE>




<H1><A NAME="LoadImage">IDXSurfaceFactory::LoadImage</A><HR size=1></H1>
<p>Binds the specified file name or URL and returns a <B>DXSurface</B> containing the image data. <B>Note: Internet Explorer 4.x or later must be installed for this method to work.</B>

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT LoadImage(
   const LPWSTR pszFileName,
   IUnknown *pDirectDraw,
   const DDSURFACEDESC *pDDSurfaceDesc,
   const GUID *pFormatID,
   REFIID riid, 
   void **ppDXSurface
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>pszFileName</I> 
 </DT><DD>[in] File name or URL to bind.
</DD>
<DT><I>pDirectDraw</I> 
 </DT><DD>[in] Optional pointer to the DirectDraw object to use. If NULL, the DirectDraw object from the transform manager's service provider will be used.

 
</DD>
<DT><I>pDDSurfaceDesc</I> 
 </DT><DD>[in] Pointer to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_ddsurfacedesc')">DDSURFACEDESC</A> structure that describes the underlying <B>DirectDrawSurface</B>.
</DD>
<DT><I>pFormatID</I> 


 </DT><DD>[in] Overriding pixel format.If NULL, the format is determined by the source data loader.
</DD>
<DT><I>riid</I> 
 </DT><DD>[in] Interface to return from the newly created surface.
</DD>
<DT><I>ppDXSurface</I> 
 </DT><DD>[out] Address of a pointer to the newly created interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The <i>pDDSurfaceDesc</i> is not required. If it is NULL, the surface is created as a system memory <B>DirectDrawSurface</B>, with the height and width specified by the <I>pBounds</I> parameter, and optionally, the format specified by the <i>pFormatId</i> parameter. If a <i>pDDSurfaceDesc</i> is provided, it does not need to be a complete <B>DirectDrawSurface</B> description. The caller


should set the flags for the fields that are valid in the DDSURFACEDESC structure


that need to be overridden, and the caller can allow others


to be set by the <b>CreateSurface</b> call.

<P>The following table describes the flags and their interaction with other parameters.


<p>
    <table>
      <tr>
        <td>Flag(s)</td>
        <td>Not set in <I>dwFlags</I></td>
        <td>Set in <I>dwFlags</I></td>
      </tr>
      <tr>
        <td>DDSD_CAPS</td>
        <td>Surface is created in system memory.</td>
        <td>The Caps specified in the surface description will be used.</td>


      </tr>
      <tr>
        <td>DDSD_PIXELFORMAT</td>
        <td>If <i>pFormatId</i> is NULL, the surface is created with the DirectDraw
        object's default pixel format.&nbsp; If <i>pFormatId</i> is specified, the surface is
        created with that format.</td>
        <td>Surface is created with the pixel format specified in the surface
        description.&nbsp; IMPORTANT:&nbsp; If <I>pFormatId</I> is specified but does not match the format in
        the surface description, the <B>DXSurface</B> creates the surface by using the surface description's pixel
        format, but treats the surface as though it has the format specified by <i>pFormatId</i>.&nbsp;</td> 
      </tr>
      <tr>
        <td>DDSD_HEIGHT | DDSD_WIDTH</td>
        <td><I>pBounds</I> is required.&nbsp; Surface is created with height and width
        specified by <I>pBounds</I>.</td>
        <td><I>pBounds</I> can be NULL.&nbsp; If <i>pBounds</i> is not NULL, the heights and
        widths of the surface description and the bounds structure must match.</td>
      </tr>
    </table>


<p>
If the values for the <i>dwHeight</i> and <i>dwWidth</i> members of the DDSURFACEDESC structure are smaller than the actual height and width of the image being loaded, the load fails and returns a DXTERR_INVALID_BOUNDS error message. In general, height and width should not be specified; the method determines them.

</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="IDXSurfaceFactory.htm#LoadImageFromStream">IDXSurfaceFactory::LoadImageFromStream</A>
</BLOCKQUOTE>

<H1><A NAME="LoadImageFromStream">IDXSurfaceFactory::LoadImageFromStream</A><HR size=1></H1>
<p>Loads an image from a specified stream and returns a <B>DXSurface</B>.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT LoadImageFromStream(
    IStream *pStream,
    IUnknown *pDirectDraw,
    const DDSURFACEDESC *pDDSurfaceDesc,
    const GUID *pFormatID,
    REFIID riid, 
    void **ppDXSurface
);
</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pStream</I>


 </DT><DD>[in] Stream to load the image data from.
</DD>
<DT><I>pDirectDraw</I> 
 </DT><DD>[in] Pointer to the DirectDraw object to use.
</DD>
<DT><I>pDDSurfaceDesc</I> 
 </DT><DD>[in] Pointer to the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_ddsurfacedesc')">DDSURFACEDESC</A> structure that describes the underlying <B>DirectDrawSurface</B>.
</DD>

<DT><I>pFormatID</I> 


 </DT><DD>[in] Overriding pixel format. If NULL, the format is determined by the source data loader.
</DD>
<DT><I>riid</I> 
 </DT><DD>[in] Interface to return from the newly created surface.
</DD>
<DT><I>ppDXSurface</I> 
 </DT><DD>[out] Address of a pointer to the newly created interface.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns an <A HREF="../errorandsuccess.htm">HRESULT</A> value that depends on the implementation of the interface. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>
All parameters except <i>pStream</i> are identical to the parameters of the <a href="idxsurfacefactory.htm#loadimage">IDXSurfaceFactory::LoadImage</a> method.
<P>For more information about using the <b>IStream</b> interface, consult a Component Object Model (COM) reference.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="IDXSurfaceFactory.htm#LoadImage">IDXSurfaceFactory::LoadImage</A>
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A CLASS="line" HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A CLASS="line" HREF="../../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>
<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>
