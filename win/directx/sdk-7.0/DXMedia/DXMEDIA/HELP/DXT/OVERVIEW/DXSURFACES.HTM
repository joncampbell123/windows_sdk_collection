<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Understanding DXSurfaces</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="Understanding DXSurfaces">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->


<SCRIPT LANGUAGE="JAVASCRIPT">

//<!--

var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";

// -->


</SCRIPT>

<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>





<SCRIPT DEFER SRC="../common.js"></SCRIPT>

<SCRIPT DEFER>

//<!--

function InitPage()

{

	if (g_isIE && g_iMaj >= 4)	

	{



		SetTOC();

	}

}

//-->


</SCRIPT>



<!-- STYLE_START -->


<SCRIPT LANGUAGE="JAVASCRIPT">

//<!--

   var sVR = '../'	// Set root for the style sheet

   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;



   if(g_isIE)

   {

	   if (g_iMaj >= 4) // For MSIE 4.0 or later

	   {

		   sCSS += 'dxm_basicSDKIE4';

		   if (g_sPlat == "Win") // Windows only for now

		   {

			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');

		   }

	   }

	   else // For MSIE 3.0 or earlier

	   {

		   sCSS += 'dxm_basicSDKIE3';

	   }

   }

   else if (g_isNav) // For all Nav versions

   {

	   sCSS += 'dxm_basicSDKNAV';

   }

   else

   {

	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet

   }



   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');



   document.write(sCSS);

//-->


</SCRIPT>

<!-- STYLE_END -->




</HEAD>

<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="understanding_dxsurfaces"></A>



<!-- HEADGRAPH_START -->



<!-- TOOLBAR_START -->

<!-- TOOLBAR_END -->


<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectX Transform Animated Header -- Microsoft DirectX Transform SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../default.htm">Topic Contents</A>
</PRE></TD></TR>

<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="dxt_objects.htm">Architecture</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="writingtransforms.htm">Writing Transforms</A>
</PRE></TD></TR></TABLE>

<!-- NAV_LINKS_END -->



<BLOCKQUOTE class="body">

<!-- CONTENTS_START -->


<H1>Understanding DXSurfaces</H1>

<P>A Microsoft&reg; DirectX&reg; surface object, <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_dxsurface')">DXSurface</A>, is an abstract image whose pixel data is obtainable in 32-bit ARGB color format, regardless of the underlying pixel representation. Microsoft DirectX Transform uses this data object for both input and output images. <b>DXSurfaces</b> enable you to concentrate on the logical aspects of designing the transform, while letting the supporting software take care of numerous details, such as <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#gloss_alphablending')">alpha blending</a>, <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_dithering')">dithering</a>, and converting between different <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_pixelformat')">pixel formats</a>.
<p>
The most common ways to construct <b>DXSurfaces</b> are by creating them from image files or by initializing them from <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_ddsurf')">DirectDrawSurfaces</a>. A <b>DXSurface</b> can also be a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_proceduralsurface')">procedural surface</a>, where the sample values are calculated on demand, rather than being stored statically in an array. Because you can represent compressed images as <b>DXSurfaces</b>, they introduce new image compression techniques into the architecture.

<P>This article contains the following sections.
	<ul>
		<li><A HREF="#dxsurfacefeatures">Features of DXSurfaces</a></LI>
		<li><A HREF="#uses_for_dxsurfaces">Why Use DXSurfaces?</a></LI>
		<li><A HREF="#dxsurface_ref">Using DXSurfaces: A Quick Reference</a></LI>
	</ul>

<h2><a name="dxsurfacefeatures">Features of DXSurfaces</a></h2>

<dl>
	<dt><b>Per-Pixel Alpha</b>
	</dt>
<dd>
Most common image formats store only RGB color information for each pixel. When an image also stores an <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#gloss_alpha_channel')">alpha</A> value for each pixel, you can do much more sophisticated graphics operations, such as <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#gloss_compositing')">compositing</A> and image fading. <b>DXSurfaces</b> enable direct access to alpha information for pixel formats that support alpha. If the underlying pixel format of a <b>DXSurface</b> does not support alpha, the code translates the pixels to an alpha-supported format as they are read from the surface. This alpha translation also properly accomodates <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#gloss_colorkey')">color keys</A> and transparency.
</dd>
	<dt><b>Pixel Format Independence</b>
	</dt>
<dd>
When you are using <b>DXSurfaces</b>, you never have to worry about the pixel format of the source or destination images. When the image is read from a <b>DXSurface</b>, you can choose to obtain it in a pixel format of <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#gloss_argb32')">ARGB32</A> or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_pmargb32')">PMARGB32</A>. If the pixel format of the source is the same, the pixel values are copied directly from memory. If the formats are different, the software automatically translates the pixels as they are read from the source format to the destination using highly optimized code. 

</dd>
	<dt><b>Image Loading</b><br>
	</dt>
<dd>
DirectX Transform uses the image loading routines of Microsoft Internet Explorer to load images into memory. This means that all of the most common image formats can be loaded directly into <b>DXSurfaces</b>. This includes formats such as the following.
<ul>
	<li>Bitmap (.bmp)
	<li>Graphics Interchange Format (.gif)
	<li>Joint Photographic Experts Group (.jpg)
	<li>Portable Network Graphics (.png)
	<li>Microsoft DirectDraw&reg; surface objects
</ul>

</dd>

	<dt><b>Procedural Surfaces</b><br>
	</dt>
<dd>
With DirectX Transform, you do not need to store <b>DXSurfaces</b> as bitmap images. You can define an image through a procedure used to build an image as its pixels are read. This makes access to the surface read-only, but because you are storing only the algorithm for the procedure and its parameters, an image of arbitrary size requires only a small amount of memory. A gradient image is an example of a simple procedural surface, but more sophisticated algorithms can produce natural-looking marble patterns or futuristic textures. The <A HREF="../reference/effects/Kemikal_squishy.htm">Kemikal</A> surface is an example of a sophisticated procedural surface.

</dd>

	<dt><b>Surface Modifiers</b><br>
	</dt>
<dd>
The samples of a <b>DXSurface</b> can be accessed directly or through a <A HREF="../reference/Ifaces/idxsurfacemodifier.htm">DXSurfaceModifier</A> object (Surface Modifier). Surface Modifiers are themselves <b>DXSurfaces</b> and provide another layer of image processing that enables you to set the global image opacity or to process an image through a lookup table. You can also use the Surface Modifier to tile an input image onto a larger surface or to place your input image onto a colored background. 
</dd>
</dl>

<H2><A NAME="advantage_dxsurf">Advantages of Using DXSurfaces</A></H2>

<p>In addition to the advantages of supporting per-pixel alpha, procedural surfaces, and any pixel format and depth, <b>DXSurfaces</b>


are the recommended surface for DirectX Transform operations for a number of other reasons.

<p>As previously mentioned, <b>DXSurfaces</b> need to be wrapped on <B>DirectDrawSurfaces</B> before they're passed as parameters to DirectX Transform objects. This occurs so that a standard surface is always passed to a transform.

This means that supplying <b>DXSurfaces</b> directly to DirectX Transform objects will be slightly more efficient than supplying other types of surfaces because the aggregation step is not necessary. Furthermore, if the <b>DXSurface</b> is already in one of two standard pixel formats (<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#gloss_argb32')">ARGB32</A> or <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_pmargb32')">PMARGB32</A>), read and read/write pointers can be obtained to directly access the surface's <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#gloss_sample')">samples</A>, saving a copy to a buffer.

<p><b>DXSurfaces</b> also provide additional functionality beyond that of <B>DirectDrawSurfaces</B> 
by supporting transforms on surfaces containing an <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#gloss_alpha_channel')">alpha channel</A> or a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_C.htm#gloss_colorkey')">color key</A>.


<h2><a name="uses_for_dxsurfaces">Why Use DXSurfaces?</a></h2>

<P>You can use <b>DXSurfaces</b> as transform inputs or outputs. However, the power of <b>DXSurfaces</b> and their supporting tools can be used in any Microsoft Windows&reg; graphics application that you create. In many ways, <b>DXSurfaces</b> are easier to use than <B>DirectDrawSurfaces</B> because they always have a known pixel format to use for image manipulation. <b>DXSurfaces</b> enable all the standard, pixel-level access of images, while also exposing generic graphics tools, such as lookup tables and image filters.

<h2><a name="dxsurface_ref">Using DXSurfaces: A Quick Reference</a></h2>

<P><b>DXSurface</b> objects are created with the <a href="../reference/ifaces/idxsurfacefactory.htm">IDXSurfaceFactory</a> interface. This interface exists as a service of the <a href="../reference/ifaces/idxtransformfactory.htm">IDXTransformFactory</a> interface, which must be created with the Component Object Model (COM) method <b>CoCreateInstance</b>.
Transform users often create the <B>DXTransformFactory</B> (Transform Factory) and use it to obtain a pointer to the <B>DXSurfaceFactory</B> (Surface Factory) and any transform interfaces they need. <b>DXSurface</b> users only need the Surface Factory pointer, which can be obtained by using the following statement.

<BLOCKQUOTE>
<PRE>
hr = CoCreateInstance( CLSID_DXTransformFactory, NULL,
CLSCTX_INPROC, IID_IDXSurfaceFactory, (void **)&amp;g_pSurfFact );
</PRE>
</BLOCKQUOTE>
<P>Multiple <b>DXSurfaces</b> can be created with the <a href="../reference/ifaces/idxsurfacefactory.htm#CreateSurface">IDXSurfaceFactory::CreateSurface</a> method. You can also create <b>DXSurfaces</b> from image files by using the <a href="../reference/ifaces/idxsurfacefactory.htm#LoadImage">IDXSurfaceFactory::LoadImage</a> method, as shown in the following:

<BLOCKQUOTE>
<PRE>
hr = g_pSurfFact-&gt;LoadImage( pwcsFileName, NULL, NULL,
&amp;DDPF_PMARGB32, IID_IDXSurface, (void**)g_pSurf );
</PRE>
</BLOCKQUOTE>
<P>You can use the <a href="../reference/ifaces/idxargbreadptr.htm">IDXARGBReadPtr</a> and <a href="../reference/ifaces/idxargbreadwriteptr.htm">IDXARGBReadWritePtr</a> interfaces to read or to modify the samples of the surfaces. The <a href="../reference/helpers/helper_intro.htm">helper functions</a> contain routines to combine arrays of samples and to allocate working buffers. 


<!-- CONTENTS_END -->


<!-- START_PAGE_FOOTER -->




<H5><HR size=1></H5>

<P><A CLASS="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>

<BR><A CLASS="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>

<!-- END_PAGE_FOOTER -->


</BLOCKQUOTE>




<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>

