<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Architecture</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="Architecture">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->


<SCRIPT LANGUAGE="JAVASCRIPT">

//<!--

var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";

// -->


</SCRIPT>

<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>





<SCRIPT DEFER SRC="../common.js"></SCRIPT>

<SCRIPT DEFER>

//<!--

function InitPage()

{

	if (g_isIE && g_iMaj >= 4)	

	{



		SetTOC();

	}

}

//-->


</SCRIPT>



<!-- STYLE_START -->


<SCRIPT LANGUAGE="JAVASCRIPT">

//<!--

   var sVR = '../'	// Set root for the style sheet

   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;



   if(g_isIE)

   {

	   if (g_iMaj >= 4) // For MSIE 4.0 or later

	   {

		   sCSS += 'dxm_basicSDKIE4';

		   if (g_sPlat == "Win") // Windows only for now

		   {

			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');

		   }

	   }

	   else // For MSIE 3.0 or earlier

	   {

		   sCSS += 'dxm_basicSDKIE3';

	   }

   }

   else if (g_isNav) // For all Nav versions

   {

	   sCSS += 'dxm_basicSDKNAV';

   }

   else

   {

	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet

   }



   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');



   document.write(sCSS);

//-->


</SCRIPT>

<!-- STYLE_END -->




</HEAD>

<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="object_relations"></A>



<!-- HEADGRAPH_START -->



<!-- TOOLBAR_START -->

<!-- TOOLBAR_END -->


<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectX Transform Animated Header -- Microsoft DirectX Transform SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../default.htm">Topic Contents</A>
</PRE></TD></TR>

<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="howtheywork.htm">How Transforms Work</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="dxsurfaces.htm">Understanding DXSurfaces</A>
</PRE></TD></TR></TABLE>

<!-- NAV_LINKS_END -->

<BLOCKQUOTE class="body">

<!-- CONTENTS_START -->


<H1>Architecture</H1>

<P>In order to properly use Microsoft&reg; DirectX&reg; Transform objects and interfaces, it is important to know what they are and how they all relate to one another.

<P>This article contains the following sections.
<ul>
<li><a href="#object_hierarchy">Object Hierarchy</a>
<li><a href="#objects_lookuptables">Lookup Tables</a>
<li><a href="#surface_modifiers">Surface Modifiers</a>
</ul>

<h2><a name="object_hierarchy">Object Hierarchy</a></h2>

<p>The following illustration depicts some of the important Component Object Model (COM) objects used in DirectX Transform. Each box represents a COM object with interfaces, and the arrow pointing to each box indicates the method used to create it.
<center>
<img width=611 height=256 src="../art/dxt_objects.gif" alt="DXTransform Objects">
</center>
<br clear=right>

<P>All operations start when you create a <a href="../reference/ifaces/idxtransformfactory.htm">DXTransformFactory</a> object (Transform Factory). This is done with a standard COM method, <b>CoCreateInstance</b>, which returns an <B>IDXTransformFactory</B> interface pointer you can use to access the object. You can use this interface to create instances of transforms and then use them in your code. The method that does is <a href="../reference/ifaces/idxtransformfactory.htm#CreateTransform">IDXTransformFactory::CreateTransform</a>, which returns an <a href="../reference/ifaces/idxtransform.htm">IDXTransform</a> interface pointer to your requested object.
<p>
After you have created a transform, you will need to prepare it to produce output. Most transforms have a number of custom properties that you can adjust to affect the output. These properties are listed for each transform in the <a href="../reference/effects/effects.htm">Transform Reference</a>, with explanations of how these properties control the output. Transforms that can produce animated transitions from static input images will support the <a href="../reference/ifaces/idxeffect.htm">IDXEffect</a> interface. This interface includes methods to control the <i>Progress</i> of the animation and to store the suggested <i>Duration</i> of the effect. This object is created by calling the COM <b>QueryInterface</b> method on the transform object and requesting a pointer to the <B>IDXEffect</B> interface.

<p>
The Transform Factory that was previously mentioned is also a service provider for a <A HREF="../reference/Ifaces/idxsurfacefactory.htm">DXSurfaceFactory</A> object (Surface Factory). This object is responsible for creating the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_D.htm#gloss_dxsurface')">DXSurfaces</a> used for transform inputs and output. To obtain pointer to a Surface Factory, you need to call the COM <b>QueryService</b> method, requesting a pointer to the <B>IDXSurfaceFactory</B> interface. With this interface, you can create empty <b>DXSurfaces</b> by calling the <a href="../reference/ifaces/idxsurfacefactory.htm#CreateSurface">IDXSurfaceFactory::CreateSurface</a> method. You can create a <b>DXSurface</b> and load an image into it at the same time with the 
<a href="../reference/ifaces/idxsurfacefactory.htm#LoadImage">IDXSurfaceFactory::LoadImage</a> method.

<p>
People who use transforms will use <B>DXSurface</B> pointers to set up their transform. People who use <B>DXSurfaces</B> to create transforms or for image applications also will need to access the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_S.htm#gloss_sample')">samples</a> of each surface. There are two kinds of access to <b>DXSurfaces</b>, both of which are obtained through the <a href="../reference/ifaces/idxsurface.htm#LockSurface">IDXSurface::LockSurface</a> method. If you are only reading samples of a <b>DXSurface</b>, you call this method, requesting a pointer to the <a href="../reference/ifaces/idxARGBReadPtr.htm">IDXARGBReadPtr</a> interface. If you are writing samples to an output <b>DXSurface</b>, you instead request a pointer to an <a href="../reference/ifaces/idxARGBReadWritePtr.htm">IDXARGBReadWritePtr</a> interface.


<h2><a name="objects_lookuptables">Lookup Tables</a></h2>

<P>There are DirectX Transform interfaces that do lookup table corrections for images. These corrections can change the brightness, contrast, color balance, or opacity of the entire image. Lookup tables also can do more sophisticated image manipulation, such as gamma correction, threshold filtering, and color inversion. For a given lookup table, you have the ability to specify any number of the operations to be performed in any order.

<p>
To use a lookup table for your image, you must first use the COM <b>CoCreateInstance</b> method, requesting a pointer to an <a href="../reference/ifaces/idxlutbuilder.htm">IDXLUTBuilder</a> (Lookup Table Builder) interface. This interface contains methods that you can use to define the lookup table operations and their order. When you are finished, you call the <b>QueryInterface</b> method on the <B>IDXLUTBuilder</B>, requesting a pointer to an <a href="../reference/ifaces/idxlookuptable.htm">IDXLookupTable</a> interface. From there, you can either use the lookup table directly on image samples, or you can associate it with a <B>DXSurfaceModifier</B> object (Surface Modifier) by using the <a href="../reference/ifaces/idxsurfacemodifier.htm#SetLookup">IDXSurfaceModifier::SetLookup</a> method.



<h2><a name="surface_modifiers">Surface Modifiers</a></h2>
<P>One of the special objects


of DirectX Transform is the Surface Modifier. It enables you change such things as the brightness or opacity of a foreground image and place the result over a background image. You can save many steps in combining and adjusting images by using a Surface Modifier, and it also enables you to place images over tiled backgrounds.
<p>
The Surface Modifier object is created by calling the COM <b>CoCreateInstance</b> method, requesting a pointer to an <a href="../reference/ifaces/idxsurfacemodifier.htm">IDXSurfaceModifier</a> interface. 
The relations among the Surface Modifier and other DirectX Transform objects are shown in the following illustration.
<center>
<img width=479 height=225 src="../art/surf_modifier.gif" alt="Surface Modifier Diagram">
</center>
<br clear=right>

<P>A Surface Modifier can have a foreground <b>DXSurface</b> associated with it. This association is made with the <a href="../reference/ifaces/idxsurfacemodifier.htm#SetForeground">IDXSurfaceModifier::SetForeground</a> method. A background <b>DXSurface</b> can also be set with the <a href="../reference/ifaces/idxsurfacemodifier.htm#SetBackground">IDXSurfaceModifier::SetBackground</a> method. There are parameters in this method that allow the image to be positioned or tiled across the <b>DXSurface</b> output.
<p>
Another object that can be used by a Surface Modifier is a Lookup Table object. A Lookup Table object is created with the <a href="../reference/ifaces/idxlutbuilder.htm">IDXLUTBuilder</a> interface and is assigned to the Surface Modifier through the <a href="../reference/ifaces/idxsurfacemodifier.htm#SetLookup">IDXSurfaceModifier::SetLookup</a> method.

<p>
The Surface Modifier object exposes an <a href="../reference/ifaces/idxsurface.htm">IDXSurface</a> interface, which makes it seem to be a <b>DXSurface</b>. You can use this pointer to read samples from the modified surface, or you can attach it directly to a transform input. In reality, when samples are read through the Surface Modifier's <b>IDXSurface</b> pointer, the Surface Modifier performs all the lookup table operations on the foreground surface, alpha blends the result onto the background surface, and returns the samples to the calling routine.


<!-- CONTENTS_END -->


<!-- START_PAGE_FOOTER -->




<H5><HR size=1></H5>

<P><A CLASS="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>

<BR><A CLASS="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>

<!-- END_PAGE_FOOTER -->


</BLOCKQUOTE>




<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>

