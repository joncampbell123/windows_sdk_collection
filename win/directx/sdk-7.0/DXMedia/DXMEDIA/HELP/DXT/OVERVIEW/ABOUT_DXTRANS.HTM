<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>About Transforms and DXSurfaces</TITLE>
<SCRIPT LANGUAGE="JavaScript"> var sRelPath = '../' </SCRIPT>

<META NAME="Description" CONTENT="About Transforms and DXSurfaces">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>



<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->

</HEAD>

<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="about_dxtrans"></A>
<!-- TOOLBAR_START -->

<!-- TOOLBAR_END -->


<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectX Transform Animated Header -- Microsoft DirectX Transform SDK"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="../art/hdrdtrns.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Microsoft DirectX Transform SDK"></TD>
<TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="DirectX Transform Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectX Transform SDK">
</TD>
</TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="writingtransforms.htm">Topic Contents</A>
</PRE></TD></TR>

<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="writingtransforms.htm">Writing Transforms</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="DXTauthorguide.htm">Author's Guide to Transforms</A>
</PRE></TD></TR></TABLE>



<BLOCKQUOTE class="body">

<!-- CONTENTS_START -->


<H1>About Transforms and DXSurfaces</H1>

<P>Microsoft&reg; DirectX&reg; Transform objects apply space and time effects to Microsoft DirectDraw&reg; and Direct3D&reg; objects. DirectX Transform objects read data from a source, modify it, and write it to a destination object. In certain cases the source and destination data objects can be the same if the transform is capable of executing in place. DirectX Transform exposes a number of Component Object Model (COM) interfaces and data types that enable you to create your own unique effects and plug them into the existing architecture.


<H2><A NAME="dxtrans_and_dxsurf">Applying Transforms To DXSurfaces</A></H2>

<p>The most common use of a transform interface is to apply an effect to a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_d.htm#gloss_dxsurface')">DXSurface</A> object that contains a bitmap image. Transforms can include transitions, convolutions, warps, spatial transforms, and color lookup table operations, such as brightening, contrasting, and gamma correcting. Transforms are created and initialized by using the <A HREF="../reference/Ifaces/idxtransformfactory.htm#CreateTransform">IDXTransformFactory::CreateTransform</A> method and are executed with the <A HREF="../reference/Ifaces/idxtransform.htm#Execute">IDXTransform::Execute</A> method.

<p><B>DXSurface</B> objects are the core image data objects for transforms. <B>DXSurfaces</B> wrap <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_d.htm#gloss_ddsurf')">DirectDrawSurfaces</a> through aggregation and provide additional functionality, such as color lookup and seamless conversion among different <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_pixelformat')">pixel formats</A>. <B>DXSurfaces</B> can also be <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_proceduralsurface')">procedural surfaces</A> that dynamically calculate the necessary pixel values when the surface is accessed instead of simply being an array of discrete values like a <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_d.htm#gloss_ddsurf')">DirectDrawSurface</A> object. Any surface that is not a <B>DXSurface</B>, such as a <B>DirectDrawSurface</B>, that is passed to a transform is wrapped  into a <B>DXSurface</B> when the <A HREF="../reference/Ifaces/idxtransform.htm#Setup">Setup</a> method is called.
 This provides a standard object for all transforms to interface with and a consistent model for reading and writing pixels. 

<p>All transforms on <B>DXSurfaces</B> must support data access through either the
<A HREF="../reference/Ifaces/idxargbreadptr.htm">IDXARGBReadPtr</a> or <A HREF="../reference/Ifaces/idxargbreadwriteptr.htm">IDXARGBReadWritePtr</a> interface, or both. These interfaces provide simplified access to the underlying samples in both of the following two pixel formats:
<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#gloss_argb32')">ARGB32</A> or alpha-premultiplied
<A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_P.htm#gloss_pmargb32')">PMARGB32</A>.
Transforms gain access to these interfaces through the <A HREF="../reference/Ifaces/idxsurface.htm#locksurface">IDXSurface::LockSurface</a> method and use them to call the <A HREF="../reference/Ifaces/idxargbreadptr.htm#unpack">IDXARGBReadPtr::UnPack</a> or <A HREF="../reference/Ifaces/idxargbreadwriteptr.htm#packandmove">IDXARGBReadWritePtr::PackAndMove</a> methods, which read and write the surface's pixels. Conversion to a common pixel format from an input surface and into an output surface simplifies the transform by making it pixel-format independent; therefore, the transform is spared the details of converting between the numerous pixel formats that are commonly used. It also allows the format of the source and the destination to differ without writing special-case transform code. If a transform recognizes both the input and output native data formats, it can go directly to the data, avoiding any intermediate conversion of the pixels. However, the pixel abstraction APIs provided are highly efficient, so writing special-case native pixel routines should be unnecessary.

<p>Transforms describe regions of an image or mesh with the <A HREF="../reference/structs/DXBNDS_struct.htm">DXBNDS</a> union structure. This structure describes an (x, y, z, t) volume in 64-bit, 32-bit, continuous, and discrete values, depending on the specific structure type. The <A HREF="../reference/CDXBnds/CDXBnds_intro.htm">CDXBnds</A> template helper class can take bounds of any type and appropriately convert where necessary. Transforms should always work using bounds in their native coordinate type. 

<p>The following diagram details the process of using the <A HREF="../reference/Ifaces/idxtransform.htm#Execute">IDXTransform::Execute</A> method. This diagram assumes the transform has been created and set up correctly prior to the execution of the transform. For details on initialization and set up, see the <A HREF="users_implement.htm">Using Transforms in C++</A> section.

<p><IMG SRC="../art/exetrans.gif" WIDTH="535" HEIGHT="280" BORDER=0 ALT="IDXTransform::Execute">

<p>The previous diagram illustrates the following steps that occur when the <B>IDXTransform::Execute</B> method is used.

<OL>
<LI>Surfaces are associated with specific DirectX Transform objects in the <A HREF="../reference/Ifaces/idxtransform.htm#Setup">IDXTransform::Setup</A> method before the call to <B>IDXTransform::Execute</B>. The transform obtains the <B>IDXSurface</B> interface from the input <B>DXSurface</B>(s) associated with it at this time.

<LI>The transform uses <A HREF="../reference/Ifaces/idxsurface.htm#LockSurface">IDXSurface::LockSurface</A> with the DXLOCKF_READ flag set to create a read pointer object and return an <A HREF="../reference/Ifaces/idxargbreadptr.htm">IDXARGBReadPtr</A> interface. This object can be used to access the <B>DXSurface</B>'s samples.

<LI>The <A HREF="../reference/Ifaces/idxargbreadptr.htm#Unpack">IDXARGBReadPtr::Unpack</A> method is used to read the pixel samples and convert them into an ARGB32 pixel format. You can optionally use the <A HREF="../reference/Ifaces/idxargbreadptr.htm#UnpackPremult">IDXARGBReadPtr::UnpackPremult</A> method to convert samples to the alpha-premultiplied PMARGB32 format.

<LI>The transform performs operations on the samples.
<LI>The transform obtains the <B>IDXSurface</B> interface from the output <B>DXSurface</B> associated with it.

<LI>The transform uses <B>IDXSurface::LockSurface</B> with the DXLOCKF_READWRITE flag set to create a read/write pointer object and to return an <A HREF="../reference/Ifaces/idxargbreadwriteptr.htm">IDXARGBReadWritePtr</A> interface. This object can be used to access the <B>DXSurface</B>'s pixel samples.

<LI>The <A HREF="../reference/Ifaces/idxargbreadwriteptr.htm#Packandmove">IDXARGBReadWritePtr::PackAndMove</A> method is used to convert ARGB32 samples into the underlying native pixel format and to write them to the output DXSurface. You can optionally use the <A HREF="../reference/Ifaces/idxargbreadwriteptr.htm#PackPremultAndMove">IDXARGBReadWritePtr::PackPremultAndMove</A> method to convert the PMARGB32 samples into the underlying pixel format and to write the samples to the output <B>DXSurface</B>.
</OL>

<P>The previous diagram focuses on transforms for <B>DXSurfaces</B>. However, you can also create DirectX Transform objects to apply unique effects to Direct3D objects. In this case, the transform operates directly on the meshes of <B>Direct3DRMMeshBuilder3</B> objects.

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H6><HR size=1></H6>
<P><A CLASS="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A CLASS="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<!-- START POP-UP GLOSSARY -->

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>
<!-- END POP-UP GLOSSARY -->


<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY></HTML>


