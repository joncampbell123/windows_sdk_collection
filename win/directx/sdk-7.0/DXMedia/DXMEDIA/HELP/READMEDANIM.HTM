<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<title>DirectAnimation Readme</title>
<!--TOOLBAR_START-->
<!--TOOLBAR_END-->
</head>

<body>

<p>
<object id="DAControl" classid="CLSID:69AD90EF-1C20-11d1-8801-00C04FC29D46"
align="baseline" border="0" width="192" height="192"
style="position:relative; left:50; top:0;width:700;height:400">
</object>
</p>

<p align="center"><a name="Top of Page"><font size="5" face="Verdana, Arial, Helvetica"><strong>DirectAnimation Readme</strong></font></a></p>

<p><font color="#006600" size="1" face="MS SANS SERIF"><a
href="cpyright.htm" class="line">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</a> </font><br clear="all"></p>

<p><font size="2" face="Verdana, Arial, Helvetica">This document provides late-breaking or
other information that supplements the Microsoft&reg; DirectAnimation&#153; documentation. </font></p>

<p><a href="#Overview"><font size="2" face="Verdana, Arial, Helvetica">Overview</font></a></p>

<p><a href="#Requirements and Dependencies"><font size="2"
face="Verdana, Arial, Helvetica">Requirements, Dependencies, and Installation</font></a></p>

<p><a href="#Additional Information"><font size="2" face="Verdana, Arial, Helvetica">Additional
Information</font></a></p>

<p><a href="#New in This Release"><font size="2" face="Verdana, Arial, Helvetica">New in
This Release</font></a></p>

<p><a href="#Known Bugs"><font size="2" face="Verdana, Arial, Helvetica">Known Bugs</font></a></p>

<p><a href="#Contact Info"><font size="2" face="Verdana, Arial, Helvetica">Contact
Information</font></a></p>

<hr>

<h3><a name="Overview"><font size="2" face="Verdana, Arial, Helvetica"><strong>Overview</strong></font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">DirectAnimation was first released as
an integrated component of the Internet Explorer 4.<I>x</I> minimal install. This provided
unprecedented animation and multimedia capabilities built into a major Internet browser
(no special download is needed). Furthermore, DirectAnimation allows for integration with
Dynamic HTML (DHTML), and hence is especially suitable for adding compact and lightweight animation
effects to Web pages. DirectAnimation is also distributed with Microsoft Windows&reg; 98 and will be part of Microsoft Windows NT&reg; 5.0. This means that you can also rely on its functionality for your stand-alone applications and content.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">DirectAnimation is the component of the
Microsoft DirectX&reg; family of APIs that provides rich animation and integrated media support for Web pages, CD-ROM titles, applications, and multimedia content and tools. DirectAnimation
provides unified and comprehensive support for the different media types, including: two-dimensional (2-D) vector graphics, three-dimensional (3-D) graphics, sprites, audio, video, and a rich time and event model that applies uniformly across the different media types. DirectAnimation is a Component Object Model (COM) API and an underlying engine/run time whose functionality can be accessed in different ways by different user groups: </font>

<ul>
  <li><font size="2" face="Verdana, Arial, Helvetica">HTML authors can integrate animation using the DirectAnimation controls.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Microsoft Visual Basic&reg; Scripting Edition (VBScript), Microsoft JScript&reg; users, and Java applet writers can program animation for Web pages with integration with DHTML.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">C++, Visual Basic, and Java programmers can develop full applications or Microsoft ActiveX&reg; controls with rich media and interactivity. </font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">The supported media types are as
follows:</font></p>

<blockquote>
  <ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">2-D images (.bmp, .gif, .png, .jpeg files)</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">3-D models (.x files) </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Sounds (.wav and .midi files)</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Movies (.avi, .mpeg, and .mov files)</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Text</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Vector graphics</font></li>
  </ul>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">For images, additional file types can
be supported through the Internet Explorer 4.<I>x</I> Pluggable Image Decoder. In the case of
movies and sounds, additional media formats can be supported by supplying Microsoft DirectShow&#153;
codecs for those formats.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">One of the key DirectAnimation classes
is the <B>Behavior</B> class. Different types of media are incorporated into the animation by
encapsulating them as DirectAnimation <B>Behavior</B> objects. <B>Behavior</B> objects can be used
interchangeably, and have a number of methods applied to them, independent of the media
type they are encapsulating. Of course, you can still access methods that are specific to
the different types of behaviors, based on the type of media.</font></p>

<p><a href="#Top of Page"><font size="2" face="Verdana, Arial, Helvetica"><strong>Back to
the top</strong></font></a></p>

<h3><a name="Requirements and Dependencies"><font size="2"
face="Verdana, Arial, Helvetica"><strong>Requirements, Dependencies, and Installation</strong></font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The <strong>minimum</strong>
requirements to run DirectAnimation applications and content are as follows:</font>

<ul>
  <li><font size="2" face="Verdana, Arial, Helvetica">A 90-megahertz (MHz) Pentium-class computer with 16 megabytes (MB) of memory</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Windows 95 or Windows NT 4.0</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">DirectX 3.0a, <u>including Microsoft Direct3D&reg;</u> (for Windows NT 4.0 users, Service Pack 3 is required)</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">The DirectAnimation run time comes as
part of the <a href="http://www.microsoft.com/ie/ie40/">Internet Explorer 4.<I>x</I> minimal install</a>, as well as with Windows 98. DirectAnimation will also be part of future releases of Windows NT.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Note that to use some of the new DirectAnimation functions, you must have Microsoft&reg; DirectX&reg; 6.x or later installed. These include <B>DAGeometry</B>'s <B>AmbientColor</B>, <B>LightRangeAnim</B>, <B>LightRange</B>, and <b>Opacity</b>, and <B>DAStatics</B>'s <B>ImportDirect3DRMVisual</B>, <B>ImportDirect3DRMVisualWrapped</B>, <B>ImportGeometryWrapped</B>, and <B>ImportGeometryWrappedAsync</B>. You will not get an error if you use these functions without DirectX 6.x. They will simply have no effect.
<p>You must have DirectX 5.x or later installed to use DAGeometry's <B>Shadow</B>, <B>Lighting</B>, and <B>ModelClip</B> functions. You will not get an error if you use these functions without DirectX 5.x or DirectX 6.x. They will simply have no effect.

<p>You must have DirectX 6.x or later to use 3-D DirectX Transform objects with <B>ApplyDXTransform</B> or <B>ApplyDXTransformEx</B>, or to use the functions in <B>DADXTransformResult</B> with 3-D transforms. Instantiation of the DirectX Transform COM object will fail if you attempt to use 3-D transforms without DirectX 6.x or later.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">To use some 2-D DirectX Transform effects, you must have optional DLLs installed. You can install these by choosing &quot;Optional DirectX Transforms&quot; when you install the DirectX Media SDK. See &quot;Using DirectX Transform Effects&quot; in the <I>Programmer's Guide</I> for a complete list of DirectX Transform effects and what additional software, if any, is required to use each. The additional DLLs are Dxtcr.dll, Dxtlipi.dll, Dxtmeta.dll, and Dxtmeta2.dll. Instantiation of the DirectX Transform COM object will fail if you attempt to use these transforms without the DLLs installed.</font></p>


<p><a href="#Top of Page"><font size="2" face="Verdana, Arial, Helvetica"><strong>Back to
the top</strong></font></a></p>

<h3><a name="Additional Information"><font size="2" face="Verdana, Arial, Helvetica"><strong>Additional
Information</strong></font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">DirectAnimation supports both JScript and VBScript, as well as the integration of the multimedia controls (in Internet Explorer 4.<I>x</I>) with the DirectAnimation run time. In addition to the
multimedia controls, a windowed control is provided that can be used, not only with Internet Explorer 4.<I>x</I> but also with Internet Explorer 3.02 and Visual Basic 5.0. With the addition of the multimedia controls, content developers can now access DirectAnimation functionality through
different levels, from PARAM tags at the control level, to scripting, to raw COM.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The DirectAnimation Java classes depend on the version of the Java VM that ships with the Microsoft SDK for Java 2.0 and
Internet Explorer 4.<I>x</I>. We used Microsoft Visual J++&#153; 1.1 to author the Java samples.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">To use DirectAnimation
Java-based content within Netscape Navigator, follow these instructions:</font></p>

<blockquote>
  <p><font size="2" face="Verdana, Arial, Helvetica">Microsoft has made a plug-in available
  to users of Netscape Navigator 2.02 and 3.0 that enables them to use the Microsoft
  Java VM. Netscape Communicator is not yet supported because of changes made to the plug-in
  interface. Note that this plug-in does not replace the Netscape Java VM, but it does
  provide access to the Microsoft Java VM through the use of the EMBED tag. To get an applet up and running under Netscape, follow these simple steps:</font></p>
</blockquote>

<blockquote>
  <ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">Get the plug-in from the SDK for Java 2.0 and place it in your Navigator\Program\Plugins directory. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Install the required Microsoft Java VM, if you haven't already. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Change the APPLET tag in your source
      HTML from this: </font></li>
  </ol>
  <blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">&lt;APPLET
    CODE=&quot;myjava.class&quot; WIDTH=100 HEIGHT=100&gt;&lt;/APPLET&gt;</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">To this: </font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">&lt;EMBED SRC=&quot;myjava.class&quot;
    WIDTH=100 HEIGHT=100&gt;&lt;/EMBED&gt;</font></p>
  </blockquote>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">In general, it is recommended that you
upgrade to the DirectX 6 set of video drivers. Several visual artifacts that appear under
older versions of video drivers disappear with the newer set.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Some C++-based samples have been added to
the SDK. Some samples rely on the DirectAnimation control, while others composite directly to a Microsoft DirectDraw&reg; surface.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">When possible, it is recommended that you take
advantage of the asynchronous import methods. This leads to more responsive content, because the end user does not have to wait for all the content to load before experiencing the
animation.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The maximum rate that you can set on a sound depends on the sound source. When synthesizing sounds with SinSynth, the rate is limited only by the maximum frequency of 11025 Hz. Static sounds (sounds stored in memory) that are less than 200 KB in size, uncompressed, have a maximum rate limited only by the DirectSound sample rate comverter, which is approximately the number of clock samples per 1/4 note. This is an optimization for small sounds kept in memory. Streaming sounds have an arbitrary clamp on the maximum rate to avoid swamping the renderer, since the size of the sound data is unknown. Speeding up the rate makes the renderer go faster which can cause garbage sound if the rate is too high. Note that audio data size is not the same as file size, since an audio file can contain compressed audio data that is much larger than the file size, while a video file can contain audio data that is much smaller than the file size.   </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In previous versions of DirectAnimation, each instance of sound in an animation had its own DirectSound buffer. Thus, if you were playing five sounds you had five DirectSound buffers. In the current implementation, all sounds with the same time base share the same DirectSound buffer. Gain in DirectAnimation can only be attenuated. That is, a sound has a default gain of one, and you can decrease the gain (and make the sound softer) but you cannot increase the gain (make the sound louder). In previous implementations, if you had <I>n</I> sounds in an animation had its own DirectSound buffer and each could have a gain of one for a total gain of <I>n</I>. In the current implementation, where all sounds have the same DirectSound buffer, the gain of all sounds together cannot be greater than one. This difference can cause subtle changes in spatialized sound. For example, if you brought two sounds, each with a gain of one, together in the center of an animation, in previous versions the combined sound would have a gain of two, while in the current version, the combined sound would have a gain of one. This difference can also cause some of the DirectAnimation samples to sound subtly different.    </font></p>

<p><a href="#Top of Page"><font size="2" face="Verdana, Arial, Helvetica"><strong>Back to
the top</strong></font></a></p>

<h3><a name="New in This Release"><font size="2" face="Verdana, Arial, Helvetica"><strong>New
in This Release</strong></font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">Importation of VRML 1.0 files has been
dropped from the API. If you need to bring in 3-D geometries, you will need to use DirectX
files.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Note that to take advantage of
any new APIs, you need to use version 2 of the interfaces. Of course, the interface
provided in the previous release still works. For more information about new APIs, see the &quot;What's New in the DirectAnimation SDK?&quot; article in the DirectAnimation documentation.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Some of the new features and
enhancements include the following:</font></p>

<blockquote>
  <p><font size="2" face="Verdana, Arial, Helvetica"><u>Engine</u></font></p>
  <blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">Extensibility - Third parties can
    extend or customize DirectAnimation functionality through Microsoft DirectX Transform effects.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">Time substitution can now be used for
    sequenced behaviors and time can be run backward (except when until or switcher constructs are part of the behavior).</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">New APIs, <B>AddPickData</B> and
    <B>QueryHitPointEx</B>, allow arbitrary data to be attached to <B>Image</B> and <B>Geometry</B> behaviors and be retrieved as a result of a pick operation.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica"><B>UntilNotify</B> can now be used from
    script.</font></p>
	
    <p><font size="2" face="Verdana, Arial, Helvetica">The new methods on the <B>Statics</B> class are as follows:</font><ul>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>ImportDirect3DRMVisual</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica">ApplyDXTransform/ApplyDXTransformEx</font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>UntilNotifyScript</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>NotifyScriptEvent</B></font></li>
    </ul>
	
    <p><font size="2" face="Verdana, Arial, Helvetica">The new methods on the <B>Behavior</B> class
    are as follows:</font><ul>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>get_EndEvent</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>SwitchToEx</B></font></li>
    </ul>
    <p><font size="2" face="Verdana, Arial, Helvetica">The new methods on the <B>Event</B> class are as follows:</font><ul>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>NotifyScript</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>GetConstDuration</B></font></li>
    </ul>
    <p><font size="2" face="Verdana, Arial, Helvetica">The new methods on the <B>View</B> class are as follows:</font><ul>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>QueryHitPointEx</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>StartModelEx</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>GetDDD3DRM</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>GetRMDevice</B></font></li>
    </ul>
  </blockquote>
  <p><font size="2" face="Verdana, Arial, Helvetica"><u>3-D</u></font></p>
  <blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">DirectAnimation takes full advantage of
    Direct3D hardware acceleration.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">This release provides full support for
    textures in DirectX files (however, .bmp and .ppm are the only file formats supported).</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">Additional 3-D attributes include
    specular coefficient, specular color, and emissive color.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">Geometry behaviors can now cast
    shadows.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">Textures can be blended with the
    geometry's diffuse color.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">In addition to importing files,
    <B>Geometry</B> behaviors can be constructed from a Direct3D Retained Mode Visual.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">The new methods on the <B>Geometry</B> class
    are as follows:</font><ul>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>AddPickData</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>Shadow</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>LightRangeAnim</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>LightRange</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>BlendTextureDiffuse</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>AmbientColor</B></font></li>
    </ul>
  </blockquote>
  <p><font size="2" face="Verdana, Arial, Helvetica"><u>2-D</u></font></p>
  <blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">You might experience problems where
    transparent GIFs exhibit a pink color in their transparent area.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">The new methods on the image class are
    as follows:</font><ul>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>AddPickData</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>RenderResolution</B></font></li>
      <li><font size="2" face="Verdana, Arial, Helvetica"><B>ImageQuality</B></font></li>
    </ul>
  </blockquote>
  <p><font size="2" face="Verdana, Arial, Helvetica"><u>Movies and Sound</u></font></p>
  <blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The conditional construct (cond) can
    now be used for sounds.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">Movies and sound are streamed when
    downloaded over the Web.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">MPEG movies will have better
    performance, especially when played below their nominal rate.</font></p>
	<p><font size="2" face="Verdana, Arial, Helvetica">Starting with this version of DirectAnimation, you can change the phase of a sound dynamically.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">For this release, you might run into
    problems if you don't play one of the tracks of the movie (sound or video). It is recommended that you use both.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">Only one MIDI sound can be played at a
    time.</font></p>
  </blockquote>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><u>Changes from previous SDKs</u></font></p>

<ul>
  <li><font size="2" face="Verdana, Arial, Helvetica">In the size parameter for text, a
    negative quantity can be specified. The negative quantity enables you to indicate to
    DirectAnimation that the text behavior's size/orientation is not going to be animated
    (although animating the position is fine), enabling the production of a higher-quality text. DirectAnimation will carry support for this parameter forward, but eventually you will get the same high-quality text regardless of transforms applied to the text behavior.
Text whose size/orientation is not animated (static text) responds correctly to scaling and translation, but not to rotation or shears (either x or y). We recommend that you not shear or rotate static text. Static text won't look good if its scale is animated, but it will respond.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">The timer source for the DirectAnimation
    control can be selected using the <B>DAViewerControl</B> class's <B>TimerSource</B> property. This is useful for Web scripting. By default, DirectAnimation uses WM_TIMER messages.
<p>You can use the Internet Explorer 4.<I>x</I> DHTML timers by specifying values of DA_TIMER_SOURCE type, which enables your DirectAnimation content to be in sync with other controls or DHTML elements. Note that if you use this property, you should check for the version number, which is
    accessible through the <B>VersionString</B> method on <B>DAStatics</B>. Failure to do so will cause an error when the page is viewed with the previous version of DirectAnimation.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">If you find a problem with your
    scripting-based content that seems to make your Web page appear unresponsive to events and
    timers outside of your DirectAnimation content, you should set the <B>UpdateInterval</B> property of the control to 0.15 (this causes a new frame to be drawn every 0.15 seconds, meaning
    that the content gets 6.66 frames per second).</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">The DirectAnimation Java classes fully
    enforce the Java security model, only allowing media located in directories below the
    location of the Web page to be opened by the applet.</font></li>
</ul>

<p><a href="#Top of Page"><font size="2" face="Verdana, Arial, Helvetica"><strong>Back to
the top</strong></font></a></p>

<h3><a name="Known Bugs"><font size="2" face="Verdana, Arial, Helvetica"><strong>Known
Bugs</strong></font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The following is a list of current
known problems. It is strongly encouraged that you send us mail if you find a problem (<a
href="mailto:dxmbug@microsoft.com">dxmbug@microsoft.com</a>). There are newsgroups set up
to allow DirectAnimation content developers to discuss issues and ideas; however, mailing
a bug description is the only sure way to get a fix for a bug.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><b>General</b></font>

<ul>

  <li><font size="2" face="Verdana, Arial, Helvetica">For Java content, all <b>initialization</b>
    of DirectAnimation behaviors and events needs to happen in methods (cannot happen in
    classes outside of methods); however, you can have <b>declarations</b> of behaviors
    outside methods to make them accessible from other classes and throughout the methods of a class.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">When using Visual J++ version 1.1 to build the Java samples in the SDK, you should click the <B>Project</B>
    menu, choose the <B>Setting</B> command, choose <B>All Configuration</B> in the <B>Setting for</B> combo box, and then select the <B>Debug</B> tab, select the <B>Browser</B> in the <B>Category</B> combo box and select the <B>Use parameters from HTML page</B> radio button and enter an HTML path for each of the projects.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">There are some small memory leaks, most
    notably when using 3-D, sounds, or notifiers. To fix this in Java, implement <b>public
    void cleanup()</b> to the class that extends <B>Model</B>. In this method, call <b>super.cleanup()</b>
    and set all behaviors that are suspected of leaking memory to NULL. If you have other
    classes that contain DirectAnimation behaviors, implement <b>public void cleanup()</b> and only set suspect behaviors to NULL. Also, add the <b>public void destroy()</b> to the class that
    extends <B>DXMApplet</B>. In this method, call <b>super.destroy()</b> and set the model to NULL.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">For Java content, sometimes the
    LeftButtonPress events miss.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">TextPath and TextImage are now obsolete.
    Please use <B>StringPath</B> and <B>StringImage</B> instead.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica"><B>AnimateControlPosition</B> takes parameters
    in meters, even if you are using the pixel library.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Only DirectDraw surfaces created through
    DirectDrawEx can be imported.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">bvrhook does not get called at snapshot
    time.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><b>Graphics</b></font>

<ul>
  <li><font size="2" face="Verdana, Arial, Helvetica">Shearing movies and lines does not work
    properly.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Color palette is not correct for 256-color displays under Windows NT.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica"><B>FollowPathAngleUpright</B> isn't doing the
    uprightness.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Although class browsers or Visual Basic
    show the parameters to <B>Arc</B> and <B>RoundRect</B> as radius, they are really the diameter.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Using Java, time-varying opacity might cause the whole object to become solid after some time.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Knot duplicity for splines is not
    handled.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Bounding box of a sheared behavior is
    incorrect.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Overlaying an image on a
    <B>SolidColorImage</B>, cropping it, and then adding a rotation transform results in the
    <B>SolidColorImage</B> disappearing. The work-around is to crop the <B>SolidColorImage</B> into a matte.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Underline and strikethrough don't work
    on Windows NT.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">When loading a large number of JPEG
    images, there is a significant delay. A work-around is to use the asynchronous
    import method.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><b>Audio</b></font>

<ul>
  <li><font size="2" face="Verdana, Arial, Helvetica">Sound does not turn off all the time.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica"><B>SinSynth</B> plays at 440 Hz no matter what
    rate is specified.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Loop causes the leaf sounds to loop, not
    the combined sound behavior (this is the intended behavior).</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica"><B>SinSynth</B> mixed with static sound gives a choppy sinusoidal sound.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><b>Controls</b></font>

<ul>
  <li><font size="2" face="Verdana, Arial, Helvetica">When using the Sprite multimedia
    control, source .bmp images over 2048 pixels long have to be broken into arrays of images
    (rows and columns of images, instead of just one long row or column).</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Under some video drivers, filtered
    transparent pixels render as black.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">For the Path control, <B>TimeMarker</B>
    persistence parameter &quot;-1&quot; works like FALSE in JScript.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><b>Using Visual Basic</b></font>

<ul>
  <li><font size="2" face="Verdana, Arial, Helvetica">Use the DirectAnimation windowed control when creating Visual Basic samples. There is a buffering problem in Visual Basic 5.0 that
    causes flashing if the DirectAnimation windowless control is used instead. It is recommended that you use version 6.0 of Visual Basic.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Button events do not work.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">If the animation runs too slowly,
    increase the value of the <b>UpdateInterval</b> property.</font></li>
  <li><font size="2" face="Verdana, Arial, Helvetica">Some of the samples will not run inside of Visual Basic when the project is opened with the Visual Basic file menu. If you open Visual Basic, click the existing tab, and choose the same project, the sample will open but will not run. If this happens, close Visual Basic and double-click to open the project file in Windows Explorer. This should work around the problem. If you build the project and then run the executable, the sample will run from Visual Basic.
</font></li>


</ul>

<p><a href="#Top of Page"><font size="2" face="Verdana, Arial, Helvetica"><strong>Back to
the top</strong></font></a></p>

<h3><a name="Contact Info"><font size="2" face="Verdana, Arial, Helvetica"><strong>Contact
Information</strong></font></a></h3>

<blockquote>
  <p><font size="2" face="Verdana, Arial, Helvetica">There are public newsgroups on the <a
  href="news://msnews.microsoft.com">Microsoft Public News Server</a>, as a forum for the
  DirectAnimation user community. You are encouraged to post all questions related to the use
  of DirectAnimation on the appropriate newsgroup: </font><ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><a
      href="news:microsoft.public.multimedia.directx.danimation.controls">microsoft.public.multimedia.directx.danimation.controls</a> is for users of the DirectAnimation controls.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><a
      href="news:microsoft.public.multimedia.directx.danimation.programming">microsoft.public.multimedia.directx.danimation.programming</a> is for programmers of the DirectAnimation API.</font></li>
  </ul>
  <p><font size="2" face="Verdana, Arial, Helvetica">For reporting bugs against the preview
  version, send mail to <a href="mailto:dxmbug@microsoft.com">dxmbug@microsoft.com</a>. When
  you do so, make sure to be specific about the OS, PC/graphics card, version of Internet Explorer 4.<I>x</I>, and specific host language/control that you're using to access DirectAnimation.</font></p>
  <p><font size="2" face="Verdana, Arial, Helvetica"><br>
  </font></p>
</blockquote>

<p><a href="#Top of Page"><font size="2" face="Verdana, Arial, Helvetica"><strong>Back to
the top</strong></font></a></p>
<script language="JScript">
<!--
m = DAControl.MeterLibrary;

dim = 0.03;  // in meters

// This gives us a smileFace, rightWinkFace, leftWinkFace and talkingFace
CreateFaces();

// Here we sequence the faces as we want them to appear in the animation
face = m.Sequence(smileFace.Duration(1),
	m.Sequence(talkingFace.Duration(3), 
	m.Sequence(smileFace.Duration(8),
	m.Sequence(leftWinkFace.Duration(4),
	smileFace))));

faceGeo = Create3DFace(face);

// Set the movement for the head around in the page, using a 3D spline path
 shipPoints = new Array(m.Vector3(-0.07,0.03,-0.01), m.Vector3(-0.06,0.02,-0.01), m.Vector3(-0.03,0.03,0),
   m.Vector3(0.0,0.01,0), m.Vector3(0.01,0,0), m.Vector3(0.02,0.02,0), m.Vector3(0.03,0,0),
   m.Vector3(0.04,-0.01,0), m.Vector3(0.065,0.03,0.02), m.Vector3(0.065,0.03,0.02), m.Vector3(0.065,0.03,0.02));


  shipKnots = new Array(m.DANumber(0), m.DANumber(0), m.DANumber(0), m.DANumber(1), m.DANumber(2), 
   m.DANumber(3), m.DANumber(4), m.DANumber(5), m.DANumber(6), m.DANumber(7),
   m.DANumber(8), m.DANumber(8), m.DANumber(8));

  shipSpline = m.Vector3BSpline(3,shipKnots,shipPoints,null,m.Div(m.LocalTime,m.DANumber(1.5)));

// Movement

rotate1 = m.Rotate3Degrees(m.YVector3,30).Duration(4);

rotate2Angle = m.Interpolate(30,-30,1);

rotate2 = m.Rotate3Anim(m.YVector3, m.ToRadians(rotate2Angle)).Duration(4);

position= m.Compose3(m.Translate3Vector(shipSpline ),m.Sequence(rotate1,rotate2));

// Add a subtle movement to the face
jiggleY = m.sequence(m.Interpolate(-0.0003,0.0003,0.1),m.Interpolate(0.0003,-0.0003,0.1)).RepeatForever();

faceGeo = faceGeo.Transform(m.Translate3Anim(m.DANumber(0),jiggleY,m.DANumber(0)));

// Apply the position transform
movingGeo = faceGeo.Transform(position);

// render the geometry with the light and camera
finalImg = m.UnionGeometryArray( new Array( movingGeo, light, m.AmbientLight.LightColor(m.ColorRgb(0.4,0.4,0.4)))).Render(camera);

DAControl.Image = m.Overlay(finalImg,m.SolidColorImage(m.White));     

// start the animation       
DAControl.Start();

function CreateFaces()
{

leftEyeXPos = m.DANumber(0.43);
leftEyeYPos = m.DANumber(0.6);
eyelid = m.sequence(m.Oval(0.07,0.2).Fill(m.EmptyLineStyle,m.SolidColorImage(m.Yellow)).Duration(0.2),m.EmptyImage.Duration(1.8)).RepeatForever();
leftEye = m.Oval(0.07,0.2).Fill(m.EmptyLineStyle,m.SolidColorImage(m.Black)).Transform(m.Translate2Anim(leftEyeXPos , leftEyeYPos));

leftEyeLid = eyelid.Transform(m.Translate2Anim(leftEyeXPos , leftEyeYPos));

rightEyeXPos = m.DANumber(0.57);
rightEyeYPos = m.DANumber(0.6);
rightEye = m.Oval(0.07,0.2).Fill(m.EmptyLineStyle,m.SolidColorImage(m.Black)).Transform(m.Translate2Anim(rightEyeXPos, rightEyeYPos));

rightEyeLid = eyelid.Transform(m.Translate2Anim(rightEyeXPos , rightEyeYPos));

bottomLip = m.Oval(0.25,0.1).Fill(m.EmptyLineStyle,m.SolidColorImage(m.Black)).Transform(m.Translate2(0.5, 0.37));

topLip = m.Oval(0.25,0.1).Fill(m.EmptyLineStyle,m.SolidColorImage(m.Yellow)).Transform(m.Translate2(0.5, 0.41));
 
mouth = m.Overlay(topLip, bottomLip);

smileFace = m.OverlayArray( new Array(leftEyeLid, leftEye, rightEyeLid, rightEye, mouth, m.SolidColorImage(m.Yellow))).Crop(m.Point2(0,0),m.Point2(1,1));

winkYPos = m.Sequence(m.DANumber(0.8).Duration(0.2),m.sequence(m.Interpolate(0.8, 0.61, 0.2).Duration(2),m.Interpolate(0.6, 0.8, 0.2)));
winkLeftEyeLid = m.Oval(0.07,0.2).Fill(m.EmptyLineStyle,m.SolidColorImage(m.Yellow)).Transform(m.Translate2Anim(leftEyeXPos , winkYPos));
winkRightEyeLid = m.Oval(0.07,0.2).Fill(m.EmptyLineStyle,m.SolidColorImage(m.Yellow)).Transform(m.Translate2Anim(rightEyeXPos , winkYPos));

rightWinkFace =  m.OverlayArray( new Array(leftEyeLid, leftEye, winkRightEyeLid, rightEye, mouth, m.SolidColorImage(m.Yellow))).Crop(m.Point2(0,0),m.Point2(1,1));
leftWinkFace =  m.OverlayArray( new Array(winkLeftEyeLid, leftEye, rightEyeLid, rightEye, mouth, m.SolidColorImage(m.Yellow))).Crop(m.Point2(0,0),m.Point2(1,1));

topLipYPos = m.sequence(m.Interpolate(0.41, 0.45, 0.2),m.Interpolate(0.45, 0.41, 0.2)).RepeatForever();
talkingTopLip = m.Oval(0.25,0.1).Fill(m.EmptyLineStyle,m.SolidColorImage(m.Yellow)).Transform(m.Translate2Anim(m.DANumber(0.5), topLipYPos));
talkingMouth =  m.Overlay(talkingTopLip , bottomLip);

talkingFace =  m.OverlayArray( new Array(leftEyeLid, leftEye, rightEyeLid, rightEye, talkingMouth, m.SolidColorImage(m.Yellow))).Crop(m.Point2(0,0),m.Point2(1,1));
}

function Create3DFace(theFaceTexture)
{

// Now we set perspective camera and lights
camera = m.PerspectiveCamera(8*dim, 4.1*dim);
// a point light
light = m.PointLight.Transform(m.Translate3(dim, dim/4, 2*dim));
//light = light.LightRangeAnim(m.Interpolate(-0.5,100,4));

// import the 3D geometry used for creating the face
theFaceGeo = m.ImportGeometry("..//samples/multimedia//media//geometry//sphere.x").Texture(theFaceTexture).Transform(m.Scale3(dim/2,dim/2,dim/4)).Transform(m.Rotate3Degrees(m.YVector3,180));

return theFaceGeo;
}
//-->
</script>

</body>
</html>
