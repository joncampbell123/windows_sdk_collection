<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirect3DRMDevice3</TITLE>
<SCRIPT LANGUAGE="JAVASCRIPT"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IDirect3DRMDevice3">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::AddUpdateCallback">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::DeleteUpdateCallback">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::FindPreferredTextureFormat">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetBufferCount">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetColorModel">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetDirect3DDevice2">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetDither">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetHeight">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetQuality">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetRenderMode">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetShades">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetStateChangeOptions">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetTextureQuality">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetTrianglesDrawn">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetViewports">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetWidth">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::GetWireframeOptions">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::Init">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::InitFromClipper">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::InitFromD3D2">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::InitFromSurface">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::LightStateChange">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::RenderStateChange">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::SetBufferCount">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::SetDither">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::SetQuality">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::SetRenderMode">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::SetShades">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::SetStateChangeOptions">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::SetTextureQuality">
<META NAME="Description" CONTENT="IDirect3DRMDevice3::Update">
<META NAME="Description" CONTENT="AddUpdateCallback (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="DeleteUpdateCallback (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="FindPreferredTextureFormat (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetBufferCount (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetColorModel (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetDirect3DDevice2 (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetDither (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetHeight (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetQuality (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetRenderMode (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetShades (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetStateChangeOptions (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetTextureQuality (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetTrianglesDrawn (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetViewports (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetWidth (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="GetWireframeOptions (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="Init (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="InitFromClipper (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="InitFromD3D2 (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="InitFromSurface (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="LightStateChange (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="RenderStateChange (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="SetBufferCount (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="SetDither (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="SetQuality (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="SetRenderMode (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="SetShades (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="SetStateChangeOptions (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="SetTextureQuality (IDirect3DRMDevice3)">
<META NAME="Description" CONTENT="Update (IDirect3DRMDevice3)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRMDevice3"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/HDRd3drm.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRMDevice3"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="Direct3D Retained Mode Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft Direct3D Retained Mode SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Iface_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="ClippedVisual.htm">IDirect3DRMClippedVisual</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="DeviceArray.htm">IDirect3DRMDeviceArray</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">


<!-- CONTENTS_START -->

<H1>IDirect3DRMDevice3</H1>

<P>Applications use the <A HREF="Device3.htm">IDirect3DRMDevice3</A>, <B>IDirect3DRMDevice2</B>, and <B>IDirect3DRMDevice</B> interfaces to interact with the output device. For a conceptual overview, see <A HREF="../oview/OutputDevices_face.htm">Output Devices</A>.

<P><b>IDirect3DRMDevice3</b> contains all the methods in the older <b>IDirect3DRMDevice2</b> and <B>IDirect3DRMDevice</B> interfaces, but adds the <a href="#FindPreferredTextureFormat">FindPreferredTextureFormat</a> method to select a texture format based on certain criteria and also adds four methods that eliminate redundant state changes (setting a state to a value equal to its current value): <A HREF="Device3.htm#GetStateChangeOptions">GetStateChangeOptions</A>, <A HREF="Device3.htm#LightStateChange">LightStateChange</A>, <A HREF="Device3.htm#RenderStateChange">RenderStateChange</A>, and <A HREF="Device3.htm#SetStateChangeOptions">SetStateChangeOptions</A>.
<p><b>IDirect3DRMDevice2</b> contains all the methods in <B>IDirect3DRMDevice</B>, plus: two addition methods that enable you to control transparency, <A HREF="Device3.htm#GetRenderMode">GetRenderMode</A> and <A HREF="Device3.htm#SetRenderMode">SetRenderMode</A>; one additional initialization method, <A HREF="Device3.htm#InitFromSurface">InitFromSurface</A>; and two changed methods, <A HREF="Device3.htm#GetDirect3DDevice2">GetDirect3DDevice2</A> and <A HREF="Device3.htm#InitFromD3D2">InitFromD3D2</A>, which get and initialize an <B>IDirect3DRMDevice2</B> object rather than an <B>IDirect3DRMDevice</B> object. 

<p>When you create the <B>IDirect3DRMDevice3</B> or <B>IDirect3DRMDevice2</B> interface from the <B>IDirect3DRM3</B> or <B>IDirect3DRM2</B> interface, respectively, or initialize either interface
 using its respective <A HREF="../ref/Device3.htm#InitFromClipper">InitFromClipper</A>, <A HREF="../ref/Device3.htm#InitFromD3D2">InitFromD3D2</A>, or <A HREF="../ref/Device3.htm#InitFromSurface">InitFromSurface</A> <b>IDirect3DRMDevice3</b> methods, the interface works with an <B>IDirect3DDevice3</B> or <B>IDirect3DDevice2</B> Immediate Mode device, respectively. The <B>IDirect3DDevice3</B> and <B>IDirect3DDevice2</B> devices support the <B>DrawPrimitive</B> interface, as well as execute buffers, and are required for progressive meshes, for alpha blending and sorting of transparent objects. When you create the old <B>IDirect3DRMDevice</B> interface from the <B>IDirect3DRM</B> interface, the <B>IDirect3DRMDevice</B> Retained Mode interface
 works with an <B>IDirect3DDevice</B> Immediate Mode device. 

<P>The <A HREF="../ref/Device3.htm#InitFromClipper">InitFromClipper</A> and <A HREF="../ref/Device3.htm#InitFromSurface">InitFromSurface</A> methods use the <A HREF="../ref/IDirect3DRM3.htm#CreateDevice">IDirect3DRM3::CreateDevice</A> method to create a <b>Direct3DRMDevice3</b> object.

<p>The <A HREF="../ref/Device3.htm#InitFromD3D2">InitFromD3D2</A> method uses an <B>IDirect3D2</B> Immediate Mode object and an <B>IDirect3DDevice2</B> Immediate Mode device to initialize an <B>IDirect3DDevice2</B> Direct3D Retained Mode device. 

<P>You can still query between the <B>IDirect3DRMDevice3</B>, <B>IDirect3DRMDevice2</B>, and <B>IDirect3DRMDevice</B> interfaces. The main difference is in how the underlying Immediate Mode device is created. 

<P>The methods of the <B>IDirect3DRMDevice3</B> interface can be organized into the following groups:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Buffer counts</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetBufferCount">GetBufferCount</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#SetBufferCount">SetBufferCount</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Color models</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetColorModel">GetColorModel</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Dithering</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetDither">GetDither</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#SetDither">SetDither</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Eliminating Redundant State Changes</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetStateChangeOptions">GetStateChangeOptions</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#LightStateChange">LightStateChange</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#RenderStateChange">RenderStateChange</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#SetStateChangeOptions">SetStateChangeOptions</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Initialization</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#Init">Init</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#InitFromClipper">InitFromClipper</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#InitFromD3D2">InitFromD3D2</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#InitFromSurface">InitFromSurface</A>
</TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Miscellaneous</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetDirect3DDevice2">GetDirect3DDevice2</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetHeight">GetHeight</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetTrianglesDrawn">GetTrianglesDrawn</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetViewports">GetViewports</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetWidth">GetWidth</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetWireframeOptions">GetWireframeOptions</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#Update">Update</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Notifications</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#AddUpdateCallback">AddUpdateCallback</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#DeleteUpdateCallback">DeleteUpdateCallback</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Rendering quality</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetQuality">GetQuality</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#SetQuality">SetQuality</A>
 </TD></TR>
 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Shading</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetShades">GetShades</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#SetShades">SetShades</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR>
  <TR><TD ALIGN=LEFT VALIGN=TOP><B>Textures</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#FindPreferredTextureFormat">FindPreferredTextureFormat</A>
 </TD></TR>
 <TR><TD ALIGN=LEFT VALIGN=TOP>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetTextureQuality">GetTextureQuality</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#SetTextureQuality">SetTextureQuality</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Transparency</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#GetRenderMode">GetRenderMode</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#SetRenderMode">SetRenderMode</A>
 </TD></TR></TABLE>
<P>The <B>IDirect3DRMDevice3</B> interface, like all Component Object Model (COM) interfaces, inherits the <A HREF="FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interface methods. The <B>IUnknown</B> interface supports the following three methods:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__AddRef">AddRef</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__QueryInter">QueryInterface</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__Release">Release</A>
</TD></TR></TABLE>
<P>In addition, the <B>IDirect3DRMDevice3</B> interface inherits the following methods from the <A HREF="Object.htm">IDirect3DRMObject</A> interface:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#AddDestroyCallback">AddDestroyCallback</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#Clone">Clone</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#DeleteDestroyCallback">DeleteDestroyCallback</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetAppData">GetAppData</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetClassName">GetClassName</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetName">GetName</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#SetAppData">SetAppData</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#SetName">SetName</A>
</TD></TR></TABLE>

<P>The <B>Direct3DRMDevice3</B> object is obtained by calling the <A HREF="IDirect3DRM3.htm#CreateDevice">IDirect3DRM3::CreateDevice</A> method.


<H1><A NAME="AddUpdateCallback">IDirect3DRMDevice3::AddUpdateCallback</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Adds a callback function that alerts the application when a change occurs to the device. The system uses this callback function when the application uses the <A HREF="Device3.htm#Update">IDirect3DRMDevice3::Update</A> method.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>AddUpdateCallback</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMDEVICE3UPDATECALLBACK</B> <I>d3drmUpdateProc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>arg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>d3drmUpdateProc</I>
</DT><DD>Pointer to an application-defined callback function, <A HREF="Callbacks.htm#D3DRMDEVICE3UPDATECALLBACK">D3DRMDEVICE3UPDATECALLBACK</A>.
</DD><DT><I>arg</I>
</DT><DD>Pointer to private data to be passed to the update callback function.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return values, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P><b>IDirect3DRMDevice2::AddUpdateCallback</b> and <b>IDirect3DRMDevice::AddUpdateCallback</b> take a <b>D3DRMUPDATECALLBACK</b> type callback for the <I>d3drmUpdateProc</I> parameter. With DirectX version 6.0, <b>IDirect3DRMDevice3</b> introduced the newer <a href="callbacks.htm#d3drmdevice3updatecallback">D3DRMDEVICE3UPDATECALLBACK</a> callback.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#DeleteUpdateCallback">IDirect3DRMDevice3::DeleteUpdateCallback</A>, <A HREF="Device3.htm#Update">IDirect3DRMDevice3::Update</A>, <A HREF="Callbacks.htm#D3DRMDEVICE3UPDATECALLBACK">D3DRMDEVICE3UPDATECALLBACK</A>
</BLOCKQUOTE>

<H1><A NAME="DeleteUpdateCallback">IDirect3DRMDevice3::DeleteUpdateCallback</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Removes an update callback function that was added by using the 
<A HREF="Device3.htm#AddUpdateCallback">IDirect3DRMDevice3::AddUpdateCallback</A> method.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>DeleteUpdateCallback</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMDEVICE3UPDATECALLBACK</B> <I>d3drmUpdateProc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>arg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>d3drmUpdateProc</I>
</DT><DD>Pointer to an application-defined callback function, <A HREF="Callbacks.htm#D3DRMDEVICE3UPDATECALLBACK">D3DRMDEVICE3UPDATECALLBACK</A>.
</DD><DT><I>arg</I>
</DT><DD>Pointer to private data that was passed to the update callback function.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return values, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P><b>IDirect3DRMDevice2::DeleteUpdateCallback</b> and <b>IDirect3DRMDevice::DeleteUpdateCallback</b> take a <b>D3DRMUPDATECALLBACK</b> type callback for the <I>d3drmUpdateProc</I> parameter. With DirectX version 6.0, <b>IDirect3DRMDevice3</b> introduced the newer <a href="callbacks.htm#d3drmdevice3updatecallback">D3DRMDEVICE3UPDATECALLBACK</a> callback.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#AddUpdateCallback">IDirect3DRMDevice3::AddUpdateCallback</A>, <A HREF="Device3.htm#Update">IDirect3DRMDevice3::Update</A>, <A HREF="Callbacks.htm#D3DRMDEVICE3UPDATECALLBACK">D3DRMDEVICE3UPDATECALLBACK</A>
</BLOCKQUOTE>



<H1><A NAME="FindPreferredTextureFormat">IDirect3DRMDevice3::FindPreferredTextureFormat</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<p>Finds a texture format that meets the user criteria and that the underlying Immediate Mode device supports. For optimal performance of the texture cache, use this function to choose the pixel format of texture surfaces.



<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><b>HRESULT FindPreferredTextureFormat(
  DWORD</b> <i>dwBitDepths</i><b>,
  DWORD</b> <i>dwFlags</i><b>,
  LPDDPIXELFORMAT </b> <i>lpDDPF</i><b>);</b></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>dwBitDepths</I></DT>
<DD>Requested texture format bit depth. Specify zero to indicate that any bit depth is acceptable. Specify other values, using a logical combination of one or more of the following DirectDraw bit-depth flags.
<DL><DT>DDBD_4</DT>
<DT>DDBD_8</DT>
<DT>DDBD_16</DT>
<DT>DDBD_24</DT>
<DT>DDBD_32</DT></DL></DD>
<DT><I>dwFlags</I></DT>
<DD>Flags that specify additional requirements. Specify zero to use the default preferences.
 Other valid values must be a logical combination of one or more of the following values.
<DL>
<DT>D3DRMFPTF_ALPHA</DT>
<DD>The returned texture format must have an alpha channel.</DD>
<DT>D3DRMFPTF_NOALPHA</DT>
<DD>The returned texture format must not have an alpha channel. Omit both the <b>D3DRMFPTF_ALPHA</b> and <b>D3DRMFPTF_NOALPHA</b> flags to indicate that the absence of an alpha channel is preferred, but not required.</DD>
<DT>D3DRMFPTF_PALETTIZED</DT>
<DD>The returned texture format must be palettized.</DD>
<DT>D3DRMFPTF_NOTPALETTIZED</DT>
<DD>The returned texture format must not be palettized. Omit both the <b>D3DRMFPTF_PALETTIZED</b> and <b>D3DRMFPTF_NOTPALETTIZED</b> flags to indicate that the absence of a palette is preferred, but not required.</DD>
</DL>
</DD>
<DT><I>lpDDPF</I></DT>
<DD>Pointer to receive the texture format.</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values.<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#D3DRMERR_TEXTUREFORMATNOTFOUND">D3DRMERR_TEXTUREFORMATNOTFOUND</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
<p><B>FindPreferredTextureFormat</B> returns <b>D3DRMERR_TEXTUREFORMATNOTFOUND</b> if the does not find an acceptable format. 
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
</BLOCKQUOTE>


<H1><A NAME="GetBufferCount">IDirect3DRMDevice3::GetBufferCount</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the value set in a call to the <A HREF="Device3.htm#SetBufferCount">IDirect3DRMDevice3::SetBufferCount</A> method.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>DWORD</B> <B>GetBufferCount</B><B>(</B> <B>)</B><B>;</B> </PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the number of buffers&#151;one for single-buffering, two for double-buffering, and so on.

</BLOCKQUOTE>
<H1><A NAME="GetColorModel">IDirect3DRMDevice3::GetColorModel</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the color model of a device.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>D3DCOLORMODEL</B> <B>GetColorModel</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a value from the <A HREF="FurtherReading.htm#D3DCOLORMODEL">D3DCOLORMODEL</A> enumerated type that describes the Direct3D color model (RGB or monochrome). 

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="../oview/OutputDevices_face.htm#sec_Color_Models">Color Models</A>
</BLOCKQUOTE>

<H1><A NAME="GetDirect3DDevice2">IDirect3DRMDevice3::GetDirect3DDevice2</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves a pointer to an <B>IDirect3DDevice2</B> Immediate Mode device.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>GetDirect3DDevice2</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DDEVICE2</B> <B>*</B> <I>lplpD3DDevice</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> </PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplpD3DDevice</I>
 </DT><DD>Address of a pointer that is initialized with a pointer to an <B>IDirect3DDevice2</B> Immediate Mode device object.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The <B>IDirect3DDevice2</B> device will support the DrawPrimitive interface and execute buffers and is required for progressive meshes and for alpha blending and sorting of transparent objects.
</BLOCKQUOTE>

<H1><A NAME="GetDither">IDirect3DRMDevice3::GetDither</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the dither flag for the device.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>
<B>BOOL</B> <B>GetDither</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns TRUE if the dither flag is set, or FALSE otherwise.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#SetDither">IDirect3DRMDevice3::SetDither</A>
</BLOCKQUOTE>

<H1><A NAME="GetHeight">IDirect3DRMDevice3::GetHeight</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the height, in pixels, of a device. This method is a convenience function.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>DWORD</B> <B>GetHeight</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the height.

</BLOCKQUOTE>
<H1><A NAME="GetQuality">IDirect3DRMDevice3::GetQuality</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the rendering quality for the device.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>D3DRMRENDERQUALITY</B> <B>GetQuality</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one or more of the members of the enumerated types represented by the <A HREF="Enums.htm#D3DRMRENDERQUALITY">D3DRMRENDERQUALITY</A> enumerated type.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#SetQuality">IDirect3DRMDevice3::SetQuality</A>
</BLOCKQUOTE>

<H1><A NAME="GetRenderMode">IDirect3DRMDevice3::GetRenderMode</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the current transparency flags.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>DWORD</B> <B>GetRenderMode</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the value of the current transparency flags.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Transparency flags have the following values.
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Flag
</B></TD><TD ALIGN=LEFT VALIGN=TOP><B>Value</B>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>No flag set (default)
</TD><TD ALIGN=LEFT VALIGN=TOP>0
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#D3DRMRENDERMODE_BLEN">D3DRMRENDERMODE_BLENDEDTRANSPARENCY</A>
</TD><TD ALIGN=LEFT VALIGN=TOP>1
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#D3DRMRENDERMODE_DISABLE">D3DRMRENDERMODE_DISABLESORTEDALPHAZWRITE</A>
</TD><TD ALIGN=LEFT VALIGN=TOP>32
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#D3DRMRENDERMODE_LIGHT">D3DRMRENDERMODE_LIGHTINMODELSPACE</A>
</TD><TD ALIGN=LEFT VALIGN=TOP>8
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#D3DRMRENDERMODE_SORT">D3DRMRENDERMODE_SORTEDTRANSPARENCY</A>
</TD><TD ALIGN=LEFT VALIGN=TOP>2
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Device3.htm#D3DRMRENDERMODE_VIEW">D3DRMRENDERMODE_VIEWDEPENDENTSPECULAR</A>
</TD><TD ALIGN=LEFT VALIGN=TOP>16
</TD></TR></TABLE>
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#SetRenderMode">IDirect3DRMDevice3::SetRenderMode</A>
</BLOCKQUOTE>


<H1><A NAME="GetShades">IDirect3DRMDevice3::GetShades</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the number of shades in a ramp of colors used for shading in the monochromatic (or ramp) model.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>DWORD</B> <B>GetShades</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the number of shades.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#SetShades">IDirect3DRMDevice3::SetShades</A>
</BLOCKQUOTE>

<H1><A NAME="GetStateChangeOptions">IDirect3DRMDevice3::GetStateChangeOptions</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the state change options flags associated with a render or light state. See <A HREF="../oview/Eliminating_Redundant.htm">Eliminating Redundant State Changes</a> for more details. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>GetStateChangeOptions</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwStateClass</I><b>,</b><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwStateNum</I><b>,</b><BR>&nbsp;&nbsp;<B>LPDWORD</B> <I>pdwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwStateClass</I>
</DT><DD>Class of states to which this state belongs. The value can be D3DRMSTATECHANGE_LIGHT or D3DRMSTATECHANGE_RENDER.
</DD><DT><I>dwStateNum</I>
</DT><DD>Appropriate D3DRENDERSTATE or D3DLIGHTSTATE number. A zero value indicates that all states of the given class should be affected.
</DD><DT><I>pdwFlags</I>
</DT><DD>Pointer to the options flags. Contains one of the following values:
<DD>D3DRMSTATECHANGE_NONVOLATILE</DD>
<DD>D3DRMSTATECHANGE_VOLATILE</DD>
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
<p>The following example code gets the options on the texture handle render state.
<PRE>
lpDirect3DRMDev3-&gt;GetStateChangeOptions(D3DRMSTATECHANGE_RENDER,
                          D3DRENDERSTATE_TEXTUREHANDLE, &amp;dwFlags);
</PRE>
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#SetStateChangeOptions">IDirect3DRMDevice3::SetStateChangeOptions</A>
</BLOCKQUOTE>

<H1><A NAME="GetTextureQuality">IDirect3DRMDevice3::GetTextureQuality</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>

<P>Retrieves the current texture quality parameter for the device. Texture quality is relevant only for an RGB device.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>
<B>D3DRMTEXTUREQUALITY</B> <B>GetTextureQuality</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P> Returns one of the members of the <A HREF="Enums.htm#D3DRMTEXTUREQUALITY">D3DRMTEXTUREQUALITY</A> enumerated type.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#SetTextureQuality">IDirect3DRMDevice3::SetTextureQuality</A>
</BLOCKQUOTE>
<H1><A NAME="GetTrianglesDrawn">IDirect3DRMDevice3::GetTrianglesDrawn</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the number of triangles drawn to a device since its creation. This method is a convenience function.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>DWORD</B> <B>GetTrianglesDrawn</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the number of triangles.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The number of triangles includes those that were passed to the renderer but were not drawn because they were backfacing (facing away from the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_c.htm#camera')">camera</A>). The number does not include triangles that were rejected for lying outside of the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_v.htm#viewing_frustum')">viewing frustum</A>. 
</BLOCKQUOTE>

<H1><A NAME="GetViewports">IDirect3DRMDevice3::GetViewports</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Constructs a <B>Direct3DRMViewportArray</B> object that represents the viewports currently constructed from the device.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>GetViewports</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMVIEWPORTARRAY*</B> <I>lplpViewports</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplpViewports</I>
</DT><DD>Address of a pointer that is initialized with a valid <B>Direct3DRMViewportArray</B> object if the call succeeds.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="GetWidth">IDirect3DRMDevice3::GetWidth</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the width, in pixels, of a device. This method is a convenience function.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>DWORD</B> <B>GetWidth</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the width of the device, in pixels.
</BLOCKQUOTE>

<H1><A NAME="GetWireframeOptions">IDirect3DRMDevice3::GetWireframeOptions</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Retrieves the wireframe options of a given device. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>DWORD</B> <B>GetWireframeOptions</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns a bitwise or one of the following values.
<DL>
<DT><B><A NAME="D3DRMWIREFRAME_CULL" IDX_CONCEPT="D3DRMWIREFRAME_CULL">D3DRMWIREFRAME_CULL</A></B>
 </DT><DD>The backfacing faces are not drawn.
</DD><DT><B><A NAME="D3DRMWIREFRAME_HIDDE" IDX_CONCEPT="D3DRMWIREFRAME_HIDDENLINE">D3DRMWIREFRAME_HIDDENLINE</A></B>
 </DT><DD>Wireframe-rendered lines are obscured by nearer objects.
</DD></DL>
</BLOCKQUOTE>

<H1><A NAME="Init">IDirect3DRMDevice3::Init</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Not implemented on the Microsoft&#174; Windows&#174; platform.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>Init</B><B>(</B><BR>&nbsp;&nbsp;<B>ULONG</B> <I>width</I><B>,</B><BR>&nbsp;&nbsp;<B>ULONG</B> <I>height</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>
<H1><A NAME="InitFromClipper">IDirect3DRMDevice3::InitFromClipper</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Initializes an <B>IDirect3DDevice2</B> device from a specified <B>DirectDrawClipper</B> object using <A HREF="IDirect3DRM3.htm#CreateDevice">IDirect3DRM3::CreateDevice</A>. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>InitFromClipper</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTDRAWCLIPPER</B> <I>lpDDClipper</I><B>,</B><BR>&nbsp;&nbsp;<B>LPGUID</B> <I>lpGUID</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>width</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>height</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpDDClipper</I>
</DT><DD>Pointer to
 the <B>DirectDrawClipper</B> object to use as an initializer.
</DD><DT><I>lpGUID</I>
</DT><DD>Direct3D device driver to use.
</DD><DT><I>width</I> and <I>height</I>
</DT><DD>Width and height of the device in pixels.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>. 

</BLOCKQUOTE>
<H1><A NAME="InitFromD3D2">IDirect3DRMDevice3::InitFromD3D2</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Initializes an <B>IDirect3DRMDevice2</B> Retained Mode device from an <B>IDirect3D2</B> Immediate Mode object and an <B>IDirect3DDevice2</B> Immediate Mode device.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>InitFromD3D2</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3D2</B> <I>lpD3D</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DDEVICE2</B> <I>lpD3DIMDev</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpD3D</I>
</DT><DD>Pointer to 
the <B>IDirect3D2</B> Immediate Mode object to use to initialize the Retained Mode device.
</DD><DT><I>lpD3DIMDev</I>
</DT><DD>Pointer to 
the <B>IDirect3DDevice2</B> Immediate Mode device to use to initialize the Retained Mode device.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The <B>IDirect3DRMDevice2</B> device initialized from <B>IDirect3DDevice2</B> will support the DrawPrimitive interface and execute buffers and is required for progressive meshes and for alpha blending and sorting of transparent objects.
</BLOCKQUOTE>
<H1><A NAME="InitFromSurface">IDirect3DRMDevice3::InitFromSurface</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Initializes a <B>IDirect3DDevice2</B> device from a specified DirectDraw surface, using the <A HREF="IDirect3DRM3.htm#CreateDevice">IDirect3DRM3::CreateDevice</A> method. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>InitFromSurface</B><B>(</B><BR>&nbsp;&nbsp;<B>LPGUID</B> <I>lpGUID</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECTDRAW</B> <I>lpDD</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECTDRAWSURFACE</B> <I>lpDDSBack</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpGUID</I>
</DT><DD>Pointer to
 the globally unique identifier (GUID) that identifies the Direct3D device driver to use.
</DD><DT><I>lpDD</I>
</DT><DD>Pointer to the interface of a DirectDraw object that created the DirectDrawSurface.
</DD><DT><I>lpDDSBack</I>
</DT><DD>Pointer to the interface of a DirectDrawSurface <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_B.htm#back_buffer')">back buffer</A> onto which the device will render.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>. 

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The <B>IDirect3DRMDevice2</B> device initialized will support the DrawPrimitive 
 methods and execute buffers, and is required for progressive meshes and for alpha blending and sorting of transparent objects.
</BLOCKQUOTE>


<H1><A NAME="LightStateChange">IDirect3DRMDevice3::LightStateChange</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Changes a light state or informs Direct3D Retained Mode of a change to a render state. If the D3DRMSTATECHANGE_NONVOLATILE flag is associated with the render state, Retained Mode eliminates redundant changes to the state made by using <A HREF="Device3.htm">IDirect3DRMDevice3</A> (it won't set the state to a value equal to its current value). See <A HREF="../oview/Eliminating_Redundant.htm">Eliminating Redundant State Changes</a> for more details.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>LightStateChange</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwStateNum</I><b>,</b><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwVal</I><b>,</b><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwStateNum</I>
</DT><DD>Appropriate D3DLIGHTSTATE number.
</DD><DT><I>dwVal</I>
</DT><DD>New value of the state.
</DD><DT><I>dwFlags</I>
</DT><DD>Flag that indicates whether Retained Mode should update the cache only. If this flag is set to D3DRMSTATECHANGE_UPDATEONLY, only the value held in the internal cache is updated. You can use D3DRMSTATECHANGE_UPDATEONLY to indicate a state change.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
<p>The following code sets the material handle light state, eliminating redundant changes if the D3DRMSTATECHANGE_NONVOLATILE flag has been associated with the state.

<PRE>
lpDirect3DRMDev3-&gt;LightStateChange(D3DLIGHTSTATE_MATERIAL, hMat, 0);
</PRE>
<p>The following indicates a change to the fog mode.
<PRE>
lpDirect3DRMDev3-&gt;LightStateChange(D3DLIGHTSTATE_FOGMODE, D3DFOG_NONE,
                                   D3DRMSTATECHANGE_UPDATEONLY);
</PRE>

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#SetStateChangeOptions">IDirect3DRMDevice3::SetStateChangeOptions</A>
</BLOCKQUOTE>

<H1><A NAME="RenderStateChange">IDirect3DRMDevice3::RenderStateChange</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Changes a render state or indicates a change to a render state. If the D3DRMSTATECHANGE_NONVOLATILE flag is associated with the render state, Retained Mode eliminates redundant changes to the state made by using <B>IDirect3DRMDevice3</B> (it won't set the state to a value equal to its current value). See <A HREF="../oview/Eliminating_Redundant.htm">Eliminating Redundant State Changes</a> for more details.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>RenderStateChange</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwStateNum</I><b>,</b><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwVal</I><b>,</b><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwStateNum</I>
</DT><DD>Appropriate D3DRENDERSTATE number.
</DD><DT><I>dwVal</I>
</DT><DD>New value of the state.
</DD><DT><I>dwFlags</I>
</DT><DD>Flag that indicates whether to update the cache only. If this flag is set to D3DRMSTATECHANGE_UPDATEONLY, only the value held in the internal cache is updated. You can use D3DRMSTATECHANGE_UPDATEONLY to indicate a change made to the state.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
<p>The following code sets the fill mode render state, eliminating redundant changes if the D3DRMSTATECHANGE_NONVOLATILE flag has been associated with the state.
<PRE>
lpDirect3DRMDev3-&gt;RenderStateChange(D3DRENDERSTATE_FILLMODE,
                          D3DFILL_SOLID, 0);
</PRE>
<p>The following code indicates a change to the texture handle render state.
<PRE>
lpDirect3DRMDev3-&gt;RenderStateChange(D3DRENDERSTATE_TEXTUREHANDLE, hTex,
                                    D3DRMSTATECHANGE_UPDATEONLY);
</PRE>

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#SetStateChangeOptions">IDirect3DRMDevice3::SetStateChangeOptions</A>
</BLOCKQUOTE>


<H1><A NAME="SetBufferCount">IDirect3DRMDevice3::SetBufferCount</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Sets the number of buffers currently being used by the application.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetBufferCount</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwCount</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwCount</I>
 </DT><DD>Number of buffers&#151;one for single-buffering, two for double-buffering, and so on. The default value is one, which is correct only for a single-buffered window operation.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application that employs double-buffering or triple-buffering must use this method to inform the system of how many buffers it is using so that the system can calculate how much of the window to clear and update on each frame. 
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#GetBufferCount">IDirect3DRMDevice3::GetBufferCount</A></BLOCKQUOTE>

<H1><A NAME="SetDither">IDirect3DRMDevice3::SetDither</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Sets the dither flag for the device. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetDither</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bDither</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>bDither</I>
</DT><DD>New dithering mode for the device. The default is TRUE.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#GetDither">IDirect3DRMDevice3::GetDither</A>
</BLOCKQUOTE>

<H1><A NAME="SetQuality">IDirect3DRMDevice3::SetQuality</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Sets the rendering quality of a device.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetQuality</B> <B>(</B><BR>&nbsp;&nbsp;<B>D3DRMRENDERQUALITY</B> <I>rqQuality</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rqQuality</I>
</DT><DD>One or more of the members of the enumerated types represented by the <A HREF="Enums.htm#D3DRMRENDERQUALITY">D3DRMRENDERQUALITY</A> enumerated type. The default setting is D3DRMRENDER_FLAT. 
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The rendering quality is the maximum quality at which rendering can take place on the rendering surface of that device.
<P>An object's quality has three components: shade mode (flat or Gouraud; Phong is not yet implemented and will default to Gouraud shading), lighting type (on or off), and fill mode (point, wireframe, or solid).
<P>You set the quality of a device with <B>SetQuality</B>. By default it is D3DRMRENDER_FLAT (flat shading, lights on, and solid fill). 

<P>You can set the quality of a <a href="progressivemesh.htm">Direct3DRMProgressiveMesh</a> or <a href="meshbuilder3.htm">Direct3DRMMeshBuilder3</a> object with their respective <B>SetQuality</B> methods. By default, the quality of these objects is D3DRMRENDER_GOURAUD (Gouraud shading, lights on, and solid fill).

<P><B>Tip:</B>  Gourad shading gets better performance on progressive mesh objects that change level of detail, often or quickly.

<P>Direct3D Retained Mode renders an object at the lowest quality setting based on the device and the object's current setting for each individual component. For example, 
if the object's current quality setting is D3DRMRENDER_GOURAUD, and the device is D3DRMRENDER_FLAT, the object will be rendered with flat shading, solid fill, and lights on. 
<P>If the object's current quality setting is D3DRMSHADE_GOURAUD|D3DRMLIGHT_OFF|D3DRMFILL_WIREFRAME, and the device's quality setting is D3DRMSHADE_FLAT|D3DRMLIGHT_ON|D3DRMFILL_POINT, the object will be rendered with flat shading, lights off, and point fill mode.

<P>These rules apply to <B>Direct3DRMMeshBuilder3</B> objects and <b>Direct3DRMProgressiveMesh</b> objects. However, <B>Direct3DRMMesh</B> objects do not follow these rules. Mesh objects ignore the device's quality settings and use the group quality setting (which defaults to D3DRMRENDER_GOURAUD).
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#GetQuality">IDirect3DRMDevice3::GetQuality</A> 
</BLOCKQUOTE>
<H1><A NAME="SetRenderMode">IDirect3DRMDevice3::SetRenderMode</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>

<P>Sets the transparency mode. The mode type determines how transparent objects will be rendered. The default mode renders transparent objects with stippled transparency. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetRenderMode</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwFlags</I>
</DT><DD>One or more of the transparent mode flags. The default (<I>dwFlags</I> = 0) sets the transparency mode to stippled transparency. Stippled (or "screen door") transparency is achieved by replacing some of the pixels in one image with pixels from the other image (as if you are seeing one image through a screen door painted with the second image).
<p>In addition, flags can
have one or more of the following values:
</DD><DD><B><A NAME="D3DRMRENDERMODE_BLEN">D3DRMRENDERMODE_BLENDEDTRANSPARENCY</A></B> (<I>dwFlags</I> = 1) sets the transparency mode to alpha blending. Blended transparency is achieved by combining two images by adding the color values at each pixel.
</DD><DD><B><A NAME="D3DRMRENDERMODE_DISABLE">D3DRMRENDERMODE_DISABLESORTEDALPHAZWRITE</A></B> (<I>dwFlags</I> = 32) specifies that no depth information will be written to the z-buffer when drawing sorted, transparent objects.
</DD><DD><B><A NAME="D3DRMRENDERMODE_LIGHT">D3DRMRENDERMODE_LIGHTINMODELSPACE</A></B> (<I>dwFlags</I> = 8). Reserved. Do not use.
</DD><DD><B><A NAME="D3DRMRENDERMODE_SORT">D3DRMRENDERMODE_SORTEDTRANSPARENCY</A></B> (<I>dwFlags</I> = 2) sets the transparency mode so that transparent polygons in the scene are buffered, sorted, and rendered in a second pass. This flag has no effect if the D3DRMRENDERMODE_BLENDEDTRANSPARENCY flag is not also set. Transparent polygons in external visuals or user visuals are not sorted. Only native D3DRM visuals (such as D3DRMMesh objects and D3DRMMeshBuilder objects) are sorted.
</DD><DD><B><A NAME="D3DRMRENDERMODE_VIEW">D3DRMRENDERMODE_VIEWDEPENDENTSPECULAR</A></B> (<I>dwFlags</I> = 16) enables more realistic specular lights that depend both on the light direction and the viewer's location. Previous versions of DirectX Foundation only supported flat specular light that did not take into account the viewer's location. If this flag is set, Direct3D Retained Mode uses the <B>D3DLIGHT2</B> structure to define the light type when calling Direct3D Immediate Mode's <B>IDirect3DLight::SetLight</B>. If this flag is not set, D3DRM uses the <B>D3DLIGHT</B> structure, and you will get the lighting behavior of previous versions of DirectX. 
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If the D3DRMRENDERMODE_BLENDEDTRANSPARENCY and D3DRMRENDERMODE_SORTEDTRANSPARENCY flags are set together, it ensures that when two transparent objects are rendered one on top of the other, the image will blend in the correct order to ensure the right visual result.
<p>The D3DRMRENDERMODE_SORTEDTRANSPARENCY turns on the per 
 triangle back-to-front sorting of alpha polygons. Only native D3DRM visuals (such as D3DRMMesh objects and D3DRMMeshBuilder objects) are sorted. You cannot add triangles from 
external visuals to the sorted list.
<p>The D3DRMRENDERMODE_BLENDEDTRANSPARENCY flag turns on true alpha blending as opposed to stippled alpha. In true alpha blending, the pixels of overlapping triangles are blended together. In stippled alpha, some pixels from the triangle in front are not drawn revealing the triangle below (this is also called screen-door transparency). When doing stippled alpha, it is not necessary to sort triangles since the result is the same no matter what order you render the triangles in.
<p>The only valid parameters to <B>SetSortMode</B> are 0 (stippled alpha with no sorting), BLENDEDTRANSPARENCY (true alpha with no sorting), and both BLENDEDTRANSPARENCY and SORTEDTRANSPARENCY (per triangle sorted true alpha).

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#GetRenderMode">IDirect3DRMDevice3::GetRenderMode</A>
</BLOCKQUOTE>
<H1><A NAME="SetShades">IDirect3DRMDevice3::SetShades</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Sets the number of shades in a ramp of colors used for shading in the monochromatic (or ramp) model. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetShades</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>ulShades</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ulShades</I>
</DT><DD>New number of shades. This parameter must be a power of two. The default is 32.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#GetShades">IDirect3DRMDevice3::GetShades</A>
</BLOCKQUOTE>

<H1><A NAME="SetStateChangeOptions">IDirect3DRMDevice3::SetStateChangeOptions</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Changes the options flags associated with one or more render or light states. The default value for all render and light states is D3DRMSTATECHANGE_VOLATILE. If the D3DRMSTATECHANGE_NONVOLATILE flag is associated with a render or light state, Direct3D Retained Mode caches the value and eliminates redundant changes (it won't set the state to a value equal to its current value). You must, however, indicate when you change the state with either the <A HREF="device3.htm#LightStateChange">LightStateChange</A> or <A HREF="device3.htm#RenderStateChange">RenderStateChange</A> method. See <A HREF="../oview/Eliminating_Redundant.htm">Eliminating Redundant State Changes</a> for more details. 
 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetStateChangeOptions</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwStateClass</I><b>,</b><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwStateNum</I><b>,</b><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwStateClass</I>
</DT><DD>Class of states to which this state belongs. The value can be D3DRMSTATECHANGE_LIGHT or D3DRMSTATECHANGE_RENDER. </DD><DT><I>dwStateNum</I>
</DT><DD>Appropriate D3DRENDERSTATE or D3DLIGHTSTATE number. A zero value indicates that all states of the given class should be affected.
</DD><DT><I>dwFlags</I>
</DT><DD>Options flags. One of the following values:
<DD>D3DRMSTATECHANGE_NONVOLATILE</DD>
<DD>D3DRMSTATECHANGE_VOLATILE</DD>
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
<p>The following code sets the D3DRMSTATECHANGE_NONVOLATILE flag on all render states.
<PRE>
lpDirect3DRMDev3-&gt;SetStateChangeOptions(D3DRMSTATECHANGE_RENDER, 0,
                                        D3DRMSTATECHANGE_NONVOLATILE);
</PRE>
<p>The following code sets the D3DRMSTATECHANGE_VOLATILE flag on the texture handle render state.
<PRE>
lpDirect3DRMDev3-&gt;SetStateChangeOptions(D3DRMSTATECHANGE_RENDER,
                                        D3DRENDERSTATE_TEXTUREHANDLE,
										D3DRMSTATECHANGE_VOLATILE);
</PRE>
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#GetStateChangeOptions">IDirect3DRMDevice3::GetStateChangeOptions</A>
</BLOCKQUOTE>

<H1><A NAME="SetTextureQuality">IDirect3DRMDevice3::SetTextureQuality</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Sets the texture quality for the device. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetTextureQuality</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMTEXTUREQUALITY</B> <I>tqTextureQuality</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>tqTextureQuality</I>
</DT><DD>One of the members of the <A HREF="Enums.htm#D3DRMTEXTUREQUALITY">D3DRMTEXTUREQUALITY</A> enumerated type. The default is <A HREF="Enums.htm#D3DRMTEXTURE_NEAREST">D3DRMTEXTURE_NEAREST</A>.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#GetTextureQuality">IDirect3DRMDevice3::GetTextureQuality</A>
</BLOCKQUOTE>

<H1><A NAME="Update">IDirect3DRMDevice3::Update</A><HR size=1></H1>
<A HREF="Device3.htm">IDirect3DRMDevice3</A>
<P>Copies the image that has been rendered to the display. It also provides a heartbeat function
 to the device driver, letting it know when to update the image.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>Update</B><B>(</B> <B>)</B><B>;</B></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>Each call to this method causes the system to call an application-defined callback function, <A HREF="Callbacks.htm#D3DRMDEVICE3UPDATECALLBACK">D3DRMDEVICE3UPDATECALLBACK</A>. To add a callback function, use the <A HREF="Device3.htm#AddUpdateCallback">IDirect3DRMDevice3::AddUpdateCallback</A> method.

<P><b>IDirect3DRMDevice2::Update</b> and <b>IDirect3DRMDevice::Update</b> cause the system to call a <b>D3DRMUPDATECALLBACK</b> type callback. With DirectX version 6.0, <b>IDirect3DRMDevice3</b> introduced the newer <a href="callbacks.htm#d3drmdevice3updatecallback">D3DRMDEVICE3UPDATECALLBACK</a> callback.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Device3.htm#AddUpdateCallback">IDirect3DRMDevice3::AddUpdateCallback</A>, <A HREF="Callbacks.htm#D3DRMDEVICE3UPDATECALLBACK">D3DRMDEVICE3UPDATECALLBACK</A>
</BLOCKQUOTE>
<!-- CONTENTS_END -->


<!-- START_PAGE_FOOTER -->


<H5><HR size=1></H5>
<P><A class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</BLOCKQUOTE>
<!-- END_PAGE_FOOTER -->


<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
