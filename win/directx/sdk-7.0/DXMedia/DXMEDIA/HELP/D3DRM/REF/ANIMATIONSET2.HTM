<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirect3DRMAnimationSet2</TITLE>
<SCRIPT LANGUAGE="JAVASCRIPT"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IDirect3DRMAnimationSet2">
<META NAME="Description" CONTENT="IDirect3DRMAnimationSet2::AddAnimation">
<META NAME="Description" CONTENT="IDirect3DRMAnimationSet2::DeleteAnimation">
<META NAME="Description" CONTENT="IDirect3DRMAnimationSet2::GetAnimations">
<META NAME="Description" CONTENT="IDirect3DRMAnimationSet2::Load">
<META NAME="Description" CONTENT="IDirect3DRMAnimationSet2::SetTime">
<META NAME="Description" CONTENT="AddAnimation (IDirect3DRMAnimationSet2)">
<META NAME="Description" CONTENT="DeleteAnimation (IDirect3DRMAnimationSet2)">
<META NAME="Description" CONTENT="GetAnimations (IDirect3DRMAnimationSet2)">
<META NAME="Description" CONTENT="Load (IDirect3DRMAnimationSet2)">
<META NAME="Description" CONTENT="SetTime (IDirect3DRMAnimationSet2)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDirect3DRMAnimationSet2"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRMAnimationSet2"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/HDRd3drm.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRMAnimationSet2"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="Direct3D Retained Mode Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft Direct3D Retained Mode SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Iface_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="AnimationArray.htm">IDirect3DRMAnimationArray</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="Array.htm">IDirect3DRMArray</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->

<H1><A NAME="dx5_IDirect3DRMAnimationSet2_d3drm"></A>IDirect3DRMAnimationSet2</H1>

<P>Applications use the methods of the <B>IDirect3DRMAnimationSet2</B> interface to group Direct3DRMAnimation objects together, which can simplify the playback of complex animation sequences.

<p>A Direct3DRMAnimationSet object allows Direct3DRMAnimation objects to be grouped together. This allows all the animations in an animation set to share the same time parameter, simplifying the playback of complex articulated animation sequences. An application can add an animation to an animation set by using the <A HREF="#IDirect3DRMAnimationSet2_AddAnimation">IDirect3DRMAnimationSet2::AddAnimation</A> method, and it can remove one by using the <A HREF="#IDirect3DRMAnimationSet2_DeleteAnimation">IDirect3DRMAnimationSet2::DeleteAnimation</A> method. Animation sets are driven by calling the <A HREF="#IDirect3DRMAnimationSet2_SetTime">IDirect3DRMAnimationSet2::SetTime</A> method.

<p>Microsoft DirectX version 6.0 introduces the <B>IDirect3DRMAnimationSet2</B> interface. <B>IDirect3DRMAnimationSet2</B> extends the 
older <b>IDirect3DRMAnimationSet</b> interface that it replaces by adding the <a href="#GetAnimations">GetAnimations</a> method that allows you to retrieve the constituent animations. For a history of the Direct3D Retained Mode interfaces, see <a href="../oview/interface_changes.htm">Interface Changes</a>.

<P>The methods of the <B>IDirect3DRMAnimationSet2</B> interface can be organized into the following groups:<P>
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Adding, removing, retrieving, and loading</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="AnimationSet2.htm#IDirect3DRMAnimationSet2_AddAnimation">AddAnimation</A>
</TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="AnimationSet2.htm#IDirect3DRMAnimationSet2_DeleteAnimation">DeleteAnimation</A>
 </TD></TR>

<TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="AnimationSet2.htm#GetAnimations">GetAnimations</A>
 </TD></TR><TR>

 <TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="AnimationSet2.htm#IDirect3DRMAnimationSet2_Load">Load</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Time</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="AnimationSet2.htm#IDirect3DRMAnimationSet2_SetTime">SetTime</A>
</TD></TR></TABLE>
<P>The <B>IDirect3DRMAnimationSet2</B> interface, like all Component Object Model (COM) interfaces, inherits the <A HREF="FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interface methods. The <A HREF="FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interface supports the following three methods:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__AddRef">AddRef</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__QueryInter">QueryInterface</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__Release">Release</A>
</TD></TR></TABLE>
<P>In addition, the <B>IDirect3DRMAnimationSet2</B> interface inherits the following methods from the <A HREF="Object.htm">IDirect3DRMObject</A> interface:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#AddDestroyCallback">AddDestroyCallback</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#Clone">Clone</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#DeleteDestroyCallback">DeleteDestroyCallback</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetAppData">GetAppData</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetClassName">GetClassName</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetName">GetName</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#SetAppData">SetAppData</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#SetName">SetName</A>
</TD></TR></TABLE>
<P>The Direct3DRMAnimationSet object is obtained by calling the <A HREF="IDirect3DRM3.htm#CreateAnimationSet">IDirect3DRM3::CreateAnimationSet</A> method.


<H1><A NAME="IDirect3DRMAnimationSet2_AddAnimation">IDirect3DRMAnimationSet2::AddAnimation</A><HR size=1></H1>
<A HREF="AnimationSet2.htm">IDirect3DRMAnimationSet2</A>
<P>Adds an animation to the animation set.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>AddAnimation</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMANIMATION2</B> <I>lpD3DRMAnimation</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpD3DRMAnimation</I>
</DT><DD>Address of the Direct3DRMAnimation object to be added to the animation set.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="IDirect3DRMAnimationSet2_DeleteAnimation">IDirect3DRMAnimationSet2::DeleteAnimation</A><HR size=1></H1>
<A HREF="AnimationSet2.htm">IDirect3DRMAnimationSet2</A>
<P>Removes a previously added animation from the animation set.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>DeleteAnimation</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMANIMATION2</B> <I>lpD3DRMAnimation</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpD3DRMAnimation</I>
</DT><DD>Address of the Direct3DRMAnimation object to be removed from the animation set.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>



<H1><a name="GetAnimations">IDirect3DRMAnimationSet2::GetAnimations</a><HR size=1></H1>
<A HREF="AnimationSet2.htm">IDirect3DRMAnimationSet2</A>
<P>Retrieves an array containing the animations in the animation set.





<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT GetAnimations
(LPDIRECT3DRMANIMATIONARRAY*</B> <I>lplpArray</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>lplpArray</I></DT>
<DD>Array that receives a pointer to the corresponding <B>Direct3DRMAnimationArray</B> object.</DD>




</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
</BLOCKQUOTE>


<H1><A NAME="IDirect3DRMAnimationSet2_Load">IDirect3DRMAnimationSet2::Load</A><HR size=1></H1>
<A HREF="AnimationSet2.htm">IDirect3DRMAnimationSet2</A>
<P>Loads an animation set.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>Load</B><B>(</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpvObjSource</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpvObjID</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DRMLOADOPTIONS</B> <I>d3drmLOFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DRMLOADTEXTURE3CALLBACK</B> <I>d3drmLoadTextureProc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArgLTP</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMFRAME3</B> <I>lpParentFrame</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpvObjSource</I>
 </DT><DD>Source for the object to be loaded. This source can be a file, resource, memory block, or stream, depending on the source flags specified in the <I>d3drmLOFlags</I> parameter.
</DD><DT><I>lpvObjID</I>
 </DT><DD>Object name or position to be loaded. The use of this parameter depends on the identifier flags specified in the <I>d3drmLOFlags</I> parameter. If the D3DRMLOAD_BYPOSITION flag is specified, this parameter is a pointer to a <B>DWORD</B> value that gives the object's order in the file. This parameter can be NULL.
</DD><DT><I>d3drmLOFlags</I>
 </DT><DD>Value of the <A HREF="Constants.htm#D3DRMLOADOPTIONS">D3DRMLOADOPTIONS</A> type describing the load options.
</DD><DT><I>d3drmLoadTextureProc</I>
 </DT><DD><A HREF="Callbacks.htm#D3DRMLOADTEXTURE3CALLBACK">D3DRMLOADTEXTURE3CALLBACK</A> callback function used to load any textures used by the object that require special formatting. This parameter can be NULL.
</DD><DT><I>lpArgLTP</I>
 </DT><DD>Address of application-defined data passed to the <B>D3DRMLOADTEXTURE3CALLBACK</B> callback function.
</DD><DT><I>lpParentFrame</I>
 </DT><DD>Address of a parent <B>Direct3DRMFrame</B> object. This argument only affects the loading of animation sets. When an animation that is loaded from an .x file references an unparented frame in the .x file, the frame's
 parent is set to this parent frame argument. However, if you use
 <B>Load</B> to load any frames in the .x file, the parent frame argument will not be used as the parent frame for frames in the .x file with no parent. That is, the parent frame argument is used only when you load animation sets. The value of this argument can be NULL.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>By default, this method loads the first animation set in the file specified by the <I>lpvObjSource</I> parameter.  By default, perspective correction is <b>on</B>.
</BLOCKQUOTE>
<H1><A NAME="IDirect3DRMAnimationSet2_SetTime">IDirect3DRMAnimationSet2::SetTime</A><HR size=1></H1>
<A HREF="AnimationSet2.htm">IDirect3DRMAnimationSet2</A>
<P>Sets the time for this animation set.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetTime</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rvTime</I>
</DT><DD>New time.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H5><HR size=1></H5>
<P><A class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
