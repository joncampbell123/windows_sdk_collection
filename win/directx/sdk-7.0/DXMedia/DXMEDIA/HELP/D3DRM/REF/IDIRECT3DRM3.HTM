<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirect3DRM3</TITLE>
<SCRIPT LANGUAGE="JAVASCRIPT"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IDirect3DRM3">
<META NAME="Description" CONTENT="IDirect3DRM3::AddSearchPath">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateAnimation">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateAnimationSet">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateClippedVisual">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateDevice">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateDeviceFromClipper">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateDeviceFromD3D">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateDeviceFromSurface">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateFace">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateFrame">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateLight">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateLightRGB">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateMaterial">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateMesh">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateMeshBuilder">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateObject">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateProgressiveMesh">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateShadow">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateTexture">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateTextureFromSurface">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateUserVisual">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateViewport">
<META NAME="Description" CONTENT="IDirect3DRM3::CreateWrap">
<META NAME="Description" CONTENT="IDirect3DRM3::EnumerateObjects">
<META NAME="Description" CONTENT="IDirect3DRM3::GetDevices">
<META NAME="Description" CONTENT="IDirect3DRM3::GetNamedObject">
<META NAME="Description" CONTENT="IDirect3DRM3::GetSearchPath">
<META NAME="Description" CONTENT="IDirect3DRM3::Load">
<META NAME="Description" CONTENT="IDirect3DRM3::LoadTexture">
<META NAME="Description" CONTENT="IDirect3DRM3::LoadTextureFromResource">
<META NAME="Description" CONTENT="IDirect3DRM3::RegisterClient">
<META NAME="Description" CONTENT="IDirect3DRM3::SetDefaultTextureColors">
<META NAME="Description" CONTENT="IDirect3DRM3::SetDefaultTextureShades">
<META NAME="Description" CONTENT="IDirect3DRM3::SetSearchPath">
<META NAME="Description" CONTENT="IDirect3DRM3::Tick">
<META NAME="Description" CONTENT="IDirect3DRM3::UnregisterClient">
<META NAME="Description" CONTENT="AddSearchPath (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateAnimation (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateAnimationSet (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateClippedVisual (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateDevice (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateDeviceFromClipper (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateDeviceFromD3D (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateDeviceFromSurface (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateFace (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateFrame (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateLight (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateLightRGB (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateMaterial (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateMesh (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateMeshBuilder (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateObject (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateProgressiveMesh (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateShadow (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateTexture (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateTextureFromSurface (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateUserVisual (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateViewport (IDirect3DRM3)">
<META NAME="Description" CONTENT="CreateWrap (IDirect3DRM3)">
<META NAME="Description" CONTENT="EnumerateObjects (IDirect3DRM3)">
<META NAME="Description" CONTENT="GetDevices (IDirect3DRM3)">
<META NAME="Description" CONTENT="GetNamedObject (IDirect3DRM3)">
<META NAME="Description" CONTENT="GetSearchPath (IDirect3DRM3)">
<META NAME="Description" CONTENT="Load (IDirect3DRM3)">
<META NAME="Description" CONTENT="LoadTexture (IDirect3DRM3)">
<META NAME="Description" CONTENT="LoadTextureFromResource (IDirect3DRM3)">
<META NAME="Description" CONTENT="RegisterClient (IDirect3DRM3)">
<META NAME="Description" CONTENT="SetDefaultTextureColors (IDirect3DRM3)">
<META NAME="Description" CONTENT="SetDefaultTextureShades (IDirect3DRM3)">
<META NAME="Description" CONTENT="SetSearchPath (IDirect3DRM3)">
<META NAME="Description" CONTENT="Tick (IDirect3DRM3)">
<META NAME="Description" CONTENT="UnregisterClient (IDirect3DRM3)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetExpandableCaption(pCode, "Show Sample Code", true);
		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDirect3DRM3"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRM3"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/HDRd3drm.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRM3"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="Direct3D Retained Mode Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft Direct3D Retained Mode SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Iface_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Iface_intro.htm">Interfaces</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="Animation2.htm">IDirect3DRMAnimation2</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->


<BLOCKQUOTE CLASS="body">
<!-- CONTENTS_START -->

<H1><A NAME="dx5_IDirect3DRM3_d3drm"></A>IDirect3DRM3</H1>




<P>Applications use the <B>IDirect3DRM3</B> interface to create Direct3DRM3 objects and work with system-level variables. For a history of the Direct3D Retained Mode interfaces, see <a href="../oview/interface_changes.htm">Interface Changes</a>.

<P>The methods of the <A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>, <B>IDirect3DRM2</B>, and <B>IDirect3DRM</B> interfaces create the following objects:
<BLOCKQUOTE>
<UL><LI>Animations and animation sets
 <LI>ClippedVisuals
 <LI>Devices
 <LI>Faces
 <LI>Frames
 <LI>Generic uninitialized objects
 <LI>Lights
 <LI>Materials
 <LI>Meshes and mesh builders
 <LI>Shadows
 <LI>Textures
 <LI>UserVisuals
 <LI>Viewports
 <LI>Wraps
</UL>
</BLOCKQUOTE>

<p>Microsoft DirectX version 6.0 introduces the <B>IDirect3DRM3</B> interface. <B>IDirect3DRM3</B> supports all of the methods provided by the <B>IDirect3DRM2</B> and <B>IDirect3DRM</B> interfaces and replaces these two older interfaces. It adds a flag parameter to <B>IDirect3DRM2</B>'s <a href="#CreateDeviceFromSurface">CreateDeviceFromSurface</a>, and adds <a href="#RegisterClient">RegisterClient</a>, <a href="#UnregisterClient">UnregisterClient</a>, and <a href="#CreateClippedVisual">CreateClippedVisual</a> methods to the methods <B>IDirect3DRM2</B> provides. 
<B>IDirect3DRM3</B> also adds the <a href="#GetOptions">GetOptions</a> and <a href="#SetOptions">SetOptions</a> methods to set and retrieve whether left-handed or right-handed geometry should be used.

<P><B>IDirect3DRM3</B>, like <B>IDirect3DRM2</B>, supports all the methods in <B>IDirect3DRM</B>. It adds the <A HREF="IDirect3DRM3.htm#CreateProgressiveMesh">CreateProgressiveMesh</A> method to the methods <B>IDirect3DRM</B> provides.
 The <A HREF="IDirect3DRM3.htm#CreateDeviceFromSurface">CreateDeviceFromSurface</A>, <A HREF="IDirect3DRM3.htm#CreateDeviceFromD3D">CreateDeviceFromD3D</A>, and <A HREF="IDirect3DRM3.htm#CreateDeviceFromClipper">CreateDeviceFromClipper</A> methods all create a DIRECT3DRMDEVICE2 object with <B>IDirect3DRM2</B> and a DIRECT3DRMDEVICE3 object with <B>IDirect3DRM3</B>. The <A HREF="IDirect3DRM3.htm#CreateViewport">CreateViewport</A> method creates a viewport on a DirectDRMDevice2 object. The <A HREF="IDirect3DRM3.htm#LoadTexture">LoadTexture</A> and <A HREF="IDirect3DRM3.htm#LoadTextureFromResource">LoadTextureFromResource</A> methods load a Direct3DRMTexture2 object with <B>IDirect3DRM2</B> and a Direct3DRMTexture3 object with <B>IDirect3DRM3</B>. 

<P>To access the <B>IDirect3DRM3</B> or <B>IDirect3DRM2</B> Component Object Model (COM) interfaces, create an <B>IDirect3DRM</B> object with <A HREF="Functions.htm#Direct3DRMCreate">Direct3DRMCreate</A>, then query for <B>IDirect3DRM3</B> or <B>IDirect3DRM2</B>, respectively, from <B>IDirect3DRM</B>. You can also access the main Direct3D Retained Mode object directly using <b>CoCreateInstance</b>.

<p>When you create a MeshBuilder object using the <B>IDirect3DRM3</B> interface, the MeshBuilder uses the Immediate Mode <b>DrawPrimitive</b> interface for its implementation.

<p>When you create Lights using the <B>IDirect3DRM3</B> interface, they take advantage of the latest Immediate Mode functionality and use the D3DLIGHT2 structure. 

<P>Applications use the <A HREF="Device3.htm">IDirect3DRMDevice3</A>, <B>IDirect3DRMDevice2</B>, and <B>IDirect3DRMDevice</B> interfaces to interact with the output device. For more information about the capabilities of the output device when you create it using the <B>IDirect3DRM3</B>, <B>IDirect3DRM2</B>, or <B>IDirect3DRM</B> interfaces, see <a href="device3.htm">IDirect3DRMDevice3</a>. For a conceptual overview of output devices, see <A HREF="../oview/OutputDevices_face.htm">Output Devices</A>.

<P>The methods of the <B>IDirect3DRM3</B> interface can be organized into the following groups:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Animation</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateAnimation">CreateAnimation</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateAnimationSet">CreateAnimationSet</A>
 </TD></TR>

<TR><TD></TD><TD></TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Application-specific Data</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#RegisterClient">RegisterClient</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#UnregisterClient">UnregisterClient</A>
 </TD></TR>

 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR>
 <TR><TD ALIGN=LEFT VALIGN=TOP><B>Clipped Visuals</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateClippedVisual">CreateClippedVisual</A>
 </TD></TR>

 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Devices</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateDevice">CreateDevice</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateDeviceFromClipper">CreateDeviceFromClipper</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateDeviceFromD3D">CreateDeviceFromD3D</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateDeviceFromSurface">CreateDeviceFromSurface</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#GetDevices">GetDevices</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Enumeration</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#EnumerateObjects">EnumerateObjects</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Faces</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateFace">CreateFace</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Frames</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateFrame">CreateFrame</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Lights</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateLight">CreateLight</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateLightRGB">CreateLightRGB</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Materials</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateMaterial">CreateMaterial</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Meshes</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateMesh">CreateMesh</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateMeshBuilder">CreateMeshBuilder</A>
 </TD></TR>
 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR>
 <TR><TD ALIGN=LEFT VALIGN=TOP><B>Miscellaneous</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateObject">CreateObject</A>
 </TD></TR>
 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateUserVisual">CreateUserVisual</A>
 </TD></TR>
 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#GetNamedObject">GetNamedObject</A>
 </TD></TR>

 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#GetOptions">GetOptions</A>
 </TD></TR>

 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#Load">Load</A>
 </TD></TR>
 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#SetOptions">SetOptions</A>
 </TD></TR>

 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#Tick">Tick</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Progressive Meshes</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateProgressiveMesh">CreateProgressiveMesh</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Search paths</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#AddSearchPath">AddSearchPath</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#GetSearchPath">GetSearchPath</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#SetSearchPath">SetSearchPath</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Shadows</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateShadow">CreateShadow</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Textures</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateTexture">CreateTexture</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateTextureFromSurface">CreateTextureFromSurface</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#LoadTexture">LoadTexture</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#LoadTextureFromResource">LoadTextureFromResource</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#SetDefaultTextureColors">SetDefaultTextureColors</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#SetDefaultTextureShades">SetDefaultTextureShades</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Viewports</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateViewport">CreateViewport</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Wraps</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="IDirect3DRM3.htm#CreateWrap">CreateWrap</A>
</TD></TR></TABLE>
<P>The <B>IDirect3DRM3</B> interface, like all COM interfaces, inherits the <A HREF="FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interface methods. The <A HREF="FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interface supports the following three methods:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__AddRef">AddRef</A>
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__QueryInter">QueryInterface</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__Release">Release</A>
</TD></TR></TABLE>

<H1><A NAME="AddSearchPath">IDirect3DRM3::AddSearchPath</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Adds a list of directories to the end of the current file search path. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>AddSearchPath</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCSTR</B> <I>lpPath</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpPath</I>
</DT><DD>Address of a null-terminated string specifying the path to add to the current search path.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>For Microsoft&#174; Windows&#174;, the path should be a list of directories separated by semicolons (;). 
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="IDirect3DRM3.htm#SetSearchPath">IDirect3DRM3::SetSearchPath</A>
</BLOCKQUOTE>
<H1><A NAME="CreateAnimation">IDirect3DRM3::CreateAnimation</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates an empty Direct3DRMAnimation object.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateAnimation</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMANIMATION2</B> <B>*</B> <I>lplpD3DRMAnimation</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplpD3DRMAnimation</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Animation2.htm">IDirect3DRMAnimation2</A> interface if the call succeeds.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="CreateAnimationSet">IDirect3DRM3::CreateAnimationSet</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates an empty Direct3DRMAnimationSet object.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateAnimationSet</B> <B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMANIMATIONSET2</B> <B>*</B> <I>lplpD3DRMAnimationSet</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplpD3DRMAnimationSet</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="AnimationSet2.htm">IDirect3DRMAnimationSet2</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>




<H1><A NAME="CreateClippedVisual">IDirect3DRM3::CreateClippedVisual</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a clipped visual object.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><b>HRESULT CreateClippedVisual(
  LPDIRECT3DRMVISUAL</b> <i>lpVisual</i><b>,
  LPDIRECT3DRMCLIPPEDVISUAL *</b> <i>lpClippedVisual</i><b>);</b></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>lpVisual</I></DT>
<DD>Pointer to a visual object, such as a meshbuilder object.</DD>
<DT><I>lpClippedVisual</I></DT>
<DD>Pointer to receive the created <a href="clippedvisual.htm">IDirect3DRMClippedVisual</a> clipped visual object.</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0. 
</BLOCKQUOTE>


<H1><A NAME="CreateDevice">IDirect3DRM3::CreateDevice</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Not implemented on the Windows platform.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateDevice</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwWidth</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwHeight</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMDEVICE3*</B> <I>lplpD3DRMDevice</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE></BLOCKQUOTE>

<H1><A NAME="CreateDeviceFromClipper">IDirect3DRM3::CreateDeviceFromClipper</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a Direct3D Retained Mode Windows device by using a specified DirectDrawClipper object. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateDeviceFromClipper</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTDRAWCLIPPER</B> <I>lpDDClipper</I><B>,</B><BR>&nbsp;&nbsp;<B>LPGUID</B> <I>lpGUID</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>width</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>height</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMDEVICE3</B> <B>*</B> <I>lplpD3DRMDevice</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpDDClipper</I>
 </DT><DD>Address of a DirectDrawClipper object.
</DD><DT><I>lpGUID</I>
 </DT><DD>Address of a globally unique identifier (GUID). This parameter can be NULL.
</DD><DT><I>width</I> and <I>height</I>
 </DT><DD>Width and height of the device to be created.
</DD><DT><I>lplpD3DRMDevice</I>
 </DT><DD>Address that will be filled with a pointer to an <A HREF="Device3.htm">IDirect3DRMDevice3</A> interface if the call succeeds.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If the <I>lpGUID</I> parameter is NULL, the system searches for a device with a default set of device capabilities. This is the recommended way to create a Retained Mode device because it always works, even if the user installs new hardware. 
<P>The system describes the default settings by using the following flags from the <A HREF="FurtherReading.htm#D3DPRIMCAPS">D3DPRIMCAPS</A> structure in internal device-enumeration calls:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#D3DPSHADECAPS_ALPHAF">D3DPSHADECAPS_ALPHAFLATSTIPPLED</A>
</TD></tr><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#D3DPTBLENDCAPS_COPY">D3DPTBLENDCAPS_COPY</A> | <A HREF="FurtherReading.htm#D3DPTBLENDCAPS_MODUL">D3DPTBLENDCAPS_MODULATE</A>
</TD></tr><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#D3DPMISCCAPS_CULLCCW">D3DPMISCCAPS_CULLCCW</A>
</TD></tr><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#D3DPRASTERCAPS_FOGVE">D3DPRASTERCAPS_FOGVERTEX</A>
</TD></tr><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#D3DPCMPCAPS_LESSEQUA">D3DPCMPCAPS_LESSEQUAL</A>
</TD></tr><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#D3DPTFILTERCAPS_NEAR">D3DPTFILTERCAPS_NEAREST</A>
</TD></tr><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#D3DPTEXTURECAPS_PERS">D3DPTEXTURECAPS_PERSPECTIVE</A> | <A HREF="FurtherReading.htm#D3DPTEXTURECAPS_TRAN">D3DPTEXTURECAPS_TRANSPARENCY</A>
</TD></tr><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#D3DPTADDRESSCAPS_WRA">D3DPTADDRESSCAPS_WRAP</A>
</TD></tr></TABLE>
<P>If a hardware device is not found, the monochromatic (ramp) software driver is loaded. An application should enumerate devices instead of specifying NULL in the <I>lpGUID</I> parameter if it has special needs that are not met by this list of default settings.

<p>For more information about devices, see <a href="../oview/outputdevices_face.htm">Output Devices</a> and <a href="device3.htm">IDirect3DRMDevice3</a>.
</BLOCKQUOTE>

<H1><A NAME="CreateDeviceFromD3D">IDirect3DRM3::CreateDeviceFromD3D</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a Direct3D Retained Mode Windows device by using specified Direct3D objects. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateDeviceFromD3D</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3D2</B> <I>lpD3D</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DDEVICE2</B> <I>lpD3DDev</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMDEVICE3</B> <B>*</B> <I>lplpD3DRMDevice</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpD3D</I>
</DT><DD>Pointer to an instance of a Direct3D Immediate Mode <B>Direct3D2</B> object.
</DD><DT><I>lpD3DDev</I>
</DT><DD>Pointer to a Direct3D Immediate Mode <B>Direct3DDevice2</B> object.
</DD><DT><I>lplpD3DRMDevice</I>
 </DT><DD>Address that will be filled with a pointer to an <A HREF="Device3.htm">IDirect3DRMDevice3</A> interface if the call succeeds.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>For more information about devices, see <a href="../oview/outputdevices_face.htm">Output Devices</a> and <a href="device3.htm">IDirect3DRMDevice3</a>.
</BLOCKQUOTE>



<H1><A NAME="CreateDeviceFromSurface">IDirect3DRM3::CreateDeviceFromSurface</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a Direct3D Retained Mode Windows device for rendering from the specified DirectDraw surfaces. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT CreateDeviceFromSurface(  
  LPGUID</B> <I>lpGUID</I><B>,
  LPDIRECTDRAW </B><I>lpDD</I><B>,
  LPDIRECTDRAWSURFACE</B> <I>lpDDSBack</I><B>,
  DWORD </B><I>dwFlags</I><B>,
  LPDIRECT3DRMDEVICE3*</B> <I>lplpD3DRMDevice</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpGUID</I>
</DT><DD>Address of the globally unique identifier (GUID) used as the required device driver. If this parameter is NULL, the default device driver is used.
</DD><DT><I>lpDD</I>
</DT><DD>Address of the DirectDraw object that is the source of the DirectDraw surface.
</DD><DT><I>lpDDSBack</I>
</DT><DD>Address of the <b>DirectDrawSurface</b> object that represents the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_B.htm#back_buffer')">back buffer</A>.
<DT><I>dwFlags</I></DT> 
<DD>The only currently defined flag is:</DD>
    <DL>
    <DT><A NAME="D3DRMDEVICE_NOZBUFFER" IDX_CONCEPT="D3DRMDEVICE_NOZBUFFER">D3DRMDEVICE_NOZBUFFER</A></DT>
    <DD>Indicates that if the <I>lpDDSBack</I> parameter has no z-buffer attached, no z-buffer is to be created.
	  By default, a z-buffer will be created.</DD>
    </DL>

</DD><DT><I>lplpD3DRMDevice</I>
 </DT><DD>Address that will be filled with a pointer to an <A HREF="Device3.htm">IDirect3DRMDevice3</A> interface if the call succeeds.
</DD></DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_OUTOFMEMORY">DDERR_OUTOFMEMORY</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0. This method adds the <I>dwFlags</I> parameter to the older <b>IDirect3DRM2::CreateDeviceFromSurface</b> method which it replaces. 
<p>For more information about devices, see <a href="../oview/outputdevices_face.htm">Output Devices</a> and <a href="device3.htm">IDirect3DRMDevice3</a>.
</BLOCKQUOTE>


<H1><A NAME="CreateFace">IDirect3DRM3::CreateFace</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates an instance of the <A HREF="Face2.htm">IDirect3DRMFace2</A> interface.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateFace</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDirect3DRMFace2</B> <B>*</B> <I>lplpd3drmFace2</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplpd3drmFace2</I>
 </DT><DD>Address that will be filled with a pointer to an <A HREF="Face2.htm">IDirect3DRMFace2</A> interface if the call succeeds.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="CreateFrame">IDirect3DRM3::CreateFrame</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a new child frame of the given parent frame. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMFRAME3</B> <I>lpD3DRMFrame</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMFRAME3*</B> <I>lplpD3DRMFrame</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpD3DRMFrame</I>
</DT><DD>Address of a <A HREF="Frame3Oview.htm">IDirect3DRMFrame3</A> object that is to be the parent of the new frame.
</DD><DT><I>lplpD3DRMFrame</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Frame3Oview.htm">IDirect3DRMFrame3</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The child frame inherits the motion attributes of its parent. For example, if the parent is moving with a given velocity, the child frame will also move with that velocity. Furthermore, if the parent is set rotating, the child frame will rotate about the origin of the parent. Frames that have no parent are called scenes. To create a scene, specify NULL as the parent. An application can create a frame with no parent and then associate it with a parent frame later by using the <A HREF="Frame3AtoM.htm#AddChild">IDirect3DRMFrame3::AddChild</A> method.

<p>If an application calls <a href="#SetOptions">IDirect3DRM3::SetOptions</a> to set right-handed geometry, the default axes for <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_r.htm#root_frame')">root frames</A> (frames with NULL as the parent) becomes v = (0, 0, -1) and u = (0, 1, 0). Therefore <a href="frame3atom.htm#GetOrientation">IDirect3DRMFrame3::GetOrientation</a> and <a href="frame3ntoz.htm#SetOrientation">IDirect3DRMFrame3::SetOrientation</a> work correctly in right-handed mode.
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Frame3AtoM.htm#AddChild">IDirect3DRMFrame3::AddChild</A>
</BLOCKQUOTE>

<H1><A NAME="CreateLight">IDirect3DRM3::CreateLight</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a new light source with the given type and color. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateLight</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMLIGHTTYPE</B> <I>d3drmltLightType</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DCOLOR</B> <I>cColor</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMLIGHT*</B> <I>lplpD3DRMLight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>d3drmltLightType</I>
</DT><DD>One of the lighting types given in the <A HREF="Enums.htm#D3DRMLIGHTTYPE">D3DRMLIGHTTYPE</A> enumerated type.
</DD><DT><I>cColor</I>
</DT><DD>Color of the light.
</DD><DT><I>lplpD3DRMLight</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Light.htm">IDirect3DRMLight</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<H1><A NAME="CreateLightRGB">IDirect3DRM3::CreateLightRGB</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a new light source with the given type and color. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateLightRGB</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMLIGHTTYPE</B> <I>ltLightType</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>vRed</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>vGreen</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>vBlue</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMLIGHT*</B> <I>lplpD3DRMLight</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>ltLightType</I>
</DT><DD>One of the lighting types given in the <A HREF="Enums.htm#D3DRMLIGHTTYPE">D3DRMLIGHTTYPE</A> enumerated type.
</DD><DT><I>vRed, vGreen,</I> and <I>vBlue</I>
</DT><DD>Color of the light. Each component of the color should be in the range 0.0 to 1.0.
</DD><DT><I>lplpD3DRMLight</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Light.htm">IDirect3DRMLight</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<p>The following code fragment calls <b>CreateLightRGB</b> to create a bright <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_d.htm#directional')">directional</A> light. It assumes the Direct3D Retained Mode object has already been created using the <a href="functions.htm#Direct3DRMCreate">Direct3DRMCreate</a> function.
<pre>
LPDIRECT3DRM3 lpD3DRM;
LPDIRECT3DRMLIGHT light;

if (FAILED(lpD3DRM->CreateLightRGB(D3DRMLIGHT_DIRECTIONAL,
                                   D3DVAL(0.9), D3DVAL(0.9), D3DVAL(0.9),
                                   &light))
{
    // error
}
</pre>
</BLOCKQUOTE>

<H1><A NAME="CreateMaterial">IDirect3DRM3::CreateMaterial</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a material with the given <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_s.htm#specular_property')">specular property</A>.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateMaterial</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>vPower</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMMATERIAL2</B> <B>*</B> <I>lplpD3DRMMaterial</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>vPower</I>
</DT><DD>Sharpness of the reflected highlights, with a value of 5 giving a metallic look and higher values giving a more plastic look to the rendered surface.
</DD><DT><I>lplpD3DRMMaterial</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Material2.htm">IDirect3DRMMaterial2</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="CreateMesh">IDirect3DRM3::CreateMesh</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a new mesh object with no faces. The mesh is not visible until it is added to a frame.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateMesh</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMMESH*</B> <I>lplpD3DRMMesh</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplpD3DRMMesh</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Mesh.htm">IDirect3DRMMesh</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="CreateMeshBuilder">IDirect3DRM3::CreateMeshBuilder</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a new mesh builder object.  
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateMeshBuilder</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMMESHBUILDER3 *</B> <I>lplpD3DRMMeshBuilder3</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplpD3DRMMeshBuilder3</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="MeshBuilder3.htm">IDirect3DRMMeshBuilder3</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
By default, perspective correction is <b>on</B>.
</BLOCKQUOTE>


<H1><A NAME="CreateObject">IDirect3DRM3::CreateObject</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a new object without initializing the object.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateObject</B><B>(</B><BR>&nbsp;&nbsp;<B>REFCLSID</B> <I>rclsid</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnkOuter</I><B>,</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <B>FAR*</B> <I>ppv</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rclsid</I>
</DT><DD>Class identifier for the new object.
</DD><DT><I>pUnkOuter</I>
</DT><DD>Pointer to the outer <B>IUnknown</B> that allows COM aggregation features.
</DD><DT><I>riid</I>
</DT><DD>Interface identifier of the object to be created.
</DD><DT><I>ppv</I>
</DT><DD>Address of a pointer to the object when the method returns.
<P>
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>An application that uses this method must initialize the object that has been created. (The other creation methods of the <A HREF="IDirect3DRM3.htm">IDirect3DRM3</A> interface initialize the object automatically.) In some cases, for example, for Direct3DRMViewport2 objects, you can use the <B>Init</B> method for that object. An application should use the <B>Init</B> method only once to initialize any given object.
<P>Applications can use this method to implement aggregation in Direct3DRM objects.
</BLOCKQUOTE>
<H1><A NAME="CreateProgressiveMesh">IDirect3DRM3::CreateProgressiveMesh</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a new progressive mesh object with no faces. The mesh is not visible until it is added to a frame.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateProgressiveMesh</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMPROGRESSIVEMESH*</B> <I>lplpD3DRMProgressiveMesh</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplpD3DRMProgressiveMesh</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="ProgressiveMesh.htm">IDirect3DRMProgressiveMesh</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="CreateShadow">IDirect3DRM3::CreateShadow</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a shadow by using the specified visual and light, projecting the shadow onto the specified plane. The shadow is a visual that should be added to the frame that contains the visual.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateShadow</B><B>(</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMLIGHT</B> <I>lpLight</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>px</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>py</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>pz</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>nx</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>ny</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>nz</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMSHADOW2</B> <B>*</B> <I>lplpShadow</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pUnk</I>
</DT><DD>Pointer to the object casting the shadow.
</DD><DT><I>lpLight</I>
</DT><DD>Address of the <A HREF="Light.htm">IDirect3DRMLight</A> interface that is the light source.
</DD><DT><I>px, py,</I> and <I>pz</I>
</DT><DD>Plane that the shadow is to be projected on.
</DD><DT><I>nx, ny,</I> and <I>nz</I>
</DT><DD>Normal to the plane that the shadow is to be projected on.
</DD><DT><I>lplpShadow</I>
</DT><DD>Address of a pointer to be initialized with a valid pointer to the shadow visual, if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="CreateTexture">IDirect3DRM3::CreateTexture</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a texture from an image in memory. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateTexture</B><B>(</B><BR>&nbsp;&nbsp;<B>LPD3DRMIMAGE</B> <I>lpImage</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMTEXTURE3*</B> <I>lplpD3DRMTexture3</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpImage</I>
</DT><DD>Address of a <A HREF="Structs.htm#D3DRMIMAGE">D3DRMIMAGE</A> structure describing the source for the texture.
</DD><DT><I>lplpD3DRMTexture3</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Texture3.htm">IDirect3DRMTexture3</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The memory associated with the image is used each time the texture is rendered, rather than the memory being copied into Direct3D Retained Mode's buffers. This allows the image to be used both as a rendering target and as a texture.
</BLOCKQUOTE>
<H1><A NAME="CreateTextureFromSurface">IDirect3DRM3::CreateTextureFromSurface</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a texture from a specified DirectDraw surface.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateTextureFromSurface</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTDRAWSURFACE</B> <I>lpDDS</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMTEXTURE3</B> <B>*</B> <I>lplpD3DRMTexture3</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpDDS</I>
</DT><DD>Address of the DirectDrawSurface object containing the texture.
</DD><DT><I>lplpD3DRMTexture3</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Texture3.htm">IDirect3DRMTexture3</A> interface if the call succeeds.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>

<p>When you create a texture from a DirectDraw surface, it is best to create the surface in system memory. This enables optimal performance for software devices and allows D3DRM to manage the use of video memory more effectively for hardware devices.
</BLOCKQUOTE>
<H1><A NAME="CreateUserVisual">IDirect3DRM3::CreateUserVisual</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates an application-defined visual object, which can then be added to a scene and rendered by using an application-defined handler.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateUserVisual</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMUSERVISUALCALLBACK</B> <I>fn</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMUSERVISUAL</B> <B>*</B> <I>lplpD3DRMUV</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>fn</I>
</DT><DD>Application-defined <A HREF="Callbacks.htm#D3DRMUSERVISUALCALLBACK">D3DRMUSERVISUALCALLBACK</A> callback function.
<P>
</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to the callback function.
</DD><DT><I>lplpD3DRMUV</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="UserVisual.htm">IDirect3DRMUserVisual</A> interface if the call succeeds.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Should return D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="UserVisual.htm#Init">IDirect3DRMUserVisual::Init</A>
</BLOCKQUOTE>

<H1><A NAME="CreateViewport">IDirect3DRM3::CreateViewport</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a viewport on a device with device coordinates (<I>dwXPos</I>, <I>dwYPos</I>) to (<I>dwXPos</I> + <I>dwWidth</I>, <I>dwYPos</I> + <I>dwHeight</I>). 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateViewport</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMDEVICE3</B> <I>lpDev</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMFRAME3</B> <I>lpCamera</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwXPos</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwYPos</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwWidth</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwHeight</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMVIEWPORT2*</B> <I>lplpD3DRMViewport</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpDev</I>
</DT><DD>Address of a <a href="device3.htm">IDirect3DRMDevice3</a> device on which the viewport is to be created.
</DD><DT><I>lpCamera</I>
</DT><DD>Address of a frame that describes the position and direction of the view.
</DD><DT><I>dwXPos</I>, <I>dwYPos</I>, <I>dwWidth</I>, and <I>dwHeight</I>
</DT><DD>Position and size of the viewport, in device coordinates. The viewport size cannot be larger than the physical device or the method will fail. 
</DD><DT><I>lplpD3DRMViewport</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Viewport2.htm">IDirect3DRMViewport2</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. If the viewport size is larger than the physical device, returns D3DRMERR_BADVALUE. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The viewport displays objects in the scene that contains the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_c.htm#camera')">camera</A>, with the view direction and up vector taken from the camera. The viewport size cannot be larger than the physical device.
<P>For more information about devices, see <a href="../oview/outputdevices_face.htm">Output Devices</a> and <a href="device3.htm">IDirect3DRMDevice3</a>.
</BLOCKQUOTE>

<H1><A NAME="CreateWrap">IDirect3DRM3::CreateWrap</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Creates a wrapping function that can be used to assign texture coordinates to faces and meshes. The vector [<I>ox oy oz</I>] gives the origin of the wrap, [<I>dx dy dz</I>] gives its z-axis, and [<I>ux uy uz</I>] gives its y-axis. The 2-D vectors [<I>ou ov</I>] and [<I>su sv</I>] give an origin and scale factor in the texture applied to the result of the wrapping function.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>CreateWrap</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMWRAPTYPE</B> <I>type</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMFRAME3</B> <I>lpRef</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>ox</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>oy</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>oz</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>dx</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>dy</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>dz</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>ux</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>uy</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>uz</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>ou</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>ov</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>su</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>sv</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMWRAP*</B> <I>lplpD3DRMWrap</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>type</I>
</DT><DD>One of the members of the <A HREF="Enums.htm#D3DRMWRAPTYPE">D3DRMWRAPTYPE</A> enumerated type.
</DD><DT><I>lpRef</I>
</DT><DD>Reference frame for the wrap.
</DD><DT><I>ox, oy,</I> and <I>oz</I>
</DT><DD>Origin of the wrap.
</DD><DT><I>dx, dy,</I> and <I>dz</I>
</DT><DD>The z-axis of the wrap.
</DD><DT><I>ux, uy,</I> and <I>uz</I>
</DT><DD>The y-axis of the wrap.
</DD><DT><I>ou</I> and <I>ov</I>
</DT><DD>Origin in the texture.
</DD><DT><I>su</I> and <I>sv</I>
</DT><DD>Scale factor in the texture.
</DD><DT><I>lplpD3DRMWrap</I>
</DT><DD>Address that will be filled with a pointer to an <A HREF="Wrap.htm">IDirect3DRMWrap</A> interface if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Wrap.htm">IDirect3DRMWrap</A></BLOCKQUOTE>
<H1><A NAME="EnumerateObjects">IDirect3DRM3::EnumerateObjects</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Uses the callback function specified by the <I>func</I> parameter on each of the active Direct3DRM objects.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>EnumerateObjects</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMOBJECTCALLBACK</B> <I>func</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>func</I>
</DT><DD>Application-defined <A HREF="Callbacks.htm#D3DRMOBJECTCALLBACK">D3DRMOBJECTCALLBACK</A> callback function to be used with each Direct3DRMObject object and the application-defined argument.
</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to the callback function.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="GetDevices">IDirect3DRM3::GetDevices</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Returns all the Direct3DRM devices that have been created in the system.
<P>
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>GetDevices</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMDEVICEARRAY*</B> <I>lplpDevArray</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lplpDevArray</I>
</DT><DD>Address of a pointer that will be filled with the resulting array of Direct3DRM devices. For information about the Direct3DRMDeviceArray object, see the <A HREF="DeviceArray.htm#IDirect3DRMDeviceArray">IDirect3DRMDeviceArray</A> interface.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="GetNamedObject">IDirect3DRM3::GetNamedObject</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Finds a Direct3DRMObject given the Direct3DRMObject name.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>GetNamedObject</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>char</B> <B>*</B> <I>lpName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMOBJECT*</B> <I>lplpD3DRMObject</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpName</I>
</DT><DD>Name of the object to be searched for.
</DD><DT><I>lplpD3DRMObject</I>
</DT><DD>Address of a pointer to be initialized with a valid Direct3DRMObject pointer if the call succeeds.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If the system does not find an object with the name specified in the <I>lpName</I> parameter, this method returns D3DRM_OK but the <I>lplpD3DRMObject</I> parameter is NULL.
</BLOCKQUOTE>





<H1><A NAME="GetOptions">IDirect3DRM3::GetOptions</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Retrieves whether Direct3D Retained Mode uses left-handed or right-handed geometry.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><b>HRESULT GetOptions(
  LPDWORD</b> <i>lpdwOptions</i><b>);</b></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>lpdwOptions</I></DT>
<DD>
Pointer to a flag value that indicates the current Direct3D Retained Mode options. Currently defined flags are:
<DL>
<DT><b>D3DRMOPTIONS_LEFTHANDED</b></DT>
<DD>Use left-handed geometry. This value is the default.</DD>
<DT><b>D3DRMOPTIONS_RIGHTHANDED</b></DT>
<DD>Use right-handed geometry.</DD>
</DL>
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P><b>D3DRMOPTIONS_LEFTHANDED</b> and <b>D3DRMOPTIONS_RIGHTHANDED</b> affect the following objects as well as picking and ray picking.
<ul>
<li><a href="clippedvisual.htm">IDirect3DRMClippedVisual</a>
<li><a href="mesh.htm">IDirect3DRMMesh</a>
<li><a href="meshbuilder3.htm">IDirect3DRMMeshBuilder3</a>
<li><a href="progressivemesh.htm">IDirect3DRMProgressiveMesh</a>
<li><a href="shadow2.htm">IDirect3DRMShadow2</a>
<li><a href="texture3.htm">IDirect3DRMTexture3</a>
<li><a href="viewport2.htm">IDirect3DRMViewport2</a>
</ul>

<p>This method was introduced in DirectX version 6.0.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><a href="../oview/techbackgrnd.htm#rmmath_Direct3D_Coor">Direct3D Coordinate System</A>
<p><a href="#SetOptions">IDirect3DRM3::SetOptions</a>
</BLOCKQUOTE>


<H1><A NAME="GetSearchPath">IDirect3DRM3::GetSearchPath</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Returns the current search path. For Windows, the path is a list of directories separated by semicolons (;). 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>GetSearchPath</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <B>*</B> <I>lpdwSize</I><B>,</B><BR>&nbsp;&nbsp;<B>LPSTR</B> <I>lpszPath</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpdwSize</I>
</DT><DD>Pointer to a DWORD. Should contain the length of <I>lpszPath</I> when <B>GetSearchPath</B> is used. On return, contains the length of the string in <I>lpszPath</I> containing the current search path. This parameter cannot be NULL.
</DD><DT><I>lpszPath</I>
</DT><DD>A pointer to a null-terminated string specifying the search path. If <I>lpszPath</I> equals NULL when <B>GetSearchPath</B> is used, the method returns the length of the current string in the location pointed to by the <I>lpdwSize</I> parameter.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="IDirect3DRM3.htm#SetSearchPath">IDirect3DRM3::SetSearchPath</A>
</BLOCKQUOTE>
<H1><A NAME="Load">IDirect3DRM3::Load</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Loads an object. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>Load</B><B>(</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpvObjSource</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpvObjID</I><B>,</B><BR>&nbsp;&nbsp;<B>LPIID</B> <B>*</B> <I>lplpGUIDs</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwcGUIDs</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DRMLOADOPTIONS</B> <I>d3drmLOFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DRMLOADCALLBACK</B> <I>d3drmLoadProc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArgLP</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DRMLOADTEXTURE3CALLBACK</B> <I>d3drmLoadTextureProc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArgLTP</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMFRAME3</B> <I>lpParentFrame</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpvObjSource</I>
 </DT><DD>Source for the object to be loaded. This source can be a file, resource, memory block, or stream, depending on the source flags specified in the <I>d3drmLOFlags</I> parameter.
</DD><DT><I>lpvObjID</I>
 </DT><DD>Object name or position to be loaded. The use of this parameter depends on the identifier flags specified in the <I>d3drmLOFlags</I> parameter. If the D3DRMLOAD_BYPOSITION flag is specified, this parameter is a pointer to a <B>DWORD</B> value that gives the object's order in the file. This parameter can be NULL.
</DD><DT><I>lplpGUIDs</I>
 </DT><DD>Address of an array of interface identifiers to be loaded. For example, if this parameter is a two-element array containing IID_IDirect3DRMMeshBuilder3 and IID_IDirect3DRMAnimationSet2, this method loads all the animation sets and mesh-builder objects. Possible GUIDs must be one or more of the following: IID_IDirect3DRMProgressiveMesh, IID_IDirect3DRMMeshBuilder3, IID_IDirect3DRMAnimationSet2, IID_IDirect3DRMAnimation2, and IID_IDirect3DRMFrame3.
</DD><DT><I>dwcGUIDs</I>
 </DT><DD>Number of elements specified in the <I>lplpGUIDs</I> parameter.
</DD><DT><I>d3drmLOFlags</I>
 </DT><DD>Value of the <A HREF="Constants.htm#D3DRMLOADOPTIONS">D3DRMLOADOPTIONS</A> type describing the load options.
</DD><DT><I>d3drmLoadProc</I>
 </DT><DD>A <A HREF="Callbacks.htm#D3DRMLOADTEXTURE3CALLBACK">D3DRMLOAD3CALLBACK</A> callback function used when the system reads the specified object. 
</DD><DT><I>lpArgLP</I>
 </DT><DD>Address of application-defined data passed to the <A HREF="Callbacks.htm#D3DRMLOADCALLBACK">D3DRMLOADCALLBACK</A> callback function.
</DD><DT><I>d3drmLoadTextureProc</I>
 </DT><DD>A <A HREF="Callbacks.htm#D3DRMLOADTEXTURE3CALLBACK">D3DRMLOADTEXTURE3CALLBACK</A> callback function used to load any textures used by an object that require special formatting. This parameter can be NULL.
</DD><DT><I>lpArgLTP</I>
 </DT><DD>Address of application-defined data passed to the <A HREF="Callbacks.htm#D3DRMLOADTEXTURE3CALLBACK">D3DRMLOADTEXTURE3CALLBACK</A> callback function.
</DD><DT><I>lpParentFrame</I>
 </DT><DD>Address of a parent Direct3DRMFrame object. This argument only affects the loading of animation sets. When an animation that is loaded from an .x file references an unparented frame in the .x file, the unparented frame's parent is set to the parent frame at <I>lpParentFrame</I>.

 However, if you use <B>Load</B> to load any frames in the .x file, the parent frame at <I>lpParentFrame</I> will not be used as the parent frame for frames in the .x file with no parent. That is, <I>lpParentFrame</I> is used only when you load animation sets. This value of <I>lpParentFrame</I> can be NULL.
<P>
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
By default, perspective correction is <b>on</B>.
</BLOCKQUOTE>

<BLOCKQUOTE>
<P>This method allows great flexibility in loading objects from Microsoft&#174; DirectX&#174; files. Here is an example of how to use it:




 
<P><A ID=pCode CHILD=divCode onclick="ToggleSample(preCode, 'AddNamedItem' )">Sample Code</A></P>
<DIV ID="divCode" CLASS=collapsed>

<PRE ID="preCode">#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;
#include &lt;initguid.h&gt;
#include &lt;d3drm.h&gt;

LPDIRECT3DRM d3dApi;

int totalMesh = 0, totalAnim = 0, totalFrames = 0;

HRESULT loadTexture(LPSTR name, LPVOID lpArg, LPDIRECT3DRMTEXTURE *tex)
{
&#009;return d3dApi-&gt;lpVtbl-&gt;LoadTexture(d3dApi, name, tex);
}

void loadCallback(LPDIRECT3DRMOBJECT lpObject, REFIID objGuid, LPVOID lpArg)
{
&#009;if (IsEqualIID(objGuid, &amp;IID_IDirect3DRMFrame3)) {
&#009;&#009;totalFrames ++;
&#009;&#009;return;
&#009;}

&#009;if (IsEqualIID(objGuid, &amp;IID_IDirect3DRMAnimationSet2)) {
&#009;&#009;totalAnim ++;
&#009;&#009;return;
&#009;}

&#009;if (IsEqualIID(objGuid, &amp;IID_IDirect3DRMMeshBuilder)) {
&#009;&#009;totalMesh ++;
&#009;&#009;return;
&#009;}

&#009;return;
}


BOOL loadObjects(LPSTR filename)
{
&#009;LPGUID guids[] = { (LPGUID)&amp;IID_IDirect3DRMMeshBuilder,
&#009;&#009;(LPGUID)&amp;IID_IDirect3DRMAnimationSet2,
&#009;&#009;(LPGUID)&amp;IID_IDirect3DRMFrame3 };

&#009;/* Tell the loader which objects you're interested in */

&#009;if (FAILED(d3dApi-&gt;lpVtbl-&gt;Load(d3dApi, filename, NULL, 
&#009;&#009;&#009;guids, 3, D3DRMLOAD_FROMFILE,
&#009;&#009;&#009;loadCallback, NULL, loadTexture, NULL, NULL)))
&#009;&#009;return FALSE;

&#009;printf("Total Frames loaded = %d\n", totalFrames);
&#009;printf("Total Animation Sets loaded = %d\n", totalAnim);
&#009;printf("Total Meshbuilders loaded = %d\n", totalMesh);

&#009;return TRUE;
}

int main(int argc, char **argv)
{

&#009;if (FAILED(Direct3DRMCreate(&amp;d3dApi)))
&#009;&#009;return FALSE;

&#009;if (argc != 2) {
&#009;&#009;fprintf(stderr, "usage: %s filename\n", argv[0]);
&#009;&#009;return FALSE;
&#009;}

&#009;if (!loadObjects(argv[1])) return FALSE;
&#009;
  return(0);
}</PRE>
</DIV>
</BLOCKQUOTE>

<H1><A NAME="LoadTexture">IDirect3DRM3::LoadTexture</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Loads a Direct3DRMTexture2 texture from the specified file. This texture can have 8, 24, or 32 bits-per-pixel, and it should be in either the Windows bitmap (.bmp) or Portable Pixmap (.ppm) P6 format. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>LoadTexture</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>char</B> <B>*</B> <I>lpFileName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMTEXTURE3*</B> <I>lplpD3DRMTexture</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpFileName</I>
</DT><DD>Address of the name of the required .bmp or .ppm file.
</DD><DT><I>lplpD3DRMTexture</I>
</DT><DD>Address of a pointer to be initialized with a valid <A HREF="Texture3.htm">IDirect3DRMTexture3</A> pointer if the call succeeds.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P><B>LoadTexture</B> checks whether the texture is in BMP or PPM format, which are the formats it can load. If you want to load other formats, you can add code to the callback to load the image into a <A HREF="Structs.htm#D3DRMIMAGE">D3DRMIMAGE</A> structure and then use <A HREF="IDirect3DRM3.htm#CreateTexture">IDirect3DRM3::CreateTexture</A>.
<P>If you write your own texture callback, the <B>LoadTexture</B> call in the texture callback does not take a reference to the texture. For example:
<PRE>HRESULT loadTextures(char *name, void *arg, LPDIRECT3DRMTEXTURE2 *tex)
{
    return lpD3DRM2-&gt;LoadTexture(name, tex);
}
</PRE>
<P>In this sample, no reference is taken for <I>tex</I>. If you want to keep a reference to each texture loaded by your texture callback, you should <B>AddRef</B> the texture. For example:

<PRE>LPDIRECT3DRMTEXTURE2 *texarray;

HRESULT loadTextures(char *name, void *arg, LPDIRECT3DRMTEXTURE2 *tex)
{
&#009;if (FAILED(lpD3DRM2-&gt;LoadTexture(name, tex)) {
&#009;&#009;return NULL;
&#009;}

&#009;texArray[current++] = tex;
&#009;tex-&gt;AddRef();

&#009;return tex;
}
</PRE>
</BLOCKQUOTE>
<H1><A NAME="LoadTextureFromResource">IDirect3DRM3::LoadTextureFromResource</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Loads a Direct3DRMTexture2 texture from a specified resource.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>LoadTextureFromResource</B><B>(</B><BR>&nbsp;&nbsp;<B>HMODULE</B> <I>hModule</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCTSTR</B> <I>strName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCTSTR</B> <I>strType</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMTEXTURE3</B> <B>*</B> <I>lplpD3DRMTexture</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>hModule</I>
</DT><DD>Handle of the module whose executable file contains the resource.
</DD><DT><I>strName</I>
</DT><DD>A null-terminated string specifying the name of the resource to be used as the texture. 
</DD><DT><I>strType</I>
</DT><DD>A null-terminated string specifying the type name of the resource. This parameter can be one of the following resource types or a user-defined type: 
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Value </B></TD>
<TD ALIGN=LEFT VALIGN=TOP><B>Meaning
</B></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP>RT_BITMAP </TD>
<TD ALIGN=LEFT VALIGN=TOP>Bitmap reource 
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP>RT_RCDATA </TD>
<TD ALIGN=LEFT VALIGN=TOP>Application-defined resource (raw data) 
</TD>
</TR>
</TABLE>
</DD><DT><I>lplpD3DRMTexture</I>
</DT><DD>Address of a pointer to be initialized with a valid <A HREF="Texture3.htm">IDirect3DRMTexture3</A> object if the call succeeds.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>




<H1><a name="RegisterClient">IDirect3DRM3::RegisterClient</a><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Registers a client (application) with which data can be associated.



<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT RegisterClient(  
  REFGUID</B> <I>rguid</I><B>,
  LPDWORD</B> <I>lpdwID</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>rguid</I></DT>
<DD>Reference to a GUID that represents the application.</DD>
<DT><I>lpdwID</I></DT>
<DD>Address that receives a unique ID that the application can use with <A HREF="Object2.htm#SetClientData">IDirect3DRMObject2::SetClientData</A> and <A HREF="Object2.htm#GetClientData">IDirect3DRMObject2::GetClientData</A> to associate data with the Retained Mode object.</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_OUTOFMEMORY">DDERR_OUTOFMEMORY</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The application passes a GUID and receives a DWORD identifier that can then be used with <A HREF="Object2.htm#SetClientData">IDirect3DRMObject2::SetClientData</A> and <A HREF="Object2.htm#GetClientData">IDirect3DRMObject2::GetClientData</A> to associate data with the Retained Mode object.
 When an application uses <A HREF="#UnregisterClient">UnregisterClient</A>, any data stored by the application by means of <A HREF="Object2.htm#SetClientData">IDirect3DRMObject2::SetClientData</A> is released in a manner dependent on its type.
The same ID is returned for multiple invocations of this method with the same GUID. This method was introduced in DirectX version 6.0. </BLOCKQUOTE>


<H1><A NAME="SetDefaultTextureColors">IDirect3DRM3::SetDefaultTextureColors</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Sets the default colors to be used for a Direct3DRMTexture2 object.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetDefaultTextureColors</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwColors</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwColors</I>
</DT><DD>Number of colors.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method affects the texture colors only when it is used before the <A HREF="IDirect3DRM3.htm#CreateTexture">IDirect3DRM3::CreateTexture</A> method; it has no effect on textures that have already been created.
</BLOCKQUOTE>
<H1><A NAME="SetDefaultTextureShades">IDirect3DRM3::SetDefaultTextureShades</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Sets the default shades to be used for an Direct3DRMTexture2 object.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetDefaultTextureShades</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwShades</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>dwShades</I>
</DT><DD>Number of shades.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method affects the texture shades only when it is used before the <A HREF="IDirect3DRM3.htm#CreateTexture">IDirect3DRM3::CreateTexture</A> method; it has no effect on textures that have already been created.
</BLOCKQUOTE>




<H1><A NAME="SetOptions">IDirect3DRM3::SetOptions</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Sets whether Direct3D Retained Mode uses left-handed or right-handed geometry.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><b>HRESULT SetOptions(
  LPDWORD</b> <i>dwOptions</i><b>);</b></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>dwOptions</I></DT>
<DD>
Flag value that indicates the current Direct3D Retained Mode options. Currently defined flags are:
<DL>
<DT><b>D3DRMOPTIONS_LEFTHANDED</b></DT>
<DD>Use left-handed geometry. This value is the default.</DD>
<DT><b>D3DRMOPTIONS_RIGHTHANDED</b></DT>
<DD>Use right-handed geometry.</DD>
</DL>
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P><b>D3DRMOPTIONS_LEFTHANDED</b> and <b>D3DRMOPTIONS_RIGHTHANDED</b> affect the following objects as well as picking and ray picking.
<ul>
<li><a href="clippedvisual.htm">IDirect3DRMClippedVisual</a>
<li><a href="mesh.htm">IDirect3DRMMesh</a>
<li><a href="meshbuilder3.htm">IDirect3DRMMeshBuilder3</a>
<li><a href="progressivemesh.htm">IDirect3DRMProgressiveMesh</a>
<li><a href="shadow2.htm">IDirect3DRMShadow2</a>
<li><a href="texture3.htm">IDirect3DRMTexture3</a>
<li><a href="viewport2.htm">IDirect3DRMViewport2</a>
</ul>

<p>This method was introduced in DirectX version 6.0.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><a href="../oview/techbackgrnd.htm#rmmath_Direct3D_Coor">Direct3D Coordinate System</A>
<p><a href="#GetOptions">IDirect3DRM3::GetOptions</a>
</BLOCKQUOTE>

<H1><A NAME="SetSearchPath">IDirect3DRM3::SetSearchPath</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Sets the current file search path from a list of directories. For Windows, the path should be a list of directories separated by semicolons (;). 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetSearchPath</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCSTR</B> <I>lpPath</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpPath</I>
</DT><DD>Address of a null-terminated string specifying the path to set as the current search path.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The default search path is taken from the value of the D3DPATH environment variable. If this is not set, the search path will be empty. When opening a file, the system first looks for the file in the current working directory and then checks every directory in the search path.
<P><B><A NAME="D3DPATH">D3DPATH</A></B> is an environment variable that sets the default search path.
<P>
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="IDirect3DRM3.htm#GetSearchPath">IDirect3DRM3::GetSearchPath</A>
</BLOCKQUOTE>
<H1><A NAME="Tick">IDirect3DRM3::Tick</A><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Performs the Direct3DRM system heartbeat. When this method is used, the positions of all moving frames are updated according to their current motion attributes, the scene is rendered to the current device, and relevant callback functions are used at their appropriate times. Control is returned when the rendering cycle is complete. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>Tick</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>d3dvalTick</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>d3dvalTick</I>
 </DT><DD>Velocity and rotation step for the <A HREF="Frame3NtoZ.htm#SetRotation">IDirect3DRMFrame3::SetRotation</A> and <A HREF="Frame3NtoZ.htm#SetVelocity">IDirect3DRMFrame3::SetVelocity</A> methods.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible return codes, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>You can implement this method by using other Retained Mode methods to allow more flexibility in rendering a scene.



<H1><a name="UnregisterClient">IDirect3DRM3::UnregisterClient</a><HR size=1></H1>
<A HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<P>Disassociates all data and object associations set by <A HREF="Object2.htm#SetClientData">IDirect3DRMObject2::SetClientData</A> and frees the data in a manner dependent on its type. 

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT UnregisterClient(  
  REFGUID </B><I>rguid</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>rguid</I></DT>
<DD>Reference to a GUID that represents the application.</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#D3DRMERR_CLIENTNOTREGISTERED">D3DRMERR_CLIENTNOTREGISTERED</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
</BLOCKQUOTE>

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H5><HR size=1></H5>
<P><A class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

</BLOCKQUOTE>
<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
