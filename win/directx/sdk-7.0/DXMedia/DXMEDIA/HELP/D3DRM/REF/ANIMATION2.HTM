<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirect3DRMAnimation2</TITLE>
<SCRIPT LANGUAGE="JAVASCRIPT"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IDirect3DRMAnimation2">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::AddKey">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::AddPositionKey">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::AddRotateKey">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::AddScaleKey">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::DeleteKey">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::DeleteKeyByID">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::GetFrame">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::GetKeys">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::GetOptions">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::ModifyKey">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::SetFrame">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::SetOptions">
<META NAME="Description" CONTENT="IDirect3DRMAnimation2::SetTime">
<META NAME="Description" CONTENT="AddKey (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="AddPositionKey (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="AddRotateKey (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="AddScaleKey (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="DeleteKey (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="DeleteKeyByID (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="GetFrame (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="GetKeys (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="GetOptions (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="ModifyKey (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="SetFrame (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="SetOptions (IDirect3DRMAnimation2)">
<META NAME="Description" CONTENT="SetTime (IDirect3DRMAnimation2)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDirect3DRMAnimation2"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRMAnimation2"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/HDRd3drm.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRMAnimation2"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="Direct3D Retained Mode Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft Direct3D Retained Mode SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Iface_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IDirect3DRM3.htm">IDirect3DRM3</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="AnimationArray.htm">IDirect3DRMAnimationArray</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->

<H1><A NAME="dx5_IDirect3DRMAnimation2_d3drm"></A>IDirect3DRMAnimation2</H1>

<P>Applications use the methods of the <B>IDirect3DRMAnimation2</B> interface to animate the position, orientation, and scaling of visuals, lights, and viewports.

<p>An animation in Retained Mode is defined by a set of <I>keys</I>. A key is a time value associated with a scaling operation, an orientation, or a position. A Direct3DRMAnimation object defines how a transformation is modified according to the time value. The animation can be set to operate on a Direct3DRMFrame object, so it could be used to animate the position, orientation, and scaling of Direct3DRMVisual, Direct3DRMLight, and Direct3DRMViewport objects. 
<P>The <A HREF="#IDirect3DRMAnimation2_AddPositionKey">IDirect3DRMAnimation2::AddPositionKey</A>, <A HREF="#IDirect3DRMAnimation2_AddRotateKey">AddRotateKey</A>, and <A HREF="#IDirect3DRMAnimation2_AddScaleKey">AddScaleKey</A> methods each specify a time value whose units are arbitrary. If an application adds a position key with a time value of 99, for example, a new position key with a time value of 49 would occur exactly halfway between the (zero-based) beginning of the animation and the first position key. 
<P>The animation is driven by calling the <A HREF="#IDirect3DRMAnimation2_SetTime">IDirect3DRMAnimation2::SetTime</A> method. This sets the visual object's transformation to the interpolated position, orientation, and scale of the nearby keys in the animation. As with the methods that add animation keys, the time value for <B>IDirect3DRMAnimation2::SetTime</B> is an arbitrary value, based on the positions of keys the application has already added.

<p>Microsoft DirectX version 6.0 introduces the <B>IDirect3DRMAnimation2</B> interface. <B>IDirect3DRMAnimation2</B> extends the
older <b>IDirect3DRMAnimation</b> interface that it replaces by adding the <a href="#AddKey">AddKey</a>, <a href="#DeleteKeyByID">DeleteKeyByID</a>, <a href="#GetKeys">GetKeys</a>, and <a href="#ModifyKey">ModifyKey</a> methods that allow access to the keys of an animation. It also adds the <a href="#GetFrame">GetFrame</a> method that returns the frame of the corresponding animation. For a history of the Direct3D Retained Mode interfaces, see <a href="../oview/interface_changes.htm">Interface Changes</a>.
<P>The methods of the <B>IDirect3DRMAnimation2</B> interface can be organized into the following groups:
<P>
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Keys</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#AddKey">AddKey</A>
 </TD></TR>
<TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#IDirect3DRMAnimation2_AddPositionKey">AddPositionKey</A>
 </TD></TR>

 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#IDirect3DRMAnimation2_AddRotateKey">AddRotateKey</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#IDirect3DRMAnimation2_AddScaleKey">AddScaleKey</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#IDirect3DRMAnimation2_DeleteKey">DeleteKey</A>
 </TD></TR>

<TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#DeleteKeyByID">DeleteKeyByID</A>
 </TD></TR>
<TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#GetKeys">GetKeys</A>
 </TD></TR>
<TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#ModifyKey">ModifyKey</A>
 </TD></TR>

 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Miscellaneous</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#GetFrame">GetFrame</A>
 </TD></TR>
<TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#IDirect3DRMAnimation2_SetFrame">SetFrame</A>
 </TD></TR>

 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#IDirect3DRMAnimation2_SetTime">SetTime</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Options</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#IDirect3DRMAnimation2_GetOptions">GetOptions</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Animation2.htm#IDirect3DRMAnimation2_SetOptions">SetOptions</A>
</TD></TR></TABLE>
<P>The <B>IDirect3DRMAnimation2</B> interface, like all Component Object Model (COM) interfaces, inherits the <A HREF="FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interface methods. The <A HREF="FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interface supports the following three methods:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__AddRef">AddRef</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__QueryInter">QueryInterface</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__Release">Release</A>
</TD></TR></TABLE>
<P>In addition, the <B>IDirect3DRMAnimation2</B> interface inherits the following methods from the <A HREF="Object.htm">IDirect3DRMObject</A> interface:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#AddDestroyCallback">AddDestroyCallback</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#Clone">Clone</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#DeleteDestroyCallback">DeleteDestroyCallback</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetAppData">GetAppData</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetClassName">GetClassName</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetName">GetName</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#SetAppData">SetAppData</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#SetName">SetName</A>
</TD></TR></TABLE>
<P>The Direct3DRMAnimation object is obtained by calling the <A HREF="IDirect3DRM3.htm#CreateAnimation">IDirect3DRM3::CreateAnimation</A> method.




<H1><a name="AddKey">IDirect3DRMAnimation2::AddKey</a><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Adds a new key.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT AddKey
(LPD3DRMANIMATIONKEY</B> <I>lpKey</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>lpKey</I></DT>
<DD>D3DRMANIMATIONKEY structure that defines a new key. The <i>dwID</i> member of the structure is ignored and is filled in with the ID of the new key upon return.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
</BLOCKQUOTE>


<H1><A NAME="IDirect3DRMAnimation2_AddPositionKey">IDirect3DRMAnimation2::AddPositionKey</A><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Adds a position key to the animation.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>AddPositionKey</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvTime</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvX</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvY</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvZ</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rvTime</I>
</DT><DD>Time in the animation to store the position key. The time units are arbitrary and zero-based; a key whose <I>rvTime</I> value is 49 occurs exactly in the middle of an animation whose last key has an <I>rvTime</I> value of 99.
</DD><DT><I>rvX, rvY,</I> and <I>rvZ</I>
</DT><DD>Position.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The transformation applied by this method is a translation. For information about the matrix mathematics involved in transformations, see <A HREF="../oview/TechBackgrnd.htm#rmmath_3D_Transformati">3-D Transformations</A>.
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Animation2.htm#IDirect3DRMAnimation2_DeleteKey">IDirect3DRMAnimation2::DeleteKey</A>
</BLOCKQUOTE>
<H1><A NAME="IDirect3DRMAnimation2_AddRotateKey">IDirect3DRMAnimation2::AddRotateKey</A><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Adds a rotate key to the animation.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>AddRotateKey</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvTime</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DRMQUATERNION</B> <I>*rqQuat</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rvTime</I>
</DT><DD>Time in the animation to store the rotate key. The time units are arbitrary and zero-based; a key whose <I>rvTime</I> value is 49 occurs exactly in the middle of an animation whose last key has an <I>rvTime</I> value of 99.
</DD><DT><I>rqQuat</I>
</DT><DD>Quaternion representing the rotation.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method applies a rotation transformation. For information about the matrix mathematics involved in transformations, see <A HREF="../oview/TechBackgrnd.htm#rmmath_3D_Transformati">3-D Transformations</A>.
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Animation2.htm#IDirect3DRMAnimation2_DeleteKey">IDirect3DRMAnimation2::DeleteKey</A>
</BLOCKQUOTE>
<H1><A NAME="IDirect3DRMAnimation2_AddScaleKey">IDirect3DRMAnimation2::AddScaleKey</A><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Adds a scale key to the animation.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>AddScaleKey</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvTime</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvX</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvY</I><B>,</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvZ</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rvTime</I>
</DT><DD>Time in the animation to store the scale key. The time units are arbitrary and zero-based; a key whose <I>rvTime</I> value is 49 occurs exactly in the middle of an animation whose last key has an <I>rvTime</I> value of 99.
</DD><DT><I>rvX, rvY,</I> and <I>rvZ</I>
</DT><DD>Scale factor.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method applies a scaling transformation. For information about the matrix mathematics involved in transformations, see <A HREF="../oview/TechBackgrnd.htm#rmmath_3D_Transformati">3-D Transformations</A>.
</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Animation2.htm#IDirect3DRMAnimation2_DeleteKey">IDirect3DRMAnimation2::DeleteKey</A>
</BLOCKQUOTE>

<H1><A NAME="IDirect3DRMAnimation2_DeleteKey">IDirect3DRMAnimation2::DeleteKey</A><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Removes all the keys with the given time from an animation. For example, if an animation has a scale key with time <i>t</i> and a rotation key with time <i>t</i> then both keys will be deleted.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>DeleteKey</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rvTime</I>
</DT><DD>Time identifying the key that will be removed from the animation. 
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>



<H1><a name="DeleteKeyByID">IDirect3DRMAnimation2::DeleteKeyByID</a><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Deletes the key corresponding to a particular ID.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT DeleteKeyByID
(DWORD</B> <I>dwID</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>dwID</I></DT>
<DD>ID of the key to delete.</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#D3DRMERR_NOSUCHKEY">D3DRMERR_NOSUCHKEY</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
</BLOCKQUOTE>



<H1><a name="GetFrame">IDirect3DRMAnimation2::GetFrame</a><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Retrieves the frame corresponding to the animation.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT GetFrame
(LPDIRECT3DRMFRAME3*</B> <I>lplpFrame</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>lplpFrame</I></DT>
<DD>Pointer to receive an interface of the current <b>Direct3DRMFrame</b> object that the animation references. This can be NULL.</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
</BLOCKQUOTE>



<H1><a name="GetKeys">IDirect3DRMAnimation2::GetKeys</a><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Retrieves the keys corresponding to a particular time. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT GetKeys
(D3DVALUE</B> <I>dvTimeMin</I><B>,
D3DVALUE</B> <I>dvTimeMax</I><B>,
LPDWORD</B> <I>lpdwNumKeys</I><B>,
LPD3DRMANIMATIONKEY</B> <I>lpKey</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>dvTimeMin</I></DT>
<DD>Minimum time value of keys to be returned.</DD>
<DT><I>dvTimeMax</I></DT>
<DD>Maximum time value of keys to be returned.</DD>
<DT><I>lpdwNumKeys</I></DT>
<DD>Pointer to a variable the contains the number of keys to be returned in <b>lpKey</b>. If <I>lpKey</I> is NULL, <I>lpdwNumKeys</I> is filled in with the number of keys at the specified time.</DD>
<DT><I>lpKey</I></DT>
<DD>Pointer to a <b>D3DRMANIMATIONKEY</b> structure that will be filled in with the key value. If <i>lpKey</i> is NULL, <i>lpdwNumKeys</i> will be filled in with the number of keys at the specified time.
  If <i>lpKey</i> is non-NULL, it will be filled in with the keys corresponding to the specified time up to a maximum number of keys indicated by <i>lpdwNumKeys</i>.
</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#D3DRMERR_NOSUCHKEY">D3DRMERR_NOSUCHKEY</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
</BLOCKQUOTE>


<H1><A NAME="IDirect3DRMAnimation2_GetOptions">IDirect3DRMAnimation2::GetOptions</A><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Retrieves animation options.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>
<B>D3DRMANIMATIONOPTIONS</B> <B>GetOptions</B><B>(</B> <B>)</B><B>;</B><BR></PRE></BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns the value of the <A HREF="Constants.htm#D3DRMANIMATIONOPTIONS">D3DRMANIMATIONOPTIONS</A> type describing the animation options.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Animation2.htm#IDirect3DRMAnimation2_SetOptions">IDirect3DRMAnimation2::SetOptions</A>
</BLOCKQUOTE>




<H1><a name="ModifyKey">IDirect3DRMAnimation2::ModifyKey</a><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Modifies the value of a key.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT Modify
(LPD3DRMANIMATIONKEY</B> <I>lpKey</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>lpKey</I></DT>
<DD>D3DRMANIMATIONKEY structure that defines an existing key's value. The <b>dwID</b> member of the structure must be an existing key.</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#D3DRMERR_INCOMPATIBLEKEY">D3DRMERR_INCOMPATIBLEKEY</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#D3DRMERR_NOSUCHKEY">D3DRMERR_NOSUCHKEY</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
<p>You cannot modify a key's type. To change a key's type you must delete the original key and then add a new key. You can modify a key's time and position, rotation, and scale values.
</BLOCKQUOTE>


<H1><A NAME="IDirect3DRMAnimation2_SetFrame">IDirect3DRMAnimation2::SetFrame</A><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Sets the frame for the animation.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECT3DRMFRAME3</B> <I>lpD3DRMFrame</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpD3DRMFrame</I>
</DT><DD>Address of a variable representing the frame to set for the animation. 
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<H1><A NAME="IDirect3DRMAnimation2_SetOptions">IDirect3DRMAnimation2::SetOptions</A><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Sets the animation options.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetOptions</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMANIMATIONOPTIONS</B> <I>d3drmanimFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>d3drmanimFlags</I>
</DT><DD>Value of the <A HREF="Constants.htm#D3DRMANIMATIONOPTIONS">D3DRMANIMATIONOPTIONS</A> type describing the animation options.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Animation2.htm#IDirect3DRMAnimation2_GetOptions">IDirect3DRMAnimation2::GetOptions</A>
</BLOCKQUOTE>
<H1><A NAME="IDirect3DRMAnimation2_SetTime">IDirect3DRMAnimation2::SetTime</A><HR size=1></H1>
<A HREF="Animation2.htm">IDirect3DRMAnimation2</A>
<P>Sets the current time for this animation.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetTime</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DVALUE</B> <I>rvTime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>rvTime</I>
</DT><DD>New current time for the animation. The time units are arbitrary and zero-based; a key whose <I>rvTime</I> value is 49 occurs exactly in the middle of an animation whose last key has an <I>rvTime</I> value of 99.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H5><HR size=1></H5>
<P><A class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
