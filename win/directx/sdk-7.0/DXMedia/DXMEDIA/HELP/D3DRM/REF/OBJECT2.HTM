<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirect3DRMObject2</TITLE>
<SCRIPT LANGUAGE="JAVASCRIPT"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="IDirect3DRMObject2">
<META NAME="Description" CONTENT="IDirect3DRMObject2::AddDestroyCallback">
<META NAME="Description" CONTENT="IDirect3DRMObject2::Clone">
<META NAME="Description" CONTENT="IDirect3DRMObject2::DeleteDestroyCallback">
<META NAME="Description" CONTENT="IDirect3DRMObject2::GetAge">
<META NAME="Description" CONTENT="IDirect3DRMObject2::GetClientData">
<META NAME="Description" CONTENT="IDirect3DRMObject2::GetDirect3DRM">
<META NAME="Description" CONTENT="IDirect3DRMObject2::GetName">
<META NAME="Description" CONTENT="IDirect3DRMObject2::SetClientData">
<META NAME="Description" CONTENT="IDirect3DRMObject2::SetName">
<META NAME="Description" CONTENT="AddDestroyCallback (IDirect3DRMObject2)">
<META NAME="Description" CONTENT="Clone (IDirect3DRMObject2)">
<META NAME="Description" CONTENT="DeleteDestroyCallback (IDirect3DRMObject2)">
<META NAME="Description" CONTENT="GetAge (IDirect3DRMObject2)">
<META NAME="Description" CONTENT="GetClientData (IDirect3DRMObject2)">
<META NAME="Description" CONTENT="GetDirect3DRM (IDirect3DRMObject2)">
<META NAME="Description" CONTENT="GetName (IDirect3DRMObject2)">
<META NAME="Description" CONTENT="SetClientData (IDirect3DRMObject2)">
<META NAME="Description" CONTENT="SetName (IDirect3DRMObject2)">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="IDirect3DRMObject2"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRMObject2"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/HDRd3drm.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --IDirect3DRMObject2"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="Direct3D Retained Mode Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft Direct3D Retained Mode SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Iface_intro.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Object.htm">IDirect3DRMObject</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="ObjectArray.htm">IDirect3DRMObjectArray</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->

<H1><A NAME="IDirect3DRMObject2"></A>IDirect3DRMObject2</H1>

<P>Applications use the methods of the <B>IDirect3DRMObject2</B> interface to work with the object2 superclass of Microsoft&#174; Direct3D&#174; Retained Mode objects. Microsoft DirectX version 6.0 introduces the <B>IDirect3DRMObject2</B> interface which all Retained Mode objects implement. Use <A HREF="FurtherReading.htm#IUnknown__QueryInter">QueryInterface</A> on any Direct3D Retained Mode object to obtain a pointer to this interface.

<p><B>IDirect3DRMObject2</B> implements the following methods which are equivalent to the <a href="object.htm">IDirect3DRMObject</a> methods of the same name:

<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="#AddDestroyCallback">AddDestroyCallback</A>
</TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="#Clone">Clone</A>
</TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="#DeleteDestroyCallback">DeleteDestroyCallback</A>
</TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="#GetName">GetName</A>
</TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="#SetName">SetName</A>
</TD></TR>
</TABLE>

<p>Besides the methods <B>IDirect3DRMObject2</B> shares with <a href="object.htm">IDirect3DRMObject</a>, it implements the following methods.
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="#GetDirect3DRM">GetDirect3DRM</A>
</TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="#GetClientData">GetClientData</A>
</TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="#GetAge">GetAge</A>
</TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="#SetClientData">SetClientData</A>
</TD></TR>
</TABLE>

<p><a href="#GetClientData">IDirect3DRMObject2::GetClientData</a> and <a href="#SetClientData">IDirect3DRMObject2::SetClientData</a> provide data association with an object, which is more flexible than the older <a href="object.htm#getappdata">IDirect3DRMObject::GetAppData</a> and <a href="object.htm#setappdata">IDirect3DRMObject::SetAppData</a> methods.

<p>For a conceptual overview of the older object interface, see <a href="object.htm">IDirect3DRMObject</a>. For a history of the Direct3D Retained Mode interfaces, see <a href="../oview/interface_changes.htm">Interface Changes</a>.

<P>The methods of the <B>IDirect3DRMObject2</B> interface can be organized into the following groups:




<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Application-specific data</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="#GetClientData">GetClientData</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="#SetClientData">SetClientData</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Cloning</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="#Clone">Clone</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Naming</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#GetName">GetName</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#SetName">SetName</A>
 </TD></TR>

<TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Miscellaneous</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="#GetAge">GetAge</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="#GetDirect3DRM">GetDirect3DRM</A>
 </TD></TR>
 
 <TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><B>Notifications</B>
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#AddDestroyCallback">AddDestroyCallback</A>
 </TD></TR><TR><TD></TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="Object.htm#DeleteDestroyCallback">DeleteDestroyCallback</A>
</TD></TR></TABLE>
<P>The <B>IDirect3DRMObject2</B> interface, like all Component Object Model (COM) interfaces, inherits the <A HREF="FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interface methods. The <A HREF="FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interface supports the following three methods:
<TABLE CLASS="ref">
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__AddRef">AddRef</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__QueryInter">QueryInterface</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="FurtherReading.htm#IUnknown__Release">Release</A>
</TD></TR></TABLE>
<P>The Direct3DRMObject2 object is obtained through the appropriate call to the <B>QueryInterface</B> method from any Retained Mode object. All Retained Mode objects inherit the <B>IDirect3DRMObject2</B> interface methods.



<H1><A NAME="AddDestroyCallback">IDirect3DRMObject2::AddDestroyCallback</A><HR size=1></H1>
<A HREF="Object2.htm">IDirect3DRMObject2</A>
<P>Registers a function that will be called when an object is destroyed.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>AddDestroyCallback</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMOBJECTCALLBACK</B> <I>lpCallback</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpCallback</I>
</DT><DD>User-defined callback function that will be used when the object is destroyed.

</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to the callback function. Because this function is used after the object has been destroyed, you should not use this function with the object as an argument.

</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method is equivalent to the <A HREF="Object.htm">IDirect3DRMObject</A> method of the same name.
</BLOCKQUOTE>



<H1><A NAME="Clone">IDirect3DRMObject2::Clone</A><HR size=1></H1>
<A HREF="Object2.htm">IDirect3DRMObject2</A>
<P>Creates a copy of an object.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>Clone</B><B>(</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnkOuter</I><B>,</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>*ppvObj</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>pUnkOuter</I>

</DT><DD>Pointer to the outer <B>IUnknown</B> interface that allows COM aggregation features. 
</DD><DT><I>riid</I>
</DT><DD>Identifier of the object being copied.
</DD><DT><I>ppvObj</I>
</DT><DD>Address that will contain the copy of the object when the method returns.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>



<H1><A NAME="DeleteDestroyCallback">IDirect3DRMObject2::DeleteDestroyCallback</A><HR size=1></H1>
<A HREF="Object2.htm">IDirect3DRMObject2</A>
<P>Removes a function previously registered with the <A HREF="Object.htm#AddDestroyCallback">IDirect3DRMObject2::AddDestroyCallback</A> method.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>DeleteDestroyCallback</B><B>(</B><BR>&nbsp;&nbsp;<B>D3DRMOBJECTCALLBACK</B> <I>d3drmObjProc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpArg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>d3drmObjProc</I>
</DT><DD>User-defined <A HREF="Callbacks.htm#D3DRMOBJECTCALLBACK">D3DRMOBJECTCALLBACK</A> callback function that will be used when the object is destroyed.

</DD><DT><I>lpArg</I>
</DT><DD>Address of application-defined data passed to the callback function.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method is equivalent to the <A HREF="Object.htm">IDirect3DRMObject</A> method of the same name.
</BLOCKQUOTE>



<H1><a name="GetAge">IDirect3DRMObject2::GetAge</a><HR size=1></H1>
<A HREF="Object2.htm">IDirect3DRMObject2</A>


<P>Reports the current age of the object.

<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE>HRESULT GetAge(
  DWORD dwFlags,
  LPDWORD lpdwAge);</PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>
<DT><I>dwFlags</I></DT>
<DD>Flag value. Must be zero if the object is not a meshbuilder. If the object is a meshbuilder, can be one of the following values:
<DL>
<DT>Default (0)</DT>
<DD>THe meshbuilder ages normally (aging is caused by any change to the meshbuilder).</DD>
<DT><B><A NAME="D3DRMMESHBUILDERAGE_GEOMETRY" IDX_CONCEPT="D3DRMMESHBUILDERAGE_GEOMETRY">D3DRMMESHBUILDERAGE_GEOMETRY</A></B></DT>
<DD>The meshbuilder ages whenever the mesh geometry is changed (for example, addition of vertices, faces, or another meshbuilder).</DD>
<DT><B><A NAME="D3DRMMESHBUILDERAGE_MATERIALS" IDX_CONCEPT="D3DRMMESHBUILDERAGE_MATERIALS">D3DRMMESHBUILDERAGE_MATERIALS</A></B></DT>
<dd>The meshbuilder ages whenever a material-related property of the mesh changes, or when faces or another mesh are added.</DD>
<DT><B><A NAME="D3DRMMESHBUILDERAGE_TEXTURES" IDX_CONCEPT="D3DRMMESHBUILDERAGE_TEXTURES">D3DRMMESHBUILDERAGE_TEXTURES</A></B></DT>
<dd>The meshbuilder ages whenever a texture-related property of the mesh changes, or when faces or another mesh are added.</DD>
</DL>

</DD>
<DT><I>lpdwAge</I></DT>
<DD>Pointer that receives the age.</DD>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The age increases when the object is modified. 

<p>This method was introduced in DirectX version 6.0. Aging is only supported in DirectX 6.0 by the following objects.
<TABLE CLASS="ref">
<tr>
<td><A HREF="../oview/OutputDevices_face.htm">Direct3DRMDevice3</A></td>
</tr>

<tr>
<td><A HREF="../oview/Textures_face.htm#rmobject_IDirect3DRMTexture3_Int">Direct3DRMTexture3</A></td>
</tr>

<tr>
<td><a href="meshbuilder3.htm">Direct3DRMMeshBuilder3</a></td>
</tr>

<tr>
<td><a href="uservisual.htm">Direct3DRMUserVisual</a></td>
</tr>

<tr>
<td><a href="Shadow2.htm">Direct3DRMShadow2</a></td>
</tr>

<tr>
<td><A HREF="../oview/Wraps_face.htm#rmobject_IDirect3DRMWrap_Int">Direct3DRMWrap</A></td>
</tr>
</TABLE>





</BLOCKQUOTE>



<H1><a name="GetClientData">IDirect3DRMObject2::GetClientData</a><HR size=1></H1>
<a href="object2.htm">IDirect3DRMObject2</a>
<P>Retrieves the data previously associated with an object through a call to <A HREF="#SetClientData">SetClientData</A>.  





<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT GetClientData(  
  DWORD</B> <I>dwID</I><B>,
  LPVOID* </B><I>lplpvData</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>dwID</I></DT>
<DD>An application ID obtained from a call to <b>RegisterClient</b>.</DD>
<DT><I>lplpvData</I></DT>
<DD>Address of a variable that receives the associated data.</DD>




A NULL value 




indicates that no data has been set.
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#D3DRMERR_CLIENTNOTREGISTERED">D3DRMERR_CLIENTNOTREGISTERED</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_NOTFOUND">DDERR_NOTFOUND</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_NOTINITIALIZED">DDERR_NOTINITIALIZED</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>If the data is of type <b>IUnknown</b>, this method increments the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_r.htm#reference_count')">reference count</A> before returning the data to the caller. This method was introduced in DirectX version 6.0.  
</BLOCKQUOTE>



<H1><a name="GetDirect3DRM">IDirect3DRMObject2::GetDirect3DRM</a><HR size=1></H1>
<a href="object2.htm">IDirect3DRMObject2</a>


<P>Retrieves a pointer to an interface of the ultimate <b>Direct3DRM</b> object involved in the creation of this object. 
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT GetDirect3DRM(  
  LPLPDIRECT3DRM </B><I>lplpD3DRM</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>lplpD3DRM</I></DT>
<DD>Address that receives a pointer to an interface of the ultimate Direct3D Retained Mode object involved in the creation of the object specified by <I>lpDirect3DRMObject</I>.</DD>




</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method was introduced with DirectX version 6.0.
</BLOCKQUOTE>



<H1><A NAME="GetName">IDirect3DRMObject2::GetName</A><HR size=1></H1>
<A HREF="Object2.htm">IDirect3DRMObject2</A>
<P>Retrieves the object's name.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>GetName</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDWORD</B> <I>lpdwSize</I><B>,</B><BR>&nbsp;&nbsp;<B>LPSTR</B> <I>lpName</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpdwSize</I>
 </DT><DD>Address of a variable containing the size, in bytes, of the buffer pointed to by the <I>lpName</I> parameter.
</DD><DT><I>lpName</I>
 </DT><DD>Address of a variable that will contain a null-terminated string identifying the object's name when the method returns. If this parameter is NULL, the <I>lpdwSize</I> parameter will contain the required size for the string when the method returns.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.

</BLOCKQUOTE>
<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Object.htm#SetName">IDirect3DRMObject2::SetName</A>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method is equivalent to the <A HREF="Object.htm">IDirect3DRMObject</A> method of the same name.
</BLOCKQUOTE>



<H1><a name="SetClientData">IDirect3DRMObject2::SetClientData</a><HR size=1></H1>
<a href="object2.htm">IDirect3DRMObject2</a>
<P>Associates an item of data with a Retained Mode object.


<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT SetClientData(  
  DWORD</B> <I>dwID</I><B>,
  LPVOID</B> <I>lpvData</I><B>,
  DWORD</B> <I>dwFlags</I><B>);</B></PRE>
</BLOCKQUOTE>

<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL>

<DT><I>dwID</I></DT>
<DD>Application ID obtained from a call to <A HREF="IDirect3DRM3.htm#RegisterClient">IDirect3DRM3::RegisterClient</A>.</DD>
<DT><I>lpvData</I></DT>
<DD>Application-specific data to be associated with the object.</DD>




<DT><I>dwFlags</I></DT>
<DD>Flags that determine how the data is interpreted by Retained Mode.</DD>




<TABLE>
<TR>
	<TD>Flag</TD>
	<TD>D3DRMCLIENTDATA_NONE</TD>
	<TD>D3DRMCLIENTDATA_LOCALFREE</TD>
	<TD>D3DRMCLIENTDATA_IUNKNOWN</TD>
</TR>
<TR>
	<TD>Interpretation of data</TD>
	<TD>No interpretation</TD>
	<TD>Data has been allocated by client; <b>Direct3DRM</b> should free it upon disassociation</TD>
	

	

	<TD>Data is assumed to pointto an <b>IUnknown</b> interface</TD>
	



</TR>
<TR>
	<TD>Behavior on <b>SetClientData</b></TD>
	<TD>No behavior</TD>
	<TD>No behavior</TD>
	<TD>Direct3D Retained Mode increments the reference count on the interface</TD>
		

		

</TR>
<TR>
	<TD>Behavior on <A HREF="#GetClientData">GetClientData</A></TD>
	<TD>No behavior</TD>
	<TD>No behavior</TD>
	<TD>Direct3D Retained Mode increments the reference count on the interface before passing it to the caller</TD>
	

	

</TR>
<TR>
	<TD>Behavior when data is disassociated from the object</TD>
	<TD>No behavior</TD>
	<TD><b>LocalFree</b> is used on data</TD>
	

	<TD>Direct3D Retained Mode decrements the reference count on the interface</TD>
	

	

</TR>
</TABLE>
</DL>
</BLOCKQUOTE>

<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns one of the following values:<BR>&nbsp;
<TABLE CLASS="ref">
<TR>
<TD><A HREF="ReturnValues.htm#D3DRMERR_CLIENTNOTREGISTERED">D3DRMERR_CLIENTNOTREGISTERED</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDOBJECT">DDERR_INVALIDOBJECT</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DDERR_INVALIDPARAMS">DDERR_INVALIDPARAMS</A></TD>
</TR>
<TR>
<TD><A HREF="ReturnValues.htm#DD_OK">DD_OK</A></TD>
</TR>
</TABLE>
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>The data can be removed by means of a call to this method with NULL as an argument,


or destruction of the object, or by using <A HREF="IDirect3DRM3.htm#UnregisterClient">IDirect3DRM3::UnregisterClient</A>.
 If you have




previously associated data with the object using the ID specified by <I>dwID</I>,




then the previous data is released.
The method of destruction depends on the flags passed to this method in the <I>dwFlags</I> parameter.




The data can be retrieved by means of a call to <A HREF="#GetClientData">GetClientData</A>. This method was introduced in DirectX version 6.0.
</BLOCKQUOTE>



<H1><A NAME="SetName">IDirect3DRMObject2::SetName</A><HR size=1></H1>
<A HREF="Object2.htm">IDirect3DRMObject2</A>
<P>Sets the object's name.
<P CLASS="ref">Syntax</P>
<BLOCKQUOTE>
<PRE><B>HRESULT</B> <B>SetName</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>char</B> <B>*</B> <I>lpName</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B></PRE>
</BLOCKQUOTE>
<P CLASS="ref">Parameters</P>
<BLOCKQUOTE>
<DL><DT><I>lpName</I>
</DT><DD>User-defined data to name the object.
</DD></DL>
</BLOCKQUOTE>
<P CLASS="ref">Return Value</P>
<BLOCKQUOTE>
<P>Returns D3DRM_OK if successful, or an error otherwise. For a list of possible errors, see <A HREF="ReturnValues.htm">Direct3D Retained Mode Return Values</A>.
</BLOCKQUOTE>

<P CLASS="ref">Remarks</P>
<BLOCKQUOTE>
<P>This method is equivalent to the <A HREF="Object.htm">IDirect3DRMObject</A> method of the same name.
</BLOCKQUOTE>

<P CLASS="ref">See Also</P>
<BLOCKQUOTE>
<P><A HREF="Object.htm#GetName">IDirect3DRMObject2::GetName</A>
</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H5><HR size=1></H5>
<P><A class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
