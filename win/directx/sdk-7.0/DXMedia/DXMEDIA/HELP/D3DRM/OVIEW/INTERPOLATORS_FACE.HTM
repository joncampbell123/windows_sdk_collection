<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Interpolators</TITLE>
<SCRIPT LANGUAGE="JAVASCRIPT"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="Interpolators">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="Interpolators_face"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --Interpolators"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/HDRd3drm.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --Interpolators"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="Direct3D Retained Mode Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft Direct3D Retained Mode SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Oview_face.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Frames_face.htm">Frames</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="Lights_face.htm">Lights</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->

<H1><a name="Interpolators">Interpolators</a></H1>

<P>Interpolators provide a way of storing actions and applying them to objects with automatic calculation of in-between values. For example, you can set a scene's background color to red at time zero and green at time ten, and the interpolator will automatically tint successive scenes to blend from red to green. With an interpolator, you can blend colors, move objects smoothly between positions, morph meshes, and perform many other transformations.

<P>In the Direct3D Retained Mode implementation, interpolators are a generalization of the <A HREF="../ref/Animation2.htm#IDirect3DRMAnimation2">IDirect3DRMAnimation2</A> interface that increases the kinds of object parameters you can animate. While the <B>IDirect3DRMAnimation2</B> interface allows animation of an object's position, size and orientation, the <A HREF="../ref/Interpolator.htm#IDirect3DRMInterpolator">IDirect3DRMInterpolator</A> interface further enables animation of colors, meshes, textures, and materials. 

<P>This article contains the following sections.
<ul>
<li><a href="#rmobject_Interpolator_Actions">Interpolator Keys</A>
<li><a href="#rmobject_Interpolator_Types">Interpolator Types</A>
<li><a href="#rmobject_Interpolator_Example">Interpolator Example</A>
<li><a href="#Methods_Supported_by_the_Interpolator">Methods Supported by the Interpolator</A>
<li><a href="#rmobject_Interpolator_Index_Span">Interpolator Index Span</A>
<li><a href="#rmobject_Interpolation_Options">Interpolation Options</A>
</ul>


<H2><A NAME="rmobject_Interpolator_Actions">Interpolator Keys</A></H2>
<P>The actions stored by the interpolator are called keys. A key is a stored procedure call and has an index associated with it. The interpolator automatically calculates between the key values.

<P>Keys are stored in the interpolator by calling one of the supported interface methods that can be interpolated. The method and the parameter values passed to it make up the key. <A HREF="Interpolators_face.htm#Methods_Supported_by_the_Interpolator">Methods Supported by the Interpolator</A> supplies a list of supported methods.

<P>Every key stored inside an interpolator has an index value. When the key is recorded, it is stamped with the current interpolator index value. The key's index value never changes once this value is set.



<H2><A NAME="rmobject_Interpolator_Types">Interpolator Types</A></H2>
<P>Objects can be attached to interpolators of an associated type; for example, a Mesh can be attached to a MeshInterpolator. The interpolator types are:
<BLOCKQUOTE>
<UL><LI>FrameInterpolator
 <LI>LightInterpolator 
 <LI>MaterialInterpolator 
 <LI>MeshInterpolator 
 <LI>TextureInterpolator 
 <LI>ViewportInterpolator 
</UL>
</BLOCKQUOTE>
<P>Other interpolators can also be attached to an interpolator. When you change the index of an interpolator, it sets the indices of any attached interpolators to the same value.

<P>Note that for MeshInterpolators, you add a <B>SetVertices</B> key to a MeshInterpolator object by calling <A HREF="../ref/Mesh.htm#SetVertices">SetVertices</A> on the MeshInterpolator object's <A HREF="../ref/Mesh.htm#IDirect3DRMMesh">IDirect3DRMMesh</A> interface.
The group index used with <B>SetVertices</B> must correspond to a valid group index in the Mesh object or objects that the interpolator is applied to. 


<H2><A NAME="rmobject_Interpolator_Example">Interpolator Example</A></H2>
<P>As an example, if you want to interpolate a frame's position, you will need a FrameInterpolator object with two interfaces, <A HREF="../ref/Interpolator.htm#IDirect3DRMInterpolator">IDirect3DRMInterpolator</A> and <A HREF="../ref/Frame3Oview.htm#IDirect3DRMFrame3">IDirect3DRMFrame3</A>.
<PRE>
pd3drm-&gt;CreateObject(CLSID_CDirect3DRMFrameInterpolator, 0, IID_IDirect3DRMInterpolator, &amp;pInterp);
pInterp-&gt;QueryInterface(IID_IDirect3DRMFrame3, &amp;pFrameInterp);
</PRE>
<P>To add a position key to the interpolator, set the interpolator's internal index by calling <A HREF="../ref/Interpolator.htm#SetIndex">IDirect3DRMInterpolator::SetIndex</A>, and record the position by calling <A HREF="../ref/Frame3NtoZ.htm#SetPosition">SetPosition</A> on the <A HREF="../ref/Frame3Oview.htm#IDirect3DRMFrame3">IDirect3DRMFrame3</A> interface.
 

This method is applied to the interpolator rather than to a real frame. The function call and its parameters are stored in the interpolator as a new key with the current index.
<PRE>
pInterp-&gt;SetIndex(keytime);
pFrameInterp-&gt;SetPosition(NULL, keypos.x, keypos.y, keypos.z);
</PRE>
<P>You can add more keys by repeating the sequence of setting the index with <A HREF="../ref/Interpolator.htm#SetIndex">IDirect3DRMInterpolator::SetIndex</A> 


followed by one or more object methods. To play actions back through a real frame, attach the frame to the interpolator.
<PRE>
pInterp-&gt;AttachObject(pRealFrame);
</PRE>
<P>Now call <A HREF="../ref/Interpolator.htm#Interpolate">IDirect3DRMInterpolator::Interpolate</A> to set the position of the <I>pRealFrame</I> parameter using the interpolated position.
<PRE>
pInterp-&gt;Interpolate(time, NULL, D3DRMINTERPOLATIONSPLINE | D3DRMINTERPOLATION_OPEN);
</PRE>
<P>The interpolator will call the attached frame's <A HREF="../ref/Frame3NtoZ.htm#SetPosition">SetPosition</A> 
 method, passing it a position it has calculated by interpolating (in this case, using a B-spline) between the nearest <B>SetPosition</B> keys.


<P>Alternatively, you can use the immediate form of <A HREF="../ref/Interpolator.htm#Interpolate">Interpolate</A> and pass the object as the second parameter. This overrides any attached objects.
<PRE>
pInterp-&gt;Interpolate(time, pRealFrame, D3DRMINTERPOLATIONSPLINE | D3DRMINTERPOLATION_OPEN);
</PRE>
<P>You can use the same interpolator to store other keys such as orientation, scale, velocity, and color keys. Each property exists on a parallel timeline, and calling <A HREF="../ref/Interpolator.htm#Interpolate">Interpolate</A> assigns the interpolated value for each property to the attached frames.

<P>It is possible to interpolate more than one method. For example, you can store <B>SetGroupColor</B> and <B>SetVertices</B> keys in the same interpolator. It is not possible to interpolate between keys of different methods, so they are stored in parallel execution threads called Key Chains. Also, if you specify two keys from different groups, such as <B>SetGroupColor</B>(0, black) and <B>SetGroupColor</B>(2, white), it does not make sense for the interpolator to generate an in-between action of <B>SetGroupColor</B>(1, gray) because the keys apply to different groups. In this case, the keys are also stored in separate chains.


<H2><A NAME="Methods_Supported_by_the_Interpolator" IDX_CONCEPT="Interpolator, Supported Methods">Methods Supported by the Interpolator</A></H2>
<P><B>Viewport</B> 


<DL>
<DT><A HREF="../ref/Viewport2.htm#SetFront">SetFront</A>(value)
 </DT><DT><A HREF="../ref/Viewport2.htm#SetBack">SetBack</A>(value)
 </DT><DT><A HREF="../ref/Viewport2.htm#SetField">SetField</A>(value)
 </DT><DT><A HREF="../ref/Viewport2.htm#SetPlane">SetPlane</A>(left, right, bottom, top)
</DT></DL>
<P><B>Frame</B> 
<DL>
<DT><A HREF="../ref/Frame3NtoZ.htm#SetPosition">SetPosition</A>(reference*, x, y, z)
 </DT><DT><A HREF="../ref/Frame3NtoZ.htm#SetRotation">SetRotation</A>(reference*, x, y, z, theta)
 </DT><DT><A HREF="../ref/Frame3NtoZ.htm#SetVelocity">SetVelocity</A>(reference*, x, y, z, withRotation*)
 </DT><DT><A HREF="../ref/Frame3NtoZ.htm#SetOrientation">SetOrientation</A>(reference*, dx, dy, dz, ux, uy, uz)
 </DT><DT><A HREF="../ref/Frame3NtoZ.htm#SetColor">SetColor</A>(color)
 </DT><DT><A HREF="../ref/Frame3NtoZ.htm#SetColorRGB">SetColorRGB</A>(red, green, blue)
 </DT><DT><A HREF="../ref/Frame3NtoZ.htm#SetSceneBackground">SetSceneBackground</A>(color)
 </DT><DT><A HREF="../ref/Frame3NtoZ.htm#SetSceneBackgroundRGB">SetSceneBackgroundRGB</A>(red, green, blue)
 </DT><DT><A HREF="../ref/Frame3NtoZ.htm#SetSceneFogColor">SetSceneFogColor</A>(color)
 </DT><DT><A HREF="../ref/Frame3NtoZ.htm#SetSceneFogParams">SetSceneFogParams</A>(start, end, density)
 </DT><DT><A HREF="../ref/frame3ntoz.htm#SetQuaternion">SetQuaternion</A>(reference*, quat)
</DT></DL>
<P><B>Mesh</B>
<DL>
<DT><A HREF="../ref/Mesh.htm#Translate">Translate</A>(x, y, z)
 </DT><DT><A HREF="../ref/Mesh.htm#SetVertices">SetVertices</A>(group*, index*, count*, vertices)
 </DT><DT><A HREF="../ref/Mesh.htm#SetGroupColor">SetGroupColor</A>(group*, color)
 </DT><DT><A HREF="../ref/Mesh.htm#SetGroupColorRGB">SetGroupColorRGB</A>(group*, red, green, blue)
</DT></DL>
<P><B>Light</B>
<DL>
<DT><A HREF="../ref/Light.htm#SetColor">SetColor</A>(color)
 </DT><DT><A HREF="../ref/Light.htm#SetColorRGB">SetColorRGB</A>(red, green, blue)
 </DT><DT><A HREF="../ref/Light.htm#SetRange">SetRange</A>(value) 
 </DT><DT><A HREF="../ref/Light.htm#SetUmbra">SetUmbra</A>(value)
 </DT><DT><A HREF="../ref/Light.htm#SetPenumbra">SetPenumbra</A>(value)
 </DT><DT><A HREF="../ref/Light.htm#SetConstantAttenuation">SetConstantAttenuation</A>(value)
 </DT><DT><A HREF="../ref/Light.htm#SetLinearAttenuation">SetLinearAttenuation</A>(value)
 </DT><DT><A HREF="../ref/Light.htm#SetQuadraticAttenuation">SetQuadraticAttenuation</A>(value)
</DT></DL>
<P><B>Texture</B>
<DL>
<DT><A HREF="../ref/Texture3.htm#SetDecalSize">SetDecalSize</A>(width, height)
 </DT><DT><A HREF="../ref/Texture3.htm#SetDecalOrigin">SetDecalOrigin</A>(x, y)
 </DT><DT><A HREF="../ref/Texture3.htm#SetDecalTransparentColor">SetDecalTransparentColor</A>(color)
</DT></DL>
<P><B>Material</B>
<DL>
<DT><A HREF="../ref/Material2.htm#SetPower">SetPower</A>(value)
 </DT><DT><A HREF="../ref/Material2.htm#SetSpecular">SetSpecular</A>(red, green, blue)
 </DT><DT><A HREF="../ref/Material2.htm#SetEmissive">SetEmissive</A>(red, green, blue)
</DT></DL>
<P>*&#151;Indicates keys with different values for this parameter are inserted in separate chains

<P>An attempt to set a key of any unsupported method will result in a non-fatal D3DRMERR_BADOBJECT error.


<H2><A NAME="rmobject_Interpolator_Index_Span">Interpolator Index Span</A></H2>
<P>The interpolator covers a span of index values. This index span is dictated by the following rules:
<BLOCKQUOTE>
<UL><LI>The start of the span is the minimum of all key index values and the current index.
<LI>The end of the span is the maximum of all key index values and the current index.
</UL>
</BLOCKQUOTE>
<H2><A NAME="rmobject_Interpolation_Options">Interpolation Options</A></H2>
<P>The <I>d3drmInterpFlags</I> parameter of <A HREF="../ref/Interpolator.htm#Interpolate">IDirect3DRMInterpolator::Interpolate</A> allows you to perform interpolation by specifying one or more of the following options: 


<BLOCKQUOTE>
<UL><LI><A HREF="../ref/Constants.htm#D3DRMINTERPOLATION_C">D3DRMINTERPOLATION_CLOSED</A>
<LI><A HREF="../ref/Constants.htm#D3DRMINTERPOLATION_L">D3DRMINTERPOLATION_LINEAR</A> 
<LI><A HREF="../ref/Constants.htm#D3DRMINTERPOLATION_N">D3DRMINTERPOLATION_NEAREST</A> 
<LI><A HREF="../ref/Constants.htm#D3DRMINTERPOLATION_O">D3DRMINTERPOLATION_OPEN</A> 
<LI><A HREF="../ref/Constants.htm#D3DRMINTERPOLATION_S">D3DRMINTERPOLATION_SLERPNORMALS</A> 
<LI><A HREF="../ref/Constants.htm#D3DRMINTERPOLATION_S">D3DRMINTERPOLATION_SPLINE</A>
<LI><A HREF="../ref/Constants.htm#D3DRMINTERPOLATION_V">D3DRMINTERPOLATION_VERTEXCOLOR</A> 
</UL>
</BLOCKQUOTE>
<P>If the interpolator is executed CLOSED, the interpolation is cyclic. The keys effectively repeat infinitely with a period equal to the index span. For compatibility with animations, any key with an index equal to the end of the span is ignored.

<P>If the interpolation is OPEN, the first and last keys of each key chain fix the interpolated values outside of the index span.

<P>The NEAREST, LINEAR, and SPLINE options specify how in-betweening 



is performed on each key chain. In-betweening is the calculation of intermediate values that smoothly connect key data points. If NEAREST is specified the nearest key value is used. LINEAR performs linear interpolation between the 2 nearest keys. SPLINE uses a B-spline blending function on the 4 nearest keys.

<P>The following two options affect only the interpolation of <A HREF="../ref/Mesh.htm#SetVertices">IDirect3DRMMesh::SetVertices</A>:
<BLOCKQUOTE>
<UL><LI>VERTEXCOLOR specifies that vertex colors should be interpolated.
<LI>SLERPNORMALS specifies that vertex normals should be spherically interpolated (not currently implemented).
</UL>
</BLOCKQUOTE>
<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H5><HR size=1></H5>
<P><A class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
