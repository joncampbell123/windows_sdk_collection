<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Architecture</TITLE>
<SCRIPT LANGUAGE="JAVASCRIPT"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="Architecture">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="rmobject_Introduction_D3DRM"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --Architecture"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/HDRd3drm.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --Architecture"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="Direct3D Retained Mode Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft Direct3D Retained Mode SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../default.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="TechBackgrnd.htm">Technical Background</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="Oview_face.htm">Overviews</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->

<H1><a name="architecture" IDX_CONCEPT="COM Architecture, Direct3D Retained Mode">Architecture</a></H1>

<P>This section gives an overview of the Microsoft&#174; Direct3D&#174; Retained Mode objects and COM architecture. The following topics are discussed:
<BLOCKQUOTE>
<UL><LI><A HREF="Architecture.htm#Objects">Objects</A> gives a brief description of the Direct3D Retained Mode objects.
<LI><A HREF="Architecture.htm#Objects_and_Int">Objects and Interfaces</A> lists the interfaces supported by each object, as well as information on creating interfaces to both single objects and <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_A.htm#array_object')">array objects</A>. 
<LI><A HREF="Architecture.htm#Objects_and_Ref">Objects and Reference Counting</A> gives tips on reference counting in Direct3D Retained Mode.
</UL>
</BLOCKQUOTE>
<H2><A NAME="Objects">Direct3D Retained Mode Objects</A></H2>
<P>All access to Direct3D Retained Mode is through a small set of objects. The following table lists these objects and a brief description of each:
<P>
<TABLE CLASS="main" BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Object</B></TD>
<TD ALIGN=LEFT VALIGN=TOP><B>Description
</B></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/animation2.htm">Direct3DRMAnimation2</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Defines how a transformation will be modified&#151;often in reference to a <B>Direct3DRMFrame3</B> object. 

You can use it to animate the position, orientation, and scaling of <a href="../ref/visualarray.htm">Direct3DRMVisual</a>, of <A HREF="Lights_face.htm#rmobject_IDirect3DRMLight_Int">Direct3DRMLight</A>, and of <A HREF="Viewports_face.htm#rmobject_IDirect3DRMViewport2_Int">Direct3DRMViewport2</A> objects. Same as the <b>Direct3DRMAnimation</b> object, but allows access to the keys and frame of an animation.
</TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/animationarray.htm">Direct3DRMAnimationArray</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Retrieves the number of animations in the array, and an interface to the requested animation.
</TD>
</TR>



<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/animationset2.htm">Direct3DRMAnimationSet2</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Allows <a href="../ref/animation2.htm">Direct3DRMAnimation2</a> objects to be grouped together. Same as the <b>Direct3DRMAnimationSet</b> object, but allows access to the constituent animations.
</TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/clippedvisual.htm">Direct3DRMClippedVisual</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Allows clipping visuals to arbitrary planes before rendering.
</TD>
</TR>


<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="OutputDevices_face.htm">Direct3DRMDevice3</A></TD>
<TD ALIGN=LEFT VALIGN=TOP>Represents the visual display destination for the renderer. Extends the <b>Direct3DRMDevice2</b> object by enabling you to set and retrieve materials. <b>Direct3DRMDevice2</b> offers the same functionality as the <b>Direct3DRMDevice</b> object but with enhanced control of transparency. 
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/face2.htm">Direct3DRMFace2</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Represents a single polygon in a mesh.
</TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Frames_face.htm#rmobject_IDirect3DRMFrame3_Int">Direct3DRMFrame3</A></TD>
<TD ALIGN=LEFT VALIGN=TOP>Positions objects within a scene and defines the positions and orientations of visual objects. Extends the <b>Direct3DRMFrame</b> object by enabling access to the frame axes, bounding boxes, and materials. Also supports ray picking. Extends the <b>Direct3DRMFrame2</b> object by adding to the transform, traversal, and fogging capabilities.
</TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Interpolators_face.htm#Interpolators_face">Direct3DRMInterpolator</A></TD>
<TD ALIGN=LEFT VALIGN=TOP>Stores actions and applies the actions to objects with automatic calculation of in-between values.
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Lights_face.htm#rmobject_IDirect3DRMLight_Int">Direct3DRMLight</A></TD>
<TD ALIGN=LEFT VALIGN=TOP>Defines one of five types of lights that are used to illuminate the visual objects in a scene. 
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/material2.htm">Direct3DRMMaterial2</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Defines how a surface reflects light. Same as the <b>Direct3DRMMaterial</b> object, but allows finer control over material properties.
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/mesh.htm">Direct3DRMMesh</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Consists of a set of polygonal faces. You can use this object to manipulate groups of faces and vertices. 
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/meshbuilder3.htm">Direct3DRMMeshBuilder3</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Allows you to work with individual vertices and faces in a mesh. Extends  <b>Direct3DRMMeshBuilder</b> objects by providing more control over normals and allowing retrieval of a face on a mesh. Extends <b>Direct3DRMMeshBuilder2</b> objects by using the Immediate Mode DrawPrimitive interface when created with the <a href="../ref/idirect3drm3.htm">IDirect3DRM3</a> interface.

</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/object.htm">Direct3DRMObject</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Used as a base class by all other Direct3D Retained Mode objects. It has characteristics that are common to all objects. 
</TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/object2.htm">Direct3DRMObject2</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Used as a base class by all other Direct3D Retained Mode objects. It has characteristics that are common to all objects. Enhances <a href="../ref/object.htm">Direct3DRMObject</a> by allowing more flexible data association with an object.
</TD>
</TR>


<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/pickedarray.htm">Direct3DRMPickedArray</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Identifies a visual object that corresponds to a given 2-D point. 
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/picked2array.htm">Direct3DRMPicked2Array</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Identifies a visual object that corresponds to a given ray intersection. 
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/progressivemesh.htm">Direct3DRMProgressiveMesh</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Consists of a coarse base mesh together with records describing how to incrementally refine the mesh. This allows a generalized level of detail to be set on the mesh, as well as progressive download of the mesh from a remote source. 
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/Shadow2.htm">Direct3DRMShadow2</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Defines a shadow. Same as the <b>Direct3DRMShadow</b> object except that shadow properties can be set and retrieved after creation.
</TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/texture3.htm">Direct3DRMTexture3</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Consists of a rectangular array of colored pixels. Same as the <b>Direct3DRMTexture</b> object except that resources can be loaded from files other than the currently executing file, textures can be created from images in memory, and you can generate <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_m.htm#mipmap')">mipmaps</A>. Enhances the <b>Direct3DRMTexture2</b> object by allowing finer control over texture management.
</TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/uservisual.htm">Direct3DRMUserVisual</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Provides functionality not otherwise available in the system. It is defined by an application.
</TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Viewports_face.htm#rmobject_IDirect3DRMViewport2_Int">Direct3DRMViewport2</A></TD>
<TD ALIGN=LEFT VALIGN=TOP>Defines how the 3-D scene is rendered into a 2-D window. Same as the <b>Direct3DRMViewport</b> object except allows you to specify what should be cleared.
</TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/visualarray.htm">Direct3DRMVisual</a></TD>
<TD ALIGN=LEFT VALIGN=TOP>Consists of anything that can be rendered in a scene. Visual objects need not be visible; for example, a frame can be added as a visual object.
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="Wraps_face.htm#rmobject_IDirect3DRMWrap_Int">Direct3DRMWrap</A></TD>
<TD ALIGN=LEFT VALIGN=TOP>Calculates texture coordinates for a face or mesh. 
</TD>
</TR>
</TABLE>
<P>Many objects can be grouped into arrays, called <I>array objects</I>. Array objects make it simpler to apply operations to the entire group. The Component Object Model (COM) interfaces that allow you to work with array objects contain the <B>GetElement</B> and <B>GetSize</B> methods. These methods retrieve a pointer to an element in the array and the size of the array, respectively. For more information about array interfaces, see the <A HREF="../ref/Iface_intro.htm">interface reference</A> section.

<H2><A NAME="Objects_and_Int">Objects and Interfaces</A></H2>
<P>Using the <I>IObjectName</I><B>::QueryInterface</B> method retrieves a valid interface pointer only if the object supports that interface; therefore, you could use the <A HREF="../ref/FurtherReading.htm#IUnknown__QueryInter">IDirect3DRMDevice3::QueryInterface</A> method to retrieve the <A HREF="../ref/WinDevice.htm#IDirect3DRMWinDevice">IDirect3DRMWinDevice</A> interface, but not to retrieve the <a href="../ref/visual.htm">IDirect3DRMVisual</a> interface. 
 
<P>
<TABLE CLASS="main" BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Object name
 </B></TD><TD ALIGN=LEFT VALIGN=TOP><B>Supported interfaces
</B></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMAnimation2
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Animation2.htm">IDirect3DRMAnimation2</A>
</TD></TR>


<TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMAnimationSet2
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/AnimationSet2.htm">IDirect3DRMAnimationSet2</A>
</TD></TR>

<TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMClippedVisual
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/ClippedVisual.htm">IDirect3DRMClippedVisual</A>, <a href="../ref/visual.htm">IDirect3DRMVisual</a>
</TD></TR>


<TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMDevice3
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Device3.htm">IDirect3DRMDevice3</A>, <A HREF="../ref/WinDevice.htm">IDirect3DRMWinDevice</A>
 </TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMFace2
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/face2.htm">IDirect3DRMFace2</A>
</TD></TR>

<TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMFrame3
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Frame3Oview.htm">IDirect3DRMFrame3</A>, <a href="../ref/visual.htm">IDirect3DRMVisual</a>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMInterpolator
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Interpolator.htm">IDirect3DRInterpolator</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMLight
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Light.htm">IDirect3DRMLight</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMMaterial2
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Material2.htm">IDirect3DRMMaterial2</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMMesh
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Mesh.htm">IDirect3DRMMesh</A>, <a href="../ref/visual.htm">IDirect3DRMVisual</a>
</TD></TR>
<TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMMeshBuilder3
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/MeshBuilder3.htm">IDirect3DRMMeshBuilder3</A>, <a href="../ref/visual.htm">IDirect3DRMVisual</a>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMProgressiveMesh
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/ProgressiveMesh.htm">IDirect3DRMProgressiveMesh</A>, <a href="../ref/visual.htm">IDirect3DRMVisual</a>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMShadow2
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Shadow2.htm">IDirect3DRMShadow2</A>, <a href="../ref/visual.htm">IDirect3DRMVisual</a>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMTexture3
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Texture3.htm">IDirect3DRMTexture3</A>, <a href="../ref/visual.htm">IDirect3DRMVisual</a>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMUserVisual
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/UserVisual.htm">IDirect3DRMUserVisual</A>, <a href="../ref/visual.htm">IDirect3DRMVisual</a>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMViewport2
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Viewport2.htm">IDirect3DRMViewport2</A>
</TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP>Direct3DRMWrap
 </TD><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Wrap.htm">IDirect3DRMWrap</A>
</TD></TR></TABLE>
<P>The following example illustrates how to create two interfaces to a single <A HREF="OutputDevices_face.htm">Direct3DRMDevice3</A> object. The <A HREF="../ref/IDirect3DRM3.htm#CreateObject">IDirect3DRM3::CreateObject</A> method creates an uninitialized <A HREF="OutputDevices_face.htm">Direct3DRMDevice3</A> object. The <A HREF="../ref/Device3.htm#InitFromClipper">IDirect3DRMDevice3::InitFromClipper</A> method initializes the object. The call to the <A HREF="../ref/FurtherReading.htm#IUnknown__QueryInter">IDirect3DRMDevice3::QueryInterface</A> method creates a second interface to the <A HREF="OutputDevices_face.htm">Direct3DRMDevice3</A> object&#151;an <A HREF="../ref/WinDevice.htm">IDirect3DRMWinDevice</A> interface that the application will use to handle WM_PAINT and WM_ACTIVATE messages.
<PRE>
d3drmapi-&gt;CreateObject(CLSID_CDirect3DRMDevice, NULL,
    IID_IDirect3DRMDevice3,(LPVOID FAR*)&amp;dev1);
dev1-&gt;InitFromClipper(lpDDClipper, IID_IDirect3DRMDevice3, 
    r.right, r.bottom);
dev1-&gt;QueryInterface(IID_IDirect3DRMWinDevice, (LPVOID*) &amp;dev2);
</PRE>
<P>To determine whether two interfaces refer to the same object, use the <B>QueryInterface</B> method of each interface, and compare the values of the pointers they return. If the pointer values are the same, the interfaces refer to the same object. 
<P>All Direct3D Retained Mode objects support the <A HREF="../ref/Object.htm#IDirect3DRMObject">IDirect3DRMObject</A>, <A HREF="../ref/Object2.htm">IDirect3DRMObject2</A> and <A HREF="../ref/FurtherReading.htm#_dx5_IUnknown_Interface_dxintro">IUnknown</A> interfaces in addition to the interfaces in the preceding list. Array objects are not derived from <B>IDirect3DRMObject</B>. Array objects have no class identifiers (CLSIDs) because they are not needed. Applications cannot create array objects in a call to the <A HREF="../ref/IDirect3DRM3.htm#CreateObject">IDirect3DRM3::CreateObject</A> method; instead, they should use the creation methods listed below for each interface:
<P>
<TABLE CLASS="main" BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><B>Array interface</B></TD>
<TD ALIGN=LEFT VALIGN=TOP><B>Creation method
</B></TD>
</TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/animationarray.htm">IDirect3DRMAnimationArray</a>
 </TD><TD ALIGN=LEFT VALIGN=TOP><a href="../ref/animationset2.htm#GetAnimations">IDirect3DRMAnimationSet2::GetAnimations</a>
</TD></TR>

<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/DeviceArray.htm">IDirect3DRMDeviceArray</A></TD>
<TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/IDirect3DRM3.htm#GetDevices">IDirect3DRM3::GetDevices</A>
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/FaceArray.htm">IDirect3DRMFaceArray</A></TD>
<TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/MeshBuilder3.htm#GetFaces">IDirect3DRMMeshBuilder3::GetFaces</A>
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/FrameArray.htm">IDirect3DRMFrameArray</A></TD>
<TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/PickedArray.htm#IDirect3DRMPickedArray_GetPick">IDirect3DRMPickedArray::GetPick</A>, <A HREF="../ref/Picked2Array.htm#IDirect3DRMPicked2Array_GetPick">IDirect3DRMPicked2Array::GetPick</A>, or <A HREF="../ref/Frame3AtoM.htm#GetChildren">IDirect3DRMFrame3::GetChildren</A>
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/LightArray.htm">IDirect3DRMLightArray</A></TD>
<TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Frame3AtoM.htm#GetLights">IDirect3DRMFrame3::GetLights</A>
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/ObjectArray.htm">IDirect3DRMObjectArray</A></TD>
<TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Interpolator.htm#GetAttachedObjects">IDirect3DRMInterpolator::GetAttachedObjects</A>
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/PickedArray.htm">IDirect3DRMPickedArray</A></TD>
<TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Viewport2.htm#Pick">IDirect3DRMViewport2::Pick</A>
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Picked2Array.htm">IDirect3DRMPicked2Array</A></TD>
<TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Frame3NtoZ.htm#RayPick">IDirect3DRMFrame3::RayPick</A>
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/ViewportArray.htm">IDirect3DRMViewportArray</A></TD>
<TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/IDirect3DRM3.htm#CreateFrame">IDirect3DRM3::CreateFrame</A>
</TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/VisualArray.htm">IDirect3DRMVisualArray</A></TD>
<TD ALIGN=LEFT VALIGN=TOP><A HREF="../ref/Frame3AtoM.htm#GetVisuals">IDirect3DRMFrame3::GetVisuals</A>
</TD>
</TR>
</TABLE>
<H2><A NAME="Objects_and_Ref" IDX_CONCEPT="Reference Counting">Objects and Reference Counting</A></H2>
<P>When an object is created, its <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_r.htm#reference_count')">reference count</A> is incremented. Each time an application creates a child of an object or a method returns a pointer to an object, the system increments the reference count for that object. The object is not deleted until its reference count reaches zero. When you are finished with an object be sure to call the object's <A HREF="../ref/FurtherReading.htm#IUnknown__Release">Release</A> method to decrement its reference count. For example, you could call <a href="../ref/idirect3drm3.htm#CreateMeshBuilder">IDirect3DRM3::CreateMeshBuilder</a> to create an <b>IDirect3DRMMeshBuilder3</b> object and <a href="../ref/meshbuilder3.htm#GetFaces">IDirect3DRMMeshBuilder3::GetFaces</a> to retrieve an <b>IDirect3DRMFaceArray</b> object. Before your application terminates you should call the <b>Release</b> method on the <b>IDirect3DRMMeshBuilder3</b> object and also call the <b>Release</b> method on the <b>IDirect3DRMFaceArray</b> object. If you do not call <b>Release</b>, the objects will not be properly released and your application will leak resources. For other examples of when to release objects, see the Direct3D Retained Mode sample code.

<P>In Direct3D Retained Mode there is internal and external reference counting. If you have created or imported objects, such as textures, and applied them to objects in your scene, such as frames or meshes, you can then release your copy of the created or imported object's interface, and when the scene is finished with the object it will be automatically released by D3DRM for you. For example, if you create a meshbuilder object, its reference count is 1. If you then add it to a frame, its reference count is 2. You can then release your copy of the pointer to the meshbuilder object, and the meshbuilder object's reference count will be 1. Then, when you release the scene containing the frame, the reference count of the meshbuilder object will be decremented (to 0) for you and the object will be released. As another example, if you import a texture, the texture object's reference count is 1. If you apply the texture to a mesh, its reference count is 2. You can then release your copy of the pointer to the texture object, and its reference count is 1. When the mesh goes away, the texture object's reference count will be decremented and it will be released as well.
<p>If you always release your objects after they have been applied in the scene, your application does not need to keep track of the reference count for them, but only for the root of the scene. Retained Mode keeps track of the other reference counts automatically. In this case, your application should be able to simply release the scene, the viewport, and the device when it cleans up before exiting. (When your application releases the viewport, the system automatically takes care of the <A CLASS="Glossary" HREF="javascript:Glossary(sRelPath + 'gloss/gloss_c.htm#camera')">camera's</A> references.) 

<P>The reference count of a child or visual object increases when it is added to a frame. When you use the <A HREF="../ref/Frame3AtoM.htm#AddChild">IDirect3DRMFrame3::AddChild</A> method to move a child from one parent to another, the system handles the reference counting automatically. 
<P>After your application loads a visual object into a scene, the scene handles the reference counting for the visual object. The application no longer needs the visual object and can release it.
<P>Creating and applying a wrap does not increase the reference count of any objects because wrapping is really just a convenient method of calculating texture coordinates.

<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H5><HR size=1></H5>
<P><A class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
