<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Wraps</TITLE>
<SCRIPT LANGUAGE="JAVASCRIPT"> var sRelPath = '../' </SCRIPT>


<META NAME="Description" CONTENT="Wraps">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<!-- SNIFF_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->

</SCRIPT>
<SCRIPT SRC="../ver.js"></SCRIPT>
<SCRIPT SRC="../gloss.js"></SCRIPT>


<SCRIPT DEFER SRC="../common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{

		SetTOC();
	}
}
//-->

</SCRIPT>

<!-- SNIFF_END -->


<!-- STYLE_START -->

<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'dxm_basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'dxm_advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'dxm_basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'dxm_basicSDKNAV';
   }
   else
   {
	   sCSS += 'dxm_basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->

</SCRIPT>
<!-- STYLE_END -->


</HEAD>
<BODY onload="InitPage(); if (g_isIE && g_iMaj >= 4){HdgrphControl()}" BGCOLOR="#FFFFFF">
<A NAME="pagetop"></A><A NAME="rmobject_IDirect3DRMWrap_Int"></A>

<!-- HEADGRAPH_START -->

<TABLE CLASS="main" BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="../art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --Wraps"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="../art/HDRd3drm.gif" WIDTH="217" HEIGHT="110" BORDER=0 ALT="Direct3D Retained Mode Animated Header --Wraps"></TD><TD VALIGN="TOP" WIDTH="383">
<IMG SRC="../art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="Direct3D Retained Mode Animated Header">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="../art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft Direct3D Retained Mode SDK"></TD></TR>
<!-- HEADGRAPH_END -->

<!-- NAV_LINKS_START -->

<TR><TD VALIGN="TOP"><PRE><IMG ID="TOC_" SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" ID="TOC" HREF="../contents.htm">Contents</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="../index.htm">Index</A>  <IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="Oview_face.htm">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Viewports_face.htm">Viewports</A>
<IMG SRC="../art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="Tutorial.htm">Tutorial</A>
</PRE></TD></TR></TABLE>
<!-- NAV_LINKS_END -->

<BLOCKQUOTE CLASS="body">

<!-- CONTENTS_START -->

<H1><A NAME="Wraps"></A>Wraps</H1>

<P>You can use a wrap to calculate texture coordinates for a face or mesh. To create a wrap, the application must specify a type, a reference frame, an origin, a direction vector, and an up vector. The application must also specify a pair of scaling factors and an origin for the texture coordinates.
<P>Your application calls the <A HREF="../ref/IDirect3DRM3.htm#CreateWrap">IDirect3DRM3::CreateWrap</A> function to create an <A HREF="../ref/Wrap.htm#IDirect3DRMWrap">IDirect3DRMWrap</A> interface. This interface has two unique methods: <A HREF="../ref/Wrap.htm#Apply">IDirect3DRMWrap::Apply</A>, which applies a wrap to the vertices of the object, and <A HREF="../ref/Wrap.htm#ApplyRelative">IDirect3DRMWrap::ApplyRelative</A>, which transforms the vertices of a wrap as it is applied.
<P>In the examples, the direction vector (the v vector) lies along the z-axis, and the up vector (the u vector) lies along the y-axis, with the origin at [0 0 0]. 




<P>For a reference to the methods of the <B>IDirect3DRMWrap</B> interface, see <A HREF="../ref/Wrap.htm#IDirect3DRMWrap">IDirect3DRMWrap</A>.
<P>This section describes the wrapping flags and the four wrapping types.
<BLOCKQUOTE>
<UL><LI><A HREF="Wraps_face.htm#rmobject_Wrapping_Flags">Wrapping Flags</A>
<LI><A HREF="Wraps_face.htm#rmobject_Flat">Flat</A>
<LI><A HREF="Wraps_face.htm#rmobject_Cylindrical">Cylindrical</A>
<LI><A HREF="Wraps_face.htm#rmobject_Spherical">Spherical</A>
<LI><A HREF="Wraps_face.htm#rmobject_Chrome">Chrome</A>
</UL>
</BLOCKQUOTE>
<H2><A NAME="rmobject_Wrapping_Flags" IDX_CONCEPT="Wrap Flags">Wrapping Flags</A></H2>
<P>The <A HREF="../ref/Constants.htm#D3DRMMAPPING">D3DRMMAPPING</A> type includes the D3DRMMAP_WRAPU and D3DRMMAP_WRAPV flags. These flags determine how the rasterizer interprets texture coordinates. The rasterizer always interpolates the shortest distance between texture coordinates&#151;that is, a line. The path taken by this line, and the valid values for the u- and v-coordinates, varies with the use of the wrapping flags. If either or both flags is set, the line can wrap around the texture edge in the u or v direction, as if the texture had a cylindrical or toroidal topology.
<BLOCKQUOTE>
<UL><LI>In flat wrapping mode, in which neither of the wrapping flags is set, the plane specified by the u- and v-coordinates is an infinite tiling of the texture. In this case, values greater than 1.0 are valid for u and v. The shortest line between (0.1, 0.1) and (0.9, 0.9) passes through (0.5, 0.5).
<LI>If either D3DRMMAP_WRAPU or D3DRMMAP_WRAPV is set, the texture is a cylinder with an infinite length and a circumference of 1.0. Texture coordinates greater than 1.0 are valid only in the dimension that is not wrapped. The shortest distance between texture coordinates varies with the wrapping flag; if D3DRMMAP_WRAPU is set, the shortest line between (0.1, 0.1) and (0.9, 0.9) passes through (0, 0.5).
<LI>If both D3DRMMAP_WRAPU and D3DRMMAP_WRAPV are set, the texture is a torus. Because the system is closed, texture coordinates greater that 1.0 are invalid. The shortest line between (0.1, 0.1) and (0.9, 0.9) passes through (0, 0).
</UL>
</BLOCKQUOTE>
<P>Although texture coordinates that are outside the valid range may be truncated to valid values, this behavior is not defined.
<P>Typically, applications set a wrap flag for cylindrical wraps when the intersection of the texture edges does not match the edges of the face; applications do not set a wrap flag when more than half of a texture is applied to a single face.




<H2><A NAME="rmobject_Flat" IDX_CONCEPT="Flat Wraps;Wraps, Flat;noindex">Flat</A></H2>
<P>The flat wrap conforms to the faces of an object as if the texture were a piece of rubber that was stretched over the object.
<P>The [<I>u v</I>] coordinates are derived from a vector [<I>x y z</I>] by using the following equations:

<P><IMG SRC="../art/flateq.gif" WIDTH="84" HEIGHT="45" ALT="Equations for deriving u-v coordinates from a vector in a flat wrap">

<P>In these formulas, <I>s</I> is the window-scaling factor and <I>o</I> is the window origin. The application should choose a pair of scaling factors and offsets that map the ranges of <I>x</I> and <I>y</I> to the range from 0 to 1 for <I>u</I> and <I>v</I>. 

<H2><A NAME="rmobject_Cylindrical" IDX_CONCEPT="Cylindrical Wraps;Wraps, Cylindrical;noindex">Cylindrical</A></H2>
<P>The cylindrical wrap treats the texture as if it were a piece of paper that is wrapped around a cylinder so that the left edge is joined to the right edge. The object is then placed in the middle of the cylinder and the texture is deformed inward onto the surface of the object.
<P>For a cylindrical texture map, the effects of the various vectors are shown in the following illustration.
<P><IMG SRC="../art/cylwrap.gif" WIDTH="247" HEIGHT="201" ALT="Diagram showing the effects of vectors on a cylindrical wrap">
<P>The direction vector specifies the axis of the cylinder, and the up vector specifies the point on the outside of the cylinder where <I>u</I> equals 0. To calculate the texture [<I>u v</I>] coordinates for a vector [<I>x y z</I>], the system uses the following equations:
<P><IMG SRC="../art/texveceq.gif" WIDTH="113" HEIGHT="45" ALT="Equations for deriving u-v coordinates from a vector in a cylindrical wrap">


<P>Typically, <I>u</I> would be left unscaled and <I>v</I> would be scaled and translated so that the range of <I>z</I> maps to the range from 0 to 1 for <I>v</I>.



<H2><A NAME="rmobject_Spherical" IDX_CONCEPT="Spherical Wraps;Wraps, Spherical;noindex">Spherical</A></H2>
<P>For a spherical wrap, the u-coordinate is derived from the angle that the vector [<I>x y</I> 0] makes with the x-axis (as in the cylindrical map) and the v-coordinate from the angle that the vector [<I>x y z</I>] makes with the z-axis. Note that this mapping causes distortion of the texture at the z-axis.
<P><IMG SRC="../art/sphwrap.gif" WIDTH="246" HEIGHT="169" ALT="Diagram showing the effects of vectors on a spherical wrap">
<P>This translates to the following equations:
<P><IMG SRC="../art/sphwrpeq.gif" WIDTH="186" HEIGHT="68" ALT="Equations for deriving u-v coordinates from a vector in a spherical wrap">
<P>The scaling factors and texture origin will often not be needed here as the unscaled range of <I>u</I> and <I>v</I> is already 0 through 1.



<H2><A NAME="rmobject_Chrome" IDX_CONCEPT="Chrome Wraps;Wraps, Chrome;noindex">Chrome</A></H2>
<P>A chrome wrap allocates texture coordinates so that the texture appears to be reflected onto the objects. The chrome wrap takes the reference frame position and uses the vertex normals in the mesh to calculate reflected vectors. The texture u- and v-coordinates are then calculated from the intersection of these reflected vectors with an imaginary sphere that surrounds the mesh. This gives the effect of the mesh reflecting whatever is wrapped on the sphere.




<!-- CONTENTS_END -->

<!-- START_PAGE_FOOTER -->


<H5><HR size=1></H5>
<P><A class="line" HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="Top of Page">&nbsp;Top of Page</A>
<BR><A Class="line" HREF="../../cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END_PAGE_FOOTER -->

</BLOCKQUOTE>

<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../tip2.js"></SCR' + 'IPT><IFRAME ID="G_L_S" NAME="SecretBuffer" STYLE="display: none" SRC=""></IFRAME>')}</SCRIPT>

<!-- DACONTROL_START -->

	<DIV ID="HeadGraphAnim"></DIV>
	<SCRIPT LANGUAGE="JAVASCRIPT">if((g_isIE == true) && (g_iMaj > 3)) {window.self.document.writeln('<SCR' + 'IPT SRC="../anim.js"></SCR' + 'IPT>')}</SCRIPT>
<!-- DACONTROL_END -->

</BODY>
</HTML>
