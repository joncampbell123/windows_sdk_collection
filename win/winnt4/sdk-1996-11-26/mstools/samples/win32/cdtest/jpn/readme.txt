CDTEST は、コモン ダイアログが作成する構造体の各数値を編集できるダイアログ 
ボックスで構成されます。そのため、大抵のコモン ダイアログをすぐに作成する
ことができます。

ここでは、その方法の最小限 必要なことについて記述します:


すべての CDTEST ダイアログについて:
************************************

1.  CDTEST は、デフォルトのダイアログを除いて、それ自身では、どんなタイプ
　　のダイアログも作成しません。固有のダイアログを作成するのであれば、構造体
    要素フィールドを編集しなければなりません。
    たとえば、GetOpenFileName ダイアログにあるネットワーク ボタンを 隠したい
    場合は、Flags 構造体要素フィールドの値と、OFN_NONENETWORKBUTTON の値との 
    "OR" をとった値にしなければなりません。
    コモン ダイアログ フラグのための数値を得るためには、commdlg.h ヘッダー
    ファイルを参照してください。

2.  各ダイアログには、説明が必要ないくつかのチェック ボックスがあります:

    A.  [NULL Structure] ボックス

        このボックスをクリックすると、CDTEST は、コモン ダイアログが作成した
　　　　構造のために、コモン ダイアログのファンクションに　NULL を送ります。
        そのコモン ダイアログ ファンクションは、 FALSE を返して正しい
　　　　CommDlgExtendedError() を設定します。

    B.  [Preloaded Template] ボックス

        このボックスがマークされると、CDTEST は、カスタム テンプレート リ
        ソースをプリロードしてコモン ダイアログ構造体（PrintDlg() にいるの
        なら hPrintTemplate または hSetupTemplateにある構造体）のメンバ 
        hInstance のリソースにハンドルの値を設定します。
        しかし、CDTEST は、[Flags] ボックスの中に XXX_ENABLETEMPLATEHANDLE
        フラグも設定しなければ、このプリロード カスタム テンプレートで
        カスタム テンプレート ダイアログを作成できません。
        次に、多重選択フラグ リスト ボックスとプリロード カスタム 
        テンプレートを使って GetOpenFileName ダイアログを作成します。

	1.　[Flags] エデット ボックスに(OFN_ENABLETEMPLATEHANDLE | 
　　　　　　OFN_ALLOWMULTISELECT)を設定します。

        2.  [Preload Template] ボックスをクリックします。

        3.  [OK] を、クリックします。

        * 注意: 正しい数値モードであることを確認してください。
　　　　１０進数モードで１６進数を入力すると、予期せぬ結果になります。
        メインメニューから [Hex Mode] または [Decimal Mode] かを 選択して
        ください。


3.  [Reset] ボタン。すべてのコモン ダイアログ作成構造体の値を CDTEST の
　　デフォルトに戻します。

4.  [Add] と [Clear] ボタン。これらは、コモン ダイアログの作成中に必要と
　　される配列を編集するために使用します。
  　[Clear] は全配列をクリアし [Add] は、これらのボタンの左のコンボ ボック
　　スのエデットコントロール部分に、タイプしたものを追加します。

5.  [MultiThread] ボタン。これは、CDTEST と同じ方法でダイアログを作成しますが、
    ２つのスレッドと２つのダイアログを作成します。

    *注意: find と replace のダイアログの modeless-ness は、それらをマル
    チスレディングするといくつかの問題が発生します。
    そのため、FindText() と ReplaceText() のマルチスレディングはインプリメント
    されていません。



CDTEST ダイアログに関する特有の情報:
************************************

ChooseFont:
-----------

1.  ChooseFont ダイアログを開くとき ChooseFont() フラグのリストと縦の分割
　　線の右側にフォントが表示されます。それらは、フォント選択ダイアログの作
　　成に何も影響を与えません。これらは、ユーザーが Choosefont() が見つけ
　　たフォントのリストとは無関係に、フォントを比較するためにのみ表示されます。
    そのフォントのリストとは、同じにするべきです。            
　　スケーラブル スクリーン フォントだけのリストを参照したい場合は、
    [CF_SCALABLEONLY] と [CF_SCREENFONTS] のボックスをマークしてください。
　　CF_SCREENFONTS または CF_SCALABLEONLY を使用して ChooseFont ダイアログを
    作成したいなら、同じフォントのリストを得るべきです。


2.  注意:  フラグ編集ボックスの一部として ChooseFont ダイアログは、
    CF_SCREENFONTS または CF_PRINTERFONTS フラグを設定しなければ 
　　"No fonts found" エラーを出します。
    これは一般的なダイアログのデザインです。

3.  ChooseFont ダイアログでリストされたプリンタ フォントを得たい場合は、
    [HDC Type] の [Printer] にラジオ ボタンをマークしなければなりません。
　　
    例:

    現行のプリンタ上にあるスケラーブル スクリーン フォントのみを含む
　　ChooseFont ダイアログを作成するには、

    A.  [Flags] エディト ボックスに (CF_PRINTERFONTS | CF_SCALABLEONLY) の
        ための数値を設定します。

    B.  [HDC Type] グループの [Printer] オプションをマークします。

  　C.  [OK] をクリックします。


Open/Save:
----------

1.  OFN_ENABLETEMPLATE を使用して、Open/Save ダイアログのカスタム テンプ
    レートを作成したい場合は、"lpTemplateName" 構造体フィールドに下記の
    テンプレート名を記述する必要があります。

    opentemp1 -- [ファイル名] リストボックスで単一選択とする

    opentemp2 -- [ファイル名] リストボックスで複数選択可能とする


Find/Replace:
-------------

1.  FR_ENABLETEMPLATE を使用して、Find/Replace ダイアログのカスタム テン
    プレートを作成したい場合は、"lpTemplateName" 構造体フィールドに下記の
    テンプレート名を記述する必要があります。

    frtemp1 -- Find テンプレート

    frtemp2 -- Replace テンプレート



最後に:
*******


* GetOpenFileName 関数が使用する構造体の要素 "lpstrFile" のような文字列
  ポインタを要求するダイアログ要素の１つのために使われる値として、NULL
  ポインタを作成する方法はありません。このフィールドを空にすると、CDTEST 
  は、先頭の値が NULL 文字を含んでいるような不正なポインタを引数として、
  GetOpenFileName 関数をコールしてしまいます。


* [MultiThread] ボタンをクリックすると、スクリーン上にあたかも１つのダイ
  アログが作成されたかのように同一位置に２つのダイアログが作成されます。


* コモン ダイアログから CDTEST に制御が戻った後に、[Reset] ボタンを押すこ
  とは良策です。CDTEST は、コモン ダイアログ関数がリターンした後、
  コモン ダイアログを作成する構造体の値が、構造体編集フィールドに設定
  されるからです。それらの値は期待したものではないかもしれません。

  １つの問題を引き起こす可能性のある例を、以下に示します。

  1.  [Dialogs] メニューから, [GetOpenFileName] を選択してください。.

  2.  規定値の GetOpenFileName ダイアログを生成するには、[OK] をクリック
      してください。

  3.  GetOpenFileName ダイアログをキャンセルしてください。

  4.  [Fields] エディット ボックスに OFN_ENABLEHOOK のための値を指定して、
　　　[OK] をクリックしてください。もし、OFN_ENABLEHOOK の指定なしで
　　　GetOpenFileName 関数をコールすると、OPENFILENAME.lpfnHook の値に NULL 
      が設定(コモン ダイアログの仕様)されるので失敗します。
      すなわち最初の GetOpenFileName ダイアログから戻ってきたとき、
      OPENFILENAME.lpfnHook の値 NULL が、[lpfnHook] エディット ボックスに
      設定され、OFN_ENABLEHOOK フラグをもって再度コールしようとしたときに
      フック関数のアドレスが NULL のため失敗してしまうのです。
  
