サンプル: プロセス間のメモリの共有方法のデモ

概要:


MEMORY サンプルは、プロセス間の共有メモリを作成するファイル マッピング 
API の使い方のデモです。

詳細:

サーバー

    「サーバー」は名前付き共有メモリをセットアップします。

    「サーバー」は、[作成] から [サーバー] メニュー項目を
    選んで作成します。

    これにより、MDI の子をオープンし、メニュー バーをサーバーの
    メニュー バーに交換します。

    名前付き共有メモリをセットアップするには、

    1. [サーバー] から [ファイル作成...] メニュー項目を選択します。
       [ファイル タイプ] ダイアログ ボックスが表示されます。
       [ページ ファイル] または [マップ ファイル] ボタンをクリックする
       ことにより、すぐに作成される名前付き共有メモリを、メモリ ページ 
       ファイルにするか、または物理ファイルにするか選択できます。

       [マップ ファイル] ボタンを選択すると、名前付き共有メモリは、
       ディスク上の物理ファイルにバックアップされます。これに
       対して、[ページ ファイル] ボタンをクリックすると、メモリは
       メモリ ページ ファイルにバックアップされます。

    2. [サーバー]から[ファイル マッピングの作成...] メニュー項目を選択します。
       [マップ名] ダイアログ ボックスが表示されます。ここで、上記の
       ステップ 1 で作成されたファイル用に作成するメモリ マップ 
       ファイル オブジェクトの名前を指定します。

       この名前は、他のプロセスのクライアントが共有メモリを識別する
       ために使います。

    3. [サーバー]から[ファイル ビューのマップ] メニュー項目を選択します。
       これにより、上記のステップ 2 で作成されたマップ ファイル 
       オブジェクトをプロセスのアドレス空間にマップします。

    4. [サーバー]から[アクセス] メニュー項目を選択します。
       これは、MDI サーバーの子の内部に MLE を作成します。MLE に
       書き込まれたものはすべて、マップ ファイル オブジェクトに置かれます。

クライアント

    「クライアント」は、他のプロセスのサーバーが作成した名前付き
    共有メモリに接続します。

    「クライアント」は、[作成]から[クライアント] メニュー項目を選択すること
    により作成されます。

    これにより、MDI の子をオープンし、メニュー バーをクライアントの
    メニュー バーに交換します。

    名前付き共有メモリへの接続をセットアップするには、

    1. [クライアント]から[ファイル マッピングのオープン...] 
       メニュー項目を選択します。[マップ名] ダイアログ ボックス
       が表示されます。ここで、クライアントから接続したいマップ 
       ファイル オブジェクトの名前を入力できます。

    2. [クライアント]から[ファイル ビューのマップ] メニュー項目を選択します。
       これにより、上記のステップ 1 でオープンされたマップ ファイル 
       オブジェクトをプロセスのアドレス空間にマップします。

    3. [クライアント]から[アクセス] メニュー項目を選択します。
       これは、MDI サーバーの子の内部に MLE を作成します。
       サーバーによってマップ ファイル オブジェクトに書き込
       まれたものはすべて、この MLE に表示されます。

       クライアントとサーバーの同期は一定間隔で行われます。

    4. [クライアント]から[リフレッシュ] メニュー項目を選択すると、マップ 
       ファイル オブジェクトの内容が最新表示になります。
