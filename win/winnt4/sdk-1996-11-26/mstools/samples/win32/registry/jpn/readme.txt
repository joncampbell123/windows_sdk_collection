サンプル: レジストリにアクセスする API 関数の使用

要約:

レジストリ MONKEY は、NT のレジストリにアクセスするために必要な
レジストリ API 関数のデモを行う簡単なユーティリティーです。
MONKEY は、個々のキーのデータ値を表示しながら、レジストリ ツリーの
さまざまなブランチを上ったり下ったりするために使うことができます。

レジストリ MONKEY サンプルは、ディレクトリ \MSTOOLS\SAMPLES\REGISTRY
にあります。

情報：

使用法:
MONKEY のインスタンスを始動してください。いくつかのエディット 
フィールド、リスト ボックス、およびボタンを持ったダイアログ 
ボックスが現われます。ダイアログ ボックスの中心のリスト ボックス 
(チャイルド キーというラベルが下に付いています) は、いつでも現在の
キーの子供のキーを保持します。最初は 4 つの項目があり、それは
あらかじめ定義された 4 つのレジストリのキー ハンドル、
HKEY_LOCAL_MACHINE、HKEY_CURRENT_USER、HKEY_USERS、および 
HKEY_CLASSES_ROOT を示します。これらの項目のいずれかの上で
ダブル クリックを行なうか、それを強調表示させてから [次/下] 
ボタンを押すと、今選択したキーがエディット フィールド [キー名] 
に現われ、リスト ボックス "チャイルド キー:" は選択されたキーの
子供で置きかわります。例えば、HKEY_LOCAL_MACHINE を選ぶとその
名前が [キー名] に現われ、その子供である HARDWARE、SAM、SECURITY、
SOFTWARE、および SYSTEM がリスト ボックスに現われます。
ツリーの中に深く進むには他の子供をダブル クリックしてください。
レジストリの中から戻るには、リスト ボックスの上部にある ".." を
ダブル クリックするか、"前/上" ボタンを押してください。

もし現在のキーに関連付けられている値がある場合は、値の名前が
右のリスト ボックス ([値:] というラベルが付いています) に
リストされます。もし値を持たないときには、[値:] の後に [0] 
が付きます。値を持つ、関連付けられているキーを一度表示すると、
このリスト ボックスの中のどの値でもダブル クリックできるように
なります。ダイアログ ボックスの下部には、[値: データ タイプ] と 
[値: データ エントリ] の２つのエディット フィールドがあります。
値の項目をダブル クリックすることにより、これらのエディット 
フィールドはデータのタイプとデータの値で埋められます。すなわち、
もしツリーを HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System 
まで下り、 項目 "1) Identifier" をダブル クリックすると、
[値: データ タイプ] は [REG_SZ: Null で終了する Unicode文字列] 
で埋まり [値: データ エントリ] はおそらく [AT/AT COMPATIBLE] 
などで埋まるでしょう。

もし現在のキーが、関連付けられているクラス タイプを持つときに
は、それは "クラス" エディット フィールドに現われます。"ACL"
エディット フィールドは、このリリースのレジストリ MONKEY で
は実現されていません。

