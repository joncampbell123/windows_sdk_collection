RASberry - RAS API セットのデモ

ここに記述されているコードと情報は、現存するままの状態で提供されるものであり、
商品性の保証および特定目的への適合性を含む、すべての黙示または明示の保証をす
るものではありません。

Copyright (C) 1993-1995  Microsoft Corporation.  All Rights Reserved.


目的:
    リモート アクセス サービス (RAS) API セットを説明します。RASberry により、
    ユーザーは現在の RAS 接続の列挙、選択した接続の状態の表示、デフォルトの
    電話帳の項目のダイヤル、アクティブな接続の切断が可能です。

以下の RAS API を使います。
    RasDial
    RasEnumConnections
    RasEnumEntries
    RasGetConnectStatus
    RasGetErrorString
    RasHangUp

備考:
    このサンプルは、16 ビットまたは 32 ビットのアプリケーションとしてビルドで
    きます。デフォルトは 32 ビットです。16 ビット版をビルドするには、ビルド 
    コマンド ラインに MAK16 を定義してください。

    32 ビット版固有情報:
    − アプリケーション自体が稼働する前に、アプリケーションでは、RAS ステート 
       マシンにハングアップがあった場合はマシンがリセットされていることを確認
       する必要があります。これは Sleep(3000) を呼び出して確認できます。詳細
       は、ドキュメントの RasHangUp の箇所を参照してください。

    − 32 ビットの RasDial API は同期的にも非同期的にも機能します。このサンブ
       ルでは非同期機能を示しています。非同期で RasDial API を呼び出すには、接
       続プロセスの状態の変化を通知するメッセージを受け取るコールバック関数が
       必要です。この関数はウィンドウ プロセスやメッセージ キューには関連付け
       られません。Win32 と Win16 の両方のアプリケーションに対して 1 種類の
       ソース コードを提供するために、RASberry の RasDialFunc はウィンドウに
       メッセージをポストするだけで、そのウィンドウのメッセージ ハンドルが適切
       なアクションを取るようにしています。


    16 ビット固有情報:
    − RasDial API は Win16 では非同期的に機能します。RasDial は、RasDial への
       呼び出しで指定されているウィンドウに WM_RASDIALEVENT メッセージを送りま
       す。アプリケーションはこのメッセージを処理中にどんなタスクを実行しても
       かまいませんが、EndDialog() を呼び出してはいけません。ウィンドウをク
       ローズしたい場合は、このサンプルのように、ウィンドウにシャット ダウン 
       メッセージをポストする必要があります。


モジュール マップ:
    RASberry − メイン ウィンドウのメッセージ ハンドラを実装します。現在の RAS 
                接続のリストを保守します。
    StatDlg  − メインのアプリケーション ウィンドウから選択された接続の状態を
                表示します。
    PhbkDlg  − デフォルトの電話帳の内容を表示します。ユーザーはその中の項目を
                ダイヤルできます。
    AuthDlg  − 接続する前に、ユーザーから認証情報を取得します。
    DialDlg  − 初期接続段階での RAS 接続の状態を表示します。
    RasUtil  − 上記モジュールで使われるユーティリティ。
    Dispatch − メッセージ ディスパッチ ルーチン。
    WinMain  − 初期化関数を呼び出し、メッセージ ループを処理します。
    Init     − アプリケーションとインスタンスに固有の初期化を実行します。
    About    − 標準のダイアログ ボックスを定義します。
    Misc     − 特定のモジュールには関係しない、アプリケーション固有のコマンド
                を定義します。
