サンプル:  メッセージ テーブル リソースの組み込み方と使い方

要約：

このサンプルは、アプリケーションで、メッセージ テーブル リソースをどう
やって組み込んで使うかを説明しています。メッセージ コンパイラ (MC.EXE) 
のサンプル メッセージ テーブル (messages.mc) には、典型的なメッセージ 
テーブル ソース ファイルの形式が示されています。それぞれのメッセージで、
いくつかのエントリは省略可能ですが、説明上、このサンプルには、省略可能な
エントリも含まれています。省略可能なフィールドの詳細は、メッセージ テー
ブル コンパイラの tools.hlp ファイルの説明を参照してください。

詳細:

このサンプルでは、リソースだけの DLL、つまりメッセージ テーブル リソース
しか含まない DLL の作成方法を説明します。DLL のソース ファイル (messages.c) 
には、TRUE を戻すスタブ エントリ ポイントだけが入っていますが、これは、
DLL には少なくとも 1 つのエントリ ポイントが必要なので、リソースだけの 
DLL にもエントリ を 1 つ設けたからです。

msgtest.exe 実行可能プログラムでは、メッセージ テーブル DLL のロード方法、
FormatMessage API を使った、リソース ファイルからのメッセージ テキストの
取り出し方法、および、メッセージ ID の様々なビットのデコード方法が示され
ています。この実行可能プログラムの messages.h インクルード ファイルは、
メッセージ コンパイラ (mc.exe) により、メイク プロセス中に作成されること
に注意してください。これは、メッセージ コンパイラが、メッセージ テーブル 
ソース ファイルからバイナリのリソース ファイルを作成するためです。

メッセージ テーブル ソース ファイルとメッセージ テーブル DLL のための依存
規則をどのように設定するかは、メイクファイルを使って表すと便利です。

メッセージ テーブル リソースを、スタンドアロンの DLL にではなく、ユーザー
の実行可能プログラムに直接リンクするのは、このサンプルを修正するだけで簡単
にできます。普通、メッセージ テーブル リソースを DLL にすることが多いので
すが、メッセージ テーブル リソースが DLL に 入っている必要はありません。
