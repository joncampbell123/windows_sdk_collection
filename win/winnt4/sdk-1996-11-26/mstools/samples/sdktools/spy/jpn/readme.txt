サンプル: スパイ

概要:

スパイ SDK サンプルは、以前は特定のウィンドウに送られるシステム メッセージを監
視するデモでした。スパイはメッセージを記録し、特定のデバイスに表示します。ウィ
ンドウが受け取ったメッセージを、受け取るはずのメッセージと検証できるので、スパイはデバッグにも有用です。

スパイは、以下の技法のデモを行います。

1. システム メッセージのフックの使い方
2. 新しい WM_COPYDATA メッセージを使って、他のアプリケーションにデータを渡す
3. レジストリの読み書き
4. スレッドの作成
5. フック用の DLL の作成

詳細:

メッセージを監視するためにスパイを使うには、以下のようにします。

1. [オプション] メニューから、以下のように選択します。

- [メッセージ] - 監視したいメッセージを選択します。
- [フォント] - 表示に使うフォントを選択します。
- [出力] - メッセージを出力したい出力デバイスを選択します。

2. メッセージを監視したいウィンドウを、[スパイ] メニューから [ウィンドウ] コマンドを選んで、選択します。現在監視できるウィンドウを一覧表示するダイアログ ボックスが表示されます。デフォルトは、すべてのウィンドウです。

3. [編集] メニューを使うと、スパイ ウィンドウからクリップボードに切り取り、コピー、貼り付けを行うことができます。

4. 監視を始めるには [スパイ開始] を選びます。このオプションを選択すると、メニュー項目は [スパイ停止] に変わります。[スパイ停止] を選ぶと、メッセージの監視を停止します。



